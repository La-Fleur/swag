<html>
<head><title> "Background (wallpaper) on a form" by DUSTIN CALDWELL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0364.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">How <font color="#FF0000"><b>to </b></font>give wallpaper <font color="#FF0000"><b>or </b></font>image <font color="#FF0000"><b>in </b></font>the delphi<font color="#800000">'s form, not Windows
</font>wallpaper<font color="#000080">?

</font>Aries<font color="#000080">,

</font>We <font color="#FF0000"><b>do </b></font>this <font color="#FF0000"><b>in </b></font>our application <font color="#000080">(</font>D1<font color="#000080">), </font>but the method <font color="#FF0000"><b>is </b></font>rather difficult <font color="#000080">(</font>well<font color="#000080">, </font>its <font color="#FF0000"><b>not </b></font>easy at any rate<font color="#000080">). </font><font color="#FF0000"><b>If </b></font>interested <font color="#000080">( </font><font color="#FF0000"><b>or </b></font>others<font color="#000080">) </font>I can post the code<font color="#000080">. (</font>its <font color="#FF0000"><b>not </b></font>too long<font color="#000080">). </font>Oh what the hey<font color="#000080">, </font>I<font color="#800000">'ll just post it now:

</font><font color="#008000"><i>{the declaration part}
  </i></font>TMainForm <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
  </font><font color="#FF0000"><b>private
         PROCEDURE </b></font>ClientWndProc<font color="#000080">(</font><font color="#FF0000"><b>VAR Message</b></font><font color="#000080">: </font>TMessage<font color="#000080">);


</font><font color="#008000"><i>{the actual procedure}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>TMainForm<font color="#000080">.</font>ClientWndProc<font color="#000080">(</font><font color="#FF0000"><b>VAR Message</b></font><font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>MyDC <font color="#000080">: </font>hDC<font color="#000080">;
  </font>Ro<font color="#000080">, </font>Co <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  with Message do
    case </b></font>Msg <font color="#FF0000"><b>of
      </b></font>WM_ERASEBKGND<font color="#000080">:
        </font><font color="#FF0000"><b>begin
          </b></font>MyDC <font color="#000080">:= </font>TWMEraseBkGnd<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">).</font>DC<font color="#000080">;
          </font>Ro <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>Co <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>PaintRgn<font color="#000080">(</font>MyDC<font color="#000080">, </font>CreateRectRgn<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>ClientWidth<font color="#000080">, </font>ClientHeight<font color="#000080">));
          </font>BitBlt<font color="#000080">(</font>MyDC<font color="#000080">, </font>Co<font color="#000080">*</font>ImageEagle<font color="#000080">.</font>Picture<font color="#000080">.</font>Width<font color="#000080">, </font>Ro<font color="#000080">*</font>ImageEagle<font color="#000080">.</font>Picture<font color="#000080">.</font>Height<font color="#000080">,
                </font>ImageEagle<font color="#000080">.</font>Picture<font color="#000080">.</font>Width<font color="#000080">, </font>ImageEagle<font color="#000080">.</font>Picture<font color="#000080">.</font>Height<font color="#000080">,
                                 </font><font color="#008000"><i>{ImageEagle.Picture.Bitmap.Canvas.Handle, 0, -130, SRCCOPY);}
                                 </i></font>ImageEagle<font color="#000080">.</font>Picture<font color="#000080">.</font>Bitmap<font color="#000080">.</font>Canvas<font color="#000080">.</font>Handle<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>SRCCOPY<font color="#000080">);
                   </font>Result <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>else
      </b></font>Result <font color="#000080">:= </font>CallWindowProc<font color="#000080">(</font>FPrevClientProc<font color="#000080">, </font>ClientHandle<font color="#000080">, </font>Msg<font color="#000080">, </font>wParam<font color="#000080">, </font>lParam<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{the reference to activate the process}
</i></font><font color="#FF0000"><b>procedure </b></font>TMainForm<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>FClientInstance <font color="#000080">:= </font>MakeObjectInstance<font color="#000080">(</font>ClientWndProc<font color="#000080">);
  </font>FPrevClientProc <font color="#000080">:= </font>Pointer<font color="#000080">(</font>GetWindowLong<font color="#000080">(</font>ClientHandle<font color="#000080">, </font>GWL_WNDPROC<font color="#000080">));
  </font>SetWindowLong<font color="#000080">(</font>ClientHandle<font color="#000080">, </font>GWL_WNDPROC<font color="#000080">, </font>LongInt<font color="#000080">(</font>FClientInstance<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>On </b></font>the form itself there <font color="#FF0000"><b>is </b></font>a TImage called ImageEagle<font color="#000080">. </font>this <font color="#FF0000"><b>contains </b></font>the image that will be used<font color="#000080">.
</font>It works <font color="#FF0000"><b>for </b></font>us<font color="#000080">, </font>but there may be a better way <font color="#FF0000"><b>do do </b></font>it<font color="#000080">.

</font>HTH<font color="#000080">,
</font>Dustin

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0364.PAS">Original</a><b>]</b></p></body>
</html>
