<html>
<head><title> "Saving and Loading aTstringgrid" by ERIC LAWRENCE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0445.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">From<font color="#000080">: &quot;</font>Eric Lawrence<font color="#000080">&quot; &lt;</font>deltagrp<font color="#000080">@</font>keynetcorp<font color="#000080">.</font>net<font color="#000080">&gt;

&gt;&gt;</font>How can I save an entire stringgrid <font color="#FF0000"><b>with </b></font>all cells <font color="#FF0000"><b>to </b></font>a <font color="#FF0000"><b>file</b></font><font color="#000080">?

--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>Procedure </b></font>SaveGrid<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font>textfile<font color="#000080">;
</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>assignfile <font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'Filename'</font><font color="#000080">);
</font>rewrite <font color="#000080">(</font>f<font color="#000080">);
</font>writeln <font color="#000080">(</font>f<font color="#000080">,</font>stringgrid<font color="#000080">.</font>colcount<font color="#000080">);
</font>writeln <font color="#000080">(</font>f<font color="#000080">,</font>stringgrid<font color="#000080">.</font>rowcount<font color="#000080">);
</font><font color="#FF0000"><b>For </b></font>X<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>stringgrid<font color="#000080">.</font>colcount<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
        For </b></font>y<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>stringgrid<font color="#000080">.</font>rowcount<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
</b></font>writeln <font color="#000080">(</font>F<font color="#000080">, </font>stringgrid<font color="#000080">.</font>cells<font color="#000080">[</font>x<font color="#000080">,</font>y<font color="#000080">]);
</font>closefile <font color="#000080">(</font>f<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>LoadGrid<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font>textfile<font color="#000080">;
</font>temp<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;
</font>tempstr<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>assignfile <font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'Filename'</font><font color="#000080">);
</font>reset <font color="#000080">(</font>f<font color="#000080">);
</font>readln <font color="#000080">(</font>f<font color="#000080">,</font>temp<font color="#000080">);
</font>stringgrid<font color="#000080">.</font>colcount<font color="#000080">:=</font>temp<font color="#000080">;
</font>readln <font color="#000080">(</font>f<font color="#000080">,</font>temp<font color="#000080">);
</font>stringgrid<font color="#000080">.</font>rowcount<font color="#000080">:=</font>temp<font color="#000080">;
</font><font color="#FF0000"><b>For </b></font>X<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>stringgrid<font color="#000080">.</font>colcount<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
        For </b></font>y<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>stringgrid<font color="#000080">.</font>rowcount<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
        </b></font>readln <font color="#000080">(</font>F<font color="#000080">, </font>tempstr<font color="#000080">);
        </font>stringgrid<font color="#000080">.</font>cells<font color="#000080">[</font>x<font color="#000080">,</font>y<font color="#000080">]:=</font>tempstr<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>closefile <font color="#000080">(</font>f<font color="#000080">);

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0445.PAS">Original</a><b>]</b></p></body>
</html>
