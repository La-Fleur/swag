<html>
<head><title> "Change color of specific cell in TString" by MICHAEL VINCZE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0142.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;I am trying to change the color of specific cell in TStringGrid.
&gt;Whenever I change the color of TStringGrid.Color, then the whole thing
&gt;(TStringGrid) is changed to the given color.
&gt;
&gt;If there is no way for doing this, are there any ways to change the
&gt;font of the text only for the specific cell ?
&gt;


This is off the top of my head:

1.  You must set the DrawAutomatic property to False.
2.  You must create a method for the OnDrawCell event.
}

</i></font>The OnDrawCell event would look something like<font color="#000080">:

  </font><font color="#FF0000"><b>var
    </b></font>Text<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>StrPCopy <font color="#000080">(</font>Text<font color="#000080">, </font>StringGrid1<font color="#000080">.</font>Cells<font color="#000080">[</font>Row<font color="#000080">, </font>Col<font color="#000080">]);
  </font><font color="#FF0000"><b>if </b></font>Col <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>then
    </b></font>StringGrid1<font color="#000080">.</font>Canvas<font color="#000080">.</font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font>clYellow
  <font color="#FF0000"><b>else
    </b></font>StringGrid1<font color="#000080">.</font>Canvas<font color="#000080">.</font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font>clWhite<font color="#000080">;
  </font>ExTextOut <font color="#000080">(..., </font>Rect<font color="#000080">.</font>Left <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">, </font>Rect<font color="#000080">.</font>Bottom <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">, ..., </font>Text<font color="#000080">, </font>StrLen <font color="#000080">(</font>Text<font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>This will draw the third column yellow <font color="#FF0000"><b>and </b></font>all others
white<font color="#000080">.

</font>Again the code <font color="#FF0000"><b>and property </b></font>names are off the top <font color="#FF0000"><b>of </b></font>my
head<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>you have the VCL source<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>take a look <font color="#FF0000"><b>in
</b></font>the GRIDS<font color="#000080">.</font>PAS <font color="#FF0000"><b>file and </b></font>you will see how the <font color="#FF0000"><b>default
</b></font>OnDrawCell event <font color="#FF0000"><b>uses </b></font>the ExTextOut<font color="#000080">() </font><font color="#FF0000"><b>function</b></font><font color="#000080">.  </font>You
could take the code from there <font color="#FF0000"><b>and </b></font>paste it into your
source <font color="#FF0000"><b>and then </b></font>add the test <font color="#FF0000"><b>for </b></font>what color <font color="#FF0000"><b>to </b></font>draw the
grid <font color="#FF0000"><b>with</b></font><font color="#000080">.

</font>Best regards<font color="#000080">,
</font>Michael Vincze
mav<font color="#000080">@</font>asd470<font color="#000080">.</font>dseg<font color="#000080">.</font>ti<font color="#000080">.</font>com






</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0142.PAS">Original</a><b>]</b></p></body>
</html>
