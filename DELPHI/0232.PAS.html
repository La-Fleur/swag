<html>
<head><title> "Re: StretchBlt with D2" by MIKE SHANE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0232.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here is some code I use to print a bitmap with StretchDIBits.  The
function accomplishes the same thing as StretchBlt.  The difference is
that it operates with Device Independent Bitmaps (DIBs).  If you want to
use
StretchBlt, you would use it like this:
}

</i></font>StretchBlt<font color="#000080">(</font>DestinationRectangle<font color="#000080">.</font>Handle<font color="#000080">, </font>DestX<font color="#000080">, </font>DestY<font color="#000080">, </font>DestWidth<font color="#000080">,
              </font>DestH<font color="#000080">, </font>Bitmap<font color="#000080">.</font>Handle<font color="#000080">,</font>SourceX<font color="#000080">, </font>SourceY<font color="#000080">, </font>SourceWidth<font color="#000080">,
              </font>SourceHeight<font color="#000080">, </font>SRCCOPY<font color="#000080">);

</font><font color="#008000"><i>{ ----- begin code ----- }
</i></font><font color="#FF0000"><b>procedure </b></font>TfrmMain<font color="#000080">.</font>PrintBitmap<font color="#000080">(</font>Bitmap<font color="#000080">: </font>TBitmap<font color="#000080">; </font>X<font color="#000080">, </font>Y<font color="#000080">, </font>W<font color="#000080">, </font>H<font color="#000080">: </font>Integer<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>Info<font color="#000080">: </font>PBitmapInfo<font color="#000080">;
    </font>InfoSize<font color="#000080">: </font>Integer<font color="#000080">;
    </font>Image<font color="#000080">: </font>Pointer<font color="#000080">;
    </font>ImageSize<font color="#000080">: </font>Longint<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    with </b></font>Bitmap <font color="#FF0000"><b>do
    begin
      </b></font>GetDIBSizes<font color="#000080">(</font>Handle<font color="#000080">, </font>InfoSize<font color="#000080">, </font>ImageSize<font color="#000080">);
      </font>Info <font color="#000080">:= </font>MemAlloc<font color="#000080">(</font>InfoSize<font color="#000080">);
      </font><font color="#FF0000"><b>try
        </b></font>Image <font color="#000080">:= </font>MemAlloc<font color="#000080">(</font>ImageSize<font color="#000080">);
        </font><font color="#FF0000"><b>try
          </b></font>GetDIB<font color="#000080">(</font>Handle<font color="#000080">, </font>Palette<font color="#000080">, </font>Info<font color="#000080">^, </font>Image<font color="#000080">^);
          </font><font color="#FF0000"><b>with </b></font>Info<font color="#000080">^.</font>bmiHeader <font color="#FF0000"><b>do
            </b></font>StretchDIBits<font color="#000080">(</font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Handle<font color="#000080">, </font>X<font color="#000080">, </font>Y<font color="#000080">, </font>W<font color="#000080">,</font>H<font color="#000080">,
                                </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>biWidth<font color="#000080">,</font>biHeight<font color="#000080">,</font>Image<font color="#000080">,</font>Info<font color="#000080">^,
                                </font>DIB_RGB_COLORS<font color="#000080">,</font>SRCCOPY<font color="#000080">);
        </font><font color="#FF0000"><b>finally
          </b></font>FreeMem<font color="#000080">(</font>Image<font color="#000080">, </font>ImageSize<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>finally
        </b></font>FreeMem<font color="#000080">(</font>Info<font color="#000080">, </font>InfoSize<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ ----- end code ----- }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0232.PAS">Original</a><b>]</b></p></body>
</html>
