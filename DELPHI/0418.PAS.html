<html>
<head><title> "A Dbgrid with colored cells ?" by ED HILLMANN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0418.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Ed_P<font color="#000080">.</font>_Hillmann<font color="#000080">@</font>mail<font color="#000080">.</font>amsinc<font color="#000080">.</font>com <font color="#000080">(</font>Ed Hillmann<font color="#000080">)

</font>I don<font color="#800000">'t know if this helps, but I could color individual cells in a DBGrid without having to make a new DBGrid component. This is what I just tested.... 
</font>I created a form<font color="#000080">, </font>dropped a TTable component it<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>pointed it <font color="#FF0000"><b>to </b></font>the EMPLOYEE<font color="#000080">.</font>DB database <font color="#FF0000"><b>in </b></font>the DBDEMOS database<font color="#000080">. </font>I dropped a Datasource <font color="#FF0000"><b>and </b></font>DBGrid <font color="#FF0000"><b>on </b></font>the form so that it showed <font color="#FF0000"><b>on </b></font>the form<font color="#000080">.

</font>I thought a simple test would be<font color="#000080">, </font><font color="#FF0000"><b>for </b></font>the employee number <font color="#FF0000"><b>in </b></font>the EMPLOYEE<font color="#000080">.</font>DB table<font color="#000080">, </font>check <font color="#FF0000"><b>if </b></font>it<font color="#800000">'s an odd number. If it'</font>s an odd number<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>turn that cell green<font color="#000080">.

</font><font color="#FF0000"><b>Then</b></font><font color="#000080">, </font>the only code I attached was <font color="#FF0000"><b>to </b></font>the DBGrid<font color="#800000">'s OnDrawColumnCell event, which looks as follows....



</font><font color="#000080">--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>DBGrid1DrawColumnCell<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>Rect<font color="#000080">:
</font>TRect<font color="#000080">; </font>DataCol<font color="#000080">: </font>Integer<font color="#000080">; </font>Column<font color="#000080">: </font>TColumn<font color="#000080">; </font>State<font color="#000080">: </font>TGridDrawState<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>holdColor<font color="#000080">: </font>TColor<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>holdColor <font color="#000080">:= </font>DBGrid1<font color="#000080">.</font>Canvas<font color="#000080">.</font>Brush<font color="#000080">.</font>Color<font color="#000080">; </font><font color="#008000"><i>{store the original color}
  </i></font><font color="#FF0000"><b>if </b></font>Column<font color="#000080">.</font>FieldName <font color="#000080">= </font><font color="#800000">'EmpNo' </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{only do for the cell displaying
EmpNo}
    </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Column<font color="#000080">.</font>Field<font color="#000080">.</font>AsInteger <font color="#FF0000"><b>mod </b></font><font color="#800000">2 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>DBGrid1<font color="#000080">.</font>Canvas<font color="#000080">.</font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font>clGreen<font color="#000080">;
      </font>DBGrid1<font color="#000080">.</font>DefaultDrawColumnCell<font color="#000080">(</font>Rect<font color="#000080">, </font>DataCol<font color="#000080">, </font>Column<font color="#000080">, </font>State<font color="#000080">);
      </font>DBGrid1<font color="#000080">.</font>Canvas<font color="#000080">.</font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font>holdColor<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

--------------------------------------------------------------------------------
</font>This <font color="#FF0000"><b>uses </b></font>the DefaultDrawColumnCell method that <font color="#FF0000"><b>is </b></font>defined <font color="#FF0000"><b>with </b></font>the TCustomDBGrid component<font color="#000080">, </font><font color="#FF0000"><b>of </b></font>which TDBGrid <font color="#FF0000"><b>is </b></font>a child<font color="#000080">. </font>This turned each cell green <font color="#FF0000"><b>of </b></font>an employee whose emp no was odd<font color="#000080">. 
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0418.PAS">Original</a><b>]</b></p></body>
</html>
