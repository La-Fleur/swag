<html>
<head><title> "Determine Easter Date" by MARK LUSSIER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0214.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;
&gt; Has anyone an algorithm to determine moveable feasts - such as Easter -
&gt; which is calculated by the year? by any other method? 
  
Popular question this past 2 days. Here is our kcEaster function from our KingCalendar product. Just pass it the year and it will
return a TDateTime for Easter. Enjoy the code, it was a fun to write&lt;G&gt; 
  
function kcEaster( nYear: Integer ): TDateTime;
var
   nMonth, nDay, nMoon, nEpact, nSunday, nGold, nCent, nCorx, nCorz: Integer;
 begin
 
    { The Golden Number of the year in the 19 year Metonic Cycle }
    </i></font>nGold <font color="#000080">:= ( ( </font>nYear <font color="#FF0000"><b>mod </b></font><font color="#800000">19 </font><font color="#000080">) + </font><font color="#800000">1  </font><font color="#000080">);
 
    </font><font color="#008000"><i>{ Calculate the Century }
    </i></font>nCent <font color="#000080">:= ( ( </font>nYear <font color="#FF0000"><b>div </b></font><font color="#800000">100 </font><font color="#000080">) + </font><font color="#800000">1 </font><font color="#000080">);
 
    </font><font color="#008000"><i>{ No. of Years in which leap year was dropped in order to keep in step
      with the sun }
    </i></font>nCorx <font color="#000080">:= ( ( </font><font color="#800000">3 </font><font color="#000080">* </font>nCent <font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">4 </font><font color="#000080">- </font><font color="#800000">12 </font><font color="#000080">);

    </font><font color="#008000"><i>{ Special Correction to Syncronize Easter with the moon's orbit }
    </i></font>nCorz <font color="#000080">:= ( ( </font><font color="#800000">8 </font><font color="#000080">* </font>nCent <font color="#000080">+ </font><font color="#800000">5 </font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">25 </font><font color="#000080">- </font><font color="#800000">5 </font><font color="#000080">);
 
    </font><font color="#008000"><i>{ Find Sunday }
    </i></font>nSunday <font color="#000080">:= ( ( </font><font color="#800000">5 </font><font color="#000080">* </font>nYear <font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">4 </font><font color="#000080">- </font>nCorx <font color="#000080">- </font><font color="#800000">10 </font><font color="#000080">);
 
    </font><font color="#008000"><i>{ Set Epact (specifies occurance of full moon }
    </i></font>nEpact <font color="#000080">:= ( ( </font><font color="#800000">11 </font><font color="#000080">* </font>nGold <font color="#000080">+ </font><font color="#800000">20 </font><font color="#000080">+ </font>nCorz <font color="#000080">- </font>nCorx <font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">30 </font><font color="#000080">);
 
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>nEpact <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>then
       </b></font>nEpact <font color="#000080">:= </font>nEpact <font color="#000080">+ </font><font color="#800000">30</font><font color="#000080">;
 
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">( ( </font>nEpact <font color="#000080">= </font><font color="#800000">25 </font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>nGold <font color="#000080">&gt; </font><font color="#800000">11 </font><font color="#000080">) ) </font><font color="#FF0000"><b>or </b></font><font color="#000080">( </font>nEpact <font color="#000080">= </font><font color="#800000">24 </font><font color="#000080">) </font><font color="#FF0000"><b>then
       </b></font>nEpact <font color="#000080">:= </font>nEpact <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
 
    </font><font color="#008000"><i>{ Find Full Moon }
    </i></font>nMoon <font color="#000080">:= </font><font color="#800000">44 </font><font color="#000080">- </font>nEpact<font color="#000080">;
 
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>nMoon <font color="#000080">&lt; </font><font color="#800000">21 </font><font color="#000080">) </font><font color="#FF0000"><b>then
       </b></font>nMoon <font color="#000080">:= </font>nMoon <font color="#000080">+ </font><font color="#800000">30</font><font color="#000080">;
 
    </font><font color="#008000"><i>{ Advance to Sunday }
    </i></font>nMoon <font color="#000080">:= ( </font>nMoon <font color="#000080">+ </font><font color="#800000">7 </font><font color="#000080">- ( ( </font>nSunday <font color="#000080">+ </font>nMoon <font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">7 </font><font color="#000080">) );
 
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>nMoon <font color="#000080">&gt; </font><font color="#800000">31 </font><font color="#000080">) </font><font color="#FF0000"><b>then
       begin
         </b></font>nMonth <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
         </font>nDay   <font color="#000080">:= ( </font>nMoon <font color="#000080">- </font><font color="#800000">31 </font><font color="#000080">);
       </font><font color="#FF0000"><b>end
    else
       begin
         </b></font>nMonth <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
         </font>nDay   <font color="#000080">:= </font>nMoon<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>Result <font color="#000080">:= </font>EncodeDate<font color="#000080">( </font>nYear<font color="#000080">, </font>nMonth<font color="#000080">, </font>nDay <font color="#000080">);

 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0214.PAS">Original</a><b>]</b></p></body>
</html>
