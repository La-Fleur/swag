<html>
<head><title> "Design-time testing of CommonDialog comp" by BRAD STOWERS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0341.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{-----------------------------------------------------------------------------}
{ Design-time testing of TCommonDialog component descendants.                 }
{ Copyright 1996, Brad Stowers.  All Rights Reserved.                         }
{ This component can be freely used and distributed in commercial and private }
{ environments, provied this notice is not modified in any way and there is   }
{ no charge for it other than nomial handling fees.  Contact me directly for  }
{ modifications to this agreement.                                            }
{-----------------------------------------------------------------------------}
{ Feel free to contact me if you have any questions, comments or suggestions  }
{ at bstowers@pobox.com or 72733,3374 on CompuServe.                          }
{ The lateset version will always be available on the web at:                 }
{   http://www.pobox.com/~bstowers/delphi/                                    }
{-----------------------------------------------------------------------------}
{ Date last modified:  May 17, 1997                                           }
{-----------------------------------------------------------------------------}

{ ----------------------------------------------------------------------------}
{ TBrowseDirectory v1.02                                                      }
{ ----------------------------------------------------------------------------}
{ Description:                                                                }
{   A component editor that allows testing of the TCommonDialog descendants   }
{   at design time.  This allows you to set the varios options and then view  }
{   the results without having to compile and run your application.  The name }
{   &quot;Component Editor&quot; is a bit of a misnomer for this, but that's what it's  }
{   called.  We add a menu item, 'Test Dialog', to the context menu (right    }
{   click) the displays the dialog, and add the same functionality for double }
{   clicking on the component.  If the TCommonDialog class had a pure virtual }
{   method &quot;Execute&quot; that each descendant overrode like it should, this would }
{   be much easier.  Because Execute is not defined in the ancestor, we have  }
{   register for each component type we want to add this to instead of just   }
{   registering it for TCommonDialog.  Beginning object oriented programmers  }
{   learn from this:  Just because you can't see a need for it, doesn't mean  }
{   that there isn't one.                                                     }
{ ----------------------------------------------------------------------------}
{ Revision History:                                                           }
{ 1.00:  + Initial release                                                    }
{ 1.01:  + Changed 'AnsiString' to 'String'.  Will now compile with no        }
{          changes under Delphi 1.x.                                          }
{ 1.02:  + Updated for Delphi 3 compatibility.  If using with Delphi 3, the   }
{          &quot;Test&quot; item will now show up on all TCommonDialog descendant       }
{          components because Borland finally added an abstract Execute       }
{          method to it.                                                      }
{ ----------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>unit </b></font>DlgTest<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses </b></font>DsgnIntf<font color="#000080">, </font>Dialogs<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TCommonDialogEditor <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TDefaultEditor<font color="#000080">)
  </font><font color="#FF0000"><b>public
    procedure </b></font>ExecuteVerb<font color="#000080">(</font>Index <font color="#000080">: </font>Integer<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>GetVerb<font color="#000080">(</font>Index <font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>GetVerbCount <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Edit<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$IFDEF VER100}
  { Just redeclare it so we can get at the Execute method, which is protected. }
  </i></font>TMyCommonDialog <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TCommonDialog<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$IFDEF VER100}
</i></font><font color="#FF0000"><b>uses
  </b></font>ExtDlgs<font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}


</i></font><font color="#FF0000"><b>procedure </b></font>TCommonDialogEditor<font color="#000080">.</font>ExecuteVerb<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Index <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">; </font><font color="#008000"><i>{ We only have one verb, so exit if this ain't it }
  </i></font>Edit<font color="#000080">;  </font><font color="#008000"><i>{ Invoke the Edit function the same as if double click had happened }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TCommonDialogEditor<font color="#000080">.</font>GetVerb<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font><font color="#800000">'Test Dialog'</font><font color="#000080">;  </font><font color="#008000"><i>{ Menu item caption for context menu }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TCommonDialogEditor<font color="#000080">.</font>GetVerbCount<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TCommonDialogEditor<font color="#000080">.</font>Edit<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{$IFDEF VER100}
  </i></font><font color="#FF0000"><b>if </b></font>Component <font color="#FF0000"><b>is </b></font>TCommonDialog <font color="#FF0000"><b>then
    </b></font>TMyCommonDialog<font color="#000080">(</font>Component<font color="#000080">).</font>Execute
<font color="#008000"><i>{$ELSE}
  </i></font><font color="#FF0000"><b>if </b></font>Component <font color="#FF0000"><b>is </b></font>TColorDialog <font color="#FF0000"><b>then
    </b></font>TColorDialog<font color="#000080">(</font>Component<font color="#000080">).</font>Execute
  <font color="#FF0000"><b>else if </b></font>Component <font color="#FF0000"><b>is </b></font>TFindDialog <font color="#FF0000"><b>then
    </b></font>TFindDialog<font color="#000080">(</font>Component<font color="#000080">).</font>Execute
  <font color="#FF0000"><b>else if </b></font>Component <font color="#FF0000"><b>is </b></font>TReplaceDialog <font color="#FF0000"><b>then
    </b></font>TReplaceDialog<font color="#000080">(</font>Component<font color="#000080">).</font>Execute
  <font color="#FF0000"><b>else if </b></font>Component <font color="#FF0000"><b>is </b></font>TFontDialog <font color="#FF0000"><b>then
    </b></font>TFontDialog<font color="#000080">(</font>Component<font color="#000080">).</font>Execute
  <font color="#FF0000"><b>else if </b></font>Component <font color="#FF0000"><b>is </b></font>TOpenDialog <font color="#FF0000"><b>then
    </b></font>TOpenDialog<font color="#000080">(</font>Component<font color="#000080">).</font>Execute
  <font color="#FF0000"><b>else if </b></font>Component <font color="#FF0000"><b>is </b></font>TSaveDialog <font color="#FF0000"><b>then
    </b></font>TSaveDialog<font color="#000080">(</font>Component<font color="#000080">).</font>Execute
  <font color="#FF0000"><b>else if </b></font>Component <font color="#FF0000"><b>is </b></font>TPrintDialog <font color="#FF0000"><b>then
    </b></font>TPrintDialog<font color="#000080">(</font>Component<font color="#000080">).</font>Execute
  <font color="#FF0000"><b>else if </b></font>Component <font color="#FF0000"><b>is </b></font>TPrinterSetupDialog <font color="#FF0000"><b>then
    </b></font>TPrinterSetupDialog<font color="#000080">(</font>Component<font color="#000080">).</font>Execute<font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponentEditor<font color="#000080">(</font>TCommonDialog<font color="#000080">, </font>TCommonDialogEditor<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0341.PAS">Original</a><b>]</b></p></body>
</html>
