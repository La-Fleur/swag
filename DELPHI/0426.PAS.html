<html>
<head><title> "Using the Multi Select option of a DBGRI" by MIKE TANCSA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0426.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">mike<font color="#000080">@</font>sentex<font color="#000080">.</font>net <font color="#000080">(</font>Mike Tancsa<font color="#000080">)

</font>There <font color="#FF0000"><b>is </b></font>an example <font color="#FF0000"><b>in </b></font>the Delphi TIs<font color="#000080">... </font>Have a look at

http<font color="#000080">:</font><font color="#008000"><i>//loki.borland.com/winbin/bds.exe?getdoc+2976+Delphi 



</i></font><font color="#000080">--------------------------------------------------------------------------------


</font><font color="#008000"><i>{*
   This example iterates through the selected rows
   of the grid and displays the second field of
   the dataset.

   The Method DisableControls is used so that the
   DBGrid will not update when the dataset is changed.
   The last position of the dataset is saved as
   a TBookmark.

   The IndexOf method is called to check whether or
   not the bookmark is still existent.
   The decision of using the IndexOf method rather
   than the Refresh method should be determined by the
   specific application.
*}

</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>SelectClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>x<font color="#000080">: </font>word<font color="#000080">;
  </font>TempBookmark<font color="#000080">: </font>TBookMark<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DBGrid1<font color="#000080">.</font>Datasource<font color="#000080">.</font>Dataset<font color="#000080">.</font>DisableControls<font color="#000080">;
  </font><font color="#FF0000"><b>with </b></font>DBgrid1<font color="#000080">.</font>SelectedRows <font color="#FF0000"><b>do
  if </b></font>Count  <font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>TempBookmark<font color="#000080">:= </font>DBGrid1<font color="#000080">.</font>Datasource<font color="#000080">.</font>Dataset<font color="#000080">.</font>GetBookmark<font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>x<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Count <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      if </b></font>IndexOf<font color="#000080">(</font>Items<font color="#000080">[</font>x<font color="#000080">])  -</font><font color="#800000">1 </font><font color="#FF0000"><b>then
      begin
        </b></font>DBGrid1<font color="#000080">.</font>Datasource<font color="#000080">.</font>Dataset<font color="#000080">.</font>Bookmark<font color="#000080">:= </font>Items<font color="#000080">[</font>x<font color="#000080">];
        </font>showmessage<font color="#000080">(</font>DBGrid1<font color="#000080">.</font>Datasource<font color="#000080">.</font>Dataset<font color="#000080">.</font>Fields<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>AsString<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>DBGrid1<font color="#000080">.</font>Datasource<font color="#000080">.</font>Dataset<font color="#000080">.</font>GotoBookmark<font color="#000080">(</font>TempBookmark<font color="#000080">);
  </font>DBGrid1<font color="#000080">.</font>Datasource<font color="#000080">.</font>Dataset<font color="#000080">.</font>FreeBookmark<font color="#000080">(</font>TempBookmark<font color="#000080">);
  </font>DBGrid1<font color="#000080">.</font>Datasource<font color="#000080">.</font>Dataset<font color="#000080">.</font>EnableControls<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0426.PAS">Original</a><b>]</b></p></body>
</html>
