<html>
<head><title> "Adjust the speaker volume in code" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0165.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{******** unit1.pas  ********}
</i></font><font color="#FF0000"><b>unit </b></font>unit1<font color="#000080">;
</font><font color="#FF0000"><b>interface
uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">,
  </font>StdCtrls<font color="#000080">, </font>ExtCtrls<font color="#000080">, </font>FileCtrl<font color="#000080">, </font>MPlayer<font color="#000080">, </font>MMSystem<font color="#000080">, </font>Spin<font color="#000080">, </font>ComCtrls<font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font>MediaPlayer1<font color="#000080">: </font>TMediaPlayer<font color="#000080">;
    </font>DriveComboBox1<font color="#000080">: </font>TDriveComboBox<font color="#000080">;
    </font>DirectoryListBox1<font color="#000080">: </font>TDirectoryListBox<font color="#000080">;
    </font>FileListBox1<font color="#000080">: </font>TFileListBox<font color="#000080">;
    </font>Panel1<font color="#000080">: </font>TPanel<font color="#000080">;
    </font>CheckBox1<font color="#000080">: </font>TCheckBox<font color="#000080">;
    </font>GroupBox2<font color="#000080">: </font>TGroupBox<font color="#000080">;
    </font>TrackBar1<font color="#000080">: </font>TTrackBar<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>FileListBox1DblClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>FileListBox1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>MediaPlayer1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font>Button<font color="#000080">: </font>TMPBtnType<font color="#000080">;
      </font><font color="#FF0000"><b>var </b></font>DoDefault<font color="#000080">: </font>Boolean<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>MediaPlayer1Notify<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>FormDestroy<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>FormShow<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>TrackBar1Change<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>GetTrackBar<font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;
  </font>pCurrentVolumeLevel<font color="#000080">: </font>PDWord<font color="#000080">;
  </font>CurrentVolumeLevel<font color="#000080">: </font>DWord<font color="#000080">;
  </font>VolumeControlHandle<font color="#000080">: </font>hWnd<font color="#000080">;
</font><font color="#FF0000"><b>implementation
</b></font><font color="#008000"><i>{$R *.DFM}
</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FileListBox1DblClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>checkbox1<font color="#000080">.</font>checked <font color="#FF0000"><b>then
     </b></font>mediaplayer1<font color="#000080">.</font>DisplayRect <font color="#000080">:= </font>Rect<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">, </font>Panel1<font color="#000080">.</font>Width<font color="#000080">, </font>Panel1<font color="#000080">.</font>Height<font color="#000080">);
  </font>mediaplayer1<font color="#000080">.</font>play<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FileListBox1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>mediaplayer1<font color="#000080">.</font>filename <font color="#000080">:= </font>FileListBox1<font color="#000080">.</font>items<font color="#000080">[</font>filelistbox1<font color="#000080">.</font>itemindex<font color="#000080">];
  </font>mediaplayer1<font color="#000080">.</font>open<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>MediaPlayer1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font>Button<font color="#000080">: </font>TMPBtnType<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>DoDefault<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>begin
  case </b></font>Button <font color="#FF0000"><b>of
    </b></font>btPlay <font color="#000080">:
    </font><font color="#FF0000"><b>if </b></font>checkbox1<font color="#000080">.</font>checked <font color="#FF0000"><b>then
       </b></font>mediaplayer1<font color="#000080">.</font>DisplayRect <font color="#000080">:= </font>Rect<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">, </font>Panel1<font color="#000080">.</font>Width<font color="#000080">, </font>Panel1<font color="#000080">.</font>Height<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>DirectoryListBox1<font color="#000080">.</font>Directory <font color="#000080">:= </font><font color="#800000">'d:\sound'</font><font color="#000080">;
  </font>mediaplayer1<font color="#000080">.</font>notify <font color="#000080">:= </font>true<font color="#000080">;
  </font>New<font color="#000080">(</font>pCurrentVolumeLevel<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>MediaPlayer1Notify<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Panel1<font color="#000080">.</font>refresh<font color="#000080">;
  </font><font color="#FF0000"><b>with </b></font>Mediaplayer1 <font color="#FF0000"><b>do
    if </b></font>NotifyValue <font color="#000080">= </font>nvAborted <font color="#FF0000"><b>then begin
       </b></font>filename <font color="#000080">:= </font>FileListBox1<font color="#000080">.</font>items<font color="#000080">[</font>filelistbox1<font color="#000080">.</font>itemindex<font color="#000080">];
       </font>open<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormDestroy<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>dispose<font color="#000080">(</font>pCurrentVolumeLevel<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>TForm1<font color="#000080">.</font>GetTrackBar<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result <font color="#000080">:= </font><font color="#800000">65535 </font><font color="#FF0000"><b>div </b></font>Trackbar1<font color="#000080">.</font>max<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormShow<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>VolumeControlHandle <font color="#000080">:= </font>FindWindow<font color="#000080">(</font><font color="#800000">'Volume Control'</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
  </font>WaveOutGetVolume<font color="#000080">(</font>VolumeControlHandle<font color="#000080">, </font>pCurrentVolumeLevel<font color="#000080">);
  </font>CurrentVolumeLevel <font color="#000080">:= </font>pCurrentVolumeLevel<font color="#000080">^;
  </font>Trackbar1<font color="#000080">.</font>position <font color="#000080">:= </font>LoWord<font color="#000080">(</font>CurrentVolumeLevel<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font>GetTrackBar<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>TrackBar1Change<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>CurrentVolumeLevel <font color="#000080">:= </font>Trackbar1<font color="#000080">.</font>position <font color="#000080">* </font>GetTrackBar <font color="#FF0000"><b>shl </b></font><font color="#800000">16</font><font color="#000080">;
  </font>CurrentVolumeLevel <font color="#000080">:= </font>CurrentVolumeLevel <font color="#000080">+ (</font>Trackbar1<font color="#000080">.</font>position <font color="#000080">* </font>GetTrackBar<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>WaveOutSetVolume<font color="#000080">(</font>VolumeControlHandle<font color="#000080">, </font>CurrentVolumeLevel<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>ShowMessage<font color="#000080">(</font><font color="#800000">'Cannot adjust Volume.'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#008000"><i>{********** unit1.dfm  *********}
</i></font><font color="#FF0000"><b>object </b></font>Form1<font color="#000080">: </font>TForm1
  Left <font color="#000080">= </font><font color="#800000">202
  </font>Top <font color="#000080">= </font><font color="#800000">109
  </font>Width <font color="#000080">= </font><font color="#800000">402
  </font>Height <font color="#000080">= </font><font color="#800000">321
  </font>ActiveControl <font color="#000080">= </font>DriveComboBox1
  BorderIcons <font color="#000080">= [</font>biSystemMenu<font color="#000080">]
  </font>Caption <font color="#000080">= </font><font color="#800000">'Mediaplayer Example - Created using Delphi 2.0'
  </font>Font<font color="#000080">.</font>Color <font color="#000080">= </font>clWindowText
  Font<font color="#000080">.</font>Height <font color="#000080">= -</font><font color="#800000">11
  </font>Font<font color="#000080">.</font>Name <font color="#000080">= </font><font color="#800000">'MS Sans Serif'
  </font>Font<font color="#000080">.</font>Style <font color="#000080">= []
  </font>Icon<font color="#000080">.</font>Data <font color="#000080">= </font><font color="#008000"><i>{
    0000010001002020100000000000E80200001600000028000000200000004000
    0000010004000000000080020000000000000000000000000000000000000000
    0000000080000080000000808000800000008000800080800000C0C0C0008080
    80000000FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF008888
    888888888888888888888888888888888888888888880000FEEFEFF000088888
    8888888888880000FEEFEFF0000888888888888888880770EFFEFEE070088888
    8888888888880000FEEFEFF00008888888888888888807700000000070088888
    888888888888077000000000700888888888888888880000FFFFFFF000088888
    8888888888880770EFFEFEE0700888888888888888880000FEEFEFF000088888
    8888888888880000FEEFEFF0000888888888888888880770EFFEFEE070088888
    888888888888000000000000000888808888888888880770FFFFFFF070088880
    8888888888880770FFFFFFF0700880000888888088880000FEEFEFF000088880
    0008800008880770EFFEFEE0700888888008888000080000FEEFEFF000088888
    8008888000080000FEEFEFF00008888880088888800807700000000070088888
    8008888880080000FFFFFFF0000888888008888880080770EFFEFEE070088888
    8008888880080770EFFEFEE0700888888008888880080000FEEFEFF000088888
    8008888880088888888888888888888880000000000888888888888888888888
    8000000000088888888888888888888880033333300888888888888888888888
    8000000000088888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888880000
    0000000000000000000000000000000000000000000000000000000000000000
    0000000000000000000000000000000000000000000000000000000000000000
    0000000000000000000000000000000000000000000000000000000000000000
    000000000000000000000000000000000000000000000000000000000000}
  </i></font>OnCreate <font color="#000080">= </font>FormCreate
  OnDestroy <font color="#000080">= </font>FormDestroy
  OnShow <font color="#000080">= </font>FormShow
  PixelsPerInch <font color="#000080">= </font><font color="#800000">96
  </font>TextHeight <font color="#000080">= </font><font color="#800000">13
  </font><font color="#FF0000"><b>object </b></font>MediaPlayer1<font color="#000080">: </font>TMediaPlayer
    Left <font color="#000080">= </font><font color="#800000">152
    </font>Top <font color="#000080">= </font><font color="#800000">240
    </font>Width <font color="#000080">= </font><font color="#800000">141
    </font>Height <font color="#000080">= </font><font color="#800000">33
    </font>VisibleButtons <font color="#000080">= [</font>btPlay<font color="#000080">, </font>btPause<font color="#000080">, </font>btStop<font color="#000080">, </font>btPrev<font color="#000080">, </font>btBack<font color="#000080">]
    </font>Display <font color="#000080">= </font>Panel1
    ParentShowHint <font color="#000080">= </font>False
    ShowHint <font color="#000080">= </font>True
    TabOrder <font color="#000080">= </font><font color="#800000">0
    </font>OnClick <font color="#000080">= </font>MediaPlayer1Click
    OnNotify <font color="#000080">= </font>MediaPlayer1Notify
  <font color="#FF0000"><b>end
  object </b></font>DriveComboBox1<font color="#000080">: </font>TDriveComboBox
    Left <font color="#000080">= </font><font color="#800000">0
    </font>Top <font color="#000080">= </font><font color="#800000">0
    </font>Width <font color="#000080">= </font><font color="#800000">145
    </font>Height <font color="#000080">= </font><font color="#800000">19
    </font>DirList <font color="#000080">= </font>DirectoryListBox1
    TabOrder <font color="#000080">= </font><font color="#800000">1
  </font><font color="#FF0000"><b>end
  object </b></font>DirectoryListBox1<font color="#000080">: </font>TDirectoryListBox
    Left <font color="#000080">= </font><font color="#800000">0
    </font>Top <font color="#000080">= </font><font color="#800000">22
    </font>Width <font color="#000080">= </font><font color="#800000">145
    </font>Height <font color="#000080">= </font><font color="#800000">114
    </font>FileList <font color="#000080">= </font>FileListBox1
    ItemHeight <font color="#000080">= </font><font color="#800000">16
    </font>TabOrder <font color="#000080">= </font><font color="#800000">2
  </font><font color="#FF0000"><b>end
  object </b></font>FileListBox1<font color="#000080">: </font>TFileListBox
    Left <font color="#000080">= </font><font color="#800000">0
    </font>Top <font color="#000080">= </font><font color="#800000">139
    </font>Width <font color="#000080">= </font><font color="#800000">145
    </font>Height <font color="#000080">= </font><font color="#800000">141
    </font>ItemHeight <font color="#000080">= </font><font color="#800000">13
    </font>Mask <font color="#000080">= </font><font color="#800000">'*.wav;*.avi'
    </font>MultiSelect <font color="#000080">= </font>True
    TabOrder <font color="#000080">= </font><font color="#800000">3
    </font>OnClick <font color="#000080">= </font>FileListBox1Click
    OnDblClick <font color="#000080">= </font>FileListBox1DblClick
  <font color="#FF0000"><b>end
  object </b></font>Panel1<font color="#000080">: </font>TPanel
    Left <font color="#000080">= </font><font color="#800000">152
    </font>Top <font color="#000080">= </font><font color="#800000">8
    </font>Width <font color="#000080">= </font><font color="#800000">241
    </font>Height <font color="#000080">= </font><font color="#800000">225
    </font>TabOrder <font color="#000080">= </font><font color="#800000">4
  </font><font color="#FF0000"><b>end
  object </b></font>CheckBox1<font color="#000080">: </font>TCheckBox
    Left <font color="#000080">= </font><font color="#800000">218
    </font>Top <font color="#000080">= </font><font color="#800000">275
    </font>Width <font color="#000080">= </font><font color="#800000">76
    </font>Height <font color="#000080">= </font><font color="#800000">17
    </font>Caption <font color="#000080">= </font><font color="#800000">'Stretch AVI'
    </font>State <font color="#000080">= </font>cbChecked
    TabOrder <font color="#000080">= </font><font color="#800000">5
  </font><font color="#FF0000"><b>end
  object </b></font>GroupBox2<font color="#000080">: </font>TGroupBox
    Left <font color="#000080">= </font><font color="#800000">296
    </font>Top <font color="#000080">= </font><font color="#800000">234
    </font>Width <font color="#000080">= </font><font color="#800000">97
    </font>Height <font color="#000080">= </font><font color="#800000">53
    </font>Caption <font color="#000080">= </font><font color="#800000">'Volume'
    </font>TabOrder <font color="#000080">= </font><font color="#800000">6
    </font><font color="#FF0000"><b>object </b></font>TrackBar1<font color="#000080">: </font>TTrackBar
      Left <font color="#000080">= </font><font color="#800000">2
      </font>Top <font color="#000080">= </font><font color="#800000">11
      </font>Width <font color="#000080">= </font><font color="#800000">93
      </font>Height <font color="#000080">= </font><font color="#800000">34
      </font>Max <font color="#000080">= </font><font color="#800000">26
      </font>Orientation <font color="#000080">= </font>trHorizontal
      ParentShowHint <font color="#000080">= </font>False
      Frequency <font color="#000080">= </font><font color="#800000">1
      </font>Position <font color="#000080">= </font><font color="#800000">0
      </font>SelEnd <font color="#000080">= </font><font color="#800000">0
      </font>SelStart <font color="#000080">= </font><font color="#800000">0
      </font>ShowHint <font color="#000080">= </font>True
      TabOrder <font color="#000080">= </font><font color="#800000">0
      </font>TickMarks <font color="#000080">= </font>tmBoth
      TickStyle <font color="#000080">= </font>tsAuto
      OnChange <font color="#000080">= </font>TrackBar1Change
    <font color="#FF0000"><b>end
  end
end
</b></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0165.PAS">Original</a><b>]</b></p></body>
</html>
