<html>
<head><title> "Encrypt" by ANATOLY PODGORETSKY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0342.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>Crypt32<font color="#000080">;
</font><font color="#008000"><i>{
*************************************************************************
* Name:		Crypt32.Pas				  		*
* Description:	32 bits encode/decode module			  	*
*	        2^96 variants it is very high to try hack		*
* Purpose:  	Good for encrypting passwors and text			*
* Security: 	avoid use StartKey less than 256			*
*		if it use only for internal use you may use default 	*
*		key, but MODIFY unit before compiling			*
* Call:		Encrypted := Encrypt(InString,StartKey,MultKey,AddKey)	*
*		Decrypted := Decrypt(InString,StartKey)		  	*
* Parameters:	InString  = long string (max 2 GB) that need to encrypt	*
*		decrypt	  						*
*		MultKey		= MultKey key				*
*		AddKey		= Second key		        	*
*		StartKey	= Third key				*
*		(posible use defaults from interface)			*
* Return:	OutString	= result string				*
* Editor:	Besr viewed with Tab stops = 2, Courier new		*
* Started:	01.08.1996						*
* Revision:	22.05.1997 - ver.2.01 converted from Delphi 1		*
*		and made all keys as parameters, before only start key	*
* Platform:	Delphi 2.0, 3.0 				  	*
* 		work in Delphi 1.0, 2^48 variants, 0..255 strings	*
* Author:	Anatoly Podgoretsky				  	*
* 		Base alghoritm from Borland				*
* Address:	Vahe 4-31, Johvi, Estonia, EE2045, tel. 61-142    	*
*		kvk@estpak.ee					  	*
* Status:	Freeware, but any sponsor help will be appreciated here	*
*		need to buy books, shareware products, tools etc	*
*************************************************************************
* Modified:     Supports Delphi 1.0 &amp; 2.0                         	*
*               Overflow checking removed                         	*
* By:           Martin Djern&aelig;s                                    	*
* e-mail:       djernaes@einstein.ot.dk                           	*
* web:          einstein.ot.dk/~djernaes                          	*
*************************************************************************
}
</i></font><font color="#FF0000"><b>interface

const
  </b></font>StartKey	<font color="#000080">= </font><font color="#800000">981</font><font color="#000080">;</font>  	<font color="#008000"><i>{Start default key}
  </i></font>MultKey	  <font color="#000080">= </font><font color="#800000">12674</font><font color="#000080">;</font>	<font color="#008000"><i>{Mult default key}
  </i></font>AddKey	  <font color="#000080">= </font><font color="#800000">35891</font><font color="#000080">;</font>	<font color="#008000"><i>{Add default key}

</i></font><font color="#FF0000"><b>function </b></font>Encrypt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>InString<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartKey<font color="#000080">,</font>MultKey<font color="#000080">,</font>AddKey<font color="#000080">:</font>Integer<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>Decrypt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>InString<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartKey<font color="#000080">,</font>MultKey<font color="#000080">,</font>AddKey<font color="#000080">:</font>Integer<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R-}
{$Q-}
{*******************************************************
 * Standard Encryption algorithm - Copied from Borland *
 *******************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Encrypt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>InString<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartKey<font color="#000080">,</font>MultKey<font color="#000080">,</font>AddKey<font color="#000080">:</font>Integer<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>I <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>InString<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>Result <font color="#000080">:= </font>Result <font color="#000080">+ </font>CHAR<font color="#000080">(</font>Byte<font color="#000080">(</font>InString<font color="#000080">[</font>I<font color="#000080">]) </font><font color="#FF0000"><b>xor </b></font><font color="#000080">(</font>StartKey <font color="#FF0000"><b>shr </b></font><font color="#800000">8</font><font color="#000080">));
    </font>StartKey <font color="#000080">:= (</font>Byte<font color="#000080">(</font>Result<font color="#000080">[</font>I<font color="#000080">]) + </font>StartKey<font color="#000080">) * </font>MultKey <font color="#000080">+ </font>AddKey<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{*******************************************************
 * Standard Decryption algorithm - Copied from Borland *
 *******************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Decrypt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>InString<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartKey<font color="#000080">,</font>MultKey<font color="#000080">,</font>AddKey<font color="#000080">:</font>Integer<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>I <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>InString<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>Result <font color="#000080">:= </font>Result <font color="#000080">+ </font>CHAR<font color="#000080">(</font>Byte<font color="#000080">(</font>InString<font color="#000080">[</font>I<font color="#000080">]) </font><font color="#FF0000"><b>xor </b></font><font color="#000080">(</font>StartKey <font color="#FF0000"><b>shr </b></font><font color="#800000">8</font><font color="#000080">));
    </font>StartKey <font color="#000080">:= (</font>Byte<font color="#000080">(</font>InString<font color="#000080">[</font>I<font color="#000080">]) + </font>StartKey<font color="#000080">) * </font>MultKey <font color="#000080">+ </font>AddKey<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$R+}
{$Q+}

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0342.PAS">Original</a><b>]</b></p></body>
</html>
