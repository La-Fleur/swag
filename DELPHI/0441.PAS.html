<html>
<head><title> "Setting time system with Delphi" by ABEL DU PLESSIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0441.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">abeldup<font color="#000080">@</font>unison<font color="#000080">.</font>co<font color="#000080">.</font>za <font color="#000080">(</font>Abel du Plessis<font color="#000080">)

&quot;</font>Vitor Martins<font color="#000080">&quot; &lt;</font>nop47019<font color="#000080">@</font>mail<font color="#000080">.</font>telecom<font color="#000080">.</font>pt wrote<font color="#000080">:


</font>How can I <font color="#FF0000"><b>set </b></font>the clock system time <font color="#FF0000"><b>and </b></font>date <font color="#FF0000"><b>in </b></font>a <font color="#FF0000"><b>program  with </b></font>Delphi <font color="#800000">2.0
</font><font color="#FF0000"><b>in </b></font>Win <font color="#800000">95
</font>This works <font color="#FF0000"><b>for </b></font>us<font color="#000080">:


--------------------------------------------------------------------------------

</font><font color="#008000"><i>//******************************************************************************
//Public function SetPCSystemTime changes the system date and time.
//Parameter(s): tDati  The new date and time
//Returns:      True if successful
//              False if not
//******************************************************************************
</i></font><font color="#FF0000"><b>function </b></font>SetPCSystemTime<font color="#000080">(</font>tDati<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>tSetDati<font color="#000080">: </font>TDateTime<font color="#000080">;
   </font>vDatiBias<font color="#000080">: </font>Variant<font color="#000080">;
   </font>tTZI<font color="#000080">: </font>TTimeZoneInformation<font color="#000080">;
   </font>tST<font color="#000080">: </font>TSystemTime<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>GetTimeZoneInformation<font color="#000080">(</font>tTZI<font color="#000080">);
   </font>vDatiBias <font color="#000080">:= </font>tTZI<font color="#000080">.</font>Bias <font color="#000080">/ </font><font color="#800000">1440</font><font color="#000080">;
   </font>tSetDati <font color="#000080">:= </font>tDati <font color="#000080">+ </font>vDatiBias<font color="#000080">;
   </font><font color="#FF0000"><b>with </b></font>tST <font color="#FF0000"><b>do
   begin
        </b></font>wYear <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>FormatDateTime<font color="#000080">(</font><font color="#800000">'yyyy'</font><font color="#000080">, </font>tSetDati<font color="#000080">));
        </font>wMonth <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>FormatDateTime<font color="#000080">(</font><font color="#800000">'mm'</font><font color="#000080">, </font>tSetDati<font color="#000080">));
        </font>wDay <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>FormatDateTime<font color="#000080">(</font><font color="#800000">'dd'</font><font color="#000080">, </font>tSetDati<font color="#000080">));
        </font>wHour <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>FormatDateTime<font color="#000080">(</font><font color="#800000">'hh'</font><font color="#000080">, </font>tSetDati<font color="#000080">));
        </font>wMinute <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>FormatDateTime<font color="#000080">(</font><font color="#800000">'nn'</font><font color="#000080">, </font>tSetDati<font color="#000080">));
        </font>wSecond <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>FormatDateTime<font color="#000080">(</font><font color="#800000">'ss'</font><font color="#000080">, </font>tSetDati<font color="#000080">));
        </font>wMilliseconds <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>SetPCSystemTime <font color="#000080">:= </font>SetSystemTime<font color="#000080">(</font>tST<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0441.PAS">Original</a><b>]</b></p></body>
</html>
