<html>
<head><title> "CGI handler with demo" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0358.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ NOTE THE Sample DEMO is included in XX34 format at the end }
</i></font><font color="#FF0000"><b>unit </b></font>cgi_h<font color="#000080">;

</font><font color="#FF0000"><b>interface
uses </b></font>classes<font color="#000080">;

</font><font color="#008000"><i>{intitialize and cleanup procedures}
</i></font><font color="#FF0000"><b>procedure </b></font>InitializeCGI<font color="#000080">;
          </font><font color="#008000"><i>{call this at the beginning of the program, it reads in and separates}
          {all the Form variables to allow easy calling from the functions}
</i></font><font color="#FF0000"><b>procedure </b></font>freeCGI<font color="#000080">;
          </font><font color="#008000"><i>{call this at end of program to free the string list containing}
          {the form input}

{output special HTML codes easily}
</i></font><font color="#FF0000"><b>procedure </b></font>writeHTMLHeader<font color="#000080">;
          </font><font color="#008000"><i>{writes out the header for an HTML document}
</i></font><font color="#FF0000"><b>function </b></font>sendFile<font color="#000080">(</font>fileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
          </font><font color="#008000"><i>{sends a file to the server for output}
</i></font><font color="#FF0000"><b>function </b></font>sendFileBinary<font color="#000080">(</font>fileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
          </font><font color="#008000"><i>{sends a binary file to the server for output}
</i></font><font color="#FF0000"><b>function </b></font>sendFileBinary2<font color="#000080">( </font>fileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>boolean<font color="#000080">;
           </font><font color="#008000"><i>{same but sends length header}
</i></font><font color="#FF0000"><b>procedure </b></font>br<font color="#000080">;
          </font><font color="#008000"><i>{writes a &lt;BR&gt; code}
</i></font><font color="#FF0000"><b>procedure </b></font>hr<font color="#000080">;
          </font><font color="#008000"><i>{writes an &lt;HR&gt; code}
</i></font><font color="#FF0000"><b>function </b></font>HRef<font color="#000080">(</font>location<font color="#000080">, </font>text<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
         </font><font color="#008000"><i>{returns a string containing the link to [location] around [text]}
</i></font><font color="#FF0000"><b>function </b></font>Image<font color="#000080">(</font>location<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
         </font><font color="#008000"><i>{returns a string containing a reference to image at [location]}


{retrieve and output Form variables}
</i></font><font color="#FF0000"><b>procedure </b></font>outputList<font color="#000080">;
          </font><font color="#008000"><i>{Outputs the list of form variables, one per line}
</i></font><font color="#FF0000"><b>procedure </b></font>outputListToFile<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
          </font><font color="#008000"><i>{Outputs all variables to an HTML file for easy reading}
          {Used for guestbooks.  It appends if fileExists}
</i></font><font color="#FF0000"><b>function </b></font>getInputVar<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
         </font><font color="#008000"><i>{return the value of the input variable}
</i></font><font color="#FF0000"><b>function </b></font>getAsField<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
         </font><font color="#008000"><i>{returns the value of the input variable with Field codes}
         {this one works when the Field name is the same as the Form variable}
</i></font><font color="#FF0000"><b>function </b></font>getAsFieldName<font color="#000080">(</font>s<font color="#000080">,</font>f<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
         </font><font color="#008000"><i>{similar to getAsField, except, this allows you to specify a different
         name for the field}
</i></font><font color="#FF0000"><b>function </b></font>getRemoteHost<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>getRemoteIP<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>getCookie<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>WinExecuteWait<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;


</font><font color="#008000"><i>{string manipulations}
</i></font><font color="#FF0000"><b>procedure </b></font>findRepl<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>f<font color="#000080">,</font>r<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
          </font><font color="#008000"><i>{finds and replaces substrings in a string}
</i></font><font color="#FF0000"><b>function </b></font>EncodeURL<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
         </font><font color="#008000"><i>{puts the hex equivolent in for special characters}
         {(opposite of decodeFormInfo)}
</i></font><font color="#FF0000"><b>function </b></font>DecodeFormInfo<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
         </font><font color="#008000"><i>{Convert Form Info to regular text (remove Special Character Codes}


{Internally used functions...but you could use them if you know how}
</i></font><font color="#FF0000"><b>function </b></font>getRequestMethod<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#008000"><i>{gets the request method (POST or GET)}
</i></font><font color="#FF0000"><b>function </b></font>decodeHEXChr<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>char<font color="#000080">;
         </font><font color="#008000"><i>{Converts a two digit Hex number to it's character equivolent}
</i></font><font color="#FF0000"><b>function </b></font>getContentLength<font color="#000080">:</font>integer<font color="#000080">;
         </font><font color="#008000"><i>{Returns the length of the Form Info}
</i></font><font color="#FF0000"><b>procedure </b></font>retrieveInput<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
          </font><font color="#008000"><i>{Pulls in all Form variables}
</i></font><font color="#FF0000"><b>procedure </b></font>separateInput<font color="#000080">( </font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
          </font><font color="#008000"><i>{Separates the Form variables and put in string list}


</i></font><font color="#FF0000"><b>implementation
uses </b></font>windows<font color="#000080">,</font>sysUtils<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>ValidURLChars<font color="#000080">:</font><font color="#FF0000"><b>set of </b></font>char<font color="#000080">=[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">,</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">,</font><font color="#800000">'~'</font><font color="#000080">,</font><font color="#800000">'_'</font><font color="#000080">,</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">];
  </font>alreadyRetrieved<font color="#000080">:</font>boolean<font color="#000080">=</font>false<font color="#000080">;
  </font>clOpen<font color="#000080">:</font>boolean<font color="#000080">=</font>false<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>cl<font color="#000080">:</font>TStringList<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>writeHTMLHeader<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'Content-type:  text/html'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>writeHTMLHeaderCookie<font color="#000080">(</font>n<font color="#000080">,</font>v<font color="#000080">,</font>d<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'Content-type:  text/html'</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>d<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'Set-cookie: '</font><font color="#000080">+</font>n<font color="#000080">+</font><font color="#800000">'='</font><font color="#000080">+</font>v<font color="#000080">+</font><font color="#800000">'; domain='</font><font color="#000080">+</font>d<font color="#000080">)
  </font><font color="#FF0000"><b>else
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'Set-cookie: '</font><font color="#000080">+</font>n<font color="#000080">+</font><font color="#800000">'='</font><font color="#000080">+</font>v<font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>fr<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>f<font color="#000080">,</font>r<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">:</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  while </b></font>pos<font color="#000080">(</font>f<font color="#000080">,</font>s<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do begin
     </b></font>x<font color="#000080">:=</font>pos<font color="#000080">(</font>f<font color="#000080">,</font>s<font color="#000080">);
     </font>delete<font color="#000080">(</font>s<font color="#000080">,</font>x<font color="#000080">,</font>length<font color="#000080">(</font>f<font color="#000080">));
     </font>insert<font color="#000080">(</font>r<font color="#000080">,</font>s<font color="#000080">,</font>x<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>findRepl<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>f<font color="#000080">,</font>r<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>fr<font color="#000080">(</font>s<font color="#000080">,</font>f<font color="#000080">,</font><font color="#800000">#25</font><font color="#000080">);
 </font>fr<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">#25</font><font color="#000080">,</font>r<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>br<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'&lt;BR&gt;'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>hr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'&lt;HR&gt;'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>HexDigit<font color="#000080">(</font>c<font color="#000080">:</font>char<font color="#000080">):</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>c<font color="#000080">:=</font>upcase<font color="#000080">(</font>c<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>c<font color="#000080">&gt;=</font><font color="#800000">'0'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c<font color="#000080">&lt;=</font><font color="#800000">'9'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>result<font color="#000080">:=</font>ord<font color="#000080">(</font>c<font color="#000080">)-</font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>c<font color="#000080">&gt;=</font><font color="#800000">'A'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c<font color="#000080">&lt;=</font><font color="#800000">'F'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>result<font color="#000080">:=</font>ord<font color="#000080">(</font>c<font color="#000080">)-</font>ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)+</font><font color="#800000">10</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>freeCGI<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>clOpen<font color="#000080">:=</font>false<font color="#000080">;
  </font>cl<font color="#000080">.</font>free<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>InitializeCGI<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>cl<font color="#000080">:=</font>tStringList<font color="#000080">.</font>create<font color="#000080">;
   </font>clOpen<font color="#000080">:=</font>true<font color="#000080">;
   </font>retrieveInput<font color="#000080">(</font>s<font color="#000080">);
   </font>SeparateInput<font color="#000080">(</font>s<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>decodeHEXChr<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>char<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>x<font color="#000080">:=</font><font color="#800000">16</font><font color="#000080">*</font>hexDigit<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">])+</font>hexDigit<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
  </font>result<font color="#000080">:=</font>chr<font color="#000080">(</font>x<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>EncodeURL<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>integer<font color="#000080">;
    </font>c<font color="#000080">:</font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>i<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>findRepl<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">'!'</font><font color="#000080">,</font><font color="#800000">'!21'</font><font color="#000080">);
   </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i<font color="#000080">&lt;=</font>length<font color="#000080">(</font>s<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i<font color="#000080">&lt;</font><font color="#800000">2000</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
       if </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font><font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>validURLChars<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]&lt;&gt;</font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]&lt;&gt;</font><font color="#800000">'!'</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
          </b></font>c<font color="#000080">:=</font>s<font color="#000080">[</font>i<font color="#000080">];
          </font>findRepl<font color="#000080">(</font>s<font color="#000080">,</font>c<font color="#000080">,</font><font color="#800000">'!'</font><font color="#000080">+</font>intToHex<font color="#000080">(</font>ord<font color="#000080">(</font>c<font color="#000080">),</font><font color="#800000">2</font><font color="#000080">));
          </font>i<font color="#000080">:=</font>i<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>i<font color="#000080">:=</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>findRepl<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">'+'</font><font color="#000080">);
   </font>result<font color="#000080">:=</font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DecodeFormInfo<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>findRepl<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">'+'</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
   </font>findRepl<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">'!'</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
   </font><font color="#FF0000"><b>while </b></font>length<font color="#000080">(</font>s<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do begin
         if </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'%' </font><font color="#FF0000"><b>then begin
             </b></font>delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
             </font><font color="#FF0000"><b>if </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'%' </font><font color="#FF0000"><b>then begin
                 </b></font>result<font color="#000080">:=</font>result<font color="#000080">+</font><font color="#800000">'%'</font><font color="#000080">;
                 </font>delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
             </font><font color="#FF0000"><b>end else begin
                 </b></font>result<font color="#000080">:=</font>result<font color="#000080">+</font>decodeHEXChr<font color="#000080">(</font>copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
                 </font>delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>end else begin
             </b></font>result<font color="#000080">:=</font>result<font color="#000080">+</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
             </font>delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>getRemoteHost<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>PC<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>getEnvironmentVariable<font color="#000080">(</font><font color="#800000">'REMOTE_HOST'</font><font color="#000080">,</font>PC<font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);
   </font>Result<font color="#000080">:=</font>StrPas<font color="#000080">(</font>pc<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>getRemoteIP<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>PC<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>getEnvironmentVariable<font color="#000080">(</font><font color="#800000">'REMOTE_ADDR'</font><font color="#000080">,</font>PC<font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);
   </font>Result<font color="#000080">:=</font>StrPas<font color="#000080">(</font>pc<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>getCookie<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>PC<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1023</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
   </font>x<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>getEnvironmentVariable<font color="#000080">(</font><font color="#800000">'HTTP_COOKIE'</font><font color="#000080">,</font>PC<font color="#000080">,</font><font color="#800000">1023</font><font color="#000080">);
   </font>Result<font color="#000080">:=</font>StrPas<font color="#000080">(</font>pc<font color="#000080">);
   </font>x<font color="#000080">:=</font>pos<font color="#000080">(</font>uppercase<font color="#000080">(</font>s<font color="#000080">),</font>uppercase<font color="#000080">(</font>result<font color="#000080">));
   </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
      </font>exit<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  
   </font>delete<font color="#000080">(</font>result<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>x<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">+</font>length<font color="#000080">(</font>s<font color="#000080">));
   </font>x<font color="#000080">:=</font>pos<font color="#000080">(</font><font color="#800000">';'</font><font color="#000080">,</font>result<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>delete<font color="#000080">(</font>result<font color="#000080">,</font>x<font color="#000080">,</font>length<font color="#000080">(</font>result<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;




</font><font color="#FF0000"><b>function </b></font>getContentLength<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>PC<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>Content_Length<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>x<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>result<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>getEnvironmentVariable<font color="#000080">(</font><font color="#800000">'CONTENT_LENGTH'</font><font color="#000080">,</font>PC<font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);
   </font>Content_Length<font color="#000080">:=</font>StrPas<font color="#000080">(</font>pc<font color="#000080">);
   </font>val<font color="#000080">(</font>Content_Length<font color="#000080">,</font>result<font color="#000080">,</font>x<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>getRequestMethod<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>PC<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>getEnvironmentVariable<font color="#000080">(</font><font color="#800000">'REQUEST_METHOD'</font><font color="#000080">,</font>PC<font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);
   </font>Result<font color="#000080">:=</font>StrPas<font color="#000080">(</font>pc<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>getQueryString<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>PC<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1023</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>getEnvironmentVariable<font color="#000080">(</font><font color="#800000">'QUERY_STRING'</font><font color="#000080">,</font>PC<font color="#000080">,</font><font color="#800000">1024</font><font color="#000080">);
   </font>Result<font color="#000080">:=</font>StrPas<font color="#000080">(</font>pc<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>procedure </b></font>retrieveInput<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:</font>char<font color="#000080">;
    </font>i<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>s<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>if </b></font>alreadyRetrieved <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
</font>alreadyRetrieved<font color="#000080">:=</font>true<font color="#000080">;
</font><font color="#FF0000"><b>if </b></font>getRequestMethod<font color="#000080">=</font><font color="#800000">'POST' </font><font color="#FF0000"><b>then
for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>getContentLength <font color="#FF0000"><b>do begin
    </b></font>read<font color="#000080">(</font>c<font color="#000080">);
    </font>s<font color="#000080">:=</font>s<font color="#000080">+</font>c<font color="#000080">;
</font><font color="#FF0000"><b>end
else
  </b></font>s<font color="#000080">:=</font>getQueryString<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>separateInput<font color="#000080">( </font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
   if not </b></font>clOpen <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
   </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>length<font color="#000080">(</font>s<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
      if </b></font>pos<font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">,</font>s<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
         </b></font>cl<font color="#000080">.</font>add<font color="#000080">(</font>copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">,</font>s<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));
         </font>delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">,</font>s<font color="#000080">));
      </font><font color="#FF0000"><b>end else begin
         </b></font>cl<font color="#000080">.</font>add<font color="#000080">(</font>s<font color="#000080">);
         </font>s<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>outputList<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   if not </b></font>clOpen <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>cl<font color="#000080">.</font>count<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
     </b></font>writeln<font color="#000080">(</font>decodeFormInfo<font color="#000080">(</font>cl<font color="#000080">.</font>strings<font color="#000080">[</font>i<font color="#000080">])+</font><font color="#800000">'&lt;BR&gt;'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>outputListToFile<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>integer<font color="#000080">;
    </font>f<font color="#000080">:</font>textFile<font color="#000080">;
</font><font color="#FF0000"><b>begin
   if not </b></font>clOpen <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>s<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
   </font>assignFile<font color="#000080">(</font>f<font color="#000080">,</font>s<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>fileExists<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>append<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>rewrite<font color="#000080">(</font>f<font color="#000080">);
   </font><font color="#FF0000"><b>try
      </b></font>writeln<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'&lt;HR&gt;('</font><font color="#000080">+</font>timeToStr<font color="#000080">(</font>time<font color="#000080">)+</font><font color="#800000">')---&gt;['</font><font color="#000080">+</font>dateToStr<font color="#000080">(</font>date<font color="#000080">)+</font><font color="#800000">']&lt;BR&gt;'</font><font color="#000080">);
      </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>cl<font color="#000080">.</font>count<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
         </b></font>s<font color="#000080">:=</font>decodeFormInfo<font color="#000080">(</font>cl<font color="#000080">.</font>strings<font color="#000080">[</font>i<font color="#000080">]);
         </font><font color="#FF0000"><b>if </b></font>pos<font color="#000080">(</font><font color="#800000">'='</font><font color="#000080">,</font>s<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
            </b></font>j<font color="#000080">:=</font>pos<font color="#000080">(</font><font color="#800000">'='</font><font color="#000080">,</font>s<font color="#000080">);
            </font>delete<font color="#000080">(</font>s<font color="#000080">,</font>j<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
            </font>insert<font color="#000080">(</font><font color="#800000">'&lt;/Strong&gt;&lt;DD&gt;'</font><font color="#000080">,</font>s<font color="#000080">,</font>j<font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font>findRepl<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">#13</font><font color="#000080">,</font><font color="#800000">'&lt;DD&gt;'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'&lt;strong&gt;'</font><font color="#000080">+</font>s<font color="#000080">);
         </font>writeln<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'&lt;BR&gt;'</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>finally
      </b></font>closeFile<font color="#000080">(</font>f<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>function </b></font>getInputVar<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if not </b></font>clOpen <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font>i<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>i<font color="#000080">&lt;</font>cl<font color="#000080">.</font>count <font color="#FF0000"><b>do begin
     if </b></font>uppercase<font color="#000080">(</font>copy<font color="#000080">(</font>cl<font color="#000080">.</font>strings<font color="#000080">[</font>i<font color="#000080">],</font><font color="#800000">1</font><font color="#000080">,</font>length<font color="#000080">(</font>s<font color="#000080">)))=</font>uppercase<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>then begin
        </b></font>result<font color="#000080">:=</font>copy<font color="#000080">(</font>cl<font color="#000080">.</font>strings<font color="#000080">[</font>i<font color="#000080">],</font>pos<font color="#000080">(</font><font color="#800000">'='</font><font color="#000080">,</font>cl<font color="#000080">.</font>strings<font color="#000080">[</font>i<font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">,</font>length<font color="#000080">(</font>cl<font color="#000080">.</font>strings<font color="#000080">[</font>i<font color="#000080">]));
        </font>result<font color="#000080">:=</font>decodeFormInfo<font color="#000080">(</font>result<font color="#000080">);
        </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>inc<font color="#000080">(</font>i<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>getAsField<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result<font color="#000080">:=</font>getInputVar<font color="#000080">(</font>s<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>result<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>result<font color="#000080">:=</font><font color="#800000">'[Field '</font><font color="#000080">+</font>s<font color="#000080">+</font><font color="#800000">':'</font><font color="#000080">+</font>result<font color="#000080">+</font><font color="#800000">']'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>getAsFieldName<font color="#000080">(</font>s<font color="#000080">,</font>f<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result<font color="#000080">:=</font>getInputVar<font color="#000080">(</font>s<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>result<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>result<font color="#000080">:=</font><font color="#800000">'[Field '</font><font color="#000080">+</font>f<font color="#000080">+</font><font color="#800000">':'</font><font color="#000080">+</font>result<font color="#000080">+</font><font color="#800000">']'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>HRef<font color="#000080">(</font>location<font color="#000080">, </font>text<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>result<font color="#000080">:=</font><font color="#800000">'&lt;A HREF=&quot;'</font><font color="#000080">+</font>location<font color="#000080">+</font><font color="#800000">'&quot;&gt;'</font><font color="#000080">+</font>text<font color="#000080">+</font><font color="#800000">'&lt;/A&gt;'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Image<font color="#000080">(</font>location<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>result<font color="#000080">:=</font><font color="#800000">'&lt;IMG SRC=&quot;'</font><font color="#000080">+</font>location<font color="#000080">+</font><font color="#800000">'&quot;&gt;'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>sendFileBinary<font color="#000080">( </font>fileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>fileHandle<font color="#000080">:</font>HFile<font color="#000080">;
    </font>f<font color="#000080">:</font>char<font color="#000080">;
    </font>x<font color="#000080">,</font>i<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>result<font color="#000080">:=</font>false<font color="#000080">;
</font>FileHandle<font color="#000080">:= </font>CreateFile<font color="#000080">( </font>PChar<font color="#000080">(</font>fileName<font color="#000080">), </font>Generic_Read<font color="#000080">, </font>File_Share_Read<font color="#000080">,
   </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>Open_Existing<font color="#000080">, </font>File_Attribute_Normal<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>if </b></font>FileHandle <font color="#000080">= </font>Invalid_Handle_Value <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
</font>fileSeek<font color="#000080">(</font>fileHandle<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>repeat
</b></font>x<font color="#000080">:=</font>fileRead<font color="#000080">(</font>FileHandle<font color="#000080">,</font>f<font color="#000080">,</font>sizeOf<font color="#000080">(</font>f<font color="#000080">));
</font>write<font color="#000080">(</font>f<font color="#000080">);
</font><font color="#FF0000"><b>until </b></font>x<font color="#000080">&lt;&gt;</font>sizeOf<font color="#000080">(</font>f<font color="#000080">);
</font>closeHandle<font color="#000080">(</font>fileHandle<font color="#000080">);
</font>result<font color="#000080">:=</font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>sendFileBinary2<font color="#000080">( </font>fileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>fileHandle<font color="#000080">:</font>HFile<font color="#000080">;
    </font>f<font color="#000080">:</font>char<font color="#000080">;
    </font>x<font color="#000080">,</font>i<font color="#000080">:</font>integer<font color="#000080">;
    </font>l<font color="#000080">:</font>longInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>result<font color="#000080">:=</font>false<font color="#000080">;
</font>FileHandle<font color="#000080">:= </font>CreateFile<font color="#000080">( </font>PChar<font color="#000080">(</font>fileName<font color="#000080">), </font>Generic_Read<font color="#000080">, </font>File_Share_Read<font color="#000080">,
   </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>Open_Existing<font color="#000080">, </font>File_Attribute_Normal<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>if </b></font>FileHandle <font color="#000080">= </font>Invalid_Handle_Value <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
</font>l<font color="#000080">:=</font>getFileSize<font color="#000080">(</font>fileHandle<font color="#000080">,@</font>l<font color="#000080">);
</font>writeln<font color="#000080">(</font><font color="#800000">'Content-type: application/octet-string'</font><font color="#000080">);
</font>writeln<font color="#000080">(</font><font color="#800000">'Content-Length: '</font><font color="#000080">+</font>intToStr<font color="#000080">(</font>l<font color="#000080">));
</font>writeln<font color="#000080">;
</font>fileSeek<font color="#000080">(</font>fileHandle<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>repeat
</b></font>x<font color="#000080">:=</font>fileRead<font color="#000080">(</font>FileHandle<font color="#000080">,</font>f<font color="#000080">,</font>sizeOf<font color="#000080">(</font>f<font color="#000080">));
</font>write<font color="#000080">((</font>f<font color="#000080">));
</font><font color="#FF0000"><b>until </b></font>x<font color="#000080">&lt;&gt;</font>sizeOf<font color="#000080">(</font>f<font color="#000080">);
</font>closeHandle<font color="#000080">(</font>fileHandle<font color="#000080">);
</font>result<font color="#000080">:=</font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>sendFile<font color="#000080">( </font>fileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>fileHandle<font color="#000080">:</font>HFile<font color="#000080">;
    </font>f<font color="#000080">:</font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2000</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>x<font color="#000080">,</font>i<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>result<font color="#000080">:=</font>false<font color="#000080">;
</font>FileHandle<font color="#000080">:= </font>CreateFile<font color="#000080">( </font>PChar<font color="#000080">(</font>fileName<font color="#000080">), </font>Generic_Read<font color="#000080">, </font>File_Share_Read<font color="#000080">,
   </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>Open_Existing<font color="#000080">, </font>File_Attribute_Normal<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>if </b></font>FileHandle <font color="#000080">= </font>Invalid_Handle_Value <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
</font>fileSeek<font color="#000080">(</font>fileHandle<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>repeat
</b></font>x<font color="#000080">:=</font>fileRead<font color="#000080">(</font>FileHandle<font color="#000080">,</font>f<font color="#000080">,</font>sizeOf<font color="#000080">(</font>f<font color="#000080">));
</font>write<font color="#000080">(</font>f<font color="#000080">);
</font><font color="#FF0000"><b>until </b></font>x<font color="#000080">&lt;&gt;</font>sizeOf<font color="#000080">(</font>f<font color="#000080">);
</font>closeHandle<font color="#000080">(</font>fileHandle<font color="#000080">);
</font>result<font color="#000080">:=</font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>WinExecuteWait<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>StartupInfo<font color="#000080">:</font>TStartupInfo<font color="#000080">;
     </font>ProcessInfo<font color="#000080">: </font>TProcessInformation<font color="#000080">;
</font><font color="#FF0000"><b>begin
   if </b></font><font color="#000080">(</font>CreateProcess<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>pchar<font color="#000080">(</font>s<font color="#000080">), </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">, </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">, </font>FALSE<font color="#000080">,
                     </font><font color="#800000">0</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>StartupInfo<font color="#000080">, </font>Processinfo<font color="#000080">))
   </font><font color="#FF0000"><b>then begin
   </b></font>waitForSingleObject<font color="#000080">(</font>ProcessInfo<font color="#000080">.</font>Hprocess<font color="#000080">, </font>INFINITE<font color="#000080">);
   </font>result<font color="#000080">:=</font>true<font color="#000080">;
   </font><font color="#FF0000"><b>end else begin
   </b></font>result<font color="#000080">:=</font>false<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ the following contains additional files that should be included with this
  file.  To extract, you need XX3402 available with the SWAG distribution.

  1.     Cut the text below out, and save to a file  ..  filename.xx
  2.     Use XX3402  :   xx3402 d filename.xx
  3.     The decoded file should be created in the same directory.
  4.     If the file is a archive file, use the proper archive program to
         extract the members.

{ ------------------            CUT              ----------------------}


</i></font><font color="#000080">*</font>XX3402<font color="#000080">-</font><font color="#800000">002753</font><font color="#000080">-</font><font color="#800000">200896</font><font color="#000080">--</font><font color="#800000">72</font><font color="#000080">--</font><font color="#800000">85</font><font color="#000080">-</font><font color="#800000">45224</font><font color="#000080">------</font>SAMPLE<font color="#000080">.</font>ZIP<font color="#000080">--</font><font color="#800000">1</font><font color="#000080">-</font><font color="#FF0000"><b>OF</b></font><font color="#000080">--</font><font color="#800000">1
</font>I2g1<font color="#000080">--</font>E<font color="#000080">++++</font><font color="#800000">6</font><font color="#000080">+</font><font color="#800000">17</font>R302nurKqA<font color="#000080">++++</font><font color="#800000">1</font>M<font color="#000080">++++</font><font color="#800000">9</font><font color="#000080">++++</font>EIt7HI3IFGt6J2qnGQdDePHXtP9lA9Ef
GGoigR5DA<font color="#000080">+</font>FlArDH3Me9YaoHwn7n2ohGxJ6fIip<font color="#000080">-</font>sjdUxE<font color="#000080">-</font>EGkA23<font color="#000080">+++++</font>U<font color="#000080">+</font>ZZoI6OJG9TLQ
<font color="#000080">++++</font><font color="#800000">6E6</font><font color="#000080">+++</font>g<font color="#000080">+++-</font>VPaZhMLFZ9aFkQfKEnIv26<font color="#000080">-</font>G3xoru1imcWH1Jl6rBP1Enfq4MsIdjEWw2
PhBdXCxiNMnFyL2bP<font color="#000080">+</font>WQQytrW0asN<font color="#000080">+</font>NV0<font color="#000080">+</font>T1oBJJLMoNQZo7AG5NACLPjQCLLW<font color="#000080">+</font><font color="#800000">7</font>KIsuaWm9
Q<font color="#000080">+</font>QCuJCtf0YVUuR4DURW63MwFrUIkyUNcoawCeU<font color="#000080">-</font><font color="#800000">1</font>q<font color="#000080">-</font>JUiXB5fdR4AaOB8wrNCJBxniaCopJ
ud9gRBfGkQ58sSiZk8y914GruC27ONbSmC8topRApmWCypxMvjxYmFsUBUxhqttzlYywwj7a
O<font color="#000080">-</font>O<font color="#000080">-</font>SoV5b0ksW1XaLajxTZuUy7Lu9fXEuExEGkA23<font color="#000080">+++++</font>U<font color="#000080">+</font>ZZkI6RwVdfLZ<font color="#000080">+</font>k<font color="#000080">++</font>qUE<font color="#000080">+++</font>c<font color="#000080">+
++-</font>dPK3bNH2iNqZa9JBzHBFZ45zj1fUvvc<font color="#000080">+</font>qGN1<font color="#000080">-</font><font color="#800000">9E</font>RfU1OopnCmv6xECHLfacKIEePb4vwe
yFJrOqkrn6gckrN1SUiBIxZEpUasyOBPAiOQb9t2or29twllFwmO9eEZUyXdSPvqzb5PQwzn
T5sxRwKPBlIyxuu9iRUXlU<font color="#000080">++</font>DvlS9zjzQQM2Mt6lVRxHlHbXUb57i46Qe0Ys2s67mMFW<font color="#000080">+</font>aVK
QWM3Yt77lGHEei7A0OMYIscdM2H04EU4Yc30JU6aOAH0NNk4se2bC7SQ8wu<font color="#000080">-</font>O92GUUj7VS60
G<font color="#000080">+</font>IqdS<font color="#000080">-</font>GQeas<font color="#000080">--</font><font color="#800000">83</font>godk7PZGL<font color="#000080">+</font><font color="#800000">3e</font>l3ICUcDYc1U<font color="#000080">+</font>GGMD8<font color="#000080">-</font>dJcWkU<font color="#000080">-</font>wG2o6W3mo04eAMbVJ<font color="#000080">-</font><font color="#800000">0
</font><font color="#000080">+</font>DZ1KemY33670KELJK<font color="#000080">-</font>HGO4II61iIFHC0d<font color="#000080">+</font><font color="#800000">0</font>Z<font color="#000080">+</font><font color="#800000">0</font>UA0UgrAMso1xEBaE7kJ<font color="#000080">+</font>oeUG8WcUF4u2F
<font color="#800000">0</font>mUtOaCBHoY730HuEpegZ768A3SoWmek8I37<font color="#000080">+</font><font color="#800000">6e</font>NfW7cZc64Gdqm2vF8QE<font color="#000080">+</font>RUFk8EW9FE1QV
<font color="#800000">5</font>M8<font color="#000080">+</font><font color="#800000">0</font>FfcF1EhW6QSsAIkGDG5h3WdlvwGvTmU5FWo2s7q7B1C<font color="#000080">+</font><font color="#800000">3</font>fEc2I7KZWUlE4OMR<font color="#000080">+</font>gUGMO
B3aU2MA41RcmO4qBWWIZ7KJYNCHathfhxe8W6eTHKJNKJZpRvLOvTHuTrywD<font color="#000080">-+</font><font color="#800000">9</font><font color="#000080">-</font>M1<font color="#000080">+</font>I0cL1
sIUY2cj3NaNa5izeR1exLawk4C9Wsi9XslAG2cl4cwZYAdjBWMa73cj3OfIWTb7mQYd8mYfu
nRBzkKU0dXBZCjevVkyMZiHj4iYDLDvoWSkhLMu<font color="#000080">-</font>spQyHyRJhoQ4HZlhTuec9LDnsAakDrTv
uJrVkNvfbOjqLijmp97hbMOOCmtNDrpBdqiMLtD58bsCD3qTI7eTKibcqReyffZeHRLBItZx
anfOv5x2jhwFWeHyCLuux71nShrubOzrrSejKPvoHQjO1rPyo5XzpMO3YXAP9XIjfYpZPDxP
<font color="#800000">3</font>peKNDnPJXUkTCK9f<font color="#000080">-</font>ItpiQ5LEQvNghTufKzTrRIPosHpcipYpp5WuDqNx6fTfzFPLksTayW
fiPwhfGnYKyzuLvkWvvDhtVoiq8glRSoo1UeUrJrKjq47hCQNqPgtiexMw4tJIqygoA3ExO0
Gu5v1xhzD35Qyj5uVRY5ymurbvapgjbLqSXtcM7rC0nyArvp1Szkp9HB0wgiq3cSfLNwRq<font color="#000080">+</font>y
fxLqWL39eSqUtSqt96xtrdWpALpDT2TXbARRwZtjHyxYvS72qcv43PNnlzRzh2wwKPtvh1Tu
NTslJzFEsPB9MsQBFzv8zif1tQhmDaj8itSnjLVm73PyKYZZHrrqFgxIlveqYpB5hjvoxMrC
rGxTrDC88rxWmjbWiPmchDnhiBjJ28aQDifyvRHoAFOrUPrk5p<font color="#000080">-</font><font color="#800000">9</font><font color="#000080">+</font>kEI<font color="#000080">++++</font><font color="#800000">0</font><font color="#000080">+</font><font color="#800000">0</font>qL<font color="#000080">-</font>EVvp1M
NnM2<font color="#000080">+++</font>a<font color="#000080">-</font>E<font color="#000080">++</font><font color="#800000">0</font>U<font color="#000080">+++</font><font color="#800000">4</font>ZhMKRZAWtbOKMhIrpApKIITWxkiNSD0qpgd6G9Q3s73Kfjk<font color="#000080">+</font>NPozUE
Q1dKsogUsQNSaXT3iG<font color="#000080">+</font>cJkkE<font color="#000080">+</font>WmLXC0RU3qsrjW6msTB3ZHHW6xP9tWf8<font color="#000080">+</font>ozIVFlOkpakCs4
drByRjutCvxnnbCStnbjrNSOzB9ikW7Kl3MN<font color="#000080">+</font>s0BXErwNTw5Nokk7VZHx<font color="#000080">-</font><font color="#800000">2</font>nnVYLX2j43SB<font color="#000080">+
</font>FQ4N22l67VEHE9qGAmaMZ2ke7c343KR8A0KNIYk<font color="#000080">-</font>kEBb6<font color="#000080">-</font>V6<font color="#000080">-</font>Uer2X<font color="#000080">--</font><font color="#800000">6</font>lMCMnTE5Uf<font color="#000080">-</font>iSFQ
QEuo3XAVi7<font color="#000080">-</font>Q80u<font color="#000080">+</font>K4<font color="#000080">-</font>F0WsZZsd9639MekFLYWj33G<font color="#000080">-</font><font color="#800000">55</font>CIUC2UCWUAENR8<font color="#000080">+</font>d72ZoU7GE7gE
<font color="#800000">4</font>f3k42UEtFVG00I2Y1tQWtaIEWcVUSEW0mke8NEG0Z<font color="#000080">+</font>xYg7S<font color="#000080">+</font>J8<font color="#000080">+</font><font color="#800000">2</font>U<font color="#000080">-</font>Y<font color="#000080">-</font>da3oqU5uUTmVWEV
<font color="#800000">4774</font>ZY<font color="#000080">-</font>KoK92FaX2<font color="#000080">+</font>b8CmdVX80a<font color="#000080">-</font>X2Fxi<font color="#000080">-</font>MndOE0x<font color="#000080">-</font>LZ6UggGZ<font color="#000080">+</font>GU4maekXe7OC<font color="#000080">-</font>L0Tj<font color="#000080">-</font><font color="#800000">6</font>qG
<font color="#800000">5</font>I<font color="#000080">-</font><font color="#800000">566</font>K0Y6Uoo2q6Vm<font color="#000080">-</font>UUUMu2LI9qYA<font color="#000080">-</font>S12o2jLVKgkIjV9hBM<font color="#000080">-</font>qPx<font color="#000080">+</font>i0hfBE9g8O9u1tWlc
rc5a1aXuEJA6aUPEK694<font color="#000080">+</font>vFBc44<font color="#000080">-</font>pUpDQgNA7ZB6G2V2F2FAH2l0EY7uSbdyTfvJOWoj9uyh
fKpeOf9NP2ubQrFopCJmnQvCngzD9mohDNbJuLES5VuSbdtSLZtujRvPqxhUA<font color="#000080">-</font>WBFVwT5pxT
LnwzDrxzTwED0<font color="#000080">+</font>U61<font color="#000080">+</font>nQGKySzUg46n0RAHFZw9AfpQOUm9mdERhMrJBPoxdGVXf54nTl6rBH
EpqHNw6G4Y7HVyqidcXLSjBQklRyObbVXFzPIWwudgxt4lvCTFqoTOfRcwfLpDj9xiGCi9f6
<font color="#800000">9</font>L4LrlnLvSx8DjfcwLDdDRYmwuUldWyfDnScP1ohYzoqe7zwRDrRs3qJRijjZolxgJ4tLtLw
TODRyeLnpaXiiaxGkxjFBrhC4ftjngosTipIpN1NaPDuMhP2vYNrywvMtJRbca7quDhztbyc
<font color="#800000">6</font>uYhtfuFytO9kES0zdIXdQI1Zv8WNbM3jrCsytjrWYrCsS9YenyIZdli0motq1DR5ZEIhRtt
vx5gttMnulLlexRiDLwA<font color="#000080">+</font>e8zWuycPvvONFVsqS7SmPkyJfkKgb9GTSCTURW<font color="#000080">-</font>kqi94sOD1<font color="#000080">+</font>KJ
<font color="#800000">5</font>U4haSxvFtPZJnLgbGmcBdenPlQ2DhVqjReFh7<font color="#000080">-</font>LiwYhvhEgPvZEa<font color="#000080">-</font><font color="#800000">7</font>KqrfnkqRRgLySK7aq
Kldbftk8rlQxYrrvxCGrlbi7MLRPwrCqVViODhulDDLLzgHMf9gTX6kbnNop<font color="#000080">-</font>xT7V0lRjPrt
QQPWT5BZQv8xqZOOSeTZuRd3qtuOxEm5hTWJ5bDHUHH5zLCKWRG3xiCCF5D5aAapw5dBngG1
wqztd4qqbL0bV5RK9xLARclhRXwwTzPMaeBfzdDulKGRpyJhZde8LlSvIvkDxLFrZFoerBhn
ReFrHryjbnjmWu4NiDHSNzFq3jwTI2g<font color="#000080">-+</font>X693<font color="#000080">+++++</font>U<font color="#000080">+</font>AZoI6HDfRPMk<font color="#000080">++++</font>BU<font color="#000080">++++</font>g<font color="#000080">+++++
+++++</font>E<font color="#000080">+</font>U<font color="#000080">+</font><font color="#800000">9</font>O<font color="#000080">-+++++</font><font color="#800000">23</font>CGIp<font color="#000080">-</font>J2IiG3FBI2g<font color="#000080">-+</font>X693<font color="#000080">+++++</font>U<font color="#000080">+</font>ZZoI6OJG9TLQ<font color="#000080">++++</font><font color="#800000">6E6</font><font color="#000080">+++</font>g<font color="#000080">+
+++++++++</font>E<font color="#000080">+</font>U<font color="#000080">+</font><font color="#800000">9</font>O<font color="#000080">-</font>KE<font color="#000080">+++</font><font color="#800000">43</font>iOKpVR4IiN5<font color="#000080">-</font>mI2g<font color="#000080">-+</font>X693<font color="#000080">+++++</font>U<font color="#000080">+</font>ZZkI6RwVdfLZ<font color="#000080">+</font>k<font color="#000080">++</font>qUE<font color="#000080">+
++</font>c<font color="#000080">++++++++++++</font>U<font color="#000080">+</font><font color="#800000">9</font>O<font color="#000080">-</font>LU2<font color="#000080">++</font><font color="#800000">4</font>ZhMKRZAGtbOKNEGk20AUgI<font color="#000080">++++</font><font color="#800000">0</font><font color="#000080">+</font><font color="#800000">0</font>qL<font color="#000080">-</font>EVvp1MNnM2<font color="#000080">+++</font>a
<font color="#000080">-</font>E<font color="#000080">++</font><font color="#800000">0</font>U<font color="#000080">+++++++++++</font><font color="#800000">0</font><font color="#000080">++</font>hc3f<font color="#000080">-</font>E<font color="#000080">++</font>OKpVNqIm9aRdNZ<font color="#000080">-</font><font color="#800000">9</font><font color="#000080">-</font>EM<font color="#000080">+++++-++</font><font color="#800000">2</font><font color="#000080">+</font>C6<font color="#000080">+++</font><font color="#800000">170E</font><font color="#000080">++++++
***** </font><font color="#FF0000"><b>END OF </b></font>BLOCK <font color="#800000">1 </font><font color="#000080">*****

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0358.PAS">Original</a><b>]</b></p></body>
</html>
