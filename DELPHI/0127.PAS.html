<html>
<head><title> "Array of Buttons" by D.F. HARTLEY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0127.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{

Here is a unit that creates a row of buttons and a label at run time and
displays which button is clicked on. Thanks go to a number of people who pushed
me in the right direction. Like all things in programing 'it's obvious when you
know how'!

All you need to do is start a new project, then paste all the code below
into Unit1.

-------------------------------------------------------------------------------------
}

</i></font><font color="#FF0000"><b>unit </b></font>Unit1<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>StdCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>ButtonClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R *.DFM}

</i></font><font color="#FF0000"><b>const
  </b></font>b <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;  </font><font color="#008000"><i>{Total number of buttons to create}

</i></font><font color="#FF0000"><b>var
  </b></font>ButtonArray <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>b<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>TButton<font color="#000080">; </font><font color="#008000"><i>{Set up an array of buttons}
  </i></font>MessageBox<font color="#000080">: </font>TLabel<font color="#000080">;                     </font><font color="#008000"><i>{...and a label!}

</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>loop <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ClientWidth<font color="#000080">:=(</font>b<font color="#000080">*</font><font color="#800000">60</font><font color="#000080">)+</font><font color="#800000">10</font><font color="#000080">;               </font><font color="#008000"><i>{Size the form to fit all the}
  </i></font>ClientHeight<font color="#000080">:=</font><font color="#800000">65</font><font color="#000080">;                     </font><font color="#008000"><i>{components in.}

  </i></font>MessageBox<font color="#000080">:=</font>TLabel<font color="#000080">.</font>Create<font color="#000080">(</font>Self<font color="#000080">);      </font><font color="#008000"><i>{Create a label...}
  </i></font>MessageBox<font color="#000080">.</font>Parent<font color="#000080">:=</font>Self<font color="#000080">;
  </font>MessageBox<font color="#000080">.</font>Align<font color="#000080">:=</font>alTop<font color="#000080">;              </font><font color="#008000"><i>{...set up it's properties...}
  </i></font>MessageBox<font color="#000080">.</font>Alignment<font color="#000080">:=</font>taCenter<font color="#000080">;
  </font>MessageBox<font color="#000080">.</font>Caption<font color="#000080">:=</font><font color="#800000">'Press a Button'</font><font color="#000080">;

  </font><font color="#FF0000"><b>for </b></font>loop<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>b<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do                </b></font><font color="#008000"><i>{Now create all the buttons}
      </i></font><font color="#FF0000"><b>begin
        </b></font>ButtonArray<font color="#000080">[</font>loop<font color="#000080">]:=</font>TButton<font color="#000080">.</font>Create<font color="#000080">(</font>Self<font color="#000080">);
        </font><font color="#FF0000"><b>with </b></font>ButtonArray<font color="#000080">[</font>loop<font color="#000080">] </font><font color="#FF0000"><b>do       </b></font><font color="#008000"><i>{Note the use of the with command.}
          </i></font><font color="#FF0000"><b>begin</b></font>	                        <font color="#008000"><i>{This lets you leave out the first}
            </i></font>Parent  <font color="#000080">:=</font>self<font color="#000080">;             </font><font color="#008000"><i>{bit of the description and}
            </i></font>Caption <font color="#000080">:=</font>IntToStr<font color="#000080">(</font>loop<font color="#000080">);   </font><font color="#008000"><i>{(I think) makes the code easier}
            </i></font>Width   <font color="#000080">:=</font><font color="#800000">50</font><font color="#000080">;               </font><font color="#008000"><i>{to read.}
            </i></font>Height  <font color="#000080">:=</font><font color="#800000">25</font><font color="#000080">;
            </font>Top	    <font color="#000080">:=</font><font color="#800000">30</font><font color="#000080">;
            </font>Left    <font color="#000080">:=(</font>loop<font color="#000080">*</font><font color="#800000">60</font><font color="#000080">)+</font><font color="#800000">10</font><font color="#000080">;
            </font>Tag	    <font color="#000080">:=</font>loop<font color="#000080">;</font>     	<font color="#008000"><i>{Used to tell which button is pressed}
            </i></font>OnClick <font color="#000080">:=</font>ButtonClick<font color="#000080">;</font>	<font color="#008000"><i>{The important bit!}
          </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>ButtonClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>t <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>t<font color="#000080">:=(</font>Sender <font color="#FF0000"><b>as </b></font>TButton<font color="#000080">).</font>Tag<font color="#000080">;</font>		<font color="#008000"><i>{Get the button number}
  </i></font>MessageBox<font color="#000080">.</font>Caption<font color="#000080">:=</font><font color="#800000">'You pressed Button '</font><font color="#000080">+</font>IntToStr<font color="#000080">(</font>t<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0127.PAS">Original</a><b>]</b></p></body>
</html>
