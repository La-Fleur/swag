<html>
<head><title> "Is Delphi running ??" by LANNY GRIM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0409.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>Unit1<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>StdCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font>Button1<font color="#000080">: </font>TButton<font color="#000080">;
    </font>Label1<font color="#000080">: </font>TLabel<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R *.DFM}

{ The following functions are written for Delphi 1.x }
  </i></font>They should be easily adaptable <font color="#FF0000"><b>for </b></font>use <font color="#FF0000"><b>with </b></font>Delphi <font color="#800000">2 </font><font color="#000080">&amp; </font><font color="#800000">3 </font><font color="#000080">}

</font><font color="#FF0000"><b>function  </b></font>ExtractFileRootName<font color="#000080">( </font>FileName<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>p<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin   </b></font><font color="#008000"><i>{ extracts the 8-character file name only }
  </i></font>Result <font color="#000080">:= </font>ExtractFileName<font color="#000080">(</font>FileName<font color="#000080">);
  </font>p <font color="#000080">:= </font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>Result<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>p<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Result <font color="#000080">:= </font>Copy<font color="#000080">(</font>Result<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>p<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>DelphiRunning<font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin   </b></font><font color="#008000"><i>{ returns true if running within the IDE/compiler }
  </i></font>Result <font color="#000080">:=
    (</font>FindWindow<font color="#000080">(</font><font color="#800000">'TApplication'</font><font color="#000080">,</font><font color="#800000">'Delphi'</font><font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR
    </b></font><font color="#000080">(</font>FindWindow<font color="#000080">(</font><font color="#800000">'TPropertyInspector'</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR
    </b></font><font color="#000080">(</font>FindWindow<font color="#000080">(</font><font color="#800000">'TAppBuilder'</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ProjectInDelphi<font color="#000080">( </font>EXEName<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Hnd<font color="#000080">: </font>HWnd<font color="#000080">;
    </font>buf<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">80</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>tmpS<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>DelphiRunning<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>EXEName <font color="#000080">:= </font>UpperCase<font color="#000080">(</font>ExtractFileRootName<font color="#000080">(</font>EXEName<font color="#000080">));
      </font>Hnd <font color="#000080">:= </font>FindWindow<font color="#000080">(</font><font color="#800000">'TAppBuilder'</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
      </font>GetWindowText<font color="#000080">(</font>Hnd<font color="#000080">, </font>buf<font color="#000080">, </font>SizeOf<font color="#000080">(</font>buf<font color="#000080">)); </font><font color="#008000"><i>{ get window caption }
      </i></font>tmpS <font color="#000080">:= </font>UpperCase<font color="#000080">(</font>StrPas<font color="#000080">(</font>buf<font color="#000080">));
      </font>Result <font color="#000080">:= (</font>Pos<font color="#000080">(</font>EXEName<font color="#000080">,</font>tmpS<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">)  </font><font color="#008000"><i>{ does it contain EXEName ? }
                </i></font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'RUNNING'</font><font color="#000080">,</font>tmpS<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">);  </font><font color="#008000"><i>{ is it running ? }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>ProjectInDelphi<font color="#000080">(</font><font color="#800000">'Project1.Exe'</font><font color="#000080">)
    </font><font color="#FF0000"><b>then </b></font>Label1<font color="#000080">.</font>Caption <font color="#000080">:= </font><font color="#800000">'TRUE'
    </font><font color="#FF0000"><b>else </b></font>Label1<font color="#000080">.</font>Caption <font color="#000080">:= </font><font color="#800000">'False'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0409.PAS">Original</a><b>]</b></p></body>
</html>
