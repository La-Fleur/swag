<html>
<head><title> "3D border for label component?" by MARK PRITCHARD</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0412.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">From<font color="#000080">: </font>Mark Pritchard <font color="#000080">&lt;</font>pritchma<font color="#000080">@</font>ozemail<font color="#000080">.</font>com<font color="#000080">.</font>au<font color="#000080">&gt;

</font>Here <font color="#FF0000"><b>is </b></font>a free one <font color="#000080">(</font>took around half an hour <font color="#FF0000"><b>to </b></font>put together<font color="#000080">, </font>it doesn<font color="#800000">'t grab the parent font correctly, but I couldn'</font>t be bothered putting any more time into it<font color="#000080">) -



--------------------------------------------------------------------------------


</font><font color="#FF0000"><b>unit </b></font>IDSLabel<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">,
</font>Dialogs<font color="#000080">,
  </font>ExtCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TIDSLabel <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TBevel<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
    </i></font>FAlignment <font color="#000080">: </font>TAlignment<font color="#000080">;
    </font>FCaption <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>FFont <font color="#000080">: </font>TFont<font color="#000080">;
    </font>FOffset <font color="#000080">: </font>Byte<font color="#000080">;

    </font>FOnChange <font color="#000080">: </font>TNotifyEvent<font color="#000080">;

    </font><font color="#FF0000"><b>procedure </b></font>SetAlignment<font color="#000080">( </font>taIn <font color="#000080">: </font>TAlignment <font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetCaption<font color="#000080">( </font><font color="#FF0000"><b>const </b></font>strIn <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetFont<font color="#000080">( </font>fntNew <font color="#000080">: </font>TFont <font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetOffset<font color="#000080">( </font>bOffNew <font color="#000080">: </font>Byte <font color="#000080">);
  </font><font color="#FF0000"><b>protected
    </b></font><font color="#008000"><i>{ Protected declarations }
    </i></font><font color="#FF0000"><b>constructor </b></font>Create<font color="#000080">( </font>compOwn <font color="#000080">: </font>TComponent <font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>destructor </b></font>Destroy<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Paint<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>published
    </b></font><font color="#008000"><i>{ Published declarations }
    </i></font><font color="#FF0000"><b>property </b></font>Alignment <font color="#000080">: </font>TAlignment <font color="#FF0000"><b>read </b></font>FAlignment <font color="#FF0000"><b>write </b></font>SetAlignment <font color="#FF0000"><b>default </b></font>taLeftJustify<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Caption <font color="#000080">: </font><font color="#FF0000"><b>String read </b></font>FCaption <font color="#FF0000"><b>write </b></font>SetCaption<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Font <font color="#000080">: </font>TFont <font color="#FF0000"><b>read </b></font>FFont <font color="#FF0000"><b>write </b></font>SetFont<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Offset <font color="#000080">: </font>Byte <font color="#FF0000"><b>read </b></font>FOffset <font color="#FF0000"><b>write </b></font>SetOffset<font color="#000080">;

    </font><font color="#FF0000"><b>property </b></font>OnChange <font color="#000080">: </font>TNotifyEvent <font color="#FF0000"><b>read </b></font>FOnChange <font color="#FF0000"><b>write </b></font>FOnChange<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

constructor </b></font>TIDSLabel<font color="#000080">.</font>Create<font color="#000080">;
</font><font color="#FF0000"><b>begin
   inherited </b></font>Create<font color="#000080">(</font>compOwn<font color="#000080">);

   </font>FFont <font color="#000080">:= </font>TFont<font color="#000080">.</font>Create<font color="#000080">;
   </font><font color="#FF0000"><b>with </b></font>compOwn <font color="#FF0000"><b>as </b></font>TForm <font color="#FF0000"><b>do
       </b></font>FFont<font color="#000080">.</font>Assign<font color="#000080">(</font>Font<font color="#000080">);

   </font>Offset <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
   </font>Height <font color="#000080">:= </font><font color="#800000">15</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>TIDSLabel<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>FFont<font color="#000080">.</font>Free<font color="#000080">;

   </font><font color="#FF0000"><b>inherited </b></font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TIDSLabel<font color="#000080">.</font>Paint<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>wXPos<font color="#000080">, </font>wYPos <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin

   </b></font><font color="#008000"><i>{Draw the bevel}
   </i></font><font color="#FF0000"><b>inherited </b></font>Paint<font color="#000080">;

   </font><font color="#008000"><i>{Retreive the font}
   </i></font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Assign<font color="#000080">(</font>Font<font color="#000080">);

   </font><font color="#008000"><i>{Calculate the y position}
   </i></font>wYPos <font color="#000080">:= (</font>Height <font color="#000080">- </font>Canvas<font color="#000080">.</font>TextHeight<font color="#000080">(</font>Caption<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;

   </font><font color="#008000"><i>{Calculate the x position}
   </i></font>wXPos <font color="#000080">:= </font>Offset<font color="#000080">;
   </font><font color="#FF0000"><b>case </b></font>Alignment <font color="#FF0000"><b>of
       </b></font>taRightJustify<font color="#000080">: </font>wXPos <font color="#000080">:= </font>Width <font color="#000080">- </font>Canvas<font color="#000080">.</font>TextWidth<font color="#000080">(</font>Caption<font color="#000080">) - </font>Offset<font color="#000080">;
       </font>taCenter<font color="#000080">:       </font>wXPos <font color="#000080">:= (</font>Width <font color="#000080">- </font>Canvas<font color="#000080">.</font>TextWidth<font color="#000080">(</font>Caption<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>Canvas<font color="#000080">.</font>Brush <font color="#000080">:= </font>Parent<font color="#000080">.</font>Brush<font color="#000080">;
   </font>Canvas<font color="#000080">.</font>TextOut<font color="#000080">(</font>wXPos<font color="#000080">,</font>wYPos<font color="#000080">,</font>Caption<font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TIDSLabel<font color="#000080">.</font>SetAlignment<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>FAlignment <font color="#000080">:= </font>taIn<font color="#000080">;
   </font>Invalidate<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TIDSLabel<font color="#000080">.</font>SetCaption<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>FCaption <font color="#000080">:= </font>strIn<font color="#000080">;

   </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>FOnChange<font color="#000080">) </font><font color="#FF0000"><b>then
       </b></font>FOnChange<font color="#000080">(</font>Self<font color="#000080">);

   </font>Invalidate<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TIDSLabel<font color="#000080">.</font>SetFont<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>FFont<font color="#000080">.</font>Assign<font color="#000080">(</font>fntNew<font color="#000080">);
   </font>Invalidate<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TIDSLabel<font color="#000080">.</font>SetOffset<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>FOffset <font color="#000080">:= </font>bOffNew<font color="#000080">;
   </font>Invalidate<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0412.PAS">Original</a><b>]</b></p></body>
</html>
