<html>
<head><title> "Re: Windows APIs" by KEITH ANDERSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0276.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">&gt; </font>GetDiskFreeSpace<font color="#000080">(</font>lpszRootPathName<font color="#000080">,
&gt;                        </font>lpSectorsPerCluster<font color="#000080">,
&gt;                        </font>lpBytesPerSector<font color="#000080">,
&gt;                        </font>lpFreeClusters<font color="#000080">,
&gt;                        </font>lpClusters<font color="#000080">);

</font>The help <font color="#FF0000"><b>file for </b></font>this <font color="#FF0000"><b>is</b></font><font color="#000080">:

</font>BOOL GetDiskFreeSpace<font color="#000080">(

    </font>LPCTSTR  lpRootPathName<font color="#000080">,    </font><font color="#008000"><i>// address of root path
    </i></font>LPDWORD  lpSectorsPerCluster<font color="#000080">,       </font><font color="#008000"><i>// address of sectors per cluster
    </i></font>LPDWORD  lpBytesPerSector<font color="#000080">,  </font><font color="#008000"><i>// address of bytes per sector
    </i></font>LPDWORD  lpNumberOfFreeClusters<font color="#000080">,    </font><font color="#008000"><i>// address of number of free clusters
    </i></font>LPDWORD  lpTotalNumberOfClusters    <font color="#008000"><i>// address of total number of clusters
   </i></font><font color="#000080">);

</font>Therefore<font color="#000080">, </font>define the following variables<font color="#000080">:

</font><font color="#FF0000"><b>Var </b></font>Path<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>Sectors<font color="#000080">,</font>Bytes<font color="#000080">,</font>free<font color="#000080">,</font>total<font color="#000080">:</font>DWORD<font color="#000080">;
      </font>FreeK<font color="#000080">,</font>TotalK <font color="#000080">:</font>Integer<font color="#000080">;

</font>Assign the root directory <font color="#FF0000"><b>of </b></font>some drive <font color="#FF0000"><b>to </b></font>PATH<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">,
</font><font color="#FF0000"><b>if </b></font>you want <font color="#FF0000"><b>to </b></font>get the information <font color="#FF0000"><b>for </b></font>drive C<font color="#000080">:, </font><font color="#FF0000"><b>then
  </b></font>PATH<font color="#000080">:=</font><font color="#800000">'C:\'</font><font color="#000080">;
</font><font color="#FF0000"><b>if </b></font>you want <font color="#FF0000"><b>to </b></font>get the information <font color="#FF0000"><b>for </b></font>volume SysVol <font color="#FF0000"><b>on
</b></font>server MainServer<font color="#000080">, </font><font color="#FF0000"><b>then
  </b></font>PATH<font color="#000080">:=</font><font color="#800000">'\\MainServer\SysVol\'</font><font color="#000080">;

</font>The code <font color="#FF0000"><b>to </b></font>retrieve the total Kilobytes <font color="#FF0000"><b>and </b></font>free Kilobytes <font color="#FF0000"><b>of </b></font>the
drive goes <font color="#FF0000"><b>as </b></font>follows<font color="#000080">:

</font><font color="#FF0000"><b>if </b></font>getdiskfreespace<font color="#000080">(</font>pchar<font color="#000080">(</font>Path<font color="#000080">),</font>sects<font color="#000080">,</font>bytes<font color="#000080">,</font>free<font color="#000080">,</font>total<font color="#000080">) </font><font color="#FF0000"><b>then
begin
   </b></font>totalK<font color="#000080">:=</font>trunc<font color="#000080">(((</font>sects<font color="#000080">*</font>bytes<font color="#000080">)/</font><font color="#800000">1024</font><font color="#000080">)*</font>total<font color="#000080">);
   </font>freeK<font color="#000080">:=</font>trunc<font color="#000080">(((</font>sects<font color="#000080">*</font>bytes<font color="#000080">)/</font><font color="#800000">1024</font><font color="#000080">)*</font>free<font color="#000080">);
</font><font color="#FF0000"><b>end else
begin
  </b></font><font color="#008000"><i>// error-- no access, drive doesn't provide this info, or drive doesn't exist
  </i></font>totalK<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>freeK<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>Use the same methodology <font color="#FF0000"><b>to </b></font>use the other similar API functions<font color="#000080">.
</font>I hope that helped<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0276.PAS">Original</a><b>]</b></p></body>
</html>
