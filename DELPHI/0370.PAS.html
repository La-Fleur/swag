<html>
<head><title> "Directory Tree to Menu" by VINCENT CROQUETTE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0370.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Procedure </b></font>FillTreeMenu<font color="#000080">(</font>MenuItem <font color="#000080">: </font>TMenuItem<font color="#000080">;</font><font color="#FF0000"><b>const </b></font>stPathName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>SearchRec <font color="#000080">: </font>TSearchRec<font color="#000080">;
</font>boTrouve <font color="#000080">: </font>Boolean<font color="#000080">;
</font>NewMenuItem <font color="#000080">: </font>TMenuItem<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>boTrouve <font color="#000080">:=  (</font>FindFirst<font color="#000080">(</font>stPathName <font color="#000080">+ </font><font color="#800000">'\*.*'</font><font color="#000080">, </font>faDirectory<font color="#000080">, </font>SearchRec<font color="#000080">) =  </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>boTrouve<font color="#000080">) </font><font color="#FF0000"><b>Do
  Begin
</b></font>  	<font color="#FF0000"><b>If </b></font><font color="#000080">(</font>SearchRec<font color="#000080">.</font>Name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>Then
    Begin
</b></font>    	<font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DirectoryExists<font color="#000080">(</font>stPathName <font color="#000080">+ </font><font color="#800000">'\' </font><font color="#000080">+ </font>SearchRec<font color="#000080">.</font>Name<font color="#000080">)) </font><font color="#FF0000"><b>Then
      Begin
</b></font>      	NewMenuItem <font color="#000080">:=  </font>TMenuItem<font color="#000080">.</font>Create<font color="#000080">(</font>MenuItem<font color="#000080">.</font>Owner<font color="#000080">);
        </font>NewMenuItem<font color="#000080">.</font>Caption <font color="#000080">:=  </font>SearchRec<font color="#000080">.</font>Name<font color="#000080">;
        </font>MenuItem<font color="#000080">.</font>Add<font color="#000080">(</font>NewMenuItem<font color="#000080">);
        </font>FillTreeMenu<font color="#000080">(</font>MenuItem<font color="#000080">.</font>Items<font color="#000080">[</font>MenuItem<font color="#000080">.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">], </font>stPathName <font color="#000080">+ = </font><font color="#800000">'\' </font><font color="#000080">+ </font>SearchRec<font color="#000080">.</font>Name<font color="#000080">);
</font>    	<font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>boTrouve <font color="#000080">:=  (</font>FindNext<font color="#000080">(</font>SearchRec<font color="#000080">) =  </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>FindClose<font color="#000080">(</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Tfrm_CassisComponentsTestForm<font color="#000080">.</font>bbtn_1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>	FillTreeMenu<font color="#000080">(</font>mnu_1<font color="#000080">.</font>Items<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">'c:'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>mnu_1 <font color="#FF0000"><b>is </b></font>your main menu <font color="#FF0000"><b>on </b></font>your form <font color="#FF0000"><b>for </b></font>which U must have at least <font color="#800000">1 </font><font color="#000080">=
</font>MenuItem <font color="#000080">(</font>Directory <font color="#FF0000"><b>for </b></font>instance<font color="#000080">).

</font>Assume that FileCtrl <font color="#FF0000"><b>is in </b></font>the <font color="#FF0000"><b>uses</b></font><font color="#000080">...

</font>Vincent Croquette


</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0370.PAS">Original</a><b>]</b></p></body>
</html>
