<html>
<head><title> "Creating and Using Parameterized Queries" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0121.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Q<font color="#000080">:  </font>How <font color="#FF0000"><b>do </b></font>I pass a variable <font color="#FF0000"><b>to </b></font>a query<font color="#000080">?

</font>A<font color="#000080">:  </font>First<font color="#000080">, </font>you must write a query that <font color="#FF0000"><b>uses </b></font>a variable<font color="#000080">.

</font>Select Test<font color="#000080">.&quot;</font>FName<font color="#000080">&quot;, </font>Test<font color="#000080">.&quot;</font>Salary <font color="#FF0000"><b>Of </b></font>Employee<font color="#000080">&quot;
</font>From Test
Where Test<font color="#000080">.&quot;</font>Salary <font color="#FF0000"><b>of </b></font>Employee<font color="#000080">&quot; &gt; :</font>val

Note<font color="#000080">:  </font><font color="#FF0000"><b>If </b></font>you just write the field name <font color="#FF0000"><b>as 
</b></font><font color="#000080">&quot;</font>Salary <font color="#FF0000"><b>of </b></font>Employee<font color="#000080">&quot; </font>you will get a Capability <font color="#FF0000"><b>Not
</b></font>Supported error<font color="#000080">.  </font>It must be Test<font color="#000080">.&quot;</font>Salary <font color="#FF0000"><b>of </b></font>Employee<font color="#000080">&quot;.

</font><font color="#FF0000"><b>In </b></font>this can the variable name <font color="#FF0000"><b>is </b></font><font color="#000080">&quot;</font>val<font color="#000080">&quot;, </font>but it can be whatever 
you want <font color="#000080">(</font><font color="#FF0000"><b>of </b></font>course<font color="#000080">).  </font><font color="#FF0000"><b>Then</b></font><font color="#000080">, </font>you go <font color="#FF0000"><b>to </b></font>the TQuery<font color="#800000">'s params 
</font><font color="#FF0000"><b>property and set </b></font>the <font color="#000080">&quot;</font>val<font color="#000080">&quot; </font>parameter <font color="#FF0000"><b>to </b></font>whatever the 
appropriate <font color="#FF0000"><b>type is</b></font><font color="#000080">. </font><font color="#FF0000"><b>In </b></font>our example here we will call it an 
integer<font color="#000080">.

</font>Next<font color="#000080">, </font>you <font color="#FF0000"><b>write </b></font>the code that sets the parameter<font color="#800000">'s value.  
</font>We will be setting the value from a TEdit box<font color="#000080">.

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  with </b></font>Query1 <font color="#FF0000"><b>do
  begin
    </b></font>Close<font color="#000080">;
    </font>ParamByName<font color="#000080">(</font><font color="#800000">'val'</font><font color="#000080">).</font>AsInteger <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>Edit1<font color="#000080">.</font>Text<font color="#000080">);
    </font>Open<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>Note<font color="#000080">:  </font>you may want <font color="#FF0000"><b>to </b></font>place this code <font color="#FF0000"><b>in </b></font>a <font color="#FF0000"><b>try</b></font><font color="#000080">..</font><font color="#FF0000"><b>except 
</b></font>block <font color="#FF0000"><b>as </b></font>a safety precaution<font color="#000080">.

</font><font color="#FF0000"><b>If </b></font>you want <font color="#FF0000"><b>to </b></font>use a LIKE <font color="#FF0000"><b>in </b></font>your query<font color="#000080">, </font>you can <font color="#FF0000"><b>do
</b></font>it this way<font color="#000080">:

</font>Note<font color="#000080">:  </font>This next section <font color="#FF0000"><b>uses </b></font>the customer table from
the <font color="#000080">\</font>delphi<font color="#000080">\</font>demos<font color="#000080">\</font>data directory<font color="#000080">.  </font>It can also be 
referenced by using the DBDEMOS alias<font color="#000080">.

</font>SQL code within the TQuery<font color="#000080">.</font>SQL <font color="#FF0000"><b>property</b></font><font color="#000080">:

  </font>SELECT <font color="#000080">* </font>FROM CUSTOMER
  WHERE Company LIKE <font color="#000080">:</font>CompanyName


Delphi code<font color="#000080">:

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  with </b></font>Query1 <font color="#FF0000"><b>do
  begin
    </b></font>Close<font color="#000080">;
    </font>ParamByName<font color="#000080">(</font><font color="#800000">'CompanyName'</font><font color="#000080">).</font>AsString <font color="#000080">:= </font>Edit1<font color="#000080">.</font>Text <font color="#000080">+ </font><font color="#800000">'%'</font><font color="#000080">;
    </font>Open<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>An alternate way <font color="#FF0000"><b>of </b></font>referencing a parameter 
<font color="#000080">(</font>other <font color="#FF0000"><b>then </b></font>ParamByName<font color="#000080">) </font><font color="#FF0000"><b>is </b></font>params<font color="#000080">[</font>TheParameterNumber<font color="#000080">].  

</font>The way that this line<font color="#000080">:

    </font>ParamByName<font color="#000080">(</font><font color="#800000">'CompanyName'</font><font color="#000080">).</font>AsString <font color="#000080">:= </font>Edit1<font color="#000080">.</font>Text <font color="#000080">+ </font><font color="#800000">'%'</font><font color="#000080">;

</font>can be alternately written <font color="#FF0000"><b>is</b></font><font color="#000080">:

    </font>Params<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">].</font>AsString <font color="#000080">:= </font>Edit1<font color="#000080">.</font>Text <font color="#000080">+ </font><font color="#800000">'%'</font><font color="#000080">;


</font>The trick <font color="#FF0000"><b>to </b></font>the wildcard <font color="#FF0000"><b>is in </b></font>the concatenating <font color="#FF0000"><b>of </b></font>the
percentage sign at the <font color="#FF0000"><b>end of </b></font>the parameter<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0121.PAS">Original</a><b>]</b></p></body>
</html>
