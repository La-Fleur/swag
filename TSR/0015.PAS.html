<html>
<head><title> "More TSR Stuff" by LOU DUCHEZ</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
LOU DUCHEZ

&gt;I recently wrote a short utility in TP.  I want to make it a TSR
&gt;which can be activated by a hotkey (like ALT-R).  Do I need to
&gt;redirect the Keyboard INT to my Program?

Right on the nose.

&gt;if so, then where does my Program direct the INT after that?

To the OLD keyboard interrupt.  You can use the GetIntVec to find
where the interrupt originally pointed; and trust me, it's a royal
pain in the keister to Program your own.  (Note: you'll want to
execute a PUSHF instruction before calling the &quot;old&quot; interrupt;
easily done With the built-in Assembler: Asm PUSHF end.)

Now, For reading the Alt-R: you can get the &quot;Alt&quot; key from
memory location $0040:$0017.  It Records the Alt key, shift keys,
caps lock, etc.  Each bit sets/reports whether the key is active or
inactive (&quot;1&quot; = &quot;active&quot;).  Like so:

Const insByte = $80;  capsByte = $40;  numByte   = $20;  scrollByte = $10;
      altByte = $08;  ctrlByte = $04;  lshftByte = $02;  rshftByte  = $01;

Var keyboardstat: Byte Absolute $0040:$0017;

To test if Alt is on, see if this expression evaluates to &quot;True&quot;:

      keyboardstat and altByte = altByte

As For the &quot;R&quot;, check port $60 (the keyboard port) For scan code $13.
(Maybe ya oughtta find a complete list of the scan codes.)

&gt;Also, I want my Window to disappear when my Program
&gt;is finished (and the previous screen to come back).
&gt;How can I do this?

Store the old screen into memory.  Hint: on Mono systems, it's the
4000 Bytes starting at b000:0000; on color, it's the 4000 starting
at b800:0000.  Use the &quot;Move&quot; Procedure first to move the 4000 Bytes
to an Array of 4000 Characters, then use &quot;Move&quot; to move the 4000 Bytes
back to the video location.

&gt;  (BTW, I could do all this on the Commodore 64 back in the good 'ol
&gt;days when the 64 was king.  Life was much simpler then).

Yeah, I can hear ya now: &quot;Oh you spoiled kids.  When I started in
computers, we had only 64k to work With, and we LIKED it!  And we
didn't waste our money on a separate 'monitor', oh no! we just hooked
our computers up to the TV.  Damn kids these days.&quot;
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p></body>
</html>
