<html>
<head><title> "Clock 2" by AMIR FRENKEL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; H E L P!!!  I need help with the timer Interrupt... I guess?  Here
&gt; is what I would like to do, I want to have the Time in the upper right
&gt; hand corner updated by the second.  I was told that I need to &quot;hook in
&gt; to the timmer interrupt&quot; but, how do I do that?  Any help would be
&gt; appreciated.  And if possible make it as non technical as possable.

Here is just the program your looking for!
}
</i></font><font color="#FF0000"><b>Program </b></font>Clock_demo<font color="#000080">;
</font><font color="#008000"><i>{$M $400 ,0 ,0}                       { Stack Size $400 , No Heap      }
{$F+}
</i></font><font color="#FF0000"><b>Uses </b></font>Dos <font color="#000080">,</font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>Var
    </b></font>Count<font color="#000080">:</font>Byte<font color="#000080">;                       </font><font color="#008000"><i>{ Counts Seconds                }
    </i></font>Time<font color="#000080">:</font>Longint  <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$6C</font><font color="#000080">;   </font><font color="#008000"><i>{ Bios Keeps Clock Time Here    }
    </i></font>Old1Cint<font color="#000080">:</font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;               </font><font color="#008000"><i>{ Linkage To Old 1C Interrupt   }


{ Every 18 Pulses Shows Time At The Left Corner Of Screen }
</i></font><font color="#FF0000"><b>Procedure </b></font>Get_Time<font color="#000080">;</font>Interrupt<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>X <font color="#000080">,</font>Y<font color="#000080">:</font>Byte<font color="#000080">;
    </font>Hour <font color="#000080">,</font>Minute <font color="#000080">,</font>Sec<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Inc<font color="#000080">(</font>Count<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Count <font color="#000080">=</font><font color="#800000">18 </font><font color="#FF0000"><b>Then                        </b></font><font color="#008000"><i>{ Every Second 18.2 Pulses      }
    </i></font><font color="#FF0000"><b>Begin
      </b></font>Count<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font>X<font color="#000080">:=</font>Wherex<font color="#000080">;                           </font><font color="#008000"><i>{ Save Cursor Place             }
      </i></font>Y<font color="#000080">:=</font>Wherey<font color="#000080">;
      </font>Hour<font color="#000080">:=</font>Time <font color="#FF0000"><b>Div </b></font><font color="#800000">65520</font><font color="#000080">;                </font><font color="#008000"><i>{ Calculate Hours. In Each Hour }
                                           { 18.2 * 60 * 60 Pulses         }
      </i></font>Minute<font color="#000080">:=</font>Time <font color="#FF0000"><b>Mod </b></font><font color="#800000">65520 </font><font color="#FF0000"><b>Div </b></font><font color="#800000">1092</font><font color="#000080">;     </font><font color="#008000"><i>{ Calculate Minutes. In Each    }
                                           { Minute 18.2 * 60 Pulses       }
      </i></font>Sec<font color="#000080">:=</font>Round<font color="#000080">((</font>Time <font color="#FF0000"><b>Mod </b></font><font color="#800000">65520 </font><font color="#FF0000"><b>Mod </b></font><font color="#800000">1092</font><font color="#000080">) / </font><font color="#800000">18.2</font><font color="#000080">) </font><font color="#FF0000"><b>Mod </b></font><font color="#800000">60</font><font color="#000080">; </font><font color="#008000"><i>{ Seconds       }
      </i></font>Gotoxy<font color="#000080">(</font><font color="#800000">70 </font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);                       </font><font color="#008000"><i>{ Left Corner Of Screen         }
                                           { Write time                    }
      </i></font><font color="#FF0000"><b>If </b></font>Hour<font color="#000080">&lt;</font><font color="#800000">10 </font><font color="#FF0000"><b>Then
        </b></font>Write<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>Hour<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else
        </b></font>Write<font color="#000080">(</font>Hour<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Minute<font color="#000080">&lt;</font><font color="#800000">10 </font><font color="#FF0000"><b>Then
        </b></font>Write<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>Minute<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else
        </b></font>Write<font color="#000080">(</font>Minute<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Sec<font color="#000080">&lt;</font><font color="#800000">10 </font><font color="#FF0000"><b>Then
        </b></font>Write<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>Sec<font color="#000080">)
      </font><font color="#FF0000"><b>Else
        </b></font>Write<font color="#000080">(</font>Sec<font color="#000080">);
      </font>Gotoxy<font color="#000080">(</font>X <font color="#000080">,</font>Y<font color="#000080">);                        </font><font color="#008000"><i>{ Restore Cursor Position       }
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Inline</b></font><font color="#000080">(</font><font color="#800000">$9C</font><font color="#000080">);                             </font><font color="#008000"><i>{ Pushf - Push Flags            }
  </i></font>Old1Cint<font color="#000080">;                                </font><font color="#008000"><i>{ Link Old 1C Procedure         }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin                          </b></font><font color="#008000"><i>{ Of Main Program                     }
  </i></font>Count<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;                    </font><font color="#008000"><i>{ Clock Pulses Counter                }
  </i></font>Getintvec<font color="#000080">(</font><font color="#800000">$1C </font><font color="#000080">,@</font>Old1Cint<font color="#000080">);   </font><font color="#008000"><i>{ Save Old 1C Interrupt Vector        }
  </i></font>Setintvec<font color="#000080">(</font><font color="#800000">$1C </font><font color="#000080">,@</font>Get_Time<font color="#000080">);   </font><font color="#008000"><i>{ Insert Current Interurupt Procedure }
  </i></font>Keep<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);                     </font><font color="#008000"><i>{ Terminate And Stay Resident - Tsr   }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p></body>
</html>
