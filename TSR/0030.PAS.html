<html>
<head><title> "Screen Blanker" by MAYNARD PHILBROOK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0030.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Screen Blanker , Tsr Example only, By Maynard Philbrook ,VGA Type
From: Maynard.Philbrook@trisoft.com (Maynard Philbrook)
}
{$F+,S-,D-,I-,V-,R-}
 {$M 1024, 0,0} { Reduce Memory to the minimum }
</i></font><font color="#FF0000"><b>Uses </b></font>DOs<font color="#000080">;
</font><font color="#FF0000"><b>Var
 </b></font>OLDINT09<font color="#000080">, </font>OLDINT08<font color="#000080">:</font>pointer<font color="#000080">;
 </font>IsScreenOn <font color="#000080">:</font>Boolean<font color="#000080">;
 </font>DownCounter <font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>NewKeyBoardHandler<font color="#000080">; </font>Interrupt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 ASm    </b></font><font color="#FF00FF">PushF;
       Call OldInt09;
       Cmp IsScreenOn, True;
        Je     @Done;
        Mov DX, $03C4;  </font><font color="#008000"><i>{ Tell VGA Card Which Reg we want &quot;Index Reg&quot;}
        </i></font><font color="#FF00FF">Mov AL, 01;
        Out DX,AL;     </font><font color="#008000"><i>{ Make sure we are in the correct Regs }
        </i></font><font color="#FF00FF">Inc DX;         </font><font color="#008000"><i>{ Move to the Data Reg now }
        </i></font><font color="#FF00FF">IN  AL, DX;     </font><font color="#008000"><i>{ get the curent  value of the CLocking Mode 
Reg}
        </i></font><font color="#FF00FF">And AL ,($FF-$20); </font><font color="#008000"><i>{ Turn off Blanker Bit }
        </i></font><font color="#FF00FF">Out DX, AL;    </font><font color="#008000"><i>{ Send New Value to Port, WRite it Back }
        </i></font><font color="#FF00FF">mov IsScreenOn, True;
@Done:
       Mov DownCounter, 50; </font><font color="#008000"><i>{ Set for 50 Ticks for Now }
 </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>NewTimerHandler<font color="#000080">; </font>Interrupt<font color="#000080">;
</font><font color="#FF0000"><b>begin
 ASm
    </b></font><font color="#FF00FF">PushF;
    Call Oldint08;
    Mov BX, DownCounter;
    Cmp BX, 0;
    Je  @Done;
    Dec        BX;
    Jnz  @Done;
    Mov DX, $03C4;  </font><font color="#008000"><i>{ Tell VGA Card Which Reg we want &quot;Index Reg&quot;}
    </i></font><font color="#FF00FF">Mov AL, 01;
    Out DX,AL; </font><font color="#008000"><i>{ Make sure we are in the correct Regs }
    </i></font><font color="#FF00FF">Inc DX;         </font><font color="#008000"><i>{ Move to the Data Reg now }
    </i></font><font color="#FF00FF">IN  AL, DX;     </font><font color="#008000"><i>{ get the curent  value of the CLocking Mode Reg}
    </i></font><font color="#FF00FF">Or  AL ,$20; </font><font color="#008000"><i>{ Turn off Blanker Bit }
    </i></font><font color="#FF00FF">Out DX, AL;         </font><font color="#008000"><i>{ Send New Value to Port, WRite it Back }
    </i></font><font color="#FF00FF">Mov IsScreenOn, False;
@Done:
    Mov DownCounter, BX;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>GetINtVec<font color="#000080">(</font><font color="#800000">$09</font><font color="#000080">, </font>OLDINT09<font color="#000080">);
 </font>GetIntVec<font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">, </font>OLDINT08<font color="#000080">);
 </font>SetIntVec<font color="#000080">(</font><font color="#800000">$09</font><font color="#000080">, @</font>NewKeyBoardHandler<font color="#000080">);
 </font>SetIntVec<font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">, @</font>NewTimerHandler<font color="#000080">);
 </font>IsScreenOn <font color="#000080">:= </font>True<font color="#000080">;
   </font><font color="#008000"><i>{ The Following is a Test }
 </i></font>Readln<font color="#000080">;
 </font>SetIntVec<font color="#000080">(</font><font color="#800000">$09</font><font color="#000080">, </font>OldINt09<font color="#000080">); </font><font color="#008000"><i>{ Restore Vectors after test }
 </i></font>SetIntVec<font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">, </font>OldINt08<font color="#000080">);
 </font><font color="#008000"><i>{ End of Test}
 { To used as a TSR Exit the program With out restoring Vectors Like
So}
 { KEEP(0) }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0030.PAS">Original</a><b>]</b></p></body>
</html>
