<html>
<head><title> "CLKTSR.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$A+,B-,D-,E-,F-,I-,L-,N-,O-,R-,S-,V-}
{$M 1024,0,0}
</i></font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">,
     </font>clock<font color="#000080">;  </font><font color="#008000"><i>{ My clock ISR Unit in next message. }
</i></font><font color="#FF0000"><b>Const
  </b></font>IRet  <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">$cf</font><font color="#000080">;
  </font>IDStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">13</font><font color="#000080">]=</font><font color="#800000">'TeeCee''s Clock'</font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>p <font color="#000080">: </font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetIntVec<font color="#000080">(</font><font color="#800000">$66</font><font color="#000080">,</font>p<font color="#000080">);  </font><font color="#008000"><i>{ Int 66h is reserved For user defined interrupts }
  </i></font>inc<font color="#000080">(</font>LongInt<font color="#000080">(</font>p<font color="#000080">),</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>if String</b></font><font color="#000080">(</font>p<font color="#000080">^) = </font>IDStr <font color="#FF0000"><b>then begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'TeeCee''s clock is already installed - you must be blind!'</font><font color="#000080">);
    </font>halt<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'TeeCee''s clock is now installed For demo purposes only'</font><font color="#000080">);
    </font>SetIntVec<font color="#000080">(</font><font color="#800000">$66</font><font color="#000080">,@</font>IRet<font color="#000080">);   </font><font color="#008000"><i>{ IRet is obviously not an interrupt!      }
    { What we are actually doing is storing a Pointer to the IDStr     }
    { in the vector table - much like the way the Video font addresses }
    { are stored.                                                      }
    </i></font>SwapVectors<font color="#000080">;
    </font>Keep<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

(</font>See the next <font color="#FF0000"><b>message For </b></font>the <font color="#FF0000"><b>Unit </b></font>Clock<font color="#000080">. )

</font>Now that <font color="#FF0000"><b>is </b></font>definintely <font color="#FF0000"><b>For </b></font>demonstration purposes only<font color="#000080">!  </font>It will work but has 
several serious shortcomings<font color="#000080">!

</font>Firstly<font color="#000080">, </font>it hooks the user defined interrupt <font color="#800000">$66 </font><font color="#FF0000"><b>to </b></font>allow any subsequent 
executions <font color="#FF0000"><b>to </b></font>determine <font color="#FF0000"><b>if </b></font>the <font color="#FF0000"><b>Program is </b></font>already installed<font color="#000080">.  </font>It does this 
without making any checks <font color="#FF0000"><b>as to </b></font>whether <font color="#FF0000"><b>or not </b></font>something <font color="#FF0000"><b>else </b></font>already <font color="#000080">&quot;</font>owns<font color="#000080">&quot; 
</font>this vector<font color="#000080">. </font><font color="#FF0000"><b>Not </b></font>very smart<font color="#000080">!

</font>Secondly<font color="#000080">, </font>it provides no means <font color="#FF0000"><b>to </b></font>uninstall itself<font color="#000080">.  </font>Mmmmm<font color="#000080">...  :-(

</font>Thirdly<font color="#000080">, </font>Graphics mode will cause problems<font color="#000080">.  </font>Again <font color="#000080">- </font><font color="#FF0000"><b>not </b></font>terribly smart<font color="#000080">!

</font><font color="#FF0000"><b>Finally</b></font><font color="#000080">, </font>TSRs are <font color="#FF0000"><b>not For </b></font>the faint<font color="#000080">-</font><font color="#FF0000"><b>of</b></font><font color="#000080">-</font>heart <font color="#FF0000"><b>or </b></font>beginner<font color="#000080">. </font>They are an 
extraordinarily complex <font color="#FF0000"><b>and </b></font>difficult part <font color="#FF0000"><b>of </b></font>Dos Programming <font color="#FF0000"><b>and if </b></font>you are 
serious about getting into TSRs <font color="#FF0000"><b>then </b></font>get <font color="#FF0000"><b>as </b></font>many good books <font color="#FF0000"><b>as </b></font>you can find 
that authoritively discuss the subject<font color="#000080">.  </font>Buying a good commercial toolbox<font color="#000080">, </font>such 
<font color="#FF0000"><b>as </b></font>Turbo Power<font color="#800000">'s &quot;TSRs Made Easy&quot; is another smart move, as studying how the 
</font>masters <font color="#FF0000"><b>do </b></font>it <font color="#FF0000"><b>is </b></font>one <font color="#FF0000"><b>of </b></font>the best ways <font color="#FF0000"><b>to </b></font>learn<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p></body>
</html>
