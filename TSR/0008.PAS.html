<html>
<head><title> "Write to DISK in a TSR" by STEVE MULLIGAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">===========================================================================
 </font>BBS<font color="#000080">: </font>Canada Remote Systems
Date<font color="#000080">: </font><font color="#800000">06</font><font color="#000080">-</font><font color="#800000">23</font><font color="#000080">-</font><font color="#800000">93 </font><font color="#000080">(</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">24</font><font color="#000080">)             </font>Number<font color="#000080">: </font><font color="#800000">27349
</font>From<font color="#000080">: </font>STEVE MULLIGAN               Refer<font color="#800000">#</font><font color="#000080">: </font>NONE
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>EDWARD WALKER                 Recvd<font color="#000080">: </font>NO  
Subj<font color="#000080">: </font>TSRS THAT WRITE <font color="#FF0000"><b>TO </b></font>DISK<font color="#000080">..      </font>Conf<font color="#000080">: (</font><font color="#800000">1221</font><font color="#000080">) </font>F<font color="#000080">-</font><font color="#FF0000"><b>PASCAL
</b></font><font color="#000080">---------------------------------------------------------------------------
</font>Tuesday June <font color="#800000">22 1993 02</font><font color="#000080">:</font><font color="#800000">38</font><font color="#000080">, </font>Edward Walker wrote <font color="#FF0000"><b>to </b></font>All<font color="#000080">:

 </font>EW<font color="#000080">&gt; </font>What <font color="#FF0000"><b>do </b></font>I need <font color="#FF0000"><b>to set </b></font>up <font color="#FF0000"><b>in </b></font>the code <font color="#FF0000"><b>to </b></font>write <font color="#FF0000"><b>to </b></font>disk <font color="#FF0000"><b>in </b></font>a TSR<font color="#000080">?

</font>Here<font color="#800000">'s a TSR called BootRes.  It opens a file and writes to disk every x
</font>seconds <font color="#000080">:

=-=-=-=-=-=-=-=-= </font>PART <font color="#800000">1 </font><font color="#000080">=-=-=-=-=-=-=-=-=-=
</font><font color="#FF0000"><b>program </b></font>BootRes<font color="#000080">;

</font><font color="#008000"><i>{$M 2048,0,0}
{$F+}

</i></font><font color="#FF0000"><b>Uses </b></font>BootVars<font color="#000080">, </font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>const
 </b></font>OLDSTACKSS <font color="#000080">:  </font>WORD <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
 </font>OLDSTACKSP <font color="#000080">:  </font>WORD <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
 </font>STACKSW <font color="#000080">:    </font>INTEGER <font color="#000080">= - </font><font color="#800000">1</font><font color="#000080">;
 </font>OurStackSeg <font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
 </font>OurStackSp  <font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
 </font>DosDelimSet <font color="#000080">: </font><font color="#FF0000"><b>set of </b></font>Char <font color="#000080">= [</font><font color="#800000">'\'</font><font color="#000080">, </font><font color="#800000">':'</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">];

</font><font color="#FF0000"><b>var
 </b></font>R                    <font color="#000080">: </font>registers<font color="#000080">;
 </font>DosSeg<font color="#000080">, </font>DosBusy              <font color="#000080">: </font>word<font color="#000080">;
 </font>Tick<font color="#000080">, </font>WaitBuf               <font color="#000080">: </font>integer<font color="#000080">;
 </font>NeedPop                 <font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>BEGINint<font color="#000080">;
</font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/</font>STACKSW<font color="#000080">/
   </font><font color="#800000">$75</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/
   </font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/</font>OLDSTACKSS<font color="#000080">/
       </font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/</font>OLDSTACKSP<font color="#000080">/
       </font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/</font>OURSTACKSEG<font color="#000080">/
       </font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/</font>OURSTACKSP<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>ENDint<font color="#000080">;
</font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$0E</font><font color="#000080">/</font>STACKSW<font color="#000080">/
       </font><font color="#800000">$7D</font><font color="#000080">/</font><font color="#800000">$08</font><font color="#000080">/
       </font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/</font>OLDSTACKSS<font color="#000080">/
   </font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/</font>OLDSTACKSP<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>CALLPOP<font color="#000080">(</font>SUB<font color="#000080">:</font>POINTER<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
INLINE</b></font><font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$5E</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>CLI<font color="#000080">; </font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FA</font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>STI<font color="#000080">; </font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FB</font><font color="#000080">);

</font><font color="#FF0000"><b>function </b></font>Exist<font color="#000080">(</font>fname <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
     </b></font>f1  <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;  </font>err <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>{$I-}
     </i></font>assign<font color="#000080">(</font>f1<font color="#000080">,</font>fname<font color="#000080">);     </font>reset<font color="#000080">(</font>f1<font color="#000080">);     </font>err <font color="#000080">:= </font>ioresult<font color="#000080">;
     </font><font color="#008000"><i>{$I+}
     </i></font><font color="#FF0000"><b>if  </b></font>err <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>close<font color="#000080">(</font>f1<font color="#000080">);     </font>exist <font color="#000080">:= </font>err <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>AddBackSlash<font color="#000080">(</font>DirName <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#008000"><i>{-Add a default backslash to a directory name}
  </i></font><font color="#FF0000"><b>begin
    if </b></font>DirName<font color="#000080">[</font>Length<font color="#000080">(</font>DirName<font color="#000080">)] </font><font color="#FF0000"><b>in </b></font>DosDelimSet <font color="#FF0000"><b>then
      </b></font>AddBackSlash <font color="#000080">:= </font>DirName
    <font color="#FF0000"><b>else
      </b></font>AddBackSlash <font color="#000080">:= </font>DirName<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TsrCrap<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>CLI<font color="#000080">;
 </font>BEGINint<font color="#000080">;
 </font>STI<font color="#000080">;

 </font>NeedPop <font color="#000080">:= </font>False<font color="#000080">;

 </font>GetDate<font color="#000080">(</font>h<font color="#000080">, </font>m<font color="#000080">, </font>s<font color="#000080">, </font>hund<font color="#000080">);
 </font>TimeLoad<font color="#000080">.</font>Year <font color="#000080">:= </font>h<font color="#000080">;
 </font>TimeLoad<font color="#000080">.</font>Month <font color="#000080">:= </font>m<font color="#000080">;
 </font>TimeLoad<font color="#000080">.</font>Day <font color="#000080">:= </font>s<font color="#000080">;
 </font>GetTime<font color="#000080">(</font>h<font color="#000080">, </font>m<font color="#000080">, </font>s<font color="#000080">, </font>hund<font color="#000080">);
 </font>TimeLoad<font color="#000080">.</font>Hour <font color="#000080">:= </font>h<font color="#000080">;
 </font>TimeLoad<font color="#000080">.</font>Min <font color="#000080">:= </font>m<font color="#000080">;
 </font>TimeLoad<font color="#000080">.</font>Sec <font color="#000080">:= </font>s<font color="#000080">;

 </font>DoDate<font color="#000080">;
 </font>DoDate2<font color="#000080">;

 </font><font color="#FF0000"><b>if not </b></font>exist<font color="#000080">(</font>LogName<font color="#000080">) </font><font color="#FF0000"><b>then begin
  </b></font>assign<font color="#000080">(</font>LogFile<font color="#000080">, </font>LogName<font color="#000080">);
  </font>rewrite<font color="#000080">(</font>LogFile<font color="#000080">);
  </font>write<font color="#000080">(</font>LogFile<font color="#000080">, </font>LogRec<font color="#000080">);
  </font>close<font color="#000080">(</font>LogFile<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font>assign<font color="#000080">(</font>LogFile<font color="#000080">, </font>LogName<font color="#000080">);
 </font>reset<font color="#000080">(</font>LogFile<font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font>FileSize<font color="#000080">(</font>LogFile<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
  </b></font>close<font color="#000080">(</font>LogFile<font color="#000080">);
  </font>assign<font color="#000080">(</font>LogFile<font color="#000080">, </font>LogName<font color="#000080">);
  </font>rewrite<font color="#000080">(</font>LogFile<font color="#000080">);
  </font>write<font color="#000080">(</font>LogFile<font color="#000080">, </font>LogRec<font color="#000080">);
  </font>close<font color="#000080">(</font>LogFile<font color="#000080">);
  </font>assign<font color="#000080">(</font>LogFile<font color="#000080">, </font>LogName<font color="#000080">);
  </font>reset<font color="#000080">(</font>LogFile<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>seek<font color="#000080">(</font>LogFile<font color="#000080">, </font>FileSize<font color="#000080">(</font>LogFile<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
 </font>read<font color="#000080">(</font>LogFile<font color="#000080">, </font>LogRec<font color="#000080">);
 </font>DoDate2<font color="#000080">;
 </font>seek<font color="#000080">(</font>LogFile<font color="#000080">, </font>FileSize<font color="#000080">(</font>LogFile<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
 </font>write<font color="#000080">(</font>LogFile<font color="#000080">, </font>LogRec<font color="#000080">);
 </font>close<font color="#000080">(</font>LogFile<font color="#000080">);
 </font>Tick <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

 </font>CLI<font color="#000080">;
 </font>ENDint<font color="#000080">;
 </font>STI<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
=-=-=-=-=-=-=-=-= </font>PART <font color="#800000">1 </font><font color="#000080">=-=-=-=-=-=-=-=-=-=

--- </font>GoldED <font color="#800000">2.41
 </font><font color="#000080">* </font>Origin<font color="#000080">: </font>Ask me about SubMove <font color="#000080">* </font>Carp<font color="#000080">, </font>Ontario <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">163</font><font color="#000080">/</font><font color="#800000">307.30</font><font color="#000080">)
===========================================================================
 </font>BBS<font color="#000080">: </font>Canada Remote Systems
Date<font color="#000080">: </font><font color="#800000">06</font><font color="#000080">-</font><font color="#800000">23</font><font color="#000080">-</font><font color="#800000">93 </font><font color="#000080">(</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">25</font><font color="#000080">)             </font>Number<font color="#000080">: </font><font color="#800000">27350
</font>From<font color="#000080">: </font>STEVE MULLIGAN               Refer<font color="#800000">#</font><font color="#000080">: </font>NONE
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>EDWARD WALKER                 Recvd<font color="#000080">: </font>NO  
Subj<font color="#000080">: </font>TSRS THAT WRITE <font color="#FF0000"><b>TO </b></font>DISK<font color="#000080">..      </font>Conf<font color="#000080">: (</font><font color="#800000">1221</font><font color="#000080">) </font>F<font color="#000080">-</font><font color="#FF0000"><b>PASCAL
</b></font><font color="#000080">---------------------------------------------------------------------------
=-=-=-=-=-=-=-=-= </font>PART <font color="#800000">2 </font><font color="#000080">=-=-=-=-=-=-=-=-=-=
</font><font color="#FF0000"><b>procedure </b></font>RunTSR<font color="#000080">; </font>Interrupt<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>CLI<font color="#000080">;
 </font>BEGINint<font color="#000080">;
 </font>STI<font color="#000080">;
 </font>inc<font color="#000080">(</font>Tick<font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font>Tick <font color="#000080">&gt; </font><font color="#800000">18.2 </font><font color="#000080">* </font>WaitBuf <font color="#FF0000"><b>then begin
  </b></font>NeedPop <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>MEM<font color="#000080">[</font>DosSeg<font color="#000080">:</font>DosBusy<font color="#000080">] = </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
   </b></font>NeedPop <font color="#000080">:= </font>False<font color="#000080">;
   </font>PORT<font color="#000080">[</font><font color="#800000">$20</font><font color="#000080">] := </font><font color="#800000">$20</font><font color="#000080">;
   </font>TsrCrap<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>CLI<font color="#000080">;
 </font>ENDint<font color="#000080">;
 </font>STI<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Int28TSR<font color="#000080">; </font>Interrupt<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>CLI<font color="#000080">;
 </font>BEGINint<font color="#000080">;
 </font>STI<font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>NeedPop <font color="#000080">= </font>True <font color="#FF0000"><b>then </b></font>TsrCrap<font color="#000080">;
 </font>CLI<font color="#000080">;
 </font>ENDint<font color="#000080">;
 </font>STI<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>InitTSR<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>OurStackSeg <font color="#000080">:= </font>SSEG<font color="#000080">;
 </font><font color="#FF0000"><b>InLine</b></font><font color="#000080">(</font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/</font>OurStackSp<font color="#000080">);
 </font>R<font color="#000080">.</font>Ah <font color="#000080">:= </font><font color="#800000">$34</font><font color="#000080">;
 </font>MSDOS<font color="#000080">(</font>R<font color="#000080">);
 </font>DosSeg <font color="#000080">:= </font>R<font color="#000080">.</font>ES<font color="#000080">;
 </font>DosBusy <font color="#000080">:= </font>R<font color="#000080">.</font>BX<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ShowHelp<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>writeln<font color="#000080">(</font><font color="#800000">'Usage : BOOTRES &lt;command line options&gt;'</font><font color="#000080">);
 </font>writeln<font color="#000080">;
 </font>writeln<font color="#000080">(</font><font color="#800000">'Valid Options : #    Number of seconds to wait before writing current
</font>time<font color="#800000">');
 </font>writeln<font color="#000080">(</font><font color="#800000">'                /?   This screen'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>InitTSR<font color="#000080">;

 </font>GetDir<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>LogName<font color="#000080">);
 </font>LogName <font color="#000080">:= </font>AddBackSlash<font color="#000080">(</font>LogName<font color="#000080">) + </font><font color="#800000">'BOOTLOG.DAT'</font><font color="#000080">;
 </font>WaitBuf <font color="#000080">:= </font><font color="#800000">60</font><font color="#000080">;

 </font>writeln<font color="#000080">;

 </font><font color="#FF0000"><b>if </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
  if </b></font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'/?' </font><font color="#FF0000"><b>then begin
   </b></font>ShowHelp<font color="#000080">;
   </font>halt<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">), </font>WaitBuf<font color="#000080">, </font>Tick<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Tick <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">((</font>WaitBuf <font color="#000080">&gt; </font><font color="#800000">60 </font><font color="#000080">* </font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>WaitBuf <font color="#000080">&lt; </font><font color="#800000">5</font><font color="#000080">)) </font><font color="#FF0000"><b>then begin
   </b></font>writeln<font color="#000080">(</font><font color="#800000">'Must be an integer between 5 and '</font><font color="#000080">, </font><font color="#800000">60 </font><font color="#000080">* </font><font color="#800000">10</font><font color="#000080">);
   </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end else begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'Type BOOTRES /? for help'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font>Tick <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

 </font>SetIntVec<font color="#000080">(</font><font color="#800000">$28</font><font color="#000080">,@</font>Int28TSR<font color="#000080">);
 </font>SetIntVec<font color="#000080">(</font><font color="#800000">$1C</font><font color="#000080">,@</font>RunTSR<font color="#000080">);

 </font>writeln<font color="#000080">(</font><font color="#800000">'BootRes installed'</font><font color="#000080">);

 </font>keep<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">. =-=-=-=-=-=-=-=-= </font>PART <font color="#800000">2 </font><font color="#000080">=-=-=-=-=-=-=-=-=-=

--- </font>GoldED <font color="#800000">2.41
 </font><font color="#000080">* </font>Origin<font color="#000080">: </font>Ask me about VoteFix <font color="#000080">* </font>Carp<font color="#000080">, </font>Ontario <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">163</font><font color="#000080">/</font><font color="#800000">307.30</font><font color="#000080">)
===========================================================================
 </font>BBS<font color="#000080">: </font>Canada Remote Systems
Date<font color="#000080">: </font><font color="#800000">06</font><font color="#000080">-</font><font color="#800000">23</font><font color="#000080">-</font><font color="#800000">93 </font><font color="#000080">(</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">26</font><font color="#000080">)             </font>Number<font color="#000080">: </font><font color="#800000">27351
</font>From<font color="#000080">: </font>STEVE MULLIGAN               Refer<font color="#800000">#</font><font color="#000080">: </font>NONE
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>EDWARD WALKER                 Recvd<font color="#000080">: </font>NO  
Subj<font color="#000080">: </font>TSRS THAT WRITE <font color="#FF0000"><b>TO </b></font>DISK<font color="#000080">..      </font>Conf<font color="#000080">: (</font><font color="#800000">1221</font><font color="#000080">) </font>F<font color="#000080">-</font><font color="#FF0000"><b>PASCAL
</b></font><font color="#000080">---------------------------------------------------------------------------
=-=-=-=-=-=-=-=-= </font>PART <font color="#800000">3 </font><font color="#000080">=-=-=-=-=-=-=-=-=-=
</font><font color="#FF0000"><b>unit </b></font>BootVars<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>const
 </b></font>Version  <font color="#000080">= </font><font color="#800000">'1.00'</font><font color="#000080">;
 </font>ProgName <font color="#000080">= </font><font color="#800000">'BootLog'</font><font color="#000080">;
        </font>CopYear  <font color="#000080">= </font><font color="#800000">'1992 - 1993'</font><font color="#000080">;

</font><font color="#FF0000"><b>type
 </b></font>LogType <font color="#000080">= </font><font color="#FF0000"><b>record
  </b></font>TimeLoad <font color="#000080">: </font>DateTime<font color="#000080">;
  </font>TimeOff <font color="#000080">: </font>DateTime<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
 </b></font>LogFile    <font color="#000080">: </font><font color="#FF0000"><b>file of </b></font>LogType<font color="#000080">;
 </font>LogRec    <font color="#000080">: </font>LogType<font color="#000080">;
 </font>h<font color="#000080">, </font>m<font color="#000080">, </font>s<font color="#000080">, </font>hund  <font color="#000080">: </font>word<font color="#000080">;
 </font>TimeLoad<font color="#000080">, </font>TimeOff <font color="#000080">: </font>DateTime<font color="#000080">;
 </font>LogName    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DoDate<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DoDate2<font color="#000080">;

</font><font color="#FF0000"><b>implementation

procedure </b></font>DoDate<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>LogRec<font color="#000080">.</font>TimeLoad<font color="#000080">.</font>Year  <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Year<font color="#000080">;
 </font>LogRec<font color="#000080">.</font>TimeLoad<font color="#000080">.</font>Month <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Month<font color="#000080">;
 </font>LogRec<font color="#000080">.</font>TimeLoad<font color="#000080">.</font>Day   <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Day<font color="#000080">;
 </font>LogRec<font color="#000080">.</font>TimeLoad<font color="#000080">.</font>Hour  <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Hour<font color="#000080">;
 </font>LogRec<font color="#000080">.</font>TimeLoad<font color="#000080">.</font>Min   <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Min<font color="#000080">;
 </font>LogRec<font color="#000080">.</font>TimeLoad<font color="#000080">.</font>Sec   <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Sec<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DoDate2<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>LogRec<font color="#000080">.</font>TimeOff<font color="#000080">.</font>Year   <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Year<font color="#000080">;
 </font>LogRec<font color="#000080">.</font>TimeOff<font color="#000080">.</font>Month  <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Month<font color="#000080">;
 </font>LogRec<font color="#000080">.</font>TimeOff<font color="#000080">.</font>Day    <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Day<font color="#000080">;
 </font>LogRec<font color="#000080">.</font>TimeOff<font color="#000080">.</font>Hour   <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Hour<font color="#000080">;
 </font>LogRec<font color="#000080">.</font>TimeOff<font color="#000080">.</font>Min    <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Min<font color="#000080">;
 </font>LogRec<font color="#000080">.</font>TimeOff<font color="#000080">.</font>Sec    <font color="#000080">:= </font>TimeLoad<font color="#000080">.</font>Sec<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
=-=-=-=-=-=-=-=-= </font>PART <font color="#800000">3 </font><font color="#000080">=-=-=-=-=-=-=-=-=-=

--- </font>GoldED <font color="#800000">2.41
 </font><font color="#000080">* </font>Origin<font color="#000080">: </font>Ask me about SubMove <font color="#000080">* </font>Carp<font color="#000080">, </font>Ontario <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">163</font><font color="#000080">/</font><font color="#800000">307.30</font><font color="#000080">)
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p></body>
</html>
