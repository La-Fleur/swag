<html>
<head><title> "TSR" by JUAN JOSE VERGARA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0025.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ This TSR, when press Crtl+Print Screen save to disk the screen. }
{Antonio Moro's routines, from Spain TP Echo}
{$M 1024, 0, 0}  (* 1 K for Stack *)
{$S-}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>Caza<font color="#000080">;
</font><font color="#FF0000"><b>USES </b></font>Dos<font color="#000080">, </font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>VAR   </b></font>numfichero   <font color="#000080">: </font>Byte<font color="#000080">;
      </font>fichero      <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
      </font>s_num<font color="#000080">, </font>drive <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
      </font>buffg        <font color="#000080">: </font>Pointer<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Graba <font color="#000080">(</font>Flags<font color="#000080">, </font>CS<font color="#000080">, </font>IP<font color="#000080">, </font>AX<font color="#000080">, </font>BX<font color="#000080">, </font>CX<font color="#000080">, </font>DX<font color="#000080">, </font>SI<font color="#000080">, </font>DI<font color="#000080">, </font>DS<font color="#000080">, </font>ES<font color="#000080">, </font>BP<font color="#000080">: </font>Word<font color="#000080">);
</font>INTERRUPT<font color="#000080">;
   </font><font color="#FF0000"><b>Begin
        </b></font>Str<font color="#000080">(</font>numfichero<font color="#000080">,</font>s_num<font color="#000080">);
        </font>Inc<font color="#000080">(</font>numfichero<font color="#000080">);
        </font>Assign<font color="#000080">(</font>fichero<font color="#000080">, </font>drive <font color="#000080">+ </font><font color="#800000">'SCREEN.' </font><font color="#000080">+ </font>s_num<font color="#000080">);
        </font>Rewrite<font color="#000080">(</font>fichero<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font>buffg<font color="#000080">:= </font>Ptr<font color="#000080">(</font><font color="#800000">$B000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);     </font><font color="#008000"><i>(* Hercules video memory direction *)
        </i></font>BlockWrite<font color="#000080">(</font>fichero<font color="#000080">,</font>buffg<font color="#000080">^,</font><font color="#800000">32768</font><font color="#000080">); </font><font color="#008000"><i>(* save 32K block of video memory    
                                          in a file*)
        </i></font>Close<font color="#000080">(</font>fichero<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
     If </b></font>ParamCount <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then  </b></font>drive<font color="#000080">:=</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) + </font><font color="#800000">':'
        </font><font color="#FF0000"><b>Else </b></font>drive<font color="#000080">:=</font><font color="#800000">'C:'</font><font color="#000080">;
     </font>Writeln<font color="#000080">;
     </font>HighVideo<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Resident Savescreen.'</font><font color="#000080">);
     </font>Write<font color="#000080">(</font><font color="#800000">'For activate press SHIFT + PRTSCR'</font><font color="#000080">);
     </font>LowVideo<font color="#000080">;
     </font>Writeln<font color="#000080">;
     </font>numfichero<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font>SetINtVec<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">, @</font>Graba<font color="#000080">);  </font><font color="#008000"><i>(* Change interrupt vector of 5 interruption
                               (print screen) *) 
     </i></font>Keep<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);               </font><font color="#008000"><i>(* End and Stay Resident *)

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TSR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0025.PAS">Original</a><b>]</b></p></body>
</html>
