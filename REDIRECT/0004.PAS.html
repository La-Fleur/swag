<html>
<head><title> "REDIRCT2.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to REDIRECT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; When pkzip executes... it Writes to the screen and scrolls my
&gt; screen up. Is there a way in which I can prevent pkzip from writing
&gt; to the screen.

This thread comes up a bunch.  Here's a tried and tested solution :
}
</i></font><font color="#FF0000"><b>Unit </b></font>Redir<font color="#000080">;

</font><font color="#008000"><i>{ Redirect input, output, and errors }

</i></font><font color="#FF0000"><b>Interface

Procedure </b></font>RedirectInput <font color="#000080">(</font>TextFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>RedirectOutput <font color="#000080">(</font>TextFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>StdInput<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>StdOutput<font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Const
    </b></font>STDin  <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
    </font>STdoUT <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
    </font>STDERR <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Force_Dup <font color="#000080">(</font>Existing<font color="#000080">,              </font><font color="#008000"><i>{ Existing handle         }
                     </i></font>Second     <font color="#000080">: </font>Word<font color="#000080">);    </font><font color="#008000"><i>{ Handle to place it to   }

</i></font><font color="#FF0000"><b>Var
  </b></font>R <font color="#000080">: </font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>begin

    </b></font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$46</font><font color="#000080">;
    </font>r<font color="#000080">.</font>BX <font color="#000080">:= </font>Existing<font color="#000080">;
    </font>r<font color="#000080">.</font>CX <font color="#000080">:= </font>Second<font color="#000080">;

    </font>MSDos <font color="#000080">(</font>R<font color="#000080">);

    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>r<font color="#000080">.</font>Flags <font color="#FF0000"><b>and </b></font>FCarry<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>Writeln <font color="#000080">(</font><font color="#800000">'Error '</font><font color="#000080">, </font>r<font color="#000080">.</font>AX<font color="#000080">, </font><font color="#800000">' changing handle '</font><font color="#000080">, </font>Second<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>RedirectInput <font color="#000080">(</font>TextFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Var
    </b></font>TF <font color="#000080">: </font>Text<font color="#000080">;

</font><font color="#FF0000"><b>begin
    </b></font>Assign <font color="#000080">(</font>TF<font color="#000080">, </font>TextFile<font color="#000080">);
    </font>Reset <font color="#000080">(</font>TF<font color="#000080">);
    </font>Force_Dup <font color="#000080">(</font>TextRec <font color="#000080">(</font>TF<font color="#000080">).</font>Handle<font color="#000080">, </font>STDin<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>RedirectOutput <font color="#000080">(</font>TextFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Var
    </b></font>TF <font color="#000080">: </font>Text<font color="#000080">;

</font><font color="#FF0000"><b>begin
    </b></font>Assign <font color="#000080">(</font>TF<font color="#000080">, </font>TextFile<font color="#000080">);
    </font>ReWrite <font color="#000080">(</font>TF<font color="#000080">);
    </font>Force_Dup <font color="#000080">(</font>TextRec <font color="#000080">(</font>TF<font color="#000080">).</font>Handle<font color="#000080">, </font>STdoUT<font color="#000080">);
    </font>Force_Dup <font color="#000080">(</font>TextRec <font color="#000080">(</font>TF<font color="#000080">).</font>Handle<font color="#000080">, </font>STDERR<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>StdInput<font color="#000080">;

</font><font color="#FF0000"><b>begin
    </b></font>Assign <font color="#000080">(</font>Input<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">);
    </font>Reset <font color="#000080">(</font>Input<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>StdOutPut<font color="#000080">;

</font><font color="#FF0000"><b>begin
    </b></font>Assign <font color="#000080">(</font>Output<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">);
    </font>ReWrite <font color="#000080">(</font>Output<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{------ cut here ------}
{
In your Program :

Uses Redir;

begin
     RedirectOutput ('LOGFile.OUT');
     Exec ('PKZIP.EXE', '');
     StdOutPut;
end.
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to REDIRECT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p></body>
</html>
