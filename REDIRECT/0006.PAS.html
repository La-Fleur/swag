<html>
<head><title> "Redirection" by FRED JOHNSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to REDIRECT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here's a neat little ditty I converted from a C++ tip I saw in a mag a few
years ago.  It tests to see if its own output has been redirected and
returns a 1 if TRUE (redirected) or a 0 if FALSE (not redirected). This
function includes a sample prog that demonstrates its use. SIDE NOTE: I
put this function in the U_FILE.pas.tpu for use with all of my home-grown
file related functions and procedures.

TEST WITH: Test_Red (enter)
   [you should see a NOT REDIRECTED msg, 10 lines and a FINISHED msg.]

TEST WITH: Test_Red &gt; this.dat (enter)
   [you should see a REDIRECTED msg, (no lines) and a FINISHED msg
    and the output of the lines will be in the this.dat file]
}

</i></font><font color="#FF0000"><b>program </b></font>test_red<font color="#000080">;

</font><font color="#008000"><i>{$A+,B-,D-,E-,F-,G-,I+,L-,N-,O-,P-,Q-,R-,S+,T-,V+,X-}
{$M 1024,0,655360}

{*******************************************************************!HDR**
** Function Name: fn_bRedirected()
** Description  : Determines if output has been redirected;
** Returns      : Integer to be treated as boolean;
** Calls        :
** Special considerations:
** Modification history:
** Created: 11/03/93 20:23
*********************************************************************!END}

</i></font><font color="#FF0000"><b>function </b></font>fn_bRedirected <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">; </font><font color="#008000"><i>{Treated as BOOLEAN}
</i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push  ds
  mov   ax,      prefixseg
  mov   ds,      ax
  xor   bx,      bx
  les   bx,      [bx + $34]
  mov   al,      es:[bx]
  mov   ah,      es:[bx +1]
  pop   ds
  cmp   al,      ah
  mov   ax,      1
  jne   @_exit
  xor   ax,      ax
 @_exit:
  </font><font color="#008000"><i>{mov   @Result, AX}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Count    <font color="#000080">: </font>Byte<font color="#000080">;
  </font>hOutFile <font color="#000080">: </font>text<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>hOutFile<font color="#000080">, </font><font color="#800000">'CON'</font><font color="#000080">);
  </font>ReWrite<font color="#000080">(</font>hOutFile<font color="#000080">);
  </font><font color="#FF0000"><b>if not </b></font><font color="#000080">(</font>boolean<font color="#000080">(</font>fn_bRedirected<font color="#000080">)) </font><font color="#FF0000"><b>then
    </b></font>writeln<font color="#000080">(</font>hOutFile<font color="#000080">, </font><font color="#800000">'Not Redirected'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>writeln<font color="#000080">(</font>hOutFile<font color="#000080">, </font><font color="#800000">'Please wait while redirection is in progress'</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>Count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do
    </b></font>writeln<font color="#000080">(</font><font color="#800000">'Line '</font><font color="#000080">, </font>Count <font color="#000080">: </font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>hOutFile<font color="#000080">, </font><font color="#800000">'Finished!'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to REDIRECT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p></body>
</html>
