<html>
<head><title> "Anti Debuggin Tricks" by SHOCHAT/GOTTLIEB</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FAQ SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0054.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">                            Anti Debugging Tricks

                                     By<font color="#000080">:

                                  </font>Inbar Raz

                 Assistance by Eden Shochat <font color="#FF0000"><b>and </b></font>Yossi Gottlieb

                               Release number <font color="#800000">5

  </font>Today<font color="#800000">'s anti debugging tricks devide into two categories:

  1. </font>Preventive actions<font color="#000080">;
  </font><font color="#800000">2. </font>Self<font color="#000080">-</font>modifying code<font color="#000080">.

  </font>Most debugging tricks<font color="#000080">, </font><font color="#FF0000"><b>as for </b></font>today<font color="#000080">, </font>are used within viruses<font color="#000080">, </font><font color="#FF0000"><b>in </b></font>order <font color="#FF0000"><b>to
</b></font>avoid dis<font color="#000080">-</font>assembly <font color="#FF0000"><b>of </b></font>the virus<font color="#000080">, </font><font color="#FF0000"><b>as </b></font>it will be exampled later <font color="#FF0000"><b>in </b></font>this <font color="#FF0000"><b>file</b></font><font color="#000080">.
</font>Another large portion <font color="#FF0000"><b>of </b></font>anti debugging tricks <font color="#FF0000"><b>is </b></font>found <font color="#FF0000"><b>with </b></font>software
protection programs<font color="#000080">, </font>that use them <font color="#FF0000"><b>in </b></font>order <font color="#FF0000"><b>to </b></font>make the cracking <font color="#FF0000"><b>of </b></font>the
protection harder<font color="#000080">.

</font><font color="#800000">1. </font>Preventive actions<font color="#000080">:
----------------------

  </font>Preventive actions are<font color="#000080">, </font>basically<font color="#000080">, </font>actions that the <font color="#FF0000"><b>program </b></font>takes <font color="#FF0000"><b>in </b></font>order
<font color="#FF0000"><b>to </b></font>make the user unable <font color="#FF0000"><b>to </b></font>dis<font color="#000080">-</font>assemble the code <font color="#FF0000"><b>or </b></font>trace it <font color="#FF0000"><b>while </b></font>running<font color="#000080">.

</font><font color="#800000">1.1. </font>Interrupt disable<font color="#000080">:

       </font>Interrupt disable <font color="#FF0000"><b>is </b></font>probably the most common form <font color="#FF0000"><b>of </b></font>anti<font color="#000080">-</font>debugging
     tricks<font color="#000080">. </font>It can be done <font color="#FF0000"><b>in </b></font>several ways<font color="#000080">:

   </font><font color="#800000">1.1.1. </font>Hardware masking <font color="#FF0000"><b>of </b></font>interrupt<font color="#000080">:

            </font><font color="#FF0000"><b>In </b></font>order <font color="#FF0000"><b>to </b></font>avoid tracing <font color="#FF0000"><b>of </b></font>a code<font color="#000080">, </font>one usually disables the
          interrupt via the <font color="#800000">8259 </font>Interrupt Controller<font color="#000080">, </font>addressed by read<font color="#000080">/</font>write
          actions <font color="#FF0000"><b>to </b></font>port <font color="#800000">21</font>h<font color="#000080">. </font>The <font color="#800000">8259 </font>Interrupt Controller controls the IRQ
          lines<font color="#000080">. </font>This means that any IRQ between <font color="#800000">0 </font><font color="#FF0000"><b>and </b></font><font color="#800000">7 </font>may be disabled by
          this action<font color="#000080">. </font>Bit <font color="#800000">0 </font><font color="#FF0000"><b>is </b></font>IRQ0<font color="#000080">, </font>bit <font color="#800000">1 </font><font color="#FF0000"><b>is </b></font>IRQ1 etc<font color="#000080">. </font>Since IRQ1 <font color="#FF0000"><b>is </b></font>the
          keyboard interrupt<font color="#000080">, </font>you may disable the keyboard without the
          debugger being able <font color="#FF0000"><b>to </b></font>bypass it<font color="#000080">.

          </font>Example<font color="#000080">:

          </font>CS<font color="#000080">:</font><font color="#800000">0100 </font>E421           <font color="#FF0000"><b>IN     </b></font>AL<font color="#000080">,</font><font color="#800000">21
          </font>CS<font color="#000080">:</font><font color="#800000">0102 0</font>C02           <font color="#FF0000"><b>OR     </b></font>AL<font color="#000080">,</font><font color="#800000">02
          </font>CS<font color="#000080">:</font><font color="#800000">0104 </font>E621           <font color="#FF0000"><b>OUT    </b></font><font color="#800000">21</font><font color="#000080">,</font>AL

            Just <font color="#FF0000"><b>as </b></font>a side notice<font color="#000080">, </font>the keyboard may be also disabled by
          commanding the Programmable Peripheral <font color="#FF0000"><b>Interface </b></font><font color="#000080">(</font>PPI<font color="#000080">), </font>port <font color="#800000">61</font>h<font color="#000080">.

          </font>Example<font color="#000080">:

          </font>CS<font color="#000080">:</font><font color="#800000">0100 </font>E461           <font color="#FF0000"><b>IN     </b></font>AL<font color="#000080">,</font><font color="#800000">61
          </font>CS<font color="#000080">:</font><font color="#800000">0102 0</font>C80           <font color="#FF0000"><b>OR     </b></font>AL<font color="#000080">,</font><font color="#800000">80
          </font>CS<font color="#000080">:</font><font color="#800000">0104 </font>E661           <font color="#FF0000"><b>OUT    </b></font><font color="#800000">61</font><font color="#000080">,</font>AL

   <font color="#800000">1.1.2. </font>Software masking <font color="#FF0000"><b>of </b></font>interrupt<font color="#000080">:

            </font>This <font color="#FF0000"><b>is </b></font>quite an easy form <font color="#FF0000"><b>of </b></font>an anti<font color="#000080">-</font>debugging trick<font color="#000080">. </font>All you
          have <font color="#FF0000"><b>to do is </b></font>simply replace the vectors <font color="#FF0000"><b>of </b></font>interrupts debuggers
          use<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>any other interrupt you will <font color="#FF0000"><b>not </b></font>be using <font color="#FF0000"><b>or </b></font>expecting <font color="#FF0000"><b>to
          </b></font>occur<font color="#000080">. </font><font color="#FF0000"><b>Do not </b></font>forget <font color="#FF0000"><b>to </b></font>restore the original vectors when you are
          finished<font color="#000080">. </font>It <font color="#FF0000"><b>is </b></font>adviseable <font color="#FF0000"><b>to </b></font>use manual change <font color="#FF0000"><b>of </b></font>vector<font color="#000080">, </font><font color="#FF0000"><b>as </b></font>shown
          below<font color="#000080">, </font>rather than <font color="#FF0000"><b>to </b></font>change it using interrupt <font color="#800000">21</font>h service <font color="#800000">25</font>h<font color="#000080">,
          </font>because any debugger that has gained control <font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">21</font>h may
          replace your vector <font color="#FF0000"><b>with </b></font>the debugger<font color="#800000">'s. The example shows an
          </font>interception <font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">03</font>h <font color="#000080">- </font>the breakpoint interrupt<font color="#000080">.

          </font>Example<font color="#000080">:

          </font>CS<font color="#000080">:</font><font color="#800000">0100 </font>EB04           JMP    <font color="#800000">0106
          </font>CS<font color="#000080">:</font><font color="#800000">0102 0000           </font>ADD    <font color="#000080">[</font>BX<font color="#000080">+</font>SI<font color="#000080">],</font>AL
          CS<font color="#000080">:</font><font color="#800000">0104 0000           </font>ADD    <font color="#000080">[</font>BX<font color="#000080">+</font>SI<font color="#000080">],</font>AL
          CS<font color="#000080">:</font><font color="#800000">0106 31</font>C0           <font color="#FF0000"><b>XOR    </b></font>AX<font color="#000080">,</font>AX
          CS<font color="#000080">:</font><font color="#800000">0108 8E</font>C0           MOV    ES<font color="#000080">,</font>AX
          CS<font color="#000080">:</font><font color="#800000">010</font>A <font color="#800000">268</font>B1E0C00     MOV    BX<font color="#000080">,</font>ES<font color="#000080">:[</font><font color="#800000">000</font>C<font color="#000080">]
          </font>CS<font color="#000080">:</font><font color="#800000">010</font>F <font color="#800000">891E0201       </font>MOV    <font color="#000080">[</font><font color="#800000">0102</font><font color="#000080">],</font>BX
          CS<font color="#000080">:</font><font color="#800000">0113 268</font>B1E0E00     MOV    BX<font color="#000080">,</font>ES<font color="#000080">:[</font><font color="#800000">000E</font><font color="#000080">]
          </font>CS<font color="#000080">:</font><font color="#800000">0118 891E0401       </font>MOV    <font color="#000080">[</font><font color="#800000">0104</font><font color="#000080">],</font>BX
          CS<font color="#000080">:</font><font color="#800000">011</font>C <font color="#800000">26</font>C7064C000000 MOV    Word Ptr ES<font color="#000080">:[</font><font color="#800000">000</font>C<font color="#000080">],</font><font color="#800000">0000
          </font>CS<font color="#000080">:</font><font color="#800000">0123 26</font>C7064E000000 MOV    Word Ptr ES<font color="#000080">:[</font><font color="#800000">000E</font><font color="#000080">],</font><font color="#800000">0000

   1.1.3. </font>Vector manipulation

             This method involves manipulations <font color="#FF0000"><b>of </b></font>the interrupt vectors<font color="#000080">,
          </font>mainly <font color="#FF0000"><b>for </b></font>proper activation <font color="#FF0000"><b>of </b></font>the algorithm<font color="#000080">. </font>Such action<font color="#000080">, </font><font color="#FF0000"><b>as
          </b></font>exampled<font color="#000080">, </font>may be used <font color="#FF0000"><b>to </b></font>decrypt a code <font color="#000080">(</font>see also <font color="#800000">2.1</font><font color="#000080">), </font>using data
          stored <font color="#FF0000"><b>ON </b></font>the vectors<font color="#000080">. </font>Ofcourse<font color="#000080">, </font>during normal operation <font color="#FF0000"><b>of </b></font>the
          <font color="#FF0000"><b>program</b></font><font color="#000080">, </font>vectors <font color="#800000">01</font>h <font color="#FF0000"><b>and </b></font><font color="#800000">03</font>h are <font color="#FF0000"><b>not </b></font>used<font color="#000080">, </font>so unless you are trying
          <font color="#FF0000"><b>to </b></font>debug such a <font color="#FF0000"><b>program</b></font><font color="#000080">, </font>it works fine<font color="#000080">.

          </font>Example<font color="#000080">:

          </font>CS<font color="#000080">:</font><font color="#800000">0100 31</font>C0           <font color="#FF0000"><b>XOR    </b></font>AX<font color="#000080">,</font>AX
          CS<font color="#000080">:</font><font color="#800000">0102 8E</font>D0           MOV    SS<font color="#000080">,</font>AX
          CS<font color="#000080">:</font><font color="#800000">0104 </font>BC0E00         MOV    SP<font color="#000080">,</font><font color="#800000">000E
          </font>CS<font color="#000080">:</font><font color="#800000">0107 2E8</font>B0E3412     MOV    CX<font color="#000080">,</font>CS<font color="#000080">:[</font><font color="#800000">1234</font><font color="#000080">]
          </font>CS<font color="#000080">:</font><font color="#800000">010</font>C <font color="#800000">50             </font>PUSH   AX
          CS<font color="#000080">:</font><font color="#800000">010</font>D <font color="#800000">31</font>C8           <font color="#FF0000"><b>XOR    </b></font>AX<font color="#000080">,</font>CX
          CS<font color="#000080">:</font><font color="#800000">010</font>F <font color="#800000">21</font>C5           <font color="#FF0000"><b>AND    </b></font>BP<font color="#000080">,</font>AX
          CS<font color="#000080">:</font><font color="#800000">0111 58             </font>POP    AX
          CS<font color="#000080">:</font><font color="#800000">0112 </font>E2F8           LOOP   <font color="#800000">010</font>C

   <font color="#800000">1.1.4. </font>Interrupt replacement

            This <font color="#FF0000"><b>is </b></font>a really nasty trick<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>it should be used ONLY <font color="#FF0000"><b>if </b></font>you
          are ABSOLUTELY sure that your programs needs no more debugging<font color="#000080">. </font>What
          you should <font color="#FF0000"><b>do is </b></font>copy the vectors <font color="#FF0000"><b>of </b></font>some interrupts you will be
          using<font color="#000080">, </font>say <font color="#800000">16</font>h <font color="#FF0000"><b>and </b></font><font color="#800000">21</font>h<font color="#000080">, </font>onto the vectors <font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">01</font>h <font color="#FF0000"><b>and </b></font><font color="#800000">03</font>h<font color="#000080">,
          </font>that <font color="#FF0000"><b>do not </b></font>occur during normal operation <font color="#FF0000"><b>of </b></font>the <font color="#FF0000"><b>program</b></font><font color="#000080">. </font><font color="#FF0000"><b>If </b></font>the
          user wants <font color="#FF0000"><b>to </b></font>debug the <font color="#FF0000"><b>program</b></font><font color="#000080">, </font>he would have <font color="#FF0000"><b>to </b></font>search <font color="#FF0000"><b>for </b></font>every
          occurance <font color="#FF0000"><b>of </b></font>INT <font color="#800000">01</font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>replace it <font color="#FF0000"><b>with </b></font>the appropriate INT
          instruction<font color="#000080">. </font>This trick <font color="#FF0000"><b>is </b></font>very effective <font color="#FF0000"><b>if </b></font>used together <font color="#FF0000"><b>with </b></font>the
          fact that the INT <font color="#800000">3 </font>intruction has a ONE BYTE opcode <font color="#000080">- </font><font color="#800000">0</font>CCh<font color="#000080">, </font>which
          can <font color="#FF0000"><b>not </b></font>be changed <font color="#FF0000"><b>to </b></font>any other interrupt<font color="#000080">.

          </font>Example<font color="#000080">:

          </font>CS<font color="#000080">:</font><font color="#800000">0100 </font>FA             CLI
          CS<font color="#000080">:</font><font color="#800000">0101 31</font>C0           <font color="#FF0000"><b>XOR    </b></font>AX<font color="#000080">,</font>AX
          CS<font color="#000080">:</font><font color="#800000">0103 8E</font>C0           MOV    ES<font color="#000080">,</font>AX
          CS<font color="#000080">:</font><font color="#800000">0105 26</font>A18400       MOV    AX<font color="#000080">,</font>ES<font color="#000080">:[</font><font color="#800000">0084</font><font color="#000080">]
          </font>CS<font color="#000080">:</font><font color="#800000">0109 26</font>A30400       MOV    ES<font color="#000080">:[</font><font color="#800000">0004</font><font color="#000080">],</font>AX
          CS<font color="#000080">:</font><font color="#800000">010</font>D <font color="#800000">26</font>A18600       MOV    AX<font color="#000080">,</font>ES<font color="#000080">:[</font><font color="#800000">0086</font><font color="#000080">]
          </font>CS<font color="#000080">:</font><font color="#800000">0111 26</font>A30600       MOV    ES<font color="#000080">:[</font><font color="#800000">0006</font><font color="#000080">],</font>AX
          CS<font color="#000080">:</font><font color="#800000">0115 </font>B44C           MOV    AH<font color="#000080">,</font><font color="#800000">4</font>C
          CS<font color="#000080">:</font><font color="#800000">0117 </font>CD01           INT    <font color="#800000">01                

1.2. </font>Time watch<font color="#000080">:

       </font>This may be a less common method<font color="#000080">, </font>but it <font color="#FF0000"><b>is </b></font>usefull against debuggers
     that disable all interrupts <font color="#FF0000"><b>except for </b></font>the time that the <font color="#FF0000"><b>program is
     </b></font>executed<font color="#000080">, </font>such <font color="#FF0000"><b>as </b></font>Borland<font color="#800000">'s Turbo Debugger. This method simply retains
     </font>the value <font color="#FF0000"><b>of </b></font>the clock counter<font color="#000080">, </font>updated by interrupt <font color="#800000">08</font>h<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>waits <font color="#FF0000"><b>in </b></font>an
     infinite loop <font color="#FF0000"><b>until </b></font>the value changes<font color="#000080">. </font>Another example <font color="#FF0000"><b>is </b></font>when you mask
     the timer interrupt by ORing the value INed from port <font color="#800000">21</font>h <font color="#FF0000"><b>with </b></font><font color="#800000">01</font>h <font color="#FF0000"><b>and
     then </b></font>OUTing it back<font color="#000080">, </font>thus disabling the IRQ0 <font color="#000080">- </font>Timer interrupt<font color="#000080">. </font>Note that
     this method <font color="#FF0000"><b>is </b></font>usefull only against RUN actions<font color="#000080">, </font><font color="#FF0000"><b>not </b></font>TRACE<font color="#000080">/</font>PROCEED ones<font color="#000080">.

     </font>Example<font color="#000080">:

     </font>CS<font color="#000080">:</font><font color="#800000">0100 2</font>BC0           SUB    AX<font color="#000080">,</font>AX
     CS<font color="#000080">:</font><font color="#800000">0102 </font>FB             STI
     CS<font color="#000080">:</font><font color="#800000">0103 8E</font>D8           MOV    DS<font color="#000080">,</font>AX
     CS<font color="#000080">:</font><font color="#800000">0105 8</font>A266C04       MOV    AH<font color="#000080">,[</font><font color="#800000">046</font>C<font color="#000080">]
     </font>CS<font color="#000080">:</font><font color="#800000">0109 </font>A06C04         MOV    AL<font color="#000080">,[</font><font color="#800000">046</font>C<font color="#000080">]
     </font>CS<font color="#000080">:</font><font color="#800000">010</font>C <font color="#800000">3</font>AC4           CMP    AL<font color="#000080">,</font>AH
     CS<font color="#000080">:</font><font color="#800000">010E 74</font>F9           JZ     <font color="#800000">0109

1.3. </font>Fool the debugger<font color="#000080">:

       </font>This <font color="#FF0000"><b>is </b></font>a very nice technique<font color="#000080">, </font>that works especially <font color="#FF0000"><b>and </b></font>only <font color="#FF0000"><b>on </b></font>those
     who use Turbo Debugger <font color="#FF0000"><b>or </b></font>its kind<font color="#000080">. </font>What you should <font color="#FF0000"><b>do is </b></font>init a jump <font color="#FF0000"><b>to
     </b></font>a middle <font color="#FF0000"><b>of </b></font>an instruction<font color="#000080">, </font>whereas the real address actually <font color="#FF0000"><b>contains
     </b></font>another opcode<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you work <font color="#FF0000"><b>with </b></font>a normal step debugger such <font color="#FF0000"><b>as </b></font>Debug <font color="#FF0000"><b>or
     </b></font>SymDeb<font color="#000080">, </font>it won<font color="#800000">'t work since the debugger jumps to the exact address of
     </font>the jump<font color="#000080">, </font><font color="#FF0000"><b>and not to </b></font>the beginning <font color="#FF0000"><b>of </b></font>an instruction at the closest
     address<font color="#000080">, </font>like Turbo Debugger<font color="#000080">.

     </font>Example<font color="#000080">:

     </font>CS<font color="#000080">:</font><font color="#800000">0100 </font>E421           <font color="#FF0000"><b>IN     </b></font>AL<font color="#000080">,</font><font color="#800000">21
     </font>CS<font color="#000080">:</font><font color="#800000">0102 </font>B0FF           MOV    AL<font color="#000080">,</font>FF
     CS<font color="#000080">:</font><font color="#800000">0104 </font>EB02           JMP    <font color="#800000">0108
     </font>CS<font color="#000080">:</font><font color="#800000">0106 </font>C606E62100     MOV    Byte Ptr <font color="#000080">[</font><font color="#800000">21E6</font><font color="#000080">],</font><font color="#800000">00
     </font>CS<font color="#000080">:</font><font color="#800000">010</font>B CD20           INT    <font color="#800000">20

     </font>Watch this<font color="#000080">:

     </font>CS<font color="#000080">:</font><font color="#800000">0108 </font>E621           <font color="#FF0000"><b>OUT    </b></font><font color="#800000">21</font><font color="#000080">,</font>AL

     Notice<font color="#000080">:

       </font>This trick does <font color="#FF0000"><b>NOT </b></font>effect the run <font color="#FF0000"><b>of </b></font>the <font color="#FF0000"><b>program in </b></font>ANY debugger<font color="#000080">. </font>Its
     only use <font color="#FF0000"><b>is to try to </b></font>deceive the user into thinking another opcode <font color="#FF0000"><b>is
     </b></font>used<font color="#000080">, </font><font color="#FF0000"><b>while </b></font>another <font color="#FF0000"><b>is </b></font>actually run<font color="#000080">.

</font><font color="#800000">1.4. </font>Check CPU Flags<font color="#000080">:

       </font>This <font color="#FF0000"><b>is </b></font>a nice trick<font color="#000080">, </font>effective against almost any real mode debugger<font color="#000080">.
     </font>What you should <font color="#FF0000"><b>do is </b></font>simply <font color="#FF0000"><b>set </b></font>the trace flag off somewhere <font color="#FF0000"><b>in </b></font>your
     <font color="#FF0000"><b>program</b></font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>check <font color="#FF0000"><b>for </b></font>it later<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>it was turned <font color="#FF0000"><b>on</b></font><font color="#000080">, </font>a debugger runs <font color="#FF0000"><b>in
     </b></font>the background<font color="#000080">...

     </font>Example<font color="#000080">:

     </font>CS<font color="#000080">:</font><font color="#800000">0100 9</font>C             PUSHF
     CS<font color="#000080">:</font><font color="#800000">0101 58             </font>POP    AX
     CS<font color="#000080">:</font><font color="#800000">0102 25</font>FFFE         <font color="#FF0000"><b>AND    </b></font>AX<font color="#000080">,</font>FEFF
     CS<font color="#000080">:</font><font color="#800000">0105 50             </font>PUSH   AX
     CS<font color="#000080">:</font><font color="#800000">0106 9</font>D             POPF

     <font color="#FF0000"><b>In </b></font>the middle <font color="#FF0000"><b>of </b></font>the <font color="#FF0000"><b>program</b></font><font color="#000080">:

     </font>CS<font color="#000080">:</font><font color="#800000">1523 9</font>C             PUSHF
     CS<font color="#000080">:</font><font color="#800000">1524 58             </font>POP    AX
     CS<font color="#000080">:</font><font color="#800000">1525 250001         </font><font color="#FF0000"><b>AND    </b></font>AX<font color="#000080">,</font><font color="#800000">0100
     </font>CS<font color="#000080">:</font><font color="#800000">1528 7402           </font>JZ     <font color="#800000">152</font>C
     CS<font color="#000080">:</font><font color="#800000">152</font>A CD20           INT    <font color="#800000">20

1.5. </font>Cause debugger <font color="#FF0000"><b>to </b></font>stop execution<font color="#000080">:

       </font>This <font color="#FF0000"><b>is </b></font>a technique that causes a debugger <font color="#FF0000"><b>to </b></font>stop the execution <font color="#FF0000"><b>of </b></font>a
     certain <font color="#FF0000"><b>program</b></font><font color="#000080">. </font>What you need <font color="#FF0000"><b>to do is to </b></font>put some INT <font color="#800000">3 </font>instructions
     over the code<font color="#000080">, </font>at random places<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>any debugger trying <font color="#FF0000"><b>to </b></font>run will stop
     there<font color="#000080">. </font>It <font color="#FF0000"><b>is </b></font>best <font color="#FF0000"><b>if </b></font>used within a loop<font color="#000080">, </font><font color="#FF0000"><b>as </b></font>it <font color="#FF0000"><b>is </b></font>run several times<font color="#000080">.

     </font>Example<font color="#000080">:

     </font>CS<font color="#000080">:</font><font color="#800000">0100 </font>B96402         MOV    CX<font color="#000080">,</font><font color="#800000">0264
     </font>CS<font color="#000080">:</font><font color="#800000">0103 </font>BE1001         MOV    SI<font color="#000080">,</font><font color="#800000">0110
     </font>CS<font color="#000080">:</font><font color="#800000">0106 </font>AC             LODSB
     CS<font color="#000080">:</font><font color="#800000">0107 </font>CC             INT    <font color="#800000">3
     </font>CS<font color="#000080">:</font><font color="#800000">0108 98             </font>CBW
     CS<font color="#000080">:</font><font color="#800000">0109 01</font>C3           ADD    BX<font color="#000080">,</font>AX
     CS<font color="#000080">:</font><font color="#800000">010</font>B E2F9           LOOP   <font color="#800000">0106

1.6. </font>Halt computer using stack<font color="#000080">:

       </font>This trick <font color="#FF0000"><b>is </b></font>based <font color="#FF0000"><b>on </b></font>the fact that debuggers don<font color="#800000">'t usually use a
     </font>stack space <font color="#FF0000"><b>of </b></font>their own<font color="#000080">, </font>but rather the user <font color="#FF0000"><b>program</b></font><font color="#800000">'s stack space. By
     </font>setting the stack <font color="#FF0000"><b>to </b></font>a location <font color="#FF0000"><b>in </b></font>the middle <font color="#FF0000"><b>of </b></font>a code that does <font color="#FF0000"><b>NOT </b></font>use
     the stack itself<font color="#000080">, </font>any debugger that will <font color="#FF0000"><b>try to </b></font>trace the code will
     overwrite some <font color="#FF0000"><b>of </b></font>the code by its own stack <font color="#000080">(</font>mainly interrupt return
     addresses<font color="#000080">). </font>Again<font color="#000080">, </font>CLI <font color="#FF0000"><b>and </b></font>STI are <font color="#FF0000"><b>in </b></font>order<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>are <font color="#FF0000"><b>not </b></font>shown <font color="#FF0000"><b>for </b></font>the
     purpose <font color="#FF0000"><b>of </b></font>the example only<font color="#000080">. </font>They must be included<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>you risk hanging
     your computer wether a debugger <font color="#FF0000"><b>is </b></font>installed <font color="#FF0000"><b>or not</b></font><font color="#000080">.

     </font>Example<font color="#000080">:

     </font>CS<font color="#000080">:</font><font color="#800000">0100 8</font>CD0           MOV    AX<font color="#000080">,</font>SS
     CS<font color="#000080">:</font><font color="#800000">0102 89E3           </font>MOV    BX<font color="#000080">,</font>SP
     CS<font color="#000080">:</font><font color="#800000">0104 0E             </font>PUSH   CS
     CS<font color="#000080">:</font><font color="#800000">0105 17             </font>POP    SS
     CS<font color="#000080">:</font><font color="#800000">0106 </font>BC0B01         MOV    SP<font color="#000080">,</font><font color="#800000">010</font>B
     CS<font color="#000080">:</font><font color="#800000">0109 90             </font>NOP
     CS<font color="#000080">:</font><font color="#800000">010</font>A <font color="#800000">90             </font>NOP
     CS<font color="#000080">:</font><font color="#800000">010</font>B EB02           JMP    <font color="#800000">010</font>F
     CS<font color="#000080">:</font><font color="#800000">010</font>D <font color="#800000">90             </font>NOP
     CS<font color="#000080">:</font><font color="#800000">010E 90             </font>NOP
     CS<font color="#000080">:</font><font color="#800000">010</font>F <font color="#800000">89</font>DC           MOV    SP<font color="#000080">,</font>BX
     CS<font color="#000080">:</font><font color="#800000">0111 8E</font>D0           MOV    SS<font color="#000080">,</font>AX

<font color="#800000">1.7. </font>Halt TD386 V8086 mode<font color="#000080">:

       </font>This <font color="#FF0000"><b>is </b></font>a nice way <font color="#FF0000"><b>to </b></font>fool Turbo Debugger<font color="#800000">'s V8086 module (TD386). It is
     </font>based <font color="#FF0000"><b>on </b></font>the fact that TD386 does <font color="#FF0000"><b>not </b></font>use INT <font color="#800000">00</font>h <font color="#FF0000"><b>to </b></font>detect division by
     zero <font color="#000080">(</font><font color="#FF0000"><b>or register </b></font>overrun after division<font color="#000080">, </font>which <font color="#FF0000"><b>is </b></font>treated by the
     processor <font color="#FF0000"><b>in </b></font>the same way <font color="#FF0000"><b>as in </b></font>the <font color="#FF0000"><b>case of </b></font>division by zero<font color="#000080">). </font>When TD386
     detects a division fault<font color="#000080">, </font>it aborts<font color="#000080">, </font>reporting about the faulty division<font color="#000080">.
     </font><font color="#FF0000"><b>In </b></font>real mode <font color="#000080">(</font>even under a regular debugger<font color="#000080">), </font>a faulty <font color="#FF0000"><b>DIV </b></font>instruction
     will cause INT <font color="#800000">00</font>h <font color="#FF0000"><b>to </b></font>be called<font color="#000080">. </font>Therefore<font color="#000080">, </font>pointing INT <font color="#800000">00</font>h <font color="#FF0000"><b>to </b></font>the next
     instruction<font color="#000080">, </font>will recover from the faulty <font color="#FF0000"><b>DIV</b></font><font color="#000080">.

     </font>Note<font color="#000080">: </font>It <font color="#FF0000"><b>is </b></font>very important <font color="#FF0000"><b>to </b></font>restore INT <font color="#800000">00</font>h<font color="#800000">'s vector. Otherwise, the
     </font>next call <font color="#FF0000"><b>to </b></font>INT <font color="#800000">00</font>h will cause the machine <font color="#FF0000"><b>to </b></font>hang<font color="#000080">.

     </font>Example<font color="#000080">:

     </font>CS<font color="#000080">:</font><font color="#800000">0100 31</font>C0          <font color="#FF0000"><b>XOR     </b></font>AX<font color="#000080">,</font>AX
     CS<font color="#000080">:</font><font color="#800000">0102 8E</font>D8          MOV     DS<font color="#000080">,</font>AX
     CS<font color="#000080">:</font><font color="#800000">0104 </font>C70600001201  MOV     WORD PTR <font color="#000080">[</font><font color="#800000">0000</font><font color="#000080">],</font><font color="#800000">0112
     </font>CS<font color="#000080">:</font><font color="#800000">010</font>A <font color="#800000">8</font>C0E0200      MOV     <font color="#000080">[</font><font color="#800000">0002</font><font color="#000080">],</font>CS
     CS<font color="#000080">:</font><font color="#800000">010E </font>B400          MOV     AH<font color="#000080">,</font><font color="#800000">00
     </font>CS<font color="#000080">:</font><font color="#800000">0110 </font>F6F4          <font color="#FF0000"><b>DIV     </b></font>AH
     CS<font color="#000080">:</font><font color="#800000">0112 </font>B8004C        MOV     AX<font color="#000080">,</font><font color="#800000">4</font>C00
     CS<font color="#000080">:</font><font color="#800000">0115 </font>CD21          INT     <font color="#800000">21

1.8. </font>Halt any V8086 process<font color="#000080">:

       </font>Another way <font color="#FF0000"><b>of </b></font>messing TD386 <font color="#FF0000"><b>is </b></font>fooling it into an exception<font color="#000080">.
     </font>Unfortunately<font color="#000080">, </font>this exception will also be generated under any other
     <font color="#FF0000"><b>program</b></font><font color="#000080">, </font>running at V8086 mode<font color="#000080">. </font>The exception <font color="#FF0000"><b>is </b></font>exception <font color="#800000">#13</font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>its
     issued interrupt <font color="#FF0000"><b>is </b></font>INT <font color="#800000">0</font>Dh <font color="#000080">- </font><font color="#800000">13</font>d<font color="#000080">. </font>The idea <font color="#FF0000"><b>is </b></font>very similar <font color="#FF0000"><b>to </b></font>the
     divide by zero trick<font color="#000080">: </font>Causing an exception<font color="#000080">, </font>when the exception interrupt
     points <font color="#FF0000"><b>to </b></font>somewhere <font color="#FF0000"><b>in </b></font>the <font color="#FF0000"><b>program</b></font><font color="#800000">'s code. It will always work when the
     </font>machine <font color="#FF0000"><b>is </b></font>running <font color="#FF0000"><b>in </b></font>real mode<font color="#000080">, </font>but never under the V8086 mode<font color="#000080">.

     </font>Note<font color="#000080">: </font>It <font color="#FF0000"><b>is </b></font>very important <font color="#FF0000"><b>to </b></font>restore the original interrupt vectors<font color="#000080">.
     </font>Otherwise<font color="#000080">, </font>the next exception will hang the machine<font color="#000080">.

     </font>Example<font color="#000080">:

     </font>CS<font color="#000080">:</font><font color="#800000">0100 31</font>C0          <font color="#FF0000"><b>XOR     </b></font>AX<font color="#000080">,</font>AX
     CS<font color="#000080">:</font><font color="#800000">0102 8E</font>D8          MOV     DS<font color="#000080">,</font>AX
     CS<font color="#000080">:</font><font color="#800000">0104 </font>C70634001301  MOV     WORD PTR <font color="#000080">[</font><font color="#800000">0034</font><font color="#000080">],</font><font color="#800000">0113
     </font>CS<font color="#000080">:</font><font color="#800000">010</font>A <font color="#800000">8</font>C0E3600      MOV     <font color="#000080">[</font><font color="#800000">0036</font><font color="#000080">],</font>CS
     CS<font color="#000080">:</font><font color="#800000">010E 833E</font>FFFF00    CMP     WORD PTR <font color="#000080">[</font>FFFF<font color="#000080">],+</font><font color="#800000">00
     </font>CS<font color="#000080">:</font><font color="#800000">0113 </font>B8004C        MOV     AX<font color="#000080">,</font><font color="#800000">4</font>C00
     CS<font color="#000080">:</font><font color="#800000">0116 </font>CD21          INT     <font color="#800000">21

2. </font>Self<font color="#000080">-</font>modifying code<font color="#000080">:
-----------------------

</font><font color="#800000">2.1. </font>Encryptive<font color="#000080">/</font>decryptive algorithm<font color="#000080">:

       </font>The first category <font color="#FF0000"><b>is </b></font>simply a code<font color="#000080">, </font>that has been encrypted<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>has
     been added a decryption routine<font color="#000080">. </font>The trick here <font color="#FF0000"><b>is </b></font>that when a debugger
     sets up a breakpoint<font color="#000080">, </font>it simply places the opcode CCh <font color="#000080">(</font>INT <font color="#800000">03</font>h<font color="#000080">) </font><font color="#FF0000"><b>in </b></font>the
     desired address<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>once that interrupt <font color="#FF0000"><b>is </b></font>executed<font color="#000080">, </font>the debugger
     regains control <font color="#FF0000"><b>of </b></font>things<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you <font color="#FF0000"><b>try to set </b></font>a breakpoint AFTER the
     decryption algorithm<font color="#000080">, </font>what <font color="#FF0000"><b>is </b></font>usually needed<font color="#000080">, </font>you will <font color="#FF0000"><b>end </b></font>up putting an
     opcode CCh <font color="#FF0000"><b>in </b></font>a place where decryptive actions are taken<font color="#000080">, </font>therefore losing
     your original CCh <font color="#FF0000"><b>in </b></font>favour <font color="#FF0000"><b>of </b></font>whatever the decryption algorithm produces<font color="#000080">.
     </font>The following example was extracted from the Haifa virus<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you <font color="#FF0000"><b>try to
     set </b></font>a breakpoint at address CS<font color="#000080">:</font><font color="#800000">0110</font><font color="#000080">, </font>you will never reach that address<font color="#000080">,
     </font>since there <font color="#FF0000"><b>is </b></font>no way <font color="#FF0000"><b>to </b></font>know what will result from the change<font color="#000080">. </font>Note that
     <font color="#FF0000"><b>if </b></font>you want <font color="#FF0000"><b>to </b></font>make the tracing even harder<font color="#000080">, </font>you should start the
     decryption <font color="#FF0000"><b>of </b></font>the code from its <font color="#FF0000"><b>END</b></font><font color="#000080">, </font>so it takes the whole operation
     <font color="#FF0000"><b>until </b></font>the opcode following the decryption routine <font color="#FF0000"><b>is </b></font>decrypted<font color="#000080">.

     </font>Example<font color="#000080">:

     </font>CS<font color="#000080">:</font><font color="#800000">0100 </font>BB7109         MOV    BX<font color="#000080">,</font><font color="#800000">0971
     </font>CS<font color="#000080">:</font><font color="#800000">0103 </font>BE1001         MOV    DI<font color="#000080">,</font><font color="#800000">0110
     </font>CS<font color="#000080">:</font><font color="#800000">0106 91             </font>XCHG   AX<font color="#000080">,</font>CX
     CS<font color="#000080">:</font><font color="#800000">0107 91             </font>XCHG   AX<font color="#000080">,</font>CX
     CS<font color="#000080">:</font><font color="#800000">0108 2E803597       </font><font color="#FF0000"><b>XOR    </b></font>Byte Ptr CS<font color="#000080">:[</font>DI<font color="#000080">],</font><font color="#800000">97
     </font>CS<font color="#000080">:</font><font color="#800000">010</font>C <font color="#800000">47             </font>INC    DI
     CS<font color="#000080">:</font><font color="#800000">010</font>D <font color="#800000">4</font>B             DEC    BX
     CS<font color="#000080">:</font><font color="#800000">010E 75</font>F6           JNZ    <font color="#800000">0106
     </font>CS<font color="#000080">:</font><font color="#800000">0110 07             </font>POP    ES
     CS<font color="#000080">:</font><font color="#800000">0111 07             </font>POP    ES

<font color="#800000">2.2. </font>Self<font color="#000080">-</font>modifying code<font color="#000080">:

   </font><font color="#800000">2.2.1. </font>Simple self<font color="#000080">-</font>modification<font color="#000080">:

            </font>This method implements the same principle <font color="#FF0000"><b>as </b></font>the encryption
          method<font color="#000080">: </font>Change the opcode before using it<font color="#000080">. </font><font color="#FF0000"><b>In </b></font>the following example<font color="#000080">,
          </font>we change the insruction following the call<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>therefore<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>you
          <font color="#FF0000"><b>try to </b></font>trace the entire call <font color="#000080">(</font><font color="#800000">'P'</font><font color="#000080">/</font>Debug <font color="#FF0000"><b>or </b></font>F8<font color="#000080">/</font>Turbo Debugger<font color="#000080">), </font>you
          will <font color="#FF0000"><b>not </b></font>succeed<font color="#000080">, </font>since the debugger will put its CCh <font color="#FF0000"><b>on </b></font>offset <font color="#800000">103</font>h<font color="#000080">,
          </font>but when the routine runs<font color="#000080">, </font>it overwrites location <font color="#800000">103</font>h<font color="#000080">.

          </font>Example<font color="#000080">:

          </font>CS<font color="#000080">:</font><font color="#800000">0100 </font>E80400         CALL   <font color="#800000">0107
          </font>CS<font color="#000080">:</font><font color="#800000">0103 </font>CD20           INT    <font color="#800000">20
          </font>CS<font color="#000080">:</font><font color="#800000">0105 </font>CD21           INT    <font color="#800000">21
          </font>CS<font color="#000080">:</font><font color="#800000">0107 </font>C7060301B44C   MOV    Word Ptr <font color="#000080">[</font><font color="#800000">0103</font><font color="#000080">],</font><font color="#800000">4</font>CB4
          CS<font color="#000080">:</font><font color="#800000">010</font>D C3             RET

          Watch this<font color="#000080">:

          </font>CS<font color="#000080">:</font><font color="#800000">0103 </font>B44C           MOV    AH<font color="#000080">,</font><font color="#800000">4</font>C

   <font color="#800000">2.2.2. </font>The Running Line <font color="#000080">(</font>self<font color="#000080">-</font>decrypting<font color="#000080">):

            </font>This <font color="#FF0000"><b>is </b></font>an example <font color="#FF0000"><b>of </b></font>a self<font color="#000080">-</font>tracing self<font color="#000080">-</font>modifying code<font color="#000080">,
          </font>sometimes called <font color="#800000">'The running line'</font><font color="#000080">. </font>It was presented by Serge
          Pachkovsky<font color="#000080">. </font>It <font color="#FF0000"><b>is </b></font>a bit tricky <font color="#FF0000"><b>in implementation</b></font><font color="#000080">, </font>but<font color="#000080">, </font>unlike
          all other techiniques mentioned <font color="#FF0000"><b>in </b></font>this document<font color="#000080">, </font>it <font color="#FF0000"><b>is </b></font>relatively
          resistive <font color="#FF0000"><b>to </b></font>various protections <font color="#FF0000"><b>of </b></font>the vector table<font color="#000080">. </font><font color="#FF0000"><b>In </b></font>short<font color="#000080">, </font>it
          results <font color="#FF0000"><b>in </b></font>instructions being decoded one at time<font color="#000080">, </font>thus never
          exposing long code fragments <font color="#FF0000"><b>to </b></font>analisys<font color="#000080">. </font>I will illustrate it
          <font color="#FF0000"><b>with </b></font>the following <font color="#000080">(</font>over<font color="#000080">-</font>simplified<font color="#000080">) </font>code example<font color="#000080">:

          </font><font color="#FF0000"><b>XOR     </b></font>AX<font color="#000080">, </font>AX
          MOV     ES<font color="#000080">, </font>AX
          MOV     WORD PTR ES<font color="#000080">:[</font><font color="#800000">4</font><font color="#000080">*</font><font color="#800000">1</font><font color="#000080">+</font><font color="#800000">0</font><font color="#000080">],</font>OFFSET TRACER
          MOV     WORD PTR ES<font color="#000080">:[</font><font color="#800000">4</font><font color="#000080">*</font><font color="#800000">1</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">],</font>CS
          MOV     BP<font color="#000080">, </font>SP
          PUSHF
          <font color="#FF0000"><b>XOR     </b></font>BYTE PTR <font color="#000080">[</font>BP<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">], </font><font color="#800000">1
          </font>POPF
          MOV     AX<font color="#000080">, </font><font color="#800000">4</font>C00H               <font color="#000080">; </font>This will <font color="#FF0000"><b>not </b></font>be traced<font color="#000080">!
          </font>DB      <font color="#800000">3 </font>DUP <font color="#000080">( </font><font color="#800000">98</font>H <font color="#000080">)
          </font>DB      C5H<font color="#000080">, </font><font color="#800000">21</font>H

   TRACER<font color="#000080">:

          </font>PUSH    BP
          MOV     BP<font color="#000080">, </font>SP
          MOV     BP<font color="#000080">, </font>WORD PTR <font color="#000080">[</font>BP<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]
          </font><font color="#FF0000"><b>XOR     </b></font>BYTE PTR CS<font color="#000080">:[</font>BP<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">], </font><font color="#800000">8
          </font><font color="#FF0000"><b>XOR     </b></font>BYTE PTR CS<font color="#000080">:[</font>BP<font color="#000080">+</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">8
          </font>POP     BP
          IRET

<font color="#000080">===============================================================================

</font>Comments<font color="#000080">:

</font><font color="#FF0000"><b>In </b></font>order <font color="#FF0000"><b>to </b></font>save lines <font color="#FF0000"><b>of </b></font>code<font color="#000080">, </font>I did <font color="#FF0000"><b>not </b></font>insert the CLI<font color="#000080">/</font>STI pair before any
vector change<font color="#000080">. </font>However<font color="#000080">, </font>it <font color="#FF0000"><b>is </b></font>adviseable <font color="#FF0000"><b>to do </b></font>this pair before ANY manual
vector change<font color="#000080">, </font>because <font color="#FF0000"><b>if </b></font>any interrupt occurs <font color="#FF0000"><b>in </b></font>the middle <font color="#FF0000"><b>of </b></font>your
operations<font color="#000080">, </font>the machine could hang<font color="#000080">.

</font>An apology<font color="#000080">:

</font><font color="#FF0000"><b>In </b></font>previous releases <font color="#FF0000"><b>of </b></font>this article<font color="#000080">, </font>a false example<font color="#000080">, </font><font color="#FF0000"><b>as </b></font>noted by Serge
Pachkovksy<font color="#000080">, </font>was posted<font color="#000080">. </font>That was <font color="#800000">2.2.2 </font><font color="#000080">- </font>Manipulating the PIQ<font color="#000080">. </font>Apperantly
the posted source would <font color="#FF0000"><b>not </b></font>work under any circumstances<font color="#000080">. </font><font color="#FF0000"><b>In </b></font>return<font color="#000080">, </font>Serge has
presented the <font color="#800000">'Running Line' </font>technique<font color="#000080">.

</font>Thanks <font color="#FF0000"><b>to</b></font><font color="#000080">:

</font>Eden Shochat<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">401</font><font color="#000080">/</font><font color="#800000">100
  </font><font color="#FF0000"><b>and
</b></font>Yossi Gottlieb<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">401</font><font color="#000080">/</font><font color="#800000">100.3

</font><font color="#FF0000"><b>for </b></font>helping me assembling this list<font color="#000080">.

</font>Other acknowledgements<font color="#000080">:

</font>Matt Pritchard<font color="#000080">, </font><font color="#800000">80</font>XXX echo

Serge Pachkovsky<font color="#000080">, </font>Distributed Node <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">5000</font><font color="#000080">/</font><font color="#800000">19.19</font><font color="#000080">)

================================================================================

</font>Any comments<font color="#000080">, </font>suggestions<font color="#000080">, </font>ideas <font color="#FF0000"><b>and </b></font>corrections will be gladly accepted<font color="#000080">.

</font>Author can be reached <font color="#FF0000"><b>in </b></font>one <font color="#FF0000"><b>of </b></font>the following ways<font color="#000080">:

</font>Inbar Raz<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">401</font><font color="#000080">/</font><font color="#800000">100.1                          </font><font color="#008000"><i>{fidonet}
</i></font>Inbar Raz<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">403</font><font color="#000080">/</font><font color="#800000">100.42                         </font><font color="#008000"><i>{fidonet}
</i></font>nyvirus<font color="#000080">@</font>weizmann<font color="#000080">.</font>weizmann<font color="#000080">.</font>ac<font color="#000080">.</font>il                 <font color="#008000"><i>{internet}
</i></font>uunet<font color="#000080">!</font>m2xenix<font color="#000080">!</font>puddle<font color="#000080">!</font><font color="#800000">2</font><font color="#000080">!</font><font color="#800000">403</font><font color="#000080">!</font><font color="#800000">100.42</font><font color="#000080">!</font>Inbar<font color="#000080">.</font>Raz     <font color="#008000"><i>{UUCP}
</i></font>Inbar<font color="#000080">.</font>Raz<font color="#000080">@</font>p1<font color="#000080">.</font>f100<font color="#000080">.</font>n401<font color="#000080">.</font>z2<font color="#000080">.</font>fidonet<font color="#000080">.</font>org           <font color="#008000"><i>{internet&lt;&gt;FIDO gate}
</i></font>Inbar<font color="#000080">.</font>Raz<font color="#000080">@</font>p42<font color="#000080">.</font>f100<font color="#000080">.</font>n403<font color="#000080">.</font>z2<font color="#000080">.</font>fidonet<font color="#000080">.</font>org          <font color="#008000"><i>{internet&lt;&gt;FIDO gate}

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FAQ SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0054.PAS">Original</a><b>]</b></p></body>
</html>
