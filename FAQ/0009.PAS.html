<html>
<head><title> "BORLAND OVERLAYS QA" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FAQ SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>

<font color="#000000">TITLE<font color="#000080">: </font>TRUBO <font color="#FF0000"><b>PASCAL </b></font>OVERLAY ISSUES
<font color="#000080">===========================================================

</font>TP <font color="#800000">5.0 5.5 </font><font color="#000080">- </font>OVERLAY SUPPORT
Q<font color="#000080">. </font>Are overlays supported <font color="#FF0000"><b>in </b></font><font color="#800000">5.0</font><font color="#000080">+?
</font>A<font color="#000080">. </font>Yes<font color="#000080">! </font>See the example <font color="#FF0000"><b>program </b></font>OVRDEMO<font color="#000080">.</font>PAS <font color="#FF0000"><b>and </b></font>refer <font color="#FF0000"><b>to </b></font>the
   Turbo <font color="#FF0000"><b>Pascal </b></font>manual <font color="#FF0000"><b>for </b></font>information <font color="#FF0000"><b>on </b></font>overlays<font color="#000080">.

</font>TP <font color="#800000">5.0 5.5 </font><font color="#000080">- </font>OVERLAY UNITS LOADED INTO BUFFER
Q<font color="#000080">. </font><font color="#FF0000"><b>Is </b></font>there any way <font color="#FF0000"><b>to </b></font>determine what overlay units are loaded
   into the overlay buffer<font color="#000080">?
</font>A<font color="#000080">. </font>Using Turbo <font color="#FF0000"><b>Pascal </b></font><font color="#800000">5.0</font><font color="#000080">+, </font>there <font color="#FF0000"><b>is </b></font>no defined method <font color="#FF0000"><b>for
   </b></font>determining which units are loaded into the overlay buffer
   area<font color="#000080">. 

</font>TP <font color="#800000">5.0 5.5 </font><font color="#000080">- </font>OVERLAYS <font color="#000080">*.</font>OVR FILES
Q<font color="#000080">. </font>How can I transfer a large overlay <font color="#FF0000"><b>file </b></font>onto a floppy disk<font color="#000080">?
</font>A<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>the <font color="#FF0000"><b>file </b></font>does <font color="#FF0000"><b>not </b></font>fit <font color="#FF0000"><b>on </b></font>a single density disk<font color="#000080">, </font><font color="#FF0000"><b>then
   </b></font>transfer it <font color="#FF0000"><b>to </b></font>a double density disk<font color="#000080">.  </font><font color="#FF0000"><b>In </b></font>the latter <font color="#FF0000"><b>case</b></font><font color="#000080">,
   </font>your application will run only from the double density disk <font color="#FF0000"><b>or
   </b></font>a hard disk<font color="#000080">.

</font>TP5<font color="#000080">.</font><font color="#800000">5 </font>OVERLAY
Q<font color="#000080">. </font>How <font color="#FF0000"><b>do </b></font>I reclaim the memory used by overlay buffer <font color="#FF0000"><b>in </b></font>TP5<font color="#000080">.</font><font color="#800000">5</font><font color="#000080">?

</font>A<font color="#000080">. </font>The following example demonstrates how <font color="#FF0000"><b>to do </b></font>so<font color="#000080">.

</font><font color="#FF0000"><b>unit </b></font>Marker<font color="#000080">;

</font><font color="#FF0000"><b>interface

procedure </b></font>RestoreHeap<font color="#000080">; </font><font color="#FF0000"><b>procedure </b></font>RestoreOverlay<font color="#000080">;

</font><font color="#FF0000"><b>implementation

var </b></font>OldHeapPtr<font color="#000080">,</font>OldHeapOrg<font color="#000080">,</font>Temp<font color="#000080">:</font>pointer<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>OldHeapPtr<font color="#000080">,</font>OldHeapOrg<font color="#000080">,</font>Temp<font color="#000080">:</font>pointer<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>RestoreHeap<font color="#000080">; </font><font color="#FF0000"><b>begin
  </b></font>Release<font color="#000080">(</font>Temp<font color="#000080">);                </font><font color="#008000"><i>{2. Release all dynamic variables}
  </i></font>OldHeapOrg<font color="#000080">:=</font>HeapOrg<font color="#000080">;          </font><font color="#008000"><i>{3. Save Current Heap state }
  </i></font>OldHeapPtr<font color="#000080">:=</font>HeapPtr<font color="#000080">;
  </font>HeapOrg<font color="#000080">:=</font>ptr<font color="#000080">(</font>OvrHeapOrg<font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">);  </font><font color="#008000"><i>{4. Set Heap to Origin of Overlay Buffer}
  </i></font>HeapPtr<font color="#000080">:=</font>HeapOrg<font color="#000080">;
  </font>Mark<font color="#000080">(</font>Temp<font color="#000080">);                   </font><font color="#008000"><i>{5. Mark the origin of this heap } </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>RestoreOverlay<font color="#000080">; </font><font color="#FF0000"><b>begin
  </b></font>Release<font color="#000080">(</font>Temp<font color="#000080">);                </font><font color="#008000"><i>{6. Release all dynamic variables }
  </i></font>HeapOrg<font color="#000080">:=</font>OldHeapOrg<font color="#000080">;          </font><font color="#008000"><i>{7. Restore heap pointers }
  </i></font>HeapPtr<font color="#000080">:=</font>OldHeapPtr<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>mark<font color="#000080">(</font>temp<font color="#000080">);  </font><font color="#008000"><i>{1. Mark the beginning of heap after overlay buffer} </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>The <font color="#FF0000"><b>unit is to </b></font>be used before any <font color="#FF0000"><b>unit </b></font>that places items into the heap during
their <font color="#FF0000"><b>initialization</b></font><font color="#000080">.  </font>You would call RESTOREHEAP before using the <font color="#FF0000"><b>dynamic
</b></font>variables requiring memory used by the overlay buffer<font color="#000080">.  </font>A call <font color="#FF0000"><b>to </b></font>OVRCLEARBUF
must come before any call <font color="#FF0000"><b>to </b></font>RESTOREHEAP <font color="#FF0000"><b>to </b></font>ensure that the overlay buffer 
<font color="#FF0000"><b>is </b></font>empty <font color="#FF0000"><b>and to </b></font>force a reload <font color="#FF0000"><b>of </b></font>overlays when you are done<font color="#000080">.  </font>Note<font color="#000080">, </font>that all 
<font color="#FF0000"><b>dynamic </b></font>variables residing <font color="#FF0000"><b>on </b></font>the heap<font color="#000080">, </font>before a RESTOREHEAP call <font color="#FF0000"><b>is </b></font>made<font color="#000080">, </font>are
lost<font color="#000080">. (</font>But<font color="#000080">, </font>you could code around this by manipulating the free list<font color="#000080">).

</font>RESTOREOVERLAY clears the heap again <font color="#FF0000"><b>and </b></font>restores the heap pointers <font color="#FF0000"><b>to </b></font>point
above the overlay buffer<font color="#000080">.  </font>You may <font color="#FF0000"><b>then </b></font>start using overlaid procedures <font color="#FF0000"><b>and
</b></font>functions again<font color="#000080">.

</font>This <font color="#FF0000"><b>is </b></font>a simple example <font color="#FF0000"><b>and </b></font>may <font color="#FF0000"><b>not </b></font>be suitable <font color="#FF0000"><b>for </b></font>all purposes<font color="#000080">.




</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FAQ SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
