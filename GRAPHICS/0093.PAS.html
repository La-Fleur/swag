<html>
<head><title> "Multicolour Text Scroll" by OSCAR WAHLBERT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0093.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>program </b></font>multicolourtextscroll<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>sseg <font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">$b800</font><font color="#000080">; </font>hi <font color="#000080">= </font><font color="#800000">16</font><font color="#000080">; </font>wideness <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>txt <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">= </font><font color="#800000">'Multicoloured smooth text scroller!   '</font><font color="#000080">;
  </font>maxcols <font color="#000080">= </font><font color="#800000">17</font><font color="#000080">; </font>cols <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>maxcols<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">=
    (</font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>idx <font color="#000080">: </font>word<font color="#000080">; </font>i<font color="#000080">, </font>cur<font color="#000080">, </font>line<font color="#000080">, </font>bitpos <font color="#000080">: </font>byte<font color="#000080">;
    </font>ccol <font color="#000080">: </font>byte<font color="#000080">; </font>colw <font color="#000080">: </font>byte<font color="#000080">; </font>ch <font color="#000080">: </font>char<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>retrace<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,3dah;
  @l1: in al,dx; test al,8; jnz @l1;
  @l2: in al,dx; test al,8; jz @l2;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>movecharsleft<font color="#000080">(</font>startingrow <font color="#000080">: </font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push  ds;
  mov   ax,$b800;
  mov   ds,ax;
  mov   di,2
  @@MoveByte:
    add   di,startingrow;
    mov   al,[ds:di];
    sub   di,2
    mov   [ds:di],al;
    sub   di,startingrow;
    add   di,4
    cmp   di,160
  jl      @@MoveByte;
  pop   ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>movecolsright<font color="#000080">(</font>startingrow <font color="#000080">: </font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push  ds
  mov   ax,$b800
  mov   ds,ax
  mov   di,161
  @@MoveByte:
    add   di,startingrow
    sub   di,4
    mov   al,[ds:di]
    add   di,2
    mov   [ds:di],al
    sub   di,startingrow
    cmp   di,0001
  ja      @@MoveByte
  pop   ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin
  </b></font>textattr <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">; </font>clrscr<font color="#000080">; </font>ccol <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font>idx <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font>colw <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>inc<font color="#000080">(</font>colw<font color="#000080">);
    </font>retrace<font color="#000080">;
    </font>mem<font color="#000080">[</font><font color="#800000">$b800</font><font color="#000080">:</font>hi<font color="#000080">*</font><font color="#800000">160</font><font color="#000080">+</font><font color="#800000">158</font><font color="#000080">] := </font>ord<font color="#000080">(</font>txt<font color="#000080">[</font>idx<font color="#000080">]);
    </font>movecharsleft<font color="#000080">(</font>hi<font color="#000080">*</font><font color="#800000">160</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>colw <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>colw <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>inc<font color="#000080">(</font>ccol<font color="#000080">);
      </font>mem<font color="#000080">[</font><font color="#800000">$b800</font><font color="#000080">:</font>hi<font color="#000080">*</font><font color="#800000">160</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] := </font>cols<font color="#000080">[</font>ccol <font color="#FF0000"><b>mod </b></font><font color="#000080">(</font>maxcols<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)];
      </font>movecolsright<font color="#000080">(</font>hi<font color="#000080">*</font><font color="#800000">160</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if not </b></font>keypressed <font color="#FF0000"><b>then </b></font>idx <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">+ </font>idx <font color="#FF0000"><b>mod </b></font>length<font color="#000080">(</font>txt<font color="#000080">);
  </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>keypressed <font color="#FF0000"><b>do </b></font>ch <font color="#000080">:= </font>readkey<font color="#000080">; </font>textattr <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">; </font>clrscr<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>The push<font color="#000080">/</font>pop ds might be superfluous<font color="#000080">... </font>I don<font color="#800000">'t know if you need them or not...
</font>I<font color="#800000">'m just starting assembly, you know.  :^)
</font>It<font color="#800000">'s kinda like the one you made, but it doesn'</font>t lock up <font color="#FF0000"><b>on </b></font>my computer <font color="#000080">-- </font>you
can<font color="#800000">'t check port[$60] on XTs.  :^)
</font><font color="#FF0000"><b>And in </b></font>this<font color="#000080">, </font>the colours move one way<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>the text<font color="#000080">, </font>the other<font color="#000080">.  </font>It<font color="#800000">'s kinda
</font>distracting when you<font color="#800000">'re trying to read the scroll, but oh well...
</font>C<font color="#000080">-</font>YA<font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0093.PAS">Original</a><b>]</b></p></body>
</html>
