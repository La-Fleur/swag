<html>
<head><title> "Moving Poligon" by LUIS MEZQUITA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0122.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
PS&gt; I see that a lot of people around here have polygon, texture mapping and
PS&gt; 3D routines so why don't you all post them here, even if you already
PS&gt; have done in the past cause there are people who didn't get them
PS&gt; and want them :)
}

{$G+,R-}
</i></font><font color="#FF0000"><b>Program </b></font>Polygoned_and_shaded_objects<font color="#000080">;

</font><font color="#008000"><i>{ Mode-x version of polygoned objects          }
{ Originally by Bas van Gaalen &amp; Sven van Heel }
{ Optimized by Luis Mezquita Raya              }

</i></font><font color="#FF0000"><b>uses </b></font>Crt<font color="#000080">,</font>x3Dunit2<font color="#000080">;
         </font><font color="#008000"><i>{ ^^^^^  Contained in GRAPHICS.SWG file }
{$DEFINE Object1}                       { Try an object between 1..4 }

</i></font><font color="#FF0000"><b>const

</b></font><font color="#008000"><i>{$IFDEF Object1}                        { Octagon }
 </i></font>nofpolys<font color="#000080">=</font><font color="#800000">9</font><font color="#000080">;                            </font><font color="#008000"><i>{ Number of poligons-1 }

 </i></font>nofpoints<font color="#000080">=</font><font color="#800000">11</font><font color="#000080">;                          </font><font color="#008000"><i>{ Number of points-1 }

 </i></font>polypoints<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">;                          </font><font color="#008000"><i>{ Number of points for each poly }

 </i></font>sc<font color="#000080">=</font><font color="#800000">5</font><font color="#000080">;                                  </font><font color="#008000"><i>{ Number of visible planes }

 </i></font>cr<font color="#000080">=</font><font color="#800000">23</font><font color="#000080">;                                 </font><font color="#008000"><i>{ RGB components }
 </i></font>cg<font color="#000080">=</font><font color="#800000">8</font><font color="#000080">;
 </font>cb<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;

 </font>point<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nofpoints<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">=(
    (-</font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),( </font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),( </font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),( </font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),
    (-</font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),(-</font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),(-</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),( </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),
    ( </font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),( </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),(-</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),(-</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">));

 </font>planes<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nofpolys<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">=(
    (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">),(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">),(</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">),(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">),(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">),
    (</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">),(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">),(</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">),(</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">));
</font><font color="#008000"><i>{$ENDIF}

{$IFDEF Object2}                        { Cube }
 </i></font>nofpolys<font color="#000080">=</font><font color="#800000">5</font><font color="#000080">;                            </font><font color="#008000"><i>{ Number of poligons-1 }

 </i></font>nofpoints<font color="#000080">=</font><font color="#800000">7</font><font color="#000080">;                           </font><font color="#008000"><i>{ Number of points-1 }

 </i></font>polypoints<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">;                          </font><font color="#008000"><i>{ Number of points for each poly }

 </i></font>sc<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;                                  </font><font color="#008000"><i>{ Number of visible planes }

 </i></font>cr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;                                  </font><font color="#008000"><i>{ RGB components }
 </i></font>cg<font color="#000080">=</font><font color="#800000">13</font><font color="#000080">;
 </font>cb<font color="#000080">=</font><font color="#800000">23</font><font color="#000080">;

 </font>point<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nofpoints<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">=(
    (-</font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">),( </font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">),( </font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">),(-</font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">),
    (-</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">),( </font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">),( </font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">),(-</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">));

 </font>planes<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nofpolys<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">=(
    (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">),(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">),(</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">),
    (</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">),(</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">));
</font><font color="#008000"><i>{$ENDIF}

{$IFDEF Object3}                        { Octahedron }
 </i></font>nofpolys<font color="#000080">=</font><font color="#800000">7</font><font color="#000080">;                            </font><font color="#008000"><i>{ Number of poligons-1 }

 </i></font>nofpoints<font color="#000080">=</font><font color="#800000">5</font><font color="#000080">;                           </font><font color="#008000"><i>{ Number of points-1 }

 </i></font>polypoints<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;                          </font><font color="#008000"><i>{ Number of points for each poly }

 </i></font>sc<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">;                                  </font><font color="#008000"><i>{ Number of visible planes }

 </i></font>cr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;                                  </font><font color="#008000"><i>{ RGB components }
 </i></font>cg<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;
 </font>cb<font color="#000080">=</font><font color="#800000">23</font><font color="#000080">;

 </font>point<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nofpoints<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">=(
    (  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">45</font><font color="#000080">),(-</font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),(-</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),( </font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),
    ( </font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),(  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">45</font><font color="#000080">));

 </font>planes<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nofpolys<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">=(
    (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),
    (</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">),(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">),(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">),(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">));

</font><font color="#008000"><i>{$ENDIF}

{$IFDEF Object4}                        { Spiky }
 </i></font>nofpolys<font color="#000080">=</font><font color="#800000">15</font><font color="#000080">;                           </font><font color="#008000"><i>{ Number of poligons-1 }

 </i></font>nofpoints<font color="#000080">=</font><font color="#800000">19</font><font color="#000080">;                          </font><font color="#008000"><i>{ Number of points-1 }

 </i></font>polypoints<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">;                          </font><font color="#008000"><i>{ Number of points for each poly }

 </i></font>sc<font color="#000080">=</font><font color="#800000">5</font><font color="#000080">;                                  </font><font color="#008000"><i>{ Number of visible planes }

 </i></font>cr<font color="#000080">=</font><font color="#800000">23</font><font color="#000080">;                                 </font><font color="#008000"><i>{ RGB components }
 </i></font>cg<font color="#000080">=</font><font color="#800000">5</font><font color="#000080">;
 </font>cb<font color="#000080">=</font><font color="#800000">5</font><font color="#000080">;

 </font>point<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nofpoints<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">=(
    (-</font><font color="#800000">10</font><font color="#000080">,-</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),( </font><font color="#800000">10</font><font color="#000080">,-</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),( </font><font color="#800000">30</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),( </font><font color="#800000">10</font><font color="#000080">,-</font><font color="#800000">10</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),
    (-</font><font color="#800000">10</font><font color="#000080">,-</font><font color="#800000">10</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),(-</font><font color="#800000">30</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),(-</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),( </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),
    ( </font><font color="#800000">30</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),( </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),(-</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),(-</font><font color="#800000">30</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),
    ( -</font><font color="#800000">2</font><font color="#000080">, -</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">),( -</font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">),(  </font><font color="#800000">2</font><font color="#000080">, -</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">),(  </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">),
    ( -</font><font color="#800000">2</font><font color="#000080">, -</font><font color="#800000">2</font><font color="#000080">,-</font><font color="#800000">60</font><font color="#000080">),( -</font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">,-</font><font color="#800000">60</font><font color="#000080">),(  </font><font color="#800000">2</font><font color="#000080">, -</font><font color="#800000">2</font><font color="#000080">,-</font><font color="#800000">60</font><font color="#000080">),(  </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">,-</font><font color="#800000">60</font><font color="#000080">));

 </font>planes<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nofpolys<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">=(
    (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">),(</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">),(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">),(</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),
    (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">),(</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">),
    (</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">19</font><font color="#000080">,</font><font color="#800000">17</font><font color="#000080">),(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">16</font><font color="#000080">,</font><font color="#800000">17</font><font color="#000080">),(</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">16</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">),(</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">19</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">),
    (</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">),
    (</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">),(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">),(</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">),(</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">));
</font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>type  </b></font>polytype<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nofpolys<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;
      </font>pointype<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nofpoints<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;

      </font>ptnode<font color="#000080">=</font>word<font color="#000080">;
      </font>stack<font color="#000080">=</font>ptnode<font color="#000080">;

</font><font color="#FF0000"><b>const </b></font>soplt<font color="#000080">=</font>SizeOf<font color="#000080">(</font>polytype<font color="#000080">);
      </font>sopit<font color="#000080">=</font>SizeOf<font color="#000080">(</font>pointype<font color="#000080">);
      </font>xst<font color="#000080">:</font>integer<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;
      </font>yst<font color="#000080">:</font>integer<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;
      </font>zst<font color="#000080">:</font>integer<font color="#000080">=-</font><font color="#800000">2</font><font color="#000080">;

</font><font color="#FF0000"><b>var   </b></font>polyz<font color="#000080">,</font>pind<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font>byte<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>polytype<font color="#000080">;
      </font>xp<font color="#000080">,</font>yp<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font>byte<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>pointype<font color="#000080">;
      </font>phix<font color="#000080">:</font>byte<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>QuickSort<font color="#000080">(</font>lo<font color="#000080">,</font>hi<font color="#000080">:</font>integer<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#008000"><i>{ Iterative QuickSort }
</i></font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;                           </font><font color="#008000"><i>{ NON RECURSIVE }
</i></font><font color="#FF0000"><b>asm
        </b></font><font color="#FF00FF">mov ah,48h                      </font><font color="#008000"><i>{ Init stack }
        </i></font><font color="#FF00FF">mov bx,1
        int 21h
        jc @exit
        mov es,ax
        xor ax,ax
        mov es:[4],ax

        mov cx,lo                       </font><font color="#008000"><i>{ Push(lo,hi) }
        </i></font><font color="#FF00FF">mov dx,hi
        call @Push

@QS:    mov ax,es:[4]                   </font><font color="#008000"><i>{ &uml;Stack empty? }
        </i></font><font color="#FF00FF">and ax,ax
        jz @Empty

        mov cx,es:[0]                   </font><font color="#008000"><i>{ Top(lo,hi) }
        </i></font><font color="#FF00FF">mov dx,es:[2]
        mov lo,cx
        mov hi,dx

        mov bx,es:[4]                   </font><font color="#008000"><i>{ Pop }
        </i></font><font color="#FF00FF">mov ah,49h
        int 21h
        jc @exit
        mov es,bx

        mov ax,cx                       </font><font color="#008000"><i>{ ax:=(i+j) div 2 }
        </i></font><font color="#FF00FF">mov bx,dx
        add ax,bx
        shr ax,1

        lea bx,polyz                    </font><font color="#008000"><i>{ ax:=polyz[ax] }
        </i></font><font color="#FF00FF">call @index
        mov x,ax

@Rep:   mov ax,cx                       </font><font color="#008000"><i>{ repeat ... }
        </i></font><font color="#FF00FF">lea bx,polyz                    </font><font color="#008000"><i>{ while polyz[i]&lt;x do ... }
        </i></font><font color="#FF00FF">call @index
        cmp ax,x
        jge @Rep2
        inc cx                          </font><font color="#008000"><i>{ inc(i); }
        </i></font><font color="#FF00FF">jmp @Rep

@Rep2:  mov ax,dx                       </font><font color="#008000"><i>{ while x&lt;polyz[j] do ... }
        </i></font><font color="#FF00FF">call @index
        cmp x,ax
        jge @EndR
        dec dx                          </font><font color="#008000"><i>{ dec(j); }
        </i></font><font color="#FF00FF">jmp @Rep2

@EndR:  cmp cx,dx                       </font><font color="#008000"><i>{ if i&gt;j ==&gt; @NSwap}
        </i></font><font color="#FF00FF">jg @NBl

        je @NSwap
        push cx

        mov ax,cx
        call @index
        mov cx,ax                       </font><font color="#008000"><i>{ cx:=polyz[i] }
        </i></font><font color="#FF00FF">mov si,di

        mov ax,dx                       </font><font color="#008000"><i>{ polyz[i]:=polyz[j] }
        </i></font><font color="#FF00FF">call @index
        mov [si],ax

        mov [di],cx                     </font><font color="#008000"><i>{ polyz[j]:=cx }
        </i></font><font color="#FF00FF">pop ax

        push ax
        lea bx,pind
        call @index
        mov cx,ax                       </font><font color="#008000"><i>{ cx:=pind[i] }
        </i></font><font color="#FF00FF">mov si,di

        mov ax,dx                       </font><font color="#008000"><i>{ pind[i]:=pind[j] }
        </i></font><font color="#FF00FF">call @index
        mov [si],ax

        mov [di],cx                     </font><font color="#008000"><i>{ pind[j]:=cx }

        </i></font><font color="#FF00FF">pop cx
@NSwap: inc cx
        dec dx

@NBl:   cmp cx,dx                       </font><font color="#008000"><i>{ ... until i&gt;j; }
        </i></font><font color="#FF00FF">jle @Rep

        mov i,cx
        mov j,dx

        mov dx,hi                       </font><font color="#008000"><i>{ if i&gt;=hi ==&gt; @ChkLo }
        </i></font><font color="#FF00FF">cmp cx,dx
        jge @ChkLo

        call @Push                      </font><font color="#008000"><i>{ Push(i,hi) }

</i></font><font color="#FF00FF">@ChkLo: mov cx,lo                       </font><font color="#008000"><i>{ if lo&gt;=j ==&gt; @QSend }
        </i></font><font color="#FF00FF">mov dx,j
        cmp cx,dx
        jge @QSend

        call @Push                      </font><font color="#008000"><i>{ Push(lo,j) }

</i></font><font color="#FF00FF">@QSend: jmp @QS                         </font><font color="#008000"><i>{ loop while stack isn't empty }

</i></font><font color="#FF00FF">@Empty: mov ah,49h
        int 21h
        jmp @exit

@index: shl ax,1                        </font><font color="#008000"><i>{ ax:=2*ax }
        </i></font><font color="#FF00FF">add ax,bx
        mov di,ax
        push bx
        mov bl,soplt
        mov al,phix
        xor ah,ah
        mul bl
        add di,ax                       </font><font color="#008000"><i>{ di=2*index+SizeOf(polytype)+polyz }
        </i></font><font color="#FF00FF">pop bx
        mov ax,[di]
        ret

@Push:  mov ah,48h                      </font><font color="#008000"><i>{ Push into stack }
        </i></font><font color="#FF00FF">mov bx,1
        int 21h
        jc @exit
        mov bx,es
        mov es,ax
        mov es:[0],cx
        mov es:[2],dx
        mov es:[4],bx
        mov di,ax
        ret

@exit:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Calc<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>z<font color="#000080">:</font>pointype<font color="#000080">;
    </font>spx<font color="#000080">,</font>spy<font color="#000080">,</font>spz<font color="#000080">,
    </font>cpx<font color="#000080">,</font>cpy<font color="#000080">,</font>cpz<font color="#000080">,
    </font>zd<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">:</font>integer<font color="#000080">;
    </font>n<font color="#000080">,</font>key<font color="#000080">,</font>phiy<font color="#000080">,</font>phiz<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>phix<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>phiy<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>phiz<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>FillChar<font color="#000080">(</font>xp<font color="#000080">,</font>sizeof<font color="#000080">(</font>xp<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
 </font>FillChar<font color="#000080">(</font>yp<font color="#000080">,</font>sizeof<font color="#000080">(</font>yp<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);

 </font><font color="#FF0000"><b>repeat

  </b></font>spx<font color="#000080">:=</font>sinus<font color="#000080">(</font>phix<font color="#000080">);                     </font><font color="#008000"><i>{ 'Precookied' constanst }
  </i></font>spy<font color="#000080">:=</font>sinus<font color="#000080">(</font>phiy<font color="#000080">);
  </font>spz<font color="#000080">:=</font>sinus<font color="#000080">(</font>phiz<font color="#000080">);

  </font>cpx<font color="#000080">:=</font>cosinus<font color="#000080">(</font>phix<font color="#000080">);
  </font>cpy<font color="#000080">:=</font>cosinus<font color="#000080">(</font>phiy<font color="#000080">);
  </font>cpz<font color="#000080">:=</font>cosinus<font color="#000080">(</font>phiz<font color="#000080">);

  </font><font color="#FF0000"><b>for </b></font>n<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>nofpoints <font color="#FF0000"><b>do
   begin
    </b></font>i<font color="#000080">:=(</font>cpy<font color="#000080">*</font>point<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]-</font>spy<font color="#000080">*</font>point<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">;
    </font>j<font color="#000080">:=(</font>cpz<font color="#000080">*</font>point<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]-</font>spz<font color="#000080">*</font>i<font color="#000080">) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">;
    </font>k<font color="#000080">:=(</font>cpy<font color="#000080">*</font>point<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]+</font>spy<font color="#000080">*</font>point<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">;
    </font>x<font color="#000080">:=(</font>cpz<font color="#000080">*</font>i<font color="#000080">+</font>spz<font color="#000080">*</font>point<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">;
    </font>y<font color="#000080">:=(</font>cpx<font color="#000080">*</font>j<font color="#000080">+</font>spx<font color="#000080">*</font>k<font color="#000080">) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">;
    </font>z<font color="#000080">[</font>n<font color="#000080">]:=(</font>cpx<font color="#000080">*</font>k<font color="#000080">-</font>spx<font color="#000080">*</font>j<font color="#000080">) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">;
    </font>zd<font color="#000080">:=</font>z<font color="#000080">[</font>n<font color="#000080">]-</font>dist<font color="#000080">;
    </font>xp<font color="#000080">[</font>phix<font color="#000080">,</font>n<font color="#000080">]:=(</font><font color="#800000">160</font><font color="#000080">+</font>cpx<font color="#000080">)-(</font>x<font color="#000080">*</font>dist<font color="#000080">) </font><font color="#FF0000"><b>div </b></font>zd<font color="#000080">;
    </font>yp<font color="#000080">[</font>phix<font color="#000080">,</font>n<font color="#000080">]:=(</font><font color="#800000">200</font><font color="#000080">+</font>spz<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">-(</font>y<font color="#000080">*</font>dist<font color="#000080">) </font><font color="#FF0000"><b>div </b></font>zd<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>for </b></font>n<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>nofpolys <font color="#FF0000"><b>do
   begin
    </b></font>polyz<font color="#000080">[</font>phix<font color="#000080">,</font>n<font color="#000080">]:=(</font>z<font color="#000080">[</font>planes<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]]+</font>z<font color="#000080">[</font>planes<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]]+
                    </font>z<font color="#000080">[</font>planes<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]]+</font>z<font color="#000080">[</font>planes<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]]) </font><font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">;
    </font>pind<font color="#000080">[</font>phix<font color="#000080">,</font>n<font color="#000080">]:=</font>n<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>QuickSort<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>nofpolys<font color="#000080">);
  </font>inc<font color="#000080">(</font>phix<font color="#000080">,</font>xst<font color="#000080">);
  </font>inc<font color="#000080">(</font>phiy<font color="#000080">,</font>yst<font color="#000080">);
  </font>inc<font color="#000080">(</font>phiz<font color="#000080">,</font>zst<font color="#000080">);
 </font><font color="#FF0000"><b>until </b></font>phix<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ShowObject<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>n<font color="#000080">:</font>byte<font color="#000080">; </font>pim<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>retrace<font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>address<font color="#000080">=</font><font color="#800000">0
 </font><font color="#FF0000"><b>then </b></font>address<font color="#000080">:=</font><font color="#800000">16000
 </font><font color="#FF0000"><b>else </b></font>address<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>setaddress<font color="#000080">(</font>address<font color="#000080">);
 </font>cls<font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>n<font color="#000080">:=</font>sc <font color="#FF0000"><b>to </b></font>nofpolys <font color="#FF0000"><b>do
  begin
   </b></font>pim<font color="#000080">:=</font>pind<font color="#000080">[</font>phix<font color="#000080">,</font>n<font color="#000080">];
   </font>polygon<font color="#000080">(</font>xp<font color="#000080">[</font>phix<font color="#000080">,</font>planes<font color="#000080">[</font>pim<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]],</font>yp<font color="#000080">[</font>phix<font color="#000080">,</font>planes<font color="#000080">[</font>pim<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]],
           </font>xp<font color="#000080">[</font>phix<font color="#000080">,</font>planes<font color="#000080">[</font>pim<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]],</font>yp<font color="#000080">[</font>phix<font color="#000080">,</font>planes<font color="#000080">[</font>pim<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]],
           </font>xp<font color="#000080">[</font>phix<font color="#000080">,</font>planes<font color="#000080">[</font>pim<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]],</font>yp<font color="#000080">[</font>phix<font color="#000080">,</font>planes<font color="#000080">[</font>pim<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]],
           </font>xp<font color="#000080">[</font>phix<font color="#000080">,</font>planes<font color="#000080">[</font>pim<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]],</font>yp<font color="#000080">[</font>phix<font color="#000080">,</font>planes<font color="#000080">[</font>pim<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]],
           </font>polyz<font color="#000080">[</font>phix<font color="#000080">,</font>n<font color="#000080">]+</font><font color="#800000">30</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Rotate<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>setmodex<font color="#000080">;
 </font>address<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>Triangles<font color="#000080">:=</font>polypoints<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">80 </font><font color="#FF0000"><b>do </b></font>setpal<font color="#000080">(</font>i<font color="#000080">,</font>cr<font color="#000080">+</font>i <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">,</font>cg<font color="#000080">+</font>i <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">,</font>cb<font color="#000080">+</font>i <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">);
 </font>setborder<font color="#000080">(</font><font color="#800000">63</font><font color="#000080">);
 </font><font color="#FF0000"><b>repeat
  </b></font>ShowObject<font color="#000080">;
  </font>inc<font color="#000080">(</font>phix<font color="#000080">,</font>xst<font color="#000080">);
 </font><font color="#FF0000"><b>until </b></font>KeyPressed<font color="#000080">;
 </font>setborder<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
    </font>s<font color="#000080">:</font>stack<font color="#000080">;
    </font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{border:=True;}
 </i></font><font color="#FF0000"><b>if </b></font>ParamCount<font color="#000080">=</font><font color="#800000">1
 </font><font color="#FF0000"><b>then begin
       </b></font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">),</font>xst<font color="#000080">,</font>yst<font color="#000080">);
       </font><font color="#FF0000"><b>if </b></font>yst<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Halt<font color="#000080">;
       </font>zst<font color="#000080">:=-</font><font color="#800000">2</font><font color="#000080">*</font>xst<font color="#000080">;
       </font>yst<font color="#000080">:=</font>xst<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>WriteLn<font color="#000080">(</font><font color="#800000">'Wait a moment ...'</font><font color="#000080">);
 </font>Calc<font color="#000080">;
 </font>Rotate<font color="#000080">;
 </font>TextMode<font color="#000080">(</font>LastMode<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

        </font>But <font color="#000080">... </font>wait a moment <font color="#000080">... </font>you also need x3dUnit2<font color="#000080">.</font>pas
        which <font color="#FF0000"><b>is </b></font>also included <font color="#FF0000"><b>in </b></font>the SWAG files

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0122.PAS">Original</a><b>]</b></p></body>
</html>
