<html>
<head><title> "Save/Restore Graphics" by RICH VERAA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0131.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>

<font color="#FF0000"><b>Procedure </b></font>GetImage <font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">;</font>P<font color="#000080">:</font>Pointer<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov  bx,320
    push ds
    les  di,P

    mov  ax,0A000h
    mov  ds,ax
    mov  ax,Y1
    mov  dx,320
    mul  dx
    add  ax,X1
    mov  si,ax

    mov  ax,X2
    sub  ax,X1
    inc  ax
    mov  dx,ax
    stosw

    mov  ax,Y2
    sub  ax,Y1
    inc  ax
    stosw
    mov  cx,ax

  @@1:
    mov  cx,dx

    shr  cx,1
    cld
    rep  movsw

    test dx,1
    jz         @@2
    movsb
  @@2:
    add  si,bx
    sub  si,dx

    dec  ax
    jnz  @@1

    pop  ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PutImage <font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">:</font>Integer<font color="#000080">;</font>P<font color="#000080">:</font>Pointer<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov  bx,320
    push ds
    lds  si,P

    mov  ax,0A000h
    mov  es,ax
    mov  ax,Y1
    mov  dx,320
    mul  dx
    add  ax,X1
    mov  di,ax

    lodsw
    mov  dx,ax

    lodsw

  @@1:
    mov  cx,dx

    shr  cx,1
    cld
    rep  movsw

    test dx,1
    jz         @@2
    movsb
  @@2:
    add  di,bx
    sub  di,dx

    dec  ax
    jnz  @@1

    pop  ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetMem <font color="#000080">(</font>Buf1<font color="#000080">,</font><font color="#800000">64000</font><font color="#000080">);
  </font>GetMem<font color="#000080">(</font>Buf2<font color="#000080">,</font><font color="#800000">64000</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>init<font color="#000080">;
  </font>dographicstuff<font color="#000080">;

  </font>GetImage<font color="#000080">( </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">319</font><font color="#000080">,</font><font color="#800000">199</font><font color="#000080">,</font>Buf1<font color="#000080">);  </font><font color="#008000"><i>{store page 1}

  </i></font>domoregraphicstuff<font color="#000080">;

  </font>GetImage<font color="#000080">( </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">319</font><font color="#000080">,</font><font color="#800000">199</font><font color="#000080">,</font>Buf2<font color="#000080">);  </font><font color="#008000"><i>{store page 2}

  </i></font>PutImage <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">, </font>Buf1<font color="#000080">);  </font><font color="#008000"><i>{restore page 1}

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0131.PAS">Original</a><b>]</b></p></body>
</html>
