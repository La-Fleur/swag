<html>
<head><title> "Critters Graphics Display" by RON NOSSAMAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0225.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>BBBBB<font color="#000080">;         </font><font color="#008000"><i>{yep, B's}
{Cheap thrills from the WookieWare Home Defense Series}
{Ron Nossaman August 1995}
{Critters follow each other about in a controlled but random appearing
 manner. Periodically, the big'un takes off in a random direction and
 the rest of the swarm straggles after her. This started out as an
 experiment in orbital mechanics but typically collapsed into something
 even less useful but a lot more fun. Sort of 'a life simulation for
 the easily impressed'. Enjoy }
</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>graph<font color="#000080">,
     </font>bgiDRIV<font color="#000080">; </font><font color="#008000"><i>{ Wherever your have the BGI drivers compiled }

</i></font><font color="#FF0000"><b>const </b></font>radcon<font color="#000080">:</font>real<font color="#000080">=</font><font color="#800000">0.017453292</font><font color="#000080">;     </font><font color="#008000"><i>{radian/degree conversion value}
      </i></font>totalbodies<font color="#000080">=</font><font color="#800000">22</font><font color="#000080">;              </font><font color="#008000"><i>{whatever you think looks right}
      </i></font>speedfactor<font color="#000080">:</font>real<font color="#000080">=</font><font color="#800000">30</font><font color="#000080">;         </font><font color="#008000"><i>{lower= more frantic, higher= more sedate}
</i></font><font color="#FF0000"><b>type </b></font>debris<font color="#000080">=</font><font color="#FF0000"><b>record
               </b></font>mass<font color="#000080">,</font>dir<font color="#000080">,</font>speed<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">:</font>real<font color="#000080">;  </font><font color="#008000"><i>{stuff swarms are made of}
               </i></font>oldx<font color="#000080">,</font>oldy<font color="#000080">:</font>integer<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>b<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>totalbodies<font color="#000080">]</font><font color="#FF0000"><b>of </b></font>debris<font color="#000080">;
    </font>grdriver<font color="#000080">,</font>grmode<font color="#000080">,</font>errcode<font color="#000080">: </font>integer<font color="#000080">;
    </font>ch<font color="#000080">:</font>char<font color="#000080">;
    </font>i<font color="#000080">,</font>countdown<font color="#000080">,</font>walls<font color="#000080">,</font>delayfactor<font color="#000080">:</font>integer<font color="#000080">;
    </font>stampede<font color="#000080">:</font>boolean<font color="#000080">;
    </font>bait<font color="#000080">:</font>debris<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>theta<font color="#000080">(</font>p1x<font color="#000080">,</font>p1y<font color="#000080">,</font>p2x<font color="#000080">,</font>p2y<font color="#000080">:</font>real<font color="#000080">):</font>real<font color="#000080">;
</font><font color="#008000"><i>{Given two sets of point coordinates, returns the angle
 between them in degrees. I've found this to be very handy}
</i></font><font color="#FF0000"><b>var </b></font>t<font color="#000080">,</font>lx<font color="#000080">,</font>ly<font color="#000080">:</font>real<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>lx<font color="#000080">:=</font>p2x<font color="#000080">-</font>p1x<font color="#000080">; </font>ly<font color="#000080">:=</font>p2y<font color="#000080">-</font>p1y<font color="#000080">;
   </font><font color="#FF0000"><b>if</b></font><font color="#000080">((</font>lx<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>ly<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">))</font><font color="#FF0000"><b>then </b></font>theta<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>else
   begin
      if </b></font>lx<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>t<font color="#000080">:=</font>arctan<font color="#000080">(</font>ly<font color="#000080">/</font><font color="#800000">0.0000000001</font><font color="#000080">)/</font>radcon <font color="#FF0000"><b>else
         </b></font>t<font color="#000080">:=</font>arctan<font color="#000080">(</font>ly<font color="#000080">/</font>lx<font color="#000080">)/</font>radcon<font color="#000080">;       </font><font color="#008000"><i>{divide by zero duck}
      </i></font><font color="#FF0000"><b>if </b></font>lx<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>t<font color="#000080">:=</font>t<font color="#000080">+</font><font color="#800000">180</font><font color="#000080">;             </font><font color="#008000"><i>{vector adjustments}
      </i></font><font color="#FF0000"><b>if</b></font><font color="#000080">((</font>lx<font color="#000080">&gt;=</font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>ly<font color="#000080">&lt;</font><font color="#800000">0</font><font color="#000080">))</font><font color="#FF0000"><b>then </b></font>t<font color="#000080">:=</font>t<font color="#000080">+</font><font color="#800000">360</font><font color="#000080">; </font><font color="#008000"><i>{back into range}
      </i></font>theta<font color="#000080">:=</font>abs<font color="#000080">(</font>t<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>hypotenuse<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">:</font>real<font color="#000080">):</font>real<font color="#000080">;
</font><font color="#008000"><i>{just what it says}
</i></font><font color="#FF0000"><b>var </b></font>h1<font color="#000080">,</font>h2<font color="#000080">:</font>real<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>hypotenuse<font color="#000080">:=</font>sqrt<font color="#000080">(</font>sqr<font color="#000080">(</font>abs<font color="#000080">(</font>x1<font color="#000080">-</font>x2<font color="#000080">))+</font>sqr<font color="#000080">(</font>abs<font color="#000080">(</font>y1<font color="#000080">-</font>y2<font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>procedure </b></font>init<font color="#000080">; </font><font color="#008000"><i>{Gentlemen, start your b's}
</i></font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>integer<font color="#000080">;
    </font>g<font color="#000080">:</font>real<font color="#000080">;
</font><font color="#FF0000"><b>begin
   for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>totalbodies <font color="#FF0000"><b>do
   begin
      </b></font>b<font color="#000080">[</font>i<font color="#000080">].</font>x<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">600</font><font color="#000080">)+</font><font color="#800000">20</font><font color="#000080">;
      </font>b<font color="#000080">[</font>i<font color="#000080">].</font>y<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">440</font><font color="#000080">)+</font><font color="#800000">20</font><font color="#000080">;
      </font>b<font color="#000080">[</font>i<font color="#000080">].</font>dir<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">359</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
      </font>b<font color="#000080">[</font>i<font color="#000080">].</font>speed<font color="#000080">:=(</font>random<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">)+</font><font color="#800000">50</font><font color="#000080">)/</font>speedfactor<font color="#000080">;
      </font>b<font color="#000080">[</font>i<font color="#000080">].</font>mass<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">50</font><font color="#000080">)+</font><font color="#800000">100</font><font color="#000080">;
      </font>bait<font color="#000080">.</font>x<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">600</font><font color="#000080">)+</font><font color="#800000">20</font><font color="#000080">;
      </font>bait<font color="#000080">.</font>y<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">440</font><font color="#000080">)+</font><font color="#800000">20</font><font color="#000080">;
      </font>bait<font color="#000080">.</font>mass<font color="#000080">:=</font><font color="#800000">100</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>delayfactor<font color="#000080">:=</font>round<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">/</font>b<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>speed<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>orbit<font color="#000080">(</font>a<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>a2<font color="#000080">,</font>min<font color="#000080">,</font>xmax<font color="#000080">,</font>ymax<font color="#000080">:</font>integer<font color="#000080">;
    </font>t<font color="#000080">,</font>m1<font color="#000080">,</font>m2<font color="#000080">,</font>ax<font color="#000080">,</font>ay<font color="#000080">,</font>newdir<font color="#000080">,</font>rate<font color="#000080">:</font>real<font color="#000080">;
</font><font color="#FF0000"><b>begin
   if </b></font>a<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>a2<font color="#000080">:=</font>totalbodies <font color="#FF0000"><b>else </b></font>a2<font color="#000080">:=</font>a<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;           </font><font color="#008000"><i>{a=1 is the queen}
   </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>stampede <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>a<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then
   begin                                               </b></font><font color="#008000"><i>{beeline toward bait}
      </i></font>t<font color="#000080">:=</font>theta<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">,</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">,</font>bait<font color="#000080">.</font>x<font color="#000080">,</font>bait<font color="#000080">.</font>y<font color="#000080">);           </font><font color="#008000"><i>{target vector}
      </i></font>m2<font color="#000080">:=</font>hypotenuse<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">,</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">,</font>bait<font color="#000080">.</font>x<font color="#000080">,</font>bait<font color="#000080">.</font>y<font color="#000080">);   </font><font color="#008000"><i>{distance}
      </i></font>m1<font color="#000080">:=</font>bait<font color="#000080">.</font>mass<font color="#000080">;        </font><font color="#008000"><i>{attraction factor}
      </i></font>rate<font color="#000080">:=</font><font color="#800000">10</font><font color="#000080">;             </font><font color="#008000"><i>{queen's cornering ability}
   </i></font><font color="#FF0000"><b>end else                 </b></font><font color="#008000"><i>{smooths abrupt directional changes}
   </i></font><font color="#FF0000"><b>begin
      </b></font>t<font color="#000080">:=</font>theta<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">,</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">,</font>b<font color="#000080">[</font>a2<font color="#000080">].</font>x<font color="#000080">,</font>b<font color="#000080">[</font>a2<font color="#000080">].</font>y<font color="#000080">);  </font><font color="#008000"><i>{follow last in line instead}
      </i></font>m2<font color="#000080">:=</font>hypotenuse<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">,</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">,</font>b<font color="#000080">[</font>a2<font color="#000080">].</font>x<font color="#000080">,</font>b<font color="#000080">[</font>a2<font color="#000080">].</font>y<font color="#000080">);
      </font>m1<font color="#000080">:=</font>b<font color="#000080">[</font>a2<font color="#000080">].</font>mass<font color="#000080">;
      </font>rate<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>ax<font color="#000080">:=</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">+(</font>m1<font color="#000080">*</font>cos<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">*</font>radcon<font color="#000080">))+(</font>m2<font color="#000080">*</font>cos<font color="#000080">(</font>t<font color="#000080">*</font>radcon<font color="#000080">)); </font><font color="#008000"><i>{new position}
   </i></font>ay<font color="#000080">:=</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">+(</font>m1<font color="#000080">*</font>sin<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">*</font>radcon<font color="#000080">))+(</font>m2<font color="#000080">*</font>sin<font color="#000080">(</font>t<font color="#000080">*</font>radcon<font color="#000080">));
   </font>newdir<font color="#000080">:=</font>theta<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">,</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">,</font>ax<font color="#000080">,</font>ay<font color="#000080">);   </font><font color="#008000"><i>{resulting direction deflection}
    {this is not a very efficient way of doing this, but when I got
      it to do what I wanted, I quit dinking with it}
   </i></font><font color="#FF0000"><b>if </b></font>a<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then
   begin
      if </b></font>abs<font color="#000080">(</font>newdir<font color="#000080">-</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">)&gt;=</font><font color="#800000">180 </font><font color="#FF0000"><b>then
      begin
         if </b></font>newdir<font color="#000080">&gt;</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir <font color="#FF0000"><b>then </b></font>newdir<font color="#000080">:=</font>newdir<font color="#000080">-</font><font color="#800000">360
           </font><font color="#FF0000"><b>else </b></font>newdir<font color="#000080">:=</font>newdir<font color="#000080">+</font><font color="#800000">360</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;                           </font><font color="#008000"><i>{smooth direction change rate}
      </i></font><font color="#FF0000"><b>if </b></font>newdir<font color="#000080">&gt;</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir <font color="#FF0000"><b>then </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">:=</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">+((</font>newdir<font color="#000080">-</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">)/</font>rate<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>newdir<font color="#000080">&lt;</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir <font color="#FF0000"><b>then </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">:=</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">-((</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">-</font>newdir<font color="#000080">)/</font>rate<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>round<font color="#000080">(</font>newdir<font color="#000080">)=</font>round<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">)
          </font><font color="#FF0000"><b>then </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">:=</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">+</font>random<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">)-</font><font color="#800000">5</font><font color="#000080">;
   </font><font color="#FF0000"><b>end else </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">:=</font>newdir<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">&gt;</font><font color="#800000">359 </font><font color="#FF0000"><b>then </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">:=</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">-</font><font color="#800000">360</font><font color="#000080">;   </font><font color="#008000"><i>{fix direction overflow}
   </i></font><font color="#FF0000"><b>if </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">:=</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">+</font><font color="#800000">360</font><font color="#000080">;
   </font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">:=</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">+(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>speed<font color="#000080">*</font>cos<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">*</font>radcon<font color="#000080">));
   </font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">:=</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">+(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>speed<font color="#000080">*</font>sin<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>dir<font color="#000080">*</font>radcon<font color="#000080">));
   </font><font color="#FF0000"><b>if </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">&lt;</font><font color="#800000">3 </font><font color="#FF0000"><b>then </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">&gt;</font><font color="#800000">637 </font><font color="#FF0000"><b>then </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">:=</font><font color="#800000">637</font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">&lt;</font><font color="#800000">3 </font><font color="#FF0000"><b>then </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">&gt;</font><font color="#800000">477 </font><font color="#FF0000"><b>then </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">:=</font><font color="#800000">477</font><font color="#000080">;
   </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">=</font><font color="#800000">637</font><font color="#000080">)</font><font color="#FF0000"><b>or</b></font><font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">)</font><font color="#FF0000"><b>or</b></font><font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">=</font><font color="#800000">477</font><font color="#000080">)</font><font color="#FF0000"><b>or</b></font><font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>then
   begin
      </b></font>b<font color="#000080">[</font>a<font color="#000080">].</font>speed<font color="#000080">:=(</font>random<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">)+</font><font color="#800000">50</font><font color="#000080">)/</font>speedfactor<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>a<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>delayfactor<font color="#000080">:=</font>round<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">/</font>b<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>speed<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>oldx<font color="#000080">&lt;&gt;</font>round<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">))</font><font color="#FF0000"><b>or</b></font><font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>oldy<font color="#000080">&lt;&gt;</font>round<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">)) </font><font color="#FF0000"><b>then
   begin
      </b></font>setcolor<font color="#000080">(</font>black<font color="#000080">);
      </font>circle<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>oldx<font color="#000080">,</font>b<font color="#000080">[</font>a<font color="#000080">].</font>oldy<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);             </font><font color="#008000"><i>{erase old position}
      </i></font><font color="#FF0000"><b>if </b></font>a<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>circle<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>oldx<font color="#000080">,</font>b<font color="#000080">[</font>a<font color="#000080">].</font>oldy<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
      </font>setcolor<font color="#000080">(</font>white<font color="#000080">);
      </font>circle<font color="#000080">(</font>round<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">),</font>round<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);     </font><font color="#008000"><i>{draw new position}
      </i></font><font color="#FF0000"><b>if </b></font>a<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then
      begin
         </b></font>setcolor<font color="#000080">(</font>lightgray<font color="#000080">);
         </font>circle<font color="#000080">(</font>round<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">),</font>round<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">),</font><font color="#800000">2</font><font color="#000080">);  </font><font color="#008000"><i>{queen's bigger}
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>b<font color="#000080">[</font>a<font color="#000080">].</font>oldx<font color="#000080">:=</font>round<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>x<font color="#000080">);
   </font>b<font color="#000080">[</font>a<font color="#000080">].</font>oldy<font color="#000080">:=</font>round<font color="#000080">(</font>b<font color="#000080">[</font>a<font color="#000080">].</font>y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Abort<font color="#000080">(</font>Msg <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Writeln<font color="#000080">(</font>Msg<font color="#000080">, </font><font color="#800000">': '</font><font color="#000080">, </font>GraphErrorMsg<font color="#000080">(</font>GraphResult<font color="#000080">));
  </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  if </b></font>RegisterBGIdriver<font color="#000080">(@</font>EGAVGADriverProc<font color="#000080">)&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>abort<font color="#000080">(</font><font color="#800000">'EGA/VGA'</font><font color="#000080">);
  </font>countdown<font color="#000080">:=</font><font color="#800000">100</font><font color="#000080">;
  </font>stampede<font color="#000080">:=</font>false<font color="#000080">;
  </font>randomize<font color="#000080">;
  </font>ch<font color="#000080">:=</font><font color="#800000">#0</font><font color="#000080">;
  </font>grDriver <font color="#000080">:= </font>Detect<font color="#000080">;
  </font>InitGraph<font color="#000080">(</font>grDriver<font color="#000080">,</font>grmode<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
  </font>setgraphmode<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
  </font>ErrCode <font color="#000080">:= </font>GraphResult<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>ErrCode <font color="#000080">&lt;&gt; </font>grOk <font color="#FF0000"><b>then
    begin
      </b></font>CloseGraph<font color="#000080">;
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Graphics error:'</font><font color="#000080">, </font>GraphErrorMsg<font color="#000080">(</font>ErrCode<font color="#000080">));
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>init<font color="#000080">;
   </font><font color="#FF0000"><b>while </b></font>keypressed <font color="#FF0000"><b>do </b></font>ch<font color="#000080">:=</font>readkey<font color="#000080">;
   </font><font color="#FF0000"><b>repeat
      for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>totalbodies <font color="#FF0000"><b>do </b></font>orbit<font color="#000080">(</font>i<font color="#000080">);
      </font>dec<font color="#000080">(</font>countdown<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>countdown<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
         </b></font>stampede<font color="#000080">:=</font><font color="#FF0000"><b>not </b></font>stampede<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>stampede <font color="#FF0000"><b>then
         begin
          </b></font><font color="#008000"><i>{de-bracket to c-d-bait}
{            setcolor(black);
            circle(round(bait.x),round(bait.y),2);}
            </i></font>walls<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
            </font>countdown<font color="#000080">:=</font>random<font color="#000080">(</font>delayfactor<font color="#000080">)+</font>delayfactor<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">;
            </font><font color="#FF0000"><b>case </b></font>walls <font color="#FF0000"><b>of          </b></font><font color="#008000"><i>{the bait always goes on a wall because}
            </i></font><font color="#800000">0</font><font color="#000080">:</font><font color="#FF0000"><b>begin                </b></font><font color="#008000"><i>{it makes the migrations more dramatic}
                 </i></font>bait<font color="#000080">.</font>x<font color="#000080">:=</font><font color="#800000">20</font><font color="#000080">;       </font><font color="#008000"><i>{and I like the effect. that's why}
                 </i></font>bait<font color="#000080">.</font>y<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">480</font><font color="#000080">);
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#800000">1</font><font color="#000080">:</font><font color="#FF0000"><b>begin
                 </b></font>bait<font color="#000080">.</font>x<font color="#000080">:=</font><font color="#800000">619</font><font color="#000080">;
                 </font>bait<font color="#000080">.</font>y<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">480</font><font color="#000080">);
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#800000">2</font><font color="#000080">:</font><font color="#FF0000"><b>begin
                 </b></font>bait<font color="#000080">.</font>y<font color="#000080">:=</font><font color="#800000">20</font><font color="#000080">;
                 </font>bait<font color="#000080">.</font>x<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">640</font><font color="#000080">);
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#800000">3</font><font color="#000080">:</font><font color="#FF0000"><b>begin
                 </b></font>bait<font color="#000080">.</font>y<font color="#000080">:=</font><font color="#800000">459</font><font color="#000080">;
                 </font>bait<font color="#000080">.</font>x<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">640</font><font color="#000080">);
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#008000"><i>{de-bracket to c-d-bait}
{            setcolor(lightblue);
            circle(round(bait.x),round(bait.y),2);}
         </i></font><font color="#FF0000"><b>end  else </b></font>countdown<font color="#000080">:=</font>random<font color="#000080">(</font>delayfactor<font color="#000080">)+</font>delayfactor<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>keypressed <font color="#FF0000"><b>then </b></font>ch<font color="#000080">:=</font>readkey<font color="#000080">;
   </font><font color="#FF0000"><b>until </b></font>ch<font color="#000080">=</font><font color="#800000">#27</font><font color="#000080">;
   </font>closegraph<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0225.PAS">Original</a><b>]</b></p></body>
</html>
