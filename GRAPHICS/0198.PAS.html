<html>
<head><title> "Check for graphmode" by PING HANSEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0198.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here is a little routine for those of you wanting to check if the VGA is in
graphics mode or textmode - quite handy for screensavers and DOS pop-ups.
}

</i></font><font color="#FF0000"><b>Var
  </b></font>t1<font color="#000080">, </font>t2 <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>InGraphMode <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">CLI
    Mov   Dx,3DAh
    In    Al,Dx         </font><font color="#008000"><i>{Reset addr/data flipflop}
    </i></font><font color="#FF00FF">Mov   Dx,3C0h       </font><font color="#008000"><i>{Index register}
    </i></font><font color="#FF00FF">Mov   Al,30h        </font><font color="#008000"><i>{10h + keep screen output enabled}
    </i></font><font color="#FF00FF">Out   Dx,Al         </font><font color="#008000"><i>{Set index}
    </i></font><font color="#FF00FF">Inc   Dx            </font><font color="#008000"><i>{Read address}
    {Accesses to the attribute controller must be separated by at least 250ns}
    </i></font><font color="#FF00FF">Nop                 </font><font color="#008000"><i>{Small delay, try Jmp @Lab; @Lab: if it doesn't work}
    </i></font><font color="#FF00FF">In    Al,Dx         </font><font color="#008000"><i>{Get mode control register}
    </i></font><font color="#FF00FF">And   Al,1          </font><font color="#008000"><i>{Isolate graphics bit}
    </i></font><font color="#FF00FF">STI
</font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{InGraphMode}</i></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetMode<font color="#000080">(</font>m <font color="#000080">: </font>word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">Mov ax,m
    int 10h
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>SetMode<font color="#000080">(</font><font color="#800000">$13</font><font color="#000080">);
  </font>t1 <font color="#000080">:= </font>InGraphMode<font color="#000080">;
  </font>SetMode<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
  </font>t2 <font color="#000080">:= </font>InGraphMode<font color="#000080">;
  </font>Writeln<font color="#000080">(</font>t1<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>t2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0198.PAS">Original</a><b>]</b></p></body>
</html>
