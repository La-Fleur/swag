<html>
<head><title> "Simple Lightning effect" by NELSON CHU</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0242.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ [ Simple lightning effect ]
      By Nelson Chu, 1994

 This is the lightning effect used in my action puzzle game Mixed World.
 Feel free to change this program. If you have any improvement, please
 send me a copy too. Internet e-mail: eg_cshaa@stu.ust.hk

 Sorry that I just encode the .PAL file to be included here. I was too
 lazy to write a set-pal routine to set it on the fly.}

{$A+,R-,S-,N-,L-,O-,D-,X+,G+}
</i></font><font color="#FF0000"><b>uses </b></font>graphic<font color="#000080">, </font>crt<font color="#000080">;
</font><font color="#008000"><i>{Unit GRAPHIC to be found in GRAPHICS.SWG }
</i></font><font color="#FF0000"><b>var </b></font>pal <font color="#000080">: </font>paltype<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Lightning<font color="#000080">;  </font><font color="#008000"><i>{ a fractal effect }
</i></font><font color="#FF0000"><b>var </b></font>aa <font color="#000080">: </font>integer<font color="#000080">;
    </font>a<font color="#000080">,</font>x<font color="#000080">,</font>y <font color="#000080">: </font>byte<font color="#000080">;

 </font><font color="#FF0000"><b>procedure </b></font>process<font color="#000080">( </font>x<font color="#000080">, </font>y<font color="#000080">, </font>intensity<font color="#000080">, </font>dx <font color="#000080">:</font>integer<font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>part_int<font color="#000080">, </font>d <font color="#000080">: </font>byte<font color="#000080">;

   </font><font color="#FF0000"><b>procedure </b></font>add<font color="#000080">(</font>x<font color="#000080">:</font>word<font color="#000080">; </font>y<font color="#000080">, </font>int<font color="#000080">:</font>byte<font color="#000080">);
   </font><font color="#FF0000"><b>begin if </b></font>screen<font color="#000080">^[</font>y<font color="#000080">,</font>x<font color="#000080">]&lt;</font>int <font color="#FF0000"><b>then </b></font>screen<font color="#000080">^[</font>y<font color="#000080">,</font>x<font color="#000080">]:=</font>int<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>begin
  while </b></font><font color="#000080">(</font>intensity<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y<font color="#000080">&lt;</font><font color="#800000">200</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x<font color="#000080">&gt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x<font color="#000080">&lt;</font><font color="#800000">319</font><font color="#000080">) </font><font color="#FF0000"><b>do
  begin

   </b></font>add<font color="#000080">( </font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>y<font color="#000080">, (</font>intensity<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">)*</font><font color="#800000">20</font><font color="#000080">+</font><font color="#800000">50</font><font color="#000080">);
   </font>add<font color="#000080">( </font>x<font color="#000080">,   </font>y<font color="#000080">, (</font>intensity<font color="#000080">)*</font><font color="#800000">20</font><font color="#000080">+</font><font color="#800000">50</font><font color="#000080">);
   </font>add<font color="#000080">( </font>x<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>y<font color="#000080">, (</font>intensity<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">)*</font><font color="#800000">20</font><font color="#000080">+</font><font color="#800000">50</font><font color="#000080">);

   </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>random<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>y<font color="#000080">&gt;</font><font color="#800000">170</font><font color="#000080">)) </font><font color="#FF0000"><b>or
      </b></font><font color="#000080">((</font>random<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>abs<font color="#000080">(</font>dx<font color="#000080">)&gt;</font><font color="#800000">5</font><font color="#000080">))</font><font color="#FF0000"><b>or
       </b></font><font color="#000080">(</font>random<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>dec<font color="#000080">(</font>intensity<font color="#000080">);

   </font>inc<font color="#000080">(</font>y<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{go next row every time}

   </i></font><font color="#FF0000"><b>if </b></font>dx<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>dec<font color="#000080">(</font>x<font color="#000080">,</font>random<font color="#000080">(</font>dx<font color="#000080">)) </font><font color="#FF0000"><b>else </b></font>inc<font color="#000080">(</font>x<font color="#000080">,</font>random<font color="#000080">(-</font>dx<font color="#000080">));

   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>abs<font color="#000080">(</font>dx<font color="#000080">)&lt;</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then begin </b></font>dec<font color="#000080">(</font>x<font color="#000080">,</font>random<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">); </font>dx<font color="#000080">:=-</font><font color="#800000">2</font><font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>abs<font color="#000080">(</font>dx<font color="#000080">)&gt;</font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>then begin </b></font>inc<font color="#000080">(</font>x<font color="#000080">,</font>random<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">); </font>dx<font color="#000080">:=+</font><font color="#800000">2</font><font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


   </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>y<font color="#000080">&gt;</font><font color="#800000">33</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>random<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>intensity<font color="#000080">&lt;</font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{split}
   </i></font><font color="#FF0000"><b>begin
    </b></font>part_int<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
    </font><font color="#FF0000"><b>repeat </b></font>d<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">); </font><font color="#FF0000"><b>until </b></font>d<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">;
    </font>process<font color="#000080">( </font>x<font color="#000080">, </font>y<font color="#000080">, (</font>intensity<font color="#000080">*</font>part_int<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">10 </font><font color="#000080">- </font>y <font color="#FF0000"><b>div </b></font><font color="#800000">20</font><font color="#000080">, -</font>random<font color="#000080">(</font>d<font color="#000080">));
    </font>process<font color="#000080">( </font>x<font color="#000080">, </font>y<font color="#000080">, (</font>intensity<font color="#000080">*(</font><font color="#800000">10</font><font color="#000080">-</font>part_int<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">10 </font><font color="#000080">- </font>y <font color="#FF0000"><b>div </b></font><font color="#800000">20</font><font color="#000080">, </font>random<font color="#000080">(</font>d<font color="#000080">));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font>blacken<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);
</font>aa<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">);</font><font color="#008000"><i>{this is for delay}
</i></font><font color="#FF0000"><b>repeat

 repeat </b></font>delay<font color="#000080">(</font><font color="#800000">120</font><font color="#000080">); </font>dec<font color="#000080">(</font>aa<font color="#000080">); </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>aa<font color="#000080">&lt;=</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{do a variable delay}
 </i></font><font color="#FF0000"><b>repeat </b></font>aa<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">)-</font><font color="#800000">3</font><font color="#000080">; </font><font color="#FF0000"><b>until </b></font>abs<font color="#000080">(</font>aa<font color="#000080">)&gt;</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{get a good starting direction}

 </i></font>process<font color="#000080">( </font>random<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">)+</font><font color="#800000">110</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font>aa <font color="#000080">); </font><font color="#008000"><i>{get our discharge ready}

 </i></font>vsync<font color="#000080">;   </font>Setpal<font color="#000080">(</font>pal<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);
 </font>vsync<font color="#000080">;   </font>setcolor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">); </font><font color="#008000"><i>{sky suddenly brighten...}
 </i></font>vsync<font color="#000080">;   </font>setcolor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#008000"><i>{ repeat until keypressed;}
 </i></font>vsync<font color="#000080">;   </font>fadeout<font color="#000080">(</font>pal<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);

 </font>clearscreen<font color="#000080">(</font>screen<font color="#000080">);
</font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure message</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>write<font color="#000080">(
 </font><font color="#800000">'This is what you should do in order to enjoy this LIGHTNING demo :)'#13#13#10</font><font color="#000080">+
 </font><font color="#800000">' 1. If it''s now daytime or somebody is with you, wait until it is not.'#13#10</font><font color="#000080">+
 </font><font color="#800000">'    Press Ctrl-C to quit.'#13#10</font><font color="#000080">);
</font>write<font color="#000080">(
 </font><font color="#800000">' 2. Close all curtains/doors so that no light can enter your room.'#13#10</font><font color="#000080">+
 </font><font color="#800000">' 3. Sit back and press ENTER...'</font><font color="#000080">);

</font>readln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>message2<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>write<font color="#000080">(</font><font color="#800000">'It should be with sounds too. But this is for SWAG... :P'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font>randomize<font color="#000080">;
</font><font color="#FF0000"><b>message</b></font><font color="#000080">;
</font>setcrtmode<font color="#000080">(</font><font color="#800000">$13</font><font color="#000080">);
</font>loadpal<font color="#000080">(</font><font color="#800000">'light1.pal'</font><font color="#000080">, </font>pal<font color="#000080">, </font>true<font color="#000080">);
</font>lightning<font color="#000080">;
</font>setcrtmode<font color="#000080">(</font><font color="#800000">$3</font><font color="#000080">);
</font>message2<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ Cut the following out and decode it with XX34. }

</i></font><font color="#000080">*</font>XX3402<font color="#000080">-</font><font color="#800000">000768</font><font color="#000080">-</font><font color="#800000">220596</font><font color="#000080">--</font><font color="#800000">72</font><font color="#000080">--</font><font color="#800000">85</font><font color="#000080">-</font><font color="#800000">42191</font><font color="#000080">------</font>LIGHT1<font color="#000080">.</font>PAL<font color="#000080">--</font><font color="#800000">1</font><font color="#000080">-</font><font color="#FF0000"><b>OF</b></font><font color="#000080">--</font><font color="#800000">1
</font><font color="#000080">+++++++++++++++++++++++-+++-+++-++</font><font color="#800000">2</font><font color="#000080">-++</font><font color="#800000">2</font><font color="#000080">-++</font><font color="#800000">20</font><font color="#000080">++</font><font color="#800000">20</font><font color="#000080">++</font><font color="#800000">20</font><font color="#000080">++</font><font color="#800000">20</font><font color="#000080">++</font><font color="#800000">21</font><font color="#000080">++</font><font color="#800000">21</font><font color="#000080">++</font><font color="#800000">21</font><font color="#000080">+</font>E21
<font color="#000080">+</font>E62<font color="#000080">+</font>E62<font color="#000080">+</font>E62<font color="#000080">+</font>E62<font color="#000080">+</font>E63<font color="#000080">+</font>EA3<font color="#000080">+</font>EA3<font color="#000080">+</font>EA4<font color="#000080">+</font>EA4<font color="#000080">+</font>EA4<font color="#000080">+</font>EA4<font color="#000080">+</font>EA5<font color="#000080">+</font>EE5<font color="#000080">+</font>EE5<font color="#000080">+</font>EE5<font color="#000080">+</font>EE6<font color="#000080">+</font>EE6<font color="#000080">+</font>EE6
<font color="#000080">+</font>UE6<font color="#000080">+</font>UI7<font color="#000080">+</font>UI7<font color="#000080">+</font>UI7<font color="#000080">+</font>UI8<font color="#000080">+</font>UI8<font color="#000080">+</font>UM8<font color="#000080">+</font>UM8<font color="#000080">+</font>UM9<font color="#000080">+</font>UM9<font color="#000080">+</font>UM9<font color="#000080">+</font>UM9<font color="#000080">+</font>kMA<font color="#000080">+</font>kQA<font color="#000080">+</font>kQA<font color="#000080">+</font>kQA<font color="#000080">+</font>kQB<font color="#000080">+</font>kQB
<font color="#000080">+</font>kQB<font color="#000080">+</font>kUC<font color="#000080">+</font>kUC<font color="#000080">+</font>kUC<font color="#000080">+</font>kUC<font color="#000080">+</font>kUD<font color="#000080">-+</font>UD<font color="#000080">-+</font>YD<font color="#000080">-+</font>YD<font color="#000080">-+</font>YE<font color="#000080">-+</font>YE<font color="#000080">-+</font>YE<font color="#000080">-+</font>YF<font color="#000080">-+</font>cF<font color="#000080">-+</font>cF<font color="#000080">-+</font>cF<font color="#000080">-+</font>cG<font color="#000080">-+</font>cG
<font color="#000080">-+</font>cG<font color="#000080">-</font>EcG<font color="#000080">-</font>EgH<font color="#000080">-</font>EgH<font color="#000080">-</font>EgH<font color="#000080">-</font>EgH<font color="#000080">-</font>EgI<font color="#000080">-</font>EgI<font color="#000080">-</font>EgI<font color="#000080">-</font>EkJ<font color="#000080">-</font>EkJ<font color="#000080">-</font>EkJ<font color="#000080">-</font>EkJ<font color="#000080">-</font>UkK<font color="#000080">-</font>UoK<font color="#000080">-</font>UoK<font color="#000080">-</font>UoK<font color="#000080">-</font>UoL
<font color="#000080">-</font>UoL<font color="#000080">-</font>UoL<font color="#000080">-</font>UoL<font color="#000080">-</font>UsM<font color="#000080">-</font>UsM<font color="#000080">-</font>UsM<font color="#000080">-</font>UsN<font color="#000080">-</font>ksN<font color="#000080">-</font>ksN<font color="#000080">-</font>kwN<font color="#000080">-</font>kwO<font color="#000080">-</font>kwO<font color="#000080">-</font>kwO<font color="#000080">-</font>kwO<font color="#000080">-</font>kwP<font color="#000080">-</font>l<font color="#000080">+</font>P<font color="#000080">-</font>l<font color="#000080">+</font>P<font color="#000080">-</font>l<font color="#000080">+</font>P
<font color="#000080">-</font>l<font color="#000080">+</font>Q<font color="#000080">-</font>l<font color="#000080">+</font>Q0<font color="#000080">-+</font>Q0<font color="#000080">-</font><font color="#800000">2</font>R0<font color="#000080">-</font><font color="#800000">2</font>R0<font color="#000080">-</font><font color="#800000">2</font>R0<font color="#000080">-</font><font color="#800000">2</font>R0<font color="#000080">-</font><font color="#800000">2</font>S0<font color="#000080">-</font><font color="#800000">2</font>S0<font color="#000080">-</font><font color="#800000">2</font>S0<font color="#000080">-</font><font color="#800000">6</font>S0<font color="#000080">-</font><font color="#800000">6</font>T0<font color="#000080">-</font><font color="#800000">6</font>T0<font color="#000080">-</font><font color="#800000">6</font>T0<font color="#000080">-</font><font color="#800000">6</font>T0F6U0FAU0FAU
<font color="#800000">0</font>FAV0FAV0FAV0FAV0FEW0FEW0FEW0FEW0FEX0VEX0VEX0VIX0VIY0VIY0VIY0VIZ0VMZ0VMZ
<font color="#800000">0</font>VMZ0VMa0VMa0lMa0lMa0lQb0lQb0lQb0lQb0lQc0lQc0lUc0lUd0lUd0lUd0lUd1<font color="#000080">-</font>Ue1<font color="#000080">-</font>Ye
<font color="#800000">1</font><font color="#000080">-</font>Ye1<font color="#000080">-</font>Ye1<font color="#000080">-</font>Yf1<font color="#000080">-</font>Yf1<font color="#000080">-</font>Yf1<font color="#000080">-</font>Yf1<font color="#000080">-</font>cg1<font color="#000080">-</font>cg1<font color="#000080">-</font>cg1<font color="#000080">-</font>ch1Fch1Fch1Fgh1Fgi1Fgj1Fkj1Fkj1Foj
<font color="#800000">1</font>Foj1Fsk1Fsk1Fsk1Vwk1Vwk1W<font color="#000080">+</font>l1W<font color="#000080">+</font>l1W<font color="#000080">+</font>l1W2l1W2l1W6m1W6m1WAm1mAm1mAm1mEn1mEn
<font color="#800000">1</font>mIn1mIn1mMn1mMn1mMo1mQo20Qo20Uo20Uo20Yp20Yp20Yp20Yp20cq20cq20cq20cq20cr
<font color="#800000">20</font>gr20gr20gr20gs2Ggs2Gks2Gks2Gkt2Gkt2Gkt2Got2Gou2Gou2Gou2Gou2Gsv2Gsv2Wsv
<font color="#800000">2</font>Wsw2Www2Www2Www2Wwx2Wwx2X<font color="#000080">+</font>x2X<font color="#000080">+</font>x2X<font color="#000080">+</font>y2X<font color="#000080">+</font>y2X<font color="#000080">+</font>y2n2y2n2z3n6z51Ez6HIz7XQz8nUz
A1czBHgzCXozDnwz
<font color="#000080">***** </font><font color="#FF0000"><b>END OF </b></font>BLOCK <font color="#800000">1 </font><font color="#000080">*****

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0242.PAS">Original</a><b>]</b></p></body>
</html>
