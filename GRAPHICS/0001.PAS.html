<html>
<head><title> "DOTSPIN.PAS" by SEAN PALMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>program </b></font>dotspin<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>inPort1<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>waitRetrace<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">mov dx,inPort1; </font><font color="#008000"><i>{find crt status reg (input port #1)}
</i></font><font color="#FF00FF">@L1: in al,dx; test al,8; jnz @L1;  </font><font color="#008000"><i>{wait for no v retrace}
</i></font><font color="#FF00FF">@L2: in al,dx; test al,8; jz @L2; </font><font color="#008000"><i>{wait for v retrace}
 </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const
 </b></font>tableWriteIndex<font color="#000080">=</font><font color="#800000">$3C8</font><font color="#000080">;
 </font>tableDataRegister<font color="#000080">=</font><font color="#800000">$3C9</font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setColor<font color="#000080">(</font>color<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;</font><font color="#FF0000"><b>asm </b></font><font color="#008000"><i>{set DAC color}
 </i></font><font color="#FF00FF">mov dx,tableWriteIndex; mov al,color; out dx,al; inc dx;
 mov al,r; out dx,al; mov al,g; out dx,al; mov al,b;out dx,al;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{write index now points to next color}

{plot a pixel in mode $13}
</i></font><font color="#FF0000"><b>procedure </b></font>plot<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">);</font><font color="#FF0000"><b>Inline</b></font><font color="#000080">(
  </font><font color="#800000">$5E</font><font color="#000080">/                   </font><font color="#008000"><i>{ pop si  ;y}
  </i></font><font color="#800000">$5F</font><font color="#000080">/                   </font><font color="#008000"><i>{ pop di  ;x}
  </i></font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$A0</font><font color="#000080">/           </font><font color="#008000"><i>{ mov ax,$A000}
  </i></font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$C0</font><font color="#000080">/               </font><font color="#008000"><i>{ mov es,ax}
  </i></font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$40</font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/           </font><font color="#008000"><i>{ mov ax,320}
  </i></font><font color="#800000">$F7</font><font color="#000080">/</font><font color="#800000">$E6</font><font color="#000080">/               </font><font color="#008000"><i>{ mul si}
  </i></font><font color="#800000">$01</font><font color="#000080">/</font><font color="#800000">$C7</font><font color="#000080">/               </font><font color="#008000"><i>{ add di,ax}
  </i></font><font color="#800000">$26</font><font color="#000080">/</font><font color="#800000">$F6</font><font color="#000080">/</font><font color="#800000">$15</font><font color="#000080">);          </font><font color="#008000"><i>{es: not byte[di]}

</i></font><font color="#FF0000"><b>procedure </b></font>plot4<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">);</font><font color="#FF0000"><b>const </b></font>f<font color="#000080">=</font><font color="#800000">60</font><font color="#000080">;</font><font color="#FF0000"><b>begin
 </b></font>plot<font color="#000080">(</font>x<font color="#000080">+</font>f<font color="#000080">,</font>y<font color="#000080">);
 </font>plot<font color="#000080">(</font><font color="#800000">199</font><font color="#000080">+</font>f<font color="#000080">-</font>x<font color="#000080">,</font><font color="#800000">199</font><font color="#000080">-</font>y<font color="#000080">);
 </font>plot<font color="#000080">(</font><font color="#800000">199</font><font color="#000080">+</font>f<font color="#000080">-</font>y<font color="#000080">,</font>x<font color="#000080">);
 </font>plot<font color="#000080">(</font>y<font color="#000080">+</font>f<font color="#000080">,</font><font color="#800000">199</font><font color="#000080">-</font>x<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>click<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">in al,$61; xor al,2; out $61,al;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const </b></font>nDots<font color="#000080">=</font><font color="#800000">21</font><font color="#000080">;

</font><font color="#FF0000"><b>var
 </b></font>dot<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nDots<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]</font><font color="#FF0000"><b>of record
  </b></font>x<font color="#000080">,</font>y<font color="#000080">,</font>sx<font color="#000080">,</font>sy<font color="#000080">:</font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>colorFn<font color="#000080">(</font>x<font color="#000080">:</font>integer<font color="#000080">):</font>byte<font color="#000080">;</font><font color="#FF0000"><b>begin
 </b></font>colorFn<font color="#000080">:=</font><font color="#800000">63</font><font color="#000080">-(</font>abs<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">-</font>x<font color="#000080">)</font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>moveDots<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>word<font color="#000080">;</font><font color="#FF0000"><b>begin
 for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>nDots<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do with </b></font>dot<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do begin
  </b></font>plot4<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
  </font>inc<font color="#000080">(</font>x<font color="#000080">,</font>sx<font color="#000080">);</font>inc<font color="#000080">(</font>y<font color="#000080">,</font>sy<font color="#000080">);
  </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>word<font color="#000080">(</font>x<font color="#000080">)&gt;</font><font color="#800000">200</font><font color="#000080">)</font><font color="#FF0000"><b>then begin
   </b></font>sx<font color="#000080">:=-</font>sx<font color="#000080">;</font>inc<font color="#000080">(</font>x<font color="#000080">,</font>sx<font color="#000080">);</font>click<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>word<font color="#000080">(</font>y<font color="#000080">)&gt;</font><font color="#800000">199</font><font color="#000080">)</font><font color="#FF0000"><b>then begin
   </b></font>sy<font color="#000080">:=-</font>sy<font color="#000080">;</font>inc<font color="#000080">(</font>y<font color="#000080">,</font>sy<font color="#000080">);</font>click<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>plot4<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>waitRetrace<font color="#000080">;</font>waitRetrace<font color="#000080">;</font>waitRetrace<font color="#000080">;</font><font color="#008000"><i>{waitRetrace;}
 </i></font>setcolor<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">,</font>colorFn<font color="#000080">(</font>dot<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">].</font>x<font color="#000080">),</font>colorFn<font color="#000080">(</font>dot<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">].</font>x<font color="#000080">),</font>colorFn<font color="#000080">(</font>dot<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">].</font>x<font color="#000080">));
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>drawdots<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>word<font color="#000080">;</font><font color="#FF0000"><b>begin
 for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>nDots<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do with </b></font>dot<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do </b></font>plot4<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>initDots<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">:</font>word<font color="#000080">;</font><font color="#FF0000"><b>begin
 </b></font>j<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;</font>k<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>nDots<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do with </b></font>dot<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do begin
  </b></font>x<font color="#000080">:=</font><font color="#800000">100</font><font color="#000080">;</font>y<font color="#000080">:=</font><font color="#800000">99</font><font color="#000080">;
  </font>sx<font color="#000080">:=</font>j<font color="#000080">;</font>sy<font color="#000080">:=</font>k<font color="#000080">;
  </font>inc<font color="#000080">(</font>j<font color="#000080">);</font><font color="#FF0000"><b>if </b></font>j<font color="#000080">&gt;=</font>k <font color="#FF0000"><b>then begin </b></font>j<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;</font>inc<font color="#000080">(</font>k<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>readKey<font color="#000080">:</font>char<font color="#000080">;</font><font color="#FF0000"><b>Inline</b></font><font color="#000080">(
  </font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$07</font><font color="#000080">/               </font><font color="#008000"><i>{mov ah,7}
  </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$21</font><font color="#000080">);              </font><font color="#008000"><i>{int $21}

</i></font><font color="#FF0000"><b>function </b></font>keyPressed<font color="#000080">:</font>boolean<font color="#000080">;</font><font color="#FF0000"><b>Inline</b></font><font color="#000080">(
  </font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$0B</font><font color="#000080">/               </font><font color="#008000"><i>{mov ah,$B}
  </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$21</font><font color="#000080">/               </font><font color="#008000"><i>{int $21}
  </i></font><font color="#800000">$24</font><font color="#000080">/</font><font color="#800000">$FE</font><font color="#000080">);              </font><font color="#008000"><i>{and al,$FE}

</i></font><font color="#FF0000"><b>begin
 </b></font>inPort1<font color="#000080">:=</font>memw<font color="#000080">[</font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$63</font><font color="#000080">]+</font><font color="#800000">6</font><font color="#000080">;
 </font>port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">]:=</font>port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">]</font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font><font color="#800000">1</font><font color="#000080">);
 </font>setcolor<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">);
 </font>initDots<font color="#000080">;
 </font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">mov ax,$13; int $10; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>drawDots<font color="#000080">;
 </font><font color="#FF0000"><b>repeat </b></font>moveDots <font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
 </font>readkey<font color="#000080">;
 </font>drawDots<font color="#000080">;
 </font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">mov ax,3; int $10; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">.


 * </font>OLX <font color="#800000">2.2 </font><font color="#000080">* </font>Printers <font color="#FF0000"><b>do </b></font>it without wrinkling the sheets<font color="#000080">.

--- </font>Maximus <font color="#800000">2.01</font>wb
 <font color="#000080">* </font>Origin<font color="#000080">: &gt;&gt;&gt; </font>Sun Mountain BBS <font color="#000080">&lt;&lt;&lt; (</font><font color="#800000">303</font><font color="#000080">)-</font><font color="#800000">665</font><font color="#000080">-</font><font color="#800000">6922 </font><font color="#000080">(</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">104</font><font color="#000080">/</font><font color="#800000">123</font><font color="#000080">)
</font>                                                                                                 
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p></body>
</html>
