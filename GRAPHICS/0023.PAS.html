<html>
<head><title> "Another Graphic Rotate" by SEAN PALMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0023.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
SEAN PALMER

&gt; I've been trying For some time to get a Pascal Procedure that can
&gt; SCALE and/or ROTATE Graphic images. if anyone has any idea how to do this,
&gt; or has a source code, PLEEEAASSEE drop me a line.. THANK YOU!

This is an out-and-out blatant hack of the routines from Abrash's
XSHARP21. They are too slow to be usable as implemented here.
}

{$A-,B-,D+,E-,F-,G+,I-,L+,N-,O-,R-,S-,V-,X+}
{$M $2000,0,0}
</i></font><font color="#FF0000"><b>Program </b></font>VectTest<font color="#000080">;
</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">, </font>b320x200<font color="#000080">; </font><font color="#008000"><i>{&lt;-this Unit just implements Plot(x, y) and Color : Byte; }

</i></font><font color="#FF0000"><b>Const
  </b></font>ClipMinY <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>ClipMaxY <font color="#000080">= </font><font color="#800000">199</font><font color="#000080">;
  </font>ClipMinX <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>ClipMaxX <font color="#000080">= </font><font color="#800000">319</font><font color="#000080">;
  </font>VertMax  <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>fixed <font color="#000080">= </font><font color="#FF0000"><b>Record
    Case </b></font>Byte <font color="#FF0000"><b>of
      </b></font><font color="#800000">0 </font><font color="#000080">: (</font>f <font color="#000080">: </font>Byte<font color="#000080">; </font>si <font color="#000080">: </font>shortint<font color="#000080">);
      </font><font color="#800000">1 </font><font color="#000080">: (</font>f2<font color="#000080">, </font>b <font color="#000080">: </font>Byte<font color="#000080">);
      </font><font color="#800000">2 </font><font color="#000080">: (</font>w <font color="#000080">: </font>Word<font color="#000080">);
      </font><font color="#800000">3 </font><font color="#000080">: (</font>i <font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>ByteArray <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">63999</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

  </font>VertRec   <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>X<font color="#000080">, </font>Y <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>VertArr   <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>VertMax<font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>VertRec<font color="#000080">;
  </font>EdgeScan  <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>scansLeft   <font color="#000080">: </font>Integer<font color="#000080">;
    </font>Currentend  <font color="#000080">: </font>Integer<font color="#000080">;
    </font>srcX<font color="#000080">, </font>srcY  <font color="#000080">: </font>fixed<font color="#000080">;
    </font>srcStepX<font color="#000080">,
    </font>srcStepY    <font color="#000080">: </font>fixed<font color="#000080">;
    </font>dstX        <font color="#000080">: </font>Integer<font color="#000080">;
    </font>dstXIntStep <font color="#000080">: </font>Integer<font color="#000080">;
    </font>dstXdir     <font color="#000080">: </font>Integer<font color="#000080">;
    </font>dstXErrTerm <font color="#000080">: </font>Integer<font color="#000080">;
    </font>dstXAdjUp   <font color="#000080">: </font>Integer<font color="#000080">;
    </font>dstXAdjDown <font color="#000080">: </font>Integer<font color="#000080">;
    </font>dir         <font color="#000080">: </font>shortInt<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>numVerts <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
  </font>mapX     <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
  </font>mapY     <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;

  </font>Vertex <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>vertMax<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>vertRec <font color="#000080">=
    ((</font>x <font color="#000080">: </font><font color="#800000">040</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">020</font><font color="#000080">),
     (</font>x <font color="#000080">: </font><font color="#800000">160</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">050</font><font color="#000080">),
     (</font>x <font color="#000080">: </font><font color="#800000">160</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">149</font><font color="#000080">),
     (</font>x <font color="#000080">: </font><font color="#800000">040</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">179</font><font color="#000080">));

  </font>Points <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>vertMax<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>vertRec <font color="#000080">=
    ((</font>x <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">),
     (</font>x <font color="#000080">: </font>mapX<font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">),
     (</font>x <font color="#000080">: </font>mapX<font color="#000080">; </font>y <font color="#000080">: </font>mapY<font color="#000080">),
     (</font>x <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">: </font>mapY<font color="#000080">));

  </font>texMap <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>mapY<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">..</font>mapX<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#000080">=
    ((</font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">),
     (</font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">),
     (</font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">),
     (</font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">),
     (</font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$9</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">),
     (</font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">),
     (</font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$7</font><font color="#000080">, </font><font color="#800000">$F</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">),
     (</font><font color="#800000">$0</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">, </font><font color="#800000">$0</font><font color="#000080">));

</font><font color="#FF0000"><b>Var
  </b></font>lfEdge<font color="#000080">,
  </font>rtEdge <font color="#000080">: </font>EdgeScan<font color="#000080">;
  </font>z<font color="#000080">, </font>z2  <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>fixedDiv<font color="#000080">(</font>d1<font color="#000080">, </font>d2 <font color="#000080">: </font>LongInt<font color="#000080">) : </font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">db  $66; xor dx, dx
  mov cx, Word ptr D1+2
  or  cx, cx
  jns @S
  db  $66; dec dx
 @S:
  mov dx, cx
  mov ax, Word ptr D1
  db  $66; shl ax, 16
  db  $66; idiv Word ptr d2
  db  $66; mov dx, ax
  db  $66; shr dx, 16
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>div2Fixed<font color="#000080">(</font>d1<font color="#000080">, </font>d2 <font color="#000080">: </font>LongInt<font color="#000080">) : </font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">db $66; xor dx, dx
  db $66; mov ax, Word ptr d1
  db $66; shl ax, 16
  jns @S
  db $66; dec dx
 @S:
  db $66; idiv Word ptr d2
  db $66; mov dx, ax
  db $66; shr dx, 16
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>divfix<font color="#000080">(</font>d1<font color="#000080">, </font>d2 <font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">mov  al, Byte ptr d1+1
  cbw
  mov  dx, ax
  xor  al, al
  mov  ah, Byte ptr d1
  idiv d2
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Draw<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>MinY<font color="#000080">,
  </font>MaxY<font color="#000080">,
  </font>MinVert<font color="#000080">,
  </font>MaxVert<font color="#000080">,
  </font>I<font color="#000080">, </font>dstY  <font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>SetUpEdge<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Edge <font color="#000080">: </font>EdgeScan<font color="#000080">; </font>StartVert <font color="#000080">: </font>Integer<font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>NextVert   <font color="#000080">: </font>shortint<font color="#000080">;
    </font>dstXWidth  <font color="#000080">: </font>Integer<font color="#000080">;
    </font>T<font color="#000080">,
    </font>dstYHeight <font color="#000080">: </font>fixed<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>SetUpEdge <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>StartVert <font color="#000080">&lt;&gt; </font>MaxVert<font color="#000080">) </font><font color="#FF0000"><b>Do
    begin
      </b></font>NextVert <font color="#000080">:= </font>StartVert <font color="#000080">+ </font>Edge<font color="#000080">.</font>dir<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>NextVert <font color="#000080">&gt;= </font>NumVerts<font color="#000080">) </font><font color="#FF0000"><b>Then
        </b></font>NextVert <font color="#000080">:= </font><font color="#800000">0
      </font><font color="#FF0000"><b>else
      if </b></font><font color="#000080">(</font>NextVert <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        </b></font>NextVert <font color="#000080">:= </font>pred<font color="#000080">(</font>NumVerts<font color="#000080">);

      </font><font color="#FF0000"><b>With </b></font>Edge <font color="#FF0000"><b>Do
      begin
       </b></font>scansLeft <font color="#000080">:= </font>vertex<font color="#000080">[</font>NextVert<font color="#000080">].</font>Y <font color="#000080">- </font>vertex<font color="#000080">[</font>StartVert<font color="#000080">].</font>Y<font color="#000080">;
       </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>scansLeft <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
       begin
         </b></font>dstYHeight<font color="#000080">.</font>f  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
         </font>dstYHeight<font color="#000080">.</font>si <font color="#000080">:= </font>scansLeft<font color="#000080">;
         </font>Currentend    <font color="#000080">:= </font>NextVert<font color="#000080">;
         </font>srcX<font color="#000080">.</font>f  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
         </font>srcX<font color="#000080">.</font>si <font color="#000080">:= </font>Points<font color="#000080">[</font>StartVert<font color="#000080">].</font>X<font color="#000080">;
         </font>srcY<font color="#000080">.</font>f  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
         </font>srcY<font color="#000080">.</font>si <font color="#000080">:= </font>Points<font color="#000080">[</font>StartVert<font color="#000080">].</font>Y<font color="#000080">;
         </font>srcStepX<font color="#000080">.</font>i <font color="#000080">:= </font>divFix<font color="#000080">(</font>points<font color="#000080">[</font>nextVert<font color="#000080">].</font>x <font color="#000080">- </font>srcX<font color="#000080">.</font>si<font color="#000080">, </font>scansLeft<font color="#000080">);
         </font>srcStepY<font color="#000080">.</font>i <font color="#000080">:= </font>divFix<font color="#000080">(</font>points<font color="#000080">[</font>nextVert<font color="#000080">].</font>y <font color="#000080">- </font>srcY<font color="#000080">.</font>si<font color="#000080">, </font>scansLeft<font color="#000080">);
         </font>dstX       <font color="#000080">:= </font>vertex<font color="#000080">[</font>StartVert<font color="#000080">].</font>X<font color="#000080">;
         </font>dstXWidth  <font color="#000080">:= </font>vertex<font color="#000080">[</font>NextVert<font color="#000080">].</font>X<font color="#000080">-</font>vertex<font color="#000080">[</font>StartVert<font color="#000080">].</font>X<font color="#000080">;

         </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>dstXWidth <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
         begin
           </b></font>dstXdir     <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
           </font>dstXWidth   <font color="#000080">:= -</font>dstXWidth<font color="#000080">;
           </font>dstXErrTerm <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">- </font>scansLeft<font color="#000080">;
           </font>dstXIntStep <font color="#000080">:= -(</font>dstXWidth <font color="#FF0000"><b>Div </b></font>scansLeft<font color="#000080">);
         </font><font color="#FF0000"><b>end
         else
         begin
           </b></font>dstXdir     <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
           </font>dstXErrTerm <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
           </font>dstXIntStep <font color="#000080">:= </font>dstXWidth <font color="#FF0000"><b>Div </b></font>scansLeft<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font>dstXAdjUp   <font color="#000080">:= </font>dstXWidth <font color="#FF0000"><b>Mod </b></font>scansLeft<font color="#000080">;
         </font>dstXAdjDown <font color="#000080">:= </font>scansLeft<font color="#000080">;
         </font>Exit<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>StartVert <font color="#000080">:= </font>NextVert<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>SetUpEdge <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>StepEdge<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Edge <font color="#000080">: </font>EdgeScan<font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Dec<font color="#000080">(</font>Edge<font color="#000080">.</font>scansLeft<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Edge<font color="#000080">.</font>scansLeft <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
    begin
      </b></font>StepEdge <font color="#000080">:= </font>SetUpEdge<font color="#000080">(</font>Edge<font color="#000080">, </font>Edge<font color="#000080">.</font>Currentend<font color="#000080">);
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>With </b></font>Edge <font color="#FF0000"><b>Do
    begin
      </b></font>Inc<font color="#000080">(</font>srcX<font color="#000080">.</font>i<font color="#000080">, </font>srcStepX<font color="#000080">.</font>i<font color="#000080">);
      </font>Inc<font color="#000080">(</font>srcY<font color="#000080">.</font>i<font color="#000080">, </font>srcStepY<font color="#000080">.</font>i<font color="#000080">);
      </font>Inc<font color="#000080">(</font>dstX<font color="#000080">, </font>dstXIntStep<font color="#000080">);
      </font>Inc<font color="#000080">(</font>dstXErrTerm<font color="#000080">, </font>dstXAdjUp<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>dstXErrTerm <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      begin
        </b></font>Inc<font color="#000080">(</font>dstX<font color="#000080">, </font>dstXdir<font color="#000080">);
        </font>Dec<font color="#000080">(</font>dstXErrTerm<font color="#000080">, </font>dstXAdjDown<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>StepEdge <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>ScanOutLine<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>srcX<font color="#000080">,
    </font>srcY     <font color="#000080">: </font>fixed<font color="#000080">;
    </font>dstX<font color="#000080">,
    </font>dstXMax  <font color="#000080">: </font>Integer<font color="#000080">;
    </font>dstWidth<font color="#000080">,
    </font>srcXStep<font color="#000080">,
    </font>srcYStep <font color="#000080">: </font>fixed<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>srcX<font color="#000080">.</font>w  <font color="#000080">:= </font>lfEdge<font color="#000080">.</font>srcX<font color="#000080">.</font>w<font color="#000080">;
    </font>srcY<font color="#000080">.</font>w  <font color="#000080">:= </font>lfEdge<font color="#000080">.</font>srcY<font color="#000080">.</font>w<font color="#000080">;
    </font>dstX    <font color="#000080">:= </font>lfEdge<font color="#000080">.</font>dstX<font color="#000080">;
    </font>dstXMax <font color="#000080">:= </font>rtEdge<font color="#000080">.</font>dstX<font color="#000080">;

    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>dstXMax <font color="#000080">&lt;= </font>ClipMinX<font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>dstX <font color="#000080">&gt;= </font>ClipMaxX<font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Exit<font color="#000080">;
    </font>dstWidth<font color="#000080">.</font>f  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>dstWidth<font color="#000080">.</font>si <font color="#000080">:= </font>dstXMax <font color="#000080">- </font>dstX<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>dstWidth<font color="#000080">.</font>i <font color="#000080">&lt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Exit<font color="#000080">;
    </font>srcXStep<font color="#000080">.</font>i <font color="#000080">:= </font>divFix<font color="#000080">(</font>rtEdge<font color="#000080">.</font>srcX<font color="#000080">.</font>i <font color="#000080">- </font>srcX<font color="#000080">.</font>i<font color="#000080">, </font>dstWidth<font color="#000080">.</font>i<font color="#000080">);
    </font>srcYStep<font color="#000080">.</font>i <font color="#000080">:= </font>divFix<font color="#000080">(</font>rtEdge<font color="#000080">.</font>srcY<font color="#000080">.</font>i <font color="#000080">- </font>srcY<font color="#000080">.</font>i<font color="#000080">, </font>dstWidth<font color="#000080">.</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>dstXMax <font color="#000080">&gt; </font>ClipMaxX<font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>dstXMax <font color="#000080">:= </font>ClipMaxX<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>dstX <font color="#000080">&lt; </font>ClipMinX<font color="#000080">) </font><font color="#FF0000"><b>Then
    begin
      </b></font>Inc<font color="#000080">(</font>srcX<font color="#000080">.</font>i<font color="#000080">, </font>srcXStep<font color="#000080">.</font>i <font color="#000080">* (</font>ClipMinX <font color="#000080">- </font>dstX<font color="#000080">));
      </font>Inc<font color="#000080">(</font>srcY<font color="#000080">.</font>i<font color="#000080">, </font>srcYStep<font color="#000080">.</font>i <font color="#000080">* (</font>ClipMinX <font color="#000080">- </font>dstX<font color="#000080">));
      </font>dstX <font color="#000080">:= </font>ClipMinX<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Asm
     </b></font><font color="#FF00FF">mov  ax, $A000
     mov  es, ax
     mov  ax, xRes
     mul  dstY
     add  ax, dstX
     mov  di, ax
     mov  cx, dstXMax
     sub  cx, dstX
     mov  bx, srcXStep.i
     mov  dx, srcYStep.i
    @L:
     mov  al, srcY.&amp;si
     xor  ah, ah
     shl  ax, 3
     add  al, srcX.&amp;si
     add  ax, offset texmap
     mov  si, ax
     movsb
     add  srcX.i,bx
     add  srcY.i,dx
     loop @L
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>NumVerts <font color="#000080">&lt; </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>Then
    </b></font>Exit<font color="#000080">;
  </font>MinY <font color="#000080">:= </font>vertex<font color="#000080">[</font>numVerts <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">].</font>y<font color="#000080">;
  </font>maxY <font color="#000080">:= </font>vertex<font color="#000080">[</font>numVerts <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">].</font>y<font color="#000080">;
  </font>maxVert <font color="#000080">:= </font>numVerts <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
  </font>minVert <font color="#000080">:= </font>numVerts <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font>numVerts <font color="#000080">- </font><font color="#800000">2 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>Do
  begin
    if </b></font><font color="#000080">(</font>vertex<font color="#000080">[</font>I<font color="#000080">].</font>Y <font color="#000080">&lt; </font>MinY<font color="#000080">) </font><font color="#FF0000"><b>Then
    begin
      </b></font>MinY    <font color="#000080">:= </font>vertex<font color="#000080">[</font>I<font color="#000080">].</font>Y<font color="#000080">;
      </font>MinVert <font color="#000080">:= </font>I<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>vertex<font color="#000080">[</font>I<font color="#000080">].</font>Y <font color="#000080">&gt; </font>MaxY<font color="#000080">) </font><font color="#FF0000"><b>Then
    begin
      </b></font>MaxY    <font color="#000080">:= </font>vertex<font color="#000080">[</font>I<font color="#000080">].</font>Y<font color="#000080">;
      </font>MaxVert <font color="#000080">:= </font>I<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>MinY <font color="#000080">&gt;= </font>MaxY<font color="#000080">) </font><font color="#FF0000"><b>Then
    </b></font>Exit<font color="#000080">;
  </font>dstY <font color="#000080">:= </font>MinY<font color="#000080">;
  </font>lfEdge<font color="#000080">.</font>dir <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
  </font>SetUpEdge<font color="#000080">(</font>lfEdge<font color="#000080">, </font>MinVert<font color="#000080">);
  </font>rtEdge<font color="#000080">.</font>dir <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>SetUpEdge<font color="#000080">(</font>rtEdge<font color="#000080">, </font>MinVert<font color="#000080">);
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>dstY <font color="#000080">&lt; </font>ClipMaxY<font color="#000080">) </font><font color="#FF0000"><b>Do
  begin
    if </b></font><font color="#000080">(</font>dstY <font color="#000080">&gt;= </font>ClipMinY<font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>ScanOutLine<font color="#000080">;
    </font><font color="#FF0000"><b>if Not </b></font>StepEdge<font color="#000080">(</font>lfEdge<font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>if Not </b></font>StepEdge<font color="#000080">(</font>rtEdge<font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Exit<font color="#000080">;
    </font>Inc<font color="#000080">(</font>dstY<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>directVideo <font color="#000080">:= </font>False<font color="#000080">;
  </font>TextAttr    <font color="#000080">:= </font><font color="#800000">63</font><font color="#000080">;
  </font><font color="#008000"><i>{ For z:=0 to mapY do For z2:=0 to mapx do texMap[z,z2]:=random(6+53);}
  </i></font><font color="#FF0000"><b>For </b></font>z <font color="#000080">:= </font><font color="#800000">4 </font><font color="#FF0000"><b>to </b></font><font color="#800000">38 </font><font color="#FF0000"><b>do
  begin
    </b></font>clearGraph<font color="#000080">;
    </font>vertex<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">].</font>x <font color="#000080">:= </font>z <font color="#000080">* </font><font color="#800000">4</font><font color="#000080">;
    </font>vertex<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">].</font>x <font color="#000080">:= </font>z <font color="#000080">* </font><font color="#800000">4</font><font color="#000080">;
    </font>draw<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>KeyPressed <font color="#FF0000"><b>then
    begin
      </b></font>ReadKey<font color="#000080">;
      </font>ReadKey<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>readln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0023.PAS">Original</a><b>]</b></p></body>
</html>
