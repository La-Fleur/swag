<html>
<head><title> "3D stereogram maker" by BOSTJAN GABROVSEK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0281.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{If you have any questions please send me mail at OleRom@hotmail.com}
{Example for 3d stereogram}
</i></font><font color="#FF0000"><b>Program </b></font>Stereogram<font color="#000080">;
</font><font color="#FF0000"><b>Uses </b></font>Graph<font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>Screen <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>Type </b></font>Coord <font color="#000080">= (</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Z<font color="#000080">);
     </font>Direct <font color="#000080">= (</font>Up<font color="#000080">, </font>Down<font color="#000080">, </font>Right<font color="#000080">, </font>Left<font color="#000080">);
     </font>Angle <font color="#000080">= (</font>Mini<font color="#000080">, </font>Maxi<font color="#000080">);
     </font>EndPoint <font color="#000080">= </font><font color="#FF0000"><b>Set of </b></font>Direct<font color="#000080">;
     </font>SType <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font>x<font color="#000080">..</font>z<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Real<font color="#000080">;
     </font>PSType <font color="#000080">= ^</font>SType<font color="#000080">;
     </font>PType <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font>x<font color="#000080">..</font>y<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Real<font color="#000080">;
     </font>PPType <font color="#000080">= ^</font>PSType<font color="#000080">;
     </font>Implicit <font color="#000080">= </font><font color="#FF0000"><b>Function</b></font><font color="#000080">(</font>S <font color="#000080">: </font>sType<font color="#000080">): </font>Real<font color="#000080">;
     </font>ParamSurface <font color="#000080">= </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>U<font color="#000080">, </font>V <font color="#000080">: </font>Real<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>S <font color="#000080">: </font>SType<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>RayTrace<font color="#000080">(</font>s0<font color="#000080">: </font>sType<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>s1<font color="#000080">: </font>sType<font color="#000080">; </font>g <font color="#000080">: </font>implicit<font color="#000080">); </font><font color="#FF0000"><b>forward</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ProjectPoint<font color="#000080">(</font>s0 <font color="#000080">: </font>sType<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>s1 <font color="#000080">: </font>Stype<font color="#000080">); </font><font color="#FF0000"><b>forward</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>MoveTo<font color="#000080">(</font>S <font color="#000080">: </font>SType<font color="#000080">); </font><font color="#FF0000"><b>forward</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>LineTo<font color="#000080">(</font>S <font color="#000080">: </font>sType<font color="#000080">; </font>g <font color="#000080">: </font>implicit<font color="#000080">); </font><font color="#FF0000"><b>forward</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Line<font color="#000080">(</font>s1<font color="#000080">, </font>s2 <font color="#000080">: </font>sType<font color="#000080">; </font>g <font color="#000080">: </font>implicit<font color="#000080">); </font><font color="#FF0000"><b>forward</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Point<font color="#000080">(</font>s <font color="#000080">: </font>SType<font color="#000080">; </font>Ch <font color="#000080">: </font>Char<font color="#000080">; </font>g <font color="#000080">: </font>implicit<font color="#000080">); </font><font color="#FF0000"><b>forward</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetEyes<font color="#000080">(</font>d<font color="#000080">, </font>v<font color="#000080">, </font>h <font color="#000080">: </font>real<font color="#000080">); </font><font color="#FF0000"><b>forward</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>PlotSurface<font color="#000080">(</font>f1 <font color="#000080">: </font>implicit<font color="#000080">; </font>f2 <font color="#000080">: </font>ParamSurface<font color="#000080">;
                      </font>u0<font color="#000080">, </font>u1 <font color="#000080">: </font>Real<font color="#000080">; </font>m <font color="#000080">: </font>integer<font color="#000080">;
                      </font>v0<font color="#000080">, </font>v1 <font color="#000080">: </font>Real<font color="#000080">; </font>n <font color="#000080">: </font>integer<font color="#000080">); </font><font color="#FF0000"><b>forward</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>RandomDotSurface<font color="#000080">(</font>N <font color="#000080">: </font>Integer<font color="#000080">; </font>Ch <font color="#000080">: </font>Char<font color="#000080">; </font>G <font color="#000080">: </font>Implicit<font color="#000080">); </font><font color="#FF0000"><b>forward</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>ClipR <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font>Mini<font color="#000080">..</font>Maxi<font color="#000080">, </font>X<font color="#000080">..</font>Y<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Real <font color="#000080">= ((</font><font color="#800000">0.05</font><font color="#000080">,</font><font color="#800000">0.05</font><font color="#000080">),(</font><font color="#800000">0.95</font><font color="#000080">,</font><font color="#800000">0.95</font><font color="#000080">));
      </font>Curr <font color="#000080">: </font>SType <font color="#000080">= (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>Eyes <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>sType<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>InSide<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>P <font color="#000080">: </font>pType<font color="#000080">) : </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>forward</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetEyes<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">][</font>x<font color="#000080">] := (</font><font color="#800000">0.5 </font><font color="#000080">- </font>d<font color="#000080">);
 </font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">][</font>y<font color="#000080">] := (</font><font color="#800000">0.5 </font><font color="#000080">- </font>v<font color="#000080">);
   </font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">][</font>z<font color="#000080">] := </font>h<font color="#000080">;
 </font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>x<font color="#000080">] := (</font><font color="#800000">0.5 </font><font color="#000080">+ </font>d<font color="#000080">);
 </font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>y<font color="#000080">] := (</font><font color="#800000">0.5 </font><font color="#000080">- </font>v<font color="#000080">);
   </font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>z<font color="#000080">] := </font>h<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>EndPoints<font color="#000080">(</font>P <font color="#000080">: </font>PType<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>E <font color="#000080">: </font>EndPoint<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 </b></font>e <font color="#000080">:= [];
 </font><font color="#FF0000"><b>If </b></font>P<font color="#000080">[</font>y<font color="#000080">] &gt; </font>ClipR<font color="#000080">[</font>maxi<font color="#000080">,</font>y<font color="#000080">] </font><font color="#FF0000"><b>then </b></font>e <font color="#000080">:= </font>e <font color="#000080">+ [</font>up<font color="#000080">];
 </font><font color="#FF0000"><b>If </b></font>P<font color="#000080">[</font>y<font color="#000080">] &lt; </font>ClipR<font color="#000080">[</font>mini<font color="#000080">,</font>y<font color="#000080">] </font><font color="#FF0000"><b>then </b></font>e <font color="#000080">:= </font>e <font color="#000080">+ [</font>down<font color="#000080">];
 </font><font color="#FF0000"><b>If </b></font>P<font color="#000080">[</font>x<font color="#000080">] &gt; </font>ClipR<font color="#000080">[</font>maxi<font color="#000080">,</font>x<font color="#000080">] </font><font color="#FF0000"><b>then </b></font>e <font color="#000080">:= </font>e <font color="#000080">+ [</font>right<font color="#000080">];
 </font><font color="#FF0000"><b>If </b></font>P<font color="#000080">[</font>x<font color="#000080">] &lt; </font>ClipR<font color="#000080">[</font>mini<font color="#000080">,</font>x<font color="#000080">] </font><font color="#FF0000"><b>then </b></font>e <font color="#000080">:= </font>e <font color="#000080">+ [</font>left<font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Clip<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>P1<font color="#000080">, </font>P2 <font color="#000080">: </font>PType<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>E1<font color="#000080">, </font>E2 <font color="#000080">: </font>EndPoint<font color="#000080">;
 </font><font color="#FF0000"><b>Procedure </b></font>MXY<font color="#000080">(</font>xy <font color="#000080">: </font>Real<font color="#000080">; </font>U <font color="#000080">: </font>coord<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>P <font color="#000080">: </font>PType<font color="#000080">);
 </font><font color="#FF0000"><b>Var </b></font>V <font color="#000080">: </font>Coord<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
   </b></font>V <font color="#000080">:= </font>Coord<font color="#000080">((</font>ord<font color="#000080">(</font>u<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">2</font><font color="#000080">);
   </font>P<font color="#000080">[</font>V<font color="#000080">] := (</font>P2<font color="#000080">[</font>v<font color="#000080">] - </font>P1<font color="#000080">[</font>v<font color="#000080">])*(</font>xy <font color="#000080">- </font>P1<font color="#000080">[</font>u<font color="#000080">])/(</font>P2<font color="#000080">[</font>u<font color="#000080">] - </font>P1<font color="#000080">[</font>u<font color="#000080">]) + </font>P1<font color="#000080">[</font>v<font color="#000080">];
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>EndPoints<font color="#000080">(</font>P1<font color="#000080">,</font>E1<font color="#000080">);
 </font>EndPoints<font color="#000080">(</font>P2<font color="#000080">,</font>E2<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>E1 <font color="#000080">+ </font>E2<font color="#000080">) = [] </font><font color="#FF0000"><b>then Begin </b></font>Clip <font color="#000080">:= </font>True<font color="#000080">; </font>exit<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>E1 <font color="#000080">* </font>E2<font color="#000080">) &lt;&gt; [] </font><font color="#FF0000"><b>then Begin </b></font>Clip <font color="#000080">:= </font>False<font color="#000080">; </font>exit<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Up <font color="#FF0000"><b>in </b></font>e1 <font color="#FF0000"><b>then Begin </b></font>mxy<font color="#000080">(</font>ClipR<font color="#000080">[</font>maxi<font color="#000080">,</font>y<font color="#000080">],</font>y<font color="#000080">,</font>p1<font color="#000080">); </font>EndPoints<font color="#000080">(</font>P1<font color="#000080">,</font>E1<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Down <font color="#FF0000"><b>in </b></font>e1 <font color="#FF0000"><b>then Begin </b></font>mxy<font color="#000080">(</font>ClipR<font color="#000080">[</font>mini<font color="#000080">,</font>y<font color="#000080">],</font>y<font color="#000080">,</font>p1<font color="#000080">); </font>EndPoints<font color="#000080">(</font>P1<font color="#000080">,</font>E1<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Right <font color="#FF0000"><b>in </b></font>e1 <font color="#FF0000"><b>then Begin </b></font>mxy<font color="#000080">(</font>ClipR<font color="#000080">[</font>maxi<font color="#000080">,</font>x<font color="#000080">],</font>x<font color="#000080">,</font>p1<font color="#000080">); </font>EndPoints<font color="#000080">(</font>P1<font color="#000080">,</font>E1<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Left <font color="#FF0000"><b>in </b></font>e1 <font color="#FF0000"><b>then Begin </b></font>mxy<font color="#000080">(</font>ClipR<font color="#000080">[</font>mini<font color="#000080">,</font>x<font color="#000080">],</font>x<font color="#000080">,</font>p1<font color="#000080">); </font>EndPoints<font color="#000080">(</font>P1<font color="#000080">,</font>E1<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Up <font color="#FF0000"><b>in </b></font>e2 <font color="#FF0000"><b>then Begin </b></font>mxy<font color="#000080">(</font>ClipR<font color="#000080">[</font>maxi<font color="#000080">,</font>y<font color="#000080">],</font>y<font color="#000080">,</font>p2<font color="#000080">); </font>EndPoints<font color="#000080">(</font>P1<font color="#000080">,</font>E2<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Down <font color="#FF0000"><b>in </b></font>e2 <font color="#FF0000"><b>then Begin </b></font>mxy<font color="#000080">(</font>ClipR<font color="#000080">[</font>mini<font color="#000080">,</font>y<font color="#000080">],</font>y<font color="#000080">,</font>p2<font color="#000080">); </font>EndPoints<font color="#000080">(</font>P1<font color="#000080">,</font>E2<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Right <font color="#FF0000"><b>in </b></font>e2 <font color="#FF0000"><b>then Begin </b></font>mxy<font color="#000080">(</font>ClipR<font color="#000080">[</font>maxi<font color="#000080">,</font>x<font color="#000080">],</font>x<font color="#000080">,</font>p2<font color="#000080">); </font>EndPoints<font color="#000080">(</font>P1<font color="#000080">,</font>E2<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Left <font color="#FF0000"><b>in </b></font>e2 <font color="#FF0000"><b>then Begin </b></font>mxy<font color="#000080">(</font>ClipR<font color="#000080">[</font>mini<font color="#000080">,</font>x<font color="#000080">],</font>x<font color="#000080">,</font>p2<font color="#000080">); </font>EndPoints<font color="#000080">(</font>P1<font color="#000080">,</font>E2<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>E1 <font color="#000080">+ </font>E2<font color="#000080">) = [] </font><font color="#FF0000"><b>then </b></font>Clip <font color="#000080">:= </font>True <font color="#FF0000"><b>else </b></font>Clip <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Inside<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>Inside <font color="#000080">:= (</font>ClipR<font color="#000080">[</font>mini<font color="#000080">,</font>x<font color="#000080">] &lt;= </font>p<font color="#000080">[</font>x<font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>p<font color="#000080">[</font>x<font color="#000080">] &lt;= </font>ClipR<font color="#000080">[</font>maxi<font color="#000080">,</font>x<font color="#000080">]) </font><font color="#FF0000"><b>and
           </b></font><font color="#000080">(</font>ClipR<font color="#000080">[</font>mini<font color="#000080">,</font>y<font color="#000080">] &lt;= </font>p<font color="#000080">[</font>y<font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>p<font color="#000080">[</font>y<font color="#000080">] &lt;= </font>ClipR<font color="#000080">[</font>maxi<font color="#000080">,</font>y<font color="#000080">]);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ProjectPoint<font color="#000080">(</font>s0 <font color="#000080">: </font>sType<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>s1 <font color="#000080">: </font>Stype<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>K <font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>K <font color="#000080">:= (</font>Screen <font color="#000080">- </font>s0<font color="#000080">[</font>z<font color="#000080">])/(</font>s1<font color="#000080">[</font>z<font color="#000080">] - </font>s0<font color="#000080">[</font>z<font color="#000080">]);
 </font>S1<font color="#000080">[</font>x<font color="#000080">] := </font>S0<font color="#000080">[</font>x<font color="#000080">] + </font>k<font color="#000080">*(</font>s1<font color="#000080">[</font>x<font color="#000080">] - </font>s0<font color="#000080">[</font>x<font color="#000080">]);
 </font>S1<font color="#000080">[</font>y<font color="#000080">] := </font>S0<font color="#000080">[</font>y<font color="#000080">] + </font>k<font color="#000080">*(</font>s1<font color="#000080">[</font>y<font color="#000080">] - </font>s0<font color="#000080">[</font>y<font color="#000080">]);
 </font>S1<font color="#000080">[</font>z<font color="#000080">] := </font>Screen<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>RayTrace<font color="#000080">(</font>s0<font color="#000080">: </font>sType<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>s1<font color="#000080">: </font>sType<font color="#000080">; </font>g <font color="#000080">: </font>implicit<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>ds <font color="#000080">: </font>SType<font color="#000080">;
    </font>F<font color="#000080">, </font>F1<font color="#000080">, </font>DF<font color="#000080">, </font>DF1<font color="#000080">, </font>T0<font color="#000080">, </font>T<font color="#000080">, </font>T1<font color="#000080">, </font>DT <font color="#000080">: </font>Real<font color="#000080">;
    </font>N <font color="#000080">: </font>Integer<font color="#000080">;
    </font>B <font color="#000080">: </font>Boolean<font color="#000080">;
    </font>I <font color="#000080">: </font>Coord<font color="#000080">;
 </font><font color="#FF0000"><b>Function </b></font>ITRF<font color="#000080">(</font>T <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
 </font><font color="#FF0000"><b>Var </b></font>I <font color="#000080">: </font>Coord<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  For </b></font>I <font color="#000080">:= </font>x <font color="#FF0000"><b>to </b></font>z <font color="#FF0000"><b>do </b></font>s1<font color="#000080">[</font>i<font color="#000080">] := </font>s0<font color="#000080">[</font>i<font color="#000080">] + </font>t<font color="#000080">*</font>ds<font color="#000080">[</font>i<font color="#000080">];
  </font>ITRF <font color="#000080">:= </font>G<font color="#000080">(</font>s1<font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 For </b></font>I <font color="#000080">:= </font>x <font color="#FF0000"><b>to </b></font>z <font color="#FF0000"><b>do </b></font>DS<font color="#000080">[</font>i<font color="#000080">] := </font>S1<font color="#000080">[</font>i<font color="#000080">] - </font>s0<font color="#000080">[</font>i<font color="#000080">];
 </font>F <font color="#000080">:= </font>ITRF<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
 </font>T <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font>DT <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
 </font>N <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>B <font color="#000080">:= </font>False<font color="#000080">;
 </font><font color="#FF0000"><b>Repeat
  </b></font>Inc<font color="#000080">(</font>N<font color="#000080">);
  </font>F1 <font color="#000080">:= </font>ITRF<font color="#000080">(</font>t<font color="#000080">);
  </font>DF <font color="#000080">:= (</font>F <font color="#000080">-</font>F1<font color="#000080">);
  </font>F <font color="#000080">:= </font>F1<font color="#000080">;
  </font>T1 <font color="#000080">:= </font>T <font color="#000080">- </font>F<font color="#000080">*</font>DT<font color="#000080">/</font>DF<font color="#000080">;
  </font>DT <font color="#000080">:= </font>T<font color="#000080">-</font>T1<font color="#000080">;
  </font>T <font color="#000080">:= </font>T1<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>T1 <font color="#000080">&gt; </font><font color="#800000">10 </font><font color="#FF0000"><b>then </b></font>t1 <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
 </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>abs<font color="#000080">(</font>F<font color="#000080">) &lt; </font><font color="#800000">0.001</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>N<font color="#000080">&gt;</font><font color="#800000">100</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>DF <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
 </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font>x <font color="#FF0000"><b>to </b></font>z <font color="#FF0000"><b>do </b></font>S1<font color="#000080">[</font>i<font color="#000080">] := </font>s0<font color="#000080">[</font>i<font color="#000080">] + </font>t1<font color="#000080">*</font>ds<font color="#000080">[</font>i<font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>PLine<font color="#000080">(</font>P1<font color="#000080">,</font>P2 <font color="#000080">: </font>PType<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 If </b></font>Clip<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Graph<font color="#000080">.</font>Line<font color="#000080">(</font>Round<font color="#000080">(</font>GetMaxX<font color="#000080">*</font>P1<font color="#000080">[</font>x<font color="#000080">]), </font>Round<font color="#000080">(</font>GetMaxY<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">-</font>P1<font color="#000080">[</font>y<font color="#000080">])),
 </font>Round<font color="#000080">(</font>GetMaxX<font color="#000080">*</font>P2<font color="#000080">[</font>x<font color="#000080">]), </font>Round<font color="#000080">(</font>GetMaxY<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">-</font>P2<font color="#000080">[</font>y<font color="#000080">])));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>PPoint<font color="#000080">(</font>P <font color="#000080">: </font>PType<font color="#000080">; </font>Ch <font color="#000080">: </font>Char<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 If </b></font>Inside<font color="#000080">(</font>P<font color="#000080">) </font><font color="#FF0000"><b>then
  </b></font>OutTextXY<font color="#000080">(</font>Round<font color="#000080">(</font>GetMaxX<font color="#000080">*</font>p<font color="#000080">[</font>x<font color="#000080">]),</font>Round<font color="#000080">(</font>GetMaxY<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">-</font>p<font color="#000080">[</font>y<font color="#000080">])),</font>ch<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>MoveTo<font color="#000080">(</font>S <font color="#000080">: </font>SType<font color="#000080">);
 </font><font color="#FF0000"><b>Begin </b></font>Curr <font color="#000080">:= </font>S<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>LineTo<font color="#000080">(</font>S <font color="#000080">: </font>sType<font color="#000080">; </font>g <font color="#000080">: </font>implicit<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 </b></font>Line<font color="#000080">(</font>Curr<font color="#000080">, </font>s<font color="#000080">,</font>g<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Line<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>St1<font color="#000080">, </font>St2 <font color="#000080">: </font>SType<font color="#000080">;
    </font>PP1<font color="#000080">, </font>PP2 <font color="#000080">: </font>PType<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 If </b></font><font color="#000080">(</font>S1<font color="#000080">[</font>z<font color="#000080">] &gt; </font>Screen<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>S2<font color="#000080">[</font>z<font color="#000080">] &gt; </font>Screen<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
 </font>St1 <font color="#000080">:= </font>s1<font color="#000080">;
 </font>St2 <font color="#000080">:= </font>s2<font color="#000080">;
 </font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>St1<font color="#000080">);
 </font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>St2<font color="#000080">);
 </font>Move<font color="#000080">(</font>St1<font color="#000080">,</font>PP1<font color="#000080">,</font>SizeOF<font color="#000080">(</font>PP1<font color="#000080">));
 </font><font color="#FF0000"><b>Repeat
  </b></font>Move<font color="#000080">(</font>St1<font color="#000080">,</font>PP1<font color="#000080">,</font>SizeOF<font color="#000080">(</font>PP1<font color="#000080">));
  </font>Move<font color="#000080">(</font>St2<font color="#000080">,</font>PP2<font color="#000080">,</font>SizeOF<font color="#000080">(</font>PP1<font color="#000080">));
  </font>PLine<font color="#000080">(</font>pp1<font color="#000080">,</font>pp2<font color="#000080">);
  </font>RayTrace<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>st1<font color="#000080">,</font>g<font color="#000080">);
  </font>RayTrace<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>st2<font color="#000080">,</font>g<font color="#000080">);
  </font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>St1<font color="#000080">);
  </font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>St2<font color="#000080">);
  </font>Move<font color="#000080">(</font>St1<font color="#000080">,</font>PP1<font color="#000080">,</font>SizeOf<font color="#000080">(</font>PP1<font color="#000080">));
  </font>Move<font color="#000080">(</font>St2<font color="#000080">,</font>PP2<font color="#000080">,</font>SizeOf<font color="#000080">(</font>PP1<font color="#000080">));
 </font><font color="#FF0000"><b>Until not </b></font><font color="#000080">(</font>Inside<font color="#000080">(</font>PP1<font color="#000080">) </font><font color="#FF0000"><b>or </b></font>Inside<font color="#000080">(</font>pp2<font color="#000080">));
</font>St1 <font color="#000080">:= </font>s1<font color="#000080">;
</font>St2 <font color="#000080">:= </font>s2<font color="#000080">;
</font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>st1<font color="#000080">);</font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>st2<font color="#000080">);
</font><font color="#FF0000"><b>Repeat
  </b></font>Move<font color="#000080">(</font>St1<font color="#000080">,</font>PP1<font color="#000080">,</font>SizeOF<font color="#000080">(</font>PP1<font color="#000080">));
  </font>Move<font color="#000080">(</font>St2<font color="#000080">,</font>PP2<font color="#000080">,</font>SizeOF<font color="#000080">(</font>PP1<font color="#000080">));
  </font>PLine<font color="#000080">(</font>pp1<font color="#000080">,</font>pp2<font color="#000080">);
  </font>RayTrace<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>st1<font color="#000080">,</font>g<font color="#000080">);
  </font>RayTrace<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>st2<font color="#000080">,</font>g<font color="#000080">);
  </font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>St1<font color="#000080">);
  </font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>St2<font color="#000080">);
  </font>Move<font color="#000080">(</font>St1<font color="#000080">,</font>PP1<font color="#000080">,</font>SizeOf<font color="#000080">(</font>PP1<font color="#000080">));
  </font>Move<font color="#000080">(</font>St2<font color="#000080">,</font>PP2<font color="#000080">,</font>SizeOf<font color="#000080">(</font>PP1<font color="#000080">));
</font><font color="#FF0000"><b>Until not </b></font><font color="#000080">(</font>Inside<font color="#000080">(</font>PP1<font color="#000080">) </font><font color="#FF0000"><b>or </b></font>Inside<font color="#000080">(</font>pp2<font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Point<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>ST <font color="#000080">: </font>SType<font color="#000080">;
    </font>Pt <font color="#000080">: </font>PType<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 If </b></font>S<font color="#000080">[</font>z<font color="#000080">] &gt; </font>Screen <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
 </font>st <font color="#000080">:= </font>s<font color="#000080">;
 </font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>st<font color="#000080">);
</font><font color="#FF0000"><b>Repeat
 </b></font>Move<font color="#000080">(</font>St<font color="#000080">,</font>Pt<font color="#000080">,</font>SizeOF<font color="#000080">(</font>Pt<font color="#000080">));
 </font>PPoint<font color="#000080">(</font>Pt<font color="#000080">,</font>ch<font color="#000080">);
 </font>RayTrace<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>St<font color="#000080">,</font>g<font color="#000080">);
 </font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>st<font color="#000080">);
 </font>Move<font color="#000080">(</font>St<font color="#000080">,</font>Pt<font color="#000080">,</font>SizeOF<font color="#000080">(</font>Pt<font color="#000080">));
</font><font color="#FF0000"><b>Until not </b></font>Inside<font color="#000080">(</font>Pt<font color="#000080">);
</font>St <font color="#000080">:= </font>s<font color="#000080">;
</font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>st<font color="#000080">);
</font><font color="#FF0000"><b>Repeat
 </b></font>Move<font color="#000080">(</font>St<font color="#000080">,</font>Pt<font color="#000080">,</font>SizeOF<font color="#000080">(</font>Pt<font color="#000080">));
 </font>PPoint<font color="#000080">(</font>Pt<font color="#000080">,</font>ch<font color="#000080">);
 </font>RayTrace<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>St<font color="#000080">,</font>g<font color="#000080">);
 </font>ProjectPoint<font color="#000080">(</font>Eyes<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>st<font color="#000080">);
 </font>Move<font color="#000080">(</font>St<font color="#000080">,</font>Pt<font color="#000080">,</font>SizeOF<font color="#000080">(</font>Pt<font color="#000080">));
</font><font color="#FF0000"><b>Until not </b></font>Inside<font color="#000080">(</font>Pt<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>PlotSurface<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>W <font color="#000080">: </font>Coord<font color="#000080">;
</font>i<font color="#000080">,</font>j <font color="#000080">: </font>integer<font color="#000080">;
</font>u<font color="#000080">,</font>du<font color="#000080">,</font>v<font color="#000080">,</font>dv <font color="#000080">: </font>real<font color="#000080">;
</font>p1 <font color="#000080">: </font>sType<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 For </b></font>W <font color="#000080">:= </font>x <font color="#FF0000"><b>to </b></font>z <font color="#FF0000"><b>do </b></font>p1<font color="#000080">[</font>w<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
 </font>du <font color="#000080">:= (</font>u1<font color="#000080">-</font>u0<font color="#000080">)/</font>m<font color="#000080">;
 </font>dv <font color="#000080">:= (</font>v1<font color="#000080">-</font>v0<font color="#000080">)/</font>n<font color="#000080">;
 </font>u <font color="#000080">:= </font>u0<font color="#000080">;
 </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>m <font color="#FF0000"><b>do
 Begin
  </b></font>V <font color="#000080">:= </font>V0<font color="#000080">; </font>F2<font color="#000080">(</font>u<font color="#000080">,</font>v<font color="#000080">,</font>p1<font color="#000080">); </font>MoveTo<font color="#000080">(</font>p1<font color="#000080">);
 </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do begin
  </b></font>V <font color="#000080">:= </font>V<font color="#000080">+</font>dv<font color="#000080">; </font>f2<font color="#000080">(</font>u<font color="#000080">,</font>v<font color="#000080">,</font>p1<font color="#000080">); </font>LineTo<font color="#000080">(</font>P1<font color="#000080">,</font>F1<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>u <font color="#000080">:= </font>u<font color="#000080">+</font>du<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>v <font color="#000080">:= </font>v0<font color="#000080">;
</font><font color="#FF0000"><b>for </b></font>j <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do begin
 </b></font>u <font color="#000080">:= </font>u0<font color="#000080">; </font>f2<font color="#000080">(</font>u<font color="#000080">,</font>v<font color="#000080">,</font>p1<font color="#000080">); </font>MoveTo<font color="#000080">(</font>p1<font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>m <font color="#FF0000"><b>do begin
    </b></font>u <font color="#000080">:= </font>u <font color="#000080">+ </font>du<font color="#000080">; </font>f2<font color="#000080">(</font>u<font color="#000080">,</font>v<font color="#000080">,</font>p1<font color="#000080">); </font>LineTo<font color="#000080">(</font>p1<font color="#000080">,</font>f1<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>v <font color="#000080">:= </font>v <font color="#000080">+ </font>du<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>RandomDotSurface<font color="#000080">(</font>N <font color="#000080">: </font>Integer<font color="#000080">; </font>Ch <font color="#000080">: </font>Char<font color="#000080">; </font>G <font color="#000080">: </font>Implicit<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>I <font color="#000080">: </font>Integer<font color="#000080">; </font>S <font color="#000080">: </font>Stype<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>Randomize<font color="#000080">;
 </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do
  Begin
   </b></font>S<font color="#000080">[</font>x<font color="#000080">] := </font>Random<font color="#000080">;
   </font>S<font color="#000080">[</font>y<font color="#000080">] := </font>Random<font color="#000080">; </font>S<font color="#000080">[</font>z<font color="#000080">] := </font>Screen<font color="#000080">;
   </font>SetColor<font color="#000080">(</font>Random<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">)); </font>Point<font color="#000080">(</font>S<font color="#000080">,</font>Ch<font color="#000080">,</font>g<font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>Gm <font color="#000080">: </font>Integer<font color="#000080">;
 </font>g <font color="#000080">: </font>implicit<font color="#000080">; </font>s <font color="#000080">: </font>sType<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>F<font color="#000080">(</font>S <font color="#000080">: </font>SType<font color="#000080">) : </font>Real<font color="#000080">; </font><font color="#FF0000"><b>far</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>F <font color="#000080">:= </font>S<font color="#000080">[</font>z<font color="#000080">] + </font><font color="#800000">1 </font><font color="#000080">-</font>sqr<font color="#000080">(</font><font color="#800000">0.5</font><font color="#000080">-</font>s<font color="#000080">[</font>x<font color="#000080">]) - </font>sqr<font color="#000080">(</font><font color="#800000">0.5</font><font color="#000080">-</font>s<font color="#000080">[</font>y<font color="#000080">]);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Sphere<font color="#000080">(</font>u<font color="#000080">,</font>v <font color="#000080">: </font>real<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>p <font color="#000080">: </font>SType<font color="#000080">); </font><font color="#FF0000"><b>far</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>p<font color="#000080">[</font>x<font color="#000080">] := </font><font color="#800000">0.1</font><font color="#000080">+</font><font color="#800000">0.3</font><font color="#000080">*</font>cos<font color="#000080">(</font>u<font color="#000080">)*</font>cos<font color="#000080">(</font>v<font color="#000080">);
 </font>p<font color="#000080">[</font>y<font color="#000080">] := </font><font color="#800000">0.5</font><font color="#000080">+</font><font color="#800000">0.3</font><font color="#000080">*</font>sin<font color="#000080">(</font>u<font color="#000080">)*</font>cos<font color="#000080">(</font>v<font color="#000080">);
 </font>p<font color="#000080">[</font>z<font color="#000080">] := </font><font color="#800000">0.2</font><font color="#000080">*</font>sin<font color="#000080">(</font>v<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>gm <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>InitGraph<font color="#000080">(</font>gm<font color="#000080">,</font>gm<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
 </font>SetEyes<font color="#000080">(</font><font color="#800000">0.1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>Screen<font color="#000080">+</font><font color="#800000">0.5</font><font color="#000080">);
 </font>g <font color="#000080">:= </font>f<font color="#000080">;
 </font>SetColor<font color="#000080">(</font>Blue<font color="#000080">);
 </font>RecTangle<font color="#000080">(</font>Round<font color="#000080">(</font>GetMaxX<font color="#000080">*</font>ClipR<font color="#000080">[</font>mini<font color="#000080">,</font>x<font color="#000080">]),
           </font>Round<font color="#000080">(</font>GetMaxY<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">-</font>ClipR<font color="#000080">[</font>mini<font color="#000080">,</font>y<font color="#000080">])),
           </font>Round<font color="#000080">(</font>GetMaxX<font color="#000080">*</font>ClipR<font color="#000080">[</font>maxi<font color="#000080">,</font>x<font color="#000080">]),
           </font>Round<font color="#000080">(</font>GetMaxY<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">-</font>ClipR<font color="#000080">[</font>maxi<font color="#000080">,</font>y<font color="#000080">])));
 </font>RAndomDotSurface<font color="#000080">(</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">'*'</font><font color="#000080">,</font>g<font color="#000080">);
 </font>SetColor<font color="#000080">(</font>Yellow<font color="#000080">);
</font><font color="#008000"><i>{ PlotSurface(g,Sphere,0,2*pi,30,-pi/2,pi/2,15);}
 </i></font>ReadLn<font color="#000080">;
 </font>CloseGRaph<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0281.PAS">Original</a><b>]</b></p></body>
</html>
