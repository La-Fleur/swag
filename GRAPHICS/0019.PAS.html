<html>
<head><title> "Graphic FX Unit" by ANDRE JAKOBS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I hope you can do something With these listings
I downloaded from a BBS near me....
This File contains:  Program VGA3d
                     Unit DDFigs
                     Unit DDVars
                     Unit DDVideo
                     Unit DDProcs
Just break it in pieces on the cut here signs......

if you need some Units or Programs (or TxtFiles) on Programming the Adlib/
Sound-Blaster or Roland MPU-401, just let me know, and i see if i can dig
up some good listings.....
But , will your game also have Soundblaster/adlib fm support and Sound
Blaster Digitized Sound support, maybe even MPU/MT32? support....
And try to make it as bloody as you can (Heads exploding etc..)(JOKE)

I hope i you can complete your game (i haven't completed any of my games yet)
And i like a copy of it when it's ready......

Please leave a message if you received this File.

  Andre Jakobs
    MicroBrain Technologies Inc.
        GelderlandLaan 9
          5691 KL   Son en Breugel
            The Netherlands............
}


</i></font><font color="#FF0000"><b>Program </b></font>animatie_van_3d_vector_grafics<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">,
  </font>ddvideo<font color="#000080">,
  </font>ddfigs<font color="#000080">,
  </font>ddprocs<font color="#000080">,
  </font>ddVars<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Opal <font color="#000080">: </font>paletteType<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>wireframe<font color="#000080">(</font>pro <font color="#000080">: </font>vertex2Array<font color="#000080">);
</font><font color="#008000"><i>{ Teken een lijnen diagram van gesloten voorwerpen met vlakken }
</i></font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j<font color="#000080">, </font>k<font color="#000080">,
  </font>v1<font color="#000080">, </font>v2  <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ntf <font color="#FF0000"><b>DO
  begin
    </b></font>j <font color="#000080">:= </font>nfac<font color="#000080">[</font>i<font color="#000080">];
    </font><font color="#FF0000"><b>if </b></font>j <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>v1 <font color="#000080">:= </font>faclist<font color="#000080">[ </font>facfront<font color="#000080">[</font>j<font color="#000080">] + </font>size<font color="#000080">[</font>j<font color="#000080">] ];
      </font><font color="#FF0000"><b>For </b></font>k <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>size<font color="#000080">[</font>j<font color="#000080">] </font><font color="#FF0000"><b>DO
      begin
        </b></font>v2 <font color="#000080">:= </font>faclist<font color="#000080">[</font>facfront<font color="#000080">[</font>j<font color="#000080">] + </font>k<font color="#000080">];
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>v1<font color="#000080">&lt;</font>v2<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>super<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>linepto<font color="#000080">(</font>colour<font color="#000080">[</font>j<font color="#000080">], </font>pro<font color="#000080">[</font>v1<font color="#000080">], </font>pro<font color="#000080">[</font>v2<font color="#000080">])
        </font>v1 <font color="#000080">:= </font>v2<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>hidden<font color="#000080">(</font>pro <font color="#000080">: </font>vertex2Array<font color="#000080">);
</font><font color="#008000"><i>{ Display van Objecten als geheel van de projectiepunten van pro }
{ b is een masker voor de kleuren }
</i></font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">,  </font>col <font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>signe<font color="#000080">( </font>n <font color="#000080">: </font>Real<font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>n <font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>signe <font color="#000080">:= -</font><font color="#800000">1
    </font><font color="#FF0000"><b>else
    if </b></font>n <font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>signe <font color="#000080">:= </font><font color="#800000">1
    </font><font color="#FF0000"><b>else
      </b></font>signe <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>orient<font color="#000080">(</font>f <font color="#000080">: </font>Integer<font color="#000080">; </font>v <font color="#000080">: </font>vertex2Array<font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>i<font color="#000080">, </font>ind1<font color="#000080">,
    </font>ind2<font color="#000080">, </font>ind3 <font color="#000080">: </font>Integer<font color="#000080">;
    </font>dv1<font color="#000080">, </font>dv2   <font color="#000080">: </font>vector2<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>i <font color="#000080">:= </font>nfac<font color="#000080">[</font>f<font color="#000080">];
    </font><font color="#FF0000"><b>if </b></font>i <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>orient <font color="#000080">:= </font><font color="#800000">0
    </font><font color="#FF0000"><b>else
    begin
      </b></font>ind1   <font color="#000080">:= </font>faclist<font color="#000080">[</font>facfront<font color="#000080">[</font>i<font color="#000080">] + </font><font color="#800000">1</font><font color="#000080">];
      </font>ind2   <font color="#000080">:= </font>faclist<font color="#000080">[</font>facfront<font color="#000080">[</font>i<font color="#000080">] + </font><font color="#800000">2</font><font color="#000080">];
      </font>ind3   <font color="#000080">:= </font>faclist<font color="#000080">[</font>facfront<font color="#000080">[</font>i<font color="#000080">] + </font><font color="#800000">3</font><font color="#000080">];
      </font>dv1<font color="#000080">.</font>x  <font color="#000080">:= </font>v<font color="#000080">[</font>ind2<font color="#000080">].</font>x <font color="#000080">- </font>v<font color="#000080">[</font>ind1<font color="#000080">].</font>x<font color="#000080">;
      </font>dv1<font color="#000080">.</font>y  <font color="#000080">:= </font>v<font color="#000080">[</font>ind2<font color="#000080">].</font>y <font color="#000080">- </font>v<font color="#000080">[</font>ind1<font color="#000080">].</font>y<font color="#000080">;
      </font>dv2<font color="#000080">.</font>x  <font color="#000080">:= </font>v<font color="#000080">[</font>ind3<font color="#000080">].</font>x <font color="#000080">- </font>v<font color="#000080">[</font>ind2<font color="#000080">].</font>x<font color="#000080">;
      </font>dv2<font color="#000080">.</font>y  <font color="#000080">:= </font>v<font color="#000080">[</font>ind3<font color="#000080">].</font>y <font color="#000080">- </font>v<font color="#000080">[</font>ind2<font color="#000080">].</font>y<font color="#000080">;
      </font>orient <font color="#000080">:= </font>signe<font color="#000080">(</font>dv1<font color="#000080">.</font>x <font color="#000080">* </font>dv2<font color="#000080">.</font>y <font color="#000080">- </font>dv2<font color="#000080">.</font>x <font color="#000080">* </font>dv1<font color="#000080">.</font>y<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>facetfill<font color="#000080">(</font>k <font color="#000080">: </font>Integer<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>v           <font color="#000080">: </font>vector2Array<font color="#000080">;
    </font>i<font color="#000080">, </font>index<font color="#000080">, </font>j <font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>j <font color="#000080">:= </font>nfac<font color="#000080">[</font>k<font color="#000080">];
    </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>size<font color="#000080">[</font>j<font color="#000080">] </font><font color="#FF0000"><b>DO
    begin
      </b></font>index <font color="#000080">:= </font>faclist<font color="#000080">[</font>facfront<font color="#000080">[</font>j<font color="#000080">] + </font>i<font color="#000080">];
      </font>v<font color="#000080">[</font>i<font color="#000080">]  := </font>pro<font color="#000080">[</font>index<font color="#000080">];
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>fillpoly<font color="#000080">(</font>colour<font color="#000080">[</font>k<font color="#000080">], </font>size<font color="#000080">[</font>j<font color="#000080">], </font>v<font color="#000080">);
    </font>polydraw<font color="#000080">(</font>colour<font color="#000080">[</font>k<font color="#000080">] - </font><font color="#800000">1</font><font color="#000080">, </font>size<font color="#000080">[</font>j<font color="#000080">], </font>v<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>seefacet<font color="#000080">(</font>k <font color="#000080">: </font>Integer<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>ipt<font color="#000080">, </font>supk <font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>facetfill<font color="#000080">(</font>k<font color="#000080">);
    </font>ipt <font color="#000080">:= </font>firstsup<font color="#000080">[</font>k<font color="#000080">];
    </font><font color="#FF0000"><b>While </b></font>ipt <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
    begin
      </b></font>supk <font color="#000080">:= </font>facetinfacet<font color="#000080">[</font>ipt<font color="#000080">].</font>info<font color="#000080">;
       </font>facetfill<font color="#000080">(</font>supk<font color="#000080">);
      </font>ipt <font color="#000080">:= </font>facetinfacet<font color="#000080">[</font>ipt<font color="#000080">].</font>Pointer<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ hidden Programmacode }
</i></font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nof <font color="#FF0000"><b>DO
  if </b></font>super<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    if </b></font>orient<font color="#000080">(</font>i<font color="#000080">, </font>pro<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then
      </b></font>seefacet<font color="#000080">(</font>i<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>display<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{observe}
  </i></font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nov <font color="#FF0000"><b>DO
    </b></font>transform<font color="#000080">(</font>act<font color="#000080">[</font>i<font color="#000080">], </font>Q<font color="#000080">, </font>obs<font color="#000080">[</font>i<font color="#000080">]);

  </font><font color="#008000"><i>{project}
  </i></font>ntv <font color="#000080">:= </font>nov<font color="#000080">;
  </font>ntf <font color="#000080">:= </font>nof<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ntv <font color="#FF0000"><b>DO
  begin
    </b></font>pro<font color="#000080">[</font>i<font color="#000080">].</font>x <font color="#000080">:= </font>obs<font color="#000080">[</font>i<font color="#000080">].</font>x<font color="#000080">;
    </font>pro<font color="#000080">[</font>i<font color="#000080">].</font>y <font color="#000080">:= </font>obs<font color="#000080">[</font>i<font color="#000080">].</font>y<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{drawit}
  </i></font>switch <font color="#000080">:= </font>switch <font color="#FF0000"><b>xor </b></font><font color="#800000">1</font><font color="#000080">;
  </font>hidden<font color="#000080">(</font>pro<font color="#000080">);
  </font>Scherm_actief<font color="#000080">(</font>switch<font color="#000080">);
  </font>Virscherm_actief<font color="#000080">(</font>switch <font color="#FF0000"><b>xor </b></font><font color="#800000">1</font><font color="#000080">);
  </font>wisscherm<font color="#000080">(</font>prevpoints<font color="#000080">, </font><font color="#800000">$a000</font><font color="#000080">, </font><font color="#800000">$8a00</font><font color="#000080">);
  </font>wis_hline<font color="#000080">(</font>prevhline<font color="#000080">, </font><font color="#800000">$8a00</font><font color="#000080">);
  </font>prevpoints <font color="#000080">:= </font>points<font color="#000080">;</font>prevhline <font color="#000080">:= </font>hline<font color="#000080">;
  </font>points<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]  := </font><font color="#800000">0</font><font color="#000080">;
  </font>hline<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]   := </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>anim3d<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>A<font color="#000080">, </font>B<font color="#000080">, </font>C<font color="#000080">, </font>D<font color="#000080">, </font>E<font color="#000080">, </font>F<font color="#000080">,
  </font>G<font color="#000080">, </font>H<font color="#000080">, </font>I<font color="#000080">, </font>J<font color="#000080">, </font>QE<font color="#000080">, </font>P    <font color="#000080">: </font>matrix4x4<font color="#000080">;
  </font>zoom<font color="#000080">, </font>inz<font color="#000080">, </font>inzplus   <font color="#000080">: </font>Real<font color="#000080">;
  </font>angle<font color="#000080">, </font>angleinc<font color="#000080">,
  </font>beta<font color="#000080">, </font>betainc<font color="#000080">, </font>frame <font color="#000080">: </font>Integer<font color="#000080">;
  </font>huidigpalette        <font color="#000080">: </font>paletteType<font color="#000080">;

  </font><font color="#008000"><i>{ Kubus Animatie : Roterende kubus }
  </i></font><font color="#FF0000"><b>Procedure </b></font>kubus<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>angle    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>angleinc <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>beta     <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>betainc  <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
    </font>direct<font color="#000080">.</font>x <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>direct<font color="#000080">.</font>y <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
    </font>direct<font color="#000080">.</font>z <font color="#000080">:= -</font><font color="#800000">3</font><font color="#000080">;
    </font>findQ<font color="#000080">;
    </font>cubesetup<font color="#000080">(</font><font color="#800000">104</font><font color="#000080">);
    </font>frame <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>frame <font color="#000080">&lt; </font><font color="#800000">91</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>frame   <font color="#000080">:= </font>frame <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>xyscale <font color="#000080">:= </font>zoom <font color="#000080">* </font><font color="#800000">2 </font><font color="#000080">* </font>sinus<font color="#000080">(</font>beta<font color="#000080">);
      </font>rot3<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>trunc<font color="#000080">(</font>angle<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">), </font>Qe<font color="#000080">);
      </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>angle<font color="#000080">, </font>P<font color="#000080">);
      </font>mult3<font color="#000080">(</font>P<font color="#000080">, </font>Qe<font color="#000080">, </font>P<font color="#000080">);
      </font>cube<font color="#000080">(</font>P<font color="#000080">);
      </font>display<font color="#000080">;
      </font>angle <font color="#000080">:= </font>angle <font color="#000080">+ </font>angleinc<font color="#000080">;
      </font>beta  <font color="#000080">:= </font>beta <font color="#000080">+ </font>betainc<font color="#000080">;
      </font>nov   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{Piramides Animatie : Scene opgebouwd uit twee Piramides en 1 Kubus }
  </i></font><font color="#FF0000"><b>Procedure </b></font>Piramides<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>frame   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>angle   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>beta    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>betainc <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
    </font>scale3<font color="#000080">(</font><font color="#800000">4.0</font><font color="#000080">, </font><font color="#800000">0.2</font><font color="#000080">, </font><font color="#800000">4.0</font><font color="#000080">, </font>C<font color="#000080">);
    </font>cubesetup<font color="#000080">(</font><font color="#800000">90</font><font color="#000080">);
    </font>cube<font color="#000080">(</font>P<font color="#000080">);

    </font>scale3<font color="#000080">(</font><font color="#800000">2.5</font><font color="#000080">, </font><font color="#800000">4.0</font><font color="#000080">, </font><font color="#800000">2.5</font><font color="#000080">, </font>D<font color="#000080">);
    </font>tran3<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">, -</font><font color="#800000">0.2</font><font color="#000080">, </font><font color="#800000">2.0</font><font color="#000080">, </font>E<font color="#000080">);
    </font>mult3<font color="#000080">(</font>E<font color="#000080">, </font>D<font color="#000080">, </font>F<font color="#000080">);
    </font>pirasetup<font color="#000080">(</font><font color="#800000">34</font><font color="#000080">);
    </font>piramid<font color="#000080">(</font>P<font color="#000080">);

    </font>scale3<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">, </font><font color="#800000">4.0</font><font color="#000080">, </font><font color="#800000">2.0</font><font color="#000080">, </font>G<font color="#000080">);
    </font>tran3<font color="#000080">(-</font><font color="#800000">3.0</font><font color="#000080">, -</font><font color="#800000">0.2</font><font color="#000080">, </font><font color="#800000">0.0</font><font color="#000080">, </font>H<font color="#000080">);
    </font>mult3<font color="#000080">(</font>H<font color="#000080">, </font>G<font color="#000080">, </font>I<font color="#000080">);
    </font>pirasetup<font color="#000080">(</font><font color="#800000">42</font><font color="#000080">);
    </font>piramid<font color="#000080">(</font>P<font color="#000080">);

    </font>E <font color="#000080">:= </font>Q<font color="#000080">;
    </font>nov <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>frame <font color="#000080">&lt; </font><font color="#800000">18</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>frame   <font color="#000080">:= </font>frame <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>xyscale <font color="#000080">:= </font>zoom <font color="#000080">* </font><font color="#800000">2 </font><font color="#000080">* </font>sinus<font color="#000080">(</font>beta<font color="#000080">);

      </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>angle<font color="#000080">, </font>B<font color="#000080">);

      </font>mult3<font color="#000080">(</font>B<font color="#000080">, </font>C<font color="#000080">, </font>P<font color="#000080">);
      </font>cube<font color="#000080">(</font>P<font color="#000080">);

      </font>mult3<font color="#000080">(</font>B<font color="#000080">, </font>F<font color="#000080">, </font>P<font color="#000080">);
      </font>piramid<font color="#000080">(</font>P<font color="#000080">);

      </font>mult3<font color="#000080">(</font>B<font color="#000080">, </font>I<font color="#000080">, </font>P<font color="#000080">);
      </font>piramid<font color="#000080">(</font>P<font color="#000080">);

      </font>display<font color="#000080">;

      </font>angle <font color="#000080">:= </font>angle <font color="#000080">+ </font>angleinc<font color="#000080">;
      </font>beta  <font color="#000080">:= </font>beta <font color="#000080">+ </font>betainc<font color="#000080">;
      </font>nov   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>frame <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>angleinc <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;

     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>frame <font color="#000080">&lt; </font><font color="#800000">75</font><font color="#000080">) </font><font color="#FF0000"><b>do
     begin
       </b></font>frame <font color="#000080">:= </font>frame <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;

       </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>angle<font color="#000080">, </font>B<font color="#000080">);

       </font>mult3<font color="#000080">(</font>B<font color="#000080">, </font>C<font color="#000080">, </font>P<font color="#000080">);
       </font>cube<font color="#000080">(</font>P<font color="#000080">);

       </font>mult3<font color="#000080">(</font>B<font color="#000080">, </font>F<font color="#000080">, </font>P<font color="#000080">);
       </font>piramid<font color="#000080">(</font>P<font color="#000080">);

       </font>mult3<font color="#000080">(</font>B<font color="#000080">, </font>I<font color="#000080">, </font>P<font color="#000080">);
       </font>piramid<font color="#000080">(</font>P<font color="#000080">);

       </font>display<font color="#000080">;

       </font>angle <font color="#000080">:= </font>angle <font color="#000080">+ </font>angleinc<font color="#000080">;
       </font>nov   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>frame <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>beta <font color="#000080">:= </font><font color="#800000">180</font><font color="#000080">-</font>beta<font color="#000080">;

     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>frame <font color="#000080">&lt; </font><font color="#800000">19</font><font color="#000080">) </font><font color="#FF0000"><b>do
     begin

       </b></font>frame <font color="#000080">:= </font>frame <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;

       </font>xyscale <font color="#000080">:= </font>zoom <font color="#000080">* </font><font color="#800000">2 </font><font color="#000080">* </font>sinus<font color="#000080">(</font>beta<font color="#000080">);
       </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>angle<font color="#000080">, </font>B<font color="#000080">);

       </font>mult3<font color="#000080">(</font>C<font color="#000080">, </font>B<font color="#000080">, </font>P<font color="#000080">);
       </font>cube<font color="#000080">(</font>P<font color="#000080">);

       </font>mult3<font color="#000080">(</font>B<font color="#000080">, </font>F<font color="#000080">, </font>P<font color="#000080">);
       </font>piramid<font color="#000080">(</font>P<font color="#000080">);

       </font>mult3<font color="#000080">(</font>B<font color="#000080">, </font>I<font color="#000080">, </font>P<font color="#000080">);
       </font>piramid<font color="#000080">(</font>P<font color="#000080">);

       </font>display<font color="#000080">;

       </font>angle <font color="#000080">:= </font>angle <font color="#000080">+ </font>angleinc<font color="#000080">;
       </font>beta  <font color="#000080">:= </font>beta  <font color="#000080">+ </font>betainc<font color="#000080">;
       </font>nov   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ Huis_animatie4 : Figuur huis roteert en &quot;komt uit de lucht vallen&quot; }
  </i></font><font color="#FF0000"><b>Procedure </b></font>huisval<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>xyscale  <font color="#000080">:= </font>zoom<font color="#000080">;
    </font>nof      <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>nov      <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>last     <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>angle    <font color="#000080">:= </font><font color="#800000">1355</font><font color="#000080">;
    </font>angleinc <font color="#000080">:= -</font><font color="#800000">7</font><font color="#000080">;
    </font>frame    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

    </font>huissetup<font color="#000080">;

    </font>zoom     <font color="#000080">:= </font><font color="#800000">0.02</font><font color="#000080">;
    </font>Direct<font color="#000080">.</font>x <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;
    </font>direct<font color="#000080">.</font>y <font color="#000080">:= -</font><font color="#800000">2</font><font color="#000080">;
    </font>direct<font color="#000080">.</font>z <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;
    </font>findQ<font color="#000080">;

    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>frame <font color="#000080">&lt; </font><font color="#800000">40</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>frame <font color="#000080">:= </font>frame <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>zoom  <font color="#000080">:= </font>zoom <font color="#000080">+ </font><font color="#800000">0.01</font><font color="#000080">;
      </font>Scale3<font color="#000080">(</font>zoom<font color="#000080">, </font>zoom<font color="#000080">, </font>zoom<font color="#000080">, </font>Qe<font color="#000080">);
      </font>tran3<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, (-</font><font color="#800000">7 </font><font color="#000080">/ </font>zoom<font color="#000080">) + </font>frame <font color="#000080">/ </font><font color="#800000">1.8</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>A<font color="#000080">);
      </font>mult3<font color="#000080">(</font>Qe<font color="#000080">, </font>A<font color="#000080">, </font>C<font color="#000080">);
      </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>angle<font color="#000080">, </font>B<font color="#000080">);
      </font>mult3<font color="#000080">(</font>C<font color="#000080">, </font>B<font color="#000080">, </font>P<font color="#000080">);
      </font>huis<font color="#000080">(</font>P<font color="#000080">);
      </font>display<font color="#000080">;
      </font>angle <font color="#000080">:= </font>angle <font color="#000080">+ </font>angleinc<font color="#000080">;
      </font>nov   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>frame   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>beta    <font color="#000080">:= </font>angle<font color="#000080">;
    </font>betainc <font color="#000080">:= </font>angleinc<font color="#000080">;

    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>frame <font color="#000080">&lt; </font><font color="#800000">15</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>frame <font color="#000080">:= </font>frame <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;

      </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>beta<font color="#000080">, </font>B<font color="#000080">);
      </font>mult3<font color="#000080">(</font>B<font color="#000080">, </font>Qe<font color="#000080">, </font>P<font color="#000080">);
      </font>mult3<font color="#000080">(</font>P<font color="#000080">, </font>A<font color="#000080">, </font>P<font color="#000080">);
      </font>huis<font color="#000080">(</font>P<font color="#000080">);

      </font>display<font color="#000080">;

      </font>beta    <font color="#000080">:= </font>beta <font color="#000080">+ </font>betainc<font color="#000080">;
      </font>betainc <font color="#000080">:= </font>trunc<font color="#000080">(</font>betainc <font color="#000080">+ (</font><font color="#800000">7 </font><font color="#000080">/ </font><font color="#800000">15</font><font color="#000080">));
      </font>nov     <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>frame <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>frame <font color="#000080">&lt; </font><font color="#800000">30</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>frame    <font color="#000080">:= </font>frame <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>direct<font color="#000080">.</font>z <font color="#000080">:= </font>direct<font color="#000080">.</font>z <font color="#000080">- (</font>frame <font color="#000080">* (</font><font color="#800000">20 </font><font color="#000080">/ </font><font color="#800000">70</font><font color="#000080">));
      </font>findQ<font color="#000080">;
      </font>huis<font color="#000080">(</font>P<font color="#000080">);
      </font>display<font color="#000080">;
      </font>nov <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>frame <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>zoom  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>frame <font color="#000080">&lt; </font><font color="#800000">31</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>frame <font color="#000080">:= </font>frame <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>mult3<font color="#000080">(</font>B<font color="#000080">, </font>Qe<font color="#000080">, </font>P<font color="#000080">);
      </font>scale3<font color="#000080">(</font>zoom<font color="#000080">, </font>zoom<font color="#000080">, </font>zoom<font color="#000080">, </font>C<font color="#000080">);
      </font>mult3<font color="#000080">(</font>P<font color="#000080">, </font>A<font color="#000080">, </font>P<font color="#000080">);
      </font>mult3<font color="#000080">(</font>P<font color="#000080">, </font>C<font color="#000080">, </font>P<font color="#000080">);
      </font>huis<font color="#000080">(</font>P<font color="#000080">);
      </font>display<font color="#000080">;
      </font>zoom <font color="#000080">:= </font>zoom <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">/ </font><font color="#800000">30</font><font color="#000080">;
      </font>nov  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>zoom <font color="#000080">:= </font>xyscale<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ Ster Animatie : Roterende ster als kubus met 4 piramides }
  </i></font><font color="#FF0000"><b>Procedure </b></font>Sterrot<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>xyscale  <font color="#000080">:= </font>zoom<font color="#000080">;
    </font>frame    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>angle    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>angleinc <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>beta     <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>betainc  <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
    </font>nof      <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>last     <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>nov      <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

    </font>stersetup<font color="#000080">(</font><font color="#800000">140</font><font color="#000080">);
    </font>scale3<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>P<font color="#000080">);
    </font>ster<font color="#000080">(</font>P<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);

    </font>Direct<font color="#000080">.</font>x <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;
    </font>direct<font color="#000080">.</font>y <font color="#000080">:= -</font><font color="#800000">2</font><font color="#000080">;
    </font>direct<font color="#000080">.</font>z <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;
    </font>findQ<font color="#000080">;
    </font>E <font color="#000080">:= </font>Q<font color="#000080">;

    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>frame <font color="#000080">&lt; </font><font color="#800000">90</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>frame   <font color="#000080">:= </font>frame <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>xyscale <font color="#000080">:= </font>zoom <font color="#000080">* </font><font color="#800000">1.7 </font><font color="#000080">* </font>sinus<font color="#000080">(</font>beta<font color="#000080">);
      </font>rot3<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>Round<font color="#000080">(</font>angle<font color="#000080">/</font><font color="#800000">5</font><font color="#000080">), </font>A<font color="#000080">);
      </font>mult3<font color="#000080">(</font>A<font color="#000080">, </font>E<font color="#000080">, </font>Q<font color="#000080">);
      </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>angle<font color="#000080">, </font>P<font color="#000080">);
      </font>ster<font color="#000080">(</font>P<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
      </font>display<font color="#000080">;
      </font>angle <font color="#000080">:= </font>angle <font color="#000080">+ </font>angleinc<font color="#000080">;
      </font>beta  <font color="#000080">:= </font>beta  <font color="#000080">+ </font>betainc<font color="#000080">;
      </font>nov   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>eye<font color="#000080">.</font>x <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>eye<font color="#000080">.</font>y <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>eye<font color="#000080">.</font>z <font color="#000080">:=  </font><font color="#800000">0</font><font color="#000080">;
  </font>zoom  <font color="#000080">:= </font>xyscale<font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>nov  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>nof  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>last <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Kubus<font color="#000080">;
    </font>Piramides<font color="#000080">;
    </font>Huisval<font color="#000080">;
    </font>Sterrot<font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>KeyPressed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ _______________Hoofd Programma --------------------- }

</i></font><font color="#FF0000"><b>begin
  </b></font>nov  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>nof  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>last <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>start<font color="#000080">(</font><font color="#800000">'pira'</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">,  </font>Opal<font color="#000080">);

  </font>points<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]     := </font><font color="#800000">0</font><font color="#000080">;
  </font>prevpoints<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
  </font>hline<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]      := </font><font color="#800000">0</font><font color="#000080">;
  </font>prevhline<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]  := </font><font color="#800000">0</font><font color="#000080">;

  </font>anim3D<font color="#000080">;

  </font>finish<font color="#000080">(</font>Opal<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Coded by ...... &quot; De Vectorman &quot;'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font><font color="#008000"><i>{ &plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn; }

</i></font><font color="#FF0000"><b>Unit </b></font>ddfigs<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses
  </b></font>DDprocs<font color="#000080">, </font>DDVars<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>cubevert <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>vector3 <font color="#000080">=
    ((</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">));

  </font>cubefacet <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer <font color="#000080">=
    ((</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">),
     (</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">),
     (</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">),
     (</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">),
     (</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">),
     (</font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">));

  </font>piravert  <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>vector3 <font color="#000080">=
    ((</font>x <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">));

  </font>pirafacet <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer <font color="#000080">=
    ((</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">),
     (</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">),
     (</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">),
     (</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">),
     (</font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">));

  </font>huisvert  <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">59</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>vector3 <font color="#000080">=
    ((</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">8</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">8</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">11</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">8</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">8</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">11</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">3</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">3</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">5</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">5</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">4</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">3</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">3</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">5</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">2</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">2</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">3</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">5</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">3</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">5</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">2</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">2</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">5</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">3</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">4</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">3</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">2</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">5</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">5</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">3</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">2</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">3</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">2</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">5</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">5</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">2</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">4</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">3</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">3</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">3</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">3</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">3</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">3</font><font color="#000080">), (</font>x <font color="#000080">: -</font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">: </font><font color="#800000">7</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">));

  </font>huissize  <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">19</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer <font color="#000080">=
    (</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);

  </font>huissuper <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">19</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer <font color="#000080">=
    (</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">);

  </font>huisfacet <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">79</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer <font color="#000080">=
    ( </font><font color="#800000">1</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">6</font><font color="#000080">,  </font><font color="#800000">5</font><font color="#000080">,
      </font><font color="#800000">5</font><font color="#000080">,  </font><font color="#800000">6</font><font color="#000080">,  </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">,
      </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,  </font><font color="#800000">8</font><font color="#000080">,  </font><font color="#800000">7</font><font color="#000080">,
      </font><font color="#800000">6</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,  </font><font color="#800000">4</font><font color="#000080">,  </font><font color="#800000">9</font><font color="#000080">,
      </font><font color="#800000">8</font><font color="#000080">,  </font><font color="#800000">8</font><font color="#000080">,  </font><font color="#800000">9</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">,
      </font><font color="#800000">7</font><font color="#000080">,  </font><font color="#800000">4</font><font color="#000080">,  </font><font color="#800000">1</font><font color="#000080">,  </font><font color="#800000">5</font><font color="#000080">,
     </font><font color="#800000">10</font><font color="#000080">,  </font><font color="#800000">9</font><font color="#000080">,  </font><font color="#800000">4</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,
      </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,
     </font><font color="#800000">13</font><font color="#000080">, </font><font color="#800000">14</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">,
     </font><font color="#800000">17</font><font color="#000080">, </font><font color="#800000">18</font><font color="#000080">, </font><font color="#800000">19</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">,
     </font><font color="#800000">21</font><font color="#000080">, </font><font color="#800000">22</font><font color="#000080">, </font><font color="#800000">23</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,
     </font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">26</font><font color="#000080">, </font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">,
     </font><font color="#800000">29</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">, </font><font color="#800000">31</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,
     </font><font color="#800000">33</font><font color="#000080">, </font><font color="#800000">34</font><font color="#000080">, </font><font color="#800000">35</font><font color="#000080">, </font><font color="#800000">36</font><font color="#000080">,
     </font><font color="#800000">37</font><font color="#000080">, </font><font color="#800000">38</font><font color="#000080">, </font><font color="#800000">39</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">,
     </font><font color="#800000">41</font><font color="#000080">, </font><font color="#800000">42</font><font color="#000080">, </font><font color="#800000">43</font><font color="#000080">, </font><font color="#800000">44</font><font color="#000080">,
     </font><font color="#800000">45</font><font color="#000080">, </font><font color="#800000">46</font><font color="#000080">, </font><font color="#800000">47</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,
     </font><font color="#800000">49</font><font color="#000080">, </font><font color="#800000">50</font><font color="#000080">, </font><font color="#800000">51</font><font color="#000080">, </font><font color="#800000">52</font><font color="#000080">,
     </font><font color="#800000">53</font><font color="#000080">, </font><font color="#800000">54</font><font color="#000080">, </font><font color="#800000">55</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,
     </font><font color="#800000">57</font><font color="#000080">, </font><font color="#800000">58</font><font color="#000080">, </font><font color="#800000">59</font><font color="#000080">);

  </font>stervert <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>vector3 <font color="#000080">=
    ((</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">),
     (</font>x <font color="#000080">: -</font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>z <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">));

</font><font color="#FF0000"><b>Procedure </b></font>cubesetup<font color="#000080">(</font>c <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>cube<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>pirasetup<font color="#000080">(</font>c <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>piramid<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>huissetup<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>huis<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>hollow<font color="#000080">(</font>P1 <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>stersetup<font color="#000080">(</font>col <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>ster<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">; </font>d <font color="#000080">: </font>Real<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>ellips<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">; </font>col <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>goblet<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">; </font>col <font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Procedure </b></font>cubesetup<font color="#000080">(</font>c <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#008000"><i>{ zet kubusdata in facetlist van de scene}
</i></font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">6 </font><font color="#FF0000"><b>DO
  begin
    For </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>DO
      </b></font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font>j<font color="#000080">] := </font>cubefacet<font color="#000080">[</font>i<font color="#000080">, </font>j<font color="#000080">] + </font>nov<font color="#000080">;
    </font>nof <font color="#000080">:= </font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>facfront<font color="#000080">[</font>nof<font color="#000080">] := </font>last<font color="#000080">;
    </font>colour<font color="#000080">[</font>nof<font color="#000080">]   := </font>c<font color="#000080">;
    </font>nfac<font color="#000080">[</font>nof<font color="#000080">]     := </font>nof<font color="#000080">;
    </font>super<font color="#000080">[</font>nof<font color="#000080">]    := </font><font color="#800000">0</font><font color="#000080">;
    </font>firstsup<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
    </font>size<font color="#000080">[</font>nof<font color="#000080">]     := </font><font color="#800000">4</font><font color="#000080">;
    </font>last <font color="#000080">:= </font>last <font color="#000080">+ </font>size<font color="#000080">[</font>nof<font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>cube<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>DO
  begin
    </b></font>nov <font color="#000080">:= </font>nov <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>transform<font color="#000080">(</font>cubevert<font color="#000080">[</font>i<font color="#000080">], </font>P<font color="#000080">, </font>act<font color="#000080">[</font>nov<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>pirasetup<font color="#000080">(</font>c <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>DO
  begin
    For </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>DO
      </b></font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font>j<font color="#000080">] := </font>pirafacet<font color="#000080">[</font>i<font color="#000080">, </font>j<font color="#000080">] + </font>nov<font color="#000080">;
    </font>nof <font color="#000080">:= </font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>facfront<font color="#000080">[</font>nof<font color="#000080">] := </font>last<font color="#000080">;
    </font>size<font color="#000080">[</font>nof<font color="#000080">]     := </font><font color="#800000">3</font><font color="#000080">;
    </font>last          <font color="#000080">:= </font>last <font color="#000080">+ </font>size<font color="#000080">[</font>nof<font color="#000080">];
    </font>colour<font color="#000080">[</font>nof<font color="#000080">]   := </font>c<font color="#000080">;
    </font>nfac<font color="#000080">[</font>nof<font color="#000080">]     := </font>nof<font color="#000080">;
    </font>super<font color="#000080">[</font>nof<font color="#000080">]    := </font><font color="#800000">0</font><font color="#000080">;
    </font>firstsup<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>size<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;
  </font>faclist<font color="#000080">[</font>facfront<font color="#000080">[</font>nof<font color="#000080">] + </font><font color="#800000">4</font><font color="#000080">] := </font><font color="#800000">2 </font><font color="#000080">+ </font>nov<font color="#000080">;
  </font>last <font color="#000080">:= </font>last <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>piramid<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>DO
  begin
    </b></font>nov <font color="#000080">:= </font>nov <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>transform<font color="#000080">(</font>piravert<font color="#000080">[</font>i<font color="#000080">], </font>P<font color="#000080">, </font>act<font color="#000080">[</font>nov<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>huissetup<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j<font color="#000080">,
  </font>host<font color="#000080">,
  </font>nofstore <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">79 </font><font color="#FF0000"><b>DO
    </b></font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font>i<font color="#000080">] := </font>huisfacet<font color="#000080">[</font>i<font color="#000080">] + </font>nov<font color="#000080">;

  </font>nofstore <font color="#000080">:= </font>nof<font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">19 </font><font color="#FF0000"><b>DO
  begin
    </b></font>nof           <font color="#000080">:= </font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>facfront<font color="#000080">[</font>nof<font color="#000080">] := </font>last<font color="#000080">;
    </font>size<font color="#000080">[</font>nof<font color="#000080">]     := </font>huissize<font color="#000080">[</font>i<font color="#000080">];
    </font>last          <font color="#000080">:= </font>last <font color="#000080">+ </font>size<font color="#000080">[</font>nof<font color="#000080">];
    </font>nfac<font color="#000080">[</font>nof<font color="#000080">]     := </font>nof<font color="#000080">;

    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>i <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>i <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>colour<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">111
    </font><font color="#FF0000"><b>else
    if </b></font>i <font color="#000080">= </font><font color="#800000">7 </font><font color="#FF0000"><b>then
      </b></font>colour<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">20
    </font><font color="#FF0000"><b>else
    if </b></font>i <font color="#000080">&lt; </font><font color="#800000">8 </font><font color="#FF0000"><b>then
      </b></font>colour<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">42
    </font><font color="#FF0000"><b>else
      </b></font>colour<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">25</font><font color="#000080">;

    </font>super<font color="#000080">[</font>nof<font color="#000080">] := </font>huissuper<font color="#000080">[</font>i<font color="#000080">];
    </font>firstsup<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;

    </font><font color="#FF0000"><b>if </b></font>super<font color="#000080">[</font>nof<font color="#000080">] &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>host <font color="#000080">:= </font>super<font color="#000080">[</font>nof<font color="#000080">] + </font>nofstore<font color="#000080">;
      </font>super<font color="#000080">[</font>nof<font color="#000080">] := </font>host<font color="#000080">;
      </font>pushfacet<font color="#000080">(</font>firstsup<font color="#000080">[</font>host<font color="#000080">], </font>nof<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i  <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">59 </font><font color="#FF0000"><b>DO
    </b></font>setup<font color="#000080">[</font>i<font color="#000080">] := </font>huisvert<font color="#000080">[</font>i<font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>huis<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">59 </font><font color="#FF0000"><b>DO
  begin
    </b></font>nov <font color="#000080">:= </font>nov <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>transform<font color="#000080">(</font>setup<font color="#000080">[</font>i<font color="#000080">], </font>P<font color="#000080">, </font>act<font color="#000080">[</font>nov<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>hollow<font color="#000080">(</font>P1 <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>A<font color="#000080">, </font>B<font color="#000080">,
  </font>P<font color="#000080">, </font>P2 <font color="#000080">: </font>matrix4x4<font color="#000080">;
  </font>i     <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>DO
  begin
    </b></font>tran3<font color="#000080">(</font><font color="#800000">4.0 </font><font color="#000080">* </font>cubevert<font color="#000080">[</font>i<font color="#000080">].</font>x<font color="#000080">, </font><font color="#800000">4.0 </font><font color="#000080">* </font>cubevert<font color="#000080">[</font>i<font color="#000080">].</font>y<font color="#000080">, </font><font color="#800000">4.0 </font><font color="#000080">* </font>cubevert<font color="#000080">[</font>i<font color="#000080">].</font>z<font color="#000080">, </font>P2<font color="#000080">);
    </font>mult3<font color="#000080">(</font>P1<font color="#000080">, </font>P2<font color="#000080">, </font>P<font color="#000080">);
    </font>cube<font color="#000080">(</font>P<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>DO
  begin
    </b></font>scale3<font color="#000080">(</font><font color="#800000">3.0</font><font color="#000080">, </font><font color="#800000">1.0</font><font color="#000080">, </font><font color="#800000">1.0</font><font color="#000080">, </font>A<font color="#000080">);
    </font>tran3<font color="#000080">(</font><font color="#800000">0.0</font><font color="#000080">, </font><font color="#800000">4.0 </font><font color="#000080">* </font>cubevert<font color="#000080">[</font>i<font color="#000080">].</font>y<font color="#000080">, </font><font color="#800000">4.0 </font><font color="#000080">* </font>cubevert<font color="#000080">[</font>i<font color="#000080">].</font>z<font color="#000080">, </font>B<font color="#000080">);
    </font>mult3<font color="#000080">(</font>A<font color="#000080">, </font>B<font color="#000080">, </font>P2<font color="#000080">);</font>mult3<font color="#000080">(</font>P1<font color="#000080">, </font>P2<font color="#000080">, </font>P<font color="#000080">);
    </font>cube<font color="#000080">(</font>P<font color="#000080">);
    </font>scale3<font color="#000080">(</font><font color="#800000">1.0</font><font color="#000080">, </font><font color="#800000">3.0</font><font color="#000080">, </font><font color="#800000">1.0</font><font color="#000080">, </font>A<font color="#000080">);
    </font>tran3<font color="#000080">(</font><font color="#800000">4.0 </font><font color="#000080">* </font>cubevert<font color="#000080">[</font>i<font color="#000080">].</font>y<font color="#000080">, </font><font color="#800000">0.0</font><font color="#000080">, </font><font color="#800000">4.0 </font><font color="#000080">* </font>cubevert<font color="#000080">[</font>i<font color="#000080">].</font>z<font color="#000080">, </font>B<font color="#000080">);
    </font>mult3<font color="#000080">(</font>A<font color="#000080">, </font>B<font color="#000080">, </font>P2<font color="#000080">);</font>mult3<font color="#000080">(</font>P1<font color="#000080">, </font>P2<font color="#000080">, </font>P<font color="#000080">);
    </font>cube<font color="#000080">(</font>P<font color="#000080">);
    </font>scale3<font color="#000080">(</font><font color="#800000">1.0</font><font color="#000080">, </font><font color="#800000">1.0</font><font color="#000080">, </font><font color="#800000">3.0</font><font color="#000080">, </font>A<font color="#000080">);
    </font>tran3<font color="#000080">(</font><font color="#800000">4.0 </font><font color="#000080">* </font>cubevert<font color="#000080">[</font>i<font color="#000080">].</font>z<font color="#000080">, </font><font color="#800000">4.0 </font><font color="#000080">* </font>cubevert<font color="#000080">[</font>i<font color="#000080">].</font>y<font color="#000080">, </font><font color="#800000">0.0</font><font color="#000080">, </font>B<font color="#000080">);
    </font>mult3<font color="#000080">(</font>A<font color="#000080">, </font>B<font color="#000080">, </font>P2<font color="#000080">);</font>mult3<font color="#000080">(</font>P1<font color="#000080">, </font>P2<font color="#000080">, </font>P<font color="#000080">);
    </font>cube<font color="#000080">(</font>P<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>stersetup<font color="#000080">(</font>col <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j<font color="#000080">,
  </font>v1<font color="#000080">, </font>v2 <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">6 </font><font color="#FF0000"><b>DO
  begin
    </b></font>v1 <font color="#000080">:= </font>cubefacet<font color="#000080">[</font>i<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">] + </font>nov<font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>DO
    begin
      </b></font>v2  <font color="#000080">:= </font>cubefacet<font color="#000080">[</font>i<font color="#000080">, </font>j<font color="#000080">] + </font>nov<font color="#000080">;
      </font>nof <font color="#000080">:= </font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>v1<font color="#000080">;
      </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font>v2<font color="#000080">;
      </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">] := </font>nov <font color="#000080">+ </font><font color="#800000">8 </font><font color="#000080">+ </font>i<font color="#000080">;
      </font>facfront<font color="#000080">[</font>nof<font color="#000080">]     := </font>last<font color="#000080">;
      </font>size<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">3</font><font color="#000080">;

      </font>last <font color="#000080">:= </font>last <font color="#000080">+ </font>size<font color="#000080">[</font>nof<font color="#000080">];
      </font>colour<font color="#000080">[</font>nof<font color="#000080">] := </font>col<font color="#000080">;
      </font>nfac<font color="#000080">[</font>nof<font color="#000080">]   := </font>nof<font color="#000080">;
      </font>super<font color="#000080">[</font>nof<font color="#000080">]  := </font><font color="#800000">0</font><font color="#000080">;
      </font>firstsup<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
      </font>v1 <font color="#000080">:= </font>v2<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ster<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">; </font>d <font color="#000080">: </font>Real<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j<font color="#000080">,
  </font>v1<font color="#000080">, </font>v2 <font color="#000080">: </font>Integer<font color="#000080">;
  </font>A<font color="#000080">, </font>S   <font color="#000080">: </font>matrix4x4<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>DO
  begin
    </b></font>nov <font color="#000080">:= </font>nov <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>transform<font color="#000080">(</font>cubevert<font color="#000080">[</font>i<font color="#000080">], </font>P<font color="#000080">, </font>act<font color="#000080">[</font>nov<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>scale3<font color="#000080">(</font>D<font color="#000080">, </font>D<font color="#000080">, </font>D<font color="#000080">, </font>A<font color="#000080">);
  </font>mult3<font color="#000080">(</font>A<font color="#000080">, </font>P<font color="#000080">, </font>S<font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">6 </font><font color="#FF0000"><b>DO
  begin
    </b></font>nov <font color="#000080">:= </font>nov <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>transform<font color="#000080">(</font>stervert<font color="#000080">[</font>i<font color="#000080">], </font>S<font color="#000080">, </font>act<font color="#000080">[</font>nov<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ellips<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">; </font>col <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>v <font color="#000080">: </font>vector2Array<font color="#000080">;
  </font>theta<font color="#000080">,
  </font>thetadiff<font color="#000080">,
  </font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>theta <font color="#000080">:= -</font><font color="#800000">90</font><font color="#000080">;
  </font>thetadiff <font color="#000080">:= -</font><font color="#800000">9</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO
  begin
    </b></font>v<font color="#000080">[</font>i<font color="#000080">].</font>x <font color="#000080">:= </font>cosin<font color="#000080">(</font>theta<font color="#000080">);
    </font>v<font color="#000080">[</font>i<font color="#000080">].</font>y <font color="#000080">:= </font>sinus<font color="#000080">(</font>theta<font color="#000080">);
    </font>theta  <font color="#000080">:= </font>theta <font color="#000080">+ </font>thetadiff<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>bodyofrev<font color="#000080">(</font>P<font color="#000080">, </font>col<font color="#000080">, </font><font color="#800000">21</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font>v<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>goblet<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">; </font>col <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Const
  </b></font>gobletdat <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>vector2 <font color="#000080">=
    ((</font>x <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">: -</font><font color="#800000">16</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">8</font><font color="#000080">; </font>y <font color="#000080">: -</font><font color="#800000">16</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">8</font><font color="#000080">; </font>y <font color="#000080">: -</font><font color="#800000">15</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">: -</font><font color="#800000">15</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">; </font>y <font color="#000080">:  -</font><font color="#800000">2</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">6</font><font color="#000080">; </font>y <font color="#000080">:  -</font><font color="#800000">1</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">8</font><font color="#000080">; </font>y <font color="#000080">:   </font><font color="#800000">2</font><font color="#000080">),
     (</font>x <font color="#000080">: </font><font color="#800000">14</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">14</font><font color="#000080">),
     (</font>x <font color="#000080">: </font><font color="#800000">13</font><font color="#000080">; </font>y <font color="#000080">:  </font><font color="#800000">14</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">7</font><font color="#000080">; </font>y <font color="#000080">:   </font><font color="#800000">2</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">5</font><font color="#000080">; </font>y <font color="#000080">:   </font><font color="#800000">0</font><font color="#000080">),
     (</font>x <font color="#000080">:  </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">:   </font><font color="#800000">0</font><font color="#000080">));

</font><font color="#FF0000"><b>Var
  </b></font>gobl <font color="#000080">: </font>vector2Array<font color="#000080">;
  </font>i    <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>DO
    </b></font>gobl<font color="#000080">[</font>i<font color="#000080">] := </font>gobletdat<font color="#000080">[</font>i<font color="#000080">];
  </font>bodyofrev<font color="#000080">(</font>P<font color="#000080">, </font>col<font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font>gobl<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font><font color="#008000"><i>{ &plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn; }

</i></font><font color="#FF0000"><b>Unit </b></font>ddprocs<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses
  </b></font>DDVars<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>maxv <font color="#000080">= </font><font color="#800000">200</font><font color="#000080">;
  </font>maxf <font color="#000080">= </font><font color="#800000">400</font><font color="#000080">;
  </font>maxlist <font color="#000080">= </font><font color="#800000">1000</font><font color="#000080">;
  </font>vectorArraysize  <font color="#000080">= </font><font color="#800000">32</font><font color="#000080">;
  </font>sizeofpixelArray <font color="#000080">= </font><font color="#800000">3200</font><font color="#000080">;
  </font>sizeofhlineArray <font color="#000080">= </font><font color="#800000">320 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>vector2      <font color="#000080">= </font><font color="#FF0000"><b>Record </b></font>x<font color="#000080">, </font>y <font color="#000080">: </font>Real<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>vector3      <font color="#000080">= </font><font color="#FF0000"><b>Record </b></font>x<font color="#000080">, </font>y<font color="#000080">, </font>z <font color="#000080">: </font>Real<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>pixelvector  <font color="#000080">= </font><font color="#FF0000"><b>Record </b></font>x<font color="#000080">, </font>y <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>pixelArray   <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>sizeofpixelArray<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;
  </font>hlineArray   <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>sizeofhlineArray<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;
  </font>vector3Array <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>vectorArraysize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>vector3<font color="#000080">;
  </font>matrix3x3    <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Real<font color="#000080">;
  </font>matrix4x4    <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Real<font color="#000080">;
  </font>vertex3Array <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>maxv<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>vector3<font color="#000080">;
  </font>vertex2Array <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>maxv<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>vector2<font color="#000080">;
  </font>vector2Array <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>vectorArraysize <font color="#000080">] </font><font color="#FF0000"><b>of </b></font>vector2<font color="#000080">;
  </font>facetArray   <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>maxf<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;
  </font>facetlist    <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>maxlist<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>EenheidsM <font color="#000080">: </font>matrix4x4 <font color="#000080">=
    ((</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">),
     (</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">),
     (</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">),
     (</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">));
</font><font color="#FF0000"><b>Var
  </b></font>Q           <font color="#000080">: </font>matrix4x4<font color="#000080">;
  </font>eye<font color="#000080">, </font>direct <font color="#000080">: </font>vector3<font color="#000080">;
  </font>nov<font color="#000080">, </font>ntv<font color="#000080">,
  </font>ntf<font color="#000080">, </font>nof<font color="#000080">,
  </font>last        <font color="#000080">: </font>Integer<font color="#000080">;
  </font>setup<font color="#000080">,
  </font>act<font color="#000080">, </font>obs    <font color="#000080">: </font>vertex3Array<font color="#000080">;
  </font>pro         <font color="#000080">: </font>vertex2Array<font color="#000080">;
  </font>faclist     <font color="#000080">: </font>facetlist<font color="#000080">;
  </font>colour<font color="#000080">,
  </font>size<font color="#000080">,
  </font>facfront<font color="#000080">,
  </font>nfac<font color="#000080">,
  </font>super<font color="#000080">,
  </font>firstsup    <font color="#000080">: </font>facetArray<font color="#000080">;
  </font>points<font color="#000080">,
  </font>prevpoints  <font color="#000080">: </font>pixelArray<font color="#000080">;
  </font>hline<font color="#000080">,
  </font>prevhline   <font color="#000080">: </font>hlineArray<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>tran3<font color="#000080">(</font>tx<font color="#000080">, </font>ty<font color="#000080">, </font>tz <font color="#000080">: </font>Real<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>A <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>scale3<font color="#000080">(</font>sx<font color="#000080">, </font>sy<font color="#000080">, </font>sz <font color="#000080">: </font>Real<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>A <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>rot3<font color="#000080">(</font>m <font color="#000080">: </font>Integer<font color="#000080">; </font>theta <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>A <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>mult3<font color="#000080">(</font>A<font color="#000080">, </font>B <font color="#000080">: </font>matrix4x4<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>C <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>findQ<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>genrot<font color="#000080">(</font>phi <font color="#000080">: </font>Integer<font color="#000080">; </font>b<font color="#000080">, </font>d <font color="#000080">: </font>vector3<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>A <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>transform<font color="#000080">(</font>v <font color="#000080">: </font>vector3<font color="#000080">; </font>A <font color="#000080">: </font>matrix4x4<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>w <font color="#000080">: </font>vector3<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>extrude<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">; </font>d <font color="#000080">: </font>Real<font color="#000080">; </font>col<font color="#000080">, </font>n <font color="#000080">: </font>Integer<font color="#000080">;
                  </font>v <font color="#000080">: </font>vector2Array<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>bodyofrev<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">; </font>col<font color="#000080">, </font>nvert<font color="#000080">, </font>nhoriz <font color="#000080">: </font>Integer<font color="#000080">;
                    </font>v <font color="#000080">: </font>vector2Array<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>polydraw<font color="#000080">(</font>c<font color="#000080">, </font>n <font color="#000080">: </font>Integer<font color="#000080">; </font>poly <font color="#000080">: </font>vector2Array<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>linepto<font color="#000080">(</font>c <font color="#000080">: </font>Integer<font color="#000080">; </font>pt1<font color="#000080">, </font>pt2 <font color="#000080">: </font>vector2<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>WisScherm<font color="#000080">(</font>punten <font color="#000080">: </font>pixelArray<font color="#000080">; </font>SchermSeg<font color="#000080">, </font>VirSeg <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>fillpoly<font color="#000080">(</font>c<font color="#000080">, </font>n <font color="#000080">: </font>Integer<font color="#000080">; </font>poly <font color="#000080">: </font>vector2Array<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Wis_Hline<font color="#000080">(</font>hline_ar <font color="#000080">: </font>hlineArray<font color="#000080">; </font>virseg <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Procedure </b></font>tran3<font color="#000080">(</font>tx<font color="#000080">, </font>ty<font color="#000080">, </font>tz <font color="#000080">: </font>Real<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>A <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#008000"><i>{ zet matrix A op punt tx, ty, tz }
</i></font><font color="#FF0000"><b>begin
  </b></font>A <font color="#000080">:= </font>EenheidsM<font color="#000080">;
  </font>A<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">] := -</font>tx<font color="#000080">;
  </font>A<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">] := -</font>ty<font color="#000080">;
  </font>A<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">] := -</font>tz<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>scale3<font color="#000080">(</font>sx<font color="#000080">, </font>sy<font color="#000080">, </font>sz <font color="#000080">: </font>Real<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>A <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#008000"><i>{ zet matrix A om in schaal van sx, sy, sz }
</i></font><font color="#FF0000"><b>begin
  </b></font>A <font color="#000080">:= </font>EenheidsM<font color="#000080">;
  </font>A<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">] := </font>sx<font color="#000080">;
  </font>A<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">] := </font>sy<font color="#000080">;
  </font>A<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">] := </font>sz<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>rot3<font color="#000080">(</font>m <font color="#000080">: </font>Integer<font color="#000080">; </font>theta <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>A <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#008000"><i>{ roteer matrix A om m: 1=x-as; 2=y-as; 3=z-as met hoek theta (in graden)}
</i></font><font color="#FF0000"><b>Var
  </b></font>m1<font color="#000080">, </font>m2 <font color="#000080">: </font>Integer<font color="#000080">;
  </font>c<font color="#000080">, </font>s   <font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>A  <font color="#000080">:= </font>EenheidsM<font color="#000080">;
  </font>m1 <font color="#000080">:= (</font>m <font color="#FF0000"><b>MOD </b></font><font color="#800000">3</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
  </font>m2 <font color="#000080">:= (</font>m1 <font color="#FF0000"><b>MOD </b></font><font color="#800000">3</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
  </font>c  <font color="#000080">:= </font>cosin<font color="#000080">(</font>theta<font color="#000080">);
  </font>s  <font color="#000080">:= </font>sinus<font color="#000080">(</font>theta<font color="#000080">);
  </font>A<font color="#000080">[</font>m1<font color="#000080">, </font>m1<font color="#000080">] := </font>c<font color="#000080">;
  </font>A<font color="#000080">[</font>m2<font color="#000080">, </font>m2<font color="#000080">] := </font>c<font color="#000080">;
  </font>A<font color="#000080">[</font>m1<font color="#000080">, </font>m2<font color="#000080">] := </font>s<font color="#000080">;
  </font>A<font color="#000080">[</font>m2<font color="#000080">, </font>m1<font color="#000080">] := -</font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>mult3<font color="#000080">(</font>A<font color="#000080">, </font>B <font color="#000080">: </font>matrix4x4<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>C <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#008000"><i>{ vermenigvuldigd matrix A en B naar matrix C }
</i></font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j<font color="#000080">, </font>k <font color="#000080">: </font>Integer<font color="#000080">;
  </font>ab      <font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
    For </b></font>j <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
    begin
      </b></font>ab <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
        </b></font>ab <font color="#000080">:= </font>ab <font color="#000080">+ </font>A<font color="#000080">[</font>i<font color="#000080">, </font>k<font color="#000080">] * </font>B<font color="#000080">[</font>k<font color="#000080">, </font>j<font color="#000080">];
      </font>C<font color="#000080">[</font>i<font color="#000080">, </font>j<font color="#000080">] := </font>ab<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>findQ<font color="#000080">;
</font><font color="#008000"><i>{ Bereken de Observatie-matrix 'Q' voor een punt in de ruimte }
</i></font><font color="#FF0000"><b>Var
  </b></font>E<font color="#000080">, </font>F<font color="#000080">, </font>G<font color="#000080">,
  </font>H<font color="#000080">, </font>U    <font color="#000080">: </font>matrix4x4<font color="#000080">;
  </font>alpha<font color="#000080">,
  </font>beta<font color="#000080">,
  </font>gamma   <font color="#000080">: </font>Integer<font color="#000080">;
  </font>v<font color="#000080">, </font>w    <font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>tran3<font color="#000080">(</font>eye<font color="#000080">.</font>x<font color="#000080">, </font>eye<font color="#000080">.</font>y<font color="#000080">, </font>eye<font color="#000080">.</font>z<font color="#000080">, </font>F<font color="#000080">);

  </font>alpha <font color="#000080">:= </font>angle<font color="#000080">(-</font>direct<font color="#000080">.</font>x<font color="#000080">, -</font>direct<font color="#000080">.</font>y<font color="#000080">);
  </font>rot3<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">, </font>alpha<font color="#000080">, </font>G<font color="#000080">);

  </font>v <font color="#000080">:=  </font>sqrt<font color="#000080">( (</font>direct<font color="#000080">.</font>x <font color="#000080">* </font>direct<font color="#000080">.</font>x<font color="#000080">) + (</font>direct<font color="#000080">.</font>y <font color="#000080">* </font>direct<font color="#000080">.</font>y<font color="#000080">));
  </font>beta <font color="#000080">:= </font>angle<font color="#000080">(-</font>direct<font color="#000080">.</font>z<font color="#000080">, </font>v<font color="#000080">);
  </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>beta<font color="#000080">, </font>H<font color="#000080">);

  </font>w <font color="#000080">:=  </font>sqrt<font color="#000080">( (</font>v <font color="#000080">* </font>v<font color="#000080">) + (</font>direct<font color="#000080">.</font>z <font color="#000080">* </font>direct<font color="#000080">.</font>z<font color="#000080">));
  </font>gamma <font color="#000080">:= </font>angle<font color="#000080">( -</font>direct<font color="#000080">.</font>x <font color="#000080">* </font>w<font color="#000080">,  </font>direct<font color="#000080">.</font>y <font color="#000080">* </font>direct<font color="#000080">.</font>z<font color="#000080">);
  </font>rot3<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">, </font>gamma<font color="#000080">, </font>U<font color="#000080">);

  </font>mult3<font color="#000080">(</font>G<font color="#000080">, </font>F<font color="#000080">, </font>Q<font color="#000080">);
  </font>mult3<font color="#000080">(</font>H<font color="#000080">, </font>Q<font color="#000080">, </font>E<font color="#000080">);
  </font>mult3<font color="#000080">(</font>U<font color="#000080">, </font>E<font color="#000080">, </font>Q<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>genrot <font color="#000080">(</font>phi <font color="#000080">: </font>Integer<font color="#000080">; </font>b<font color="#000080">, </font>d <font color="#000080">: </font>vector3<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>A <font color="#000080">: </font>matrix4x4<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>F<font color="#000080">, </font>G<font color="#000080">, </font>H<font color="#000080">,
  </font>W<font color="#000080">, </font>FI<font color="#000080">, </font>GI<font color="#000080">,
  </font>HI<font color="#000080">, </font>S<font color="#000080">, </font>T  <font color="#000080">: </font>matrix4x4<font color="#000080">;
  </font>v         <font color="#000080">: </font>Real<font color="#000080">;
  </font>beta<font color="#000080">,
  </font>theta     <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>tran3<font color="#000080">(</font>b<font color="#000080">.</font>x<font color="#000080">, </font>b<font color="#000080">.</font>y<font color="#000080">, </font>b<font color="#000080">.</font>z<font color="#000080">, </font>F<font color="#000080">);
  </font>tran3<font color="#000080">(-</font>b<font color="#000080">.</font>x<font color="#000080">, -</font>b<font color="#000080">.</font>y<font color="#000080">, -</font>b<font color="#000080">.</font>z<font color="#000080">, </font>FI<font color="#000080">);
  </font>theta <font color="#000080">:= </font>angle<font color="#000080">(</font>d<font color="#000080">.</font>x<font color="#000080">, </font>d<font color="#000080">.</font>y<font color="#000080">);
  </font>rot3<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">, </font>theta<font color="#000080">, </font>G<font color="#000080">);
  </font>rot3<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">, -</font>theta<font color="#000080">, </font>GI<font color="#000080">);
  </font>v <font color="#000080">:= </font>sqrt<font color="#000080">(</font>d<font color="#000080">.</font>x <font color="#000080">* </font>d<font color="#000080">.</font>x <font color="#000080">+ </font>d<font color="#000080">.</font>y <font color="#000080">* </font>d<font color="#000080">.</font>y<font color="#000080">);
  </font>beta <font color="#000080">:= </font>angle<font color="#000080">(</font>d<font color="#000080">.</font>z<font color="#000080">, </font>v<font color="#000080">);
  </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>beta<font color="#000080">, </font>H<font color="#000080">);
  </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, -</font>beta<font color="#000080">, </font>HI<font color="#000080">);
  </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>beta<font color="#000080">, </font>H<font color="#000080">);
  </font>rot3<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, -</font>beta<font color="#000080">, </font>HI<font color="#000080">);
  </font>rot3<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">, </font>phi<font color="#000080">, </font>W<font color="#000080">);
  </font>mult3<font color="#000080">(</font>G<font color="#000080">, </font>F<font color="#000080">, </font>S<font color="#000080">);
  </font>mult3<font color="#000080">(</font>H<font color="#000080">, </font>S<font color="#000080">, </font>T<font color="#000080">);
  </font>mult3<font color="#000080">(</font>W<font color="#000080">, </font>S<font color="#000080">, </font>T<font color="#000080">);
  </font>mult3<font color="#000080">(</font>HI<font color="#000080">, </font>S<font color="#000080">, </font>T<font color="#000080">);
  </font>mult3<font color="#000080">(</font>GI<font color="#000080">, </font>T<font color="#000080">, </font>S<font color="#000080">);
  </font>mult3<font color="#000080">(</font>FI<font color="#000080">, </font>S<font color="#000080">, </font>A<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>transform<font color="#000080">(</font>v <font color="#000080">: </font>vector3<font color="#000080">; </font>A <font color="#000080">: </font>matrix4x4<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>w <font color="#000080">: </font>vector3<font color="#000080">);
</font><font color="#008000"><i>{ transformeer colomvector 'v' uit A in colomvector 'w'}
</i></font><font color="#FF0000"><b>begin
  </b></font>w<font color="#000080">.</font>x <font color="#000080">:= </font>A<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">] * </font>v<font color="#000080">.</font>x <font color="#000080">+ </font>A<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">] * </font>v<font color="#000080">.</font>y <font color="#000080">+ </font>A<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">] * </font>v<font color="#000080">.</font>z <font color="#000080">+ </font>A<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">];
  </font>w<font color="#000080">.</font>y <font color="#000080">:= </font>A<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">] * </font>v<font color="#000080">.</font>x <font color="#000080">+ </font>A<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">] * </font>v<font color="#000080">.</font>y <font color="#000080">+ </font>A<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">] * </font>v<font color="#000080">.</font>z <font color="#000080">+ </font>A<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">];
  </font>w<font color="#000080">.</font>z <font color="#000080">:= </font>A<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">] * </font>v<font color="#000080">.</font>x <font color="#000080">+ </font>A<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">] * </font>v<font color="#000080">.</font>y <font color="#000080">+ </font>A<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">] * </font>v<font color="#000080">.</font>z <font color="#000080">+ </font>A<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>extrude<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">; </font>d <font color="#000080">: </font>Real<font color="#000080">; </font>col<font color="#000080">, </font>n <font color="#000080">: </font>Integer<font color="#000080">;
                  </font>v <font color="#000080">: </font>vector2Array<font color="#000080">);
</font><font color="#008000"><i>{ Maakt van een 2d-figuur een 3d-figuur }
{ vb: converteert 2d-letters naar 3d-letters }
</i></font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j<font color="#000080">,
  </font>lasti <font color="#000080">: </font>Integer<font color="#000080">;
  </font>v3    <font color="#000080">: </font>vector3<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>DO
  begin
    </b></font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font>i<font color="#000080">] := </font>nov <font color="#000080">+ </font>i<font color="#000080">;
    </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font>n <font color="#000080">+ </font>i<font color="#000080">] := </font>nov <font color="#000080">+ </font><font color="#800000">2 </font><font color="#000080">* </font>n <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">- </font>i<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>facfront<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>last<font color="#000080">;
  </font>facfront<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font>last <font color="#000080">+ </font>n<font color="#000080">;
  </font>size<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>n<font color="#000080">;
  </font>size<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font>n<font color="#000080">;
  </font>nfac<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>nfac<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font>nof <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
  </font>super<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
  </font>super<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
  </font>firstsup<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
  </font>firstsup<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
  </font>colour<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>col<font color="#000080">;
  </font>colour<font color="#000080">[</font>nof <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font>col<font color="#000080">;
  </font>last  <font color="#000080">:= </font>last <font color="#000080">+ </font><font color="#800000">2 </font><font color="#000080">* </font>n<font color="#000080">;
  </font>nof   <font color="#000080">:= </font>nof <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
  </font>lasti <font color="#000080">:= </font>n<font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>DO
  begin
    </b></font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>nov <font color="#000080">+ </font>i<font color="#000080">;
    </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font>nov <font color="#000080">+ </font>lasti<font color="#000080">;
    </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">] := </font>nov <font color="#000080">+ </font>n <font color="#000080">+ </font>lasti<font color="#000080">;
    </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">4</font><font color="#000080">] := </font>nov <font color="#000080">+ </font>n <font color="#000080">+ </font>i<font color="#000080">;
    </font>nof <font color="#000080">:= </font>nof <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">;
    </font>facfront<font color="#000080">[</font>nof<font color="#000080">] := </font>last<font color="#000080">;
    </font>size<font color="#000080">[</font>nof<font color="#000080">]     := </font><font color="#800000">4</font><font color="#000080">;
    </font>nfac<font color="#000080">[</font>nof<font color="#000080">]     := </font>nof<font color="#000080">;
    </font>super<font color="#000080">[</font>nof<font color="#000080">]    := </font><font color="#800000">0</font><font color="#000080">;
    </font>firstsup<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
    </font>colour<font color="#000080">[</font>nof<font color="#000080">]   := </font>col<font color="#000080">;
    </font>last  <font color="#000080">:= </font>last <font color="#000080">+ </font><font color="#800000">4</font><font color="#000080">;
    </font>lasti <font color="#000080">:= </font>i<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>n <font color="#FF0000"><b>DO
  begin
    </b></font>v3<font color="#000080">.</font>x <font color="#000080">:= </font>v<font color="#000080">[</font>i<font color="#000080">].</font>x<font color="#000080">;
    </font>v3<font color="#000080">.</font>y <font color="#000080">:= </font>v<font color="#000080">[</font>i<font color="#000080">].</font>y<font color="#000080">;
    </font>v3<font color="#000080">.</font>z <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
    </font>nov  <font color="#000080">:= </font>nov <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>transform<font color="#000080">(</font>v3<font color="#000080">, </font>P<font color="#000080">, </font>act<font color="#000080">[</font>nov<font color="#000080">]);
    </font>v3<font color="#000080">.</font>z <font color="#000080">:= -</font>d<font color="#000080">;
    </font>transform<font color="#000080">(</font>v3<font color="#000080">, </font>P<font color="#000080">, </font>act<font color="#000080">[</font>nov <font color="#000080">+ </font>n<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>nov <font color="#000080">:= </font>nov <font color="#000080">+ </font>n<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>bodyofrev<font color="#000080">(</font>P <font color="#000080">: </font>matrix4x4<font color="#000080">; </font>col<font color="#000080">, </font>nvert<font color="#000080">, </font>nhoriz <font color="#000080">: </font>Integer<font color="#000080">;
                    </font>v <font color="#000080">: </font>vector2Array<font color="#000080">);
</font><font color="#008000"><i>{ maakt een &quot;rond&quot; figuur van een 2-dimensionale omlijning van het figuur }
</i></font><font color="#FF0000"><b>Var
  </b></font>theta<font color="#000080">,
  </font>thetadiff<font color="#000080">,
  </font>i<font color="#000080">, </font>j<font color="#000080">, </font>newnov <font color="#000080">: </font>Integer<font color="#000080">;
  </font>c<font color="#000080">, </font>s         <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1 </font><font color="#000080">.. </font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Real<font color="#000080">;
  </font>index1<font color="#000080">,
  </font>index2       <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1 </font><font color="#000080">.. </font><font color="#800000">101</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>theta <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>thetadiff <font color="#000080">:= </font>trunc<font color="#000080">(</font><font color="#800000">360 </font><font color="#000080">/ </font>nhoriz<font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nhoriz <font color="#FF0000"><b>DO
  begin
    </b></font>c<font color="#000080">[</font>i<font color="#000080">]  := </font>cosin<font color="#000080">(</font>theta<font color="#000080">);
    </font>s<font color="#000080">[</font>i<font color="#000080">]  := </font>sinus<font color="#000080">(</font>theta<font color="#000080">);
    </font>theta <font color="#000080">:= </font>theta <font color="#000080">+ </font>thetadiff<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>newnov <font color="#000080">:= </font>nov<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>abs<font color="#000080">(</font>v<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>x<font color="#000080">) &lt; </font>epsilon  <font color="#FF0000"><b>then
  begin
    </b></font>newnov <font color="#000080">:= </font>newnov <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>x <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
    </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>y <font color="#000080">:= </font>v<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>y<font color="#000080">;
    </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>z <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nhoriz <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
      </b></font>index1<font color="#000080">[</font>i<font color="#000080">] := </font>newnov<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  begin
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nhoriz <font color="#FF0000"><b>DO
    begin
      </b></font>newnov <font color="#000080">:= </font>newnov <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>x <font color="#000080">:= </font>v<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>x <font color="#000080">* </font>c<font color="#000080">[</font>i<font color="#000080">];
      </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>y <font color="#000080">:= </font>v<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>y<font color="#000080">;
      </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>z <font color="#000080">:= -</font>v<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>x <font color="#000080">* </font>s<font color="#000080">[</font>i<font color="#000080">];
      </font>index1<font color="#000080">[</font>i<font color="#000080">] := </font>newnov<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>index1<font color="#000080">[</font>nhoriz <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>index1<font color="#000080">[</font>i<font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>j <font color="#000080">:=  </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>nvert <font color="#FF0000"><b>DO
  begin
    if </b></font>abs<font color="#000080">(</font>v<font color="#000080">[</font>j<font color="#000080">].</font>x<font color="#000080">) &lt; </font>epsilon <font color="#FF0000"><b>then
    begin
      </b></font>newnov <font color="#000080">:= </font>newnov <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>x <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
      </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>y <font color="#000080">:= </font>v<font color="#000080">[</font>j<font color="#000080">].</font>y<font color="#000080">;
      </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>z <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nhoriz <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
        </b></font>index2<font color="#000080">[</font>i<font color="#000080">] := </font>newnov<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
    begin
      For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>nhoriz <font color="#FF0000"><b>DO
      begin
        </b></font>newnov <font color="#000080">:= </font>newnov <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
        </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>x <font color="#000080">:=  </font>v<font color="#000080">[</font>j<font color="#000080">].</font>x <font color="#000080">* </font>c<font color="#000080">[</font>i<font color="#000080">];
        </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>y <font color="#000080">:=  </font>v<font color="#000080">[</font>j<font color="#000080">].</font>y<font color="#000080">;
        </font>setup<font color="#000080">[</font>newnov<font color="#000080">].</font>z <font color="#000080">:= -</font>v<font color="#000080">[</font>j<font color="#000080">].</font>x <font color="#000080">* </font>s<font color="#000080">[</font>i<font color="#000080">];
        </font>index2<font color="#000080">[</font>i<font color="#000080">] := </font>newnov<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>index2<font color="#000080">[</font>nhoriz <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>index2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>if </b></font>index1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font>index1<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>then
      if </b></font>index2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font>index2<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>then
      begin
        For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nhoriz <font color="#FF0000"><b>DO
        begin
          </b></font>nof <font color="#000080">:= </font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; </font>size<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">3</font><font color="#000080">;
          </font>facfront<font color="#000080">[</font>nof<font color="#000080">] := </font>last<font color="#000080">;
          </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>index1<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">];
          </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font>index2<font color="#000080">[</font>i<font color="#000080">];
          </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">] := </font>index1<font color="#000080">[</font>i<font color="#000080">];
          </font>last <font color="#000080">:= </font>last <font color="#000080">+ </font>size<font color="#000080">[</font>nof<font color="#000080">];
          </font>nfac<font color="#000080">[</font>nof<font color="#000080">]     := </font>nof<font color="#000080">;
          </font>colour<font color="#000080">[</font>nof<font color="#000080">]   := </font>col<font color="#000080">;
          </font>super<font color="#000080">[</font>nof<font color="#000080">]    := </font><font color="#800000">0</font><font color="#000080">;
          </font>firstsup<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end
      else
      begin
        For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nhoriz <font color="#FF0000"><b>DO
        begin
          </b></font>nof <font color="#000080">:= </font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
          </font>size<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;
          </font>facfront<font color="#000080">[</font>nof<font color="#000080">] := </font>last<font color="#000080">;
          </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>index1<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">];
          </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font>index2<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">];
          </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">] := </font>index2<font color="#000080">[</font>i<font color="#000080">];
          </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">4</font><font color="#000080">] := </font>index1<font color="#000080">[</font>i<font color="#000080">];
          </font>last <font color="#000080">:= </font>last <font color="#000080">+ </font>size<font color="#000080">[</font>nof<font color="#000080">];
          </font>nfac<font color="#000080">[</font>nof<font color="#000080">]     := </font>nof<font color="#000080">;
          </font>colour<font color="#000080">[</font>nof<font color="#000080">]   := </font>col<font color="#000080">;
          </font>super<font color="#000080">[</font>nof<font color="#000080">]    := </font><font color="#800000">0</font><font color="#000080">;
          </font>firstsup<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end
      else
      if </b></font>index2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font>index2<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>then
        For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nhoriz <font color="#FF0000"><b>DO
        begin
          </b></font>nof <font color="#000080">:= </font>nof <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
          </font>size<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">3</font><font color="#000080">;
          </font>facfront<font color="#000080">[</font>nof<font color="#000080">] := </font>last<font color="#000080">;
          </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>index2<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">];
          </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font>index2<font color="#000080">[</font>i<font color="#000080">];
          </font>faclist<font color="#000080">[</font>last <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">] := </font>index1<font color="#000080">[</font>i<font color="#000080">];
          </font>last <font color="#000080">:= </font>last <font color="#000080">+ </font>size<font color="#000080">[</font>nof<font color="#000080">];
          </font>nfac<font color="#000080">[</font>nof<font color="#000080">]     := </font>nof<font color="#000080">;
          </font>colour<font color="#000080">[</font>nof<font color="#000080">]   := </font>col<font color="#000080">;
          </font>super<font color="#000080">[</font>nof<font color="#000080">]    := </font><font color="#800000">0</font><font color="#000080">;
          </font>firstsup<font color="#000080">[</font>nof<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nhoriz <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
          </b></font>index1<font color="#000080">[</font>i<font color="#000080">] := </font>index2<font color="#000080">[</font>i<font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:=  </font>nov <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>newnov <font color="#FF0000"><b>DO
    </b></font>transform<font color="#000080">(</font>setup<font color="#000080">[</font>i<font color="#000080">], </font>P<font color="#000080">, </font>act<font color="#000080">[</font>i<font color="#000080">]);

  </font>nov <font color="#000080">:= </font>newnov<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>BressenHam<font color="#000080">( </font>Virseg <font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>{ Adres-&gt; VIRSEG:0 }
                      </i></font>pnts   <font color="#000080">: </font>pixelArray<font color="#000080">;
                      </font>c      <font color="#000080">: </font>Byte<font color="#000080">;          </font><font color="#008000"><i>{ c-&gt;     kleur    }
                      </i></font>p1<font color="#000080">, </font>p2 <font color="#000080">: </font>pixelvector<font color="#000080">);  </font><font color="#008000"><i>{ vector           } </i></font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>x<font color="#000080">, </font>y<font color="#000080">, </font>error<font color="#000080">,
  </font>s1<font color="#000080">,  </font>s2<font color="#000080">,
  </font>deltax<font color="#000080">,
  </font>deltay<font color="#000080">, </font>i   <font color="#000080">: </font>Integer<font color="#000080">;
  </font>interchange <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>dcolor      <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Asm
</b></font><font color="#008000"><i>{  initialize Variables  }
  </i></font><font color="#FF00FF">PUSH   ds
  LDS    si, pnts
  MOV    ax, virseg
  MOV    es, ax
  MOV    cx, 320
  MOV    ax, p1.x
  MOV    x,  ax
  MOV    ax, p1.y
  MOV    y, ax
  MOV    dcolor, ax

  MOV    ax, p2.x                </font><font color="#008000"><i>{ deltax := abs(x2 - x1) }
  </i></font><font color="#FF00FF">SUB    ax, p1.x                </font><font color="#008000"><i>{ s1 := sign(x2 - x1) }
  </i></font><font color="#FF00FF">PUSH   ax
  PUSH   ax
  CALL   ddVars.sign
  MOV    s1, ax;
  POP    ax
  TEST   ax, $8000
  JZ     @@GeenSIGN1
  NEG    ax
 @@GeenSign1:
  MOV    deltax, ax
  MOV    ax, p2.y
  SUB    ax, p1.y
  PUSH   ax
  PUSH   ax
  CALL   ddVars.sign
  MOV    s2, ax
  POP    ax
  TEST   ax, $8000
  JZ     @@GeenSign2
  NEG    ax
 @@GeenSign2:
  MOV    deltay, ax

 </font><font color="#008000"><i>{ Interchange DeltaX and DeltaY depending on the slope of the line }

  </i></font><font color="#FF00FF">MOV    interchange, False
  CMP    ax, deltax
  JNG    @@NO_INTERCHANGE
  XCHG   ax, deltax
  XCHG   ax, deltay
  MOV    interchange, True

 @@NO_INTERCHANGE:

  </font><font color="#008000"><i>{ Initialize the error term to compensate For a nonzero intercept }

  </i></font><font color="#FF00FF">MOV    ax, deltaY
  SHL    ax, 1
  SUB    ax, deltaX
  MOV    error, ax

  </font><font color="#008000"><i>{ Main loop }
  </i></font><font color="#FF00FF">MOV    ax, 1
  MOV    i, ax
 @@FOR_begin:
  CMP    ax, deltaX
  JG     @@EINDE_FOR_LOOP

  </font><font color="#008000"><i>{ Plot punt! }
  </i></font><font color="#FF00FF">MOV   bx, x
  MOV   ax, y
  MUL   cx
  ADD   bx, ax
  MOV   al, c
  MOV   Byte PTR [es:bx], al
  INC   [Word ptr ds:si]     </font><font color="#008000"><i>{ aantal verhogen }
  </i></font><font color="#FF00FF">MOV   ax, [si]
  SHL   ax, 1                </font><font color="#008000"><i>{ offset berekenen }
  </i></font><font color="#FF00FF">PUSH  si
  ADD   si, ax
  MOV   [si], bx
  POP   si

  </font><font color="#008000"><i>{ While Loop }
 </i></font><font color="#FF00FF">@@W1_begin:
  CMP    error, 0
  JL     @@EINDE_WHILE

  </font><font color="#008000"><i>{ if interchange then }

  </i></font><font color="#FF00FF">CMP    interchange, True
  JE     @@i_is_t
  MOV    ax, s2
  ADD    y, ax
  JMP    @@w1_eruit

 @@i_is_t:
  MOV    ax, s1
  ADD    x, ax

 @@w1_eruit:
  MOV    ax, deltax
  SHL    ax, 1
  SUB    error, ax
  JMP    @@w1_begin

 @@EINDE_WHILE:
  CMP    interchange, True
  JE     @@i_is_t_1
  MOV    ax, s1
  ADD    x, ax
  JMP    @@if_2_eruit

 @@i_is_t_1:
  MOV    ax, s2
  ADD    y, ax

 @@if_2_eruit:
  MOV    ax, deltay
  SHL    ax, 1
  ADD    error, ax
  INC    i
  MOV    ax, i
  JMP    @@FOR_begin
 @@Einde_for_loop:
  POP    ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>linepto<font color="#000080">(</font>c <font color="#000080">: </font>Integer<font color="#000080">; </font>pt1<font color="#000080">, </font>pt2 <font color="#000080">: </font>vector2<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>p1<font color="#000080">, </font>p2 <font color="#000080">: </font>pixelvector<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>p1<font color="#000080">.</font>x <font color="#000080">:= </font>fx<font color="#000080">(</font>pt1<font color="#000080">.</font>x<font color="#000080">);
  </font>p1<font color="#000080">.</font>y <font color="#000080">:= </font>fy<font color="#000080">(</font>pt1<font color="#000080">.</font>y<font color="#000080">);
  </font>p2<font color="#000080">.</font>x <font color="#000080">:= </font>fx<font color="#000080">(</font>pt2<font color="#000080">.</font>x<font color="#000080">);
  </font>p2<font color="#000080">.</font>y <font color="#000080">:= </font>fy<font color="#000080">(</font>pt2<font color="#000080">.</font>y<font color="#000080">);
  </font>BressenHam<font color="#000080">(</font><font color="#800000">$a000</font><font color="#000080">, </font>points<font color="#000080">, </font>c<font color="#000080">,  </font>p1<font color="#000080">,  </font>p2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>WisScherm<font color="#000080">(</font>punten <font color="#000080">: </font>pixelArray<font color="#000080">; </font>SchermSeg <font color="#000080">, </font>Virseg <font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">PUSH      ds
  MOV       ax, SchermSeg
  MOV       es, ax
  LDS       bx, punten
  MOV       cx, [bx]
  JCXZ      @@NietTekenen
 @@Wis:
  INC       bx
  INC       bx
  MOV       si, [bx]
  MOV       di, si
  PUSH      ds
  MOV       ax, virseg
  MOV       ds, ax
  MOVSB
  POP       ds
  LOOP      @@Wis
 @@NietTekenen:
  POP       ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>polydraw<font color="#000080">(</font>c<font color="#000080">, </font>n <font color="#000080">: </font>Integer<font color="#000080">; </font>poly <font color="#000080">: </font>vector2Array<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
    </b></font>linepto<font color="#000080">(</font>c<font color="#000080">, </font>poly<font color="#000080">[</font>i<font color="#000080">], </font>poly<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">]);
  </font>linepto<font color="#000080">(</font>c<font color="#000080">, </font>poly<font color="#000080">[</font>n<font color="#000080">], </font>poly<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>fillpoly<font color="#000080">(</font>c<font color="#000080">, </font>n <font color="#000080">: </font>Integer<font color="#000080">; </font>poly <font color="#000080">: </font>vector2Array<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>scan_table <font color="#000080">: </font>tabel<font color="#000080">;
  </font>scanline<font color="#000080">,
  </font>line<font color="#000080">,
  </font>offsetx    <font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>Draw_horiz_line<font color="#000080">(</font>hline_ar  <font color="#000080">: </font>hlineArray<font color="#000080">;
                            </font>color     <font color="#000080">: </font>Byte<font color="#000080">;
                            </font>lijn      <font color="#000080">: </font>Word<font color="#000080">;
                            </font>begin_p   <font color="#000080">: </font>Word<font color="#000080">;
                            </font>linelen   <font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">PUSH  ds
    MOV   cx, 320
    MOV   ax, 0a000h
    MOV   es, ax
    MOV   di, begin_p
    MOV   ax, lijn
    MUL   cx
    ADD   di, ax
    PUSH  di
    MOV   al, color
    MOV   cx, linelen
    PUSH  cx
    REP   STOSB
    LDS   si, hline_ar
    INC   [Word ptr ds:si]
    MOV   ax, [si]
    SHL   ax, 1
    SHL   ax, 1
    ADD   si, ax
    POP   bx
    POP   dx
    MOV   [si], dx
    MOV   [si + 2], bx
    POP   ds
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>swap<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>x<font color="#000080">, </font>y <font color="#000080">: </font>Integer<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>x <font color="#000080">:= </font>x <font color="#000080">+ </font>y<font color="#000080">;
    </font>y <font color="#000080">:= </font>x <font color="#000080">- </font>y<font color="#000080">;
    </font>x <font color="#000080">:= </font>x <font color="#000080">- </font>y<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
Procedure Calc_x(x1, y1, x2, y2 : Word; Var scan_table : tabel);
Var
  m_inv,
  xReal : Real;
begin
  Asm
    LDS     dx, scan_table
    MOV     ax, y1
    MOV     bx, y2
    CMP     ax, bx
    JNE     @@NotHorizLine
    MOV     bx, x1
    SHL     ax, 1
    ADD     ax, dx
    CMP     bx, [dx]
    JGE     @@Notstorexmin
    MOV     [dx], bx

   @@Notstorexmin:
    INC     dx
    MOV     bx, x2
    CMP     bx, [dx]
    JLE     @@Klaar
    MOV     [dx], bx
    JMP     @@Klaar

   @@NotHorizLine:
}

  </i></font><font color="#FF0000"><b>Procedure </b></font>Calc_x<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">, </font>x2<font color="#000080">, </font>y2 <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>scan_table <font color="#000080">: </font>tabel<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>m_inv<font color="#000080">, </font>xReal <font color="#000080">: </font>Real<font color="#000080">;
    </font>i<font color="#000080">, </font>y<font color="#000080">, </font>temp   <font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>y1 <font color="#000080">= </font>y2 <font color="#FF0000"><b>then
    begin
      if </b></font>x2 <font color="#000080">&lt; </font>x1 <font color="#FF0000"><b>then
        </b></font>swap<font color="#000080">(</font>x1<font color="#000080">, </font>x2<font color="#000080">)
      </font><font color="#FF0000"><b>else
      begin
        if </b></font>x1 <font color="#000080">&lt; </font>scan_table<font color="#000080">[</font>y1<font color="#000080">].</font>xmin <font color="#FF0000"><b>then
          </b></font>scan_table<font color="#000080">[</font>y1<font color="#000080">].</font>xmin <font color="#000080">:= </font>x1<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>x2 <font color="#000080">&gt; </font>scan_table<font color="#000080">[</font>y2<font color="#000080">].</font>xmax <font color="#FF0000"><b>then
          </b></font>scan_table<font color="#000080">[</font>y2<font color="#000080">].</font>xmax <font color="#000080">:= </font>x2<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
    begin
      </b></font>m_inv <font color="#000080">:= (</font>x2 <font color="#000080">- </font>x1<font color="#000080">) / (</font>y2 <font color="#000080">- </font>y1<font color="#000080">);

      </font><font color="#FF0000"><b>if </b></font>y1 <font color="#000080">&gt; </font>y2 <font color="#FF0000"><b>then </b></font><font color="#008000"><i>{swap}
      </i></font><font color="#FF0000"><b>begin
        </b></font>swap<font color="#000080">(</font>y1<font color="#000080">, </font>y2<font color="#000080">);
        </font>swap<font color="#000080">(</font>x1<font color="#000080">, </font>x2<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>if </b></font>x1 <font color="#000080">&lt; </font>scan_table<font color="#000080">[</font>y1<font color="#000080">].</font>xmin <font color="#FF0000"><b>then
        </b></font>scan_table<font color="#000080">[</font>y1<font color="#000080">].</font>xmin <font color="#000080">:= </font>x1<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>x2 <font color="#000080">&gt; </font>scan_table<font color="#000080">[</font>y2<font color="#000080">].</font>xmax <font color="#FF0000"><b>then
        </b></font>scan_table<font color="#000080">[</font>y2<font color="#000080">].</font>xmax <font color="#000080">:= </font>x2<font color="#000080">;
      </font>xReal <font color="#000080">:= </font>x1<font color="#000080">; </font>y <font color="#000080">:= </font>y1<font color="#000080">;

      </font><font color="#FF0000"><b>While </b></font>y <font color="#000080">&lt; </font>y2 <font color="#FF0000"><b>do
      begin
        </b></font>y <font color="#000080">:= </font>y <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
        </font>xReal <font color="#000080">:= </font>xReal <font color="#000080">+ </font>m_inv<font color="#000080">;
        </font>offsetx <font color="#000080">:= </font>round<font color="#000080">(</font>xReal<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>xReal <font color="#000080">&lt; </font>scan_table<font color="#000080">[</font>y<font color="#000080">].</font>xmin <font color="#FF0000"><b>then
          </b></font>scan_table<font color="#000080">[</font>y<font color="#000080">].</font>xmin <font color="#000080">:= </font>offsetx<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>xReal <font color="#000080">&gt; </font>scan_table<font color="#000080">[</font>y<font color="#000080">].</font>xmax <font color="#FF0000"><b>then
          </b></font>scan_table<font color="#000080">[</font>y<font color="#000080">].</font>xmax <font color="#000080">:= </font>offsetx<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>scan_table <font color="#000080">:= </font>emptytabel<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>line <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
    </b></font>calc_x<font color="#000080">(</font>fx<font color="#000080">(</font>poly<font color="#000080">[</font>line<font color="#000080">].</font>x<font color="#000080">), </font>fy<font color="#000080">(</font>poly<font color="#000080">[</font>line<font color="#000080">].</font>y<font color="#000080">),
           </font>fx<font color="#000080">(</font>poly<font color="#000080">[</font>line <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">].</font>x<font color="#000080">), </font>fy<font color="#000080">(</font>poly<font color="#000080">[</font>line <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">].</font>y<font color="#000080">), </font>scan_table<font color="#000080">);

  </font>calc_x<font color="#000080">(</font>fx<font color="#000080">(</font>poly<font color="#000080">[</font>n<font color="#000080">].</font>x<font color="#000080">), </font>fy<font color="#000080">(</font>poly<font color="#000080">[</font>n<font color="#000080">].</font>y<font color="#000080">),
         </font>fx<font color="#000080">(</font>poly<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>x<font color="#000080">), </font>fy<font color="#000080">(</font>poly<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>y<font color="#000080">), </font>scan_table<font color="#000080">);

  </font>scanline <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#FF0000"><b>While </b></font>scanline <font color="#000080">&lt; </font>nypix <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
  begin
    With </b></font>Scan_table<font color="#000080">[</font>scanline<font color="#000080">] </font><font color="#FF0000"><b>DO
      if </b></font>xmax <font color="#000080">&gt; </font>xmin <font color="#FF0000"><b>then
        </b></font>draw_horiz_line<font color="#000080">(</font>hline<font color="#000080">, </font>c<font color="#000080">,  </font>scanline<font color="#000080">,  </font>xmin<font color="#000080">,  </font>xmax <font color="#000080">- </font>xmin <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
      </font>scanline <font color="#000080">:= </font>scanline <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure  </b></font>Wis_Hline<font color="#000080">(</font>hline_ar <font color="#000080">: </font>hlineArray<font color="#000080">; </font>virseg <font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">PUSH      ds
  MOV       ax, 0a000h
  MOV       es, ax
  LDS       bx, hline_ar
  MOV       cx, [bx]
  JCXZ      @@Niet_tekenen
  ADD       bx, 4
 @@Wis:
  XCHG      cx, dx
  MOV       si, [bx]
  MOV       cx, [bx + 2]
  MOV       di, si
  PUSH      ds
  MOV       ax, virseg
  MOV       ds, ax
  CLD
  REP       MOVSB
  POP       ds
  XCHG      cx, dx
  ADD       bx, 4
  LOOP      @@Wis
 @@Niet_tekenen:
  POP       ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.


</font><font color="#008000"><i>{ &plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn; }

</i></font><font color="#FF0000"><b>Unit
  </b></font>ddVars<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Const
  </b></font>pi      <font color="#000080">= </font><font color="#800000">3.1415926535</font><font color="#000080">;
  </font>epsilon <font color="#000080">= </font><font color="#800000">0.000001</font><font color="#000080">;
  </font>rad     <font color="#000080">= </font>pi <font color="#000080">/ </font><font color="#800000">180</font><font color="#000080">;
  </font>nxpix   <font color="#000080">= </font><font color="#800000">320</font><font color="#000080">; </font><font color="#008000"><i>{ scherm resolutie }
  </i></font>nypix   <font color="#000080">= </font><font color="#800000">200</font><font color="#000080">;
  </font>maxfinf <font color="#000080">= </font><font color="#800000">200</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>xmaxymax  <font color="#000080">= </font><font color="#FF0000"><b>Record </b></font>xmin<font color="#000080">, </font>xmax <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>facetinfo <font color="#000080">= </font><font color="#FF0000"><b>Record </b></font>info<font color="#000080">, </font>Pointer <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>tabel     <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>nypix <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>xmaxymax<font color="#000080">;
  </font>sincos    <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">359</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Real<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>sinusArray   <font color="#000080">: </font>sincos<font color="#000080">;
  </font>cosinusArray <font color="#000080">: </font>sincos<font color="#000080">;
  </font>facetinfacet <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>maxfinf<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>facetinfo<font color="#000080">;
  </font>facetfree    <font color="#000080">: </font>Integer<font color="#000080">;
  </font>xyscale      <font color="#000080">: </font>Real<font color="#000080">;
  </font>emptytabel   <font color="#000080">: </font>tabel<font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>fx<font color="#000080">(</font>x <font color="#000080">: </font>Real<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>fy<font color="#000080">(</font>y <font color="#000080">: </font>Real<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Sign<font color="#000080">(</font>I <font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>macht<font color="#000080">(</font>a<font color="#000080">, </font>n <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>angle<font color="#000080">(</font>x<font color="#000080">, </font>y <font color="#000080">: </font>Real<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>sinus<font color="#000080">(</font>hoek <font color="#000080">: </font>Integer<font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>cosin<font color="#000080">(</font>hoek <font color="#000080">: </font>Integer<font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>pushfacet<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>stackname <font color="#000080">: </font>Integer<font color="#000080">; </font>value <font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Function </b></font>fx<font color="#000080">(</font>x <font color="#000080">: </font>Real<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>fx <font color="#000080">:= </font>nxpix <font color="#000080">- </font>trunc<font color="#000080">(</font>x <font color="#000080">* </font>xyscale <font color="#000080">+ </font>nxpix <font color="#000080">* </font><font color="#800000">0.5 </font><font color="#000080">- </font><font color="#800000">0.5</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>fy<font color="#000080">(</font>y <font color="#000080">: </font>Real<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>fy <font color="#000080">:= </font>nypix <font color="#000080">- </font>trunc<font color="#000080">(</font>y <font color="#000080">* </font>xyscale <font color="#000080">+ </font>nypix <font color="#000080">* </font><font color="#800000">0.5 </font><font color="#000080">- </font><font color="#800000">0.5</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Sign<font color="#000080">(</font>I <font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV  ax, i
  CMP  ax, 0
  JGE  @@Zero_or_one
  MOV  ax, -1
  JMP  @@Exit

 @@Zero_or_One:
  JE   @@Nul
  MOV  ax, 1
  JMP  @@Exit

 @@Nul:
  xor  ax, ax

 @@Exit:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>macht<font color="#000080">(</font>a<font color="#000080">, </font>n <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>a <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>macht <font color="#000080">:=  </font>exp<font color="#000080">(</font>n <font color="#000080">* (</font>ln<font color="#000080">(</font>a<font color="#000080">)))
  </font><font color="#FF0000"><b>else
  if </b></font>a <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>macht <font color="#000080">:= -</font>exp<font color="#000080">(</font>n <font color="#000080">* (</font>ln<font color="#000080">(-</font>a<font color="#000080">)))
  </font><font color="#FF0000"><b>else
    </b></font>macht <font color="#000080">:= </font>a<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>angle<font color="#000080">(</font>x<font color="#000080">, </font>y <font color="#000080">: </font>Real<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>abs<font color="#000080">(</font>x<font color="#000080">) &lt; </font>epsilon <font color="#FF0000"><b>then
    if </b></font>abs<font color="#000080">(</font>y<font color="#000080">) &lt; </font>epsilon <font color="#FF0000"><b>then
      </b></font>angle <font color="#000080">:= </font><font color="#800000">0
    </font><font color="#FF0000"><b>else
    if </b></font>y <font color="#000080">&gt; </font><font color="#800000">0.0 </font><font color="#FF0000"><b>then
      </b></font>angle <font color="#000080">:= </font><font color="#800000">90
    </font><font color="#FF0000"><b>else
      </b></font>angle <font color="#000080">:= </font><font color="#800000">270
  </font><font color="#FF0000"><b>else
  if </b></font>x <font color="#000080">&lt; </font><font color="#800000">0.0 </font><font color="#FF0000"><b>then
    </b></font>angle <font color="#000080">:= </font>round<font color="#000080">(</font>arctan<font color="#000080">(</font>y <font color="#000080">/ </font>x<font color="#000080">) / </font>rad<font color="#000080">) + </font><font color="#800000">180
  </font><font color="#FF0000"><b>else
    </b></font>angle <font color="#000080">:= </font>round<font color="#000080">(</font>arctan<font color="#000080">(</font>y <font color="#000080">/ </font>x<font color="#000080">) / </font>rad<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>sinus<font color="#000080">(</font>hoek <font color="#000080">: </font>Integer<font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>hoek  <font color="#000080">:= </font>hoek <font color="#FF0000"><b>mod </b></font><font color="#800000">360</font><font color="#000080">;
  </font>sinus <font color="#000080">:= </font>sinusArray<font color="#000080">[</font>hoek<font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>cosin<font color="#000080">(</font>hoek <font color="#000080">: </font>Integer<font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>hoek  <font color="#000080">:= </font>hoek <font color="#FF0000"><b>mod </b></font><font color="#800000">360 </font><font color="#000080">;
  </font>cosin <font color="#000080">:= </font>cosinusArray<font color="#000080">[</font>hoek<font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>pushfacet<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>stackname <font color="#000080">: </font>Integer<font color="#000080">; </font>value <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>location <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>facetfree <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>Write<font color="#000080">(</font><font color="#800000">'Cannot hold more facets'</font><font color="#000080">);
    </font>HALT<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>location  <font color="#000080">:= </font>facetfree<font color="#000080">;
    </font>facetfree <font color="#000080">:= </font>facetinfacet<font color="#000080">[</font>facetfree<font color="#000080">].</font>Pointer<font color="#000080">;
    </font>facetinfacet<font color="#000080">[</font>location<font color="#000080">].</font>info <font color="#000080">:= </font>value<font color="#000080">;
    </font>facetinfacet<font color="#000080">[</font>location<font color="#000080">].</font>Pointer <font color="#000080">:= </font>stackname<font color="#000080">;
    </font>stackname <font color="#000080">:= </font>location<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ vul sinus- en cosinusArray met waarden }
  </i></font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">359 </font><font color="#FF0000"><b>DO
  begin
    </b></font>sinusArray<font color="#000080">[</font>i<font color="#000080">]   := </font>sin<font color="#000080">(</font>i <font color="#000080">* </font>rad<font color="#000080">);
    </font>cosinusArray<font color="#000080">[</font>i<font color="#000080">] := </font>cos<font color="#000080">(</font>i <font color="#000080">* </font>rad<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Init facetinfacet }
  </i></font>facetfree <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>maxfinf <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
    </b></font>facetinfacet<font color="#000080">[</font>i<font color="#000080">].</font>Pointer <font color="#000080">:= </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;

  </font>facetinfacet<font color="#000080">[</font>maxfinf<font color="#000080">].</font>Pointer <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#008000"><i>{ Init EmptyTabel }
  </i></font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>nypix <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
  begin
    </b></font>Emptytabel<font color="#000080">[</font>i<font color="#000080">].</font>xmin <font color="#000080">:= </font><font color="#800000">319</font><font color="#000080">;
    </font>Emptytabel<font color="#000080">[</font>i<font color="#000080">].</font>xmax <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font><font color="#008000"><i>{ &plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn; }

</i></font><font color="#FF0000"><b>Unit </b></font>ddvideo<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses
  </b></font>Dos<font color="#000080">, </font>DDVars<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>schermPointer <font color="#000080">= ^</font>schermType<font color="#000080">;
  </font>schermType    <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>nypix <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">..</font>nxpix <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
  </font>color         <font color="#000080">= </font><font color="#FF0000"><b>Record  </b></font>R<font color="#000080">, </font>G<font color="#000080">, </font>B <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>paletteType   <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>color<font color="#000080">;
  </font>WordArray     <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word<font color="#000080">;
  </font>palFile       <font color="#000080">= </font><font color="#FF0000"><b>File of </b></font>paletteType<font color="#000080">;
  </font>picFile       <font color="#000080">= </font><font color="#FF0000"><b>File of </b></font>schermType<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>scherm    <font color="#000080">: </font>schermType <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$8A00 </font><font color="#000080">: </font><font color="#800000">$0000</font><font color="#000080">;
  </font>schermptr <font color="#000080">: </font>schermPointer<font color="#000080">;
  </font>switch    <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>start<font color="#000080">(</font>Filenaam <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>horiz <font color="#000080">: </font>Real<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Oldpal <font color="#000080">: </font>paletteType<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>finish<font color="#000080">(</font>Oldpal <font color="#000080">: </font>paletteType<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>VirScherm_actief<font color="#000080">(</font>switch <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Scherm_actief<font color="#000080">(</font>switch <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Procedure </b></font>Virscherm_actief<font color="#000080">(</font>switch <font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV     dx, 3cch
  MOV     cx, switch
  JCXZ    @@volgende
  in      al, dx             </font><font color="#008000"><i>{ switch=1 }
  </i></font><font color="#FF00FF">and     al, 0dfh
  MOV     dx, 3c2h
  OUT     dx, al             </font><font color="#008000"><i>{ set even mode }
  </i></font><font color="#FF00FF">JMP     @@Klaar

 @@Volgende:
  in      al, dx             </font><font color="#008000"><i>{ switch=0 }
  </i></font><font color="#FF00FF">or      al, 20h
  MOV     dx, 3c2h
  OUT     dx, al             </font><font color="#008000"><i>{ set odd mode }

 </i></font><font color="#FF00FF">@@Klaar:
  MOV     dx, 3dah           </font><font color="#008000"><i>{ Wacht op Vert-retrace }
  </i></font><font color="#FF00FF">in      al, dx             </font><font color="#008000"><i>{ Zodat virscherm = invisible }
  </i></font><font color="#FF00FF">TEST    al, 08h
  JZ      @@Klaar
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Scherm_actief<font color="#000080">(</font>switch <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  Asm
   </b></font><font color="#FF00FF">@@Wacht:
    MOV  dx, 3dah
    in   al, dx
    TEST al, 01h
    JNZ  @@Wacht
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>port<font color="#000080">[</font><font color="#800000">$3d4</font><font color="#000080">] := </font><font color="#800000">$c</font><font color="#000080">;
  </font>port<font color="#000080">[</font><font color="#800000">$3d5</font><font color="#000080">] := </font>switch <font color="#000080">* </font><font color="#800000">$80</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetVgaPalette<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>p <font color="#000080">: </font>paletteType<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  With </b></font>regs <font color="#FF0000"><b>do
  begin
    </b></font>ax <font color="#000080">:= </font><font color="#800000">$1012</font><font color="#000080">;
    </font>bx <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>cx <font color="#000080">:= </font><font color="#800000">256</font><font color="#000080">;
    </font>es <font color="#000080">:= </font>seg<font color="#000080">(</font>p<font color="#000080">);
    </font>dx <font color="#000080">:= </font>ofs<font color="#000080">(</font>p<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>intr <font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>regs<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>start<font color="#000080">(</font>Filenaam <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>horiz <font color="#000080">: </font>Real<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Oldpal <font color="#000080">: </font>paletteType<font color="#000080">);

  </font><font color="#FF0000"><b>Procedure </b></font>readimage<font color="#000080">(</font>Filenaam <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>pal <font color="#000080">: </font>paletteType<font color="#000080">);

    </font><font color="#FF0000"><b>Function </b></font>FileExists<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>Var
      </b></font>f <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font><font color="#008000"><i>{$I-}
      </i></font>Assign<font color="#000080">(</font>f<font color="#000080">,  </font>FileName<font color="#000080">);
      </font>Reset<font color="#000080">(</font>f<font color="#000080">);
      </font>Close<font color="#000080">(</font>f<font color="#000080">);
      </font><font color="#008000"><i>{$I + }
      </i></font>FileExists <font color="#000080">:= (</font>IOResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FileName <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Var
    </b></font>pFile <font color="#000080">: </font>picFile<font color="#000080">;
    </font>lFile <font color="#000080">: </font>palFile<font color="#000080">;
    </font>a     <font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>FileExists<font color="#000080">(</font>Filenaam <font color="#000080">+ </font><font color="#800000">'.pal'</font><font color="#000080">)) </font><font color="#FF0000"><b>and
       </b></font><font color="#000080">(</font>FileExists<font color="#000080">(</font>Filenaam <font color="#000080">+ </font><font color="#800000">'.dwg'</font><font color="#000080">)) </font><font color="#FF0000"><b>then
    begin
      </b></font>assign<font color="#000080">(</font>lFile<font color="#000080">, </font>Filenaam <font color="#000080">+ </font><font color="#800000">'.pal'</font><font color="#000080">);
      </font>reset<font color="#000080">(</font>lFile<font color="#000080">);
      </font>read<font color="#000080">(</font>lFile<font color="#000080">, </font>pal<font color="#000080">);
      </font>close<font color="#000080">(</font>lFile<font color="#000080">);
      </font>assign<font color="#000080">(</font>pFile<font color="#000080">, </font>Filenaam <font color="#000080">+ </font><font color="#800000">'.dwg'</font><font color="#000080">);
      </font>reset<font color="#000080">(</font>pFile<font color="#000080">);
      </font>read<font color="#000080">(</font>pFile<font color="#000080">, </font>schermptr<font color="#000080">^);
      </font>close<font color="#000080">(</font>pFile<font color="#000080">);
    </font><font color="#FF0000"><b>end
    else
    begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Palette en Picture bestanden niet gevonden....'</font><font color="#000080">);
      </font>Halt<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>SetVgaMode<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">mov  ah, 0
    mov  al, 13h
    int  $10
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>GetVgaPalette<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>p <font color="#000080">: </font>paletteType<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>regs <font color="#000080">: </font>Registers<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    With </b></font>regs <font color="#FF0000"><b>do
    begin
      </b></font>ax <font color="#000080">:= </font><font color="#800000">$1017</font><font color="#000080">;
      </font>bx <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>cx <font color="#000080">:= </font><font color="#800000">256</font><font color="#000080">;
      </font>es <font color="#000080">:= </font>seg<font color="#000080">(</font>p<font color="#000080">);
      </font>dx <font color="#000080">:= </font>ofs<font color="#000080">(</font>p<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>intr <font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>regs<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>pal <font color="#000080">: </font>paletteType<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>getmem<font color="#000080">(</font>schermptr<font color="#000080">, </font>sizeof<font color="#000080">(</font>schermType<font color="#000080">));
  </font>readimage<font color="#000080">(</font>Filenaam<font color="#000080">, </font>pal<font color="#000080">);
  </font>GetVgaPalette<font color="#000080">(</font>OldPal<font color="#000080">);
  </font>SetVgaPalette<font color="#000080">(</font>pal<font color="#000080">);
  </font>SetVgaMode<font color="#000080">;
  </font>move<font color="#000080">(</font>schermptr<font color="#000080">^, </font>scherm<font color="#000080">, </font>nypix <font color="#000080">* </font>nxpix<font color="#000080">);
  </font>Virscherm_actief<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>move<font color="#000080">(</font>schermptr<font color="#000080">^, </font>mem<font color="#000080">[</font><font color="#800000">$A000 </font><font color="#000080">: </font><font color="#800000">0</font><font color="#000080">], </font>nypix <font color="#000080">* </font>nxpix<font color="#000080">);     </font><font color="#008000"><i>{ blanko scherm }
  </i></font>VirScherm_actief<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font>move<font color="#000080">(</font>schermptr<font color="#000080">^, </font>mem<font color="#000080">[</font><font color="#800000">$A000 </font><font color="#000080">: </font><font color="#800000">0</font><font color="#000080">], </font>nypix <font color="#000080">* </font>nxpix<font color="#000080">);     </font><font color="#008000"><i>{ blanko scherm }
  </i></font>Scherm_actief<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font>switch  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>xyscale <font color="#000080">:= (</font>nypix <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) / </font>horiz<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>finish<font color="#000080">(</font>Oldpal <font color="#000080">: </font>paletteType<font color="#000080">);

  </font><font color="#FF0000"><b>Procedure </b></font>SetNormalMode<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">mov  ah,  0
    mov  al,  3
    int  $10
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>SetVgaPalette<font color="#000080">(</font>Oldpal<font color="#000080">);
  </font>SetNormalMode<font color="#000080">;
  </font>Virscherm_actief<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>Freemem<font color="#000080">(</font>schermptr<font color="#000080">, </font>sizeof<font color="#000080">(</font>schermType<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p></body>
</html>
