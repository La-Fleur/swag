<html>
<head><title> "Complete Unit for BMP Images" by ALEKSANDAR DLABAC</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0247.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000"> <font color="#008000"><i>{$R-}
 </i></font><font color="#FF0000"><b>Unit </b></font>BMP<font color="#000080">;
</font><font color="#008000"><i>{
             &Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;     Complete unit for BMP images     &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;           Aleksandar Dlabac          &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;     (C)1995. Dlabac Bros. Company    &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;    ------------------------------    &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;      adlabac@urcpg.urc.cg.ac.yu      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;      adlabac@urcpg.pmf.cg.ac.yu      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
               &plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;
}
   </i></font><font color="#FF0000"><b>Interface

   Type </b></font>BMPInfoType <font color="#000080">= </font><font color="#FF0000"><b>Record
                        </b></font>Width   <font color="#000080">: </font>longint<font color="#000080">;
                        </font>Height  <font color="#000080">: </font>longint<font color="#000080">;
                        </font>Colors  <font color="#000080">: </font>longint<font color="#000080">;
                        </font>Palette <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of Record
                                                      </b></font>Red   <font color="#000080">: </font>byte<font color="#000080">;
                                                      </font>Green <font color="#000080">: </font>byte<font color="#000080">;
                                                      </font>Blue  <font color="#000080">: </font>byte
                                                    <font color="#FF0000"><b>End
                      End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>ReadBMP <font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
   </font><font color="#FF0000"><b>Function  </b></font>BMPResult <font color="#000080">: </font>integer<font color="#000080">;
   </font><font color="#FF0000"><b>Function  </b></font>BMPErrorMsg <font color="#000080">(</font>ErrorCode <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>Procedure </b></font>BMPInfo <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Info <font color="#000080">: </font>BMPInfoType<font color="#000080">);

   </font><font color="#FF0000"><b>Implementation

   Uses </b></font>Graph<font color="#000080">;

   </font><font color="#FF0000"><b>Const </b></font>Rasters <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">=
         ((</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">136</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">136</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),
          (</font><font color="#800000">168</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">42</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">138</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">42</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">136</font><font color="#000080">,</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">136</font><font color="#000080">,</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">136</font><font color="#000080">,</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">136</font><font color="#000080">,</font><font color="#800000">34</font><font color="#000080">),
          (</font><font color="#800000">168</font><font color="#000080">,</font><font color="#800000">136</font><font color="#000080">,</font><font color="#800000">42</font><font color="#000080">,</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">168</font><font color="#000080">,</font><font color="#800000">136</font><font color="#000080">,</font><font color="#800000">42</font><font color="#000080">,</font><font color="#800000">34</font><font color="#000080">),(</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">68</font><font color="#000080">,</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">68</font><font color="#000080">,</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">68</font><font color="#000080">,</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">68</font><font color="#000080">),
          (</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">85</font><font color="#000080">,</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">85</font><font color="#000080">,</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">85</font><font color="#000080">,</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">85</font><font color="#000080">),(</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">213</font><font color="#000080">,</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">93</font><font color="#000080">,</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">213</font><font color="#000080">,</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">93</font><font color="#000080">),
          (</font><font color="#800000">85</font><font color="#000080">,</font><font color="#800000">187</font><font color="#000080">,</font><font color="#800000">85</font><font color="#000080">,</font><font color="#800000">187</font><font color="#000080">,</font><font color="#800000">85</font><font color="#000080">,</font><font color="#800000">187</font><font color="#000080">,</font><font color="#800000">85</font><font color="#000080">,</font><font color="#800000">187</font><font color="#000080">),(</font><font color="#800000">87</font><font color="#000080">,</font><font color="#800000">119</font><font color="#000080">,</font><font color="#800000">213</font><font color="#000080">,</font><font color="#800000">221</font><font color="#000080">,</font><font color="#800000">117</font><font color="#000080">,</font><font color="#800000">119</font><font color="#000080">,</font><font color="#800000">213</font><font color="#000080">,</font><font color="#800000">221</font><font color="#000080">),
          (</font><font color="#800000">119</font><font color="#000080">,</font><font color="#800000">221</font><font color="#000080">,</font><font color="#800000">119</font><font color="#000080">,</font><font color="#800000">221</font><font color="#000080">,</font><font color="#800000">119</font><font color="#000080">,</font><font color="#800000">221</font><font color="#000080">,</font><font color="#800000">119</font><font color="#000080">,</font><font color="#800000">221</font><font color="#000080">),(</font><font color="#800000">87</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">213</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">117</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">213</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">),
          (</font><font color="#800000">119</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">221</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">119</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">221</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">),(</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">247</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">247</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">),
          (</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">));

   </font><font color="#008000"><i>{ This rasters is used for mono image dithering. Whenever program
     determines that number of colors available is smaller than number of
     colors in picture, picture is shown in mono (1 color) dither. }

   </i></font><font color="#FF0000"><b>Var </b></font>B             <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
       </font>K             <font color="#000080">: </font>byte<font color="#000080">;
       </font>BMPError      <font color="#000080">: </font>integer<font color="#000080">;
       </font>I<font color="#000080">, </font>J          <font color="#000080">: </font>longint<font color="#000080">;
       </font>Colors        <font color="#000080">: </font>longint<font color="#000080">;
       </font>MaxColor      <font color="#000080">: </font>longint<font color="#000080">;
       </font>CoreHeader    <font color="#000080">: </font>Boolean<font color="#000080">;
       </font>BMPFileHeader <font color="#000080">: </font><font color="#FF0000"><b>Record
                         </b></font>BfType      <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{ Signature &quot;BM&quot; ($4D $42) }
                         </i></font>BfSize      <font color="#000080">: </font>longint<font color="#000080">; </font><font color="#008000"><i>{ File size }
                         </i></font>BfReserved1 <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{ Reserved }
                         </i></font>BfReserved2 <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{ Reserved }
                         </i></font>BfOffBits   <font color="#000080">: </font>longint  <font color="#008000"><i>{ Data offset address: }
                       </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;                     </font><font color="#008000"><i>{    2 colors        $3E  }
                                                {   16 colors        $76  }
                                                {  256 colors       $436  }
                                                {  true color        $36  }

       </i></font>BMPInfoHeader <font color="#000080">: </font><font color="#FF0000"><b>Record
                         </b></font>BiSize          <font color="#000080">: </font>longint<font color="#000080">; </font><font color="#008000"><i>{ $28 - Header length in bytes }
                         </i></font>BiWidth         <font color="#000080">: </font>longint<font color="#000080">; </font><font color="#008000"><i>{ Picture width }
                         </i></font>BiHeight        <font color="#000080">: </font>longint<font color="#000080">; </font><font color="#008000"><i>{ Picture height }
                         </i></font>BiPlanes        <font color="#000080">: </font>word<font color="#000080">;    </font><font color="#008000"><i>{ Number of planes }
                         </i></font>BiBitCount      <font color="#000080">: </font>word<font color="#000080">;    </font><font color="#008000"><i>{ Bits per pixel }
                         </i></font>BiCompression   <font color="#000080">: </font>longint<font color="#000080">; </font><font color="#008000"><i>{ Compression type (0-none) }
                         </i></font>BiSizeImage     <font color="#000080">: </font>longint<font color="#000080">; </font><font color="#008000"><i>{ Picture size in bytes (can be 0 for no compression) }
                         </i></font>BiXPelsPerMeter <font color="#000080">: </font>longint<font color="#000080">;
                         </font>BiYPelsPerMeter <font color="#000080">: </font>longint<font color="#000080">;
                         </font>BiClrUsed       <font color="#000080">: </font>longint<font color="#000080">;
                         </font>BiClrImportant  <font color="#000080">: </font>longint
                       <font color="#FF0000"><b>End</b></font><font color="#000080">;

       </font>RGBColors <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of Record
                                       </b></font>RGBBlue     <font color="#000080">: </font>byte<font color="#000080">;
                                       </font>RGBGreen    <font color="#000080">: </font>byte<font color="#000080">;
                                       </font>RGBRed      <font color="#000080">: </font>byte<font color="#000080">;
                                       </font>RGBReserved <font color="#000080">: </font>byte
                                     <font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>PutPix <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Col<font color="#000080">:</font>longint<font color="#000080">);
     </font><font color="#FF0000"><b>Var </b></font>Pix       <font color="#000080">: </font>byte<font color="#000080">;
         </font>Intensity <font color="#000080">: </font>real<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         If </b></font><font color="#000080">(</font>Y<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Col<font color="#000080">&lt;&gt;</font><font color="#800000">255</font><font color="#000080">) </font><font color="#FF0000"><b>then
           </b></font>Write <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>X<font color="#000080">&gt;</font>GetMaxX <font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>Y<font color="#000080">&gt;</font>GetMaxY <font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>X<font color="#000080">&gt;</font>BMPInfoHeader<font color="#000080">.</font>BiWidth<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>Y<font color="#000080">&gt;</font>BMPInfoHeader<font color="#000080">.</font>BiHeight<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>MaxColor<font color="#000080">&lt;</font>Colors<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>then
           With </b></font>RGBColors <font color="#000080">[</font>Col<font color="#000080">] </font><font color="#FF0000"><b>do
             Begin
               </b></font>Intensity<font color="#000080">:=</font><font color="#800000">0.299</font><font color="#000080">*</font>RGBRed<font color="#000080">+</font><font color="#800000">0.587</font><font color="#000080">*</font>RGBGreen<font color="#000080">+</font><font color="#800000">0.114</font><font color="#000080">*</font>RGBBlue<font color="#000080">;
               </font>Intensity<font color="#000080">:=</font>Intensity<font color="#000080">/</font><font color="#800000">255</font><font color="#000080">;
               </font>Pix<font color="#000080">:=</font>Rasters <font color="#000080">[</font>Round <font color="#000080">(</font>Intensity<font color="#000080">*</font><font color="#800000">15</font><font color="#000080">)][</font>Y <font color="#FF0000"><b>and </b></font><font color="#800000">7</font><font color="#000080">];
               </font>Pix<font color="#000080">:=(</font>Pix <font color="#FF0000"><b>shr </b></font><font color="#000080">(</font>X <font color="#FF0000"><b>and </b></font><font color="#800000">7</font><font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">;
               </font>PutPixel <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Pix<font color="#000080">);
             </font><font color="#FF0000"><b>End
                              else
           </b></font>PutPixel <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Col<font color="#000080">)
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>ReadBMP <font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
     </font><font color="#FF0000"><b>Var </b></font>F        <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
         </font>Size     <font color="#000080">: </font>longint<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         </b></font>Assign <font color="#000080">(</font>F<font color="#000080">,</font>FileName<font color="#000080">);
</font><font color="#008000"><i>{$I-}
         </i></font>Reset <font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#008000"><i>{$I+}
         </i></font><font color="#FF0000"><b>If </b></font>IOResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
           Begin
             </b></font>BMPError<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
             </font>Exit
           <font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>Size<font color="#000080">:=</font>FileSize <font color="#000080">(</font>F<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>Size<font color="#000080">&lt;</font><font color="#800000">246 </font><font color="#FF0000"><b>then
           Begin
             </b></font>BMPError<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
             </font>Exit
           <font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>BMPFileHeader<font color="#000080">,</font><font color="#800000">14</font><font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>BMPFileHeader<font color="#000080">.</font>BfType<font color="#000080">&lt;&gt;</font><font color="#800000">$4D42 </font><font color="#FF0000"><b>then
           Begin
             </b></font>BMPError<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;
             </font>Exit
           <font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>Size<font color="#000080">&lt;</font>BMPFileHeader<font color="#000080">.</font>BfSize <font color="#FF0000"><b>then
           Begin
             </b></font>BMPError<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
             </font>Exit
           <font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>Size<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
         </font>CoreHeader<font color="#000080">:=</font>Size<font color="#000080">=</font><font color="#800000">$0C</font><font color="#000080">;
         </font>BMPInfoHeader<font color="#000080">.</font>BiSize<font color="#000080">:=</font>Size<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>Size<font color="#000080">=</font><font color="#800000">$28 </font><font color="#FF0000"><b>then
           </b></font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>BMPInfoHeader<font color="#000080">.</font>BiWidth<font color="#000080">,</font><font color="#800000">$24</font><font color="#000080">)
                     </font><font color="#FF0000"><b>else
           If </b></font>Size<font color="#000080">=</font><font color="#800000">$0C </font><font color="#FF0000"><b>then
             With </b></font>BMPInfoHeader <font color="#FF0000"><b>do
               Begin
                 </b></font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>BiWidth<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
                 </font>BiCompression<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                 </font>BiSizeImage<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                 </font>BiXPelsPerMeter<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                 </font>BiYPelsPerMeter<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                 </font>BiClrUsed<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                 </font>BiClrImportant<font color="#000080">:=</font><font color="#800000">0
               </font><font color="#FF0000"><b>End
                       else
             Begin
               </b></font>BMPError<font color="#000080">:=</font><font color="#800000">5</font><font color="#000080">;
               </font>Exit
             <font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>Case </b></font>BMPInfoHeader<font color="#000080">.</font>BiBitCount <font color="#FF0000"><b>of
             </b></font><font color="#800000">1  </font><font color="#000080">: </font>Colors<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
             </font><font color="#800000">4  </font><font color="#000080">: </font>Colors<font color="#000080">:=</font><font color="#800000">16</font><font color="#000080">;
             </font><font color="#800000">8  </font><font color="#000080">: </font>Colors<font color="#000080">:=</font><font color="#800000">256</font><font color="#000080">;
             </font><font color="#800000">24 </font><font color="#000080">: </font>Colors<font color="#000080">:=</font><font color="#800000">16777216</font><font color="#000080">;
             </font><font color="#FF0000"><b>else
               Begin
                 </b></font>BMPError<font color="#000080">:=</font><font color="#800000">6</font><font color="#000080">;
                 </font>Exit
                <font color="#FF0000"><b>End
           End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>GetGraphMode<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
           Begin
             </b></font>BMPError<font color="#000080">:=</font><font color="#800000">7</font><font color="#000080">;
             </font>Exit
           <font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>Colors<font color="#000080">&lt;=</font><font color="#800000">256 </font><font color="#FF0000"><b>then
           For </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Colors<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
             Begin
               </b></font>SetPalette <font color="#000080">(</font>I<font color="#000080">,</font>I<font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font>Colors<font color="#000080">=</font><font color="#800000">2 </font><font color="#FF0000"><b>then
                 With </b></font>RGBColors <font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>do
                   Begin
                     </b></font>RGBBlue<font color="#000080">:=</font>I<font color="#000080">*</font><font color="#800000">255</font><font color="#000080">;
                     </font>RGBGreen<font color="#000080">:=</font>I<font color="#000080">*</font><font color="#800000">255</font><font color="#000080">;
                     </font>RGBRed<font color="#000080">:=</font>I<font color="#000080">*</font><font color="#800000">255</font><font color="#000080">;
                     </font>RGBReserved<font color="#000080">:=</font><font color="#800000">0
                   </font><font color="#FF0000"><b>End
                           else
                 If </b></font>CoreHeader <font color="#FF0000"><b>then
                   Begin
                     </b></font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>RGBColors <font color="#000080">[</font>I<font color="#000080">],</font><font color="#800000">3</font><font color="#000080">);
                     </font>RGBColors <font color="#000080">[</font>I<font color="#000080">].</font>RGBReserved<font color="#000080">:=</font><font color="#800000">0
                   </font><font color="#FF0000"><b>End
                               else
                   </b></font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>RGBColors <font color="#000080">[</font>I<font color="#000080">],</font><font color="#800000">4</font><font color="#000080">);
                 </font><font color="#FF0000"><b>With </b></font>RGBColors <font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>do
                   </b></font>SetRGBPalette <font color="#000080">(</font>I<font color="#000080">,</font>RGBRed <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">,</font>RGBGreen <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">,</font>RGBBlue <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">)
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>GetMaxColor<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">&lt;</font>Colors <font color="#FF0000"><b>then
           </b></font>MaxColor<font color="#000080">:=</font><font color="#800000">1
                                 </font><font color="#FF0000"><b>else
           </b></font>MaxColor<font color="#000080">:=</font>GetMaxColor<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>MaxColor<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then
           Begin
             </b></font>SetRGBPalette <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
             </font>SetRGBPalette <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">)
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>Seek <font color="#000080">(</font>F<font color="#000080">,</font>BMPFileHeader<font color="#000080">.</font>BfOffBits<font color="#000080">);
         </font><font color="#FF0000"><b>With </b></font>BMPInfoHeader <font color="#FF0000"><b>do
           For </b></font>J<font color="#000080">:=</font>BiHeight<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
             Begin
               </b></font>I<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                 </font><font color="#FF0000"><b>Repeat
                   If </b></font>Colors<font color="#000080">&lt;=</font><font color="#800000">256 </font><font color="#FF0000"><b>then
                     </b></font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>B <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">4</font><font color="#000080">)
                                  </font><font color="#FF0000"><b>else
                     </b></font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>B <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">3</font><font color="#000080">);
                     </font><font color="#FF0000"><b>Case </b></font>BiBitCount <font color="#FF0000"><b>of
                       </b></font><font color="#800000">1  </font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                              </b></font>K<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
                                </font><font color="#FF0000"><b>Repeat
                                  If </b></font>B <font color="#000080">[</font>K<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$80</font><font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                                    </b></font>PutPix <font color="#000080">(</font>I<font color="#000080">,</font>J<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)
                                                     </font><font color="#FF0000"><b>else
                                    </b></font>PutPix <font color="#000080">(</font>I<font color="#000080">,</font>J<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
                                  </font>Inc <font color="#000080">(</font>I<font color="#000080">);
                                  </font>B <font color="#000080">[</font>K<font color="#000080">]:=</font>B <font color="#000080">[</font>K<font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">;
                                  </font><font color="#FF0000"><b>If </b></font>I <font color="#FF0000"><b>mod </b></font><font color="#800000">8</font><font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Inc <font color="#000080">(</font>K<font color="#000080">)
                                </font><font color="#FF0000"><b>Until </b></font>K<font color="#000080">=</font><font color="#800000">5
                            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                       </font><font color="#800000">4  </font><font color="#000080">: </font><font color="#FF0000"><b>For </b></font>K<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
                              Begin
                                </b></font>PutPix <font color="#000080">(</font>I<font color="#000080">,</font>J<font color="#000080">,(</font>B <font color="#000080">[</font>K<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$F0</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">);
                                </font>Inc <font color="#000080">(</font>I<font color="#000080">);
                                </font>PutPix <font color="#000080">(</font>I<font color="#000080">,</font>J<font color="#000080">,</font>B <font color="#000080">[</font>K<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$0F</font><font color="#000080">);
                                </font>Inc <font color="#000080">(</font>I<font color="#000080">)
                              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                       </font><font color="#800000">8  </font><font color="#000080">: </font><font color="#FF0000"><b>For </b></font>K<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
                              Begin
                                </b></font>PutPix <font color="#000080">(</font>I<font color="#000080">,</font>J<font color="#000080">,</font>B <font color="#000080">[</font>K<font color="#000080">]);
                                </font>Inc <font color="#000080">(</font>I<font color="#000080">)
                              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                       </font><font color="#800000">24 </font><font color="#000080">: </font>PutPix <font color="#000080">(</font>I<font color="#000080">,</font>J<font color="#000080">,</font>longint <font color="#000080">(</font>B <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">])*</font><font color="#800000">65536</font><font color="#000080">+</font>B <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]*</font><font color="#800000">256</font><font color="#000080">+</font>B <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">])
                     </font><font color="#FF0000"><b>End
                 Until </b></font>I<font color="#000080">&gt;</font>BiWidth<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font>Colors<font color="#000080">&gt;</font><font color="#800000">256 </font><font color="#FF0000"><b>then
                 For </b></font>K<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>I<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do
                   </b></font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>B<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">1</font><font color="#000080">)
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>BMPError<font color="#000080">:=</font><font color="#800000">0
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Function </b></font>BMPResult <font color="#000080">: </font>integer<font color="#000080">;
     </font><font color="#FF0000"><b>Begin
       </b></font>BMPResult<font color="#000080">:=</font>BMPError<font color="#000080">;
       </font>BMPError<font color="#000080">:=</font><font color="#800000">0
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Function </b></font>BMPErrorMsg <font color="#000080">(</font>ErrorCode <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Var </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>Begin
           Case </b></font>ErrorCode <font color="#FF0000"><b>of
             </b></font><font color="#800000">0 </font><font color="#000080">: </font>Temp<font color="#000080">:=</font><font color="#800000">'No error'</font><font color="#000080">;
             </font><font color="#800000">1 </font><font color="#000080">: </font>Temp<font color="#000080">:=</font><font color="#800000">'Error opening file'</font><font color="#000080">;
             </font><font color="#800000">2 </font><font color="#000080">: </font>Temp<font color="#000080">:=</font><font color="#800000">'File too short'</font><font color="#000080">;
             </font><font color="#800000">3 </font><font color="#000080">: </font>Temp<font color="#000080">:=</font><font color="#800000">'File not loaded'</font><font color="#000080">;
             </font><font color="#800000">4 </font><font color="#000080">: </font>Temp<font color="#000080">:=</font><font color="#800000">'Not a BMP file'</font><font color="#000080">;
             </font><font color="#800000">5 </font><font color="#000080">: </font>Temp<font color="#000080">:=</font><font color="#800000">'Invalid header'</font><font color="#000080">;
             </font><font color="#800000">6 </font><font color="#000080">: </font>Temp<font color="#000080">:=</font><font color="#800000">'Invalid number of colors'</font><font color="#000080">;
             </font><font color="#800000">7 </font><font color="#000080">: </font>Temp<font color="#000080">:=</font><font color="#800000">'Graphics mode not initialized'</font><font color="#000080">;
             </font><font color="#FF0000"><b>else </b></font>Temp<font color="#000080">:=</font><font color="#800000">'Unknown error'
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>BMPErrorMsg<font color="#000080">:=</font>Temp<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>BMPInfo <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Info <font color="#000080">: </font>BMPInfoType<font color="#000080">);
     </font><font color="#FF0000"><b>Var </b></font>I <font color="#000080">: </font>integer<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         With </b></font>Info <font color="#FF0000"><b>do
           Begin
             </b></font>Width<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
             </font>Height<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
             </font>Colors<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>BMPError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
               With </b></font>BMPInfoHeader <font color="#FF0000"><b>do
                 Begin
                   </b></font>Width<font color="#000080">:=</font>BiWidth<font color="#000080">;
                   </font>Height<font color="#000080">:=</font>BiHeight<font color="#000080">;
                     </font><font color="#FF0000"><b>Case </b></font>BiBitCount <font color="#FF0000"><b>of
                       </b></font><font color="#800000">1  </font><font color="#000080">: </font>Colors<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
                       </font><font color="#800000">4  </font><font color="#000080">: </font>Colors<font color="#000080">:=</font><font color="#800000">16</font><font color="#000080">;
                       </font><font color="#800000">8  </font><font color="#000080">: </font>Colors<font color="#000080">:=</font><font color="#800000">256</font><font color="#000080">;
                       </font><font color="#800000">24 </font><font color="#000080">: </font>Colors<font color="#000080">:=</font><font color="#800000">16777216</font><font color="#000080">;
                       </font><font color="#FF0000"><b>else </b></font>Colors<font color="#000080">:=</font><font color="#800000">0
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Info<font color="#000080">.</font>Colors<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
                     With </b></font>Palette <font color="#000080">[</font>I<font color="#000080">], </font>RGBColors <font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>do
                       Begin
                         </b></font>Red<font color="#000080">:=</font>RGBRed<font color="#000080">;
                         </font>Green<font color="#000080">:=</font>RGBGreen<font color="#000080">;
                         </font>Blue<font color="#000080">:=</font>RGBBlue
                       <font color="#FF0000"><b>End
                 End
           End
       End</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>Begin
       </b></font>BMPError<font color="#000080">:=</font><font color="#800000">3
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ---------------------- Demo program ---------------------- }

</i></font><font color="#FF0000"><b>Program </b></font>LoadBMP<font color="#000080">;

  </font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">, </font>Graph<font color="#000080">, </font>BMP<font color="#000080">;

  </font><font color="#FF0000"><b>Const </b></font>VGA256 <font color="#000080">= </font>False<font color="#000080">;

  </font><font color="#FF0000"><b>Var </b></font>Gd<font color="#000080">, </font>Gm<font color="#000080">, </font>Result    <font color="#000080">: </font>integer<font color="#000080">;
      </font>AutoDetectPointer <font color="#000080">: </font>pointer<font color="#000080">;

</font><font color="#008000"><i>{$F+}
  </i></font><font color="#FF0000"><b>Function </b></font>DetectCard<font color="#000080">:</font>integer<font color="#000080">;
    </font><font color="#FF0000"><b>Var </b></font>DetectedDriver<font color="#000080">, </font>SuggestedMode <font color="#000080">: </font>integer<font color="#000080">;
      </font><font color="#FF0000"><b>Begin
        </b></font>DetectGraph <font color="#000080">(</font>DetectedDriver<font color="#000080">,</font>SuggestedMode<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DetectedDriver<font color="#000080">=</font>VGA<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>DetectedDriver<font color="#000080">=</font>MCGA<font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>DetectCard<font color="#000080">:=</font>grOk
                                                         <font color="#FF0000"><b>else
          </b></font>DetectCard<font color="#000080">:=</font>grError
      <font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{$F-}

  </i></font><font color="#FF0000"><b>Procedure </b></font>InitGraph256<font color="#000080">;
    </font><font color="#FF0000"><b>Var </b></font>Gd<font color="#000080">, </font>Gm<font color="#000080">, </font>ErrorCode <font color="#000080">: </font>integer<font color="#000080">;
      </font><font color="#FF0000"><b>Begin
        </b></font>AutoDetectPointer<font color="#000080">:=@</font>DetectCard<font color="#000080">;
        </font>Gd<font color="#000080">:=</font>InstallUserDriver <font color="#000080">(</font><font color="#800000">'VGA256'</font><font color="#000080">,</font>AutoDetectPointer<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>GraphResult<font color="#000080">&lt;&gt;</font>grOk <font color="#FF0000"><b>then
          Begin
            </b></font>Writeln <font color="#000080">(</font><font color="#800000">'Error installing driver'</font><font color="#000080">);
            </font>Halt
          <font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>Gd<font color="#000080">:=</font>Detect<font color="#000080">;
        </font>InitGraph <font color="#000080">(</font>Gd<font color="#000080">,</font>Gm<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
        </font>ErrorCode<font color="#000080">:=</font>GraphResult<font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>ErrorCode<font color="#000080">&lt;&gt;</font>grOk <font color="#FF0000"><b>then
          Begin
            </b></font>Writeln <font color="#000080">(</font><font color="#800000">'Error: '</font><font color="#000080">,</font>GraphErrorMsg <font color="#000080">(</font>ErrorCode<font color="#000080">));
            </font>Halt
          <font color="#FF0000"><b>End
      End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Begin
      If </b></font>VGA256 <font color="#FF0000"><b>then
        </b></font>InitGraph256
                    <font color="#FF0000"><b>else
        Begin
          </b></font>DetectGraph <font color="#000080">(</font>Gd<font color="#000080">,</font>Gm<font color="#000080">);
          </font>InitGraph <font color="#000080">(</font>Gd<font color="#000080">,</font>Gm<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">)
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>ReadBMP <font color="#000080">(</font><font color="#800000">'\WINDOWS\TARTAN.BMP'</font><font color="#000080">);
      </font>Write <font color="#000080">(</font><font color="#800000">#7</font><font color="#000080">);
      </font>Result<font color="#000080">:=</font>BMPResult<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Result<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then Repeat Until </b></font>ReadKey<font color="#000080">&lt;&gt;</font><font color="#800000">''</font><font color="#000080">;
      </font>CloseGraph<font color="#000080">;
      </font>Writeln <font color="#000080">(</font><font color="#800000">'BMP status = '</font><font color="#000080">,</font>BMPErrorMsg <font color="#000080">(</font>Result<font color="#000080">))
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0247.PAS">Original</a><b>]</b></p></body>
</html>
