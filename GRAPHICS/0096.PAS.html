<html>
<head><title> "Wormhole" by ALEX CHALFIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0096.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
MSGID: 1:108/180 868965DB
Well, here is the cool wormhole program that everybody has been awaiting.

It consists of three programs, WGEN, PGEN, and WORMHOLE. The WGen program
generates the data file for the wormhole. PGen generates a palette file
for the wormhole. WORMHOLE actually runs the program once everything is done.

************  Listing of WGEN.PAS
}

{$N+,E+,G+}
</i></font><font color="#FF0000"><b>Program </b></font>WGen<font color="#000080">;
</font><font color="#008000"><i>{actually generates the Wormhole, SLOW}
{ math co-processor HIGHLY recommended }

</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>Stretch <font color="#000080">= </font><font color="#800000">25</font><font color="#000080">;     </font>XCenter <font color="#000080">= </font><font color="#800000">160</font><font color="#000080">;
  </font>YCenter <font color="#000080">= </font><font color="#800000">50</font><font color="#000080">;     </font>DIVS <font color="#000080">= </font><font color="#800000">1200</font><font color="#000080">;
  </font>SPOKES <font color="#000080">= </font><font color="#800000">2400</font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TransArray<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>x<font color="#000080">, </font>y<font color="#000080">, </font>z <font color="#000080">: </font>Real<font color="#000080">;
  </font>i<font color="#000080">, </font>j<font color="#000080">, </font>color <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  For </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>DIVS <font color="#FF0000"><b>do
    Begin
      For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>Spokes<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
        Begin
          </b></font>z <font color="#000080">:= (-</font><font color="#800000">1.0</font><font color="#000080">)+(</font>Ln<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>j<font color="#000080">/</font>DIVS<font color="#000080">));
          </font>x <font color="#000080">:= (</font><font color="#800000">320.0</font><font color="#000080">*</font>j<font color="#000080">/</font>DIVS<font color="#000080">*</font>cos<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">*</font>Pi<font color="#000080">*</font>i<font color="#000080">/</font>SPOKES<font color="#000080">));
          </font>y <font color="#000080">:= (</font><font color="#800000">240.0</font><font color="#000080">*</font>j<font color="#000080">/</font>DIVS<font color="#000080">*</font>sin<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">*</font>Pi<font color="#000080">*</font>i<font color="#000080">/</font>Spokes<font color="#000080">));
          </font>y <font color="#000080">:= </font>y<font color="#000080">-</font>STRETCH<font color="#000080">*</font>z<font color="#000080">;
          </font>x <font color="#000080">:= </font>x <font color="#000080">+ </font>XCenter<font color="#000080">;
          </font>y <font color="#000080">:= </font>y <font color="#000080">+ </font>YCenter<font color="#000080">;
          </font>Color <font color="#000080">:= (</font>Round<font color="#000080">(</font>i<font color="#000080">/</font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Mod </b></font><font color="#800000">15</font><font color="#000080">)+</font><font color="#800000">15</font><font color="#000080">*(</font>Round<font color="#000080">(</font>j<font color="#000080">/</font><font color="#800000">6</font><font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">15</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>X<font color="#000080">&gt;=</font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>x<font color="#000080">&lt;</font><font color="#800000">320</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>Y<font color="#000080">&gt;=</font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>y<font color="#000080">&lt;</font><font color="#800000">200</font><font color="#000080">))
            </font><font color="#FF0000"><b>Then </b></font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Round<font color="#000080">(</font>x<font color="#000080">) + (</font>Round<font color="#000080">(</font>y<font color="#000080">) * </font><font color="#800000">320</font><font color="#000080">)] := </font>Color<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SaveImage<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Diskfile <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Assign<font color="#000080">(</font>Diskfile<font color="#000080">, </font><font color="#800000">'Ln.DAT'</font><font color="#000080">);
  </font>Rewrite<font color="#000080">(</font>Diskfile<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">199 </font><font color="#FF0000"><b>do
    For </b></font>j <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">319 </font><font color="#FF0000"><b>do
      </b></font>Write<font color="#000080">(</font>Diskfile<font color="#000080">, </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>j <font color="#000080">+ (</font><font color="#800000">320 </font><font color="#000080">* </font>i<font color="#000080">)]);
  </font>Close<font color="#000080">(</font>Diskfile<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  Asm  </b></font><font color="#FF00FF">MOV  AX,$13; INT $10; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>FillChar<font color="#000080">(</font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font><font color="#800000">$0000</font><font color="#000080">], </font><font color="#800000">64000</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font>transarray<font color="#000080">;
  </font>SaveImage<font color="#000080">;
  </font><font color="#FF0000"><b>Asm </b></font><font color="#FF00FF">MOV  AX,3; INT $10; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0096.PAS">Original</a><b>]</b></p></body>
</html>
