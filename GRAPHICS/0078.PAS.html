<html>
<head><title> "Loading PCX Files" by OLAF BARTELT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0078.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{

 SL&gt; Does someone has a pascalsource for showing a PCX file with a resolution
 SL&gt; of 640x400x256 /or a automatic build-in convertor who wil let the drawing

Sure thing, the following code will load PCX files with 256 colors and variable
height and width (it looks into the header):  (Sorry about the german comments,
but I've got no time to erase them right now :-(( ) }

</i></font><font color="#FF0000"><b>UNIT </b></font>uVESAPcx<font color="#000080">;                                </font><font color="#008000"><i>{ (c) 1993 by NEBULA-Software }
     { PCX-Darstellungsroutinen f. VESA     } { Olaf Bartelt &amp; Oliver Carow }

</i></font><font color="#FF0000"><b>INTERFACE                                     </b></font><font color="#008000"><i>{ Interface-Teil der Unit     }

{ &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml; Typen &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml; }
</i></font><font color="#FF0000"><b>TYPE  </b></font>pVESAPcx   <font color="#000080">= ^</font>tVESAPcx<font color="#000080">;                 </font><font color="#008000"><i>{ Zeiger auf Objekt           }
      </i></font>tVESAPcx   <font color="#000080">= </font><font color="#FF0000"><b>OBJECT                     </b></font><font color="#008000"><i>{ Objekt fÅr PCX-Dateien      }
                     </i></font><font color="#FF0000"><b>PROCEDURE </b></font>load<font color="#000080">(</font>f <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>dx<font color="#000080">, </font>dy <font color="#000080">: </font>WORD<font color="#000080">);
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml; Variablen &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml; }
</i></font><font color="#FF0000"><b>VAR   </b></font>vVESAPcx  <font color="#000080">: </font>pVESAPcx<font color="#000080">;                   </font><font color="#008000"><i>{ Instanz des Objekts tPcx    }


</i></font><font color="#FF0000"><b>IMPLEMENTATION                                </b></font><font color="#008000"><i>{ Implementation-Teil d. Unit }

</i></font><font color="#FF0000"><b>USES </b></font>uVesa<font color="#000080">;                                   </font><font color="#008000"><i>{ Einbinden der Units         }
{ CAN BE FOUND IN SWAG }

{ &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml; tVESAPcx &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml; }
</i></font><font color="#FF0000"><b>PROCEDURE  </b></font>tVESAPcx<font color="#000080">.</font>load<font color="#000080">(</font>f <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>dx<font color="#000080">, </font>dy <font color="#000080">: </font>WORD<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>q                          <font color="#000080">: </font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;
    </font>b                          <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2047</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
    </font>anz<font color="#000080">, </font>pos<font color="#000080">, </font>c<font color="#000080">, </font>w<font color="#000080">, </font>h<font color="#000080">, </font>e<font color="#000080">, </font>pack <font color="#000080">: </font>WORD<font color="#000080">;
    </font>x<font color="#000080">, </font>y                       <font color="#000080">: </font>WORD<font color="#000080">;

</font><font color="#FF0000"><b>LABEL </b></font>ende_background<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>x <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font>ASSIGN<font color="#000080">(</font>q<font color="#000080">, </font>f<font color="#000080">); </font><font color="#008000"><i>{$I-} </i></font>RESET<font color="#000080">(</font>q<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>IF </b></font>IORESULT <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
    GOTO </b></font>ende_background<font color="#000080">;

  </font>BLOCKREAD<font color="#000080">(</font>q<font color="#000080">, </font>b<font color="#000080">, </font><font color="#800000">128</font><font color="#000080">, </font>anz<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>b<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &lt;&gt; </font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>b<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] &lt;&gt; </font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font>CLOSE<font color="#000080">(</font>q<font color="#000080">);
    </font>EXIT<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>w <font color="#000080">:= </font>SUCC<font color="#000080">((</font>b<font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] - </font>b<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]) </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8 </font><font color="#000080">+ </font>b<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">] - </font>b<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
  </font>h <font color="#000080">:= </font>SUCC<font color="#000080">((</font>b<font color="#000080">[</font><font color="#800000">11</font><font color="#000080">] - </font>b<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">]) </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8 </font><font color="#000080">+ </font>b<font color="#000080">[</font><font color="#800000">10</font><font color="#000080">] - </font>b<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]);
  </font>pack <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>c <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>e <font color="#000080">:= </font>y <font color="#000080">+ </font>h<font color="#000080">;
  </font><font color="#FF0000"><b>REPEAT
    </b></font>BLOCKREAD<font color="#000080">(</font>q<font color="#000080">, </font>b<font color="#000080">, </font><font color="#800000">2048</font><font color="#000080">, </font>anz<font color="#000080">);
    </font>pos <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>pos <font color="#000080">&lt; </font>anz<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>y <font color="#000080">&lt; </font>e<font color="#000080">) </font><font color="#FF0000"><b>DO
    BEGIN
      IF </b></font>pack <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      BEGIN
        FOR </b></font>c <font color="#000080">:= </font>c <font color="#FF0000"><b>TO </b></font>c <font color="#000080">+ </font>pack <font color="#FF0000"><b>DO
          </b></font>vVesa<font color="#000080">^.</font>putpixel<font color="#000080">(</font>x <font color="#000080">+ </font>c<font color="#000080">+</font>dx<font color="#000080">, </font>y<font color="#000080">+</font>dy<font color="#000080">, </font>b<font color="#000080">[</font>pos<font color="#000080">]);
        </font>pack <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>END
      ELSE
        IF </b></font><font color="#000080">(</font>b<font color="#000080">[</font>pos<font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$C0</font><font color="#000080">) = </font><font color="#800000">$C0 </font><font color="#FF0000"><b>THEN
          </b></font>pack <font color="#000080">:= </font>b<font color="#000080">[</font>pos<font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$3F
        </font><font color="#FF0000"><b>ELSE
        BEGIN
          </b></font>vVesa<font color="#000080">^.</font>putpixel<font color="#000080">(</font>x <font color="#000080">+ </font>c<font color="#000080">+</font>dx<font color="#000080">, </font>y<font color="#000080">+</font>dy<font color="#000080">, </font>b<font color="#000080">[</font>pos<font color="#000080">]);
          </font>INC<font color="#000080">(</font>c<font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>INC<font color="#000080">(</font>pos<font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>c <font color="#000080">= </font>w <font color="#FF0000"><b>THEN
      BEGIN
        </b></font>c <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font>INC<font color="#000080">(</font>y<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>anz <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>y <font color="#000080">= </font>e<font color="#000080">);
  </font>SEEK<font color="#000080">(</font>q<font color="#000080">, </font>FILESIZE<font color="#000080">(</font>q<font color="#000080">) - </font><font color="#800000">3 </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8 </font><font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
  </font>BLOCKREAD<font color="#000080">(</font>q<font color="#000080">, </font>b<font color="#000080">, </font><font color="#800000">3 </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>b<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] = </font><font color="#800000">12 </font><font color="#FF0000"><b>THEN
    FOR </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">3 </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8 </font><font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
      </b></font>b<font color="#000080">[</font>x<font color="#000080">] := </font>b<font color="#000080">[</font>x<font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">2</font><font color="#000080">;
  </font>CLOSE<font color="#000080">(</font>q<font color="#000080">);

  </font>ende_background<font color="#000080">:
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>{ &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml; Hauptprogramm &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml; }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>NEW<font color="#000080">(</font>vVESAPcx<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>Remember <font color="#FF0000"><b>to </b></font>put <font color="#FF0000"><b>in </b></font><font color="#000080">*</font>your<font color="#000080">* </font>putpixel routines there<font color="#000080">!

</font>scroll from top till bottom<font color="#000080">.(</font>VGA<font color="#000080">/</font>SVGAcompat<font color="#000080">./</font>TPASCAL6<font color="#000080">.</font><font color="#800000">0</font><font color="#000080">)

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0078.PAS">Original</a><b>]</b></p></body>
</html>
