<html>
<head><title> "RE: PLASMA  (revisited)" by KAARE BOEEGH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0090.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
{TITLE: Plasma  FROM: Kaare Boeegh  DATE: Sun Apr 17 1994 08:25 pm}
{$A+,B-,D-,E-,F+,G+,I-,L-,N-,O-,R-,S-,V-,X-}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>plasma<font color="#000080">;

</font><font color="#FF0000"><b>CONST </b></font>ys <font color="#000080">: </font>BYTE <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
      </font>yt <font color="#000080">: </font>BYTE <font color="#000080">= </font><font color="#800000">255</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR </b></font>ft   <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">512</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
    </font>sint <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">256</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
    </font>i1<font color="#000080">,</font>a<font color="#000080">,</font>b<font color="#000080">,</font>d<font color="#000080">,</font>c<font color="#000080">,</font>od<font color="#000080">,</font>color<font color="#000080">,</font>e<font color="#000080">,</font>y <font color="#000080">: </font>BYTE<font color="#000080">;
    </font>x<font color="#000080">,</font>k<font color="#000080">,</font>i                   <font color="#000080">: </font>WORD<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>do_tables<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>WORD<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">512 </font><font color="#FF0000"><b>DO   </b></font>FT <font color="#000080">[</font>i<font color="#000080">] := </font>ROUND<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">+</font><font color="#800000">63</font><font color="#000080">*</font>SIN<font color="#000080">(</font>i<font color="#000080">/</font><font color="#800000">40.74</font><font color="#000080">));
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">256 </font><font color="#FF0000"><b>DO </b></font>SINT <font color="#000080">[</font>i<font color="#000080">] := </font>ROUND<font color="#000080">(</font><font color="#800000">128</font><font color="#000080">+</font><font color="#800000">127</font><font color="#000080">*</font>SIN<font color="#000080">(</font>i<font color="#000080">/</font><font color="#800000">40.74</font><font color="#000080">))-</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>do_palette<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>WORD<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>PORT<font color="#000080">[</font><font color="#800000">$3C8</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">255 </font><font color="#FF0000"><b>DO
      BEGIN
        </b></font>PORT<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>i <font color="#FF0000"><b>DIV </b></font><font color="#800000">4</font><font color="#000080">;
        </font>PORT<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>i <font color="#FF0000"><b>DIV </b></font><font color="#800000">6</font><font color="#000080">;
        </font>PORT<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>i <font color="#FF0000"><b>DIV </b></font><font color="#800000">8</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  ASM
    </b></font><font color="#FF00FF">mov al,ys
    mov y,al
    mov ax,0013h;
    int 10h;      </font><font color="#008000"><i>{Set Mode $13}

    </i></font><font color="#FF00FF">mov dx,3d4h   </font><font color="#008000"><i>{Go into Double Height Pixel Mode}
    </i></font><font color="#FF00FF">mov al,9
    out dx,al
    inc dx
    in al,dx
    and al,0e0h
    add al,3
    out dx,al

    call do_palette;
    call do_tables;

@3: inc i1  </font><font color="#008000"><i>{Main Loop}                                          {Grid Counter}
    </i></font><font color="#FF00FF">sub c,2
    inc od
    mov al,od
    mov d,al

    mov al,ys                          </font><font color="#008000"><i>{Alternate Starting Position every pass}
    </i></font><font color="#FF00FF">mov ah,yt
    xchg al,ah
    mov ys,al
    mov ah,yt
    mov y,al

  @2: mov al,y                 </font><font color="#008000"><i>{Calculate Offset and add one every second line}
      </i></font><font color="#FF00FF">mov bx,320
      mul bx
      mov bx,ax
      mov al,y
      mov ah,0
      and al,1
      add ax,bx
      mov k,ax

      mov al,i1                   </font><font color="#008000"><i>{move grid one pixel down every second frame}
      </i></font><font color="#FF00FF">mov ah,0
      and al,1
      mov ah,0
      mov bx,320
      mul bx

      mov bx,k
      sub bx,ax
      mov k,bx

      mov al,d
      add al,2
      mov d,al

      mov al,c           </font><font color="#008000"><i>{[(c}
      </i></font><font color="#FF00FF">add al,y           </font><font color="#008000"><i>{+y)}
      </i></font><font color="#FF00FF">and ax,255         </font><font color="#008000"><i>{and 255]}
      </i></font><font color="#FF00FF">mov di,offset sint </font><font color="#008000"><i>{get sint mem location}
      </i></font><font color="#FF00FF">add di,ax          </font><font color="#008000"><i>{[c+y] and 255}
      </i></font><font color="#FF00FF">mov al,ds:[di]     </font><font color="#008000"><i>{sint[(c+y) and 255]}
      </i></font><font color="#FF00FF">mov a,al

      mov di,offset sint
      mov al,d
      and al,255
      add di,ax
      mov al,ds:[di]
      mov b,al

      mov ax,0
      mov bx,0
      mov cx,0

    @1: mov di,offset ft    </font><font color="#008000"><i>{get ft mem location}
        </i></font><font color="#FF00FF">mov al,a            </font><font color="#008000"><i>{a}
        </i></font><font color="#FF00FF">add al,b            </font><font color="#008000"><i>{+b}
        </i></font><font color="#FF00FF">add di,ax           </font><font color="#008000"><i>{[a+b]}
        </i></font><font color="#FF00FF">mov al,ds:[di]      </font><font color="#008000"><i>{ft[a+b]}
        </i></font><font color="#FF00FF">mov bx,ax           </font><font color="#008000"><i>{Store}
        </i></font><font color="#FF00FF">inc bx              </font><font color="#008000"><i>{+1}
        </i></font><font color="#FF00FF">mov di,offset ft    </font><font color="#008000"><i>{get ft mem location}
        </i></font><font color="#FF00FF">mov al,y            </font><font color="#008000"><i>{y}
        </i></font><font color="#FF00FF">add al,b            </font><font color="#008000"><i>{+b}
        </i></font><font color="#FF00FF">add di,ax           </font><font color="#008000"><i>{[y+b]}
        </i></font><font color="#FF00FF">mov ax,ds:[di]      </font><font color="#008000"><i>{ft[y+b]}
        </i></font><font color="#FF00FF">add ax,bx           </font><font color="#008000"><i>{+}
        </i></font><font color="#FF00FF">mov color,al        </font><font color="#008000"><i>{color:=}

        </i></font><font color="#FF00FF">mov bx,0a000h       </font><font color="#008000"><i>{screen memory location}
        </i></font><font color="#FF00FF">mov es,bx           </font><font color="#008000"><i>{mov it to es}
        </i></font><font color="#FF00FF">mov di,k            </font><font color="#008000"><i>{k is screen offset}


        </i></font><font color="#FF00FF">mov es:[di+80],al      </font><font color="#008000"><i>{plot color to screen}
                 { ^^ center}
        </i></font><font color="#FF00FF">mov al,b
        add al,2
        mov b,al

        mov ax,k </font><font color="#008000"><i>{Ofs of Plasma Pixel, Increased by 2 to Create the Grid}
        </i></font><font color="#FF00FF">add ax,2
        mov k,ax

        mov ah,0                                  </font><font color="#008000"><i>{INC(a,1+color SHR 7);}
        </i></font><font color="#FF00FF">mov al,color
        shr al,7
        add al,1
        mov ah,0
        mov bl,al
        mov al,a
        add al,bl
        mov a,al

        inc cx
        cmp cx,80  </font><font color="#008000"><i>{160}
        </i></font><font color="#FF00FF">jnz @1     </font><font color="#008000"><i>{inner loop}

      </i></font><font color="#FF00FF">inc y
      cmp y,101
      jnz @2     </font><font color="#008000"><i>{outer loop, number of lines}

    </i></font><font color="#FF00FF">mov ah,01h
    int 16h
    jz @3      </font><font color="#008000"><i>{get keypress}

    </i></font><font color="#FF00FF">mov ax,03h </font><font color="#008000"><i>{mode 3}
    </i></font><font color="#FF00FF">int 10h
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
-----------------------------------------------------------------------------
</font>Shipley
<font color="#000080">--- </font>Synchronet
 <font color="#000080">* </font>Origin<font color="#000080">: </font>The Brook Forest Inn <font color="#000080">[</font><font color="#800000">714</font><font color="#000080">] </font><font color="#800000">951</font><font color="#000080">-</font><font color="#800000">5282 </font><font color="#000080">(</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">103</font><font color="#000080">/</font><font color="#800000">950</font><font color="#000080">)
</font>                              
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0090.PAS">Original</a><b>]</b></p></body>
</html>
