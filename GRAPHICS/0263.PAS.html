<html>
<head><title> "TWEAK source of fastest known ellipse" by GERD.PLATL@SIEMENS.AT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0263.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$A+,B+,G-,I-,O-,V-,D-,L-,Q-,R-,S-,E-,N-  TP 7.0 Opt.}

</i></font><font color="#FF0000"><b>program </b></font>FastEllipseDrawingDemo320x400<font color="#000080">;    </font><font color="#008000"><i>{02-05-96}

</i></font><font color="#FF0000"><b>uses  </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#008000"><i>{********************************************************}
</i></font><font color="#FF0000"><b>procedure </b></font>SetTweakedMode320x400<font color="#000080">;

</font><font color="#FF0000"><b>var   </b></font>r<font color="#000080">: </font>registers<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>r<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$13</font><font color="#000080">;   </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>r<font color="#000080">);  </font><font color="#008000"><i>{video mode 19: 320x200/256}
  </i></font>portw<font color="#000080">[</font><font color="#800000">$3c4</font><font color="#000080">] := </font><font color="#800000">$0604</font><font color="#000080">;      </font><font color="#008000"><i>{&gt;64KByte Video-Ram, chain4 mode off}
  </i></font>portw<font color="#000080">[</font><font color="#800000">$3d4</font><font color="#000080">] := </font><font color="#800000">$4009</font><font color="#000080">;      </font><font color="#008000"><i>{max. scan line = 400}
  </i></font>portw<font color="#000080">[</font><font color="#800000">$3d4</font><font color="#000080">] := </font><font color="#800000">$0014</font><font color="#000080">;      </font><font color="#008000"><i>{word mode}
  </i></font>portw<font color="#000080">[</font><font color="#800000">$3d4</font><font color="#000080">] := </font><font color="#800000">$E317</font><font color="#000080">;      </font><font color="#008000"><i>{mode control}
  </i></font>FillChar <font color="#000080">(</font>ptr<font color="#000080">(</font><font color="#800000">$A000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)^, </font><font color="#800000">$8000</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);  </font><font color="#008000"><i>{clear memory}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{*********************************************************}
</i></font><font color="#FF0000"><b>procedure </b></font>PutPixel <font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">: </font>integer<font color="#000080">; </font>color<font color="#000080">: </font>word<font color="#000080">);

</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{ if x &lt; 0 then exit;
  if y &lt; 0 then exit; }
  </i></font>port<font color="#000080">[</font><font color="#800000">$03C4</font><font color="#000080">] := </font><font color="#800000">2</font><font color="#000080">;            </font><font color="#008000"><i>{plane selection}
  </i></font>port<font color="#000080">[</font><font color="#800000">$03C5</font><font color="#000080">] := </font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font><font color="#000080">(</font>x <font color="#FF0000"><b>and </b></font><font color="#800000">3</font><font color="#000080">);
  </font>mem <font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">: </font>word <font color="#000080">(</font>y <font color="#FF0000"><b>shl </b></font><font color="#800000">6 </font><font color="#000080">+ </font>y <font color="#FF0000"><b>shl </b></font><font color="#800000">4 </font><font color="#000080">+ (</font>x <font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">))] := </font>color<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{*********************************************************}
</i></font><font color="#FF0000"><b>procedure </b></font>DrawEllipse <font color="#000080">(</font>mx<font color="#000080">,</font>my<font color="#000080">, </font>a<font color="#000080">,</font>b<font color="#000080">, </font>color<font color="#000080">: </font>integer<font color="#000080">);

</font><font color="#FF0000"><b>var   </b></font>x<font color="#000080">,  </font>mx1<font color="#000080">,</font>mx2<font color="#000080">,  </font>my1<font color="#000080">,</font>my2<font color="#000080">: </font>integer<font color="#000080">;
      </font>aq<font color="#000080">,</font>bq<font color="#000080">, </font>dx<font color="#000080">,</font>dy<font color="#000080">, </font>r<font color="#000080">,</font>rx<font color="#000080">,</font>ry<font color="#000080">: </font>longint<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>PutPixel <font color="#000080">(</font>mx <font color="#000080">+ </font>a<font color="#000080">, </font>my<font color="#000080">, </font>color<font color="#000080">);
  </font>PutPixel <font color="#000080">(</font>mx <font color="#000080">- </font>a<font color="#000080">, </font>my<font color="#000080">, </font>color<font color="#000080">);

  </font>mx1 <font color="#000080">:= </font>mx <font color="#000080">- </font>a<font color="#000080">;   </font>my1 <font color="#000080">:= </font>my<font color="#000080">;
  </font>mx2 <font color="#000080">:= </font>mx <font color="#000080">+ </font>a<font color="#000080">;   </font>my2 <font color="#000080">:= </font>my<font color="#000080">;

  </font>aq <font color="#000080">:= </font>longint <font color="#000080">(</font>a<font color="#000080">) * </font>a<font color="#000080">;        </font><font color="#008000"><i>{calc sqr}
  </i></font>bq <font color="#000080">:= </font>longint <font color="#000080">(</font>b<font color="#000080">) * </font>b<font color="#000080">;
  </font>dx <font color="#000080">:= </font>aq <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">;               </font><font color="#008000"><i>{dx := 2 * a * a}
  </i></font>dy <font color="#000080">:= </font>bq <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">;               </font><font color="#008000"><i>{dy := 2 * b * b}
  </i></font>r  <font color="#000080">:= </font>a <font color="#000080">* </font>bq<font color="#000080">;                 </font><font color="#008000"><i>{r  := a * b * b}
  </i></font>rx <font color="#000080">:= </font>r <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">;                </font><font color="#008000"><i>{rx := 2 * a * b * b}
  </i></font>ry <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                      </font><font color="#008000"><i>{because y = 0}
  </i></font>x <font color="#000080">:= </font>a<font color="#000080">;

  </font><font color="#FF0000"><b>while </b></font>x <font color="#000080">&gt; </font><font color="#800000">0
  </font><font color="#FF0000"><b>do begin
    if </b></font>r <font color="#000080">&gt; </font><font color="#800000">0
    </font><font color="#FF0000"><b>then begin                  </b></font><font color="#008000"><i>{ y + 1 }
      </i></font>inc <font color="#000080">(</font>my1<font color="#000080">);   </font>dec <font color="#000080">(</font>my2<font color="#000080">);
      </font>inc <font color="#000080">(</font>ry<font color="#000080">, </font>dx<font color="#000080">);             </font><font color="#008000"><i>{ry = dx * y}
      </i></font>dec <font color="#000080">(</font>r<font color="#000080">, </font>ry<font color="#000080">);              </font><font color="#008000"><i>{r = r - dx + y}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>r <font color="#000080">&lt;= </font><font color="#800000">0
    </font><font color="#FF0000"><b>then begin                  </b></font><font color="#008000"><i>{ x - 1 }
      </i></font>dec <font color="#000080">(</font>x<font color="#000080">);
      </font>inc <font color="#000080">(</font>mx1<font color="#000080">);   </font>dec <font color="#000080">(</font>mx2<font color="#000080">);
      </font>dec <font color="#000080">(</font>rx<font color="#000080">, </font>dy<font color="#000080">);             </font><font color="#008000"><i>{rx = dy * x}
      </i></font>inc <font color="#000080">(</font>r<font color="#000080">, </font>rx<font color="#000080">);              </font><font color="#008000"><i>{r = r + dy * x}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>PutPixel <font color="#000080">(</font>mx1<font color="#000080">, </font>my1<font color="#000080">, </font>color<font color="#000080">);
    </font>PutPixel <font color="#000080">(</font>mx1<font color="#000080">, </font>my2<font color="#000080">, </font>color<font color="#000080">);
    </font>PutPixel <font color="#000080">(</font>mx2<font color="#000080">, </font>my1<font color="#000080">, </font>color<font color="#000080">);
    </font>PutPixel <font color="#000080">(</font>mx2<font color="#000080">, </font>my2<font color="#000080">, </font>color<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{*********************************************************}
</i></font><font color="#FF0000"><b>const </b></font>maxX <font color="#000080">= </font><font color="#800000">319</font><font color="#000080">;   </font>maxY <font color="#000080">= </font><font color="#800000">399</font><font color="#000080">;

</font><font color="#FF0000"><b>var   </b></font>a<font color="#000080">,</font>b<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>SetTweakedMode320x400<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>a <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">+</font>Random <font color="#000080">(</font><font color="#800000">100</font><font color="#000080">);
    </font>b <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">+</font>Random <font color="#000080">(</font><font color="#800000">100</font><font color="#000080">);
    </font>DrawEllipse <font color="#000080">(</font>a <font color="#000080">+ </font>Random <font color="#000080">(</font>maxX <font color="#000080">- </font><font color="#800000">2 </font><font color="#000080">* </font>a<font color="#000080">),
                 </font>b <font color="#000080">+ </font>Random <font color="#000080">(</font>maxY <font color="#000080">- </font><font color="#800000">2 </font><font color="#000080">* </font>b<font color="#000080">), </font>a<font color="#000080">,</font>b<font color="#000080">,
                 </font><font color="#800000">1 </font><font color="#000080">+ </font>Random <font color="#000080">(</font><font color="#800000">255</font><font color="#000080">));
  </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
  </font>TextMode<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0263.PAS">Original</a><b>]</b></p></body>
</html>
