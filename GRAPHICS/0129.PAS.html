<html>
<head><title> "Transparent 3D Vectors" by DAVID DAHL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0129.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Program </b></font>TrnsVect<font color="#000080">; </font><font color="#008000"><i>{ Transparent Vectors }
{$G+} { 286 Instructions Enabled }

{  Transparent 3D Vectors Example  }
{     Programmed by David Dahl     }
{  This program is PUBLIC DOMAIN   }

</i></font><font color="#FF0000"><b>Uses </b></font>CRT<font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>ViewerDist <font color="#000080">= </font><font color="#800000">200</font><font color="#000080">;
</font><font color="#FF0000"><b>Type </b></font>VGAArray <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">199</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">319</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
     </font>VGAPtr   <font color="#000080">= ^</font>VGAArray<font color="#000080">;
     </font>PaletteRec  <font color="#000080">= </font><font color="#FF0000"><b>Record
                         </b></font>Red   <font color="#000080">: </font>Byte<font color="#000080">;
                         </font>Green <font color="#000080">: </font>Byte<font color="#000080">;
                         </font>Blue  <font color="#000080">: </font>Byte<font color="#000080">;
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>PaletteType <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>PaletteRec<font color="#000080">;
     </font>PalettePtr  <font color="#000080">= ^</font>PaletteType<font color="#000080">;
     </font>PolyRaster  <font color="#000080">= </font><font color="#FF0000"><b>Record
                         </b></font>X1 <font color="#000080">: </font>Word<font color="#000080">;
                         </font>X2 <font color="#000080">: </font>Word<font color="#000080">;
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>PolyFill    <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">199</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>PolyRaster<font color="#000080">;
     </font>PolyFillPtr <font color="#000080">= ^</font>PolyFill<font color="#000080">;
     </font>FacetPtr     <font color="#000080">= ^</font>PolyFacet<font color="#000080">;
     </font>PolyFacet    <font color="#000080">= </font><font color="#FF0000"><b>Record
                          </b></font>Color       <font color="#000080">: </font>Byte<font color="#000080">;
                          </font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>Z1<font color="#000080">,
                          </font>X2<font color="#000080">, </font>Y2<font color="#000080">, </font>Z2<font color="#000080">,
                          </font>X3<font color="#000080">, </font>Y3<font color="#000080">, </font>Z3<font color="#000080">,
                          </font>X4<font color="#000080">, </font>Y4<font color="#000080">, </font>Z4  <font color="#000080">: </font>Integer<font color="#000080">;
                          </font>NextFacet   <font color="#000080">: </font>FacetPtr<font color="#000080">;
                    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>PolyHPtr     <font color="#000080">= ^</font>PolygonHead<font color="#000080">;
     </font>PolygonHead  <font color="#000080">= </font><font color="#FF0000"><b>Record
                          </b></font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Z    <font color="#000080">: </font>Integer<font color="#000080">;
                          </font>AX<font color="#000080">, </font>AY<font color="#000080">, </font>AZ <font color="#000080">: </font>Integer<font color="#000080">;
                          </font>FirstFacet <font color="#000080">: </font>FacetPtr<font color="#000080">;
                    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var  </b></font>VGAMEM   <font color="#000080">: </font>VGAPtr<font color="#000080">;
     </font>WorkPage <font color="#000080">: </font>VGAPtr<font color="#000080">;
     </font>BkgPage  <font color="#000080">: </font>VGAPtr<font color="#000080">;
     </font>Palette  <font color="#000080">: </font>PalettePtr<font color="#000080">;
     </font>PolyList <font color="#000080">: </font>PolyFillPtr<font color="#000080">;
</font><font color="#008000"><i>{-[ Initialize 320 X 200 X 256 VGA ]---------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>GoMode13h<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">MOV AX, $0013
   INT $10
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{=[ Convex Polygon Drawing Routines ]======================================}
{-[ Clear Polygon Raster List ]--------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>ClearPolyList <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>ListIn <font color="#000080">: </font>PolyFill<font color="#000080">);
</font><font color="#FF0000"><b>Begin
     </b></font>FillChar <font color="#000080">(</font>ListIn<font color="#000080">, </font>SizeOf<font color="#000080">(</font>ListIn<font color="#000080">), </font><font color="#800000">$FF</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-[ OR VariableIn with Value -- Modeled after FillChar ]-------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>ORChar <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>VariableIn<font color="#000080">;
                      </font>Size       <font color="#000080">: </font>Word<font color="#000080">;
                      </font>Value      <font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">PUSH DS
   MOV CX, Size
   OR  CX, CX
   JZ  @Done
   LDS SI, VariableIn
   MOV AL, Value
   @ORLoop:
      OR DS:[SI], AL
      INC SI
   LOOP @ORLoop
   @Done:
   POP DS
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-[ Draw Polygon From Raster List To Work Buffer ]-------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>DrawPolyFromList <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>ListIn      <font color="#000080">: </font>PolyFill<font color="#000080">;
                            </font><font color="#FF0000"><b>Var </b></font>FrameBuffer <font color="#000080">: </font>VGAArray<font color="#000080">;
                                </font>Color       <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>YCount <font color="#000080">: </font>Word<font color="#000080">;
    </font>TempX1 <font color="#000080">: </font>Word<font color="#000080">;
    </font>TempX2 <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     For </b></font>YCount <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">199 </font><font color="#FF0000"><b>do
     Begin
          </b></font>TempX1 <font color="#000080">:= </font>ListIn<font color="#000080">[</font>YCount<font color="#000080">].</font>X1<font color="#000080">;
          </font>TempX2 <font color="#000080">:= </font>ListIn<font color="#000080">[</font>YCount<font color="#000080">].</font>X2<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>TempX1 <font color="#000080">&lt;= </font><font color="#800000">319</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>TempX2 <font color="#000080">&lt;= </font><font color="#800000">319</font><font color="#000080">)
          </font><font color="#FF0000"><b>Then
              </b></font>ORChar <font color="#000080">(</font>FrameBuffer<font color="#000080">[</font>YCount<font color="#000080">, </font>TempX1<font color="#000080">],
                      </font>TempX2 <font color="#000080">- </font>TempX1 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>Color<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-[ Add An Element To The Raster List ]------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>AddRasterToPoly <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>ListIn <font color="#000080">: </font>PolyFill<font color="#000080">;
                               </font>X<font color="#000080">, </font>Y   <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
     </b></font><font color="#008000"><i>{ Clip X }
     </i></font><font color="#FF0000"><b>If </b></font>X <font color="#000080">&lt; </font><font color="#800000">0
     </font><font color="#FF0000"><b>Then
         </b></font>X <font color="#000080">:= </font><font color="#800000">0
     </font><font color="#FF0000"><b>Else
         If </b></font>X <font color="#000080">&gt; </font><font color="#800000">319
         </font><font color="#FF0000"><b>Then
             </b></font>X <font color="#000080">:= </font><font color="#800000">319</font><font color="#000080">;
    </font><font color="#008000"><i>{ If Y in bounds, add to list }
    </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Y <font color="#000080">&gt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Y <font color="#000080">&lt;= </font><font color="#800000">199</font><font color="#000080">))
    </font><font color="#FF0000"><b>Then
    Begin
         If </b></font><font color="#000080">(</font>ListIn<font color="#000080">[</font>Y<font color="#000080">].</font>X1 <font color="#000080">&gt; </font><font color="#800000">319</font><font color="#000080">)
         </font><font color="#FF0000"><b>Then
         Begin
             </b></font>ListIn<font color="#000080">[</font>Y<font color="#000080">].</font>X1 <font color="#000080">:= </font>X<font color="#000080">;
             </font>ListIn<font color="#000080">[</font>Y<font color="#000080">].</font>X2 <font color="#000080">:= </font>X<font color="#000080">;
         </font><font color="#FF0000"><b>End
         Else
             If </b></font><font color="#000080">(</font>X <font color="#000080">&lt; </font>ListIn<font color="#000080">[</font>Y<font color="#000080">].</font>X1<font color="#000080">)
             </font><font color="#FF0000"><b>Then
                 </b></font>ListIn<font color="#000080">[</font>Y<font color="#000080">].</font>X1 <font color="#000080">:= </font>X
             <font color="#FF0000"><b>Else
                 If </b></font><font color="#000080">(</font>X <font color="#000080">&gt; </font>ListIn<font color="#000080">[</font>Y<font color="#000080">].</font>X2<font color="#000080">)
                 </font><font color="#FF0000"><b>Then
                     </b></font>ListIn<font color="#000080">[</font>Y<font color="#000080">].</font>X2 <font color="#000080">:= </font>X<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{=[ Polygon ]==============================================================}
{-[ Add A Facet To Current Polygon ]---------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>AddFacet <font color="#000080">(</font>Polygon          <font color="#000080">: </font>PolyHPtr<font color="#000080">;
                    </font>Color            <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>X1In<font color="#000080">, </font>Y1In<font color="#000080">, </font>Z1In <font color="#000080">: </font>Integer<font color="#000080">;
                    </font>X2In<font color="#000080">, </font>Y2In<font color="#000080">, </font>Z2In <font color="#000080">: </font>Integer<font color="#000080">;
                    </font>X3In<font color="#000080">, </font>Y3In<font color="#000080">, </font>Z3In <font color="#000080">: </font>Integer<font color="#000080">;
                    </font>X4In<font color="#000080">, </font>Y4In<font color="#000080">, </font>Z4In <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>CurrentFacet <font color="#000080">: </font>FacetPtr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     If </b></font>Polygon<font color="#000080">^.</font>FirstFacet <font color="#000080">= </font><font color="#FF0000"><b>Nil
     Then
     Begin
          </b></font>New<font color="#000080">(</font>Polygon<font color="#000080">^.</font>FirstFacet<font color="#000080">);
          </font>CurrentFacet <font color="#000080">:= </font>Polygon<font color="#000080">^.</font>FirstFacet<font color="#000080">;
     </font><font color="#FF0000"><b>End
     Else
     Begin
          </b></font>CurrentFacet <font color="#000080">:= </font>Polygon<font color="#000080">^.</font>FirstFacet<font color="#000080">;
          </font><font color="#FF0000"><b>While </b></font>CurrentFacet<font color="#000080">^.</font>NextFacet <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>Nil do
                </b></font>CurrentFacet <font color="#000080">:= </font>CurrentFacet<font color="#000080">^.</font>NextFacet<font color="#000080">;
          </font>New<font color="#000080">(</font>CurrentFacet<font color="#000080">^.</font>NextFacet<font color="#000080">);
          </font>CurrentFacet <font color="#000080">:= </font>CurrentFacet<font color="#000080">^.</font>NextFacet<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>Color <font color="#000080">:= </font>Color<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>X1 <font color="#000080">:= </font>X1In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>X2 <font color="#000080">:= </font>X2In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>X3 <font color="#000080">:= </font>X3In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>X4 <font color="#000080">:= </font>X4In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>Y1 <font color="#000080">:= </font>Y1In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>Y2 <font color="#000080">:= </font>Y2In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>Y3 <font color="#000080">:= </font>Y3In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>Y4 <font color="#000080">:= </font>Y4In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>Z1 <font color="#000080">:= </font>Z1In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>Z2 <font color="#000080">:= </font>Z2In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>Z3 <font color="#000080">:= </font>Z3In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>Z4 <font color="#000080">:= </font>Z4In<font color="#000080">;
     </font>CurrentFacet<font color="#000080">^.</font>NextFacet <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-[ Initialize a New Polygon ]---------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>InitializePolygon <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>PolyHead               <font color="#000080">: </font>PolyHPtr<font color="#000080">;
                                 </font>XIn<font color="#000080">, </font>YIn<font color="#000080">, </font>ZIn          <font color="#000080">: </font>Integer<font color="#000080">;
                                 </font>RollIn<font color="#000080">, </font>PitchIn<font color="#000080">, </font>YawIn <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
     If </b></font>PolyHead <font color="#000080">= </font><font color="#FF0000"><b>Nil
     Then
     Begin
          </b></font>New<font color="#000080">(</font>PolyHead<font color="#000080">);
          </font>PolyHead<font color="#000080">^.</font>X <font color="#000080">:= </font>XIn<font color="#000080">;
          </font>PolyHead<font color="#000080">^.</font>Y <font color="#000080">:= </font>YIn<font color="#000080">;
          </font>PolyHead<font color="#000080">^.</font>Z <font color="#000080">:= </font>ZIn<font color="#000080">;
          </font>PolyHead<font color="#000080">^.</font>AX <font color="#000080">:= </font>RollIn<font color="#000080">;
          </font>PolyHead<font color="#000080">^.</font>AY <font color="#000080">:= </font>PitchIn<font color="#000080">;
          </font>PolyHead<font color="#000080">^.</font>AZ <font color="#000080">:= </font>YawIn<font color="#000080">;
          </font>PolyHead<font color="#000080">^.</font>FirstFacet <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-[ Dispose Polygon ]------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>DisposePolygon <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>PolyHead <font color="#000080">: </font>PolyHPtr<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>TempPtr <font color="#000080">: </font>FacetPtr<font color="#000080">;
    </font>TP2     <font color="#000080">: </font>FacetPtr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>TempPtr <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>FirstFacet<font color="#000080">;
     </font><font color="#FF0000"><b>While </b></font>TempPtr <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>Nil do
     Begin
          </b></font>TP2 <font color="#000080">:= </font>TempPtr<font color="#000080">^.</font>NextFacet<font color="#000080">;
          </font>Dispose <font color="#000080">(</font>TempPtr<font color="#000080">);
          </font>TempPtr <font color="#000080">:= </font>TP2<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>Dispose <font color="#000080">(</font>PolyHead<font color="#000080">);
     </font>PolyHead <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-[ Rotate Polygon About Axies ]-------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>RotatePolygon <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>PolyHead   <font color="#000080">: </font>PolyHPtr<font color="#000080">;
                             </font>DX<font color="#000080">, </font>DY<font color="#000080">, </font>DZ <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
     </b></font>INC <font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AX<font color="#000080">, </font>DX<font color="#000080">);
     </font>INC <font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AY<font color="#000080">, </font>DY<font color="#000080">);
     </font>INC <font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AZ<font color="#000080">, </font>DZ<font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AX <font color="#000080">&gt; </font><font color="#800000">360</font><font color="#000080">) </font><font color="#FF0000"><b>do
           </b></font>DEC<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AX<font color="#000080">, </font><font color="#800000">360</font><font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AY <font color="#000080">&gt; </font><font color="#800000">360</font><font color="#000080">) </font><font color="#FF0000"><b>do
           </b></font>DEC<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AY<font color="#000080">, </font><font color="#800000">360</font><font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AZ <font color="#000080">&gt; </font><font color="#800000">360</font><font color="#000080">) </font><font color="#FF0000"><b>do
           </b></font>DEC<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AZ<font color="#000080">, </font><font color="#800000">360</font><font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AX <font color="#000080">&lt; -</font><font color="#800000">360</font><font color="#000080">) </font><font color="#FF0000"><b>do
           </b></font>INC<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AX<font color="#000080">, </font><font color="#800000">360</font><font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AY <font color="#000080">&lt; -</font><font color="#800000">360</font><font color="#000080">) </font><font color="#FF0000"><b>do
           </b></font>INC<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AY<font color="#000080">, </font><font color="#800000">360</font><font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AZ <font color="#000080">&lt; -</font><font color="#800000">360</font><font color="#000080">) </font><font color="#FF0000"><b>do
           </b></font>INC<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AZ<font color="#000080">, </font><font color="#800000">360</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{=[ Graphics Related Routines ]============================================}
{-[ Build Facet Edge ]-----------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>DrawLine <font color="#000080">(</font>X1In<font color="#000080">, </font>Y1In<font color="#000080">,
                    </font>X2In<font color="#000080">, </font>Y2In  <font color="#000080">: </font>Integer<font color="#000080">;
                    </font>Color       <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>dx<font color="#000080">, </font>dy <font color="#000080">: </font>Integer<font color="#000080">;
    </font>ix<font color="#000080">, </font>iy <font color="#000080">: </font>Integer<font color="#000080">;
    </font>X<font color="#000080">,  </font>Y  <font color="#000080">: </font>Integer<font color="#000080">;
    </font>PX<font color="#000080">, </font>PY <font color="#000080">: </font>Integer<font color="#000080">;
    </font>i      <font color="#000080">: </font>Integer<font color="#000080">;
    </font>incc   <font color="#000080">: </font>Integer<font color="#000080">;
    </font>plot   <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>dx <font color="#000080">:= </font>X1In <font color="#000080">- </font>X2In<font color="#000080">;
     </font>dy <font color="#000080">:= </font>Y1In <font color="#000080">- </font>Y2In<font color="#000080">;
     </font>ix <font color="#000080">:= </font>abs<font color="#000080">(</font>dx<font color="#000080">);
     </font>iy <font color="#000080">:= </font>abs<font color="#000080">(</font>dy<font color="#000080">);
     </font>X  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>Y  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>PX <font color="#000080">:= </font>X1In<font color="#000080">;
     </font>PY <font color="#000080">:= </font>Y1In<font color="#000080">;
     </font>AddRasterToPoly <font color="#000080">(</font>PolyList<font color="#000080">^, </font>PX<font color="#000080">, </font>PY<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>ix <font color="#000080">&gt; </font>iy
     <font color="#FF0000"><b>Then
         </b></font>incc <font color="#000080">:= </font>ix
     <font color="#FF0000"><b>Else
         </b></font>incc <font color="#000080">:= </font>iy<font color="#000080">;
     </font>i <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>incc<font color="#000080">) </font><font color="#FF0000"><b>do
     Begin
          </b></font>Inc <font color="#000080">(</font>X<font color="#000080">, </font>ix<font color="#000080">);
          </font>Inc <font color="#000080">(</font>Y<font color="#000080">, </font>iy<font color="#000080">);
          </font>Plot <font color="#000080">:= </font>False<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>X <font color="#000080">&gt; </font>incc
          <font color="#FF0000"><b>Then
          Begin
               </b></font>Plot <font color="#000080">:= </font>True<font color="#000080">;
               </font>Dec <font color="#000080">(</font>X<font color="#000080">, </font>incc<font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font>dx <font color="#000080">&lt; </font><font color="#800000">0
               </font><font color="#FF0000"><b>Then
                   </b></font>Inc<font color="#000080">(</font>PX<font color="#000080">)
               </font><font color="#FF0000"><b>Else
                   </b></font>Dec<font color="#000080">(</font>PX<font color="#000080">);
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Y <font color="#000080">&gt; </font>incc
          <font color="#FF0000"><b>Then
          Begin
               </b></font>Plot <font color="#000080">:= </font>True<font color="#000080">;
               </font>Dec <font color="#000080">(</font>Y<font color="#000080">, </font>incc<font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font>dy <font color="#000080">&lt; </font><font color="#800000">0
               </font><font color="#FF0000"><b>Then
                   </b></font>Inc<font color="#000080">(</font>PY<font color="#000080">)
               </font><font color="#FF0000"><b>Else
                   </b></font>Dec<font color="#000080">(</font>PY<font color="#000080">);
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Plot
          <font color="#FF0000"><b>Then
              </b></font>AddRasterToPoly <font color="#000080">(</font>PolyList<font color="#000080">^, </font>PX<font color="#000080">, </font>PY<font color="#000080">);
          </font>Inc<font color="#000080">(</font>i<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-[ Draw Polygon ]---------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>DrawPolygon3D <font color="#000080">(</font>PolyHead <font color="#000080">: </font>PolyHPtr<font color="#000080">;
                         </font>Buffer   <font color="#000080">: </font>VGAPtr<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>CurrentFacet               <font color="#000080">: </font>FacetPtr<font color="#000080">;
    </font>CalcX1<font color="#000080">, </font>CalcY1<font color="#000080">, </font>CalcZ1<font color="#000080">,
    </font>CalcX2<font color="#000080">, </font>CalcY2<font color="#000080">, </font>CalcZ2<font color="#000080">,
    </font>CalcX3<font color="#000080">, </font>CalcY3<font color="#000080">, </font>CalcZ3<font color="#000080">,
    </font>CalcX4<font color="#000080">, </font>CalcY4<font color="#000080">, </font>CalcZ4     <font color="#000080">: </font>Integer<font color="#000080">;
    </font>XPrime1<font color="#000080">, </font>YPrime1<font color="#000080">, </font>ZPrime1<font color="#000080">,
    </font>XPrime2<font color="#000080">, </font>YPrime2<font color="#000080">, </font>ZPrime2<font color="#000080">,
    </font>XPrime3<font color="#000080">, </font>YPrime3<font color="#000080">, </font>ZPrime3<font color="#000080">,
    </font>XPrime4<font color="#000080">, </font>YPrime4<font color="#000080">, </font>ZPrime4  <font color="#000080">: </font>Integer<font color="#000080">;
    </font>Temp                       <font color="#000080">: </font>Integer<font color="#000080">;
    </font>CTX<font color="#000080">, </font>STX<font color="#000080">,
    </font>CTY<font color="#000080">, </font>STY<font color="#000080">,
    </font>CTZ<font color="#000080">, </font>STZ  <font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>CurrentFacet <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>FirstFacet<font color="#000080">;
     </font><font color="#FF0000"><b>While </b></font>CurrentFacet <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>Nil do
       With </b></font>CurrentFacet<font color="#000080">^ </font><font color="#FF0000"><b>do
       Begin
            </b></font>ClearPolyList <font color="#000080">(</font>PolyList<font color="#000080">^);
            </font>XPrime1 <font color="#000080">:= </font>X1<font color="#000080">; </font>YPrime1 <font color="#000080">:= </font>Y1<font color="#000080">; </font>ZPrime1 <font color="#000080">:= </font>Z1<font color="#000080">;
            </font>XPrime2 <font color="#000080">:= </font>X2<font color="#000080">; </font>YPrime2 <font color="#000080">:= </font>Y2<font color="#000080">; </font>ZPrime2 <font color="#000080">:= </font>Z2<font color="#000080">;
            </font>XPrime3 <font color="#000080">:= </font>X3<font color="#000080">; </font>YPrime3 <font color="#000080">:= </font>Y3<font color="#000080">; </font>ZPrime3 <font color="#000080">:= </font>Z3<font color="#000080">;
            </font>XPrime4 <font color="#000080">:= </font>X4<font color="#000080">; </font>YPrime4 <font color="#000080">:= </font>Y4<font color="#000080">; </font>ZPrime4 <font color="#000080">:= </font>Z4<font color="#000080">;
            </font><font color="#008000"><i>{ Rotate Coords }
            </i></font>CTX <font color="#000080">:= </font>COS<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AX <font color="#000080">* </font>PI <font color="#000080">/ </font><font color="#800000">180</font><font color="#000080">);
            </font>STX <font color="#000080">:= </font>SIN<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AX <font color="#000080">* </font>PI <font color="#000080">/ </font><font color="#800000">180</font><font color="#000080">);
            </font>CTY <font color="#000080">:= </font>COS<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AY <font color="#000080">* </font>PI <font color="#000080">/ </font><font color="#800000">180</font><font color="#000080">);
            </font>STY <font color="#000080">:= </font>SIN<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AY <font color="#000080">* </font>PI <font color="#000080">/ </font><font color="#800000">180</font><font color="#000080">);
            </font>CTZ <font color="#000080">:= </font>COS<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AZ <font color="#000080">* </font>PI <font color="#000080">/ </font><font color="#800000">180</font><font color="#000080">);
            </font>STZ <font color="#000080">:= </font>SIN<font color="#000080">(</font>PolyHead<font color="#000080">^.</font>AZ <font color="#000080">* </font>PI <font color="#000080">/ </font><font color="#800000">180</font><font color="#000080">);
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>YPrime1 <font color="#000080">* </font>CTX<font color="#000080">) - (</font>ZPrime1 <font color="#000080">* </font>STX<font color="#000080">));
            </font>ZPrime1 <font color="#000080">:= </font>Round<font color="#000080">((</font>YPrime1 <font color="#000080">* </font>STX<font color="#000080">) + (</font>ZPrime1 <font color="#000080">* </font>CTX<font color="#000080">));
            </font>YPrime1 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime1 <font color="#000080">* </font>CTY<font color="#000080">) - (</font>ZPrime1 <font color="#000080">* </font>STY<font color="#000080">));
            </font>ZPrime1 <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime1 <font color="#000080">* </font>STY<font color="#000080">) + (</font>ZPrime1 <font color="#000080">* </font>CTY<font color="#000080">));
            </font>XPrime1 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime1 <font color="#000080">* </font>CTZ<font color="#000080">) - (</font>YPrime1 <font color="#000080">* </font>STZ<font color="#000080">));
            </font>YPrime1 <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime1 <font color="#000080">* </font>STZ<font color="#000080">) + (</font>YPrime1 <font color="#000080">* </font>CTZ<font color="#000080">));
            </font>XPrime1 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>YPrime2 <font color="#000080">* </font>CTX<font color="#000080">) - (</font>ZPrime2 <font color="#000080">* </font>STX<font color="#000080">));
            </font>ZPrime2 <font color="#000080">:= </font>Round<font color="#000080">((</font>YPrime2 <font color="#000080">* </font>STX<font color="#000080">) + (</font>ZPrime2 <font color="#000080">* </font>CTX<font color="#000080">));
            </font>YPrime2 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime2 <font color="#000080">* </font>CTY<font color="#000080">) - (</font>ZPrime2 <font color="#000080">* </font>STY<font color="#000080">));
            </font>ZPrime2 <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime2 <font color="#000080">* </font>STY<font color="#000080">) + (</font>ZPrime2 <font color="#000080">* </font>CTY<font color="#000080">));
            </font>XPrime2 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime2 <font color="#000080">* </font>CTZ<font color="#000080">) - (</font>YPrime2 <font color="#000080">* </font>STZ<font color="#000080">));
            </font>YPrime2 <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime2 <font color="#000080">* </font>STZ<font color="#000080">) + (</font>YPrime2 <font color="#000080">* </font>CTZ<font color="#000080">));
            </font>XPrime2 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>YPrime3 <font color="#000080">* </font>CTX<font color="#000080">) - (</font>ZPrime3 <font color="#000080">* </font>STX<font color="#000080">));
            </font>ZPrime3 <font color="#000080">:= </font>Round<font color="#000080">((</font>YPrime3 <font color="#000080">* </font>STX<font color="#000080">) + (</font>ZPrime3 <font color="#000080">* </font>CTX<font color="#000080">));
            </font>YPrime3 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime3 <font color="#000080">* </font>CTY<font color="#000080">) - (</font>ZPrime3 <font color="#000080">* </font>STY<font color="#000080">));
            </font>ZPrime3 <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime3 <font color="#000080">* </font>STY<font color="#000080">) + (</font>ZPrime3 <font color="#000080">* </font>CTY<font color="#000080">));
            </font>XPrime3 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime3 <font color="#000080">* </font>CTZ<font color="#000080">) - (</font>YPrime3 <font color="#000080">* </font>STZ<font color="#000080">));
            </font>YPrime3 <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime3 <font color="#000080">* </font>STZ<font color="#000080">) + (</font>YPrime3 <font color="#000080">* </font>CTZ<font color="#000080">));
            </font>XPrime3 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>YPrime4 <font color="#000080">* </font>CTX<font color="#000080">) - (</font>ZPrime4 <font color="#000080">* </font>STX<font color="#000080">));
            </font>ZPrime4 <font color="#000080">:= </font>Round<font color="#000080">((</font>YPrime4 <font color="#000080">* </font>STX<font color="#000080">) + (</font>ZPrime4 <font color="#000080">* </font>CTX<font color="#000080">));
            </font>YPrime4 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime4 <font color="#000080">* </font>CTY<font color="#000080">) - (</font>ZPrime4 <font color="#000080">* </font>STY<font color="#000080">));
            </font>ZPrime4 <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime4 <font color="#000080">* </font>STY<font color="#000080">) + (</font>ZPrime4 <font color="#000080">* </font>CTY<font color="#000080">));
            </font>XPrime4 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font>Temp    <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime4 <font color="#000080">* </font>CTZ<font color="#000080">) - (</font>YPrime4 <font color="#000080">* </font>STZ<font color="#000080">));
            </font>YPrime4 <font color="#000080">:= </font>Round<font color="#000080">((</font>XPrime4 <font color="#000080">* </font>STZ<font color="#000080">) + (</font>YPrime4 <font color="#000080">* </font>CTZ<font color="#000080">));
            </font>XPrime4 <font color="#000080">:= </font>Temp<font color="#000080">;
            </font><font color="#008000"><i>{ Translate Coords }
            </i></font>XPrime1 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>X <font color="#000080">+ </font>XPrime1<font color="#000080">;
            </font>YPrime1 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>Y <font color="#000080">+ </font>YPrime1<font color="#000080">;
            </font>ZPrime1 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>Z <font color="#000080">+ </font>ZPrime1<font color="#000080">;
            </font>XPrime2 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>X <font color="#000080">+ </font>XPrime2<font color="#000080">;
            </font>YPrime2 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>Y <font color="#000080">+ </font>YPrime2<font color="#000080">;
            </font>ZPrime2 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>Z <font color="#000080">+ </font>ZPrime2<font color="#000080">;
            </font>XPrime3 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>X <font color="#000080">+ </font>XPrime3<font color="#000080">;
            </font>YPrime3 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>Y <font color="#000080">+ </font>YPrime3<font color="#000080">;
            </font>ZPrime3 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>Z <font color="#000080">+ </font>ZPrime3<font color="#000080">;
            </font>XPrime4 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>X <font color="#000080">+ </font>XPrime4<font color="#000080">;
            </font>YPrime4 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>Y <font color="#000080">+ </font>YPrime4<font color="#000080">;
            </font>ZPrime4 <font color="#000080">:= </font>PolyHead<font color="#000080">^.</font>Z <font color="#000080">+ </font>ZPrime4<font color="#000080">;
            </font><font color="#008000"><i>{ Translate 3D Vectorspace to 2D Framespace }
            </i></font>CalcX1 <font color="#000080">:= </font><font color="#800000">160 </font><font color="#000080">+ ((</font>LongInt<font color="#000080">(</font>XPrime1<font color="#000080">)*</font>ViewerDist<font color="#000080">) </font><font color="#FF0000"><b>DIV
                             </b></font><font color="#000080">(</font>ZPrime1<font color="#000080">+</font>ViewerDist<font color="#000080">));
            </font>CalcY1 <font color="#000080">:= </font><font color="#800000">100 </font><font color="#000080">+ ((</font>LongInt<font color="#000080">(</font>YPrime1<font color="#000080">)*</font>ViewerDist<font color="#000080">) </font><font color="#FF0000"><b>DIV
                             </b></font><font color="#000080">(</font>ZPrime1<font color="#000080">+</font>ViewerDist<font color="#000080">));
            </font>CalcX2 <font color="#000080">:= </font><font color="#800000">160 </font><font color="#000080">+ ((</font>LongInt<font color="#000080">(</font>XPrime2<font color="#000080">)*</font>ViewerDist<font color="#000080">) </font><font color="#FF0000"><b>DIV
                             </b></font><font color="#000080">(</font>ZPrime2<font color="#000080">+</font>ViewerDist<font color="#000080">));
            </font>CalcY2 <font color="#000080">:= </font><font color="#800000">100 </font><font color="#000080">+ ((</font>LongInt<font color="#000080">(</font>YPrime2<font color="#000080">)*</font>ViewerDist<font color="#000080">) </font><font color="#FF0000"><b>DIV
                             </b></font><font color="#000080">(</font>ZPrime2<font color="#000080">+</font>ViewerDist<font color="#000080">));
            </font>CalcX3 <font color="#000080">:= </font><font color="#800000">160 </font><font color="#000080">+ ((</font>LongInt<font color="#000080">(</font>XPrime3<font color="#000080">)*</font>ViewerDist<font color="#000080">) </font><font color="#FF0000"><b>DIV
                             </b></font><font color="#000080">(</font>ZPrime3<font color="#000080">+</font>ViewerDist<font color="#000080">));
            </font>CalcY3 <font color="#000080">:= </font><font color="#800000">100 </font><font color="#000080">+ ((</font>LongInt<font color="#000080">(</font>YPrime3<font color="#000080">)*</font>ViewerDist<font color="#000080">) </font><font color="#FF0000"><b>DIV
                             </b></font><font color="#000080">(</font>ZPrime3<font color="#000080">+</font>ViewerDist<font color="#000080">));
            </font>CalcX4 <font color="#000080">:= </font><font color="#800000">160 </font><font color="#000080">+ ((</font>LongInt<font color="#000080">(</font>XPrime4<font color="#000080">)*</font>ViewerDist<font color="#000080">) </font><font color="#FF0000"><b>DIV
                             </b></font><font color="#000080">(</font>ZPrime4<font color="#000080">+</font>ViewerDist<font color="#000080">));
            </font>CalcY4 <font color="#000080">:= </font><font color="#800000">100 </font><font color="#000080">+ ((</font>LongInt<font color="#000080">(</font>YPrime4<font color="#000080">)*</font>ViewerDist<font color="#000080">) </font><font color="#FF0000"><b>DIV
                             </b></font><font color="#000080">(</font>ZPrime4<font color="#000080">+</font>ViewerDist<font color="#000080">));
            </font><font color="#008000"><i>{ Draw Shape }
            </i></font>DrawLine <font color="#000080">(</font>CalcX1<font color="#000080">, </font>CalcY1<font color="#000080">, </font>CalcX2<font color="#000080">, </font>CalcY2<font color="#000080">, </font>Color<font color="#000080">);
            </font>DrawLine <font color="#000080">(</font>CalcX2<font color="#000080">, </font>CalcY2<font color="#000080">, </font>CalcX3<font color="#000080">, </font>CalcY3<font color="#000080">, </font>Color<font color="#000080">);
            </font>DrawLine <font color="#000080">(</font>CalcX3<font color="#000080">, </font>CalcY3<font color="#000080">, </font>CalcX4<font color="#000080">, </font>CalcY4<font color="#000080">, </font>Color<font color="#000080">);
            </font>DrawLine <font color="#000080">(</font>CalcX4<font color="#000080">, </font>CalcY4<font color="#000080">, </font>CalcX1<font color="#000080">, </font>CalcY1<font color="#000080">, </font>Color<font color="#000080">);
            </font>DrawPolyFromList <font color="#000080">(</font>PolyList<font color="#000080">^, </font>WorkPage<font color="#000080">^, </font>Color<font color="#000080">);
            </font>CurrentFacet <font color="#000080">:= </font>CurrentFacet<font color="#000080">^.</font>NextFacet<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-[ Build Background ]-----------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>BuildBackground <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>BufferIn <font color="#000080">: </font>VGAArray<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>CounterX<font color="#000080">,
    </font>CounterY  <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     For </b></font>CounterY <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">199 </font><font color="#FF0000"><b>do
      For </b></font>CounterX <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">319 </font><font color="#FF0000"><b>do
          </b></font>BufferIn<font color="#000080">[</font>CounterY<font color="#000080">, </font>CounterX<font color="#000080">] := </font><font color="#800000">1 </font><font color="#000080">+ ((</font>CounterY <font color="#FF0000"><b>MOD </b></font><font color="#800000">5</font><font color="#000080">) * </font><font color="#800000">5</font><font color="#000080">) +
                                               (</font>CounterX <font color="#FF0000"><b>MOD </b></font><font color="#800000">5</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-[ Build Palette ]--------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>BuildPalette <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>PaletteOut <font color="#000080">: </font>PaletteType<font color="#000080">);
</font><font color="#FF0000"><b>Const </b></font>BC <font color="#000080">= </font><font color="#800000">16</font><font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>Counter1<font color="#000080">,
    </font>Counter2  <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>FillChar <font color="#000080">(</font>PaletteOut<font color="#000080">, </font>SizeOf<font color="#000080">(</font>PaletteOut<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
     </font><font color="#FF0000"><b>For </b></font>Counter1 <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
     For </b></font>Counter2 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">2 </font><font color="#FF0000"><b>do
     Begin
          </b></font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font>Counter1 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">)+</font>Counter2<font color="#000080">].</font>Red   <font color="#000080">:= </font>BC<font color="#000080">+(</font>Counter2 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">);
          </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font>Counter1 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">)+</font>Counter2<font color="#000080">].</font>Green <font color="#000080">:= </font>BC<font color="#000080">+(</font>Counter2 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">);
          </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font>Counter1 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">)+</font>Counter2<font color="#000080">].</font>Blue  <font color="#000080">:= </font>BC<font color="#000080">+(</font>Counter2 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">);
          </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font>Counter1 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">)+</font><font color="#800000">4</font><font color="#000080">-</font>Counter2<font color="#000080">].</font>Red   <font color="#000080">:= </font>BC<font color="#000080">+(</font>Counter2 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">);
          </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font>Counter1 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">)+</font><font color="#800000">4</font><font color="#000080">-</font>Counter2<font color="#000080">].</font>Green <font color="#000080">:= </font>BC<font color="#000080">+(</font>Counter2 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">);
          </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font>Counter1 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">)+</font><font color="#800000">4</font><font color="#000080">-</font>Counter2<font color="#000080">].</font>Blue  <font color="#000080">:= </font>BC<font color="#000080">+(</font>Counter2 <font color="#000080">* </font><font color="#800000">5</font><font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>Counter1 <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
     Begin
          If </b></font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">1</font><font color="#000080">)+</font>Counter1<font color="#000080">].</font>Red <font color="#000080">&lt; </font>BC <font color="#000080">+ </font><font color="#800000">5
          </font><font color="#FF0000"><b>Then
          Begin
              </b></font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">1</font><font color="#000080">)+</font>Counter1<font color="#000080">].</font>Red   <font color="#000080">:= </font>BC <font color="#000080">+ </font><font color="#800000">5</font><font color="#000080">;
              </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">1</font><font color="#000080">)+</font>Counter1<font color="#000080">].</font>Green <font color="#000080">:= </font>BC <font color="#000080">+ </font><font color="#800000">5</font><font color="#000080">;
              </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">1</font><font color="#000080">)+</font>Counter1<font color="#000080">].</font>Blue  <font color="#000080">:= </font>BC <font color="#000080">+ </font><font color="#800000">5</font><font color="#000080">;
              </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">)+</font>Counter1<font color="#000080">].</font>Red   <font color="#000080">:= </font>BC <font color="#000080">+ </font><font color="#800000">5</font><font color="#000080">;
              </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">)+</font>Counter1<font color="#000080">].</font>Green <font color="#000080">:= </font>BC <font color="#000080">+ </font><font color="#800000">5</font><font color="#000080">;
              </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">)+</font>Counter1<font color="#000080">].</font>Blue  <font color="#000080">:= </font>BC <font color="#000080">+ </font><font color="#800000">5</font><font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">2</font><font color="#000080">)+</font>Counter1<font color="#000080">].</font>Red   <font color="#000080">:= </font>BC <font color="#000080">+ </font><font color="#800000">10</font><font color="#000080">;
          </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">2</font><font color="#000080">)+</font>Counter1<font color="#000080">].</font>Green <font color="#000080">:= </font>BC <font color="#000080">+ </font><font color="#800000">10</font><font color="#000080">;
          </font>PaletteOut<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+(</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">2</font><font color="#000080">)+</font>Counter1<font color="#000080">].</font>Blue  <font color="#000080">:= </font>BC <font color="#000080">+ </font><font color="#800000">10</font><font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>Counter1 <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">24 </font><font color="#FF0000"><b>do
     Begin
      </b></font>PaletteOut<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Red   <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Red<font color="#000080">* </font><font color="#800000">8</font><font color="#000080">)+
                                        (</font><font color="#800000">26 </font><font color="#000080">* </font><font color="#800000">24</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Green <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Green<font color="#000080">* </font><font color="#800000">8</font><font color="#000080">)+
                                        (</font><font color="#800000">0  </font><font color="#000080">* </font><font color="#800000">24</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Blue  <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Blue<font color="#000080">* </font><font color="#800000">8</font><font color="#000080">)+
                                        (</font><font color="#800000">0  </font><font color="#000080">* </font><font color="#800000">24</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">64</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Red   <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Red<font color="#000080">* </font><font color="#800000">8</font><font color="#000080">)+
                                        (</font><font color="#800000">0  </font><font color="#000080">* </font><font color="#800000">24</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">64</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Green <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Green<font color="#000080">* </font><font color="#800000">8</font><font color="#000080">)+
                                        (</font><font color="#800000">26 </font><font color="#000080">* </font><font color="#800000">24</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">64</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Blue  <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Blue<font color="#000080">* </font><font color="#800000">8</font><font color="#000080">)+
                                        (</font><font color="#800000">0  </font><font color="#000080">* </font><font color="#800000">24</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">128</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Red   <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Red<font color="#000080">* </font><font color="#800000">8</font><font color="#000080">)+
                                        (</font><font color="#800000">0  </font><font color="#000080">* </font><font color="#800000">24</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">128</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Green <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Green<font color="#000080">* </font><font color="#800000">8</font><font color="#000080">)+
                                        (</font><font color="#800000">0  </font><font color="#000080">* </font><font color="#800000">24</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">128</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Blue  <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Blue<font color="#000080">* </font><font color="#800000">8</font><font color="#000080">)+
                                        (</font><font color="#800000">26 </font><font color="#000080">* </font><font color="#800000">24</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">+</font><font color="#800000">64</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Red   <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Red<font color="#000080">* </font><font color="#800000">6</font><font color="#000080">)+
                                        (</font><font color="#800000">23 </font><font color="#000080">* </font><font color="#800000">26</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">+</font><font color="#800000">64</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Green <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Green<font color="#000080">* </font><font color="#800000">6</font><font color="#000080">)+
                                        (</font><font color="#800000">23 </font><font color="#000080">* </font><font color="#800000">26</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">+</font><font color="#800000">64</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Blue  <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Blue<font color="#000080">* </font><font color="#800000">6</font><font color="#000080">)+
                                        (</font><font color="#800000">0  </font><font color="#000080">* </font><font color="#800000">26</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">+</font><font color="#800000">128</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Red   <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Red<font color="#000080">* </font><font color="#800000">6</font><font color="#000080">)+
                                        (</font><font color="#800000">23 </font><font color="#000080">* </font><font color="#800000">26</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">+</font><font color="#800000">128</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Green <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Green<font color="#000080">* </font><font color="#800000">6</font><font color="#000080">)+
                                        (</font><font color="#800000">0  </font><font color="#000080">* </font><font color="#800000">26</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">+</font><font color="#800000">128</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Blue  <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Blue<font color="#000080">* </font><font color="#800000">6</font><font color="#000080">)+
                                        (</font><font color="#800000">23 </font><font color="#000080">* </font><font color="#800000">26</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">64</font><font color="#000080">+</font><font color="#800000">128</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Red   <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Red<font color="#000080">* </font><font color="#800000">6</font><font color="#000080">)+
                                        (</font><font color="#800000">0  </font><font color="#000080">* </font><font color="#800000">26</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">64</font><font color="#000080">+</font><font color="#800000">128</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Green <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Green<font color="#000080">* </font><font color="#800000">6</font><font color="#000080">)+
                                        (</font><font color="#800000">23 </font><font color="#000080">* </font><font color="#800000">26</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
      </font>PaletteOut<font color="#000080">[</font><font color="#800000">64</font><font color="#000080">+</font><font color="#800000">128</font><font color="#000080">+</font>Counter1<font color="#000080">].</font>Blue  <font color="#000080">:= ((</font>PaletteOut<font color="#000080">[</font>Counter1<font color="#000080">].</font>Blue<font color="#000080">* </font><font color="#800000">6</font><font color="#000080">)+
                                        (</font><font color="#800000">23 </font><font color="#000080">* </font><font color="#800000">26</font><font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">32</font><font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-[ Move Background by Moving Palette ]------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>MoveBackground <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>PaletteIn <font color="#000080">: </font>PaletteType<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>TempPal <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>PaletteRec<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font><font color="#008000"><i>{-- Move Background Colors --}
     </i></font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+</font><font color="#800000">5</font><font color="#000080">], </font>PaletteIn<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], ((</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">) * </font><font color="#800000">3</font><font color="#000080">));
     </font>Move <font color="#000080">(</font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>PaletteIn<font color="#000080">[</font><font color="#800000">1 </font><font color="#000080">+ (</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">)], </font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font><font color="#008000"><i>{-- Move See-Through Colors --}
     { Red }
     </i></font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">], </font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">+</font><font color="#800000">5</font><font color="#000080">], </font>PaletteIn<font color="#000080">[</font><font color="#800000">32</font><font color="#000080">], ((</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">) * </font><font color="#800000">3</font><font color="#000080">));
     </font>Move <font color="#000080">(</font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>PaletteIn<font color="#000080">[</font><font color="#800000">32 </font><font color="#000080">+ (</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">)], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font><font color="#008000"><i>{ Green }
     </i></font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[</font><font color="#800000">64</font><font color="#000080">], </font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[</font><font color="#800000">64</font><font color="#000080">+</font><font color="#800000">5</font><font color="#000080">], </font>PaletteIn<font color="#000080">[</font><font color="#800000">64</font><font color="#000080">], ((</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">) * </font><font color="#800000">3</font><font color="#000080">));
     </font>Move <font color="#000080">(</font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>PaletteIn<font color="#000080">[</font><font color="#800000">64 </font><font color="#000080">+ (</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">)], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font><font color="#008000"><i>{ Blue }
     </i></font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[</font><font color="#800000">128</font><font color="#000080">], </font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[</font><font color="#800000">128</font><font color="#000080">+</font><font color="#800000">5</font><font color="#000080">], </font>PaletteIn<font color="#000080">[</font><font color="#800000">128</font><font color="#000080">], ((</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">) * </font><font color="#800000">3</font><font color="#000080">));
     </font>Move <font color="#000080">(</font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>PaletteIn<font color="#000080">[</font><font color="#800000">128 </font><font color="#000080">+ (</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">)], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font><font color="#008000"><i>{ Red + Green }
     </i></font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[(</font><font color="#800000">32 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">64</font><font color="#000080">)], </font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[(</font><font color="#800000">32 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">64</font><font color="#000080">)+</font><font color="#800000">5</font><font color="#000080">], </font>PaletteIn<font color="#000080">[(</font><font color="#800000">32 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">64</font><font color="#000080">)], ((</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">) * </font><font color="#800000">3</font><font color="#000080">));
     </font>Move <font color="#000080">(</font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>PaletteIn<font color="#000080">[(</font><font color="#800000">32 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">64</font><font color="#000080">) + (</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">)], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font><font color="#008000"><i>{ Red + Blue }
     </i></font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[(</font><font color="#800000">32 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">128</font><font color="#000080">)], </font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[(</font><font color="#800000">32 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">128</font><font color="#000080">)+</font><font color="#800000">5</font><font color="#000080">], </font>PaletteIn<font color="#000080">[(</font><font color="#800000">32 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">128</font><font color="#000080">)], ((</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">) * </font><font color="#800000">3</font><font color="#000080">));
     </font>Move <font color="#000080">(</font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>PaletteIn<font color="#000080">[(</font><font color="#800000">32 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">128</font><font color="#000080">) + (</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">)], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font><font color="#008000"><i>{ Green + Blue }
     </i></font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[(</font><font color="#800000">64 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">128</font><font color="#000080">)], </font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
     </font>Move <font color="#000080">(</font>PaletteIn<font color="#000080">[(</font><font color="#800000">64 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">128</font><font color="#000080">)+</font><font color="#800000">5</font><font color="#000080">], </font>PaletteIn<font color="#000080">[(</font><font color="#800000">64 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">128</font><font color="#000080">)], ((</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">) * </font><font color="#800000">3</font><font color="#000080">));
     </font>Move <font color="#000080">(</font>TempPal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>PaletteIn<font color="#000080">[(</font><font color="#800000">64 </font><font color="#FF0000"><b>OR </b></font><font color="#800000">128</font><font color="#000080">) + (</font><font color="#800000">5 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">)], </font><font color="#800000">6 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-[ Set Palette ]----------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>SetPalette <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>PaletteIn <font color="#000080">: </font>PaletteType<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">PUSH DS
   LDS SI, PaletteIn </font><font color="#008000"><i>{ Sets whole palette at once...       }
   </i></font><font color="#FF00FF">MOV CX, 256 * 3   </font><font color="#008000"><i>{  *NOT* good practice since many VGA }
   </i></font><font color="#FF00FF">MOV DX, 03DAh     </font><font color="#008000"><i>{  cards will show snow at the top of }
   </i></font><font color="#FF00FF">@WaitNotVSync:    </font><font color="#008000"><i>{  of the screen.  It's done here     }
     </i></font><font color="#FF00FF">IN  AL, DX      </font><font color="#008000"><i>{  'cause the background animation    }
     </i></font><font color="#FF00FF">AND AL, 8       </font><font color="#008000"><i>{  requires large ammounts of the     }
   </i></font><font color="#FF00FF">JNZ @WaitNotVSync </font><font color="#008000"><i>{  palette to be updated every new    }
   </i></font><font color="#FF00FF">@WaitVSync:       </font><font color="#008000"><i>{  frame.                             }
     </i></font><font color="#FF00FF">IN  AL, DX
     AND AL, 8
   JZ @WaitVSync
   XOR AX, AX
   MOV DX, 03C8h
   OUT DX, AL
   INC DX
   @PaletteLoop:
     LODSB
     OUT DX, AL
   LOOP @PaletteLoop
   POP DS
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{=[ Main Program ]=========================================================}
</i></font><font color="#FF0000"><b>Var </b></font>Polygon1 <font color="#000080">: </font>PolyHPtr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>VGAMEM <font color="#000080">:= </font>Ptr<font color="#000080">(</font><font color="#800000">$A000</font><font color="#000080">, </font><font color="#800000">$0000</font><font color="#000080">);
     </font>New <font color="#000080">(</font>WorkPage<font color="#000080">);
     </font>New <font color="#000080">(</font>BkgPage<font color="#000080">);
     </font>New <font color="#000080">(</font>Palette<font color="#000080">);
     </font>New <font color="#000080">(</font>PolyList<font color="#000080">);
     </font>ClearPolyList <font color="#000080">(</font>PolyList<font color="#000080">^);
     </font>GoMode13h<font color="#000080">;
     </font>BuildBackground <font color="#000080">(</font>BkgPage<font color="#000080">^);
     </font>BuildPalette    <font color="#000080">(</font>Palette<font color="#000080">^);
     </font>SetPalette <font color="#000080">(</font>Palette<font color="#000080">^);
     </font>Polygon1 <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
     </font>InitializePolygon <font color="#000080">(</font>Polygon1<font color="#000080">,  </font><font color="#008000"><i>{ Polygon List Head         }
                        </i></font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,  </font><font color="#008000"><i>{ X, Y, Z of polygon        }
                        </i></font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);  </font><font color="#008000"><i>{ Iniitial Roll, Pitch, Yaw }
     </i></font>AddFacet <font color="#000080">(</font>Polygon1<font color="#000080">,       </font><font color="#008000"><i>{ Polygon List Head        }
                </i></font><font color="#800000">32</font><font color="#000080">,            </font><font color="#008000"><i>{ Color                    }
               </i></font><font color="#000080">-</font><font color="#800000">40</font><font color="#000080">, -</font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">50</font><font color="#000080">,  </font><font color="#008000"><i>{ One Corner of Polygon    }
                </i></font><font color="#800000">40</font><font color="#000080">, -</font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">50</font><font color="#000080">,  </font><font color="#008000"><i>{ Second Corner of Polygon }
                </i></font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">50</font><font color="#000080">,  </font><font color="#008000"><i>{ Third Corner of Polygon  }
               </i></font><font color="#000080">-</font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">50</font><font color="#000080">); </font><font color="#008000"><i>{ Last Corner of Polygon   }
     </i></font>AddFacet <font color="#000080">(</font>Polygon1<font color="#000080">,
                </font><font color="#800000">64</font><font color="#000080">,
               -</font><font color="#800000">50</font><font color="#000080">, -</font><font color="#800000">40</font><font color="#000080">, -</font><font color="#800000">40</font><font color="#000080">,
               -</font><font color="#800000">50</font><font color="#000080">, -</font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">40</font><font color="#000080">,
               -</font><font color="#800000">50</font><font color="#000080">,  </font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">40</font><font color="#000080">,
               -</font><font color="#800000">50</font><font color="#000080">,  </font><font color="#800000">40</font><font color="#000080">, -</font><font color="#800000">40</font><font color="#000080">);
     </font>AddFacet <font color="#000080">(</font>Polygon1<font color="#000080">,
               </font><font color="#800000">128</font><font color="#000080">,
                </font><font color="#800000">40</font><font color="#000080">, -</font><font color="#800000">50</font><font color="#000080">, -</font><font color="#800000">40</font><font color="#000080">,
                </font><font color="#800000">40</font><font color="#000080">, -</font><font color="#800000">50</font><font color="#000080">,  </font><font color="#800000">40</font><font color="#000080">,
               -</font><font color="#800000">40</font><font color="#000080">, -</font><font color="#800000">50</font><font color="#000080">,  </font><font color="#800000">40</font><font color="#000080">,
               -</font><font color="#800000">40</font><font color="#000080">, -</font><font color="#800000">50</font><font color="#000080">, -</font><font color="#800000">40</font><font color="#000080">);
     </font><font color="#FF0000"><b>Repeat
           </b></font><font color="#008000"><i>{ Clear Workpage }
           </i></font>WorkPage<font color="#000080">^ := </font>BkgPage<font color="#000080">^;
           </font>ClearPolyList <font color="#000080">(</font>PolyList<font color="#000080">^);
           </font>DrawPolygon3D <font color="#000080">(</font>Polygon1<font color="#000080">,    </font><font color="#008000"><i>{ Polygon Definition }
                          </i></font>WorkPage<font color="#000080">);   </font><font color="#008000"><i>{ Work buffer        }
           </i></font>MoveBackground <font color="#000080">(</font>Palette<font color="#000080">^);
           </font>SetPalette     <font color="#000080">(</font>Palette<font color="#000080">^);
           </font><font color="#008000"><i>{ Display Work Buffer }
           </i></font>VGAMEM<font color="#000080">^ := </font>WorkPage<font color="#000080">^;
           </font>RotatePolygon <font color="#000080">(</font>Polygon1<font color="#000080">,
                          </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
     </font><font color="#FF0000"><b>Until </b></font>Keypressed<font color="#000080">;
     </font>DisposePolygon <font color="#000080">(</font>Polygon1<font color="#000080">);
     </font>Dispose <font color="#000080">(</font>PolyList<font color="#000080">);
     </font>Dispose <font color="#000080">(</font>Palette<font color="#000080">);
     </font>Dispose <font color="#000080">(</font>BkgPage<font color="#000080">);
     </font>Dispose <font color="#000080">(</font>WorkPage<font color="#000080">);
     </font>TextMode <font color="#000080">(</font>C80<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0129.PAS">Original</a><b>]</b></p></body>
</html>
