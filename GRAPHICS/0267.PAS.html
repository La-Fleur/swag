<html>
<head><title> "3D TEXTURES" by PAVEL STRATIL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0267.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{$A+,B-,D+,E-,F-,G+,I+,L+,N+,O+,P-,Q+,R-,S+,T+,V+,X+,Y+}
{$M 4096,0,655360}

{
  Please,

     Go through the code, and find the bugs. Optimize. There is a frame
     counter so..
     If something is wrong plase correct it.
     If you change something, please preserve the former code as a comment.

     Please Email me the changed code ASAP on:

     stratil@feniz.cz


     -you may add anything, you thing to be interresting

     Thanks, Pavel
}


{ check the info below the code. Something is explained there.
  There is also another file, you need for running this}

</i></font><font color="#FF0000"><b>type
    </b></font>VirtualArray <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">64000</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
    </font>VPointer <font color="#000080">= ^</font>VirtualArray<font color="#000080">;
</font><font color="#FF0000"><b>var
    </b></font>define <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[ </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">255 </font><font color="#000080">] </font><font color="#FF0000"><b>of record
                                  </b></font>color<font color="#000080">:</font>byte<font color="#000080">;
                                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>base <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[ </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1000 </font><font color="#000080">] </font><font color="#FF0000"><b>of record
                                 </b></font>x<font color="#000080">,</font>y<font color="#000080">,</font>z<font color="#000080">:</font>integer<font color="#000080">;
                                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>rpoint <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[ </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1000 </font><font color="#000080">] </font><font color="#FF0000"><b>of record
                                   </b></font>rx<font color="#000080">,</font>ry<font color="#000080">,</font>rz<font color="#000080">:</font>single<font color="#000080">;
                                   </font>px<font color="#000080">,</font>py<font color="#000080">:</font>integer<font color="#000080">;
                                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>poly <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[ </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1000 </font><font color="#000080">] </font><font color="#FF0000"><b>of record
                                 </b></font>p1<font color="#000080">,</font>p2<font color="#000080">,</font>p3<font color="#000080">:</font>word<font color="#000080">;
                                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>normal <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[ </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1000 </font><font color="#000080">] </font><font color="#FF0000"><b>of record
                                   </b></font>x<font color="#000080">,</font>y<font color="#000080">,</font>z<font color="#000080">:</font>single<font color="#000080">;
                                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>rnormal <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[ </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1000 </font><font color="#000080">] </font><font color="#FF0000"><b>of record
                                   </b></font>x<font color="#000080">,</font>y<font color="#000080">,</font>z<font color="#000080">:</font>single<font color="#000080">;
                                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>sinb <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[ </font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255 </font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>single<font color="#000080">;
    </font>cosb <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[ </font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255 </font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>single<font color="#000080">;
    </font>cbound <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of record
                                </b></font>llower<font color="#000080">,</font>glower<font color="#000080">,</font>lmul<font color="#000080">,</font>gmul<font color="#000080">:</font>byte<font color="#000080">;
                               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>lx<font color="#000080">,</font>ly<font color="#000080">,</font>lz<font color="#000080">:</font>single<font color="#000080">; </font><font color="#008000"><i>{light x,y,z}
    </i></font>lalfa<font color="#000080">,</font>lbeta<font color="#000080">,</font>lgama<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#008000"><i>{light alfa beta gama}
    </i></font>polycount<font color="#000080">,</font>pointcount<font color="#000080">:</font>word<font color="#000080">;
    </font>origox<font color="#000080">,</font>origoy<font color="#000080">,</font>dist<font color="#000080">:</font>integer<font color="#000080">;

    </font>singles <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>single<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>KeyPressed<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">mov</font>	<font color="#FF00FF">ah,1
    int</font>	<font color="#FF00FF">16h
    jnz</font>	<font color="#FF00FF">@true
    mov</font>	<font color="#FF00FF">[@result],false
    jmp</font>	<font color="#FF00FF">@</font><font color="#FF0000"><b>end
</b></font><font color="#000080">@</font>true<font color="#000080">:
    </font>mov	<font color="#000080">[@</font>result<font color="#000080">],</font>true
<font color="#000080">@</font><font color="#FF0000"><b>end</b></font><font color="#000080">:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ReadKey<font color="#000080">:</font>char<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ah,0h
  int 16h
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>psinb<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>w<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>w<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do
  </b></font>sinb<font color="#000080">[</font>w<font color="#000080">]:=</font>sin<font color="#000080">(</font>w<font color="#000080">*</font>pi<font color="#000080">/</font><font color="#800000">128</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>pcosb<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>w<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>w<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do
  </b></font>cosb<font color="#000080">[</font>w<font color="#000080">]:=</font>cos<font color="#000080">(</font>w<font color="#000080">*</font>pi<font color="#000080">/</font><font color="#800000">128</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>WaitRet<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,3dah
  @1:
    in al,dx
    test al,08h
    jnz @1
  @2:
    in al,dx
    test al,08h
    jz @2
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Flip<font color="#000080">(</font>source<font color="#000080">,</font>target<font color="#000080">:</font>word<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push ds
  mov ax,target
  mov es,ax
  mov ax,Source
  mov ds,ax
  xor si,si
  xor di,di
  mov cx,16000
  db $f3,66h,$a5
  pop ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SetRGB<font color="#000080">(</font>color<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>Byte<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,3c8h
  mov al,[Color]
  out dx,al
  inc dx
  mov al,[r]
  out dx,al
  mov al,[g]
  out dx,al
  mov al,[b]
  out dx,al
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>Cls<font color="#000080">(</font>target<font color="#000080">:</font>word<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax,[bp+offset target]
  mov es,ax
  xor di,di
  db 66h; xor ax,ax
  mov cx,16000
  db 0f3h,66h,0abh
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>LoadCoords<font color="#000080">(</font>filename<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>s1<font color="#000080">,</font>s2<font color="#000080">,</font>s3<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>souradnice<font color="#000080">,</font>i<font color="#000080">,</font>i1<font color="#000080">,</font>i2<font color="#000080">,</font>i3<font color="#000080">,</font>i4<font color="#000080">:</font>integer<font color="#000080">;
    </font>soubor<font color="#000080">:</font>text<font color="#000080">;

</font><font color="#FF0000"><b>label </b></font>MainLoop<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>assign<font color="#000080">(</font>soubor<font color="#000080">,</font>filename<font color="#000080">);
  </font>reset<font color="#000080">(</font>soubor<font color="#000080">);
  </font>readln<font color="#000080">(</font>soubor<font color="#000080">,</font>pointcount<font color="#000080">);
  </font>readln<font color="#000080">(</font>soubor<font color="#000080">,</font>polycount<font color="#000080">);

 </font>MainLoop<font color="#000080">:
     </font>readln<font color="#000080">(</font>soubor<font color="#000080">,</font>s1<font color="#000080">);
     </font>readln<font color="#000080">(</font>soubor<font color="#000080">,</font>s1<font color="#000080">);
     </font>i<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font>s2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
     </font><font color="#FF0000"><b>repeat
        </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
        </font>s3<font color="#000080">:=</font>copy<font color="#000080">(</font>s1<font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>s3<font color="#000080">=</font><font color="#800000">',' </font><font color="#FF0000"><b>then </b></font>s3<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font>s2<font color="#000080">:=</font>s2<font color="#000080">+</font>s3<font color="#000080">;
     </font><font color="#FF0000"><b>until </b></font>s3<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
     </font>val<font color="#000080">(</font>s2<font color="#000080">,</font>i1<font color="#000080">,</font>i2<font color="#000080">);
     </font>s2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
     </font><font color="#FF0000"><b>repeat
        </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
        </font>s3<font color="#000080">:=</font>copy<font color="#000080">(</font>s1<font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>s3<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>s3<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font>s2<font color="#000080">:=</font>s2<font color="#000080">+</font>s3<font color="#000080">;
     </font><font color="#FF0000"><b>until </b></font>s3<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
     </font>val<font color="#000080">(</font>s2<font color="#000080">,</font>i4<font color="#000080">,</font>i2<font color="#000080">);
     </font>i<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>repeat
        </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
        </font>readln<font color="#000080">(</font>soubor<font color="#000080">,</font>s1<font color="#000080">);
        </font>i2<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font>s2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font><font color="#FF0000"><b>repeat
           </b></font>inc<font color="#000080">(</font>i2<font color="#000080">);
           </font>s3<font color="#000080">:=</font>copy<font color="#000080">(</font>s1<font color="#000080">,</font>i2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
           </font><font color="#FF0000"><b>if </b></font>s3<font color="#000080">=</font><font color="#800000">'=' </font><font color="#FF0000"><b>then </b></font>s3<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
           </font>s2<font color="#000080">:=</font>s2<font color="#000080">+</font>s3<font color="#000080">;
        </font><font color="#FF0000"><b>until </b></font>s3<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
        </font>val<font color="#000080">(</font>s2<font color="#000080">,</font>souradnice<font color="#000080">,</font>i3<font color="#000080">);
        </font>s2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font><font color="#FF0000"><b>repeat
          </b></font>inc<font color="#000080">(</font>i2<font color="#000080">);
          </font>s3<font color="#000080">:=</font>copy<font color="#000080">(</font>s1<font color="#000080">,</font>i2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>s3<font color="#000080">=</font><font color="#800000">',' </font><font color="#FF0000"><b>then </b></font>s3<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
          </font>s2<font color="#000080">:=</font>s2<font color="#000080">+</font>s3<font color="#000080">;
        </font><font color="#FF0000"><b>until </b></font>s3<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
        </font>val<font color="#000080">(</font>s2<font color="#000080">,</font>base<font color="#000080">[</font>souradnice<font color="#000080">].</font>x<font color="#000080">,</font>i3<font color="#000080">);
        </font>s2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font><font color="#FF0000"><b>repeat
           </b></font>inc<font color="#000080">(</font>i2<font color="#000080">);
           </font>s3<font color="#000080">:=</font>copy<font color="#000080">(</font>s1<font color="#000080">,</font>i2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
           </font><font color="#FF0000"><b>if </b></font>s3<font color="#000080">=</font><font color="#800000">',' </font><font color="#FF0000"><b>then </b></font>s3<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
           </font>s2<font color="#000080">:=</font>s2<font color="#000080">+</font>s3<font color="#000080">;
        </font><font color="#FF0000"><b>until </b></font>s3<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
        </font>val<font color="#000080">(</font>s2<font color="#000080">,</font>base<font color="#000080">[</font>souradnice<font color="#000080">].</font>y<font color="#000080">,</font>i3<font color="#000080">);
        </font>s2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font><font color="#FF0000"><b>repeat
           </b></font>inc<font color="#000080">(</font>i2<font color="#000080">);
           </font>s3<font color="#000080">:=</font>copy<font color="#000080">(</font>s1<font color="#000080">,</font>i2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
           </font><font color="#FF0000"><b>if </b></font>s3<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>s3<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
           </font>s2<font color="#000080">:=</font>s2<font color="#000080">+</font>s3<font color="#000080">;
        </font><font color="#FF0000"><b>until </b></font>s3<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
        </font>val<font color="#000080">(</font>s2<font color="#000080">,</font>base<font color="#000080">[</font>souradnice<font color="#000080">].</font>z<font color="#000080">,</font>i3<font color="#000080">);
     </font><font color="#FF0000"><b>until </b></font>i<font color="#000080">=</font>i1<font color="#000080">;
     </font>readln<font color="#000080">(</font>soubor<font color="#000080">,</font>s1<font color="#000080">);
     </font>i<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>repeat
        </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
        </font>readln<font color="#000080">(</font>soubor<font color="#000080">,</font>s1<font color="#000080">);
        </font>i2<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font>s2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font><font color="#FF0000"><b>repeat
           </b></font>inc<font color="#000080">(</font>i2<font color="#000080">);
           </font>s3<font color="#000080">:=</font>copy<font color="#000080">(</font>s1<font color="#000080">,</font>i2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
           </font><font color="#FF0000"><b>if </b></font>s3<font color="#000080">=</font><font color="#800000">'=' </font><font color="#FF0000"><b>then </b></font>s3<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
           </font>s2<font color="#000080">:=</font>s2<font color="#000080">+</font>s3<font color="#000080">;
       </font><font color="#FF0000"><b>until </b></font>s3<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
       </font>val<font color="#000080">(</font>s2<font color="#000080">,</font>souradnice<font color="#000080">,</font>i3<font color="#000080">);
       </font>s2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
       </font><font color="#FF0000"><b>repeat
          </b></font>inc<font color="#000080">(</font>i2<font color="#000080">);
          </font>s3<font color="#000080">:=</font>copy<font color="#000080">(</font>s1<font color="#000080">,</font>i2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>s3<font color="#000080">=</font><font color="#800000">',' </font><font color="#FF0000"><b>then </b></font>s3<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
          </font>s2<font color="#000080">:=</font>s2<font color="#000080">+</font>s3<font color="#000080">;
       </font><font color="#FF0000"><b>until </b></font>s3<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
       </font>val<font color="#000080">(</font>s2<font color="#000080">,</font>poly<font color="#000080">[</font>souradnice<font color="#000080">].</font>p1<font color="#000080">,</font>i3<font color="#000080">);
       </font>s2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
       </font><font color="#FF0000"><b>repeat
          </b></font>inc<font color="#000080">(</font>i2<font color="#000080">);
          </font>s3<font color="#000080">:=</font>copy<font color="#000080">(</font>s1<font color="#000080">,</font>i2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>s3<font color="#000080">=</font><font color="#800000">',' </font><font color="#FF0000"><b>then </b></font>s3<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
          </font>s2<font color="#000080">:=</font>s2<font color="#000080">+</font>s3<font color="#000080">;
       </font><font color="#FF0000"><b>until </b></font>s3<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
       </font>val<font color="#000080">(</font>s2<font color="#000080">,</font>poly<font color="#000080">[</font>souradnice<font color="#000080">].</font>p2<font color="#000080">,</font>i3<font color="#000080">);
       </font>s2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
       </font><font color="#FF0000"><b>repeat
          </b></font>inc<font color="#000080">(</font>i2<font color="#000080">);
          </font>s3<font color="#000080">:=</font>copy<font color="#000080">(</font>s1<font color="#000080">,</font>i2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>s3<font color="#000080">=</font><font color="#800000">'-' </font><font color="#FF0000"><b>then </b></font>s3<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
          </font>s2<font color="#000080">:=</font>s2<font color="#000080">+</font>s3<font color="#000080">;
       </font><font color="#FF0000"><b>until </b></font>s3<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
       </font>val<font color="#000080">(</font>s2<font color="#000080">,</font>poly<font color="#000080">[</font>souradnice<font color="#000080">].</font>p3<font color="#000080">,</font>i3<font color="#000080">);
       </font>s2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
       </font><font color="#FF0000"><b>repeat
          </b></font>inc<font color="#000080">(</font>i2<font color="#000080">);
          </font>s3<font color="#000080">:=</font>copy<font color="#000080">(</font>s1<font color="#000080">,</font>i2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>s3<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>s3<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
          </font>s2<font color="#000080">:=</font>s2<font color="#000080">+</font>s3<font color="#000080">;
       </font><font color="#FF0000"><b>until </b></font>s3<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
       </font>val<font color="#000080">(</font>s2<font color="#000080">,</font>define<font color="#000080">[</font>souradnice<font color="#000080">].</font>color<font color="#000080">,</font>i3<font color="#000080">);
    </font><font color="#FF0000"><b>until </b></font>i<font color="#000080">=</font>i4<font color="#000080">;
    </font>readln<font color="#000080">(</font>soubor<font color="#000080">,</font>s1<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>s1<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then goto </b></font>MainLoop<font color="#000080">;
  </font>close<font color="#000080">(</font>soubor<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>VSetup<font color="#000080">(</font>VScreen<font color="#000080">:</font>VPointer<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>new<font color="#000080">(</font>Vscreen<font color="#000080">);
  </font>VSetup<font color="#000080">:=</font>seg<font color="#000080">(</font>vscreen<font color="#000080">^);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>VDispose<font color="#000080">(</font>Va<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>vscreen<font color="#000080">:</font>pointer <font color="#FF0000"><b>absolute </b></font>va<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>dispose<font color="#000080">(</font>Vscreen<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const </b></font>map<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">20</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">=(
(</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">),
(</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">),
(</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">),
(</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">),
(</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">),
(</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">),
(</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">),
(</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">),
(</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">),
(</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">),
(</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">),
(</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">07</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">));

</font><font color="#FF0000"><b>procedure </b></font>PPix<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">: </font>Integer<font color="#000080">;</font>color<font color="#000080">:</font>byte<font color="#000080">;</font>target<font color="#000080">:</font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax,target
  mov es,ax
  mov ax,y
  mov di,ax
  shl ax,6
  shl di,8
  add di,ax
  add di,x
  mov al,color
  mov es:[di],al
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>xchgi<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>x2<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>z<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>z<font color="#000080">:=</font>x1<font color="#000080">;
 </font>x1<font color="#000080">:=</font>x2<font color="#000080">;
 </font>x2<font color="#000080">:=</font>z<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>Ttriangle<font color="#000080">(</font>num<font color="#000080">,</font>target<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>var
 </b></font>u<font color="#000080">,</font>v<font color="#000080">,</font>incu<font color="#000080">,</font>incv<font color="#000080">,</font>test<font color="#000080">,</font>u1<font color="#000080">,</font>v1<font color="#000080">,</font>u2<font color="#000080">,</font>v2<font color="#000080">,</font>inc12u<font color="#000080">,</font>inc13u<font color="#000080">,</font>inc23u<font color="#000080">,</font>inc12v<font color="#000080">,</font>inc13v<font color="#000080">,</font>inc23v<font color="#000080">:</font>single<font color="#000080">;
 </font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">,</font>x3<font color="#000080">,</font>y3<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#008000"><i>{shading}
 </i></font>tx1<font color="#000080">,</font>ty1<font color="#000080">,</font>tx2<font color="#000080">,</font>ty2<font color="#000080">,</font>tx3<font color="#000080">,</font>ty3<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#008000"><i>{shading}
 </i></font>color<font color="#000080">:</font>byte<font color="#000080">;
 </font>gu<font color="#000080">,</font>gv<font color="#000080">,</font>width<font color="#000080">:</font>word<font color="#000080">;
 </font>cnt<font color="#000080">,</font>x<font color="#000080">,</font>minY<font color="#000080">,</font>maxY<font color="#000080">,</font>midY<font color="#000080">,</font>xa<font color="#000080">,</font>xb<font color="#000080">,</font>yy<font color="#000080">,</font>p1<font color="#000080">,</font>q1<font color="#000080">,</font>p2<font color="#000080">,</font>q2<font color="#000080">,</font>p3<font color="#000080">,</font>q3<font color="#000080">:</font>integer<font color="#000080">;
 </font>ideal<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>tx1<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>ty1<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>tx2<font color="#000080">:=</font><font color="#800000">20</font><font color="#000080">;
  </font>ty2<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>tx3<font color="#000080">:=</font><font color="#800000">20</font><font color="#000080">;
  </font>ty3<font color="#000080">:=</font><font color="#800000">11</font><font color="#000080">;

 </font><font color="#008000"><i>{width:=x2-x1+1;}
 </i></font><font color="#FF0000"><b>if </b></font>rnormal<font color="#000080">[</font>num<font color="#000080">].</font>z<font color="#000080">&gt;=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
 begin
  begin  </b></font><font color="#008000"><i>{color}
   </i></font>x1<font color="#000080">:=</font>rpoint<font color="#000080">[</font>poly<font color="#000080">[</font>num<font color="#000080">].</font>p1<font color="#000080">].</font>px<font color="#000080">;
   </font>y1<font color="#000080">:=</font>rpoint<font color="#000080">[</font>poly<font color="#000080">[</font>num<font color="#000080">].</font>p1<font color="#000080">].</font>py<font color="#000080">;
   </font>x2<font color="#000080">:=</font>rpoint<font color="#000080">[</font>poly<font color="#000080">[</font>num<font color="#000080">].</font>p2<font color="#000080">].</font>px<font color="#000080">;
   </font>y2<font color="#000080">:=</font>rpoint<font color="#000080">[</font>poly<font color="#000080">[</font>num<font color="#000080">].</font>p2<font color="#000080">].</font>py<font color="#000080">;
   </font>x3<font color="#000080">:=</font>rpoint<font color="#000080">[</font>poly<font color="#000080">[</font>num<font color="#000080">].</font>p3<font color="#000080">].</font>px<font color="#000080">;
   </font>y3<font color="#000080">:=</font>rpoint<font color="#000080">[</font>poly<font color="#000080">[</font>num<font color="#000080">].</font>p3<font color="#000080">].</font>py<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;</font>y2<font color="#000080">) </font><font color="#FF0000"><b>then
 begin
  </b></font>xchgi<font color="#000080">(</font>y1<font color="#000080">,</font>y2<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>x1<font color="#000080">,</font>x2<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>ty1<font color="#000080">,</font>ty2<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>tx1<font color="#000080">,</font>tx2<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;</font>y3<font color="#000080">) </font><font color="#FF0000"><b>then
 begin
  </b></font>xchgi<font color="#000080">(</font>y1<font color="#000080">,</font>y3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>x1<font color="#000080">,</font>x3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>ty1<font color="#000080">,</font>ty3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>tx1<font color="#000080">,</font>tx3<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y2<font color="#000080">&gt;</font>y3<font color="#000080">) </font><font color="#FF0000"><b>then
 begin
  </b></font>xchgi<font color="#000080">(</font>y2<font color="#000080">,</font>y3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>x2<font color="#000080">,</font>x3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>ty2<font color="#000080">,</font>ty3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>tx2<font color="#000080">,</font>tx3<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y2<font color="#000080">-</font>y1<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc12u<font color="#000080">:=(</font>tx2<font color="#000080">-</font>tx1<font color="#000080">)/(</font>y2<font color="#000080">-</font>y1<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc12u<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">-</font>y2<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc23u<font color="#000080">:=(</font>tx3<font color="#000080">-</font>tx2<font color="#000080">)/(</font>y3<font color="#000080">-</font>y2<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc23u<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">-</font>y1<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc13u<font color="#000080">:=(</font>tx3<font color="#000080">-</font>tx1<font color="#000080">)/(</font>y3<font color="#000080">-</font>y1<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc13u<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y2<font color="#000080">-</font>y1<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc12v<font color="#000080">:=(</font>ty2<font color="#000080">-</font>ty1<font color="#000080">)/(</font>y2<font color="#000080">-</font>y1<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc12v<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">-</font>y2<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc23v<font color="#000080">:=(</font>ty3<font color="#000080">-</font>ty2<font color="#000080">)/(</font>y3<font color="#000080">-</font>y2<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc23v<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">-</font>y1<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc13v<font color="#000080">:=(</font>ty3<font color="#000080">-</font>ty1<font color="#000080">)/(</font>y3<font color="#000080">-</font>y1<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc13v<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;

 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">-</font>y1<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>test<font color="#000080">:=(</font>x3<font color="#000080">-</font>x1<font color="#000080">)/(</font>y3<font color="#000080">-</font>y1<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>test<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>test<font color="#000080">:=</font>test<font color="#000080">*(</font>y2<font color="#000080">-</font>y1<font color="#000080">);
 </font>test<font color="#000080">:=</font>test<font color="#000080">+</font>x1<font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>x2<font color="#000080">&gt;=</font>test <font color="#FF0000"><b>then </b></font>ideal<font color="#000080">:=</font>true <font color="#FF0000"><b>else </b></font>ideal<font color="#000080">:=</font>false<font color="#000080">;

 </font>u1<font color="#000080">:=</font>tx1<font color="#000080">;</font>v1<font color="#000080">:=</font>ty1<font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>y1<font color="#000080">&lt;&gt;</font>y2 <font color="#FF0000"><b>then
 begin
 </b></font>u2<font color="#000080">:=</font>tx1<font color="#000080">;</font>v2<font color="#000080">:=</font>ty1<font color="#000080">;
 </font><font color="#FF0000"><b>end else begin
 </b></font>u2<font color="#000080">:=</font>tx2<font color="#000080">;</font>v2<font color="#000080">:=</font>ty2<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


 </font>p1<font color="#000080">:=</font>x1<font color="#000080">-</font>x3<font color="#000080">; </font>q1<font color="#000080">:=</font>y1<font color="#000080">-</font>y3<font color="#000080">;
 </font>p2<font color="#000080">:=</font>x2<font color="#000080">-</font>x1<font color="#000080">; </font>q2<font color="#000080">:=</font>y2<font color="#000080">-</font>y1<font color="#000080">;
 </font>p3<font color="#000080">:=</font>x3<font color="#000080">-</font>x2<font color="#000080">; </font>q3<font color="#000080">:=</font>y3<font color="#000080">-</font>y2<font color="#000080">;

  </font><font color="#FF0000"><b>for </b></font>yy<font color="#000080">:=</font>Y1 <font color="#FF0000"><b>to </b></font><font color="#000080">(</font>Y2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>xa<font color="#000080">:=</font><font color="#800000">320</font><font color="#000080">;
      </font>xb<font color="#000080">:=-</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y3<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y1<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y3<font color="#000080">=</font>y1<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y3<font color="#000080">)*</font>p1 <font color="#FF0000"><b>div </b></font>q1<font color="#000080">+</font>x3<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y2<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y1<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y2<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y1<font color="#000080">=</font>y2<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y1<font color="#000080">)*</font>p2 <font color="#FF0000"><b>div </b></font>q2<font color="#000080">+</font>x1<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y2<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y3<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y2<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y3<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y2<font color="#000080">=</font>y3<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y2<font color="#000080">)*</font>p3 <font color="#FF0000"><b>div </b></font>q3<font color="#000080">+</font>x2<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>xa<font color="#000080">&lt;=</font>xb <font color="#FF0000"><b>then
      begin
        </b></font>incu<font color="#000080">:=(</font>u2<font color="#000080">-</font>u1<font color="#000080">)/(</font>xb<font color="#000080">-</font>xa<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
        </font>incv<font color="#000080">:=(</font>v2<font color="#000080">-</font>v1<font color="#000080">)/(</font>xb<font color="#000080">-</font>xa<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
        </font>u<font color="#000080">:=</font>u1<font color="#000080">;
        </font>v<font color="#000080">:=</font>v1<font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>cnt<font color="#000080">:=</font>xa <font color="#FF0000"><b>to </b></font>xb <font color="#FF0000"><b>do
        begin
          </b></font><font color="#008000"><i>{gv:=round(v);
          gu:=round(u);}
          </i></font>color<font color="#000080">:=</font>map<font color="#000080">[</font>round<font color="#000080">(</font>v<font color="#000080">),</font>round<font color="#000080">(</font>u<font color="#000080">)];  </font><font color="#008000"><i>{*}
          {asm
           mov di,offset bitmap
           mov ax,gv
           mul width
           add ax,gu
           add di,ax
           mov al,byte ptr ds:[di]
           mov color,al
          end;}
          </i></font>ppix<font color="#000080">(</font>cnt<font color="#000080">,</font>yy<font color="#000080">,</font>color<font color="#000080">,</font>target<font color="#000080">);
          </font>u<font color="#000080">:=</font>u<font color="#000080">+</font>incu<font color="#000080">;
          </font>v<font color="#000080">:=</font>v<font color="#000080">+</font>incv<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>ideal<font color="#000080">=</font>false <font color="#FF0000"><b>then
        begin
          </b></font>u1<font color="#000080">:=</font>u1<font color="#000080">+</font>inc12u<font color="#000080">;
          </font>u2<font color="#000080">:=</font>u2<font color="#000080">+</font>inc13u<font color="#000080">;
          </font>v1<font color="#000080">:=</font>v1<font color="#000080">+</font>inc12v<font color="#000080">;
          </font>v2<font color="#000080">:=</font>v2<font color="#000080">+</font>inc13v<font color="#000080">;
        </font><font color="#FF0000"><b>end else
        begin
          </b></font>u1<font color="#000080">:=</font>u1<font color="#000080">+</font>inc13u<font color="#000080">;
          </font>u2<font color="#000080">:=</font>u2<font color="#000080">+</font>inc12u<font color="#000080">;
          </font>v1<font color="#000080">:=</font>v1<font color="#000080">+</font>inc13v<font color="#000080">;
          </font>v2<font color="#000080">:=</font>v2<font color="#000080">+</font>inc12v<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>for </b></font>yy<font color="#000080">:=</font>Y2 <font color="#FF0000"><b>to </b></font>Y3 <font color="#FF0000"><b>do
    begin
      </b></font>xa<font color="#000080">:=</font><font color="#800000">320</font><font color="#000080">;
      </font>xb<font color="#000080">:=-</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y3<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y1<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y3<font color="#000080">=</font>y1<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y3<font color="#000080">)*</font>p1 <font color="#FF0000"><b>div </b></font>q1<font color="#000080">+</font>x3<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y2<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y1<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y2<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y1<font color="#000080">=</font>y2<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y1<font color="#000080">)*</font>p2 <font color="#FF0000"><b>div </b></font>q2<font color="#000080">+</font>x1<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y2<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y3<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y2<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y3<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y2<font color="#000080">=</font>y3<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y2<font color="#000080">)*</font>p3 <font color="#FF0000"><b>div </b></font>q3<font color="#000080">+</font>x2<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>xa<font color="#000080">&lt;=</font>xb <font color="#FF0000"><b>then
      begin
        </b></font>incu<font color="#000080">:=(</font>u2<font color="#000080">-</font>u1<font color="#000080">)/(</font>xb<font color="#000080">-</font>xa<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
        </font>incv<font color="#000080">:=(</font>v2<font color="#000080">-</font>v1<font color="#000080">)/(</font>xb<font color="#000080">-</font>xa<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
        </font>u<font color="#000080">:=</font>u1<font color="#000080">;
        </font>v<font color="#000080">:=</font>v1<font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>cnt<font color="#000080">:=</font>xa <font color="#FF0000"><b>to </b></font>xb <font color="#FF0000"><b>do
        begin
          </b></font><font color="#008000"><i>{gv:=round(v);
          gu:=round(u);}
          </i></font>color<font color="#000080">:=</font>map<font color="#000080">[</font>round<font color="#000080">(</font>v<font color="#000080">),</font>round<font color="#000080">(</font>u<font color="#000080">)];  </font><font color="#008000"><i>{*}
          {asm
           mov di,offset bitmap
           mov ax,gv
           mul width
           add ax,gu
           add di,ax
           mov al,byte ptr ds:[di]
           mov color,al
          end;}
          </i></font>ppix<font color="#000080">(</font>cnt<font color="#000080">,</font>yy<font color="#000080">,</font>color<font color="#000080">,</font>target<font color="#000080">);
          </font>u<font color="#000080">:=</font>u<font color="#000080">+</font>incu<font color="#000080">;
          </font>v<font color="#000080">:=</font>v<font color="#000080">+</font>incv<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>ideal<font color="#000080">=</font>false <font color="#FF0000"><b>then
        begin
          </b></font>u1<font color="#000080">:=</font>u1<font color="#000080">+</font>inc23u<font color="#000080">;
          </font>u2<font color="#000080">:=</font>u2<font color="#000080">+</font>inc13u<font color="#000080">;
          </font>v1<font color="#000080">:=</font>v1<font color="#000080">+</font>inc23v<font color="#000080">;
          </font>v2<font color="#000080">:=</font>v2<font color="#000080">+</font>inc13v<font color="#000080">;
        </font><font color="#FF0000"><b>end else
        begin
          </b></font>u1<font color="#000080">:=</font>u1<font color="#000080">+</font>inc13u<font color="#000080">;
          </font>u2<font color="#000080">:=</font>u2<font color="#000080">+</font>inc23u<font color="#000080">;
          </font>v1<font color="#000080">:=</font>v1<font color="#000080">+</font>inc13v<font color="#000080">;
          </font>v2<font color="#000080">:=</font>v2<font color="#000080">+</font>inc23v<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GCoords<font color="#000080">(</font>alfa<font color="#000080">,</font>beta<font color="#000080">,</font>gama<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:</font>word<font color="#000080">;
    </font>s<font color="#000080">:</font>single<font color="#000080">;
</font><font color="#FF0000"><b>begin
for </b></font>c<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>pointcount <font color="#FF0000"><b>do
 begin
   </b></font>singles<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>cosb<font color="#000080">[</font>alfa<font color="#000080">]*</font>base<font color="#000080">[</font>c<font color="#000080">].</font>y<font color="#000080">-</font>sinb<font color="#000080">[</font>alfa<font color="#000080">]*</font>base<font color="#000080">[</font>c<font color="#000080">].</font>z<font color="#000080">;
   </font>singles<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font>sinb<font color="#000080">[</font>alfa<font color="#000080">]*</font>base<font color="#000080">[</font>c<font color="#000080">].</font>y<font color="#000080">+</font>cosb<font color="#000080">[</font>alfa<font color="#000080">]*</font>base<font color="#000080">[</font>c<font color="#000080">].</font>z<font color="#000080">;
   </font>singles<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font>cosb<font color="#000080">[</font>beta<font color="#000080">]*</font>base<font color="#000080">[</font>c<font color="#000080">].</font>x<font color="#000080">+</font>sinb<font color="#000080">[</font>beta<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
   </font>rpoint<font color="#000080">[</font>c<font color="#000080">].</font>rx<font color="#000080">:=</font>cosb<font color="#000080">[</font>gama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]-</font>sinb<font color="#000080">[</font>gama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
   </font>rpoint<font color="#000080">[</font>c<font color="#000080">].</font>ry<font color="#000080">:=</font>sinb<font color="#000080">[</font>gama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]+</font>cosb<font color="#000080">[</font>gama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
   </font>rpoint<font color="#000080">[</font>c<font color="#000080">].</font>rz<font color="#000080">:=</font>cosb<font color="#000080">[</font>beta<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]-</font>sinb<font color="#000080">[</font>beta<font color="#000080">]*</font>base<font color="#000080">[</font>c<font color="#000080">].</font>x<font color="#000080">;
   </font>s<font color="#000080">:=(</font>dist<font color="#000080">+</font>rpoint<font color="#000080">[</font>c<font color="#000080">].</font>rz<font color="#000080">)/</font>dist<font color="#000080">;
   </font>rpoint<font color="#000080">[</font>c<font color="#000080">].</font>px<font color="#000080">:=</font>round<font color="#000080">(</font>origoX<font color="#000080">+</font>s<font color="#000080">*</font>rpoint<font color="#000080">[</font>c<font color="#000080">].</font>rx<font color="#000080">);
   </font>rpoint<font color="#000080">[</font>c<font color="#000080">].</font>py<font color="#000080">:=</font>round<font color="#000080">(</font>origoY<font color="#000080">+</font>s<font color="#000080">*</font>rpoint<font color="#000080">[</font>c<font color="#000080">].</font>ry<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>for </b></font>c<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>polycount <font color="#FF0000"><b>do
 begin
   </b></font>singles<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font>sinb<font color="#000080">[</font>alfa<font color="#000080">]*</font>normal<font color="#000080">[</font>c<font color="#000080">].</font>y<font color="#000080">+</font>cosb<font color="#000080">[</font>alfa<font color="#000080">]*</font>normal<font color="#000080">[</font>c<font color="#000080">].</font>z<font color="#000080">;
   </font>rnormal<font color="#000080">[</font>c<font color="#000080">].</font>z<font color="#000080">:=</font>cosb<font color="#000080">[</font>beta<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]-</font>sinb<font color="#000080">[</font>beta<font color="#000080">]*</font>normal<font color="#000080">[</font>c<font color="#000080">].</font>x<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>rnormal<font color="#000080">[</font>c<font color="#000080">].</font>z<font color="#000080">&gt;=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
   begin
     </b></font>singles<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>cosb<font color="#000080">[</font>alfa<font color="#000080">]*</font>normal<font color="#000080">[</font>c<font color="#000080">].</font>y<font color="#000080">-</font>sinb<font color="#000080">[</font>alfa<font color="#000080">]*</font>normal<font color="#000080">[</font>c<font color="#000080">].</font>z<font color="#000080">;
     </font>singles<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font>cosb<font color="#000080">[</font>beta<font color="#000080">]*</font>normal<font color="#000080">[</font>c<font color="#000080">].</font>x<font color="#000080">+</font>sinb<font color="#000080">[</font>beta<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
     </font>rnormal<font color="#000080">[</font>c<font color="#000080">].</font>x<font color="#000080">:=</font>cosb<font color="#000080">[</font>gama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]-</font>sinb<font color="#000080">[</font>gama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
     </font>rnormal<font color="#000080">[</font>c<font color="#000080">].</font>y<font color="#000080">:=</font>sinb<font color="#000080">[</font>gama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]+</font>cosb<font color="#000080">[</font>gama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>rot<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">,</font>b<font color="#000080">,</font>c<font color="#000080">,</font>inca<font color="#000080">,</font>incb<font color="#000080">,</font>incc<font color="#000080">:</font>byte<font color="#000080">;</font>target<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>cnt<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>a<font color="#000080">:=</font>byte<font color="#000080">(</font>a<font color="#000080">+</font>inca<font color="#000080">);
  </font>b<font color="#000080">:=</font>byte<font color="#000080">(</font>b<font color="#000080">+</font>incb<font color="#000080">);
  </font>c<font color="#000080">:=</font>byte<font color="#000080">(</font>c<font color="#000080">+</font>incc<font color="#000080">);
  </font>GCoords<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">,</font>c<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>cnt<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>polycount <font color="#FF0000"><b>do </b></font>Ttriangle<font color="#000080">(</font>cnt<font color="#000080">,</font>target<font color="#000080">);
  </font>flip<font color="#000080">(</font>target<font color="#000080">,</font><font color="#800000">$0a000</font><font color="#000080">);
  </font>cls<font color="#000080">(</font>target<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>prepare<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>light<font color="#000080">,</font>z<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>norm<font color="#000080">:</font>extended<font color="#000080">;
</font>c<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
for </b></font>c<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>polycount <font color="#FF0000"><b>do
 begin
  </b></font>x<font color="#000080">:=(</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p2<font color="#000080">].</font>y<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>y<font color="#000080">)*(</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>z<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p3<font color="#000080">].</font>z<font color="#000080">)-
     (</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p2<font color="#000080">].</font>z<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>z<font color="#000080">)*(</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>y<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p3<font color="#000080">].</font>y<font color="#000080">);
  </font>y<font color="#000080">:=(</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p2<font color="#000080">].</font>z<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>z<font color="#000080">)*(</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>x<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p3<font color="#000080">].</font>x<font color="#000080">)-
     (</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p2<font color="#000080">].</font>x<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>x<font color="#000080">)*(</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>z<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p3<font color="#000080">].</font>z<font color="#000080">);
  </font>z<font color="#000080">:=(</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p2<font color="#000080">].</font>x<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>x<font color="#000080">)*(</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>y<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p3<font color="#000080">].</font>y<font color="#000080">)-
     (</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p2<font color="#000080">].</font>y<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>y<font color="#000080">)*(</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p1<font color="#000080">].</font>x<font color="#000080">-</font>base<font color="#000080">[</font>poly<font color="#000080">[</font>c<font color="#000080">].</font>p3<font color="#000080">].</font>x<font color="#000080">);
  </font>norm<font color="#000080">:=</font>sqrt<font color="#000080">(</font>sqr<font color="#000080">(</font>x<font color="#000080">)+</font>sqr<font color="#000080">(</font>y<font color="#000080">)+</font>sqr<font color="#000080">(</font>z<font color="#000080">));
  </font>normal<font color="#000080">[</font>c<font color="#000080">].</font>x<font color="#000080">:=</font>x<font color="#000080">/</font>norm<font color="#000080">;
  </font>normal<font color="#000080">[</font>c<font color="#000080">].</font>y<font color="#000080">:=</font>y<font color="#000080">/</font>norm<font color="#000080">;
  </font>normal<font color="#000080">[</font>c<font color="#000080">].</font>z<font color="#000080">:=</font>z<font color="#000080">/</font>norm<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>light<font color="#000080">:=</font>sqrt<font color="#000080">(</font>sqr<font color="#000080">(</font>lx<font color="#000080">)+</font>sqr<font color="#000080">(</font>ly<font color="#000080">)+</font>sqr<font color="#000080">(</font>lz<font color="#000080">));
 </font>lx<font color="#000080">:=</font>lx<font color="#000080">/</font>light<font color="#000080">;
 </font>ly<font color="#000080">:=</font>ly<font color="#000080">/</font>light<font color="#000080">;
 </font>lz<font color="#000080">:=</font>lz<font color="#000080">/</font>light<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setshades<font color="#000080">(</font>rh<font color="#000080">,</font>gh<font color="#000080">,</font>bh<font color="#000080">,</font>rl<font color="#000080">,</font>gl<font color="#000080">,</font>bl<font color="#000080">,</font>col1<font color="#000080">,</font>col2<font color="#000080">,</font>color<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>rr<font color="#000080">,</font>gg<font color="#000080">,</font>bb<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">,</font>incr<font color="#000080">,</font>incg<font color="#000080">,</font>incb<font color="#000080">:</font>single<font color="#000080">;
    </font>count<font color="#000080">,</font>cto<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>incr<font color="#000080">:=(</font>rh<font color="#000080">-</font>rl<font color="#000080">)/</font>abs<font color="#000080">(</font>col2<font color="#000080">-</font>col1<font color="#000080">);
 </font>incg<font color="#000080">:=(</font>gh<font color="#000080">-</font>gl<font color="#000080">)/</font>abs<font color="#000080">(</font>col2<font color="#000080">-</font>col1<font color="#000080">);
 </font>incb<font color="#000080">:=(</font>bh<font color="#000080">-</font>bl<font color="#000080">)/</font>abs<font color="#000080">(</font>col2<font color="#000080">-</font>col1<font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font>col1<font color="#000080">&lt;</font>col2 <font color="#FF0000"><b>then
 begin
   </b></font>count<font color="#000080">:=</font>col1<font color="#000080">;
   </font>cto<font color="#000080">:=</font>col2<font color="#000080">;
 </font><font color="#FF0000"><b>end else
 begin
   </b></font>count<font color="#000080">:=</font>col2<font color="#000080">;
   </font>cto<font color="#000080">:=</font>col1<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>r<font color="#000080">:=</font>rl<font color="#000080">; </font>g<font color="#000080">:=</font>gl<font color="#000080">; </font>b<font color="#000080">:=</font>bl<font color="#000080">;
 </font>rr<font color="#000080">:=</font>rl<font color="#000080">; </font>gg<font color="#000080">:=</font>gl<font color="#000080">; </font>bb<font color="#000080">:=</font>bl<font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>count<font color="#000080">:=</font>count <font color="#FF0000"><b>to </b></font>cto <font color="#FF0000"><b>do
 begin
   </b></font>setrgb<font color="#000080">(</font>count<font color="#000080">,</font>round<font color="#000080">(</font>r<font color="#000080">),</font>round<font color="#000080">(</font>g<font color="#000080">),</font>round<font color="#000080">(</font>b<font color="#000080">));
   </font>rr<font color="#000080">:=</font>rr<font color="#000080">+</font>incr<font color="#000080">;
   </font>gg<font color="#000080">:=</font>gg<font color="#000080">+</font>incg<font color="#000080">;
   </font>bb<font color="#000080">:=</font>bb<font color="#000080">+</font>incb<font color="#000080">;
   </font>r<font color="#000080">:=</font>rr<font color="#000080">; </font>g<font color="#000080">:=</font>gg<font color="#000080">; </font>b<font color="#000080">:=</font>bb<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>setrgb<font color="#000080">(</font>count<font color="#000080">,</font>round<font color="#000080">(</font>r<font color="#000080">),</font>round<font color="#000080">(</font>g<font color="#000080">),</font>round<font color="#000080">(</font>b<font color="#000080">));
 </font>cbound<font color="#000080">[</font>color<font color="#000080">].</font>lmul<font color="#000080">:=</font>abs<font color="#000080">(</font>col2<font color="#000080">-</font>col1<font color="#000080">);
 </font>cbound<font color="#000080">[</font>color<font color="#000080">].</font>llower<font color="#000080">:=</font>col1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>var
</b></font>aa<font color="#000080">,</font>bb<font color="#000080">,</font>cc<font color="#000080">,</font>incaa<font color="#000080">,</font>incbb<font color="#000080">,</font>inccc<font color="#000080">:</font>byte<font color="#000080">;
</font>rd<font color="#000080">:</font>char<font color="#000080">;
</font>vp<font color="#000080">:</font>vpointer<font color="#000080">;
</font>adr<font color="#000080">:</font>word<font color="#000080">;

</font><font color="#FF0000"><b>var  </b></font>Time <font color="#000080">: </font>Longint <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$0</font><font color="#000080">:</font><font color="#800000">$046c</font><font color="#000080">;
  </font>frame<font color="#000080">,</font>etime<font color="#000080">,</font>stime<font color="#000080">:</font>longint<font color="#000080">;

</font><font color="#FF0000"><b>begin
 asm  </b></font><font color="#FF00FF">mov ax,13h; int 10h </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>psinb<font color="#000080">;
 </font>pcosb<font color="#000080">;
 </font>LoadCoords<font color="#000080">(</font><font color="#800000">'star2.x'</font><font color="#000080">);
 </font>incaa<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>incbb<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>inccc<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>aa<font color="#000080">:=</font><font color="#800000">00</font><font color="#000080">;
 </font>bb<font color="#000080">:=</font><font color="#800000">00</font><font color="#000080">;
 </font>cc<font color="#000080">:=</font><font color="#800000">00</font><font color="#000080">;
 </font>lx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>ly<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>lz<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
 </font>origox<font color="#000080">:=</font><font color="#800000">160</font><font color="#000080">;
 </font>origoy<font color="#000080">:=</font><font color="#800000">100</font><font color="#000080">;
 </font>dist<font color="#000080">:=</font><font color="#800000">32678</font><font color="#000080">;
 </font>adr<font color="#000080">:=</font>vsetup<font color="#000080">(</font>vp<font color="#000080">);
 </font>cls<font color="#000080">(</font>adr<font color="#000080">);
 </font>prepare<font color="#000080">;
 </font>stime<font color="#000080">:=</font>time<font color="#000080">;
</font><font color="#FF0000"><b>repeat
  </b></font>inc<font color="#000080">(</font>frame<font color="#000080">);
  </font>rot<font color="#000080">(</font>aa<font color="#000080">,</font>bb<font color="#000080">,</font>cc<font color="#000080">,</font>incaa<font color="#000080">,</font>incbb<font color="#000080">,</font>inccc<font color="#000080">,</font>adr<font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font>keypressed <font color="#FF0000"><b>then
  begin </b></font>rd<font color="#000080">:=</font>readkey<font color="#000080">;
   </font><font color="#FF0000"><b>case </b></font>rd <font color="#FF0000"><b>of
         </b></font><font color="#800000">'z'</font><font color="#000080">:</font>inc<font color="#000080">(</font>incaa<font color="#000080">);
         </font><font color="#800000">'x'</font><font color="#000080">:</font>dec<font color="#000080">(</font>incaa<font color="#000080">);
         </font><font color="#800000">'c'</font><font color="#000080">:</font>inc<font color="#000080">(</font>incbb<font color="#000080">);
         </font><font color="#800000">'v'</font><font color="#000080">:</font>dec<font color="#000080">(</font>incbb<font color="#000080">);
         </font><font color="#800000">'b'</font><font color="#000080">:</font>inc<font color="#000080">(</font>inccc<font color="#000080">);
         </font><font color="#800000">'n'</font><font color="#000080">:</font>dec<font color="#000080">(</font>inccc<font color="#000080">);
         </font><font color="#800000">'t'</font><font color="#000080">:</font><font color="#FF0000"><b>begin
              </b></font>inc<font color="#000080">(</font>lalfa<font color="#000080">);
              </font>singles<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>cosb<font color="#000080">[</font>lalfa<font color="#000080">]*</font>ly<font color="#000080">-</font>sinb<font color="#000080">[</font>lalfa<font color="#000080">]*</font>lz<font color="#000080">;
              </font>singles<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font>sinb<font color="#000080">[</font>lalfa<font color="#000080">]*</font>ly<font color="#000080">+</font>cosb<font color="#000080">[</font>lalfa<font color="#000080">]*</font>lz<font color="#000080">;
              </font>singles<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font>cosb<font color="#000080">[</font>lbeta<font color="#000080">]*</font>lx<font color="#000080">+</font>sinb<font color="#000080">[</font>lbeta<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
              </font>lx<font color="#000080">:=</font>cosb<font color="#000080">[</font>lgama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]-</font>sinb<font color="#000080">[</font>lgama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
              </font>ly<font color="#000080">:=</font>sinb<font color="#000080">[</font>lgama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]+</font>cosb<font color="#000080">[</font>lgama<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
              </font>lz<font color="#000080">:=</font>cosb<font color="#000080">[</font>lbeta<font color="#000080">]*</font>singles<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]-</font>sinb<font color="#000080">[</font>lbeta<font color="#000080">]*</font>lx<font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font><font color="#800000">'s'</font><font color="#000080">:</font><font color="#FF0000"><b>begin </b></font>aa<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                   </font>bb<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                   </font>cc<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                   </font>incaa<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                   </font>incbb<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                   </font>inccc<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#800000">'a'</font><font color="#000080">:</font><font color="#FF0000"><b>begin
           </b></font>incaa<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
           </font>incbb<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
           </font>inccc<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>until </b></font>port<font color="#000080">[</font><font color="#800000">$60</font><font color="#000080">]=</font><font color="#800000">1</font><font color="#000080">;
  </font>etime<font color="#000080">:=</font>time<font color="#000080">;
</font><font color="#FF0000"><b>asm  </b></font><font color="#FF00FF">mov ax,3 ; int 10h </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>Writeln<font color="#000080">((</font>Frame<font color="#000080">*</font><font color="#800000">18.2</font><font color="#000080">)/(</font>ETime<font color="#000080">-</font>STime<font color="#000080">):</font><font color="#800000">5</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">' fps'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ The achievment:
  1) Have a perspective not correct texturemapped
     object rotating correctly -&gt; see bug in textrot.pas
  2) Turn on the range check in textrot without an error
  3) Optimize it
  4) Use any texture (see below)
  5) Fix the bug in this file for y1=y2 somewhat intelligently
  -for even better understanding, see how I made the gouraud
  triangle, in 3dfi.pas }


{ANYTHING I'M REFERING TO CAN BE FOUND IN 3DFI.PAS}

</i></font><font color="#FF0000"><b>procedure </b></font>Ttriangle<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">,</font>x3<font color="#000080">,</font>y3<font color="#000080">,</font>tx1<font color="#000080">,</font>ty1<font color="#000080">,</font>tx2<font color="#000080">,</font>ty2<font color="#000080">,</font>tx3<font color="#000080">,</font>ty3<font color="#000080">:</font>integer<font color="#000080">;
                    </font><font color="#FF0000"><b>var </b></font>bitmap<font color="#000080">;</font>target<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>var
 </b></font>u<font color="#000080">,</font>v<font color="#000080">,</font>incu<font color="#000080">,</font>incv<font color="#000080">,</font>test<font color="#000080">,</font>u1<font color="#000080">,</font>v1<font color="#000080">,</font>u2<font color="#000080">,</font>v2<font color="#000080">,</font>inc12u<font color="#000080">,</font>inc13u<font color="#000080">,</font>inc23u<font color="#000080">,</font>inc12v<font color="#000080">,</font>inc13v<font color="#000080">,</font>inc23v<font color="#000080">:</font>single<font color="#000080">;
 </font>color<font color="#000080">:</font>byte<font color="#000080">;
 </font>gu<font color="#000080">,</font>gv<font color="#000080">,</font>width<font color="#000080">:</font>word<font color="#000080">;
 </font>cnt<font color="#000080">,</font>x<font color="#000080">,</font>minY<font color="#000080">,</font>maxY<font color="#000080">,</font>midY<font color="#000080">,</font>xa<font color="#000080">,</font>xb<font color="#000080">,</font>yy<font color="#000080">,</font>p1<font color="#000080">,</font>q1<font color="#000080">,</font>p2<font color="#000080">,</font>q2<font color="#000080">,</font>p3<font color="#000080">,</font>q3<font color="#000080">:</font>integer<font color="#000080">;
 </font>ideal<font color="#000080">:</font>boolean<font color="#000080">;
 </font><font color="#008000"><i>{the things in brackets shoud have been used, but.. se below at ASM}
</i></font><font color="#FF0000"><b>begin
 </b></font>width<font color="#000080">:=</font>x2<font color="#000080">-</font>x1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;</font>y2<font color="#000080">) </font><font color="#FF0000"><b>then  </b></font><font color="#008000"><i>{sort to have y1&lt;=y2&lt;=y3, implicitly x,tx,ty are chnged}
 </i></font><font color="#FF0000"><b>begin
  </b></font>xchgi<font color="#000080">(</font>y1<font color="#000080">,</font>y2<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>x1<font color="#000080">,</font>x2<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>ty1<font color="#000080">,</font>ty2<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>tx1<font color="#000080">,</font>tx2<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;</font>y3<font color="#000080">) </font><font color="#FF0000"><b>then
 begin
  </b></font>xchgi<font color="#000080">(</font>y1<font color="#000080">,</font>y3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>x1<font color="#000080">,</font>x3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>ty1<font color="#000080">,</font>ty3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>tx1<font color="#000080">,</font>tx3<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y2<font color="#000080">&gt;</font>y3<font color="#000080">) </font><font color="#FF0000"><b>then
 begin
  </b></font>xchgi<font color="#000080">(</font>y2<font color="#000080">,</font>y3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>x2<font color="#000080">,</font>x3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>ty2<font color="#000080">,</font>ty3<font color="#000080">);
  </font>xchgi<font color="#000080">(</font>tx2<font color="#000080">,</font>tx3<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y2<font color="#000080">-</font>y1<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc12u<font color="#000080">:=(</font>tx2<font color="#000080">-</font>tx1<font color="#000080">)/(</font>y2<font color="#000080">-</font>y1<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc12u<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">-</font>y2<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc23u<font color="#000080">:=(</font>tx3<font color="#000080">-</font>tx2<font color="#000080">)/(</font>y3<font color="#000080">-</font>y2<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc23u<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">-</font>y1<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc13u<font color="#000080">:=(</font>tx3<font color="#000080">-</font>tx1<font color="#000080">)/(</font>y3<font color="#000080">-</font>y1<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc13u<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y2<font color="#000080">-</font>y1<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc12v<font color="#000080">:=(</font>ty2<font color="#000080">-</font>ty1<font color="#000080">)/(</font>y2<font color="#000080">-</font>y1<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc12v<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">-</font>y2<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc23v<font color="#000080">:=(</font>ty3<font color="#000080">-</font>ty2<font color="#000080">)/(</font>y3<font color="#000080">-</font>y2<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc23v<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">-</font>y1<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>inc13v<font color="#000080">:=(</font>ty3<font color="#000080">-</font>ty1<font color="#000080">)/(</font>y3<font color="#000080">-</font>y1<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>inc13v<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#008000"><i>{get the increasing u,v along the inc(y) between points 1..2,1..3,2..3
  (inc12,inc13,inc23)}

 </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">-</font>y1<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>test<font color="#000080">:=(</font>x3<font color="#000080">-</font>x1<font color="#000080">)/(</font>y3<font color="#000080">-</font>y1<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>test<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>test<font color="#000080">:=</font>test<font color="#000080">*(</font>y2<font color="#000080">-</font>y1<font color="#000080">);
 </font>test<font color="#000080">:=</font>test<font color="#000080">+</font>x1<font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>x2<font color="#000080">&gt;=</font>test <font color="#FF0000"><b>then </b></font>ideal<font color="#000080">:=</font>true <font color="#FF0000"><b>else </b></font>ideal<font color="#000080">:=</font>false<font color="#000080">;
 </font><font color="#008000"><i>{ the above is my speciality. I don't know any other way of solving
   this problem. If someone knows..:
   In the loop there are 2 'u' and 'v' defined: u1,u2,v1,v2:
   u1,v1 for the left side of the line, u2,v2 for the right side.
   There are two ways a triangle can look like,
   ideal: where on the left side the line between point 1 and 3,
   on the right side between point 1 and 2, 2 and three.
   I have 3 increments for y:=y+1 inc between 1..3,1..2,2..3 (inc12,inc13,
   inc23). Using the thing above,I decide to which u,v
   (left-u1,v1 or right-u2,v2) I should add which increment
   if ideal=false then the line between 1..3 is on the right side }

 </i></font>u1<font color="#000080">:=</font>tx1<font color="#000080">;</font>v1<font color="#000080">:=</font>ty1<font color="#000080">;</font>u2<font color="#000080">:=</font>tx1<font color="#000080">;</font>v2<font color="#000080">:=</font>ty1<font color="#000080">; </font><font color="#008000"><i>{we're on the begining of the texture}
 </i></font>gu<font color="#000080">:=</font>tx1<font color="#000080">;</font>gv<font color="#000080">:=</font>ty1<font color="#000080">;

 </font>p1<font color="#000080">:=</font>x1<font color="#000080">-</font>x3<font color="#000080">; </font>q1<font color="#000080">:=</font>y1<font color="#000080">-</font>y3<font color="#000080">;
 </font>p2<font color="#000080">:=</font>x2<font color="#000080">-</font>x1<font color="#000080">; </font>q2<font color="#000080">:=</font>y2<font color="#000080">-</font>y1<font color="#000080">;
 </font>p3<font color="#000080">:=</font>x3<font color="#000080">-</font>x2<font color="#000080">; </font>q3<font color="#000080">:=</font>y3<font color="#000080">-</font>y2<font color="#000080">;

  </font><font color="#FF0000"><b>for </b></font>yy<font color="#000080">:=</font>Y1 <font color="#FF0000"><b>to </b></font>Y2<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      </b></font>xa<font color="#000080">:=</font><font color="#800000">320</font><font color="#000080">;
      </font>xb<font color="#000080">:=-</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y3<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y1<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y3<font color="#000080">=</font>y1<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y3<font color="#000080">)*</font>p1 <font color="#FF0000"><b>div </b></font>q1<font color="#000080">+</font>x3<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y2<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y1<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y2<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y1<font color="#000080">=</font>y2<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y1<font color="#000080">)*</font>p2 <font color="#FF0000"><b>div </b></font>q2<font color="#000080">+</font>x1<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y2<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y3<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y2<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y3<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y2<font color="#000080">=</font>y3<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y2<font color="#000080">)*</font>p3 <font color="#FF0000"><b>div </b></font>q3<font color="#000080">+</font>x2<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>xa<font color="#000080">&lt;=</font>xb <font color="#FF0000"><b>then
      begin
       </b></font>incu<font color="#000080">:=(</font>u2<font color="#000080">-</font>u1<font color="#000080">)/(</font>xb<font color="#000080">-</font>xa<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
       </font>incv<font color="#000080">:=(</font>v2<font color="#000080">-</font>v1<font color="#000080">)/(</font>xb<font color="#000080">-</font>xa<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);</font><font color="#008000"><i>{inc for u,v for evry pixel along the scanline}
        </i></font>u<font color="#000080">:=</font>u1<font color="#000080">;
        </font>v<font color="#000080">:=</font>v1<font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>cnt<font color="#000080">:=</font>xa <font color="#FF0000"><b>to </b></font>xb <font color="#FF0000"><b>do
        begin
         </b></font><font color="#008000"><i>{well here should heve been the things in brackets, but when I use
          the assembly routine to get my color, it doesn't do well in the
          2nd part. Please have a look at it. Just put away the brackets
          round gv:=.. and asm..end in this, and the 2nd part otf the triangle
          and you'll see what I mean (!) you have to put the color:=map[..
          into brackets}

          {gv:=round(v);
          gu:=round(u);}
          </i></font>color<font color="#000080">:=</font>map<font color="#000080">[</font>round<font color="#000080">(</font>v<font color="#000080">),</font>round<font color="#000080">(</font>u<font color="#000080">)];  </font><font color="#008000"><i>{*} {choose the color of the pix}
          {asm
           mov di,offset bitmap
           mov ax,gv
           mul width
           add ax,gu
           add di,ax
           mov al,byte ptr ds:[di]
           mov color,al
          end;}
          </i></font>ppix<font color="#000080">(</font>cnt<font color="#000080">,</font>yy<font color="#000080">,</font>color<font color="#000080">,</font>target<font color="#000080">);
          </font>u<font color="#000080">:=</font>u<font color="#000080">+</font>incu<font color="#000080">;
          </font>v<font color="#000080">:=</font>v<font color="#000080">+</font>incv<font color="#000080">; </font><font color="#008000"><i>{putpixel and increment}
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>ideal<font color="#000080">=</font>false <font color="#FF0000"><b>then
        begin
          </b></font>u1<font color="#000080">:=</font>u1<font color="#000080">+</font>inc12u<font color="#000080">;     </font><font color="#008000"><i>{inc along the y:=y+1}
          </i></font>u2<font color="#000080">:=</font>u2<font color="#000080">+</font>inc13u<font color="#000080">;
          </font>v1<font color="#000080">:=</font>v1<font color="#000080">+</font>inc12v<font color="#000080">;
          </font>v2<font color="#000080">:=</font>v2<font color="#000080">+</font>inc13v<font color="#000080">;
        </font><font color="#FF0000"><b>end else
        begin
          </b></font>u1<font color="#000080">:=</font>u1<font color="#000080">+</font>inc13u<font color="#000080">;
          </font>u2<font color="#000080">:=</font>u2<font color="#000080">+</font>inc12u<font color="#000080">;
          </font>v1<font color="#000080">:=</font>v1<font color="#000080">+</font>inc13v<font color="#000080">;
          </font>v2<font color="#000080">:=</font>v2<font color="#000080">+</font>inc12v<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{the same you saw above, is down here (below), only the inc(y) increments
   are insted of inc12 changed to inc23   (more details in gouraud)}
  </i></font><font color="#FF0000"><b>for </b></font>yy<font color="#000080">:=</font>Y2 <font color="#FF0000"><b>to </b></font>Y3 <font color="#FF0000"><b>do
    begin
      </b></font>xa<font color="#000080">:=</font><font color="#800000">320</font><font color="#000080">;
      </font>xb<font color="#000080">:=-</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y3<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y3<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y1<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y3<font color="#000080">=</font>y1<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y3<font color="#000080">)*</font>p1 <font color="#FF0000"><b>div </b></font>q1<font color="#000080">+</font>x3<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y1<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y2<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y1<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y2<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y1<font color="#000080">=</font>y2<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y1<font color="#000080">)*</font>p2 <font color="#FF0000"><b>div </b></font>q2<font color="#000080">+</font>x1<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y2<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y3<font color="#000080">&gt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
        if </b></font><font color="#000080">(</font>y2<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y3<font color="#000080">&lt;=</font>yy<font color="#000080">) </font><font color="#FF0000"><b>then
          if not</b></font><font color="#000080">(</font>y2<font color="#000080">=</font>y3<font color="#000080">) </font><font color="#FF0000"><b>then begin
              </b></font>x<font color="#000080">:=(</font>yy<font color="#000080">-</font>y2<font color="#000080">)*</font>p3 <font color="#FF0000"><b>div </b></font>q3<font color="#000080">+</font>x2<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font>xa <font color="#FF0000"><b>then </b></font>xa<font color="#000080">:=</font>x<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&gt;</font>xb <font color="#FF0000"><b>then </b></font>xb<font color="#000080">:=</font>x<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>xa<font color="#000080">&lt;=</font>xb <font color="#FF0000"><b>then
      begin
        </b></font>incu<font color="#000080">:=(</font>u2<font color="#000080">-</font>u1<font color="#000080">)/(</font>xb<font color="#000080">-</font>xa<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
        </font>incv<font color="#000080">:=(</font>v2<font color="#000080">-</font>v1<font color="#000080">)/(</font>xb<font color="#000080">-</font>xa<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
        </font>u<font color="#000080">:=</font>u1<font color="#000080">;
        </font>v<font color="#000080">:=</font>v1<font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>cnt<font color="#000080">:=</font>xa <font color="#FF0000"><b>to </b></font>xb <font color="#FF0000"><b>do
        begin
          </b></font><font color="#008000"><i>{gv:=round(v);
          gu:=round(u);}
          </i></font>color<font color="#000080">:=</font>map<font color="#000080">[</font>round<font color="#000080">(</font>v<font color="#000080">),</font>round<font color="#000080">(</font>u<font color="#000080">)];  </font><font color="#008000"><i>{*}
          {asm
           mov di,offset bitmap
           mov ax,gv
           mul width
           add ax,gu
           add di,ax
           mov al,byte ptr ds:[di]
           mov color,al
          end;}
          </i></font>ppix<font color="#000080">(</font>cnt<font color="#000080">,</font>yy<font color="#000080">,</font>color<font color="#000080">,</font>target<font color="#000080">);
          </font>u<font color="#000080">:=</font>u<font color="#000080">+</font>incu<font color="#000080">;
          </font>v<font color="#000080">:=</font>v<font color="#000080">+</font>incv<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>ideal<font color="#000080">=</font>false <font color="#FF0000"><b>then
        begin
          </b></font>u1<font color="#000080">:=</font>u1<font color="#000080">+</font>inc23u<font color="#000080">;
          </font>u2<font color="#000080">:=</font>u2<font color="#000080">+</font>inc13u<font color="#000080">;
          </font>v1<font color="#000080">:=</font>v1<font color="#000080">+</font>inc23v<font color="#000080">;
          </font>v2<font color="#000080">:=</font>v2<font color="#000080">+</font>inc13v<font color="#000080">;
        </font><font color="#FF0000"><b>end else
        begin
          </b></font>u1<font color="#000080">:=</font>u1<font color="#000080">+</font>inc13u<font color="#000080">;
          </font>u2<font color="#000080">:=</font>u2<font color="#000080">+</font>inc23u<font color="#000080">;
          </font>v1<font color="#000080">:=</font>v1<font color="#000080">+</font>inc13v<font color="#000080">;
          </font>v2<font color="#000080">:=</font>v2<font color="#000080">+</font>inc23v<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>save this <font color="#FF0000"><b>as </b></font>star2<font color="#000080">.</font>x
<font color="#000080">****************</font>cut<font color="#000080">****************
</font><font color="#800000">12
20
</font><font color="#000080">;</font>triangle
<font color="#800000">12</font><font color="#000080">,</font><font color="#800000">20
1</font><font color="#000080">=-</font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">0
2</font><font color="#000080">=-</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0
3</font><font color="#000080">=-</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">0
4</font><font color="#000080">=</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">0
5</font><font color="#000080">=</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">0
6</font><font color="#000080">=</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0
7</font><font color="#000080">=</font><font color="#800000">22</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">25
8</font><font color="#000080">=</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">40
9</font><font color="#000080">=-</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">70
10</font><font color="#000080">=-</font><font color="#800000">17</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">70
11</font><font color="#000080">=-</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">40
12</font><font color="#000080">=-</font><font color="#800000">42</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">25
</font><font color="#000080">;</font>coords<font color="#000080">,</font>done
<font color="#800000">1</font><font color="#000080">=</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">-</font><font color="#800000">1
2</font><font color="#000080">=</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">-</font><font color="#800000">1
3</font><font color="#000080">=</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">-</font><font color="#800000">1
4</font><font color="#000080">=</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">-</font><font color="#800000">1
5</font><font color="#000080">=</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">-</font><font color="#800000">1
6</font><font color="#000080">=</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">-</font><font color="#800000">1
7</font><font color="#000080">=</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">-</font><font color="#800000">1
8</font><font color="#000080">=</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">-</font><font color="#800000">1
9</font><font color="#000080">=</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">-</font><font color="#800000">1
10</font><font color="#000080">=</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">-</font><font color="#800000">1
11</font><font color="#000080">=</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">-</font><font color="#800000">1
12</font><font color="#000080">=</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">-</font><font color="#800000">1
13</font><font color="#000080">=</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">-</font><font color="#800000">1
14</font><font color="#000080">=</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">-</font><font color="#800000">1
15</font><font color="#000080">=</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">-</font><font color="#800000">1
16</font><font color="#000080">=</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">-</font><font color="#800000">1
17</font><font color="#000080">=</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">-</font><font color="#800000">1
18</font><font color="#000080">=</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">-</font><font color="#800000">1
19</font><font color="#000080">=</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">-</font><font color="#800000">1
20</font><font color="#000080">=</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">-</font><font color="#800000">1

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0267.PAS">Original</a><b>]</b></p></body>
</html>
