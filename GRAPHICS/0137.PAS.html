<html>
<head><title> "Storing 3D Graphics" by BOB SCHOR</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0137.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: Bschor@vms.cis.pitt.edu

&gt; Now the problem. &quot;Seek(F, I)&quot; will only take ONE integer at a time!!
&gt; Naturally I need two. I'm trying to run it so that at each virtual
&gt; &quot;square&quot; a user can define a different message, monster, etc. And the
&gt; file i'm writing to must be able to define between X &amp; Y, [(1,2) for
&gt; example], or both of them togeter [E.G. Two steps to the right, two steps
&gt; forward = (2,2)]. HOW DO I DO THIS???

If I understand the question correctly, you are asking how to map a
two-dimensional structure (a 2-D map of your world) into a 1-dimensional
data structure (a file).  Ah, my ancient Fortran knowledge does come in
useful ...

The following works for arrays of any dimension, though you need to
have the array size fixed.  Suppose you have dimensioned World into R rows,
C columns, and L layers (I'm doing 3-D, just to show how it can be done).
To make it all very clear, I'll define the world as either a 3-D or linear
structure, using the Pascal Variant Record type.
}

</i></font><font color="#FF0000"><b>CONST
 </b></font>rows <font color="#000080">= </font><font color="#800000">30</font><font color="#000080">;
 </font>columns <font color="#000080">= </font><font color="#800000">40</font><font color="#000080">;
 </font>layers <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;
 </font>rooms <font color="#000080">= </font><font color="#800000">6000</font><font color="#000080">; </font><font color="#008000"><i>{ rows * columns * layers }
</i></font><font color="#FF0000"><b>TYPE
 </b></font>rowtype <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">.. </font>rows<font color="#000080">;
 </font>columntype <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">.. </font>columns<font color="#000080">;
 </font>layertype <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">.. </font>layers<font color="#000080">;
 </font>roomnumbertype <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">.. </font>rooms<font color="#000080">;
 </font>roomtype <font color="#000080">= </font><font color="#FF0000"><b>RECORD
 </b></font><font color="#008000"><i>{ you define as needed }
 </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font>worldtype <font color="#000080">= </font><font color="#FF0000"><b>RECORD
 CASE </b></font><font color="#000080">(</font>d3<font color="#000080">, </font>d1<font color="#000080">) </font><font color="#FF0000"><b>of
 </b></font>d3 <font color="#000080">: (</font>spatial<font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font>layertype<font color="#000080">, </font>rowtype<font color="#000080">, </font>columntype<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>roomtype<font color="#000080">);
 </font>d1 <font color="#000080">: (</font>linear <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font>roomnumbertype<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>roomtype<font color="#000080">);
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{
     Basically, you determine an order you wish to store the data.  Suppose
you say &quot;Start with the first layer, the first row, the first column.
March across the columns, then move down a row and repeat across the
columns; when you finish a layer, move down to the next layer and repeat&quot;.

     Clearly Layer 1, Row 1, Column C maps to Room C.  Since each row has
&quot;columns&quot; columns, then the mapping of Layer 1, Row R, Column C is to
Room (R-1)*columns + C.  The full mapping is --
}
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>roomnumber <font color="#000080">(</font>layer <font color="#000080">: </font>layertype<font color="#000080">; </font>row <font color="#000080">: </font>rowtype<font color="#000080">;
   </font>column <font color="#000080">: </font>columntype<font color="#000080">) : </font>roomnumbertype<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN   </b></font><font color="#008000"><i>{ roomnumber }
   </i></font>roomnumber <font color="#000080">:= </font>column <font color="#000080">+ </font>pred<font color="#000080">(</font>row<font color="#000080">)*</font>columns <font color="#000080">+ </font>pred<font color="#000080">(</font>layer<font color="#000080">)*</font>columns<font color="#000080">*</font>rows
  <font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{     Note you can also map in the other direction:}

  </i></font><font color="#FF0000"><b>FUNCTION </b></font>layer <font color="#000080">(</font>roomnumber <font color="#000080">: </font>roomnumbertype<font color="#000080">) : </font>layertype<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN   </b></font><font color="#008000"><i>{ layer }
   </i></font>layer <font color="#000080">:= </font>succ <font color="#000080">(</font>pred<font color="#000080">(</font>roomnumber<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#000080">(</font>columns <font color="#000080">* </font>rows<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>row <font color="#000080">(</font>roomnumber <font color="#000080">: </font>roomnumbertype<font color="#000080">) : </font>rowtype<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN   </b></font><font color="#008000"><i>{ row }
   </i></font>row <font color="#000080">:= </font>succ <font color="#000080">((</font>pred<font color="#000080">(</font>roomnumber<font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font><font color="#000080">(</font>columns <font color="#000080">* </font>rows<font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font>columns<font color="#000080">)
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>column <font color="#000080">(</font>roomnumber <font color="#000080">: </font>roomnumbertype<font color="#000080">) : </font>columntype<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN   </b></font><font color="#008000"><i>{ column }
   </i></font>column <font color="#000080">:= </font>succ <font color="#000080">(</font>pred<font color="#000080">(</font>roomnumber<font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font>columns<font color="#000080">)
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{
     Putting it all together, suppose you have a room, &quot;room&quot;, with room
number &quot;roomnumber&quot;, that you want to put into the world.
}
 </i></font><font color="#FF0000"><b>VAR </b></font>world <font color="#000080">: </font>worldtype<font color="#000080">;
     </font>room <font color="#000080">: </font>roomtype<font color="#000080">;
     </font>roomnumber <font color="#000080">: </font>roomnumbertype<font color="#000080">;

 </font><font color="#FF0000"><b>WITH </b></font>world <font color="#FF0000"><b>DO
  BEGIN
   </b></font>spatial<font color="#000080">[</font>layer<font color="#000080">(</font>roomnumber<font color="#000080">), </font>row<font color="#000080">(</font>roomnumber<font color="#000080">), </font>column<font color="#000080">(</font>roomnumber<font color="#000080">)] := </font>room
  <font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{
     The above fragment stores a room into the three-dimensional world.
Of course, if you know the room number (which we do), you can also simply
}

 </i></font><font color="#FF0000"><b>WITH </b></font>world <font color="#FF0000"><b>DO </b></font>linear<font color="#000080">[</font>roomnumber<font color="#000080">] := </font>room
<font color="#008000"><i>{
     For the original question, note that the &quot;roomnumber&quot; function gives
you the record number for the Seek procedure (you may need to offset by 1,
depending on how Seek is implemented ...).
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0137.PAS">Original</a><b>]</b></p></body>
</html>
