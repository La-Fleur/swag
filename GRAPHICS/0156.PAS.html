<html>
<head><title> "credits scroller" by BAS VAN GAALEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0156.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here's an example of one of the possibilities mode-q offers. Of course the same
can be done in any other mode, too... Well, just check it out. To Jens and the
other carefull ones: keep being carefull (read the text).

&gt;--- cut here
}
{$define cpu386}

</i></font><font color="#FF0000"><b>program </b></font>creditscroll<font color="#000080">;
</font><font color="#008000"><i>{ Made by Bas van Gaalen, Holland, PD }
</i></font><font color="#FF0000"><b>uses
  </b></font>crt<font color="#000080">,</font>umodeq<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>vseg<font color="#000080">:</font>word<font color="#000080">=</font><font color="#800000">$a000</font><font color="#000080">; </font>fseg<font color="#000080">=</font><font color="#800000">$f000</font><font color="#000080">; </font>fofs<font color="#000080">=</font><font color="#800000">$fa6e</font><font color="#000080">; </font>lines<font color="#000080">=</font><font color="#800000">45</font><font color="#000080">;
  </font>txt<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>lines<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">30</font><font color="#000080">]=(
   </font><font color="#008000"><i>{.........|.........|.........|}
    </i></font><font color="#800000">'This is a credits-scroll'</font><font color="#000080">,
    </font><font color="#800000">'in mode-q: 256x256x256.'</font><font color="#000080">,
    </font><font color="#800000">'That''s a chained mode, with'</font><font color="#000080">,
    </font><font color="#800000">'a lineair addressing sceme.'</font><font color="#000080">,
    </font><font color="#800000">'The graphics-screen is'</font><font color="#000080">,
    </font><font color="#800000">'initialized in the unit'</font><font color="#000080">,
    </font><font color="#800000">'umodeq. It''s enclosed in the'</font><font color="#000080">,
    </font><font color="#800000">'next message (I hope).'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,
    </font><font color="#800000">'and so the credits go to'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,
    </font><font color="#800000">'...Bas van Gaalen...'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,
    </font><font color="#800000">'Btw: this is quite lame:'</font><font color="#000080">,
    </font><font color="#800000">'not even a hardware-scroll!'</font><font color="#000080">,
    </font><font color="#800000">'But it''s just to show the'</font><font color="#000080">,
    </font><font color="#800000">'nice overscan-mode...'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,
    </font><font color="#800000">'Uuuhm, can someone supply'</font><font color="#000080">,
    </font><font color="#800000">'some shit, to fill up this'</font><font color="#000080">,
    </font><font color="#800000">'text?'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,
    </font><font color="#800000">'Oyeah, before I forget,'</font><font color="#000080">,
    </font><font color="#800000">'mode-q is a tweaked mode,'</font><font color="#000080">,
    </font><font color="#800000">'and it plays a bit with the'</font><font color="#000080">,
    </font><font color="#800000">'VGA-registers!'</font><font color="#000080">,
    </font><font color="#800000">'So again: I won''t take any'</font><font color="#000080">,
    </font><font color="#800000">'responsebilty for this code!'</font><font color="#000080">,
    </font><font color="#800000">'It works fine on my ET-4000.'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,
    </font><font color="#800000">'Gayle, place this in the SWAG'</font><font color="#000080">,
    </font><font color="#800000">'if you like...'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);

</font><font color="#FF0000"><b>procedure </b></font>retrace<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,3dah; @vert1: in al,dx; test al,8; jz @vert1
  @vert2: in al,dx; test al,8; jnz @vert2; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>moveup<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push ds; mov es,vseg; mov ds,vseg; xor di,di; mov si,0100h
  </font><font color="#008000"><i>{$ifdef cpu386} </i></font><font color="#FF00FF">mov cx,255*256/4; db $66; rep movsw
  </font><font color="#008000"><i>{$else} </i></font><font color="#FF00FF">mov cx,255*256/2; rep movsw </font><font color="#008000"><i>{$endif} </i></font><font color="#FF00FF">pop ds; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>slidx<font color="#000080">,</font>txtidx<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>setmodeq<font color="#000080">;
  </font>txtidx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>slidx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>retrace<font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>txt<font color="#000080">[</font>txtidx<font color="#000080">]) </font><font color="#FF0000"><b>do for </b></font>j<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
      if </b></font><font color="#000080">((</font>mem<font color="#000080">[</font>fseg<font color="#000080">:</font>fofs<font color="#000080">+</font>ord<font color="#000080">(</font>txt<font color="#000080">[</font>txtidx<font color="#000080">][</font>i<font color="#000080">])*</font><font color="#800000">8</font><font color="#000080">+</font>slidx<font color="#000080">] </font><font color="#FF0000"><b>shl </b></font>j<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">128</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>mem<font color="#000080">[</font>vseg<font color="#000080">:</font><font color="#800000">$fe00</font><font color="#000080">+</font>i<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">+(</font><font color="#800000">256</font><font color="#000080">-</font><font color="#800000">8</font><font color="#000080">*</font>length<font color="#000080">(</font>txt<font color="#000080">[</font>txtidx<font color="#000080">])) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">+</font>j<font color="#000080">]:=</font><font color="#800000">32</font><font color="#000080">+</font>txtidx<font color="#000080">+</font>slidx<font color="#000080">+</font>j<font color="#000080">;    </font>moveup<font color="#000080">;
    </font>slidx<font color="#000080">:=(</font><font color="#800000">1</font><font color="#000080">+</font>slidx<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">8</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>slidx<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>txtidx<font color="#000080">:=(</font><font color="#800000">1</font><font color="#000080">+</font>txtidx<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>lines<font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
  </font>inittxt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ UNIT NEEDED BY SCROLLER !! }

{ Original by Robert Schmidt in C, converted to Pas by Bas van Gaalen,
  fido: 2:285/213.8, email: bas.van.gaalen@schotman.nl, Holland, Aug. '94, PD }

</i></font><font color="#FF0000"><b>unit </b></font>umodeq<font color="#000080">;

</font><font color="#FF0000"><b>interface

const
  </b></font>vidseg<font color="#000080">:</font>word<font color="#000080">=</font><font color="#800000">$a000</font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setpal<font color="#000080">(</font>col<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>initvga<font color="#000080">; </font><font color="#008000"><i>{ not public }
</i></font><font color="#FF0000"><b>procedure </b></font>inittxt<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>openregs<font color="#000080">; </font><font color="#008000"><i>{ not public }
</i></font><font color="#FF0000"><b>procedure </b></font>closeregs<font color="#000080">; </font><font color="#008000"><i>{ not public }
</i></font><font color="#FF0000"><b>procedure </b></font>setmodeq<font color="#000080">;

</font><font color="#FF0000"><b>implementation

type
  </b></font>twrec<font color="#000080">=</font><font color="#FF0000"><b>record </b></font>reg<font color="#000080">:</font>word<font color="#000080">; </font>func<font color="#000080">,</font>data<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>twarr<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">22</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>twrec<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>tweak<font color="#000080">:</font>twarr<font color="#000080">=(
    (</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$00</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$5f</font><font color="#000080">), </font><font color="#008000"><i>{ hor. total }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$01</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$3f</font><font color="#000080">), </font><font color="#008000"><i>{ hor. display enable end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$02</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$40</font><font color="#000080">), </font><font color="#008000"><i>{ blank start }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$03</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$82</font><font color="#000080">), </font><font color="#008000"><i>{ blank end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$04</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$4e</font><font color="#000080">), </font><font color="#008000"><i>{ retrace start }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$05</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$9a</font><font color="#000080">), </font><font color="#008000"><i>{ retrace end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$06</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$23</font><font color="#000080">), </font><font color="#008000"><i>{ vertical total }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$07</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$b2</font><font color="#000080">), </font><font color="#008000"><i>{ overflow register }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$08</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$00</font><font color="#000080">), </font><font color="#008000"><i>{ preset row scan }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$09</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$61</font><font color="#000080">), </font><font color="#008000"><i>{ max scan line/char heigth }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$10</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$0a</font><font color="#000080">), </font><font color="#008000"><i>{ ver. retrace start }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$11</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$ac</font><font color="#000080">), </font><font color="#008000"><i>{ ver. retrace end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$12</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$ff</font><font color="#000080">), </font><font color="#008000"><i>{ ver. display enable end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$13</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$20</font><font color="#000080">), </font><font color="#008000"><i>{ offset/logical width }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$14</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$40</font><font color="#000080">), </font><font color="#008000"><i>{ underlinde location }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$15</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$07</font><font color="#000080">), </font><font color="#008000"><i>{ ver. blank start }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$16</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$17</font><font color="#000080">), </font><font color="#008000"><i>{ ver. blank end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$17</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$a3</font><font color="#000080">), </font><font color="#008000"><i>{ mode control }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03c4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$01</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$01</font><font color="#000080">), </font><font color="#008000"><i>{ clock mode register }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03c4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$04</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$0e</font><font color="#000080">), </font><font color="#008000"><i>{ memory mode register }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03ce</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$05</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$40</font><font color="#000080">), </font><font color="#008000"><i>{ mode register }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03ce</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$06</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$05</font><font color="#000080">), </font><font color="#008000"><i>{ misc. register }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03c0</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$10</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$41</font><font color="#000080">)  </font><font color="#008000"><i>{ mode control }
  </i></font><font color="#000080">);

</font><font color="#FF0000"><b>procedure </b></font>setpal<font color="#000080">(</font>col<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b <font color="#000080">: </font>byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,03c8h; mov al,col; out dx,al; inc dx; mov al,r; out dx,al
  mov al,g; out dx,al; mov al,b; out dx,al; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>initvga<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">mov ax,13h; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>inittxt<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">mov ax,3; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>openregs<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,03d4h; mov al,11h; out dx,al; inc dx; in al,dx; and al,7fh
  mov ah,al; mov al,11h; dec dx; out dx,ax; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>closeregs<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,03d4h; mov al,11h; out dx,al; inc dx; in al,dx; or al,80h
  mov ah,al; mov al,11h; dec dx; out dx,ax; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setmodeq<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>initvga<font color="#000080">;
  </font>openregs<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">22 </font><font color="#FF0000"><b>do
    with </b></font>tweak<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do begin
      if </b></font>reg<font color="#000080">&lt;&gt;</font><font color="#800000">$03c0 </font><font color="#FF0000"><b>then </b></font>port<font color="#000080">[</font>reg<font color="#000080">]:=</font>func <font color="#FF0000"><b>else </b></font>port<font color="#000080">[</font>reg<font color="#000080">]:=</font>func<font color="#000080">+</font><font color="#800000">32</font><font color="#000080">;
      </font>port<font color="#000080">[</font>reg<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>data<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>closeregs<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{var x,y:byte;
begin
  setmodeq;
  for x:=0 to 255 do setpal(x,x div 4,x div 5,x div 6);
  for x:=0 to 255 do for y:=0 to 255 do mem[vidseg:y*256+x]:=(x+y) mod 255;
  readln;
  inittxt;}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0156.PAS">Original</a><b>]</b></p></body>
</html>
