<html>
<head><title> "Cannon Ball Animation" by LUIS MEZQUITA RAYA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0104.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 JG&gt; This coding works fine, I would like to make the ball travel
 JG&gt; smoother.  When it travels in the air, its kinda &quot;Chunky&quot;

 JG&gt; How could you make it so that the computer calculates the next
 JG&gt; point and make it travel the ball to that point one pixel at a
 JG&gt; time?  Cause with this structure, it kinda &quot;Jumps there&quot;

        Try next code and tell me ...
}

</i></font><font color="#FF0000"><b>Program </b></font>FallingBall<font color="#000080">;

</font><font color="#008000"><i>{ Written by Luis Mezquita Raya }

{$x+}

</i></font><font color="#FF0000"><b>uses  </b></font>Crt<font color="#000080">,
      </font>Graph<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Init<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>cg<font color="#000080">,</font>mg<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>cg<font color="#000080">:=</font>Detect<font color="#000080">;
 </font>InitGraph<font color="#000080">(</font>cg<font color="#000080">,</font>mg<font color="#000080">,</font><font color="#800000">'\turbo\tp'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Wait<font color="#000080">(</font>msk<font color="#000080">:</font>byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
        </b></font><font color="#FF00FF">mov dx,3dah
@Loop1: in al,dx
        test al,msk
        jz @Loop1
@Loop2: in al,dx
        test al,msk
        jnz @Loop2
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Calc<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>angle<font color="#000080">,</font>power<font color="#000080">,</font>gravity<font color="#000080">,</font>a1<font color="#000080">,</font>a2<font color="#000080">,</font>a3<font color="#000080">,</font>y0<font color="#000080">,</font>n<font color="#000080">:</font>real<font color="#000080">;
    </font>size<font color="#000080">:</font>word<font color="#000080">;
    </font>ball<font color="#000080">,</font>mask<font color="#000080">,</font>bkg<font color="#000080">:</font>pointer<font color="#000080">;
    </font>x<font color="#000080">,</font>y<font color="#000080">,</font>ox<font color="#000080">,</font>oy<font color="#000080">,</font>pause<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin

 </b></font>ClearViewPort<font color="#000080">;

 </font>size<font color="#000080">:=</font>ImageSize<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);
 </font>GetMem<font color="#000080">(</font>ball<font color="#000080">,</font>size<font color="#000080">);
 </font>GetMem<font color="#000080">(</font>mask<font color="#000080">,</font>size<font color="#000080">);
 </font>GetMem<font color="#000080">(</font>bkg<font color="#000080">,</font>size<font color="#000080">);

 </font>SetFillStyle<font color="#000080">(</font>SolidFill<font color="#000080">,</font>Yellow<font color="#000080">);        </font><font color="#008000"><i>{ Draw a ball }
 </i></font>Circle<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
 </font>FloodFill<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font>White<font color="#000080">);
 </font>GetImage<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>ball<font color="#000080">^);             </font><font color="#008000"><i>{ Get the ball }

 </i></font>SetFillStyle<font color="#000080">(</font>SolidFill<font color="#000080">,</font>White<font color="#000080">);         </font><font color="#008000"><i>{ Draw ball's mask }
 </i></font>Bar<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);
 </font>SetFillStyle<font color="#000080">(</font>SolidFill<font color="#000080">,</font>Black<font color="#000080">);
 </font>SetColor<font color="#000080">(</font>Black<font color="#000080">);
 </font>Circle<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">);
 </font>FloodFill<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font>Black<font color="#000080">);
 </font>GetImage<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>mask<font color="#000080">^);             </font><font color="#008000"><i>{ Get the mask }

 </i></font>ClearViewPort<font color="#000080">;                         </font><font color="#008000"><i>{ Draw a background }
 </i></font>SetFillStyle<font color="#000080">(</font>CloseDotFill<font color="#000080">,</font>LightBlue<font color="#000080">);
 </font>Bar<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>GetMaxX<font color="#000080">,</font>GetMaxY<font color="#000080">);

 </font>angle<font color="#000080">:=</font><font color="#800000">35</font><font color="#000080">;                             </font><font color="#008000"><i>{ Init vars }
 </i></font>power<font color="#000080">:=</font><font color="#800000">10</font><font color="#000080">;
 </font>gravity<font color="#000080">:=</font><font color="#800000">0.1</font><font color="#000080">;
 </font>y0<font color="#000080">:=</font><font color="#800000">200</font><font color="#000080">;
 </font>ox<font color="#000080">:=-</font><font color="#800000">1</font><font color="#000080">;
 </font>n<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;

 </font><font color="#FF0000"><b>while </b></font>n<font color="#000080">&lt;</font><font color="#800000">80 </font><font color="#FF0000"><b>do                          </b></font><font color="#008000"><i>{ Main loop }
  </i></font><font color="#FF0000"><b>begin
   </b></font>a1<font color="#000080">:=</font>cos<font color="#000080">(</font>angle<font color="#000080">*</font>pi<font color="#000080">/</font><font color="#800000">180</font><font color="#000080">)*</font>power<font color="#000080">*</font>n<font color="#000080">;
   </font>a2<font color="#000080">:=</font>y0<font color="#000080">-</font>sin<font color="#000080">(</font>angle<font color="#000080">*</font>pi<font color="#000080">/</font><font color="#800000">180</font><font color="#000080">)*</font>power<font color="#000080">*</font>n<font color="#000080">;
   </font>a3<font color="#000080">:=</font>gravity<font color="#000080">*</font>n<font color="#000080">*</font>n<font color="#000080">;
   </font>x<font color="#000080">:=</font>Round<font color="#000080">(</font>a1<font color="#000080">);
   </font>y<font color="#000080">:=</font>Round<font color="#000080">(</font>a2<font color="#000080">+</font>a3<font color="#000080">);
   </font>Wait<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">);                             </font><font color="#008000"><i>{ Wait retrace }
   </i></font><font color="#FF0000"><b>for </b></font>pause<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">399 </font><font color="#FF0000"><b>do </b></font>Wait<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);      </font><font color="#008000"><i>{ Wait scan line }
   </i></font><font color="#FF0000"><b>if </b></font>ox<font color="#000080">&lt;&gt;-</font><font color="#800000">1                            </font><font color="#008000"><i>{ Restore old background }
   </i></font><font color="#FF0000"><b>then </b></font>PutImage<font color="#000080">(</font>ox<font color="#000080">,</font>oy<font color="#000080">,</font>bkg<font color="#000080">^,</font>CopyPut<font color="#000080">);
   </font>GetImage<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>x<font color="#000080">+</font><font color="#800000">20</font><font color="#000080">,</font>y<font color="#000080">+</font><font color="#800000">20</font><font color="#000080">,</font>bkg<font color="#000080">^);        </font><font color="#008000"><i>{ Save background }
   </i></font>PutImage<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>mask<font color="#000080">^,</font>AndPut<font color="#000080">);          </font><font color="#008000"><i>{ Put mask }
   </i></font>PutImage<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>ball<font color="#000080">^,</font>OrPut<font color="#000080">);           </font><font color="#008000"><i>{ Put ball }
   </i></font>ox<font color="#000080">:=</font>x<font color="#000080">;
   </font>oy<font color="#000080">:=</font>y<font color="#000080">;
   </font>n<font color="#000080">:=</font>n<font color="#000080">+</font><font color="#800000">0.2</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font>FreeMem<font color="#000080">(</font>ball<font color="#000080">,</font>size<font color="#000080">);
 </font>FreeMem<font color="#000080">(</font>mask<font color="#000080">,</font>size<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin
 </b></font>Init<font color="#000080">;
 </font>Calc<font color="#000080">;
 </font>ReadKey<font color="#000080">;
 </font>CloseGraph<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0104.PAS">Original</a><b>]</b></p></body>
</html>
