<html>
<head><title> "Vga 256 Color PCX" by OLAF BARTELT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0116.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 CF&gt; I am working with VGA 320x200x256.  Can anyone please help
 CF&gt; me with a good line routine and the PCX format?  I have
 CF&gt; tryed both and things go bad.. If you have code laying
 CF&gt; around it would help me a lot...  Thanks

}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>load_pcx<font color="#000080">(</font>dx<font color="#000080">, </font>dy <font color="#000080">: </font>WORD<font color="#000080">; </font>name <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>q                          <font color="#000080">: </font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;        </font><font color="#008000"><i>{ Quellendatei-Handle         }
    </i></font>b                          <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2047</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;  </font><font color="#008000"><i>{ Puffer          }
    </i></font>anz<font color="#000080">, </font>pos<font color="#000080">, </font>c<font color="#000080">, </font>w<font color="#000080">, </font>h<font color="#000080">, </font>e<font color="#000080">, </font>pack <font color="#000080">: </font>WORD<font color="#000080">;        </font><font color="#008000"><i>{ diverse benîtigte Variablen }
    </i></font>x<font color="#000080">, </font>y                       <font color="#000080">: </font>WORD<font color="#000080">;        </font><font color="#008000"><i>{ fÅr die PCX-Laderoutine     }

</i></font><font color="#FF0000"><b>LABEL </b></font>ende_background<font color="#000080">;                        </font><font color="#008000"><i>{ Sprungmarken definieren     }

</i></font><font color="#FF0000"><b>BEGIN
  </b></font>x <font color="#000080">:= </font>dx<font color="#000080">; </font>y <font color="#000080">:= </font>dy<font color="#000080">;                           </font><font color="#008000"><i>{ Nullpunkt festsetzen        }

  </i></font>ASSIGN<font color="#000080">(</font>q<font color="#000080">, </font>name<font color="#000080">); </font><font color="#008000"><i>{$I-} </i></font>RESET<font color="#000080">(</font>q<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{$I+}   { Quellendatei îffnen         }
  </i></font><font color="#FF0000"><b>IF </b></font>IORESULT <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN                       </b></font><font color="#008000"><i>{ Fehler beim &trade;ffnen?         }
    </i></font><font color="#FF0000"><b>GOTO </b></font>ende_background<font color="#000080">;                     </font><font color="#008000"><i>{ Ja: zum Ende springen       }

  </i></font>BLOCKREAD<font color="#000080">(</font>q<font color="#000080">, </font>b<font color="#000080">, </font><font color="#800000">128</font><font color="#000080">, </font>anz<font color="#000080">);                  </font><font color="#008000"><i>{ Header einlesen             }

  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>b<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &lt;&gt; </font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>b<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] &lt;&gt; </font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>{ wirklich ein PCX-File?      }
  </i></font><font color="#FF0000"><b>BEGIN
    </b></font>CLOSE<font color="#000080">(</font>q<font color="#000080">);                                 </font><font color="#008000"><i>{ Nein: Datei schlie&aacute;en und   }
    </i></font><font color="#FF0000"><b>GOTO </b></font>ende_background<font color="#000080">;                     </font><font color="#008000"><i>{       zum Ende springen     }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>w <font color="#000080">:= </font>SUCC<font color="#000080">((</font>b<font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] - </font>b<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]) </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8 </font><font color="#000080">+ </font>b<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">] - </font>b<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);  </font><font color="#008000"><i>{ Breite auslesen          }
  </i></font>h <font color="#000080">:= </font>SUCC<font color="#000080">((</font>b<font color="#000080">[</font><font color="#800000">11</font><font color="#000080">] - </font>b<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">]) </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8 </font><font color="#000080">+ </font>b<font color="#000080">[</font><font color="#800000">10</font><font color="#000080">] - </font>b<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]);  </font><font color="#008000"><i>{ Hîhe auslesen          }

  </i></font>pack <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>c <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>e <font color="#000080">:= </font>y <font color="#000080">+ </font>h<font color="#000080">;
  </font><font color="#FF0000"><b>REPEAT
    </b></font>BLOCKREAD<font color="#000080">(</font>q<font color="#000080">, </font>b<font color="#000080">, </font><font color="#800000">2048</font><font color="#000080">, </font>anz<font color="#000080">);

    </font>pos <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>pos <font color="#000080">&lt; </font>anz<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>y <font color="#000080">&lt; </font>e<font color="#000080">) </font><font color="#FF0000"><b>DO
    BEGIN
      IF </b></font>pack <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      BEGIN
        FOR </b></font>c <font color="#000080">:= </font>c <font color="#FF0000"><b>TO </b></font>c <font color="#000080">+ </font>pack <font color="#FF0000"><b>DO
          </b></font>MEM<font color="#000080">[</font>SEGA000<font color="#000080">:</font>y<font color="#000080">*</font><font color="#800000">320</font><font color="#000080">+(</font>x<font color="#000080">+</font>c<font color="#000080">)] := </font>b<font color="#000080">[</font>pos<font color="#000080">];
        </font>pack <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>END
      ELSE
        IF </b></font><font color="#000080">(</font>b<font color="#000080">[</font>pos<font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$C0</font><font color="#000080">) = </font><font color="#800000">$C0 </font><font color="#FF0000"><b>THEN
          </b></font>pack <font color="#000080">:= </font>b<font color="#000080">[</font>pos<font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$3F
        </font><font color="#FF0000"><b>ELSE
        BEGIN
          </b></font>MEM<font color="#000080">[</font>SEGA000<font color="#000080">:</font>y<font color="#000080">*</font><font color="#800000">320</font><font color="#000080">+(</font>x<font color="#000080">+</font>c<font color="#000080">)] := </font>b<font color="#000080">[</font>pos<font color="#000080">];
          </font>INC<font color="#000080">(</font>c<font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

      </font>INC<font color="#000080">(</font>pos<font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>c <font color="#000080">= </font>w <font color="#FF0000"><b>THEN                           </b></font><font color="#008000"><i>{ letzte Spalte erreicht?     }
      </i></font><font color="#FF0000"><b>BEGIN
        </b></font>c <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                               </font><font color="#008000"><i>{ Ja: Spalte auf 0 setzen und }
        </i></font>INC<font color="#000080">(</font>y<font color="#000080">);                               </font><font color="#008000"><i>{     in die nÑchste Zeile    }
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>anz <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>y <font color="#000080">= </font>e<font color="#000080">);

  </font>SEEK<font color="#000080">(</font>q<font color="#000080">, </font>FILESIZE<font color="#000080">(</font>q<font color="#000080">) - </font><font color="#800000">3 </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8 </font><font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
  </font>BLOCKREAD<font color="#000080">(</font>q<font color="#000080">, </font>b<font color="#000080">, </font><font color="#800000">3 </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);

  </font><font color="#FF0000"><b>IF </b></font>b<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] = </font><font color="#800000">12 </font><font color="#FF0000"><b>THEN
    FOR </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">3 </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8 </font><font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
      </b></font>b<font color="#000080">[</font>x<font color="#000080">] := </font>b<font color="#000080">[</font>x<font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">2</font><font color="#000080">;

  </font>PORT<font color="#000080">[</font><font color="#800000">$3C8</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#FF0000"><b>FOR </b></font>x <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">255 </font><font color="#FF0000"><b>DO
  BEGIN
    </b></font>PORT<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>b<font color="#000080">[</font>x<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
    </font>PORT<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>b<font color="#000080">[</font>x<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">];
    </font>PORT<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>b<font color="#000080">[</font>x<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">];
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>CLOSE<font color="#000080">(</font>q<font color="#000080">);

</font>ende_background<font color="#000080">:
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
    </b></font>Load_Pcx<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">'c:\lpexface.pcx'</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0116.PAS">Original</a><b>]</b></p></body>
</html>
