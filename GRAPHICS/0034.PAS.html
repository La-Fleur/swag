<html>
<head><title> "Display PIC Files" by DAVE FOSTER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Dave Foster

&gt; Could anyone please post any routines or help on how
&gt; to read an image into TURBO 6. I can save the image
&gt; in any format, but i need code to be able to display
&gt; it on the screen. Source code would be an advantage!
&gt;
I wrote this Program For a friend to read a image into his Program, and
and I would be happy For any help on how to improve it.
}

</i></font><font color="#FF0000"><b>Program  </b></font>Read_Image<font color="#000080">;      </font><font color="#008000"><i>{ SRC-CODE.PAS   ver 1.00 }
{-----------------------------------------------------------------------------
 Program reads in a binary data File, and displays the image on the screen by
 using &quot;PutPixel&quot; Procedure in the Graph Unit.  The image can be displayed in
 color, or in grey-scale by using the subroutine &quot;Set64Gray&quot; below.
 This is a quick and dirty method to display the image using &quot;PutPixel&quot;,
 and I hope someone will be able to show us how to use the &quot;PutImage&quot; to
 display the image quicker.
-----------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">, </font>Crt<font color="#000080">, </font>Graph<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>ByteArray <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">175</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Gd<font color="#000080">, </font>Gm<font color="#000080">,
  </font>m<font color="#000080">, </font>n    <font color="#000080">: </font>Integer<font color="#000080">;
  </font>buffer  <font color="#000080">: </font>ByteArray<font color="#000080">;
  </font>f       <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;

</font><font color="#008000"><i>{
&gt; Does anyone know how can I get a Graphic mode in VGA in which I
&gt; could use 64 gray level (at least 32)?  Could I keep on using the
&gt; Graphical Procedures in Unit Graph then?

 The fragment below will initialize the first 64 VGA color values to
 gray scale.  These colors are valid For any VGA mode (including Text),
 but in most Graphics modes/devices the Borland Graph Unit limits you
 to using only 16 colors.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>Set64Gray<font color="#000080">;
</font><font color="#008000"><i>{ Sets up 64 shades of gray where 0 = black, 63 = full white }
</i></font><font color="#FF0000"><b>Type
  </b></font>CRec <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>R<font color="#000080">, </font>G<font color="#000080">, </font>B<font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
  </font>I    <font color="#000080">: </font>Integer<font color="#000080">;
  </font>G64  <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">63</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>CRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ Initialize the block of color values }
  </i></font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>do
  With </b></font>G64<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>do
  begin
    </b></font>R <font color="#000080">:= </font>I<font color="#000080">;
    </font>G <font color="#000080">:= </font>I<font color="#000080">;          </font><font color="#008000"><i>{ Color is gray when RGB values are equal }
    </i></font>B <font color="#000080">:= </font>I<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$1012</font><font color="#000080">;      </font><font color="#008000"><i>{ Dos Function to update block of colors }
  </i></font>Regs<font color="#000080">.</font>bx <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;          </font><font color="#008000"><i>{ First color to change }
  </i></font>Regs<font color="#000080">.</font>cx <font color="#000080">:= </font><font color="#800000">64</font><font color="#000080">;         </font><font color="#008000"><i>{ Number of colors to change }
  </i></font>Regs<font color="#000080">.</font>es <font color="#000080">:= </font>seg<font color="#000080">(</font>G64<font color="#000080">); </font><font color="#008000"><i>{ Address of block of color values }
  </i></font>Regs<font color="#000080">.</font>dx <font color="#000080">:= </font>ofs<font color="#000080">(</font>G64<font color="#000080">);
  </font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>Regs<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Gd <font color="#000080">:= </font>detect<font color="#000080">;
  </font>initGraph<font color="#000080">(</font>Gd<font color="#000080">, </font>Gm<font color="#000080">, </font><font color="#800000">'e:\bp\bgi'</font><font color="#000080">);

  </font><font color="#008000"><i>{ Open the image File which is 250 lines, and 175 pixels per line.
    Each pixel is 1 Byte, and no header data, or Record delimiters.
    File is 43,750 Bytes (250 x 175) in size.  Have look at the input
    File using binary File viewer. }

   </i></font>assign<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'DOMINO.DAT'</font><font color="#000080">);
   </font>reset<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">175</font><font color="#000080">);

  </font><font color="#008000"><i>{ if you enable this, you will be able to see the image in grey-scale,
    but I am not sure if it is quite right.  Currently it seems to display
    only few grey-scale levels instead of the full 64 levels.

   }</i></font>Set64Gray<font color="#000080">;

  </font><font color="#008000"><i>{ Method used to read the File line at a time, and Write the pixel
    values to the screen. This is bit slow, and it would be lot faster
    by using &quot;PutImage&quot; but I do not know the method For that. }

   </i></font>n <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>While not </b></font>eof<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>do
   begin
     </b></font>BlockRead<font color="#000080">(</font>f<font color="#000080">, </font>buffer<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
     </font><font color="#FF0000"><b>For </b></font>m <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">175 </font><font color="#FF0000"><b>do
       </b></font>PutPixel<font color="#000080">(</font>m<font color="#000080">, </font>n<font color="#000080">, </font>buffer<font color="#000080">[</font>m<font color="#000080">]);
     </font>n <font color="#000080">:= </font>n <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>close<font color="#000080">(</font>f<font color="#000080">);
   </font>readln<font color="#000080">;
   </font>closeGraph<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
The image File &quot;DOMINO.DAT&quot; used in the Program &quot;SRC-CODE.PAS&quot;.
Image File is 250 x 175 pixels (43,750 Bytes).
}

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p></body>
</html>
