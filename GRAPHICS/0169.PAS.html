<html>
<head><title> "Texture Vector" by ALEX CHALFIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0169.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here is a re-vamped version of my texture mapper. Code has been used from
several sources. The texture mapper is mine. The rotation code is from
Bas van Gaalan (look like anything from GFXFX? :). The whole thing was
thrown together by Daniel Wakefield (including some conversion of my texture
maper to ASM). I hope everyone finds this useful. The texture mapper it self
isn't very good, but it gives you an idea of how it can be done (if you
want source for a good texture mapper, register GFXFX2!!).

Without further delay.....

{ -------------- Begin Code -----------------}

{$r-,g+}
</i></font><font color="#FF0000"><b>program </b></font>texure_poly<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>TE <font color="#000080">= </font><font color="#FF0000"><b>Record  </b></font>X <font color="#000080">: </font>Integer<font color="#000080">; </font>px<font color="#000080">, </font>py <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Table <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">199</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>TE<font color="#000080">; </font>PTable <font color="#000080">= ^</font>Table<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Left<font color="#000080">, </font>Right <font color="#000080">: </font>Table<font color="#000080">;  </font>stab<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;
  </font>polyz<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">; </font>pind<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>page<font color="#000080">,</font>virscr<font color="#000080">:</font>pointer<font color="#000080">; </font>pageseg<font color="#000080">,</font>virseg<font color="#000080">:</font>word<font color="#000080">; </font>Frame<font color="#000080">, </font>St<font color="#000080">, </font>Et <font color="#000080">: </font>Longint<font color="#000080">;
  </font>Time <font color="#000080">: </font>Longint <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$046c</font><font color="#000080">; </font>pxVal<font color="#000080">, </font>pxStep <font color="#000080">: </font>Integer<font color="#000080">;
  </font>pyVal<font color="#000080">, </font>pyStep <font color="#000080">: </font>Integer<font color="#000080">; </font>Count<font color="#000080">, </font>res <font color="#000080">: </font>Integer<font color="#000080">; </font>O1 <font color="#000080">: </font>Word<font color="#000080">; </font>b<font color="#000080">:</font>byte<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>Bitmap <font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">16</font><font color="#000080">*</font><font color="#800000">16</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#000080">= (
  </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,
  </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,
  </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,
  </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,
  </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,
  </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,
  </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,
  </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font>pointnum<font color="#000080">=</font><font color="#800000">11</font><font color="#000080">; </font>planenum<font color="#000080">=</font><font color="#800000">7</font><font color="#000080">; </font>border<font color="#000080">=</font>false<font color="#000080">; </font>vidseg<font color="#000080">:</font>word<font color="#000080">=</font><font color="#800000">$a000</font><font color="#000080">;
  </font>divd<font color="#000080">=</font><font color="#800000">128</font><font color="#000080">; </font>dist<font color="#000080">=</font><font color="#800000">200</font><font color="#000080">; </font>points<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>pointnum<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">=(
    (-</font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),( </font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),( </font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),( </font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),
    (-</font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),(-</font><font color="#800000">40</font><font color="#000080">,-</font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),(-</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),( </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">),
    ( </font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">),( </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),(-</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">,-</font><font color="#800000">30</font><font color="#000080">),(-</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">));
  </font>planes<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>planenum<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">=(
    (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">),(</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">),(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">),(</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),
    (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">),(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">),(</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">),(</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">));
</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Procedure </b></font>TextureHLine<font color="#000080">(</font>X1<font color="#000080">, </font>X2<font color="#000080">, </font>px1<font color="#000080">, </font>py1<font color="#000080">, </font>px2<font color="#000080">, </font>py2<font color="#000080">, </font>Y <font color="#000080">: </font>Integer<font color="#000080">; </font>Dim <font color="#000080">: </font>Word<font color="#000080">);
 </font><font color="#FF0000"><b>Begin </b></font>pxStep <font color="#000080">:= ((</font>px2<font color="#000080">-</font>px1<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>x2<font color="#000080">-</font>x1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>pyStep <font color="#000080">:= ((</font>py2<font color="#000080">-</font>py1<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>x2<font color="#000080">-</font>x1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>asm
   </b></font><font color="#FF00FF">mov     bx, px1; shl bx, 8; mov pxval,bx;  </font><font color="#008000"><i>{  pxVal := px1 Shl 8;}
   </i></font><font color="#FF00FF">mov     bx, py1; shl bx, 8; mov pyval,bx;  </font><font color="#008000"><i>{  pyVal := py1 Shl 8;}
   </i></font><font color="#FF00FF">mov     ax,y; shl     ax,6; mov     di,ax; shl     ax,2
   add     di,ax; add     di,x1; mov     o1, di; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Count <font color="#000080">:= </font>X1 <font color="#FF0000"><b>to </b></font>X2 <font color="#FF0000"><b>do
    Begin
     </b></font>b<font color="#000080">:= </font>Bitmap<font color="#000080">[</font>Hi<font color="#000080">(</font>pxVal<font color="#000080">)+(</font>Hi<font color="#000080">(</font>pyVal<font color="#000080">)) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">4</font><font color="#000080">];
     </font><font color="#FF0000"><b>Asm </b></font><font color="#FF00FF">mov ax,virseg; mov es,ax; mov ax,o1; mov di,ax; mov al, b;
      mov es:[di],al; mov ax, pxval; add ax, pxstep;mov pxval, ax;
      mov ax, pyval; add ax, pystep; mov pyval, ax; inc o1; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; ; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Swap<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>A<font color="#000080">, </font>B <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>t <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Begin </b></font>t <font color="#000080">:= </font>a<font color="#000080">; </font>a <font color="#000080">:= </font>b<font color="#000080">; </font>b <font color="#000080">:= </font>t<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Texture4Poly<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">, </font>X3<font color="#000080">, </font>Y3<font color="#000080">, </font>X4<font color="#000080">, </font>Y4 <font color="#000080">: </font>Integer<font color="#000080">; </font>Dim <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>yMin<font color="#000080">, </font>yMax <font color="#000080">: </font>Integer<font color="#000080">; </font>xStart<font color="#000080">, </font>xEnd <font color="#000080">: </font>Integer<font color="#000080">; </font>yStart<font color="#000080">, </font>yEnd <font color="#000080">: </font>Integer<font color="#000080">;
  </font>pxStart<font color="#000080">, </font>pxEnd <font color="#000080">: </font>Integer<font color="#000080">; </font>pyStart<font color="#000080">,</font>pyEnd  <font color="#000080">: </font>Integer<font color="#000080">; </font>XVal<font color="#000080">, </font>XStep <font color="#000080">: </font>Longint<font color="#000080">;
  </font>pxVal<font color="#000080">, </font>pxStep <font color="#000080">: </font>Integer<font color="#000080">; </font>pyVal<font color="#000080">, </font>pyStep <font color="#000080">: </font>Integer<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Side <font color="#000080">: </font>PTable<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>yMin <font color="#000080">:= </font>Y1<font color="#000080">; </font>yMax <font color="#000080">:= </font>Y1<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Y2 <font color="#000080">&gt; </font>yMax <font color="#FF0000"><b>Then </b></font>yMax <font color="#000080">:= </font>Y2<font color="#000080">; </font><font color="#FF0000"><b>If </b></font>Y3 <font color="#000080">&gt; </font>yMax <font color="#FF0000"><b>Then </b></font>yMax <font color="#000080">:= </font>Y3<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Y4 <font color="#000080">&gt; </font>yMax <font color="#FF0000"><b>Then </b></font>yMax <font color="#000080">:= </font>Y4<font color="#000080">; </font><font color="#FF0000"><b>If </b></font>Y2 <font color="#000080">&lt; </font>yMin <font color="#FF0000"><b>Then </b></font>yMin <font color="#000080">:= </font>Y2<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Y3 <font color="#000080">&lt; </font>yMin <font color="#FF0000"><b>Then </b></font>yMin <font color="#000080">:= </font>Y3<font color="#000080">; </font><font color="#FF0000"><b>If </b></font>Y4 <font color="#000080">&lt; </font>yMin <font color="#FF0000"><b>Then </b></font>yMin <font color="#000080">:= </font>Y4<font color="#000080">;
  </font>xStart <font color="#000080">:= </font>X1<font color="#000080">; </font>yStart <font color="#000080">:= </font>Y1<font color="#000080">; </font>xEnd <font color="#000080">:= </font>X2<font color="#000080">; </font>yEnd <font color="#000080">:= </font>Y2<font color="#000080">;
  </font>pxStart <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>pyStart <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>pxEnd <font color="#000080">:= </font>Dim<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font>pyEnd <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>yStart <font color="#000080">&gt; </font>yEnd <font color="#FF0000"><b>Then Begin
      </b></font>Swap<font color="#000080">(</font>xStart<font color="#000080">, </font>xEnd<font color="#000080">); </font>Swap<font color="#000080">(</font>yStart<font color="#000080">, </font>yEnd<font color="#000080">); </font>Swap<font color="#000080">(</font>pxStart<font color="#000080">, </font>pxEnd<font color="#000080">);
      </font>Side <font color="#000080">:= @</font>Left<font color="#000080">; </font><font color="#FF0000"><b>End Else </b></font>Side <font color="#000080">:= @</font>Right<font color="#000080">;
  </font>XVal <font color="#000080">:= </font>Longint<font color="#000080">(</font>xStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">;
  </font>XStep <font color="#000080">:= (</font>Longint<font color="#000080">(</font>xEnd<font color="#000080">-</font>xStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>yEnd<font color="#000080">-</font>yStart<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>pxVal <font color="#000080">:= </font>pxStart <font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">;
  </font>pxStep <font color="#000080">:= ((</font>pxEnd<font color="#000080">-</font>pxStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>yEnd<font color="#000080">-</font>yStart<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Count <font color="#000080">:= </font>yStart <font color="#FF0000"><b>to </b></font>yEnd <font color="#FF0000"><b>do
    Begin </b></font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>x <font color="#000080">:= </font>XVal <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">; </font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>px <font color="#000080">:= </font>pxVal <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">;
      </font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>py <font color="#000080">:= </font>pyStart<font color="#000080">; </font>XVal <font color="#000080">:= </font>XVal <font color="#000080">+ </font>XStep<font color="#000080">;
      </font>pxVal <font color="#000080">:= </font>pxVal <font color="#000080">+ </font>pxStep<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>xStart <font color="#000080">:= </font>X2<font color="#000080">; </font>yStart <font color="#000080">:= </font>Y2<font color="#000080">; </font>xEnd <font color="#000080">:= </font>X3<font color="#000080">; </font>yEnd <font color="#000080">:= </font>Y3<font color="#000080">;
  </font>pxStart <font color="#000080">:= </font>Dim<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font>pyStart <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>pxEnd <font color="#000080">:= </font>Dim<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font>pyEnd <font color="#000080">:= </font>Dim<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>yStart <font color="#000080">&gt; </font>yEnd <font color="#FF0000"><b>Then Begin </b></font>Swap<font color="#000080">(</font>xStart<font color="#000080">, </font>xEnd<font color="#000080">); </font>Swap<font color="#000080">(</font>yStart<font color="#000080">, </font>yEnd<font color="#000080">);
      </font>Swap<font color="#000080">(</font>pyStart<font color="#000080">, </font>pyEnd<font color="#000080">); </font>Side <font color="#000080">:= @</font>Left<font color="#000080">; </font><font color="#FF0000"><b>End Else </b></font>Side <font color="#000080">:= @</font>Right<font color="#000080">;
  </font>XVal <font color="#000080">:= </font>Longint<font color="#000080">(</font>xStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">;
  </font>XStep <font color="#000080">:= (</font>Longint<font color="#000080">(</font>xEnd<font color="#000080">-</font>xStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>yEnd<font color="#000080">-</font>yStart<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>pyVal <font color="#000080">:= </font>pyStart <font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">;
  </font>pyStep <font color="#000080">:= ((</font>pyEnd<font color="#000080">-</font>pyStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>yEnd<font color="#000080">-</font>yStart<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Count <font color="#000080">:= </font>yStart <font color="#FF0000"><b>to </b></font>yEnd <font color="#FF0000"><b>do
    Begin </b></font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>x <font color="#000080">:= </font>XVal <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">; </font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>py <font color="#000080">:= </font>pyVal <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">;
      </font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>px <font color="#000080">:= </font>pxStart<font color="#000080">; </font>XVal <font color="#000080">:= </font>XVal <font color="#000080">+ </font>XStep<font color="#000080">;
      </font>pyVal <font color="#000080">:= </font>pyVal <font color="#000080">+ </font>pyStep<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>xStart <font color="#000080">:= </font>X3<font color="#000080">; </font>yStart <font color="#000080">:= </font>Y3<font color="#000080">; </font>xEnd <font color="#000080">:= </font>X4<font color="#000080">; </font>yEnd <font color="#000080">:= </font>Y4<font color="#000080">;
  </font>pxStart <font color="#000080">:= </font>Dim<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font>pyStart <font color="#000080">:= </font>Dim<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font>pxEnd <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>pyEnd <font color="#000080">:= </font>Dim<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>yStart <font color="#000080">&gt; </font>yEnd <font color="#FF0000"><b>Then Begin </b></font>Swap<font color="#000080">(</font>xStart<font color="#000080">, </font>xEnd<font color="#000080">); </font>Swap<font color="#000080">(</font>yStart<font color="#000080">, </font>yEnd<font color="#000080">);
      </font>Swap<font color="#000080">(</font>pxStart<font color="#000080">, </font>pxEnd<font color="#000080">); </font>Side <font color="#000080">:= @</font>Left<font color="#000080">; </font><font color="#FF0000"><b>End Else </b></font>Side <font color="#000080">:= @</font>Right<font color="#000080">;
  </font>XVal <font color="#000080">:= </font>Longint<font color="#000080">(</font>xStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">;
  </font>XStep <font color="#000080">:= (</font>Longint<font color="#000080">(</font>xEnd<font color="#000080">-</font>xStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>yEnd<font color="#000080">-</font>yStart<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>pxVal <font color="#000080">:= </font>pxStart <font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">;
  </font>pxStep <font color="#000080">:= ((</font>pxEnd<font color="#000080">-</font>pxStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>yEnd<font color="#000080">-</font>yStart<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Count <font color="#000080">:= </font>yStart <font color="#FF0000"><b>to </b></font>yEnd <font color="#FF0000"><b>do
    Begin </b></font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>x <font color="#000080">:= </font>XVal <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">; </font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>px <font color="#000080">:= </font>pxVal <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">;
      </font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>py <font color="#000080">:= </font>pyStart<font color="#000080">; </font>XVal <font color="#000080">:= </font>XVal <font color="#000080">+ </font>XStep<font color="#000080">;
      </font>pxVal <font color="#000080">:= </font>pxVal <font color="#000080">+ </font>pxStep<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>xStart <font color="#000080">:= </font>X4<font color="#000080">; </font>yStart <font color="#000080">:= </font>Y4<font color="#000080">;</font>xEnd <font color="#000080">:= </font>X1<font color="#000080">; </font>yEnd <font color="#000080">:= </font>Y1<font color="#000080">;
  </font>pxStart <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;  </font>pyStart <font color="#000080">:= </font>Dim<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font>pxEnd <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>pyEnd <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>yStart <font color="#000080">&gt; </font>yEnd
    <font color="#FF0000"><b>Then Begin </b></font>Swap<font color="#000080">(</font>xStart<font color="#000080">, </font>xEnd<font color="#000080">); </font>Swap<font color="#000080">(</font>yStart<font color="#000080">, </font>yEnd<font color="#000080">);
      </font>Swap<font color="#000080">(</font>pyStart<font color="#000080">, </font>pyEnd<font color="#000080">); </font>Side <font color="#000080">:= @</font>Left<font color="#000080">; </font><font color="#FF0000"><b>End
    Else </b></font>Side <font color="#000080">:= @</font>Right<font color="#000080">;
  </font>XVal <font color="#000080">:= </font>Longint<font color="#000080">(</font>xStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">;
  </font>XStep <font color="#000080">:= (</font>Longint<font color="#000080">(</font>xEnd<font color="#000080">-</font>xStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>yEnd<font color="#000080">-</font>yStart<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>pyVal <font color="#000080">:= </font>pyStart <font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">;
  </font>pyStep <font color="#000080">:= ((</font>pyEnd<font color="#000080">-</font>pyStart<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>yEnd<font color="#000080">-</font>yStart<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Count <font color="#000080">:= </font>yStart <font color="#FF0000"><b>to </b></font>yEnd <font color="#FF0000"><b>do
    Begin </b></font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>x <font color="#000080">:= </font>XVal <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">; </font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>py <font color="#000080">:= </font>pyVal <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">;
      </font>Side<font color="#000080">^[</font>Count<font color="#000080">].</font>px <font color="#000080">:= </font>pxStart<font color="#000080">; </font>XVal <font color="#000080">:= </font>XVal <font color="#000080">+ </font>XStep<font color="#000080">;
      </font>pyVal <font color="#000080">:= </font>pyVal <font color="#000080">+ </font>pyStep<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Count <font color="#000080">:= </font>yMin <font color="#FF0000"><b>to </b></font>yMax <font color="#FF0000"><b>do
    If </b></font>Left<font color="#000080">[</font>Count<font color="#000080">].</font>x <font color="#000080">&lt; </font>Right<font color="#000080">[</font>Count<font color="#000080">].</font>x
      <font color="#FF0000"><b>Then </b></font>TextureHLine<font color="#000080">(</font>Left<font color="#000080">[</font>Count<font color="#000080">].</font>x<font color="#000080">, </font>Right<font color="#000080">[</font>Count<font color="#000080">].</font>x<font color="#000080">, </font>Left<font color="#000080">[</font>Count<font color="#000080">].</font>px<font color="#000080">, </font>Left<font color="#000080">[</font>Count<font color="#000080">].</font>py<font color="#000080">,
              </font>Right<font color="#000080">[</font>Count<font color="#000080">].</font>px<font color="#000080">, </font>Right<font color="#000080">[</font>Count<font color="#000080">].</font>py<font color="#000080">, </font>Count<font color="#000080">, </font>Dim<font color="#000080">)
      </font><font color="#FF0000"><b>Else </b></font>TextureHLine<font color="#000080">(</font>Right<font color="#000080">[</font>Count<font color="#000080">].</font>x<font color="#000080">, </font>Left<font color="#000080">[</font>Count<font color="#000080">].</font>x<font color="#000080">, </font>Right<font color="#000080">[</font>Count<font color="#000080">].</font>px<font color="#000080">, </font>Right<font color="#000080">[</font>Count<font color="#000080">].</font>py<font color="#000080">,
              </font>Left<font color="#000080">[</font>Count<font color="#000080">].</font>px<font color="#000080">, </font>Left<font color="#000080">[</font>Count<font color="#000080">].</font>py<font color="#000080">, </font>Count<font color="#000080">, </font>Dim<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setpal<font color="#000080">(</font>c<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm</b></font><font color="#FF00FF">; mov dx,3c8h; mov al,[c]; out dx,al; inc dx; mov al,[r]; out dx,al
  mov al,[g]; out dx,al; mov al,[b]; out dx,al; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>flip<font color="#000080">(</font>src<font color="#000080">,</font>dst<font color="#000080">:</font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
</b></font><font color="#FF00FF">push ds; mov es,[dst]; mov ds,[src]; xor si,si; xor di,di; mov cx,320*200/2
rep movsw; pop ds; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>quicksort<font color="#000080">(</font>lo<font color="#000080">,</font>hi<font color="#000080">:</font>integer<font color="#000080">);

</font><font color="#FF0000"><b>procedure </b></font>sort<font color="#000080">(</font>l<font color="#000080">,</font>r<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>i<font color="#000080">:=</font>l<font color="#000080">; </font>j<font color="#000080">:=</font>r<font color="#000080">; </font>x<font color="#000080">:=</font>polyz<font color="#000080">[(</font>l<font color="#000080">+</font>r<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">];
  </font><font color="#FF0000"><b>repeat
    while </b></font>polyz<font color="#000080">[</font>i<font color="#000080">]&lt;</font>x <font color="#FF0000"><b>do </b></font>inc<font color="#000080">(</font>i<font color="#000080">); </font><font color="#FF0000"><b>while </b></font>x<font color="#000080">&lt;</font>polyz<font color="#000080">[</font>j<font color="#000080">] </font><font color="#FF0000"><b>do </b></font>dec<font color="#000080">(</font>j<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">&lt;=</font>j <font color="#FF0000"><b>then begin </b></font>y<font color="#000080">:=</font>polyz<font color="#000080">[</font>i<font color="#000080">]; </font>polyz<font color="#000080">[</font>i<font color="#000080">]:=</font>polyz<font color="#000080">[</font>j<font color="#000080">]; </font>polyz<font color="#000080">[</font>j<font color="#000080">]:=</font>y<font color="#000080">;
      </font>y<font color="#000080">:=</font>pind<font color="#000080">[</font>i<font color="#000080">]; </font>pind<font color="#000080">[</font>i<font color="#000080">]:=</font>pind<font color="#000080">[</font>j<font color="#000080">]; </font>pind<font color="#000080">[</font>j<font color="#000080">]:=</font>y<font color="#000080">; </font>inc<font color="#000080">(</font>i<font color="#000080">); </font>dec<font color="#000080">(</font>j<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>i<font color="#000080">&gt;</font>j<font color="#000080">; </font><font color="#FF0000"><b>if </b></font>l<font color="#000080">&lt;</font>j <font color="#FF0000"><b>then </b></font>sort<font color="#000080">(</font>l<font color="#000080">,</font>j<font color="#000080">); </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">&lt;</font>r <font color="#FF0000"><b>then </b></font>sort<font color="#000080">(</font>i<font color="#000080">,</font>r<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>sort<font color="#000080">(</font>lo<font color="#000080">,</font>hi<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>sinus<font color="#000080">(</font>i<font color="#000080">:</font>byte<font color="#000080">):</font>integer<font color="#000080">; </font><font color="#FF0000"><b>begin </b></font>sinus<font color="#000080">:=</font>stab<font color="#000080">[</font>i<font color="#000080">]; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>cosinus<font color="#000080">(</font>i<font color="#000080">:</font>byte<font color="#000080">):</font>integer<font color="#000080">; </font><font color="#FF0000"><b>begin </b></font>cosinus<font color="#000080">:=</font>stab<font color="#000080">[(</font>i<font color="#000080">+</font><font color="#800000">192</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">255</font><font color="#000080">]; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>rotate_cube<font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>xst<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">; </font>yst<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">; </font>zst<font color="#000080">=-</font><font color="#800000">4</font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>xp<font color="#000080">,</font>yp<font color="#000080">,</font>z<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;
  </font>x<font color="#000080">,</font>y<font color="#000080">,</font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">:</font>integer<font color="#000080">;
  </font>n<font color="#000080">,</font>Key<font color="#000080">,</font>phix<font color="#000080">,</font>phiy<font color="#000080">,</font>phiz<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>phix<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>phiy<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>phiz<font color="#000080">:=</font><font color="#800000">40</font><font color="#000080">; </font>fillchar<font color="#000080">(</font>xp<font color="#000080">,</font>sizeof<font color="#000080">(</font>xp<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font>fillchar<font color="#000080">(</font>yp<font color="#000080">,</font>sizeof<font color="#000080">(</font>yp<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">); </font>Frame <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>St <font color="#000080">:= </font>Time<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>flip<font color="#000080">(</font>pageseg<font color="#000080">,</font>virseg<font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>n<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>pointnum <font color="#FF0000"><b>do begin
      </b></font>i<font color="#000080">:=(</font>cosinus<font color="#000080">(</font>phiy<font color="#000080">)*</font>points<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]-</font>sinus<font color="#000080">(</font>phiy<font color="#000080">)*</font>points<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">;
      </font>j<font color="#000080">:=(</font>cosinus<font color="#000080">(</font>phiz<font color="#000080">)*</font>points<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]-</font>sinus<font color="#000080">(</font>phiz<font color="#000080">)*</font>i<font color="#000080">) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">;
      </font>k<font color="#000080">:=(</font>cosinus<font color="#000080">(</font>phiy<font color="#000080">)*</font>points<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]+</font>sinus<font color="#000080">(</font>phiy<font color="#000080">)*</font>points<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">;
      </font>x<font color="#000080">:=(</font>cosinus<font color="#000080">(</font>phiz<font color="#000080">)*</font>i<font color="#000080">+</font>sinus<font color="#000080">(</font>phiz<font color="#000080">)*</font>points<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">;
      </font>y<font color="#000080">:=(</font>cosinus<font color="#000080">(</font>phix<font color="#000080">)*</font>j<font color="#000080">+</font>sinus<font color="#000080">(</font>phix<font color="#000080">)*</font>k<font color="#000080">) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">;
      </font>z<font color="#000080">[</font>n<font color="#000080">]:=(</font>cosinus<font color="#000080">(</font>phix<font color="#000080">)*</font>k<font color="#000080">-</font>sinus<font color="#000080">(</font>phix<font color="#000080">)*</font>j<font color="#000080">) </font><font color="#FF0000"><b>div </b></font>divd<font color="#000080">+</font>cosinus<font color="#000080">(</font>phix<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">3</font><font color="#000080">;
      </font>xp<font color="#000080">[</font>n<font color="#000080">]:=</font><font color="#800000">160</font><font color="#000080">+</font>sinus<font color="#000080">(</font>phix<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">+(-</font>x<font color="#000080">*</font>dist<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#000080">(</font>z<font color="#000080">[</font>n<font color="#000080">]-</font>dist<font color="#000080">);
      </font>yp<font color="#000080">[</font>n<font color="#000080">]:=</font><font color="#800000">100</font><font color="#000080">+(-</font>y<font color="#000080">*</font>dist<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#000080">(</font>z<font color="#000080">[</font>n<font color="#000080">]-</font>dist<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>n<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>planenum <font color="#FF0000"><b>do begin
      </b></font>polyz<font color="#000080">[</font>n<font color="#000080">]:=(</font>z<font color="#000080">[</font>planes<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]]+</font>z<font color="#000080">[</font>planes<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]]) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">; </font>pind<font color="#000080">[</font>n<font color="#000080">]:=</font>n<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>quicksort<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>planenum<font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>n<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>planenum <font color="#FF0000"><b>do
      </b></font>texture4poly<font color="#000080">(</font>xp<font color="#000080">[</font>planes<font color="#000080">[</font>pind<font color="#000080">[</font>n<font color="#000080">],</font><font color="#800000">0</font><font color="#000080">]],</font>yp<font color="#000080">[</font>planes<font color="#000080">[</font>pind<font color="#000080">[</font>n<font color="#000080">],</font><font color="#800000">0</font><font color="#000080">]],
                   </font>xp<font color="#000080">[</font>planes<font color="#000080">[</font>pind<font color="#000080">[</font>n<font color="#000080">],</font><font color="#800000">1</font><font color="#000080">]],</font>yp<font color="#000080">[</font>planes<font color="#000080">[</font>pind<font color="#000080">[</font>n<font color="#000080">],</font><font color="#800000">1</font><font color="#000080">]],
                   </font>xp<font color="#000080">[</font>planes<font color="#000080">[</font>pind<font color="#000080">[</font>n<font color="#000080">],</font><font color="#800000">2</font><font color="#000080">]],</font>yp<font color="#000080">[</font>planes<font color="#000080">[</font>pind<font color="#000080">[</font>n<font color="#000080">],</font><font color="#800000">2</font><font color="#000080">]],
                   </font>xp<font color="#000080">[</font>planes<font color="#000080">[</font>pind<font color="#000080">[</font>n<font color="#000080">],</font><font color="#800000">3</font><font color="#000080">]],</font>yp<font color="#000080">[</font>planes<font color="#000080">[</font>pind<font color="#000080">[</font>n<font color="#000080">],</font><font color="#800000">3</font><font color="#000080">]],</font><font color="#800000">16</font><font color="#000080">);
    </font>inc<font color="#000080">(</font>phix<font color="#000080">,</font>xst<font color="#000080">); </font>inc<font color="#000080">(</font>phiy<font color="#000080">,</font>yst<font color="#000080">); </font>inc<font color="#000080">(</font>phiz<font color="#000080">,</font>zst<font color="#000080">); </font>flip<font color="#000080">(</font>virseg<font color="#000080">,</font>vidseg<font color="#000080">);
    </font>inc<font color="#000080">(</font>frame<font color="#000080">); </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">; </font>Et<font color="#000080">:=</font>time<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm </b></font><font color="#FF00FF">mov ax,13h; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>getmem<font color="#000080">(</font>virscr<font color="#000080">,</font><font color="#800000">64000</font><font color="#000080">);
  </font>virseg<font color="#000080">:=</font>seg<font color="#000080">(</font>virscr<font color="#000080">^);
  </font>getmem<font color="#000080">(</font>page<font color="#000080">,</font><font color="#800000">64000</font><font color="#000080">);
  </font>pageseg<font color="#000080">:=</font>seg<font color="#000080">(</font>page<font color="#000080">^);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do </b></font>stab<font color="#000080">[</font>i<font color="#000080">]:=</font>round<font color="#000080">(</font>sin<font color="#000080">(</font>i<font color="#000080">*</font>pi<font color="#000080">/</font><font color="#800000">128</font><font color="#000080">)*</font>divd<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">104 </font><font color="#FF0000"><b>do </b></font>setpal<font color="#000080">(</font><font color="#800000">150</font><font color="#000080">+</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">+</font>i <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">+</font>i <font color="#FF0000"><b>div </b></font><font color="#800000">5</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">319 </font><font color="#FF0000"><b>do for </b></font>j<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">199 </font><font color="#FF0000"><b>do </b></font>mem<font color="#000080">[</font>pageseg<font color="#000080">:</font>j<font color="#000080">*</font><font color="#800000">320</font><font color="#000080">+</font>i<font color="#000080">]:=</font><font color="#800000">151</font><font color="#000080">+(</font>i<font color="#000080">*</font>i<font color="#000080">+</font>j<font color="#000080">*</font>j<font color="#000080">) </font><font color="#FF0000"><b>mod
</b></font><font color="#800000">104</font><font color="#000080">;
  </font>rotate_cube<font color="#000080">;
  </font>freemem<font color="#000080">(</font>page<font color="#000080">,</font><font color="#800000">64000</font><font color="#000080">);
  </font>freemem<font color="#000080">(</font>virscr<font color="#000080">,</font><font color="#800000">64000</font><font color="#000080">);
  </font>textmode<font color="#000080">(</font>lastmode<font color="#000080">);
  </font>Writeln<font color="#000080">(</font>Frame<font color="#000080">*</font><font color="#800000">18.2</font><font color="#000080">/(</font>Et<font color="#000080">-</font>St<font color="#000080">):</font><font color="#800000">5</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">' fps'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0169.PAS">Original</a><b>]</b></p></body>
</html>
