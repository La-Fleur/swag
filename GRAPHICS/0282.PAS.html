<html>
<head><title> "Spline code 4 SWAG" by RON NOSSAMAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0282.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000"> <font color="#008000"><i>{ At last! A couple of spline routines that CONNECT the data points.}
 {they are set up in a simple, but probably useless, manner for you to
  configure to suit. The reconfigurations are simple, it's the core
  routines that seem to be hard to get.}

</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>graph<font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>maxnodes<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">;
      </font>sigma<font color="#000080">:</font>real<font color="#000080">=</font><font color="#800000">1.0</font><font color="#000080">;  </font><font color="#008000"><i>{tension factor}
      </i></font>total<font color="#000080">=</font><font color="#800000">100</font><font color="#000080">;
</font><font color="#FF0000"><b>type </b></font>data<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>maxnodes<font color="#000080">]</font><font color="#FF0000"><b>of </b></font>real<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>xmin<font color="#000080">,</font>xmax<font color="#000080">,</font>sum<font color="#000080">,</font>xx<font color="#000080">,</font>yy<font color="#000080">:</font>real<font color="#000080">;
    </font>i<font color="#000080">,</font>n<font color="#000080">,</font>eger<font color="#000080">:</font>integer<font color="#000080">;
    </font>xc<font color="#000080">,</font>yc<font color="#000080">,</font>xp<font color="#000080">,</font>yp<font color="#000080">,</font>temp<font color="#000080">,</font>path<font color="#000080">:</font>data<font color="#000080">;
    </font>GraphDriver<font color="#000080">,</font>GraphMode<font color="#000080">,</font>ErrorCode<font color="#000080">:</font>Integer<font color="#000080">;
    </font>ch<font color="#000080">:</font>char<font color="#000080">;
    </font>alternate<font color="#000080">:</font>boolean<font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Spline1<font color="#000080">(</font>color<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#008000"><i>{ Fits a smooth curve through a given set of points. Small, simple, fast.
  No tension factor.
  From Algorithms, Robert Sedgewick, sort of...
  simple, but limited
  Beat beyond recognition by Ron Nossaman June 1996 }
</i></font><font color="#FF0000"><b>Var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>oldy<font color="#000080">,</font>oldx<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;
    </font>part<font color="#000080">,</font>t<font color="#000080">,</font>xx<font color="#000080">,</font>yy<font color="#000080">:</font>real<font color="#000080">;
    </font>d<font color="#000080">,</font>wy<font color="#000080">,</font>wx<font color="#000080">:</font>data<font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>f<font color="#000080">(</font>g<font color="#000080">:</font>real<font color="#000080">):</font>real<font color="#000080">;
  </font><font color="#FF0000"><b>begin
     </b></font>f<font color="#000080">:=</font>g<font color="#000080">*</font>g<font color="#000080">*</font>g<font color="#000080">-</font>g<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>setcolor<font color="#000080">(</font>color<font color="#000080">);
   </font>oldx<font color="#000080">:=</font><font color="#800000">999</font><font color="#000080">;
   </font>x<font color="#000080">:=</font>round<font color="#000080">(</font>xc<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
   </font>y<font color="#000080">:=</font>round<font color="#000080">(</font>yc<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);

        </font><font color="#008000"><i>{calculate matrix for x &amp; y}
   </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>maxnodes<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>d<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">4</font><font color="#000080">; </font><font color="#008000"><i>{fake ascending sequence}
   </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>maxnodes<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
   begin
      </b></font>wy<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">6</font><font color="#000080">*((</font>yc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>yc<font color="#000080">[</font>i<font color="#000080">])-(</font>yc<font color="#000080">[</font>i<font color="#000080">]-</font>yc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]));
      </font>wx<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">6</font><font color="#000080">*((</font>xc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>xc<font color="#000080">[</font>i<font color="#000080">])-(</font>xc<font color="#000080">[</font>i<font color="#000080">]-</font>xc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>yp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">0.0</font><font color="#000080">; </font>xp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">0.0</font><font color="#000080">;
   </font>yp<font color="#000080">[</font>maxnodes<font color="#000080">]:=</font><font color="#800000">0.0</font><font color="#000080">; </font>xp<font color="#000080">[</font>maxnodes<font color="#000080">]:=</font><font color="#800000">0.0</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>maxnodes<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>do
   begin
      </b></font>wy<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>wy<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>wy<font color="#000080">[</font>i<font color="#000080">]*</font><font color="#800000">0.25</font><font color="#000080">;
      </font>wx<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>wx<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>wx<font color="#000080">[</font>i<font color="#000080">]*</font><font color="#800000">0.25</font><font color="#000080">;
      </font>d<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>d<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font><font color="#800000">0.25</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>maxnodes<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
   begin
      </b></font>yp<font color="#000080">[</font>i<font color="#000080">]:=(</font>wy<font color="#000080">[</font>i<font color="#000080">]-</font>yp<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">])/</font>d<font color="#000080">[</font>i<font color="#000080">];
      </font>xp<font color="#000080">[</font>i<font color="#000080">]:=(</font>wx<font color="#000080">[</font>i<font color="#000080">]-</font>xp<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">])/</font>d<font color="#000080">[</font>i<font color="#000080">];
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font><font color="#008000"><i>{ Draw spline  }
   </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>maxnodes<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
   begin
      for </b></font>j<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">30 </font><font color="#FF0000"><b>do </b></font><font color="#008000"><i>{arbitrary number of steps between points}
      </i></font><font color="#FF0000"><b>begin
         </b></font>t<font color="#000080">:=</font>j<font color="#000080">/</font><font color="#800000">30</font><font color="#000080">;
         </font>part<font color="#000080">:=</font>t<font color="#000080">*</font>yc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]+(</font><font color="#800000">1</font><font color="#000080">-</font>t<font color="#000080">)*</font>yc<font color="#000080">[</font>i<font color="#000080">]+(</font>f<font color="#000080">(</font>t<font color="#000080">)*</font>yp<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]+</font>f<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">-</font>t<font color="#000080">)*</font>yp<font color="#000080">[</font>i<font color="#000080">])/</font><font color="#800000">6.0</font><font color="#000080">;
         </font>y<font color="#000080">:=</font>round<font color="#000080">(</font>part<font color="#000080">);
         </font>part<font color="#000080">:=</font>t<font color="#000080">*</font>xc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]+(</font><font color="#800000">1</font><font color="#000080">-</font>t<font color="#000080">)*</font>xc<font color="#000080">[</font>i<font color="#000080">]+(</font>f<font color="#000080">(</font>t<font color="#000080">)*</font>xp<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]+</font>f<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">-</font>t<font color="#000080">)*</font>xp<font color="#000080">[</font>i<font color="#000080">])/</font><font color="#800000">6.0</font><font color="#000080">;
         </font>x<font color="#000080">:=</font>round<font color="#000080">(</font>part<font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font>oldx<font color="#000080">&lt;&gt;</font><font color="#800000">999 </font><font color="#FF0000"><b>then </b></font>line<font color="#000080">(</font>oldx<font color="#000080">,</font>oldy<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">);
         </font>oldx<font color="#000080">:=</font>x<font color="#000080">;
         </font>oldy<font color="#000080">:=</font>y<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Spline2<font color="#000080">(</font>color<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#008000"><i>{ Fits a smooth curve through a given set of points. Small, simple, fast.
  No tension factor. Nicer curve than above Spline1 routine.
  From Algorithms, Robert Sedgewick, sort of...
  Beat beyond recognition by Ron Nossaman June 1996 }
</i></font><font color="#FF0000"><b>Var </b></font>i<font color="#000080">,</font>oldy<font color="#000080">,</font>oldx<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>j<font color="#000080">:</font>integer<font color="#000080">;
    </font>part<font color="#000080">,</font>t<font color="#000080">,</font>xx<font color="#000080">,</font>yy<font color="#000080">:</font>real<font color="#000080">;
    </font>zc<font color="#000080">,</font>dx<font color="#000080">,</font>dy<font color="#000080">,</font>u<font color="#000080">,</font>wx<font color="#000080">,</font>wy<font color="#000080">,</font>px<font color="#000080">,</font>py<font color="#000080">:</font>data<font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>f<font color="#000080">(</font>g<font color="#000080">:</font>real<font color="#000080">):</font>real<font color="#000080">;
  </font><font color="#FF0000"><b>begin
     </b></font>f<font color="#000080">:=</font>g<font color="#000080">*</font>g<font color="#000080">*</font>g<font color="#000080">-</font>g<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>setcolor<font color="#000080">(</font>color<font color="#000080">);
   </font>oldx<font color="#000080">:=</font><font color="#800000">999</font><font color="#000080">;
   </font>x<font color="#000080">:=</font>round<font color="#000080">(</font>xc<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
   </font>y<font color="#000080">:=</font>round<font color="#000080">(</font>yc<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
   </font>zc<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">0.0</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>maxnodes <font color="#FF0000"><b>do
   begin
      </b></font>xx<font color="#000080">:=</font>xc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]-</font>xc<font color="#000080">[</font>i<font color="#000080">]; </font>yy<font color="#000080">:=</font>yc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]-</font>yc<font color="#000080">[</font>i<font color="#000080">];
      </font>t<font color="#000080">:=</font>sqrt<font color="#000080">(</font>xx<font color="#000080">*</font>xx<font color="#000080">+</font>yy<font color="#000080">*</font>yy<font color="#000080">);
      </font>zc<font color="#000080">[</font>i<font color="#000080">]:=</font>zc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]+</font>t<font color="#000080">;     </font><font color="#008000"><i>{establish a proportional linear progression}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{calculate x &amp; y matrix stuff}
   </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>maxnodes<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
   begin
      </b></font>dx<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">2</font><font color="#000080">*(</font>zc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>zc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]);
      </font>dy<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">2</font><font color="#000080">*(</font>zc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>zc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>maxnodes<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
   begin
      </b></font>u<font color="#000080">[</font>i<font color="#000080">]:=</font>zc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>zc<font color="#000080">[</font>i<font color="#000080">];
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>maxnodes<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
   begin
      </b></font>wy<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">6</font><font color="#000080">*((</font>yc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>yc<font color="#000080">[</font>i<font color="#000080">])/</font>u<font color="#000080">[</font>i<font color="#000080">]-(</font>yc<font color="#000080">[</font>i<font color="#000080">]-</font>yc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">])/</font>u<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]);
      </font>wx<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">6</font><font color="#000080">*((</font>xc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>xc<font color="#000080">[</font>i<font color="#000080">])/</font>u<font color="#000080">[</font>i<font color="#000080">]-(</font>xc<font color="#000080">[</font>i<font color="#000080">]-</font>xc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">])/</font>u<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>py<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">0.0</font><font color="#000080">; </font>px<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">0.0</font><font color="#000080">;    </font>px<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">; </font>py<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
   </font>py<font color="#000080">[</font>maxnodes<font color="#000080">]:=</font><font color="#800000">0.0</font><font color="#000080">; </font>px<font color="#000080">[</font>maxnodes<font color="#000080">]:=</font><font color="#800000">0.0</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>maxnodes<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>do
   begin
      </b></font>wy<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>wy<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>wy<font color="#000080">[</font>i<font color="#000080">]*</font>u<font color="#000080">[</font>i<font color="#000080">]/</font>dy<font color="#000080">[</font>i<font color="#000080">];
      </font>dy<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>dy<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>u<font color="#000080">[</font>i<font color="#000080">]*</font>u<font color="#000080">[</font>i<font color="#000080">]/</font>dy<font color="#000080">[</font>i<font color="#000080">];
      </font>wx<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>wx<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>wx<font color="#000080">[</font>i<font color="#000080">]*</font>u<font color="#000080">[</font>i<font color="#000080">]/</font>dx<font color="#000080">[</font>i<font color="#000080">];
      </font>dx<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>dx<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>u<font color="#000080">[</font>i<font color="#000080">]*</font>u<font color="#000080">[</font>i<font color="#000080">]/</font>dx<font color="#000080">[</font>i<font color="#000080">];
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>maxnodes<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
   begin
      </b></font>py<font color="#000080">[</font>i<font color="#000080">]:=(</font>wy<font color="#000080">[</font>i<font color="#000080">]-</font>u<font color="#000080">[</font>i<font color="#000080">]*</font>py<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">])/</font>dy<font color="#000080">[</font>i<font color="#000080">];
      </font>px<font color="#000080">[</font>i<font color="#000080">]:=(</font>wx<font color="#000080">[</font>i<font color="#000080">]-</font>u<font color="#000080">[</font>i<font color="#000080">]*</font>px<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">])/</font>dx<font color="#000080">[</font>i<font color="#000080">];
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Draw spline  }
   </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>maxnodes<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
   begin
      for </b></font>j<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">30 </font><font color="#FF0000"><b>do
      begin
         </b></font>part<font color="#000080">:=</font>zc<font color="#000080">[</font>i<font color="#000080">]-(((</font>zc<font color="#000080">[</font>i<font color="#000080">]-</font>zc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">])/</font><font color="#800000">30</font><font color="#000080">)*</font>j<font color="#000080">);
         </font>t<font color="#000080">:=(</font>part<font color="#000080">-</font>zc<font color="#000080">[</font>i<font color="#000080">])/</font>u<font color="#000080">[</font>i<font color="#000080">];
         </font>part<font color="#000080">:=</font>t<font color="#000080">*</font>yc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]+(</font><font color="#800000">1</font><font color="#000080">-</font>t<font color="#000080">)*</font>yc<font color="#000080">[</font>i<font color="#000080">]+</font>u<font color="#000080">[</font>i<font color="#000080">]*</font>u<font color="#000080">[</font>i<font color="#000080">]*(</font>f<font color="#000080">(</font>t<font color="#000080">)*</font>py<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]+</font>f<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">-</font>t<font color="#000080">)*</font>py<font color="#000080">[</font>i<font color="#000080">])/</font><font color="#800000">6.0</font><font color="#000080">;
         </font>y<font color="#000080">:=</font>round<font color="#000080">(</font>part<font color="#000080">);
         </font>part<font color="#000080">:=</font>zc<font color="#000080">[</font>i<font color="#000080">]-(((</font>zc<font color="#000080">[</font>i<font color="#000080">]-</font>zc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">])/</font><font color="#800000">30</font><font color="#000080">)*</font>j<font color="#000080">);
         </font>t<font color="#000080">:=(</font>part<font color="#000080">-</font>zc<font color="#000080">[</font>i<font color="#000080">])/</font>u<font color="#000080">[</font>i<font color="#000080">];
         </font>part<font color="#000080">:=</font>t<font color="#000080">*</font>xc<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]+(</font><font color="#800000">1</font><font color="#000080">-</font>t<font color="#000080">)*</font>xc<font color="#000080">[</font>i<font color="#000080">]+</font>u<font color="#000080">[</font>i<font color="#000080">]*</font>u<font color="#000080">[</font>i<font color="#000080">]*(</font>f<font color="#000080">(</font>t<font color="#000080">)*</font>px<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]+</font>f<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">-</font>t<font color="#000080">)*</font>px<font color="#000080">[</font>i<font color="#000080">])/</font><font color="#800000">6.0</font><font color="#000080">;
         </font>x<font color="#000080">:=</font>round<font color="#000080">(</font>part<font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font>oldx<font color="#000080">&lt;&gt;</font><font color="#800000">999 </font><font color="#FF0000"><b>then </b></font>line<font color="#000080">(</font>oldx<font color="#000080">,</font>oldy<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">);
         </font>oldx<font color="#000080">:=</font>x<font color="#000080">;
         </font>oldy<font color="#000080">:=</font>y<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;




 </font><font color="#008000"><i>(* -----------------------------------------------------------------*)
                { Spline under tension}
{  Original Author -- Copyright(c)1985 James R .Van Zandt
   Converted to Turbo Pascal, simplified, altered
    - Ron Nossaman June 1996 nossaman@southwind.net
   Based on algorithms by A. K. Cline      }

</i></font><font color="#FF0000"><b>procedure </b></font>curv1<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">:</font>data<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>y<font color="#000080">:</font>data<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>p<font color="#000080">:</font>data<font color="#000080">; </font>n<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>Integer<font color="#000080">;
    </font>c1<font color="#000080">,</font>c2<font color="#000080">,</font>c3<font color="#000080">,</font>deln<font color="#000080">,</font>delnm1<font color="#000080">,</font>delnn<font color="#000080">,</font>dels<font color="#000080">,</font>delx1<font color="#000080">,</font>delx2<font color="#000080">,</font>delx12<font color="#000080">,
    </font>diag1<font color="#000080">,</font>diag2<font color="#000080">,</font>diagin<font color="#000080">,</font>dx1<font color="#000080">,</font>dx2<font color="#000080">,</font>exps<font color="#000080">,
    </font>sigmap<font color="#000080">,</font>sinhs<font color="#000080">,</font>sinhin<font color="#000080">,</font>slpp1<font color="#000080">,</font>slppn<font color="#000080">,</font>spdiag<font color="#000080">:</font>real<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>delx1<font color="#000080">:=</font>x<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]-</font>x<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];
   </font>dx1<font color="#000080">:=(</font>y<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]-</font>y<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])/</font>delx1<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>sigma<font color="#000080">&gt;=</font><font color="#800000">0.</font><font color="#FF0000"><b>then
   begin
      </b></font>slpp1<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font>slppn<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>end else
       begin
          if </b></font>n<font color="#000080">&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then
          begin
             </b></font>delx2<font color="#000080">:=</font>x<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]-</font>x<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
             </font>delx12<font color="#000080">:=</font>x<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]-</font>x<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];
             </font>c1<font color="#000080">:=-(</font>delx12<font color="#000080">+</font>delx1<font color="#000080">)/</font>delx12<font color="#000080">/</font>delx1<font color="#000080">;
             </font>c2<font color="#000080">:=</font>delx12<font color="#000080">/</font>delx1<font color="#000080">/</font>delx2<font color="#000080">;
             </font>c3<font color="#000080">:=-</font>delx1<font color="#000080">/</font>delx12<font color="#000080">/</font>delx2<font color="#000080">;
             </font>slpp1<font color="#000080">:=</font>c1<font color="#000080">* </font>y<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]+</font>c2<font color="#000080">* </font>y<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font>c3<font color="#000080">* </font>y<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
             </font>deln<font color="#000080">:=</font>x<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]-</font>x<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">];
             </font>delnm1<font color="#000080">:=</font>x<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">]-</font>x<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">];
             </font>delnn<font color="#000080">:=</font>x<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]-</font>x<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">];
             </font>c1<font color="#000080">:=(</font>delnn<font color="#000080">+</font>deln<font color="#000080">)/</font>delnn<font color="#000080">/</font>deln<font color="#000080">;
             </font>c2<font color="#000080">:=-</font>delnn<font color="#000080">/</font>deln<font color="#000080">/</font>delnm1<font color="#000080">;
             </font>c3<font color="#000080">:=</font>deln<font color="#000080">/</font>delnn<font color="#000080">/</font>delnm1<font color="#000080">;
             </font>slppn<font color="#000080">:=</font>c3<font color="#000080">* </font>y<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">]+</font>c2<font color="#000080">* </font>y<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">]+</font>c1<font color="#000080">* </font>y<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">];
          </font><font color="#FF0000"><b>end else
             begin
                </b></font>p<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">0.</font><font color="#000080">;
                </font>p<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">0.</font><font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#008000"><i>(* denormalize tension factor *)
   </i></font>sigmap<font color="#000080">:=</font>abs<font color="#000080">(</font>sigma<font color="#000080">)*(</font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)/(</font>x<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]-</font>x<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
   </font><font color="#008000"><i>(* set up right hand side and tridiagonal system for
         yp and perform forward elimination *)
   </i></font>dels<font color="#000080">:=</font>sigmap<font color="#000080">* </font>delx1<font color="#000080">;
   </font>exps<font color="#000080">:=</font>exp<font color="#000080">(</font>dels<font color="#000080">);
   </font>sinhs<font color="#000080">:=</font><font color="#800000">0.5</font><font color="#000080">*(</font>exps<font color="#000080">-</font><font color="#800000">1.</font><font color="#000080">/</font>exps<font color="#000080">);
   </font>sinhin<font color="#000080">:=</font><font color="#800000">1.</font><font color="#000080">/(</font>delx1<font color="#000080">* </font>sinhs<font color="#000080">);
   </font>diag1<font color="#000080">:=</font>sinhin<font color="#000080">*(</font>dels<font color="#000080">* </font><font color="#800000">0.5</font><font color="#000080">*(</font>exps<font color="#000080">+</font><font color="#800000">1.</font><font color="#000080">/</font>exps<font color="#000080">)-</font>sinhs<font color="#000080">);
   </font>diagin<font color="#000080">:=</font><font color="#800000">1.</font><font color="#000080">/</font>diag1<font color="#000080">;
   </font>p<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>diagin<font color="#000080">*(</font>dx1<font color="#000080">-</font>slpp1<font color="#000080">);
   </font>spdiag<font color="#000080">:=</font>sinhin<font color="#000080">*(</font>sinhs<font color="#000080">-</font>dels<font color="#000080">);
   </font>temp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>diagin<font color="#000080">* </font>spdiag<font color="#000080">;
   </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>n <font color="#000080">&lt;&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
   begin
      for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>do
      begin
         </b></font>delx2<font color="#000080">:=</font>x<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>x<font color="#000080">[</font>i<font color="#000080">];
         </font>dx2<font color="#000080">:=(</font>y<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>y<font color="#000080">[</font>i<font color="#000080">])/</font>delx2<font color="#000080">;
         </font>dels<font color="#000080">:=</font>sigmap<font color="#000080">*</font>delx2<font color="#000080">;
         </font>exps<font color="#000080">:=</font>exp<font color="#000080">(</font>dels<font color="#000080">);
         </font>sinhs<font color="#000080">:=</font><font color="#800000">0.5</font><font color="#000080">*(</font>exps<font color="#000080">-</font><font color="#800000">1.</font><font color="#000080">/</font>exps<font color="#000080">);
         </font>sinhin<font color="#000080">:=</font><font color="#800000">1.</font><font color="#000080">/(</font>delx2<font color="#000080">*</font>sinhs<font color="#000080">);
         </font>diag2<font color="#000080">:=</font>sinhin<font color="#000080">*(</font>dels<font color="#000080">*(</font><font color="#800000">0.5</font><font color="#000080">*(</font>exps<font color="#000080">+</font><font color="#800000">1.</font><font color="#000080">/</font>exps<font color="#000080">))-</font>sinhs<font color="#000080">);
         </font>diagin<font color="#000080">:=</font><font color="#800000">1.</font><font color="#000080">/(</font>diag1<font color="#000080">+</font>diag2<font color="#000080">-</font>spdiag<font color="#000080">*</font>temp<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]);
         </font>p<font color="#000080">[</font>i<font color="#000080">]:=</font>diagin<font color="#000080">*(</font>dx2<font color="#000080">-</font>dx1<font color="#000080">-</font>spdiag<font color="#000080">*</font>p<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]);
         </font>spdiag<font color="#000080">:=</font>sinhin<font color="#000080">*(</font>sinhs<font color="#000080">-</font>dels<font color="#000080">);
         </font>temp<font color="#000080">[</font>i<font color="#000080">]:=</font>diagin<font color="#000080">*</font>spdiag<font color="#000080">;
         </font>dx1<font color="#000080">:=</font>dx2<font color="#000080">;
         </font>diag1<font color="#000080">:=</font>diag2<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>diagin<font color="#000080">:=</font><font color="#800000">1.</font><font color="#000080">/(</font>diag1<font color="#000080">-</font>spdiag<font color="#000080">*</font>temp<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">]);
   </font>p<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]:=</font>diagin<font color="#000080">*(</font>slppn<font color="#000080">-</font>dx2<font color="#000080">-</font>spdiag<font color="#000080">*</font>p<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">]);
              </font><font color="#008000"><i>(* perform back substitution *)
   </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>n<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do </b></font>p<font color="#000080">[</font>i<font color="#000080">]:=</font>p<font color="#000080">[</font>i<font color="#000080">]-(</font>temp<font color="#000080">[</font>i<font color="#000080">]*</font>p<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>function </b></font>curv2<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">:</font>data<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>y<font color="#000080">:</font>data<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>p<font color="#000080">:</font>data<font color="#000080">; </font>t<font color="#000080">:</font>real<font color="#000080">; </font>n<font color="#000080">:</font>integer<font color="#000080">):</font>real<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>i1<font color="#000080">:</font>integer<font color="#000080">;
    </font>del1<font color="#000080">,</font>del2<font color="#000080">,</font>dels<font color="#000080">,</font>exps<font color="#000080">,</font>exps1<font color="#000080">,</font>s<font color="#000080">,</font>sigmap<font color="#000080">,</font>sinhd1<font color="#000080">,</font>sinhd2<font color="#000080">,</font>sinhs<font color="#000080">:</font>real<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>i1<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>s<font color="#000080">:=</font>x<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]-</font>x<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];
   </font>sigmap<font color="#000080">:=</font>abs<font color="#000080">(</font>sigma<font color="#000080">)*(</font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)/</font>s<font color="#000080">;
   </font>i<font color="#000080">:=</font>i1<font color="#000080">;
   </font><font color="#FF0000"><b>while</b></font><font color="#000080">(</font>i<font color="#000080">&lt;</font>n<font color="#000080">) </font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>t<font color="#000080">&gt;= </font>x<font color="#000080">[</font>i<font color="#000080">])</font><font color="#FF0000"><b>do </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
   </font><font color="#FF0000"><b>while</b></font><font color="#000080">(</font>i<font color="#000080">&gt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>x<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]&gt;</font>t<font color="#000080">)</font><font color="#FF0000"><b>do </b></font>dec<font color="#000080">(</font>i<font color="#000080">);
   </font>i1<font color="#000080">:=</font>i<font color="#000080">;
   </font>del1<font color="#000080">:=</font>t<font color="#000080">-</font>x<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">];
   </font>del2<font color="#000080">:=</font>x<font color="#000080">[</font>i<font color="#000080">]-</font>t<font color="#000080">;
   </font>dels<font color="#000080">:=</font>x<font color="#000080">[</font>i<font color="#000080">]-</font>x<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">];
   </font>exps1<font color="#000080">:=</font>exp<font color="#000080">(</font>sigmap<font color="#000080">*</font>del1<font color="#000080">); </font>sinhd1<font color="#000080">:=</font><font color="#800000">0.5</font><font color="#000080">*(</font>exps1<font color="#000080">-</font><font color="#800000">1.</font><font color="#000080">/</font>exps1<font color="#000080">);
   </font>exps<font color="#000080">:=</font>exp<font color="#000080">(</font>sigmap<font color="#000080">*</font>del2<font color="#000080">); </font>sinhd2<font color="#000080">:=</font><font color="#800000">0.5</font><font color="#000080">*(</font>exps<font color="#000080">-</font><font color="#800000">1.</font><font color="#000080">/</font>exps<font color="#000080">);
   </font>exps<font color="#000080">:=</font>exps1<font color="#000080">*</font>exps<font color="#000080">; </font>sinhs<font color="#000080">:=</font><font color="#800000">0.5</font><font color="#000080">*(</font>exps<font color="#000080">-</font><font color="#800000">1.</font><font color="#000080">/</font>exps<font color="#000080">);
   </font>curv2<font color="#000080">:=((</font>p<font color="#000080">[</font>i<font color="#000080">]*</font>sinhd1<font color="#000080">+</font>p<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]*</font>sinhd2<font color="#000080">)/</font>sinhs<font color="#000080">+
        ((</font>y<font color="#000080">[</font>i<font color="#000080">]-</font>p<font color="#000080">[</font>i<font color="#000080">])*</font>del1<font color="#000080">+(</font>y<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]-</font>p<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">])*</font>del2<font color="#000080">)/</font>dels<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>curv0<font color="#000080">(</font>n<font color="#000080">,</font>requested<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var  </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>each<font color="#000080">,</font>stop<font color="#000080">,</font>seg<font color="#000080">,</font>regressing<font color="#000080">:</font>integer<font color="#000080">;
     </font>s<font color="#000080">,</font>ds<font color="#000080">,</font>xx<font color="#000080">,</font>yy<font color="#000080">,</font>oldx<font color="#000080">,</font>oldy<font color="#000080">:</font>real<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>oldx<font color="#000080">:=</font><font color="#800000">999</font><font color="#000080">;
   </font>curv1<font color="#000080">(</font>path<font color="#000080">,</font>xc<font color="#000080">,</font>xp<font color="#000080">,</font>n<font color="#000080">);
   </font>curv1<font color="#000080">(</font>path<font color="#000080">,</font>yc<font color="#000080">,</font>yp<font color="#000080">,</font>n<font color="#000080">);
   </font>s<font color="#000080">:=</font>path<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];
   </font>seg<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>n<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>do
   begin
      </b></font>stop<font color="#000080">:=</font><font color="#800000">100</font><font color="#000080">;
      </font>ds<font color="#000080">:=(</font>path<font color="#000080">[</font>j<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]-</font>path<font color="#000080">[</font>j<font color="#000080">])/</font>stop<font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>stop<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
      begin
         </b></font>xx<font color="#000080">:=</font>round<font color="#000080">(</font>curv2<font color="#000080">(</font>path<font color="#000080">,</font>xc<font color="#000080">,</font>xp<font color="#000080">,</font>s<font color="#000080">,</font>n<font color="#000080">));
         </font>yy<font color="#000080">:=</font>round<font color="#000080">(</font>curv2<font color="#000080">(</font>path<font color="#000080">,</font>yc<font color="#000080">,</font>yp<font color="#000080">,</font>s<font color="#000080">,</font>n<font color="#000080">));
         </font><font color="#FF0000"><b>if </b></font>oldx<font color="#000080">&lt;&gt;</font><font color="#800000">999 </font><font color="#FF0000"><b>then
           </b></font>line<font color="#000080">(</font>round<font color="#000080">(</font>oldx<font color="#000080">),</font>round<font color="#000080">(</font>oldy<font color="#000080">),</font>round<font color="#000080">(</font>xx<font color="#000080">),</font>round<font color="#000080">(</font>yy<font color="#000080">));
         </font>oldx<font color="#000080">:=</font>xx<font color="#000080">; </font>oldy<font color="#000080">:=</font>yy<font color="#000080">;
         </font>s<font color="#000080">:=</font>s<font color="#000080">+</font>ds<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>xx<font color="#000080">:=</font>xc<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">];
   </font>yy<font color="#000080">:=</font>yc<font color="#000080">[</font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">];
   </font>line<font color="#000080">(</font>round<font color="#000080">(</font>oldx<font color="#000080">),</font>round<font color="#000080">(</font>oldy<font color="#000080">),</font>round<font color="#000080">(</font>xx<font color="#000080">),</font>round<font color="#000080">(</font>yy<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>tspline<font color="#000080">(</font>color<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#008000"><i>{  Fits a smooth curve through a given set of points, using the splines
   under tension introduced by J. Schweikert. They are similar to cubic
   splines,but are less likely to introduce spurious inflection points.

   Original Author -- Copyright(c)1985James R .Van Zandt
   Converted to Turbo Pascal, butchered, simplified, altered --
         Ron Nossaman June 1996 nossaman@southwind.net
   Based on algorithms by A. K. Cline      }
</i></font><font color="#FF0000"><b>var </b></font>nn<font color="#000080">,</font>origin<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>sum<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>path<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>maxnodes <font color="#FF0000"><b>do
   begin
      </b></font>xx<font color="#000080">:=</font>xc<font color="#000080">[</font>i<font color="#000080">]-</font>xc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">];
      </font>yy<font color="#000080">:=</font>yc<font color="#000080">[</font>i<font color="#000080">]-</font>yc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">];
      </font>sum<font color="#000080">:=</font>sum<font color="#000080">+</font>sqrt<font color="#000080">((</font>xx<font color="#000080">*</font>xx<font color="#000080">)+(</font>yy<font color="#000080">*</font>yy<font color="#000080">));
      </font>path<font color="#000080">[</font>i<font color="#000080">]:=</font>sum<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>alternate <font color="#FF0000"><b>then </b></font>path<font color="#000080">[</font>i<font color="#000080">]:=</font>i<font color="#000080">; </font><font color="#008000"><i>{my addition, another alternative }
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>setcolor<font color="#000080">(</font>color<font color="#000080">);   </font><font color="#008000"><i>{display color for spline curve}
   </i></font>curv0<font color="#000080">(</font>maxnodes<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">100</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>loadarrays<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>setcolor<font color="#000080">(</font>red<font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>maxnodes <font color="#FF0000"><b>do
   begin
      </b></font>xc<font color="#000080">[</font>i<font color="#000080">]:=</font>random<font color="#000080">(</font><font color="#800000">540</font><font color="#000080">)+</font><font color="#800000">50</font><font color="#000080">;   </font><font color="#008000"><i>{try to keep it on the screen for demo}
      </i></font>yc<font color="#000080">[</font>i<font color="#000080">]:=</font>random<font color="#000080">(</font><font color="#800000">380</font><font color="#000080">)+</font><font color="#800000">50</font><font color="#000080">;
</font><font color="#008000"><i>{show the path, if you want}
      </i></font><font color="#FF0000"><b>if </b></font>i<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>line<font color="#000080">(</font>round<font color="#000080">(</font>xc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]),</font>round<font color="#000080">(</font>yc<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]),</font>round<font color="#000080">(</font>xc<font color="#000080">[</font>i<font color="#000080">]),</font>round<font color="#000080">(</font>yc<font color="#000080">[</font>i<font color="#000080">]));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>setcolor<font color="#000080">(</font>white<font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>maxnodes <font color="#FF0000"><b>do </b></font>circle<font color="#000080">(</font>round<font color="#000080">(</font>xc<font color="#000080">[</font>i<font color="#000080">]),</font>round<font color="#000080">(</font>yc<font color="#000080">[</font>i<font color="#000080">]),</font><font color="#800000">3</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin
   </b></font>clrscr<font color="#000080">;
   </font>randomize<font color="#000080">;
   </font>ch<font color="#000080">:=</font><font color="#800000">#0</font><font color="#000080">;
   </font>GraphDriver<font color="#000080">:=</font>VGA<font color="#000080">;
   </font>Graphmode<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
   </font>InitGraph<font color="#000080">(</font>GraphDriver<font color="#000080">,</font>GraphMode<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
   </font>ErrorCode<font color="#000080">:=</font>GraphResult<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>ErrorCode<font color="#000080">&lt;&gt;</font>grOK <font color="#FF0000"><b>then </b></font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
   </font><font color="#FF0000"><b>repeat
      </b></font>setfillstyle<font color="#000080">(</font>solidfill<font color="#000080">,</font>black<font color="#000080">);
      </font>bar<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">639</font><font color="#000080">,</font><font color="#800000">479</font><font color="#000080">);
      </font>loadarrays<font color="#000080">;

    </font><font color="#008000"><i>{try whatever combinations strike you}
    {there are a lot of different ways to get there!}
      </i></font>alternate<font color="#000080">:=</font>false<font color="#000080">; </font>sigma<font color="#000080">:=-</font><font color="#800000">2</font><font color="#000080">; </font>tspline<font color="#000080">(</font>green<font color="#000080">);
      </font>alternate<font color="#000080">:=</font>false<font color="#000080">; </font>sigma<font color="#000080">:=</font><font color="#800000">0.01</font><font color="#000080">; </font>tspline<font color="#000080">(</font>cyan<font color="#000080">);
      </font>alternate<font color="#000080">:=</font>true<font color="#000080">; </font>sigma<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">; </font>tspline<font color="#000080">(</font>white<font color="#000080">);
      </font>spline1<font color="#000080">(</font>lightred<font color="#000080">);
      </font>spline2<font color="#000080">(</font>yellow<font color="#000080">);
      </font><font color="#FF0000"><b>repeat until </b></font>keypressed<font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font>keypressed <font color="#FF0000"><b>do </b></font>ch<font color="#000080">:=</font>readkey<font color="#000080">;
   </font><font color="#FF0000"><b>until </b></font>ch<font color="#000080">=</font><font color="#800000">#27</font><font color="#000080">;
   </font>closegraph<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0282.PAS">Original</a><b>]</b></p></body>
</html>
