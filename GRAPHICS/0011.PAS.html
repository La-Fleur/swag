<html>
<head><title> "Very Large Graphic Image" by WILBER VAN LEIJEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
WILBERT VAN LEIJEN

&gt; I am looking for a way to get an Image into a pointer (besides arrays)
&gt; and write it to my disk. I am using arrays right now, and works fine, but
&gt; When  I get big images I run out of mem fast...  :: IBUF : array [1..30000]
&gt; of byte; getimage(x1,y1,x2,y2,IBUF); repeat Write(f,IBUF[NUM]); num:=num+1;
&gt; until num=sizeof(ibuf);
&gt; This works as long as I dont try to grab a large image.

These &quot;large images&quot; are in fact stored in &quot;planes&quot;, chunks of up to 64 kByte
in size. You must understand the VGA architecture to store these in a file.
The only VGA video mode that keeps all data (from the programmer's point of
view) into a single data space is mode 13h (320x200 with 256 colours): a simple
array [1..200, 1..320] of Byte.  The other video modes require you to access
the VGA hardware: take for example 640x480 by 16 colours: 4 planes of 38,400
bytes (Red, Green, Blue and Intensity).  Together with the colour information
as returned by BIOS call INT 10h/AX=1012h they make up the picture.

Here's how you select a plane:
}

</i></font><font color="#FF0000"><b>Procedure </b></font>SwitchBitplane<font color="#000080">(</font>plane <font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;

</font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">MOV   DX, 3C4h
  MOV   AL, 2
  OUT   DX, AL
  INC   DX
  MOV   AL, plane
  OUT   DX, AL
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
Assume the video mode to be 12h (640x480/16 colours), BitplaneSize = 38400, and
Bitplane is an Array[0..3] of pointer to an array [1..38400] of Byte:
}
      </i></font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>Do
        Begin
          </b></font>SwitchBitplane<font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font>i<font color="#000080">);
          </font>Move<font color="#000080">(</font>Bitplane<font color="#000080">[</font>i<font color="#000080">]^, </font>Ptr<font color="#000080">(</font><font color="#800000">$A000</font><font color="#000080">, </font><font color="#800000">$0000</font><font color="#000080">)^, </font>BitplaneSize<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{
This is a snippet of code lifted from my VGAGRAB package; a TSR that dumps
graphic information (any standard VGA mode) to a disk file by pressing
&lt;PrtScr&gt;, plus a few demo programs written in TP - with source code.  Available
on FTP sites.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p></body>
</html>
