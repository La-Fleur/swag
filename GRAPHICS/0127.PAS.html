<html>
<head><title> "More STAR-ROUTINE" by BAS VAN GAALEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0127.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Howdy all!

By request here's the stars-routine, the final update. ;-)
Limits: cpu-speed and conv.-memory. No others...

}
</i></font><font color="#FF0000"><b>program </b></font>_stars<font color="#000080">;
</font><font color="#008000"><i>{ Done by Sven van Heel and Bas van Gaalen, Holland, PD }
</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>f<font color="#000080">=</font><font color="#800000">6</font><font color="#000080">; </font>nofstars<font color="#000080">=</font><font color="#800000">100</font><font color="#000080">; </font>vidseg<font color="#000080">:</font>word<font color="#000080">=</font><font color="#800000">$a000</font><font color="#000080">;
  </font>bitmask<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">=(
    ((</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)),
    ((</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)));
</font><font color="#FF0000"><b>type </b></font>starstruc<font color="#000080">=</font><font color="#FF0000"><b>record
  </b></font>xp<font color="#000080">,</font>yp<font color="#000080">:</font>word<font color="#000080">; </font>phase<font color="#000080">,</font>col<font color="#000080">:</font>byte<font color="#000080">; </font>dur<font color="#000080">:</font>shortint<font color="#000080">; </font>active<font color="#000080">:</font>boolean<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>stars<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>nofstars<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>starstruc<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setpal<font color="#000080">(</font>col<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b <font color="#000080">: </font>byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,03c8h; mov al,col; out dx,al; inc dx; mov al,r
  out dx,al; mov al,g; out dx,al; mov al,b; out dx,al; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>retrace<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,3dah; @vert1: in al,dx; test al,8; jz @vert1
  @vert2: in al,dx; test al,8; jnz @vert2; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm </b></font><font color="#FF00FF">mov ax,13h; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do begin
    </b></font>setpal<font color="#000080">(</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">21</font><font color="#000080">-</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">+</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font>setpal<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">+</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">51</font><font color="#000080">-</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">50</font><font color="#000080">+</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font>setpal<font color="#000080">(</font><font color="#800000">60</font><font color="#000080">+</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">81</font><font color="#000080">-</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">80</font><font color="#000080">+</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font>setpal<font color="#000080">(</font><font color="#800000">90</font><font color="#000080">+</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">111</font><font color="#000080">-</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">110</font><font color="#000080">+</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font>setpal<font color="#000080">(</font><font color="#800000">120</font><font color="#000080">+</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">141</font><font color="#000080">-</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">140</font><font color="#000080">+</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font>setpal<font color="#000080">(</font><font color="#800000">150</font><font color="#000080">+</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">171</font><font color="#000080">-</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">,</font>f<font color="#000080">*</font>i<font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">170</font><font color="#000080">+</font>i<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>randomize<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nofstars <font color="#FF0000"><b>do with </b></font>stars<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do begin
    </b></font>xp<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>yp<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>col<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>phase<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font>dur<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">);
    </font>active<font color="#000080">:=</font>false<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>retrace<font color="#000080">; </font>retrace<font color="#000080">;
    </font><font color="#008000"><i>{setpal(0,0,0,30);}
    </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nofstars <font color="#FF0000"><b>do with </b></font>stars<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do begin
      </b></font>dec<font color="#000080">(</font>dur<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>active<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>dur<font color="#000080">&lt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
        </b></font>active<font color="#000080">:=</font>true<font color="#000080">; </font>phase<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>col<font color="#000080">:=</font><font color="#800000">30</font><font color="#000080">*</font>random<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">);
        </font>xp<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">315</font><font color="#000080">); </font>yp<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">195</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>nofstars <font color="#FF0000"><b>do with </b></font>stars<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do
      if </b></font>active <font color="#FF0000"><b>then begin
        for </b></font>x<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do for </b></font>y<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
          if </b></font>bitmask<font color="#000080">[</font>byte<font color="#000080">(</font>phase<font color="#000080">&gt;</font><font color="#800000">10</font><font color="#000080">),</font>x<font color="#000080">,</font>y<font color="#000080">]&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
            </b></font>mem<font color="#000080">[</font>vidseg<font color="#000080">:(</font>yp<font color="#000080">+</font>y<font color="#000080">)*</font><font color="#800000">320</font><font color="#000080">+</font>xp<font color="#000080">+</font>x<font color="#000080">]:=</font>bitmask<font color="#000080">[</font>byte<font color="#000080">(</font>phase<font color="#000080">&gt;</font><font color="#800000">10</font><font color="#000080">),</font>x<font color="#000080">,</font>y<font color="#000080">]+</font>col<font color="#000080">+</font>phase<font color="#000080">;
        </font>inc<font color="#000080">(</font>phase<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>phase<font color="#000080">=</font><font color="#800000">20 </font><font color="#FF0000"><b>then begin </b></font>active<font color="#000080">:=</font>false<font color="#000080">; </font>dur<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>setpal<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
  </font>textmode<font color="#000080">(</font>lastmode<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0127.PAS">Original</a><b>]</b></p></body>
</html>
