<html>
<head><title> "VGA 13h-mode unit for fast graphics" by HARDBREAKER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0289.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$A+,B-,D-,E+,F+,G+,I-,L-,N+,P-,Q-,R-,S-,T-,V-,X+,Y-}
{*-----------------------------------------------*}
{|                                               |}
{|  &lt;&lt;&lt; VGA 13h-mode unit for fast graphics &gt;&gt;&gt;  |}
{|         Written on Borland Pascal 7.0         |}
{|     and supports real and protected modes.    |}
{|    Version 1.11 p, last update : 20-Dec-97    |}
{|       Coded by HardBreaker [FleXoft Co.]      |}
{|    alexic@ropnet.ru; 9135@multi-page.cea.ru   |}
{|      Alexic@hotmail.com, #pascal-IRC-EFNet    |}
{|  Special thanks to : Zyklon, [bios], my wife  |}
{|                                               |}
{*-----------------------------------------------*}

</i></font><font color="#FF0000"><b>Unit </b></font>Graphics<font color="#000080">;
</font><font color="#FF0000"><b>Interface
Type
  </b></font><font color="#008000"><i>{ VGA color record }
  </i></font>TColor    <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>R<font color="#000080">, </font>G<font color="#000080">, </font>B <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ VGA palette structures }
  </i></font>PVGAPalette  <font color="#000080">= ^</font>TVGAPalette<font color="#000080">;
  </font>TVGAPalette  <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>TColor<font color="#000080">;

  </font><font color="#008000"><i>{ Sprite structures }
  </i></font>PSprite <font color="#000080">= ^</font>TSprite<font color="#000080">;
  </font>TSprite <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>a<font color="#000080">, </font>b <font color="#000080">: </font>word<font color="#000080">;
    </font>data <font color="#000080">: </font>pointer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font><font color="#008000"><i>{ Unit version label }
  </i></font>Version        <font color="#000080">= </font><font color="#800000">'1.11 p'</font><font color="#000080">;

  </font><font color="#008000"><i>{ Error codes }
  </i></font>VGA_Ok          <font color="#000080">=   </font><font color="#800000">0</font><font color="#000080">;
  </font>VGA_NoMemory    <font color="#000080">=  -</font><font color="#800000">1</font><font color="#000080">;
  </font>VGA_IOError     <font color="#000080">=  -</font><font color="#800000">2</font><font color="#000080">;
  </font>VGA_NoFile      <font color="#000080">=  -</font><font color="#800000">3</font><font color="#000080">;
  </font>VGA_BadVersion  <font color="#000080">=  -</font><font color="#800000">4</font><font color="#000080">;
  </font>VGA_BadFormat   <font color="#000080">=  -</font><font color="#800000">5</font><font color="#000080">;

  </font><font color="#008000"><i>{ Workplace area }
  </i></font>MinX           <font color="#000080">=   </font><font color="#800000">0</font><font color="#000080">;
  </font>MaxX           <font color="#000080">= </font><font color="#800000">319</font><font color="#000080">;
  </font>MinY           <font color="#000080">=   </font><font color="#800000">0</font><font color="#000080">;
  </font>MaxY           <font color="#000080">= </font><font color="#800000">199</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font><font color="#008000"><i>{ Pointer to double buffer     }
  { aka virtual or shadow screen }
  </i></font>DBuffer   <font color="#000080">: </font>pointer<font color="#000080">;

  </font><font color="#008000"><i>{ Pointer to VGA videobuffer   }
  </i></font>VBuffer   <font color="#000080">: </font>pointer<font color="#000080">;

  </font><font color="#008000"><i>{$L vb30.obj}                          { include 32-bit grapics procedures }
                                         { see asm source at the end of file }
{ -------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Function  </b></font>GetVideoMode<font color="#000080">:</font>byte<font color="#000080">;                    </font><font color="#008000"><i>{ get current video mode     }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetVideoMode<font color="#000080">(</font>n<font color="#000080">:</font>byte<font color="#000080">);                 </font><font color="#008000"><i>{ set video mode             }
</i></font><font color="#FF0000"><b>Procedure </b></font>InitGraphMode<font color="#000080">;                        </font><font color="#008000"><i>{ init 13h graph mode        }
</i></font><font color="#FF0000"><b>Procedure </b></font>DoneGraphMode<font color="#000080">;                        </font><font color="#008000"><i>{ restore old mode           }
</i></font><font color="#FF0000"><b>Function  </b></font>InitDoubleBuffer<font color="#000080">:</font>integer<font color="#000080">;             </font><font color="#008000"><i>{ allocate double buffer     }
</i></font><font color="#FF0000"><b>Procedure </b></font>DoneDoubleBuffer<font color="#000080">;                     </font><font color="#008000"><i>{ deallocate double buffer   }
</i></font><font color="#FF0000"><b>Procedure </b></font>ShowBuffer32<font color="#000080">;                         </font><font color="#008000"><i>{ copy d-buffer to screen    }
</i></font><font color="#FF0000"><b>Procedure </b></font>ClearDBuffer32<font color="#000080">;                       </font><font color="#008000"><i>{ clear d-buffer fast        }
</i></font><font color="#FF0000"><b>Procedure </b></font>ClearVBuffer32<font color="#000080">;                       </font><font color="#008000"><i>{ clear screen buffer fast   }
</i></font><font color="#FF0000"><b>Procedure </b></font>Retrace<font color="#000080">;                              </font><font color="#008000"><i>{ wait for back trace        }
{ -------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetPoint<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;</font>c<font color="#000080">:</font>byte<font color="#000080">);         </font><font color="#008000"><i>{ fast point to d-buffer     }
</i></font><font color="#FF0000"><b>Function  </b></font>GetPoint<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">):</font>byte<font color="#000080">;           </font><font color="#008000"><i>{ get point from d-buffer    }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetScreenPoint<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;</font>c<font color="#000080">:</font>byte<font color="#000080">);   </font><font color="#008000"><i>{ fast point direct to screen}
</i></font><font color="#FF0000"><b>Function  </b></font>GetScreenPoint<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">):</font>byte<font color="#000080">;     </font><font color="#008000"><i>{ get point from screen      }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetVLine<font color="#000080">(</font>x<font color="#000080">,</font>y1<font color="#000080">,</font>y2<font color="#000080">:</font>integer<font color="#000080">;</font>c<font color="#000080">:</font>byte<font color="#000080">);     </font><font color="#008000"><i>{ fast vertical line (db)    }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetHLine<font color="#000080">(</font>x1<font color="#000080">,</font>x2<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;</font>c<font color="#000080">:</font>byte<font color="#000080">);     </font><font color="#008000"><i>{ fast horizontal line (db)  }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetLine<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">:</font>integer<font color="#000080">;</font>c<font color="#000080">:</font>byte<font color="#000080">);  </font><font color="#008000"><i>{ set line (not so fast)     }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetBox<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">:</font>integer<font color="#000080">;</font>c<font color="#000080">:</font>byte<font color="#000080">);   </font><font color="#008000"><i>{ draw box                   }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetRect<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">:</font>integer<font color="#000080">;</font>c<font color="#000080">:</font>byte<font color="#000080">);  </font><font color="#008000"><i>{ draw rectangle             }
{ -------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetPaletteColor<font color="#000080">(</font>c<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">);        </font><font color="#008000"><i>{ set palette color          }
</i></font><font color="#FF0000"><b>Procedure </b></font>GetPaletteColor<font color="#000080">(</font>c<font color="#000080">:</font>byte<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">); </font><font color="#008000"><i>{ get palette color        }
</i></font><font color="#FF0000"><b>Function  </b></font>ColorInPal<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:</font>byte<font color="#000080">;</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">;</font>p<font color="#000080">:</font>pointer<font color="#000080">):</font>boolean<font color="#000080">; </font><font color="#008000"><i>{ check color }
</i></font><font color="#FF0000"><b>Function  </b></font>FindColor<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:</font>byte<font color="#000080">;</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">;</font>p<font color="#000080">:</font>pointer<font color="#000080">):</font>integer<font color="#000080">;  </font><font color="#008000"><i>{ find color  }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetAllPalette<font color="#000080">(</font>p<font color="#000080">: </font>pointer<font color="#000080">);            </font><font color="#008000"><i>{ set all vga palette        }
</i></font><font color="#FF0000"><b>Procedure </b></font>GetAllPalette<font color="#000080">(</font>p<font color="#000080">: </font>pointer<font color="#000080">);            </font><font color="#008000"><i>{ get all vga palette        }
</i></font><font color="#FF0000"><b>Procedure </b></font>FadeIn<font color="#000080">(</font>n<font color="#000080">:</font>word<font color="#000080">;</font>p<font color="#000080">:</font>pointer<font color="#000080">);             </font><font color="#008000"><i>{ fading palette in          }
</i></font><font color="#FF0000"><b>Procedure </b></font>FadeOut<font color="#000080">(</font>n<font color="#000080">:</font>word<font color="#000080">);                      </font><font color="#008000"><i>{ fading palette out         }
{ -------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Procedure </b></font>BitBLT_Opaque<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font>sprite<font color="#000080">:</font>TSprite<font color="#000080">);       </font><font color="#008000"><i>{ bit blitting   }
</i></font><font color="#FF0000"><b>Procedure </b></font>BitBLT_Transparent<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font>sprite<font color="#000080">:</font>TSprite<font color="#000080">);  </font><font color="#008000"><i>{ bit blitting   }
</i></font><font color="#FF0000"><b>Procedure </b></font>BitBLT_OpaqueT<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font>sprite<font color="#000080">:</font>TSprite<font color="#000080">);      </font><font color="#008000"><i>{ bit blitting   }
</i></font><font color="#FF0000"><b>Procedure </b></font>BitBLT_TransparentT<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font>sprite<font color="#000080">:</font>TSprite<font color="#000080">); </font><font color="#008000"><i>{ bit blitting   }
</i></font><font color="#FF0000"><b>Procedure </b></font>Zoom_OpaqueT<font color="#000080">(</font>zx<font color="#000080">,</font>zy<font color="#000080">,</font>za<font color="#000080">,</font>zb<font color="#000080">:</font>integer<font color="#000080">; </font>sprite<font color="#000080">:</font>TSprite<font color="#000080">); </font><font color="#008000"><i>{ zoom opaque   }
</i></font><font color="#FF0000"><b>Procedure </b></font>Zoom_TransparentT<font color="#000080">(</font>zx<font color="#000080">,</font>zy<font color="#000080">,</font>za<font color="#000080">,</font>zb<font color="#000080">:</font>integer<font color="#000080">; </font>sprite<font color="#000080">:</font>TSprite<font color="#000080">); </font><font color="#008000"><i>{ zoom tr. }
</i></font><font color="#FF0000"><b>Procedure </b></font>GetImage<font color="#000080">(</font>zx<font color="#000080">,</font>zy<font color="#000080">:</font>integer<font color="#000080">; </font>sprite<font color="#000080">:</font>TSprite<font color="#000080">); </font><font color="#008000"><i>{                         }
{ -------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Function  </b></font>InitSysFont<font color="#000080">(</font>cb<font color="#000080">,</font>cf<font color="#000080">:</font>byte<font color="#000080">):</font>integer<font color="#000080">;      </font><font color="#008000"><i>{ load BIOS 1st 128 chars    }
</i></font><font color="#FF0000"><b>Procedure </b></font>DoneSysFont<font color="#000080">;                          </font><font color="#008000"><i>{ unload system font         }
</i></font><font color="#FF0000"><b>Procedure </b></font>TextOut<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font>st<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);      </font><font color="#008000"><i>{ write to screen/d-buffer   }
{ -------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Function  </b></font>GetVGAErrorMsg<font color="#000080">(</font>n<font color="#000080">:</font>integer<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;     </font><font color="#008000"><i>{ get error msg by errnum    }
{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Implementation
Uses
  </b></font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>PFontBuffer <font color="#000080">= ^</font>TFontBuffer<font color="#000080">;
  </font>TFontBuffer <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">8191</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>sysfont  <font color="#000080">: </font>PFontBuffer<font color="#000080">;

</font><font color="#008000"><i>{ --------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Function </b></font>GetVideoMode<font color="#000080">;
</font><font color="#008000"><i>{    Job : return current videomode via bios call                       }
{  Input : none                                                         }
{ Output : videomode ( byte )                                           }
</i></font><font color="#FF0000"><b>begin</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov ah, $0F
    int $10
    mov @result, al
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetVideoMode<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : set video mode via bios call                                 }
{  Input : videomode number ( byte )                                    }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">xor ah, ah
  mov al, n
  int $10
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>InitGraphMode<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : initiate 13h mode ( 320x200x256 )                            }
{  Input : none                                                         }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax,$0013
  int $10
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DoneGraphMode<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : reset to 03h text mode ( 80x25 )                             }
{  Input : none                                                         }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax, $0003
  int $10
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>InitDoubleBuffer<font color="#000080">;
</font><font color="#008000"><i>{    Job : allocate double buffer 64000 bytes in heap                   }
{  Input : none                                                         }
{ Output : operation error code (integer), 0 if no errors               }
</i></font><font color="#FF0000"><b>begin
  if </b></font>dbuffer <font color="#000080">= </font>vbuffer <font color="#FF0000"><b>then begin
    if </b></font>MaxAvail <font color="#000080">&lt; </font><font color="#800000">64000 </font><font color="#FF0000"><b>then begin
      </b></font>InitDoubleBuffer<font color="#000080">:=</font>VGA_NoMemory<font color="#000080">; </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>getmem<font color="#000080">(</font>dbuffer<font color="#000080">,</font><font color="#800000">64000</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>InitDoubleBuffer<font color="#000080">:=</font>VGA_Ok<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DoneDoubleBuffer<font color="#000080">;
</font><font color="#008000"><i>{    Job : deallocate double buffer                                     }
{  Input : none                                                         }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>begin
  if </b></font>dbuffer <font color="#000080">&lt;&gt; </font>vbuffer <font color="#FF0000"><b>then begin
    </b></font>freemem<font color="#000080">(</font>dbuffer<font color="#000080">,</font><font color="#800000">64000</font><font color="#000080">);
    </font>dbuffer<font color="#000080">:=</font>vbuffer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ShowBuffer32<font color="#000080">;   </font><font color="#FF0000"><b>external</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : fast copy double buffer to VGA screen memory                 }
{  Input : none                                                         }
{ Output : none                                                         }

</i></font><font color="#FF0000"><b>Procedure </b></font>ClearDBuffer32<font color="#000080">; </font><font color="#FF0000"><b>external</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : fast cleaning double buffer                                  }
{  Input : none                                                         }
{ Output : none                                                         }

</i></font><font color="#FF0000"><b>Procedure </b></font>ClearVBuffer32<font color="#000080">; </font><font color="#FF0000"><b>external</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : fast cleaning VGA screen memory                              }
{  Input : none                                                         }
{ Output : none                                                         }

</i></font><font color="#FF0000"><b>Procedure </b></font>Retrace<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : wait for begin retracing CRT                                 }
{  Input : none                                                         }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,$3da
 @wait1:
  in al,dx
  and al,8
  jnz @wait1
 @wait2:
  in al,dx
  and al,8
  jz @wait2
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ --------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Procedure </b></font>SetPoint<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : set fast point on screen/double buffer ( with clipping )     }
{  Input : x, y - coordinates; c - color index                          }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax, y              </font><font color="#008000"><i>{ load y to ax }
  </i></font><font color="#FF00FF">cmp ax, MinY
  jl @fin
  cmp ax, MaxY
  jg @fin
  mov cx, x              </font><font color="#008000"><i>{ load x to cx }
  </i></font><font color="#FF00FF">cmp cx, MinX
  jl @fin
  cmp cx, MaxX
  jg @fin
  les di, dbuffer        </font><font color="#008000"><i>{ loading d-buffer starting address }
  </i></font><font color="#FF00FF">mov bx, ax             </font><font color="#008000"><i>{ copy y to bx }
  </i></font><font color="#FF00FF">sal ax, 6              </font><font color="#008000"><i>{ shift equal mult on 32 }
  </i></font><font color="#FF00FF">sal bx, 8              </font><font color="#008000"><i>{ shift equal mult on 256 }
  </i></font><font color="#FF00FF">add ax, bx             </font><font color="#008000"><i>{ equal mult on 320 (with shifts) }
  </i></font><font color="#FF00FF">add ax, cx             </font><font color="#008000"><i>{ starting point solved }
  </i></font><font color="#FF00FF">add di, ax             </font><font color="#008000"><i>{ starting point in es:di now }
  </i></font><font color="#FF00FF">mov bh, c              </font><font color="#008000"><i>{ load color into bh }
  </i></font><font color="#FF00FF">mov es:[di], bh        </font><font color="#008000"><i>{ moving color into d-buffer }
 </i></font><font color="#FF00FF">@fin:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>GetPoint<font color="#000080">;
</font><font color="#008000"><i>{    Job : get point from screen/double buffer ( with clipping )        }
{  Input : x, y - coordinates                                           }
{ Output : color index                                                  }
</i></font><font color="#FF0000"><b>begin</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov ax, y              </font><font color="#008000"><i>{ load y to ax }
    </i></font><font color="#FF00FF">cmp ax, MinY
    jl @fin
    cmp ax, MaxY
    jg @fin
    mov cx, x              </font><font color="#008000"><i>{ load x to cx }
    </i></font><font color="#FF00FF">cmp cx, MinX
    jl @fin
    cmp cx, MaxX
    jg @fin
    les di, dbuffer        </font><font color="#008000"><i>{ loading d-buffer starting address }
    </i></font><font color="#FF00FF">mov bx, ax             </font><font color="#008000"><i>{ copy y to bx }
    </i></font><font color="#FF00FF">sal ax, 6              </font><font color="#008000"><i>{ shift equal mult on 32 }
    </i></font><font color="#FF00FF">sal bx, 8              </font><font color="#008000"><i>{ shift equal mult on 256 }
    </i></font><font color="#FF00FF">add ax, bx             </font><font color="#008000"><i>{ equal mult on 320 (with shifts) }
    </i></font><font color="#FF00FF">add ax, cx             </font><font color="#008000"><i>{ starting point solved }
    </i></font><font color="#FF00FF">add di, ax             </font><font color="#008000"><i>{ starting point in es:di now }
    </i></font><font color="#FF00FF">mov bh, es:[di]
    mov @result, bh
    jmp @ok
   @fin:
    mov @result, 0
   @ok:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetScreenPoint<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : set point direct to screen ( with clipping )                 }
{  Input : x, y - coordinates; c - color index                          }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax, y              </font><font color="#008000"><i>{ load y to ax }
  </i></font><font color="#FF00FF">cmp ax, MinY
  jl @fin
  cmp ax, MaxY
  jg @fin
  mov cx, x              </font><font color="#008000"><i>{ load x to cx }
  </i></font><font color="#FF00FF">cmp cx, MinX
  jl @fin
  cmp cx, MaxX
  jg @fin
  les di, vbuffer        </font><font color="#008000"><i>{ loading screen buffer starting address }
  </i></font><font color="#FF00FF">mov bx, ax             </font><font color="#008000"><i>{ copy y to bx }
  </i></font><font color="#FF00FF">sal ax, 6              </font><font color="#008000"><i>{ shift equal mult on 32 }
  </i></font><font color="#FF00FF">sal bx, 8              </font><font color="#008000"><i>{ shift equal mult on 256 }
  </i></font><font color="#FF00FF">add ax, bx             </font><font color="#008000"><i>{ equal mult on 320 (with shifts) }
  </i></font><font color="#FF00FF">add ax, cx             </font><font color="#008000"><i>{ starting point solved }
  </i></font><font color="#FF00FF">add di, ax             </font><font color="#008000"><i>{ starting point in es:di now }
  </i></font><font color="#FF00FF">mov bh, c              </font><font color="#008000"><i>{ load color into bh }
  </i></font><font color="#FF00FF">mov es:[di], bh        </font><font color="#008000"><i>{ moving color into d-buffer }
 </i></font><font color="#FF00FF">@fin:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>GetScreenPoint<font color="#000080">;
</font><font color="#008000"><i>{    Job : get point from VGA screen memory                             }
{  Input : x, y - coordinates                                           }
{ Output : color index                                                  }
</i></font><font color="#FF0000"><b>begin</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov ax, y              </font><font color="#008000"><i>{ load y to ax }
    </i></font><font color="#FF00FF">cmp ax, MinY
    jl @fin
    cmp ax, MaxX
    jg @fin
    mov cx, x              </font><font color="#008000"><i>{ load x to cx }
    </i></font><font color="#FF00FF">cmp cx, MinX
    jl @fin
    cmp cx, MaxX
    jg @fin
    les di, vbuffer        </font><font color="#008000"><i>{ loading d-buffer starting address }
    </i></font><font color="#FF00FF">mov bx, ax             </font><font color="#008000"><i>{ copy y to bx }
    </i></font><font color="#FF00FF">sal ax, 6              </font><font color="#008000"><i>{ shift equal mult on 32 }
    </i></font><font color="#FF00FF">sal bx, 8              </font><font color="#008000"><i>{ shift equal mult on 256 }
    </i></font><font color="#FF00FF">add ax, bx             </font><font color="#008000"><i>{ equal mult on 320 (with shifts) }
    </i></font><font color="#FF00FF">add ax, cx             </font><font color="#008000"><i>{ starting point solved }
    </i></font><font color="#FF00FF">add di, ax             </font><font color="#008000"><i>{ starting point in es:di now }
    </i></font><font color="#FF00FF">mov bh, es:[di]        </font><font color="#008000"><i>{ load point from buffer to bh }
    </i></font><font color="#FF00FF">mov @result, bh        </font><font color="#008000"><i>{ return color into func. result }
    </i></font><font color="#FF00FF">jmp @ok
   @fin:
    mov @result, 0
   @ok:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetVLine<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : draw vertical line to screen/double buffer ( with clipping ) }
{  Input : x, y1, y2 - coordinates; c - color index                     }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov cx, x
  cmp cx, MinX
  jl @fin
  cmp cx, MaxX
  jg @fin
  mov ax, y1
  cmp y2, ax
  jg @nochange
    xchg y2, ax
    mov y1, ax
 @nochange:
  mov ax, y1
  cmp ax, MaxY
  jg @fin
  cmp ax, MinY
  jge @notopcut
  mov ax, MinY
  mov y1, ax
 @notopcut:
  mov ax, y2
  cmp ax, MinY
  jl @fin
  cmp ax, MaxY
  jle @nobottomcut
  mov ax, MaxY
  mov y2, ax
 @nobottomcut:
  les di, dbuffer       </font><font color="#008000"><i>{ loading d-buffer starting address }
  </i></font><font color="#FF00FF">mov ax, y1            </font><font color="#008000"><i>{ solving starting point }
  </i></font><font color="#FF00FF">mov bx, ax            </font><font color="#008000"><i>{ copy y1 to bx }
  </i></font><font color="#FF00FF">sal ax, 6             </font><font color="#008000"><i>{ shift equal mult on 32 }
  </i></font><font color="#FF00FF">sal bx, 8             </font><font color="#008000"><i>{ shift equal mult on 256 }
  </i></font><font color="#FF00FF">add ax, bx            </font><font color="#008000"><i>{ equal mult on 320 (with shifts) }
  </i></font><font color="#FF00FF">mov bx, x             </font><font color="#008000"><i>{ load x to bx }
  </i></font><font color="#FF00FF">add ax, bx            </font><font color="#008000"><i>{ starting point solved }
  </i></font><font color="#FF00FF">add di, ax            </font><font color="#008000"><i>{ starting point in es:di now }
  </i></font><font color="#FF00FF">mov cx, y2            </font><font color="#008000"><i>{ load y2 coordinate to ax }
  </i></font><font color="#FF00FF">mov bx, y1            </font><font color="#008000"><i>{ load y1 coordinate to bx }
  </i></font><font color="#FF00FF">inc cx                </font><font color="#008000"><i>{ correct size of line }
  </i></font><font color="#FF00FF">sub cx, bx            </font><font color="#008000"><i>{ size of line -1 in ax }
  </i></font><font color="#FF00FF">mov bh, c             </font><font color="#008000"><i>{ load color into bh }
  </i></font><font color="#FF00FF">mov ax, 320           </font><font color="#008000"><i>{ load size of line into cx }
 </i></font><font color="#FF00FF">@cont:                 </font><font color="#008000"><i>{ label for repeat points }
    </i></font><font color="#FF00FF">mov es:[di], bh     </font><font color="#008000"><i>{ moving color into d-buffer }
    </i></font><font color="#FF00FF">add di, ax          </font><font color="#008000"><i>{ increment pointer }
  </i></font><font color="#FF00FF">loop @cont            </font><font color="#008000"><i>{ return if not ready }
 </i></font><font color="#FF00FF">@fin:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetHLine<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : draw horizontal line to screen/dble buffer ( with clipping ) }
{  Input : x1, x2, y - coordinates, c - color index                     }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax, y
  cmp ax, MinY
  jl @fin
  cmp ax, MaxY
  jg @fin
  mov ax, x1
  cmp x2, ax
  jg @nochange
    xchg x2, ax
    mov x1, ax
 @nochange:
  mov ax, x1
  cmp ax, MaxX
  jg @fin
  cmp ax, MinX
  jge @noleftcut
  mov ax, MinX
  mov x1, ax
 @noleftcut:
  mov ax, x2
  cmp ax, MinX
  jl @fin
  cmp ax, MaxX
  jle @norightcut
  mov ax, MaxX
  mov x2, ax
 @norightcut:
  les di, dbuffer       </font><font color="#008000"><i>{ loading d-buffer starting address }
  </i></font><font color="#FF00FF">mov ax, y             </font><font color="#008000"><i>{ solving starting point }
  </i></font><font color="#FF00FF">mov bx, ax            </font><font color="#008000"><i>{ copy y to bx }
  </i></font><font color="#FF00FF">sal ax, 6             </font><font color="#008000"><i>{ shift equal mult on 32 }
  </i></font><font color="#FF00FF">sal bx, 8             </font><font color="#008000"><i>{ shift equal mult on 256 }
  </i></font><font color="#FF00FF">add ax, bx            </font><font color="#008000"><i>{ equal mult on 320 (with shifts) }
  </i></font><font color="#FF00FF">mov bx, x1            </font><font color="#008000"><i>{ load first x to bx }
  </i></font><font color="#FF00FF">add ax, bx            </font><font color="#008000"><i>{ starting point solved }
  </i></font><font color="#FF00FF">add di, ax            </font><font color="#008000"><i>{ starting point in es:di now }
  </i></font><font color="#FF00FF">mov cx, x2            </font><font color="#008000"><i>{ load y2 coordinate to ax }
  </i></font><font color="#FF00FF">inc cx                </font><font color="#008000"><i>{ correct size of line }
  </i></font><font color="#FF00FF">mov bx, x1            </font><font color="#008000"><i>{ load y1 coordinate bx }
  </i></font><font color="#FF00FF">sub cx, bx            </font><font color="#008000"><i>{ size of line -1 in ax }
  </i></font><font color="#FF00FF">mov bh, c             </font><font color="#008000"><i>{ load color into bh }
 </i></font><font color="#FF00FF">@cont:                 </font><font color="#008000"><i>{ label for repeat point }
    </i></font><font color="#FF00FF">mov es:[di], bh     </font><font color="#008000"><i>{ moving color into d-buffer }
    </i></font><font color="#FF00FF">inc di              </font><font color="#008000"><i>{ increment pointer }
  </i></font><font color="#FF00FF">loop @cont            </font><font color="#008000"><i>{ return if not ready }
 </i></font><font color="#FF00FF">@fin:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SetLine<font color="#000080">;  </font><font color="#008000"><i>{ * needs optimizing * }
{    Job : draw any line on screen/double buffer                        }
{  Input : x1, y1, x2, y2 - coordinates; c - color index                }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>var </b></font>dx<font color="#000080">, </font>dy<font color="#000080">, </font>s<font color="#000080">, </font>e<font color="#000080">, </font>i <font color="#000080">: </font>integer<font color="#000080">; </font>j<font color="#000080">, </font>delta <font color="#000080">: </font>single<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>dx<font color="#000080">:=</font>x2 <font color="#000080">- </font>x1<font color="#000080">;
  </font>dy<font color="#000080">:=</font>y2 <font color="#000080">- </font>y1<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>dx <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
    if </b></font>dy <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin </b></font>SetPoint<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>c<font color="#000080">); </font>exit<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>dy <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin </b></font>SetVLine<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>y2<font color="#000080">,</font>c<font color="#000080">); </font>exit<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>dy <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
    if </b></font>dx <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin </b></font>SetPoint<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>c<font color="#000080">); </font>exit<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>dx <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin </b></font>SetHLine<font color="#000080">(</font>x1<font color="#000080">,</font>x2<font color="#000080">,</font>y1<font color="#000080">,</font>c<font color="#000080">); </font>exit<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>abs<font color="#000080">(</font>dx<font color="#000080">) &gt; </font>abs<font color="#000080">(</font>dy<font color="#000080">) </font><font color="#FF0000"><b>then begin
    </b></font>delta<font color="#000080">:=</font>dy <font color="#000080">/ </font>dx<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>dx <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>j<font color="#000080">:=</font>y1<font color="#000080">; </font>s<font color="#000080">:=</font>x1<font color="#000080">; </font>e<font color="#000080">:=</font>x2<font color="#000080">;
    </font><font color="#FF0000"><b>end else begin
      </b></font>j<font color="#000080">:=</font>y2<font color="#000080">; </font>s<font color="#000080">:=</font>x2<font color="#000080">; </font>e<font color="#000080">:=</font>x1<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>s <font color="#FF0000"><b>to </b></font>e <font color="#FF0000"><b>do begin
      </b></font>SetPoint<font color="#000080">(</font>i<font color="#000080">,</font>round<font color="#000080">(</font>j<font color="#000080">),</font>c<font color="#000080">); </font>j<font color="#000080">:=</font>j<font color="#000080">+</font>delta<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end else begin
    </b></font>delta<font color="#000080">:=</font>dx <font color="#000080">/ </font>dy<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>dy <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>j<font color="#000080">:=</font>x1<font color="#000080">; </font>s<font color="#000080">:=</font>y1<font color="#000080">; </font>e<font color="#000080">:=</font>y2<font color="#000080">;
    </font><font color="#FF0000"><b>end else begin
      </b></font>j<font color="#000080">:=</font>x2<font color="#000080">; </font>s<font color="#000080">:=</font>y2<font color="#000080">; </font>e<font color="#000080">:=</font>y1<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>s <font color="#FF0000"><b>to </b></font>e <font color="#FF0000"><b>do begin
      </b></font>SetPoint<font color="#000080">(</font>round<font color="#000080">(</font>j<font color="#000080">),</font>i<font color="#000080">,</font>c<font color="#000080">); </font>j<font color="#000080">:=</font>j<font color="#000080">+</font>delta<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetBox<font color="#000080">;  </font><font color="#008000"><i>{ * needs optimizing a bit * }
{    Job : draw filled box on screen/double buffer                      }
{  Input : x1, y1, x2, y2 - coordinates; c - color index                }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>var </b></font>i<font color="#000080">, </font>s<font color="#000080">, </font>e <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>y1 <font color="#000080">&lt; </font>y2 <font color="#FF0000"><b>then begin </b></font>s<font color="#000080">:=</font>y1<font color="#000080">; </font>e<font color="#000080">:=</font>y2 <font color="#FF0000"><b>end else begin </b></font>s<font color="#000080">:=</font>y2<font color="#000080">; </font>e<font color="#000080">:=</font>y1<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>s <font color="#FF0000"><b>to </b></font>e <font color="#FF0000"><b>do </b></font>SetHLine<font color="#000080">(</font>x1<font color="#000080">,</font>x2<font color="#000080">,</font>i<font color="#000080">,</font>c<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetRect<font color="#000080">;  </font><font color="#008000"><i>{ * needs optimizing a bit * }
{    Job : draw rectangle on screen/double buffer                       }
{  Input : x1, y1, x2, y2 - coordinates; c - color index                }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>begin
  </b></font>SetHLine<font color="#000080">(</font>x1<font color="#000080">,</font>x2<font color="#000080">,</font>y1<font color="#000080">,</font>c<font color="#000080">);
  </font>SetHLine<font color="#000080">(</font>x1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">,</font>c<font color="#000080">);
  </font>SetVLine<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>y2<font color="#000080">,</font>c<font color="#000080">);
  </font>SetVLine<font color="#000080">(</font>x2<font color="#000080">,</font>y1<font color="#000080">,</font>y2<font color="#000080">,</font>c<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ --------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Procedure </b></font>SetPaletteColor<font color="#000080">;
</font><font color="#008000"><i>{    Job : set selected color in VGA palette                            }
{  Input : c - color index; r, g, b - color components (0..63)          }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>begin
  </b></font>port<font color="#000080">[</font><font color="#800000">$3C6</font><font color="#000080">]:=</font><font color="#800000">$FF</font><font color="#000080">;
  </font>port<font color="#000080">[</font><font color="#800000">$3C8</font><font color="#000080">]:=</font>c<font color="#000080">;
  </font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>r<font color="#000080">;
  </font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>g<font color="#000080">;
  </font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>b<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetPaletteColor<font color="#000080">;
</font><font color="#008000"><i>{    Job : get selected color from VGA palette                          }
{  Input : c - color index                                              }
{ Output : r, g, b - color components (0..63)                           }
</i></font><font color="#FF0000"><b>begin
  </b></font>port<font color="#000080">[</font><font color="#800000">$3C6</font><font color="#000080">]:=</font><font color="#800000">$FF</font><font color="#000080">;
  </font>port<font color="#000080">[</font><font color="#800000">$3C7</font><font color="#000080">]:=</font>c<font color="#000080">;
  </font>r<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
  </font>g<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
  </font>b<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ColorInPal<font color="#000080">;
</font><font color="#008000"><i>{    Job : check color in palette                                       }
{  Input : r,g,b - color components; p - palette, if NIL - VGA palette  }
{ Output : true if color in palette, in that case c - index in palette  }
</i></font><font color="#FF0000"><b>var
  </b></font>pal        <font color="#000080">: </font>PVGAPalette<font color="#000080">;
  </font>tr<font color="#000080">, </font>tg<font color="#000080">, </font>tb <font color="#000080">: </font>byte<font color="#000080">;
  </font>ok<font color="#000080">, </font>en     <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>c<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>pal<font color="#000080">:=</font>p<font color="#000080">; </font>ok<font color="#000080">:=</font>false<font color="#000080">; </font>en<font color="#000080">:=</font>false<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    if </b></font>pal <font color="#000080">= </font><font color="#FF0000"><b>NIL then begin
      </b></font>GetPaletteColor<font color="#000080">(</font>c<font color="#000080">,</font>tr<font color="#000080">,</font>tg<font color="#000080">,</font>tb<font color="#000080">);
    </font><font color="#FF0000"><b>end else begin
      </b></font>tr<font color="#000080">:=</font>pal<font color="#000080">^[</font>c<font color="#000080">].</font>r<font color="#000080">;
      </font>tg<font color="#000080">:=</font>pal<font color="#000080">^[</font>c<font color="#000080">].</font>g<font color="#000080">;
      </font>tb<font color="#000080">:=</font>pal<font color="#000080">^[</font>c<font color="#000080">].</font>b<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>r <font color="#000080">= </font>tr<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>g <font color="#000080">= </font>tg<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>b <font color="#000080">= </font>tb<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>ok<font color="#000080">:=</font>true<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>ok<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c <font color="#000080">&lt; </font><font color="#800000">255</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>c<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>en<font color="#000080">:=</font>true<font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>ok <font color="#FF0000"><b>or </b></font>en<font color="#000080">;
  </font>ColorInPal<font color="#000080">:=</font>ok<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FindColor<font color="#000080">;
</font><font color="#008000"><i>{    Job : find nearest color in palette                                }
{  Input : r, g, b - color components; p - palette,if NIL - VGA palette }
{ Output : deviation                                                    }
</i></font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>save<font color="#000080">, </font>tr<font color="#000080">, </font>tg<font color="#000080">, </font>tb <font color="#000080">: </font>byte<font color="#000080">;
  </font>dist<font color="#000080">, </font>d <font color="#000080">: </font>integer<font color="#000080">; </font>pal <font color="#000080">: </font>PVGAPalette<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>dist<font color="#000080">:=</font><font color="#800000">1000</font><font color="#000080">; </font>save<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>pal<font color="#000080">:=</font>p<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do begin
    if </b></font>pal <font color="#000080">= </font><font color="#FF0000"><b>NIL then begin
      </b></font>GetPaletteColor<font color="#000080">(</font>i<font color="#000080">,</font>tr<font color="#000080">,</font>tg<font color="#000080">,</font>tb<font color="#000080">);
    </font><font color="#FF0000"><b>end else begin
      </b></font>tr<font color="#000080">:=</font>pal<font color="#000080">^[</font>i<font color="#000080">].</font>r<font color="#000080">;
      </font>tg<font color="#000080">:=</font>pal<font color="#000080">^[</font>i<font color="#000080">].</font>g<font color="#000080">;
      </font>tb<font color="#000080">:=</font>pal<font color="#000080">^[</font>i<font color="#000080">].</font>b<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>d<font color="#000080">:=</font>round<font color="#000080">(</font>sqrt<font color="#000080">(</font>sqr<font color="#000080">(</font>tr<font color="#000080">-</font>r<font color="#000080">)+</font>sqr<font color="#000080">(</font>tg<font color="#000080">-</font>g<font color="#000080">)+</font>sqr<font color="#000080">(</font>tb<font color="#000080">-</font>b<font color="#000080">)));
    </font><font color="#FF0000"><b>if </b></font>d <font color="#000080">&lt; </font>dist <font color="#FF0000"><b>then begin </b></font>dist<font color="#000080">:=</font>d<font color="#000080">; </font>save<font color="#000080">:=</font>i<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>c<font color="#000080">:=</font>save<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetAllPalette<font color="#000080">;
</font><font color="#008000"><i>{    Job : set all palette colors from memory buffer                    }
{  Input : p - pointer to mem buffer ( 768 bytes of color components )  }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">; </font>pp <font color="#000080">: </font>PVGAPalette<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>pp<font color="#000080">:=</font>p<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do begin
    </b></font>port<font color="#000080">[</font><font color="#800000">$3C6</font><font color="#000080">]:=</font><font color="#800000">$FF</font><font color="#000080">;
    </font>port<font color="#000080">[</font><font color="#800000">$3C8</font><font color="#000080">]:=</font>i<font color="#000080">;
    </font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>pp<font color="#000080">^[</font>i<font color="#000080">].</font>r<font color="#000080">;
    </font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>pp<font color="#000080">^[</font>i<font color="#000080">].</font>g<font color="#000080">;
    </font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>pp<font color="#000080">^[</font>i<font color="#000080">].</font>b<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetAllPalette<font color="#000080">;
</font><font color="#008000"><i>{    Job : read all VGA palette colors from DAC to memory buffer        }
{  Input : p - pointer to mem buffer ( 768 bytes of color components )  }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">; </font>pp <font color="#000080">: </font>PVGAPalette<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>pp<font color="#000080">:=</font>p<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do begin
    </b></font>port<font color="#000080">[</font><font color="#800000">$3C6</font><font color="#000080">]:=</font><font color="#800000">$FF</font><font color="#000080">;
    </font>port<font color="#000080">[</font><font color="#800000">$3C7</font><font color="#000080">]:=</font>i<font color="#000080">;
    </font>pp<font color="#000080">^[</font>i<font color="#000080">].</font>r<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
    </font>pp<font color="#000080">^[</font>i<font color="#000080">].</font>g<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
    </font>pp<font color="#000080">^[</font>i<font color="#000080">].</font>b<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FadeIn<font color="#000080">; </font><font color="#008000"><i>{ * needs optimizing * }
{    Job : fading screen palette into new palette                       }
{  Input : n - fading speed; p : new palette                            }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>var </b></font>tmp <font color="#000080">: </font>TVGAPalette<font color="#000080">; </font>pp <font color="#000080">: </font>PVGAPalette<font color="#000080">; </font>i<font color="#000080">, </font>j <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>pp<font color="#000080">:=</font>p<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>do begin
    </b></font>Delay<font color="#000080">(</font>n<font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do begin
      </b></font>tmp<font color="#000080">[</font>i<font color="#000080">].</font>R<font color="#000080">:=</font>round<font color="#000080">((</font>pp<font color="#000080">^[</font>i<font color="#000080">].</font>r <font color="#000080">/ </font><font color="#800000">63</font><font color="#000080">) * </font>j<font color="#000080">);
      </font>tmp<font color="#000080">[</font>i<font color="#000080">].</font>G<font color="#000080">:=</font>round<font color="#000080">((</font>pp<font color="#000080">^[</font>i<font color="#000080">].</font>g <font color="#000080">/ </font><font color="#800000">63</font><font color="#000080">) * </font>j<font color="#000080">);
      </font>tmp<font color="#000080">[</font>i<font color="#000080">].</font>B<font color="#000080">:=</font>round<font color="#000080">((</font>pp<font color="#000080">^[</font>i<font color="#000080">].</font>b <font color="#000080">/ </font><font color="#800000">63</font><font color="#000080">) * </font>j<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Retrace<font color="#000080">;
    </font>SetAllPalette<font color="#000080">(@</font>tmp<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FadeOut<font color="#000080">; </font><font color="#008000"><i>{ * needs optimizing * }
{    Job : fading screen out                                            }
{  Input : n - fading speed                                             }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>var </b></font>tmp<font color="#000080">, </font>base <font color="#000080">: </font>TVGAPalette<font color="#000080">; </font>i<font color="#000080">, </font>j <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetAllPalette<font color="#000080">(@</font>base<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font><font color="#800000">63 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do begin
    </b></font>Delay<font color="#000080">(</font>n<font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do begin
      </b></font>tmp<font color="#000080">[</font>i<font color="#000080">].</font>R<font color="#000080">:=</font>round<font color="#000080">(</font>j <font color="#000080">* (</font>base<font color="#000080">[</font>i<font color="#000080">].</font>R <font color="#000080">/ </font><font color="#800000">63</font><font color="#000080">));
      </font>tmp<font color="#000080">[</font>i<font color="#000080">].</font>G<font color="#000080">:=</font>round<font color="#000080">(</font>j <font color="#000080">* (</font>base<font color="#000080">[</font>i<font color="#000080">].</font>G <font color="#000080">/ </font><font color="#800000">63</font><font color="#000080">));
      </font>tmp<font color="#000080">[</font>i<font color="#000080">].</font>B<font color="#000080">:=</font>round<font color="#000080">(</font>j <font color="#000080">* (</font>base<font color="#000080">[</font>i<font color="#000080">].</font>B <font color="#000080">/ </font><font color="#800000">63</font><font color="#000080">));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Retrace<font color="#000080">;
    </font>SetAllPalette<font color="#000080">(@</font>tmp<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ --------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Procedure </b></font>BitBLT_Opaque<font color="#000080">;
</font><font color="#008000"><i>{    Job : draw sprite to screen/double buffer ( with clipping )        }
{  Input : x, y - coordinates; sprite - sprite structure                }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>var </b></font>ra<font color="#000080">, </font>rb<font color="#000080">, </font>ox<font color="#000080">, </font>oy<font color="#000080">, </font>fx<font color="#000080">, </font>fy<font color="#000080">, </font>ch1<font color="#000080">, </font>ch2 <font color="#000080">: </font>integer<font color="#000080">; </font>sz<font color="#000080">, </font>rz <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">mov ax, x
    mov bx, MaxX
    cmp ax, bx
    jg @fin
    mov dx, MinX
    mov cx, sprite.a
    add ax, cx
    cmp ax, dx
    jle @fin
    mov ra, cx
    mov ax, x
    cmp ax, dx
    jge @m_zx
      mov ox, dx
      sub ox, ax
      mov fx, dx
      mov cx, ox
      sub ra, cx
      jmp @m_zxe
    @m_zx:
      mov ox, 0
      mov fx, ax
    @m_zxe:
    mov ch1, ax
    mov bx, sprite.a
    dec bx
    add ch1, bx
    mov cx, MaxX
    cmp ch1, cx
    jle @noxdec
      mov ax, ch1
      sub ax, cx
      sub ra, ax
    @noxdec:
    mov ax, y
    mov bx, MaxY
    cmp ax, bx
    jg @fin
    mov dx, MinY
    mov cx, sprite.b
    add ax, cx
    cmp ax, dx
    jle @fin
    mov rb, cx
    mov ax, y
    cmp ax, dx
    jge @m_zy
      mov oy, dx
      sub oy, ax
      mov fy, dx
      mov cx, oy
      sub rb, cx
      jmp @m_zye
    @m_zy:
      mov oy, 0
      mov fy, ax
    @m_zye:
    mov ch2, ax
    mov bx, sprite.b
    dec bx
    add ch2, bx
    mov cx, MaxY
    cmp ch2, cx
    jle @noydec
      mov ax, ch2
      sub ax, cx
      sub rb, ax
    @noydec:
    mov ax, oy
    mov bx, sprite.a
    imul bx
    mov sz, ax
    mov ax, ra
    mov bx, rb
    imul bx
    mov rz, ax
    </font><font color="#008000"><i>{ go draw }
    </i></font><font color="#FF00FF">push ds
    les di, dbuffer
    add di, fx
    mov ax, fy
    mov bx, ax
    sal ax, 6
    sal bx, 8
    add di, bx
    add di, ax
    lds si, sprite.data
    add si, sz
    add si, ox
    mov dx, sprite.a
    mov bx, ra
    mov cx, rz
    @sprite_loop:
      mov al, ds:[si]
      mov es:[di], al
      inc di
      inc si
      dec bx
      cmp bx, 0
      jne @nocorr
        mov bx, ra
        sub di, bx
        add di, 320
        add si, dx
        sub si, bx
      @nocorr:
    loop @sprite_loop
    pop ds
    @fin:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>BitBLT_Transparent<font color="#000080">;
</font><font color="#008000"><i>{    Job : draw sprite to screen/double buffer with transparency check  }
{          trancparency color = 0  ( with clipping )                    }
{  Input : x, y - coordinates; sprite - sprite structure                }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>var </b></font>ra<font color="#000080">, </font>rb<font color="#000080">, </font>ox<font color="#000080">, </font>oy<font color="#000080">, </font>fx<font color="#000080">, </font>fy<font color="#000080">, </font>ch1<font color="#000080">, </font>ch2 <font color="#000080">: </font>integer<font color="#000080">; </font>sz<font color="#000080">, </font>rz <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">mov ax, x
    mov bx, MaxX
    cmp ax, bx
    jg @fin
    mov dx, MinX
    mov cx, sprite.a
    add ax, cx
    cmp ax, dx
    jle @fin
    mov ra, cx
    mov ax, x
    cmp ax, dx
    jge @m_zx
      mov ox, dx
      sub ox, ax
      mov fx, dx
      mov cx, ox
      sub ra, cx
      jmp @m_zxe
    @m_zx:
      mov ox, 0
      mov fx, ax
    @m_zxe:
    mov ch1, ax
    mov bx, sprite.a
    dec bx
    add ch1, bx
    mov cx, MaxX
    cmp ch1, cx
    jle @noxdec
      mov ax, ch1
      sub ax, cx
      sub ra, ax
    @noxdec:
    mov ax, y
    mov bx, MaxY
    cmp ax, bx
    jg @fin
    mov dx, MinY
    mov cx, sprite.b
    add ax, cx
    cmp ax, dx
    jle @fin
    mov rb, cx
    mov ax, y
    cmp ax, dx
    jge @m_zy
      mov oy, dx
      sub oy, ax
      mov fy, dx
      mov cx, oy
      sub rb, cx
      jmp @m_zye
    @m_zy:
      mov oy, 0
      mov fy, ax
    @m_zye:
    mov ch2, ax
    mov bx, sprite.b
    dec bx
    add ch2, bx
    mov cx, MaxY
    cmp ch2, cx
    jle @noydec
      mov ax, ch2
      sub ax, cx
      sub rb, ax
    @noydec:
    mov ax, oy
    mov bx, sprite.a
    imul bx
    mov sz, ax
    mov ax, ra
    mov bx, rb
    imul bx
    mov rz, ax
    </font><font color="#008000"><i>{ go draw }
    </i></font><font color="#FF00FF">push ds
    les di, dbuffer
    add di, fx
    mov ax, fy
    mov bx, ax
    sal ax, 6
    sal bx, 8
    add di, bx
    add di, ax
    lds si, sprite.data
    add si, sz
    add si, ox
    mov dx, sprite.a
    mov bx, ra
    mov cx, rz
    @sprite_loop:
      mov al, ds:[si]
      cmp al, 0
      je @skip_transparent
        mov es:[di], al
      @skip_transparent:
      inc di
      inc si
      dec bx
      cmp bx, 0
      jne @nocorr
        mov bx, ra
        sub di, bx
        add di, 320
        add si, dx
        sub si, bx
      @nocorr:
    loop @sprite_loop
    pop ds
    @fin:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>BitBLT_OpaqueT<font color="#000080">;
</font><font color="#008000"><i>{    Job : draw sprite to screen/double buffer  ( w/o clipping )        }
{  Input : x, y - coordinates; sprite - sprite structure                }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">push ds                         </font><font color="#008000"><i>{ save DS segment }
    </i></font><font color="#FF00FF">les di, dbuffer                 </font><font color="#008000"><i>{ load d-buffer }
    </i></font><font color="#FF00FF">mov ax, y                       </font><font color="#008000"><i>{ load starting y }
    </i></font><font color="#FF00FF">mov bx, ax                      </font><font color="#008000"><i>{ copy starting y }
    </i></font><font color="#FF00FF">sal ax, 6                       </font><font color="#008000"><i>{ mul to 64 }
    </i></font><font color="#FF00FF">sal bx, 8                       </font><font color="#008000"><i>{ mul to 256 }
    </i></font><font color="#FF00FF">add ax, bx                      </font><font color="#008000"><i>{ now mul to 320 }
    </i></font><font color="#FF00FF">mov bx, x                       </font><font color="#008000"><i>{ load starting x }
    </i></font><font color="#FF00FF">add ax, bx                      </font><font color="#008000"><i>{ solving starting dest point }
    </i></font><font color="#FF00FF">add di, ax                      </font><font color="#008000"><i>{ dest first point in es:di }
    </i></font><font color="#FF00FF">lds si, sprite.data             </font><font color="#008000"><i>{ load source point to ds:si }
    </i></font><font color="#FF00FF">mov bx, sprite.b                </font><font color="#008000"><i>{ load height to bx }
    </i></font><font color="#FF00FF">mov cx, sprite.a                </font><font color="#008000"><i>{ load width to cx }
    </i></font><font color="#FF00FF">@cont_next_line:                </font><font color="#008000"><i>{ label for next line }
      </i></font><font color="#FF00FF">mov cx, sprite.a              </font><font color="#008000"><i>{ load width again }
      </i></font><font color="#FF00FF">@cont_line:                   </font><font color="#008000"><i>{ label for next pixel }
        </i></font><font color="#FF00FF">mov al, ds:[si]             </font><font color="#008000"><i>{ load source to al }
        </i></font><font color="#FF00FF">mov [es:di], al             </font><font color="#008000"><i>{ load al to dest }
        </i></font><font color="#FF00FF">inc si                      </font><font color="#008000"><i>{ increment source line }
        </i></font><font color="#FF00FF">inc di                      </font><font color="#008000"><i>{ increment dest line }
        </i></font><font color="#FF00FF">dec cx                      </font><font color="#008000"><i>{ decrement pixel counter }
      </i></font><font color="#FF00FF">jnz @cont_line                </font><font color="#008000"><i>{ return if line not ready }
      </i></font><font color="#FF00FF">add di, 320                   </font><font color="#008000"><i>{ add const to next line }
      </i></font><font color="#FF00FF">sub di, sprite.a              </font><font color="#008000"><i>{ correct to start line }
      </i></font><font color="#FF00FF">dec bx                        </font><font color="#008000"><i>{ decrement lines counter }
    </i></font><font color="#FF00FF">jnz @cont_next_line             </font><font color="#008000"><i>{ continue if block not ready }
    </i></font><font color="#FF00FF">pop ds                          </font><font color="#008000"><i>{ return ds segment }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>BitBLT_TransparentT<font color="#000080">;
</font><font color="#008000"><i>{    Job : draw sprite to screen/double buffer with transparency check  }
{          trancparency color = 0  ( w/o clipping )                     }
{  Input : x, y - coordinates; sprite - sprite structure                }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">push ds                         </font><font color="#008000"><i>{ save DS segment }
    </i></font><font color="#FF00FF">les di, dbuffer                 </font><font color="#008000"><i>{ load d-buffer }
    </i></font><font color="#FF00FF">mov ax, y                       </font><font color="#008000"><i>{ load starting y }
    </i></font><font color="#FF00FF">mov bx, ax                      </font><font color="#008000"><i>{ copy starting y }
    </i></font><font color="#FF00FF">sal ax, 6                       </font><font color="#008000"><i>{ mul to 64 }
    </i></font><font color="#FF00FF">sal bx, 8                       </font><font color="#008000"><i>{ mul to 256 }
    </i></font><font color="#FF00FF">add ax, bx                      </font><font color="#008000"><i>{ now mul to 320 }
    </i></font><font color="#FF00FF">mov bx, x                       </font><font color="#008000"><i>{ load starting x }
    </i></font><font color="#FF00FF">add ax, bx                      </font><font color="#008000"><i>{ solving starting dest point }
    </i></font><font color="#FF00FF">add di, ax                      </font><font color="#008000"><i>{ dest first point in es:di }
    </i></font><font color="#FF00FF">lds si, sprite.data             </font><font color="#008000"><i>{ load source point to ds:si }
    </i></font><font color="#FF00FF">mov bx, sprite.b                </font><font color="#008000"><i>{ load height to bx }
    </i></font><font color="#FF00FF">mov cx, sprite.a                </font><font color="#008000"><i>{ load width to cx }
    </i></font><font color="#FF00FF">@cont_next_line:                </font><font color="#008000"><i>{ label for next line }
      </i></font><font color="#FF00FF">mov cx, sprite.a              </font><font color="#008000"><i>{ load width again }
      </i></font><font color="#FF00FF">@cont_line:                   </font><font color="#008000"><i>{ label for next pixel }
        </i></font><font color="#FF00FF">mov al, ds:[si]             </font><font color="#008000"><i>{ load source to al }
        </i></font><font color="#FF00FF">cmp al, 0                   </font><font color="#008000"><i>{ compare with transparent }
        </i></font><font color="#FF00FF">je @skip_transparent        </font><font color="#008000"><i>{ skip if transparent }
          </i></font><font color="#FF00FF">mov [es:di], al           </font><font color="#008000"><i>{ load al to dest }
        </i></font><font color="#FF00FF">@skip_transparent:          </font><font color="#008000"><i>{ label for skipping }
        </i></font><font color="#FF00FF">inc si                      </font><font color="#008000"><i>{ increment source line }
        </i></font><font color="#FF00FF">inc di                      </font><font color="#008000"><i>{ increment dest line }
        </i></font><font color="#FF00FF">dec cx                      </font><font color="#008000"><i>{ decrement pixel counter }
      </i></font><font color="#FF00FF">jnz @cont_line                </font><font color="#008000"><i>{ return if line not ready }
      </i></font><font color="#FF00FF">add di, 320                   </font><font color="#008000"><i>{ add const to next line }
      </i></font><font color="#FF00FF">sub di, sprite.a              </font><font color="#008000"><i>{ correct to start line }
      </i></font><font color="#FF00FF">dec bx                        </font><font color="#008000"><i>{ decrement lines counter }
    </i></font><font color="#FF00FF">jnz @cont_next_line             </font><font color="#008000"><i>{ continue if block not ready }
    </i></font><font color="#FF00FF">pop ds                          </font><font color="#008000"><i>{ return ds segment }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Zoom_OpaqueT<font color="#000080">;    </font><font color="#008000"><i>{ * needs addon clipping * }
{    Job : moving sprite into screen with zooming ( w/o clipping )   }
{          max sprite size for correct zooming - 255x255             }
{  Input : zx, zy, za, zb - position and size of sprite on screen,   }
{          sprite - sprite structure                                 }
{ Output : none ( visual result :)                                   }
</i></font><font color="#FF0000"><b>var </b></font>vdx<font color="#000080">, </font>vdy<font color="#000080">, </font>soff <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">push ds                     </font><font color="#008000"><i>{ save ds register, will changed }
    </i></font><font color="#FF00FF">mov ax, 320                 </font><font color="#008000"><i>{ * }
    </i></font><font color="#FF00FF">sub ax, word ptr za
    mov word ptr soff, ax       </font><font color="#008000"><i>{ make screen offset }
    </i></font><font color="#FF00FF">mov ax, word ptr sprite.a   </font><font color="#008000"><i>{ * }
    </i></font><font color="#FF00FF">mov bx, word ptr za
    sal ax, 8
    xor dx, dx
    div bx
    mov word ptr vdx, ax        </font><font color="#008000"><i>{ count increment x factor }
    </i></font><font color="#FF00FF">mov ax, word ptr sprite.b   </font><font color="#008000"><i>{ * }
    </i></font><font color="#FF00FF">mov bx, word ptr zb
    sal ax, 8
    xor dx, dx
    div bx
    mov word ptr vdy, ax     </font><font color="#008000"><i>{ count increment y factor }
    </i></font><font color="#FF00FF">les di, dbuffer          </font><font color="#008000"><i>{ * }
    </i></font><font color="#FF00FF">mov ax, zy
    mov bx, ax
    sal ax, 6
    sal bx, 8
    add ax, bx
    mov bx, zx
    add ax, bx
    add di, ax               </font><font color="#008000"><i>{ es:di points to first screen pixel }
    </i></font><font color="#FF00FF">lds si, sprite.data      </font><font color="#008000"><i>{ ds:si points to first pixel of sprite }
    </i></font><font color="#FF00FF">xor dx, dx               </font><font color="#008000"><i>{ reset current row (fixed) counter }
    </i></font><font color="#FF00FF">mov cx, zb               </font><font color="#008000"><i>{ init counter by column size }
    </i></font><font color="#FF00FF">@column:
      push cx                </font><font color="#008000"><i>{ save cx for inner loop }
      </i></font><font color="#FF00FF">push dx                </font><font color="#008000"><i>{ save dx for inner loop }
      </i></font><font color="#FF00FF">xor bx, bx             </font><font color="#008000"><i>{ reset bx (row pixel offset) }
      </i></font><font color="#FF00FF">xor dx, dx             </font><font color="#008000"><i>{ reset row (fixed) counter }
      </i></font><font color="#FF00FF">mov cx, za             </font><font color="#008000"><i>{ init current pixel in row }
      </i></font><font color="#FF00FF">@row:
        mov al, ds:[si][bx]  </font><font color="#008000"><i>{ pick up pixel from sprite }
        </i></font><font color="#FF00FF">mov es:[di], al      </font><font color="#008000"><i>{ draw pixel into video (or double) buffer }
        </i></font><font color="#FF00FF">add dx, word ptr vdx </font><font color="#008000"><i>{ increment pixel in row counter (fixed) }
        </i></font><font color="#FF00FF">mov bl, dh           </font><font color="#008000"><i>{ modify bx by integer part of current pixel }
        </i></font><font color="#FF00FF">inc di               </font><font color="#008000"><i>{ increment video (double) buffer offset }
      </i></font><font color="#FF00FF">loop @row              </font><font color="#008000"><i>{ loop of row drawing }
      </i></font><font color="#FF00FF">add di, word ptr soff  </font><font color="#008000"><i>{ increment screen (double) buffer offset }
      </i></font><font color="#FF00FF">pop dx                 </font><font color="#008000"><i>{ restore dx for outer loop }
      </i></font><font color="#FF00FF">pop cx                 </font><font color="#008000"><i>{ restore cx for outer loop }
      </i></font><font color="#FF00FF">mov ah, dh             </font><font color="#008000"><i>{ move dh to ah }
      </i></font><font color="#FF00FF">add dx, word ptr vdy   </font><font color="#008000"><i>{ increment column counter (fixed) }
      </i></font><font color="#FF00FF">mov al, dh
      sub al, ah
      jz @nonextcol
      @incy:
        add si, word ptr sprite.a
        dec al
        cmp al, 0
      jnz @incy
      @nonextcol:
    loop @column
    pop ds                 </font><font color="#008000"><i>{ restore ds register }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Zoom_TransparentT<font color="#000080">;    </font><font color="#008000"><i>{ * needs addon clipping * }
{    Job : moving sprite into screen with zooming ( w/o clipping )   }
{          max sprite size for correct zooming - 255x255             }
{  Input : zx, zy, za, zb - position and size of sprite on screen,   }
{          sprite - sprite structure                                 }
{ Output : none ( visual result :)                                   }
</i></font><font color="#FF0000"><b>var </b></font>vdx<font color="#000080">, </font>vdy<font color="#000080">, </font>soff <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">push ds                       </font><font color="#008000"><i>{ save ds register, will changed }
    </i></font><font color="#FF00FF">mov ax, 320                   </font><font color="#008000"><i>{ * }
    </i></font><font color="#FF00FF">sub ax, word ptr za
    mov word ptr soff, ax         </font><font color="#008000"><i>{ make screen offset }
    </i></font><font color="#FF00FF">mov ax, word ptr sprite.a     </font><font color="#008000"><i>{ * }
    </i></font><font color="#FF00FF">mov bx, word ptr za
    sal ax, 8
    xor dx, dx
    div bx
    mov word ptr vdx, ax          </font><font color="#008000"><i>{ count increment x factor }
    </i></font><font color="#FF00FF">mov ax, word ptr sprite.b     </font><font color="#008000"><i>{ * }
    </i></font><font color="#FF00FF">mov bx, word ptr zb
    sal ax, 8
    xor dx, dx
    div bx
    mov word ptr vdy, ax          </font><font color="#008000"><i>{ count increment y factor }
    </i></font><font color="#FF00FF">les di, dbuffer               </font><font color="#008000"><i>{ * }
    </i></font><font color="#FF00FF">mov ax, zy
    mov bx, ax
    sal ax, 6
    sal bx, 8
    add ax, bx
    mov bx, zx
    add ax, bx
    add di, ax                    </font><font color="#008000"><i>{ es:di points to first screen pixel }
    </i></font><font color="#FF00FF">lds si, sprite.data           </font><font color="#008000"><i>{ ds:si points to first pixel of sprite }
    </i></font><font color="#FF00FF">xor dx, dx                    </font><font color="#008000"><i>{ reset current row (fixed) counter }
    </i></font><font color="#FF00FF">mov cx, zb                    </font><font color="#008000"><i>{ init counter by column size }
    </i></font><font color="#FF00FF">@column:
      push cx                     </font><font color="#008000"><i>{ save cx for inner loop }
      </i></font><font color="#FF00FF">push dx                     </font><font color="#008000"><i>{ save dx for inner loop }
      </i></font><font color="#FF00FF">xor bx, bx                  </font><font color="#008000"><i>{ reset bx (row pixel offset) }
      </i></font><font color="#FF00FF">xor dx, dx                  </font><font color="#008000"><i>{ reset row (fixed) counter }
      </i></font><font color="#FF00FF">mov cx, za                  </font><font color="#008000"><i>{ init current pixel in row }
      </i></font><font color="#FF00FF">push bp                     </font><font color="#008000"><i>{ save bp (will changed) }
      </i></font><font color="#FF00FF">mov bp, word ptr vdx        </font><font color="#008000"><i>{ store horiz. increment into bp }
      </i></font><font color="#FF00FF">@row:
        mov al, ds:[si][bx]       </font><font color="#008000"><i>{ pick up pixel from sprite }
        </i></font><font color="#FF00FF">cmp al, 0                 </font><font color="#008000"><i>{ compare pixel with transparent color }
        </i></font><font color="#FF00FF">je @skip                  </font><font color="#008000"><i>{ skip if transparent color }
          </i></font><font color="#FF00FF">mov es:[di], al         </font><font color="#008000"><i>{ draw pixel into video (or double) buffer }
        </i></font><font color="#FF00FF">@skip:
        add dx, bp                </font><font color="#008000"><i>{ increment pixel in row counter (fixed) }
        </i></font><font color="#FF00FF">mov bl, dh                </font><font color="#008000"><i>{ modify bx by int. part of current pixel }
        </i></font><font color="#FF00FF">inc di                    </font><font color="#008000"><i>{ increment video (double) buffer offset }
      </i></font><font color="#FF00FF">loop @row                   </font><font color="#008000"><i>{ loop of row drawing }
      </i></font><font color="#FF00FF">pop bp                      </font><font color="#008000"><i>{ restore bp register }
      </i></font><font color="#FF00FF">add di, word ptr soff       </font><font color="#008000"><i>{ increment screen (double) buffer offset }
      </i></font><font color="#FF00FF">pop dx                      </font><font color="#008000"><i>{ restore dx for outer loop }
      </i></font><font color="#FF00FF">pop cx                      </font><font color="#008000"><i>{ restore cx for outer loop }
      </i></font><font color="#FF00FF">mov ah, dh                  </font><font color="#008000"><i>{ move dh to ah }
      </i></font><font color="#FF00FF">add dx, word ptr vdy        </font><font color="#008000"><i>{ increment column counter (fixed) }
      </i></font><font color="#FF00FF">mov al, dh
      sub al, ah
      jz @nonextcol
        mov bx, word ptr sprite.a
        @incy:
          add si, bx
          dec al
          cmp al, 0
        jnz @incy
      @nonextcol:
    loop @column
    pop ds                        </font><font color="#008000"><i>{ restore ds register }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GetImage<font color="#000080">;  </font><font color="#008000"><i>{ * needs optimizing * }
{    Job : moving screen/dbl buffer image to sprite structure           }
{  Input : zx, zy - position image on screen                            }
{          sprite - sprite structure, filled with a, b sprite size      }
{          and allocated memory for sprite ( getmem(data, a * b) )      }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>type </b></font>tm <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">64000</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">, </font>j <font color="#000080">: </font>integer<font color="#000080">; </font>m <font color="#000080">: ^</font>tm<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>m<font color="#000080">:=</font>sprite<font color="#000080">.</font>data<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>zx <font color="#FF0000"><b>to </b></font>zx<font color="#000080">+</font>sprite<font color="#000080">.</font>a<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
    for </b></font>j<font color="#000080">:=</font>zy <font color="#FF0000"><b>to </b></font>zy<font color="#000080">+</font>sprite<font color="#000080">.</font>b<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
      </b></font>m<font color="#000080">^[(</font>i<font color="#000080">-</font>zx<font color="#000080">)+(</font>j<font color="#000080">-</font>zy<font color="#000080">)*</font>sprite<font color="#000080">.</font>a<font color="#000080">]:=</font>GetPoint<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ------------------------------------------------------------------------ }

</i></font><font color="#FF0000"><b>Function </b></font>InitSysFont<font color="#000080">;
</font><font color="#008000"><i>{    Job : allocate buffer and fill it with char bitmaps                  }
{          here using copy of BIOS standart first 128 ASCII chars         }
{  Input : cb, cf - colors of background and foreground of chars          }
{ Output : error code, 0 if Ok                                            }
</i></font><font color="#FF0000"><b>const
  </b></font>fs <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1023</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">=
          (  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">129</font><font color="#000080">,</font><font color="#800000">165</font><font color="#000080">,</font><font color="#800000">129</font><font color="#000080">,</font><font color="#800000">189</font><font color="#000080">,</font><font color="#800000">153</font><font color="#000080">,</font><font color="#800000">129</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,
           </font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">219</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">195</font><font color="#000080">,</font><font color="#800000">231</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,
            </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">231</font><font color="#000080">,</font><font color="#800000">195</font><font color="#000080">,</font><font color="#800000">195</font><font color="#000080">,</font><font color="#800000">231</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">66</font><font color="#000080">, </font><font color="#800000">66</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">195</font><font color="#000080">,</font><font color="#800000">153</font><font color="#000080">,</font><font color="#800000">189</font><font color="#000080">,</font><font color="#800000">189</font><font color="#000080">,</font><font color="#800000">153</font><font color="#000080">,</font><font color="#800000">195</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">,  </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">125</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,
            </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">63</font><font color="#000080">, </font><font color="#800000">51</font><font color="#000080">, </font><font color="#800000">63</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">112</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,
           </font><font color="#800000">127</font><font color="#000080">, </font><font color="#800000">99</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">, </font><font color="#800000">99</font><font color="#000080">, </font><font color="#800000">99</font><font color="#000080">,</font><font color="#800000">103</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">153</font><font color="#000080">, </font><font color="#800000">90</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">231</font><font color="#000080">,</font><font color="#800000">231</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">90</font><font color="#000080">,</font><font color="#800000">153</font><font color="#000080">,
           </font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">14</font><font color="#000080">, </font><font color="#800000">62</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">, </font><font color="#800000">62</font><font color="#000080">, </font><font color="#800000">14</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">219</font><font color="#000080">,</font><font color="#800000">219</font><font color="#000080">,</font><font color="#800000">123</font><font color="#000080">, </font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">27</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">62</font><font color="#000080">, </font><font color="#800000">99</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,
            </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">36</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">36</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">206</font><font color="#000080">,</font><font color="#800000">222</font><font color="#000080">,</font><font color="#800000">246</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">112</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">28</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">112</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,
            </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">222</font><font color="#000080">,</font><font color="#800000">222</font><font color="#000080">,</font><font color="#800000">222</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">206</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">62</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">30</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">238</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">214</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,</font><font color="#800000">246</font><font color="#000080">,</font><font color="#800000">222</font><font color="#000080">,</font><font color="#800000">206</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">112</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">252</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">214</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">238</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">254</font><font color="#000080">,  </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">192</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,  </font><font color="#800000">6</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,
            </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">28</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,
           </font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">112</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">12</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">112</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">214</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">52</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">214</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,
             </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">152</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">100</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
            </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
           </font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">,</font>v <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>sysfont <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>maxavail <font color="#000080">&lt; </font>sizeof<font color="#000080">(</font>TFontBuffer<font color="#000080">) </font><font color="#FF0000"><b>then begin
    </b></font>InitSysFont<font color="#000080">:=</font>VGA_NoMemory<font color="#000080">; </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>new<font color="#000080">(</font>sysfont<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">127 </font><font color="#FF0000"><b>do begin                          </b></font><font color="#008000"><i>{ symbol count }
    </i></font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do begin                          </b></font><font color="#008000"><i>{ byte   count(line) }
      </i></font><font color="#FF0000"><b>for </b></font>k<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do begin                        </b></font><font color="#008000"><i>{ bit    count(column) }
        {v:=($80 shr k) and (mem[$F000:$FA6E+i*8+j]);}
        </i></font>v<font color="#000080">:=(</font><font color="#800000">$80 </font><font color="#FF0000"><b>shr </b></font>k<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>fs<font color="#000080">[</font>i<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">+</font>j<font color="#000080">];
        </font><font color="#FF0000"><b>if </b></font>v <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>sysfont<font color="#000080">^[</font>i<font color="#000080">*</font><font color="#800000">64</font><font color="#000080">+</font>j<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">+</font>k<font color="#000080">]:=</font>cf
                 <font color="#FF0000"><b>else </b></font>sysfont<font color="#000080">^[</font>i<font color="#000080">*</font><font color="#800000">64</font><font color="#000080">+</font>j<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">+</font>k<font color="#000080">]:=</font>cb<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>InitSysFont<font color="#000080">:=</font>VGA_Ok<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DoneSysFont<font color="#000080">;
</font><font color="#008000"><i>{    Job : deallocate system bitmap font buffer                           }
{  Input : none                                                           }
{ Output : none                                                           }
</i></font><font color="#FF0000"><b>begin
  if </b></font>sysfont <font color="#000080">= </font><font color="#FF0000"><b>NIL then </b></font>exit<font color="#000080">;
  </font>dispose<font color="#000080">(</font>sysfont<font color="#000080">); </font>sysfont<font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TextOut<font color="#000080">;   </font><font color="#008000"><i>{ * needs addon clipping * }
{    Job : writing string out to screen/dble-buffer ( without cliping ) }
{  Input : x, y - position of left top corner of string; st - string    }
{ Output : none                                                         }
</i></font><font color="#FF0000"><b>var </b></font>size <font color="#000080">: </font>word<font color="#000080">; </font>lineptr <font color="#000080">: </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>sysfont <font color="#000080">= </font><font color="#FF0000"><b>NIL then begin </b></font>exit<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>size<font color="#000080">:=</font>length<font color="#000080">(</font>st<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>size <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font>lineptr<font color="#000080">:=</font>addr<font color="#000080">(</font>st<font color="#000080">);
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">push ds
    les di, dbuffer
    mov ax, y
    mov bx, ax             </font><font color="#008000"><i>{ copy y to bx }
    </i></font><font color="#FF00FF">sal ax, 6              </font><font color="#008000"><i>{ shift equal mult on 32 }
    </i></font><font color="#FF00FF">sal bx, 8              </font><font color="#008000"><i>{ shift equal mult on 256 }
    </i></font><font color="#FF00FF">add ax, bx             </font><font color="#008000"><i>{ equal mult on 320 (with shifts) }
    </i></font><font color="#FF00FF">mov bx, x
    add ax, bx
    add di, ax             </font><font color="#008000"><i>{ es:di - screen position }
    </i></font><font color="#FF00FF">lds si, sysfont
    mov dx, 1              </font><font color="#008000"><i>{ current char }
    </i></font><font color="#FF00FF">mov cx, size
    @char:
      push es
      push di
      les di, lineptr
      add di, dx
      inc dx
      xor ax, ax
      mov al, es:[di]
      and al, $7F
      sal ax, 6
      mov bx, ax
      pop di
      pop es
      push cx
      mov cx, 8
        @col:
        push cx
        mov cx, 8
          @row:
          mov al, ds:[si+bx] </font><font color="#008000"><i>{ ds:si points to 64 bytes of char in font }
          </i></font><font color="#FF00FF">cmp al, 0
          jz @skip_transparent
          mov es:[di], al
          @skip_transparent:
          inc si
        inc di
      loop @row
      pop cx
      add di, 312
    loop @col
    sub di, 2552
    sub si, 64
    pop cx
    loop @char
    pop ds
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ --------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Function  </b></font>GetVGAErrorMsg<font color="#000080">(</font>n<font color="#000080">:</font>integer<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#008000"><i>{    Job : return text message of VGA error                             }
{  Input : n - error code                                               }
{ Output : string with error message                                    }
</i></font><font color="#FF0000"><b>var </b></font>msg <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  case </b></font>n <font color="#FF0000"><b>of
    </b></font>VGA_Ok         <font color="#000080">: </font>msg<font color="#000080">:=</font><font color="#800000">'No errors'</font><font color="#000080">;
    </font>VGA_NoMemory   <font color="#000080">: </font>msg<font color="#000080">:=</font><font color="#800000">'Out of memory'</font><font color="#000080">;
    </font>VGA_IOError    <font color="#000080">: </font>msg<font color="#000080">:=</font><font color="#800000">'IO error'</font><font color="#000080">;
    </font>VGA_NoFile     <font color="#000080">: </font>msg<font color="#000080">:=</font><font color="#800000">'File not exists'</font><font color="#000080">;
    </font>VGA_BadVersion <font color="#000080">: </font>msg<font color="#000080">:=</font><font color="#800000">'Version unsupported'</font><font color="#000080">;
    </font>VGA_BadFormat  <font color="#000080">: </font>msg<font color="#000080">:=</font><font color="#800000">'Incorrect file format'</font><font color="#000080">;
  </font><font color="#FF0000"><b>else
    </b></font>msg<font color="#000080">:=</font><font color="#800000">'Undefined error'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>GetVGAErrorMsg<font color="#000080">:=</font>msg<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>sysfont<font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
  </font><font color="#008000"><i>{$IFDEF DPMI}
    </i></font>dbuffer<font color="#000080">:=</font>ptr<font color="#000080">(</font>SegA000<font color="#000080">,</font><font color="#800000">$0000</font><font color="#000080">);
    </font>vbuffer<font color="#000080">:=</font>ptr<font color="#000080">(</font>SegA000<font color="#000080">,</font><font color="#800000">$0000</font><font color="#000080">);
  </font><font color="#008000"><i>{$ELSE}
    </i></font>dbuffer<font color="#000080">:=</font>ptr<font color="#000080">(</font><font color="#800000">$A000</font><font color="#000080">,</font><font color="#800000">$0000</font><font color="#000080">);
    </font>vbuffer<font color="#000080">:=</font>ptr<font color="#000080">(</font><font color="#800000">$A000</font><font color="#000080">,</font><font color="#800000">$0000</font><font color="#000080">);
  </font><font color="#008000"><i>{$ENDIF}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ---x---x---x---x---x---x---x--- Cut here ---x---x---x---x---x---x---x--- }

{ Move that part into VB30.ASM and assemble it with TASM  }

</i></font><font color="#000080">.</font>MODEL MEDIUM

EXTRN vbuffer<font color="#000080">:</font>DWORD
EXTRN dbuffer<font color="#000080">:</font>DWORD

<font color="#FF0000"><b>PUBLIC </b></font>ClearDBuffer32
<font color="#FF0000"><b>PUBLIC </b></font>ClearVBuffer32
<font color="#FF0000"><b>PUBLIC </b></font>ShowBuffer32

<font color="#000080">.</font>CODE
<font color="#000080">.</font><font color="#800000">386

</font>ClearDBuffer32 PROC <font color="#FF0000"><b>FAR
  </b></font>cld
  les di<font color="#000080">, </font>dbuffer
  mov cx<font color="#000080">, </font><font color="#800000">16000
  </font><font color="#FF0000"><b>xor </b></font>eax<font color="#000080">, </font>eax
  rep stosd
  ret
ClearDBuffer32 ENDP

ClearVBuffer32 PROC <font color="#FF0000"><b>FAR
  </b></font>cld
  les di<font color="#000080">, </font>vbuffer
  mov cx<font color="#000080">, </font><font color="#800000">16000
  </font><font color="#FF0000"><b>xor </b></font>eax<font color="#000080">, </font>eax
  rep stosd
  ret
ClearVBuffer32 ENDP

ShowBuffer32 PROC <font color="#FF0000"><b>FAR
  </b></font>push ds
  cld
  les di<font color="#000080">, </font>vbuffer
  lds si<font color="#000080">, </font>dbuffer
  mov cx<font color="#000080">, </font><font color="#800000">16000
  </font>rep movsd
  pop ds
  ret
ShowBuffer32 ENDP

<font color="#FF0000"><b>END

</b></font><font color="#008000"><i>{ End of VB30.ASM file }

{ ---x---x---x---x---x---x---x--- Cut here ---x---x---x---x---x---x---x--- }

{ there are 8x8 chars, image from BIOS first 128 chars           }
{ every char coded by 8 bytes, every bit in byte is point in row }

{   bits : 7 6 5 4 3 2 1 0                                       }
{ byte 0  [#|#|#|#|#|#| | ]  = 1111 1100 = $FC = 252             }
{ byte 1  [ |#|#| | |#|#| ]  = 0110 0110 = $66 = 102             }
{ byte 2  [ |#|#| | |#|#| ]  = 0110 0110 = $66 = 102             }
{ byte 3  [ |#|#|#|#|#| | ]  = 0111 1100 = $7C = 124             }
{ byte 4  [ |#|#| | |#|#| ]  = 0110 0110 = $66 = 102             }
{ byte 5  [ |#|#| | |#|#| ]  = 0110 0110 = $66 = 102             }
{ byte 6  [#|#|#|#|#|#| | ]  = 1111 1100 = $FC = 252             }
{ byte 7  [ | | | | | | | ]  = 0000 0000 = $00 =   0             }

</i></font><font color="#FF0000"><b>const
  </b></font>fs <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1023</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">=
  (  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">129</font><font color="#000080">,</font><font color="#800000">165</font><font color="#000080">,</font><font color="#800000">129</font><font color="#000080">,</font><font color="#800000">189</font><font color="#000080">,</font><font color="#800000">153</font><font color="#000080">,</font><font color="#800000">129</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,
   </font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">219</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">195</font><font color="#000080">,</font><font color="#800000">231</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,
    </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">231</font><font color="#000080">,</font><font color="#800000">195</font><font color="#000080">,</font><font color="#800000">195</font><font color="#000080">,</font><font color="#800000">231</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">66</font><font color="#000080">, </font><font color="#800000">66</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">195</font><font color="#000080">,</font><font color="#800000">153</font><font color="#000080">,</font><font color="#800000">189</font><font color="#000080">,</font><font color="#800000">189</font><font color="#000080">,</font><font color="#800000">153</font><font color="#000080">,</font><font color="#800000">195</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">,  </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">125</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,
    </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">63</font><font color="#000080">, </font><font color="#800000">51</font><font color="#000080">, </font><font color="#800000">63</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">112</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,
   </font><font color="#800000">127</font><font color="#000080">, </font><font color="#800000">99</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">, </font><font color="#800000">99</font><font color="#000080">, </font><font color="#800000">99</font><font color="#000080">,</font><font color="#800000">103</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">153</font><font color="#000080">, </font><font color="#800000">90</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">231</font><font color="#000080">,</font><font color="#800000">231</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">90</font><font color="#000080">,</font><font color="#800000">153</font><font color="#000080">,
   </font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">14</font><font color="#000080">, </font><font color="#800000">62</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">, </font><font color="#800000">62</font><font color="#000080">, </font><font color="#800000">14</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">219</font><font color="#000080">,</font><font color="#800000">219</font><font color="#000080">,</font><font color="#800000">123</font><font color="#000080">, </font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">27</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">62</font><font color="#000080">, </font><font color="#800000">99</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,
    </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">36</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">36</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">206</font><font color="#000080">,</font><font color="#800000">222</font><font color="#000080">,</font><font color="#800000">246</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">112</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">28</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">112</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,
    </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">222</font><font color="#000080">,</font><font color="#800000">222</font><font color="#000080">,</font><font color="#800000">222</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">126</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">206</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">62</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">30</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">126</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">238</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">214</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,</font><font color="#800000">246</font><font color="#000080">,</font><font color="#800000">222</font><font color="#000080">,</font><font color="#800000">206</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">112</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">252</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">214</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">238</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">254</font><font color="#000080">,  </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">192</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,  </font><font color="#800000">6</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,
    </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">28</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,
   </font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">112</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">12</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">230</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">112</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">214</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">52</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">118</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">214</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">204</font><font color="#000080">,</font><font color="#800000">124</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,
     </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,</font><font color="#800000">152</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">100</font><font color="#000080">,</font><font color="#800000">252</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
   </font><font color="#800000">118</font><font color="#000080">,</font><font color="#800000">220</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">,</font><font color="#800000">108</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">198</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">);

</font><font color="#008000"><i>{ End of char fonts }

{ ---x---x---x---x---x---x---x--- Cut here ---x---x---x---x---x---x---x--- }

{ the following contains additional files that should be included with this
  file.  To extract, you need XX3402 available with the SWAG distribution.

  1.     Cut the text below out, and save to a file  ..  filename.xx
  2.     Use XX3402  :   xx3402 d filename.xx
  3.     The decoded file should be created in the same directory.
  4.     If the file is a archive file, use the proper archive program to
         extract the members.

{ ------------------            CUT              ----------------------}

{ ----------------------------  OBJ NEEDED FOR THIS UNIT --------------------- }


</i></font><font color="#000080">*</font>XX3402<font color="#000080">-</font><font color="#800000">000335</font><font color="#000080">-</font><font color="#800000">170197</font><font color="#000080">--</font><font color="#800000">72</font><font color="#000080">--</font><font color="#800000">85</font><font color="#000080">-</font><font color="#800000">61511</font><font color="#000080">--------</font>VB30<font color="#000080">.</font>OBJ<font color="#000080">--</font><font color="#800000">1</font><font color="#000080">-</font><font color="#FF0000"><b>OF</b></font><font color="#000080">--</font><font color="#800000">1
</font>U<font color="#000080">+</font>c<font color="#000080">+</font><font color="#800000">05</font>NWAn<font color="#000080">+</font>iMLBhl6UU<font color="#000080">++++</font><font color="#800000">53</font>FpQa7j623nQqJhMalZQW<font color="#000080">+</font>UJaJmQqZjPW<font color="#000080">+</font>n9X8NW<font color="#000080">-++</font>ECZ1
crcX05NWAn<font color="#000080">+</font>iMLBh0cU1<font color="#000080">+</font><font color="#800000">21</font>dH7M0<font color="#000080">++-</font>cW<font color="#000080">+</font>A<font color="#000080">+</font>E84IZV<font color="#000080">++</font><font color="#800000">0</font>JN0An<font color="#000080">-</font>TJ2JMJ<font color="#000080">+</font>F1HoF3YtU5<font color="#000080">+</font><font color="#800000">2</font>Uk
<font color="#000080">++</font><font color="#800000">61</font><font color="#000080">+</font>SCK1<font color="#000080">++</font><font color="#800000">3</font>LoF<font color="#000080">-</font>J222F23IEQ8M<font color="#000080">-</font>k<font color="#000080">-</font><font color="#800000">6</font><font color="#000080">+++</font><font color="#800000">2</font><font color="#000080">-</font>E2DZUU<font color="#000080">+-</font>YF5IYxJI6iO<font color="#000080">-++</font><font color="#800000">4</font>zk7PX<font color="#000080">-</font>A<font color="#000080">+-</font>pN0
JIN4FJ6<font color="#000080">+-</font>oF0JIN4FJ6<font color="#000080">+</font>FN<font color="#000080">+</font>J<font color="#000080">+++-</font><font color="#800000">1</font>YBAFI3GF27JFYN3IXAm<font color="#000080">++++</font>Ud<font color="#000080">+</font>J<font color="#000080">+++-</font><font color="#800000">1</font>YBAFI3GJY7J
FYN3IXAm1k<font color="#000080">++</font>MN<font color="#000080">+</font>H<font color="#000080">+++-</font><font color="#800000">13</font>B6HpR0JIN4FJ6nAVs<font color="#000080">++</font>B86<font color="#000080">-+-+</font>cU4Fc1E<font color="#000080">++</font>E<font color="#000080">++</font>zAEy<font color="#000080">++</font><font color="#800000">0</font>tU1ta
Aw1nNej9zAEy<font color="#000080">++</font><font color="#800000">0</font>tU1taAw1nNej95jn2DU<font color="#000080">++</font>lHM<font color="#000080">++</font><font color="#800000">9</font>a<font color="#000080">+</font>DjBadFz9StkF<font color="#000080">+</font>AE1JU922ZM<font color="#000080">-</font>l07K
<font color="#000080">+</font>QEaJU86WU6<font color="#000080">++</font><font color="#800000">5E</font><font color="#000080">+
***** </font><font color="#FF0000"><b>END OF </b></font>BLOCK <font color="#800000">1 </font><font color="#000080">*****


</font><font color="#008000"><i>{ ----------------------------  ASM MODULE --------------------- }
</i></font><font color="#000080">.</font>MODEL MEDIUM

EXTRN vbuffer<font color="#000080">:</font>DWORD
EXTRN dbuffer<font color="#000080">:</font>DWORD

<font color="#FF0000"><b>PUBLIC </b></font>ClearDBuffer32
<font color="#FF0000"><b>PUBLIC </b></font>ClearVBuffer32
<font color="#FF0000"><b>PUBLIC </b></font>ShowBuffer32

<font color="#000080">.</font>CODE
<font color="#000080">.</font><font color="#800000">386

</font>ClearDBuffer32 PROC <font color="#FF0000"><b>FAR
  </b></font>cld
  les di<font color="#000080">, </font>dbuffer
  mov cx<font color="#000080">, </font><font color="#800000">16000
  </font><font color="#FF0000"><b>xor </b></font>eax<font color="#000080">, </font>eax
  rep stosd
  ret
ClearDBuffer32 ENDP

ClearVBuffer32 PROC <font color="#FF0000"><b>FAR
  </b></font>cld
  les di<font color="#000080">, </font>vbuffer
  mov cx<font color="#000080">, </font><font color="#800000">16000
  </font><font color="#FF0000"><b>xor </b></font>eax<font color="#000080">, </font>eax
  rep stosd
  ret
ClearVBuffer32 ENDP

ShowBuffer32 PROC <font color="#FF0000"><b>FAR
  </b></font>push ds
  cld
  les di<font color="#000080">, </font>vbuffer
  lds si<font color="#000080">, </font>dbuffer
  mov cx<font color="#000080">, </font><font color="#800000">16000
  </font>rep movsd
  pop ds
  ret
ShowBuffer32 ENDP

<font color="#FF0000"><b>END</b></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0289.PAS">Original</a><b>]</b></p></body>
</html>
