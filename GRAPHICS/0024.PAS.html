<html>
<head><title> "Rotate PIC" by WILLIAM SITCH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
WILLIAM SITCH

&gt; I've been trying For some time to get a Pascal
&gt; Procedure that can SCALE and/or ROTATE Graphic images. if
&gt; anyone has any idea how to do this, or has a source code,
&gt; PLEEEAASSEE drop me a line.. THANK YOU!

Here is some code to rotate an image (in MCGA screen mode $13) ... but it has a
few drawbacks... its kinda slow and the image falls apart during rotation... it
hasn't been tested fully either...
}

</i></font><font color="#FF0000"><b>Procedure </b></font>rotate<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">, </font>x2<font color="#000080">, </font>y2 <font color="#000080">: </font>Word<font color="#000080">; </font>ang<font color="#000080">, </font>ainc <font color="#000080">: </font>Real<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>ca<font color="#000080">, </font>sa <font color="#000080">:  </font>Real<font color="#000080">;
  </font>cx<font color="#000080">, </font>cy <font color="#000080">:  </font>Real<font color="#000080">;
  </font>dx<font color="#000080">, </font>dy <font color="#000080">:  </font>Real<font color="#000080">;
  </font>h<font color="#000080">, </font>i<font color="#000080">,
  </font>j<font color="#000080">, </font>k   <font color="#000080">:  </font>Word<font color="#000080">;

  </font>pinf   <font color="#000080">:  </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12500</font><font color="#000080">] </font><font color="#FF0000"><b>of Record
    </b></font>x<font color="#000080">, </font>y <font color="#000080">:  </font>Word<font color="#000080">;
    </font>col  <font color="#000080">:  </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ca <font color="#000080">:= </font>cos<font color="#000080">((</font>ainc <font color="#000080">/ </font><font color="#800000">180</font><font color="#000080">) * </font>pi<font color="#000080">);
  </font>sa <font color="#000080">:= </font>sin<font color="#000080">((</font>ainc <font color="#000080">/ </font><font color="#800000">180</font><font color="#000080">) * </font>pi<font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>h <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>round<font color="#000080">(</font>ang <font color="#000080">/ </font>ainc<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>k  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>cx <font color="#000080">:= </font>x1 <font color="#000080">+ ((</font>x2 <font color="#000080">- </font>x1<font color="#000080">) / </font><font color="#800000">2</font><font color="#000080">);
    </font>cy <font color="#000080">:= </font>y1 <font color="#000080">+ ((</font>y2 <font color="#000080">- </font>y1<font color="#000080">) / </font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font>x1 <font color="#FF0000"><b>to </b></font>x2 <font color="#FF0000"><b>do
      For </b></font>j <font color="#000080">:= </font>y1 <font color="#FF0000"><b>to </b></font>y2 <font color="#FF0000"><b>do
      begin
        </b></font>inc<font color="#000080">(</font>k<font color="#000080">);

        </font>dx <font color="#000080">:= </font>cx <font color="#000080">+ (((</font>i <font color="#000080">- </font>cx<font color="#000080">) * </font>ca<font color="#000080">) - ((</font>j <font color="#000080">- </font>cy<font color="#000080">) * </font>sa<font color="#000080">));
        </font>dy <font color="#000080">:= </font>cy <font color="#000080">+ (((</font>i <font color="#000080">- </font>cx<font color="#000080">) * </font>sa<font color="#000080">) + ((</font>j <font color="#000080">- </font>cy<font color="#000080">) * </font>ca<font color="#000080">));

        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>round<font color="#000080">(</font>dx<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>round<font color="#000080">(</font>dy<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and
           </b></font><font color="#000080">(</font>round<font color="#000080">(</font>dx<font color="#000080">) &lt; </font><font color="#800000">65000</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>round<font color="#000080">(</font>dy<font color="#000080">) &lt; </font><font color="#800000">65000</font><font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          </b></font>pinf<font color="#000080">[</font>k<font color="#000080">].</font>x   <font color="#000080">:= </font>round<font color="#000080">(</font>dx<font color="#000080">);
          </font>pinf<font color="#000080">[</font>k<font color="#000080">].</font>y   <font color="#000080">:= </font>round<font color="#000080">(</font>dy<font color="#000080">);
          </font>pinf<font color="#000080">[</font>k<font color="#000080">].</font>col <font color="#000080">:= </font>mem<font color="#000080">[</font><font color="#800000">$A000 </font><font color="#000080">: </font>j <font color="#000080">* </font><font color="#800000">320 </font><font color="#000080">+ </font>i<font color="#000080">];
        </font><font color="#FF0000"><b>end
        else
        begin
          </b></font>pinf<font color="#000080">[</font>k<font color="#000080">].</font>x   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>pinf<font color="#000080">[</font>k<font color="#000080">].</font>y   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>pinf<font color="#000080">[</font>k<font color="#000080">].</font>col <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font>x1 <font color="#FF0000"><b>to </b></font>x2 <font color="#FF0000"><b>do
        For </b></font>j <font color="#000080">:= </font>y1 <font color="#FF0000"><b>to </b></font>y2 <font color="#FF0000"><b>do
          </b></font>mem<font color="#000080">[</font><font color="#800000">$A000 </font><font color="#000080">: </font>j <font color="#000080">* </font><font color="#800000">320 </font><font color="#000080">+ </font>i<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;

      </font>x1 <font color="#000080">:= </font><font color="#800000">320</font><font color="#000080">;
      </font>x2 <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>y1 <font color="#000080">:= </font><font color="#800000">200</font><font color="#000080">;
      </font>y2 <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>k <font color="#FF0000"><b>do
      begin
        if </b></font><font color="#000080">(</font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>x <font color="#000080">&lt; </font>x1<font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>x1 <font color="#000080">:= </font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>x<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>x <font color="#000080">&gt; </font>x2<font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>x2 <font color="#000080">:= </font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>x<font color="#000080">;

        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>y <font color="#000080">&lt; </font>y1<font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>y1 <font color="#000080">:= </font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>y<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>y <font color="#000080">&gt; </font>y2<font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>y2 <font color="#000080">:= </font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>y<font color="#000080">;

        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>x <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>y <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>mem<font color="#000080">[</font><font color="#800000">$A000 </font><font color="#000080">: </font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>y <font color="#000080">* </font><font color="#800000">320 </font><font color="#000080">+ </font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>x<font color="#000080">] := </font>pinf<font color="#000080">[</font>i<font color="#000080">].</font>col<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
It works, but DON'T try to use it For a main module or base a Program AROUND
it... instead try to change it to suit your needs, as right now it's kinda
optimized For my needs...

Sorry For not editing it to work With any screen mode, but I just don't have
the time.  MCGA memory is a linear block of Bytes, and you can access it using:
mem[$A000:offset].  So to find the color at screen position 10,10, you would
go:

mem[$A000 : y * 320 + x]
          ^     ^     ^-- x val, 10
          |     |----- screenwidth
          |-------- y val, 10
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p></body>
</html>
