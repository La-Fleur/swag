<html>
<head><title> "VGA256 Unit" by BERNIE PALLEK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0050.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I'm using 320x200x256.  I use mainly assembly to do my procedures and
&gt; function in this library... but I can't manage to figure out a way to do
&gt; GET and PUTs ... have ny Idea how to do it?  And yes, if you have any nice
&gt; graphic procedures/functions, well, I'm interrested...

Ok, if you want, I can post a bitmap scaler I got from Sean Palmer... it's in
assembler, so it's fast, and you could use it just like put, except it doesn't
do &quot;transparency.&quot;  If I ever figure out how to do it, I'll modify it and post
it.  But for now, here are some other routines for mode 13h:
}

</i></font><font color="#FF0000"><b>TYPE
  </b></font>RGBPalette <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">767</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetVideoMode<font color="#000080">(</font>desiredVideoMode <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN ASM </b></font><font color="#FF00FF">MOV AH,0; MOV AL,desiredVideoMode; INT $10; </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetPixel<font color="#000080">(</font>pix2get_x<font color="#000080">, </font>pix2get_y <font color="#000080">: </font>Word<font color="#000080">) : </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN </b></font>GetPixel <font color="#000080">:= </font>Mem<font color="#000080">[</font><font color="#800000">$A000 </font><font color="#000080">: </font>pix2get_y <font color="#000080">* </font><font color="#800000">320 </font><font color="#000080">+ </font>pix2get_x<font color="#000080">]; </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetPixel<font color="#000080">(</font>pix2set_x<font color="#000080">, </font>pix2set_y <font color="#000080">: </font>Word<font color="#000080">; </font>pix2set_c <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN </b></font>Mem<font color="#000080">[</font><font color="#800000">$A000 </font><font color="#000080">: </font>pix2set_y <font color="#000080">* </font><font color="#800000">320 </font><font color="#000080">+ </font>pix2set_x<font color="#000080">] := </font>pix2set_c<font color="#000080">; </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Ellipse<font color="#000080">(</font>exc<font color="#000080">, </font>eyc<font color="#000080">, </font>ea<font color="#000080">, </font>eb <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>elx<font color="#000080">, </font>ely <font color="#000080">: </font>Integer<font color="#000080">;
  </font>aa<font color="#000080">, </font>aa2<font color="#000080">, </font>bb<font color="#000080">, </font>bb2<font color="#000080">, </font>d<font color="#000080">, </font>dx<font color="#000080">, </font>dy <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>elx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>ely<font color="#000080">:=</font>eb<font color="#000080">; </font>aa<font color="#000080">:=</font>LongInt<font color="#000080">(</font>ea<font color="#000080">)*</font>ea<font color="#000080">; </font>aa2<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">*</font>aa<font color="#000080">;
  </font>bb<font color="#000080">:=</font>LongInt<font color="#000080">(</font>eb<font color="#000080">)*</font>eb<font color="#000080">; </font>bb2<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">*</font>bb<font color="#000080">;
  </font>d<font color="#000080">:=</font>bb<font color="#000080">-</font>aa<font color="#000080">*</font>eb<font color="#000080">+</font>aa <font color="#FF0000"><b>DIV </b></font><font color="#800000">4</font><font color="#000080">; </font>dx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>dy<font color="#000080">:=</font>aa2<font color="#000080">*</font>eb<font color="#000080">;
  </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">, </font>eyc<font color="#000080">-</font>ely<font color="#000080">, </font>Colour<font color="#000080">); </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">, </font>eyc<font color="#000080">+</font>ely<font color="#000080">, </font>Colour<font color="#000080">);
  </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">-</font>ea<font color="#000080">, </font>eyc<font color="#000080">, </font>Colour<font color="#000080">); </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">+</font>ea<font color="#000080">, </font>eyc<font color="#000080">, </font>Colour<font color="#000080">);
  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>dx <font color="#000080">&lt; </font>dy<font color="#000080">) </font><font color="#FF0000"><b>DO BEGIN
    IF </b></font><font color="#000080">(</font>d <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>Dec<font color="#000080">(</font>ely<font color="#000080">); </font>Dec<font color="#000080">(</font>dy<font color="#000080">, </font>aa2<font color="#000080">); </font>Dec<font color="#000080">(</font>d<font color="#000080">, </font>dy<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>Inc<font color="#000080">(</font>elx<font color="#000080">); </font>Inc<font color="#000080">(</font>dx<font color="#000080">, </font>bb2<font color="#000080">); </font>Inc<font color="#000080">(</font>d<font color="#000080">, </font>bb<font color="#000080">+</font>dx<font color="#000080">);
    </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">+</font>elx<font color="#000080">, </font>eyc<font color="#000080">+</font>ely<font color="#000080">, </font>Colour<font color="#000080">);
    </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">-</font>elx<font color="#000080">, </font>eyc<font color="#000080">+</font>ely<font color="#000080">, </font>Colour<font color="#000080">);
    </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">+</font>elx<font color="#000080">, </font>eyc<font color="#000080">-</font>ely<font color="#000080">, </font>Colour<font color="#000080">);
    </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">-</font>elx<font color="#000080">, </font>eyc<font color="#000080">-</font>ely<font color="#000080">, </font>Colour<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Inc<font color="#000080">(</font>d<font color="#000080">, (</font><font color="#800000">3</font><font color="#000080">*(</font>aa<font color="#000080">-</font>bb<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">-(</font>dx<font color="#000080">+</font>dy<font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>ely <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO BEGIN
    IF </b></font><font color="#000080">(</font>d <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>Inc<font color="#000080">(</font>elx<font color="#000080">); </font>Inc<font color="#000080">(</font>dx<font color="#000080">, </font>bb2<font color="#000080">); </font>Inc<font color="#000080">(</font>d<font color="#000080">, </font>bb <font color="#000080">+ </font>dx<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>Dec<font color="#000080">(</font>ely<font color="#000080">); </font>Dec<font color="#000080">(</font>dy<font color="#000080">, </font>aa2<font color="#000080">); </font>Inc<font color="#000080">(</font>d<font color="#000080">, </font>aa<font color="#000080">-</font>dy<font color="#000080">);
    </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">+</font>elx<font color="#000080">, </font>eyc<font color="#000080">+</font>ely<font color="#000080">, </font>Colour<font color="#000080">);
    </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">-</font>elx<font color="#000080">, </font>eyc<font color="#000080">+</font>ely<font color="#000080">, </font>Colour<font color="#000080">);
    </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">+</font>elx<font color="#000080">, </font>eyc<font color="#000080">-</font>ely<font color="#000080">, </font>Colour<font color="#000080">);
    </font>SetPixel<font color="#000080">(</font>exc<font color="#000080">-</font>elx<font color="#000080">, </font>eyc<font color="#000080">-</font>ely<font color="#000080">, </font>Colour<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ these routines have been &quot;compressed&quot; to take up less line space; I
  like spaces between addition, subtraction, etc, but I took them out
  to save space... you can add them again if you want }


</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Line<font color="#000080">(</font>lnx1<font color="#000080">, </font>lny1<font color="#000080">, </font>lnx2<font color="#000080">, </font>lny2 <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>lndd<font color="#000080">, </font>lndx<font color="#000080">, </font>lndy<font color="#000080">, </font>lnai<font color="#000080">, </font>lnbi<font color="#000080">, </font>lnxi<font color="#000080">, </font>lnyi <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>lnx1 <font color="#000080">&lt; </font>lnx2<font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN </b></font>lnxi<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">; </font>lndx<font color="#000080">:=</font>lnx2<font color="#000080">-</font>lnx1<font color="#000080">;
  </font><font color="#FF0000"><b>END ELSE BEGIN </b></font>lnxi <font color="#000080">:= (-</font><font color="#800000">1</font><font color="#000080">); </font>lndx<font color="#000080">:= </font>lnx1<font color="#000080">-</font>lnx2<font color="#000080">; </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>lny1 <font color="#000080">&lt; </font>lny2<font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN </b></font>lnyi<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">; </font>lndy<font color="#000080">:=</font>lny2<font color="#000080">-</font>lny1<font color="#000080">;
  </font><font color="#FF0000"><b>END ELSE BEGIN </b></font>lnyi <font color="#000080">:= (-</font><font color="#800000">1</font><font color="#000080">); </font>lndy<font color="#000080">:=</font>lny1<font color="#000080">-</font>lny2<font color="#000080">; </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>SetPixel<font color="#000080">(</font>lnx1<font color="#000080">, </font>lny1<font color="#000080">, </font>Colour<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>lndx <font color="#000080">&gt; </font>lndy<font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
    </b></font>lnai<font color="#000080">:=(</font>lndy<font color="#000080">-</font>lndx<font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">; </font>lnbi<font color="#000080">:=</font>lndy<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">; </font>lndd<font color="#000080">:=</font>lnbi<font color="#000080">-</font>lndx<font color="#000080">;
    </font><font color="#FF0000"><b>REPEAT
      IF </b></font><font color="#000080">(</font>lndd <font color="#000080">&gt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
        </b></font>Inc<font color="#000080">(</font>lny1<font color="#000080">, </font>lnyi<font color="#000080">);
        </font>Inc<font color="#000080">(</font>lndd<font color="#000080">, </font>lnai<font color="#000080">);
      </font><font color="#FF0000"><b>END ELSE </b></font>Inc<font color="#000080">(</font>lndd<font color="#000080">, </font>lnbi<font color="#000080">);
      </font>Inc<font color="#000080">(</font>lnx1<font color="#000080">, </font>lnxi<font color="#000080">);
      </font>SetPixel<font color="#000080">(</font>lnx1<font color="#000080">, </font>lny1<font color="#000080">, </font>Colour<font color="#000080">);
    </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>lnx1 <font color="#000080">= </font>lnx2<font color="#000080">);
  </font><font color="#FF0000"><b>END ELSE BEGIN
    </b></font>lnai <font color="#000080">:= (</font>lndx <font color="#000080">- </font>lndy<font color="#000080">) * </font><font color="#800000">2</font><font color="#000080">;
    </font>lnbi <font color="#000080">:= </font>lndx <font color="#000080">* </font><font color="#800000">2</font><font color="#000080">;
    </font>lndd <font color="#000080">:= </font>lnbi <font color="#000080">- </font>lndy<font color="#000080">;
    </font><font color="#FF0000"><b>REPEAT
      IF </b></font><font color="#000080">(</font>lndd <font color="#000080">&gt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
        </b></font>Inc<font color="#000080">(</font>lnx1<font color="#000080">, </font>lnxi<font color="#000080">);
        </font>Inc<font color="#000080">(</font>lndd<font color="#000080">, </font>lnai<font color="#000080">);
      </font><font color="#FF0000"><b>END ELSE </b></font>inc<font color="#000080">(</font>lndd<font color="#000080">, </font>lnbi<font color="#000080">);
      </font>Inc<font color="#000080">(</font>lny1<font color="#000080">, </font>lnyi<font color="#000080">);
      </font>SetPixel<font color="#000080">(</font>lnx1<font color="#000080">, </font>lny1<font color="#000080">, </font>Colour<font color="#000080">);
    </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>lny1 <font color="#000080">= </font>lny2<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>GetPalette<font color="#000080">(</font>index2get <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>r_inte<font color="#000080">, </font>g_inte<font color="#000080">, </font>b_inte <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#008000"><i>{ returns the r, g, and b values of a palette index }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Port<font color="#000080">[</font><font color="#800000">$3C7</font><font color="#000080">] := </font>index2get<font color="#000080">;
  </font>r_inte <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
  </font>g_inte <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
  </font>b_inte <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetPalette<font color="#000080">(</font>index2set<font color="#000080">, </font>r_inte<font color="#000080">, </font>g_inte<font color="#000080">, </font>b_inte <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#008000"><i>{ sets the r, g, and b values of a palette index }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Port<font color="#000080">[</font><font color="#800000">$3C8</font><font color="#000080">] := </font>index2set<font color="#000080">;
  </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>r_inte<font color="#000080">;
  </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>g_inte<font color="#000080">;
  </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>b_inte<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ oh, I'll give credit where credit is due: Sean Palmer supplied the
  Bresenham line and ellipse procedures }


</i></font><font color="#FF0000"><b>PROCEDURE </b></font>BurstSetPalette<font color="#000080">(</font>burstPalette <font color="#000080">: </font>RGBPalette<font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>burstCount <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Port<font color="#000080">[</font><font color="#800000">$3C8</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>burstCount <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">767 </font><font color="#FF0000"><b>DO </b></font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>burstPalette<font color="#000080">[</font>burstCount<font color="#000080">];
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>WaitForRetrace<font color="#000080">;
</font><font color="#008000"><i>{ waits for a vertical retrace to reduce flicker }
</i></font><font color="#FF0000"><b>BEGIN
     </b></font><font color="#008000"><i>(* REPEAT UNTIL (Port[$3DA] AND $08) = 0; *)
     { the above loop has been commented because it is only }
     { necessary to wait until a retrace is in progress }
     </i></font><font color="#FF0000"><b>REPEAT UNTIL </b></font><font color="#000080">(</font>Port<font color="#000080">[</font><font color="#800000">$3DA</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$08</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ClearScr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>FillChar<font color="#000080">(</font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font><font color="#800000">0000</font><font color="#000080">], </font><font color="#800000">64000</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetOverscan <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>tmpOverscanByte <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  ASM
    </b></font><font color="#FF00FF">MOV AX,$1008
    INT $10
    MOV tmpOverscanByte,BH
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>GetOverscan <font color="#000080">:= </font>tmpOverscanByte<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetOverscan<font color="#000080">(</font>borderColour <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  ASM
    </b></font><font color="#FF00FF">MOV AX,$1001
    MOV BH,borderColour
    INT $10
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{
Well, that's basically it, except for the bitmap scaler.  If you want it, let
me know if you can receive NetMail, and I'll send it that way; otherwise, I'll
post.  The last two procedures/functions have not been tested.  In fact, I
can't guarantee that any of the stuff will work.  But try it out...  :^)
C-YA.
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0050.PAS">Original</a><b>]</b></p></body>
</html>
