<html>
<head><title> "Ribbon scroll.." by GLEN JEH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0092.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{Ribbon scroller...programmed by Glen Jeh in Turbo Pascal 7.0, 4/24/94
 Use freely}

{$R+}
</i></font><font color="#FF0000"><b>program </b></font>RibbonScroll<font color="#000080">;  </font><font color="#008000"><i>{this is IT}
</i></font><font color="#FF0000"><b>uses </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

     </font><font color="#008000"><i>{ I turned on range checking to slow it down :) }

</i></font><font color="#FF0000"><b>const
  </b></font>YLocation <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;  </font><font color="#008000"><i>{position on the screen...}
  </i></font>Constant <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;     </font><font color="#008000"><i>{mess with this to use different parts of the curve}
  </i></font>Radius <font color="#000080">= </font><font color="#800000">30</font><font color="#000080">;      </font><font color="#008000"><i>{this is how big of a curve you want}
  </i></font>Width  <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;      </font><font color="#008000"><i>{wrong name..this is actually the waviness of the curve}
  </i></font>Spacing <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;      </font><font color="#008000"><i>{this is how fat the chars will be..or something}
  </i></font>Height <font color="#000080">= </font><font color="#800000">1.5</font><font color="#000080">;     </font><font color="#008000"><i>{this is how tall each character will be}
  </i></font>DispStr <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">= </font><font color="#800000">'Adjust the above constants &lt;WRAP&gt;...   '</font><font color="#000080">;

  </font>Rows   <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">; </font><font color="#008000"><i>{don't change this}

{testing}
</i></font><font color="#FF0000"><b>type
  </b></font>CharType <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
  </font>PathType <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">320 </font><font color="#FF0000"><b>div </b></font>Spacing<font color="#000080">] </font><font color="#FF0000"><b>of
    record
      </b></font>Pos <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{position in memory}
      </i></font><font color="#FF0000"><b>On  </b></font><font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#008000"><i>{on or off?}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font><font color="#008000"><i>{this keeps track of the Y-Pos of the dot at X}
</i></font><font color="#FF0000"><b>var
  </b></font>CharSet <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>CharType <font color="#FF0000"><b>absolute </b></font><font color="#800000">$F000</font><font color="#000080">:</font><font color="#800000">$FA6E</font><font color="#000080">;
  </font>PathArray <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Rows<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>PathType<font color="#000080">;
  </font>I<font color="#000080">,
  </font>I2<font color="#000080">,
  </font>DispLine <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>GetNext<font color="#000080">(</font>Row <font color="#000080">: </font>Integer<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>CharNum<font color="#000080">,
  </font>ColumnNum <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>CharNum <font color="#000080">:= </font>DispLine <font color="#FF0000"><b>div </b></font><font color="#800000">8 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>ColumnNum <font color="#000080">:= </font>DispLine <font color="#FF0000"><b>mod </b></font><font color="#800000">8 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>GetNext <font color="#000080">:= </font>CharSet<font color="#000080">[</font>Ord<font color="#000080">(</font>DispStr<font color="#000080">[</font>CharNum<font color="#000080">])][</font>Row<font color="#000080">] </font><font color="#FF0000"><b>shr </b></font><font color="#000080">(</font><font color="#800000">8 </font><font color="#000080">- </font>ColumnNum<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">1 </font><font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>F<font color="#000080">(</font>X<font color="#000080">:</font>Real<font color="#000080">): </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>F <font color="#000080">:= (</font>Sin <font color="#000080">((</font>X <font color="#000080">+ </font>Constant<font color="#000080">) / </font>Width<font color="#000080">) * </font>Radius <font color="#000080">+ </font>YLocation<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>Mode<font color="#000080">(</font>B <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>al <font color="#000080">:= </font>B<font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>BuildPath<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Rows <font color="#FF0000"><b>do
    for </b></font>I2 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">320 </font><font color="#FF0000"><b>div </b></font>Spacing <font color="#FF0000"><b>do
      begin
        </b></font>PathArray<font color="#000080">[</font>I<font color="#000080">][</font>I2<font color="#000080">].</font>Pos <font color="#000080">:= </font>Round<font color="#000080">(</font>F<font color="#000080">(</font>I2<font color="#000080">+</font>Height<font color="#000080">*</font>I<font color="#000080">));
          </font><font color="#008000"><i>{compute Y location first}

        </i></font>PathArray<font color="#000080">[</font>I<font color="#000080">][</font>I2<font color="#000080">].</font>Pos <font color="#000080">:=
          (</font>PathArray<font color="#000080">[</font>I<font color="#000080">][</font>I2<font color="#000080">].</font>Pos <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) * </font><font color="#800000">320 </font><font color="#000080">+ (</font>I2 <font color="#000080">* </font>Spacing<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">;
          </font><font color="#008000"><i>{compute memory location}
      </i></font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin
  </b></font>Mode<font color="#000080">(</font><font color="#800000">$13</font><font color="#000080">);
  </font>BuildPath<font color="#000080">;
  </font>DispLine <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    repeat until </b></font><font color="#000080">(</font>Port<font color="#000080">[</font><font color="#800000">$3DA</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$08</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do
      begin
        for </b></font>I2 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font><font color="#800000">320 </font><font color="#FF0000"><b>div </b></font>Spacing<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>do
          </b></font>PathArray<font color="#000080">[</font>I<font color="#000080">][</font>I2<font color="#000080">].</font><font color="#FF0000"><b>On </b></font><font color="#000080">:= </font>PathArray<font color="#000080">[</font>I<font color="#000080">][</font>I2 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">].</font><font color="#FF0000"><b>On</b></font><font color="#000080">;
        </font>PathArray<font color="#000080">[</font>I<font color="#000080">][</font><font color="#800000">320 </font><font color="#FF0000"><b>div </b></font>Spacing<font color="#000080">].</font><font color="#FF0000"><b>On </b></font><font color="#000080">:= </font>GetNext<font color="#000080">(</font>I<font color="#000080">);
        </font><font color="#FF0000"><b>for </b></font>I2 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">320 </font><font color="#FF0000"><b>div </b></font>Spacing <font color="#FF0000"><b>do
          if </b></font>PathArray<font color="#000080">[</font>I<font color="#000080">][</font>I2<font color="#000080">].</font><font color="#FF0000"><b>On then
            </b></font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>PathArray<font color="#000080">[</font>I<font color="#000080">][</font>I2<font color="#000080">].</font>Pos<font color="#000080">] := </font>I2 <font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">100 </font><font color="#000080">- </font><font color="#800000">50</font><font color="#000080">) + </font><font color="#800000">50
          </font><font color="#FF0000"><b>else
            </b></font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>PathArray<font color="#000080">[</font>I<font color="#000080">][</font>I2<font color="#000080">].</font>Pos<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Inc<font color="#000080">(</font>DispLine<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>DispLine <font color="#000080">= </font><font color="#800000">8 </font><font color="#000080">* </font>Length<font color="#000080">(</font>DispStr<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>DispLine <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>KeyPressed<font color="#000080">;
  </font>Mode<font color="#000080">(</font><font color="#800000">$3</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0092.PAS">Original</a><b>]</b></p></body>
</html>
