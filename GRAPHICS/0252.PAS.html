<html>
<head><title> "Dos Icon Viewer" by AVONTURE CHRISTOPHE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0252.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{

   Dos icon viewer


               &Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;
               &ordm;                                        &ordm;&deg;
               &ordm;          AVONTURE CHRISTOPHE           &ordm;&deg;
               &ordm;              AVC SOFTWARE              &ordm;&deg;
               &ordm;     BOULEVARD EDMOND MACHTENS 157/53   &ordm;&deg;
               &ordm;           B-1080 BRUXELLES             &ordm;&deg;
               &ordm;              BELGIQUE                  &ordm;&deg;
               &ordm;                                        &ordm;&deg;
               &Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;&deg;
               &deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;

}

</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>CONST
   </b></font>IcoSize <font color="#000080">= </font><font color="#800000">32</font><font color="#000080">;  </font><font color="#008000"><i>{ An icon is a 32*32 square }

</i></font><font color="#FF0000"><b>VAR
   </b></font>arrNom <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">]; </font><font color="#008000"><i>{ Store the full filename }

{ Display a pixel }

</i></font><font color="#FF0000"><b>Procedure </b></font>Put_Pixel <font color="#000080">(</font>Colonne<font color="#000080">, </font>Ligne<font color="#000080">, </font>Couleur <font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
     </b></font><font color="#FF00FF">Mov  Ah, 0Ch
     Mov  Al, Byte Ptr Couleur
     Mov  Cx, Colonne
     Mov  Dx, Ligne
     Xor  Bh, Bh
     Int  10h
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Display the given icon file to the given coordinates }

</i></font><font color="#FF0000"><b>Procedure </b></font>Show_Ico   <font color="#000080">(</font>sFileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>wColumn<font color="#000080">, </font>wLine <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#FF0000"><b>Type
   </b></font>TIconRec <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1023</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
   </font>TIcon    <font color="#000080">= ^</font>TIconRec<font color="#000080">;

</font><font color="#FF0000"><b>Var
   </b></font>Color    <font color="#000080">: </font>Byte<font color="#000080">;
   </font>fIcon    <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
   </font>I<font color="#000080">, </font>J     <font color="#000080">: </font>Word<font color="#000080">;
   </font>Icon     <font color="#000080">: </font>TIcon<font color="#000080">;

</font><font color="#FF0000"><b>Begin

   </b></font>Assign <font color="#000080">(</font>fIcon<font color="#000080">, </font>sFileName<font color="#000080">);
   </font>FileMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                           </font><font color="#008000"><i>{ Read only }
   </i></font>Reset  <font color="#000080">(</font>fIcon<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

   </font>GetMem <font color="#000080">(</font>Icon<font color="#000080">, </font><font color="#800000">1024</font><font color="#000080">);                    </font><font color="#008000"><i>{ Allocate memory for the icon }

   </i></font>BlockRead <font color="#000080">(</font>fIcon<font color="#000080">, </font>Icon<font color="#000080">^, </font><font color="#800000">126</font><font color="#000080">);

   </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">511 </font><font color="#FF0000"><b>Do                     </b></font><font color="#008000"><i>{ Process the icon file }
       </i></font><font color="#FF0000"><b>BEGIN
          </b></font>BlockRead <font color="#000080">(</font>fIcon<font color="#000080">, </font>Color<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
          </font>Icon<font color="#000080">^[</font>I <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">]       := </font>Color <font color="#FF0000"><b>Shr </b></font><font color="#800000">4</font><font color="#000080">;
          </font>Icon<font color="#000080">^[(</font>I <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">] := </font>Color <font color="#FF0000"><b>And </b></font><font color="#800000">$0F</font><font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font>Close <font color="#000080">(</font>fIcon<font color="#000080">);

   </font>wLine <font color="#000080">:= </font>wLine <font color="#000080">+ </font>icoSize<font color="#000080">;

   </font><font color="#008000"><i>{ Display the icon. }

   </i></font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">31 </font><font color="#FF0000"><b>Downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
       For </b></font>I <font color="#000080">:= </font><font color="#800000">31 </font><font color="#FF0000"><b>Downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
          </b></font>Put_Pixel <font color="#000080">(</font>wColumn<font color="#000080">+</font>I<font color="#000080">, </font>wLine<font color="#000080">-</font>J<font color="#000080">, </font>Icon<font color="#000080">^[</font>I<font color="#000080">+</font>J <font color="#FF0000"><b>Shl </b></font><font color="#800000">5</font><font color="#000080">]);

   </font>Release <font color="#000080">(</font>Icon<font color="#000080">);                          </font><font color="#008000"><i>{ Release icon memory }

</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Load all icon files present in the specified directory }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Load_Icons<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>DosFile    <font color="#000080">: </font>SearchRec<font color="#000080">;
   </font>OldX<font color="#000080">, </font>OldY <font color="#000080">: </font>Word<font color="#000080">;
   </font>I          <font color="#000080">: </font>Byte<font color="#000080">;
   </font>wPos       <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   </b></font>OldX <font color="#000080">:= </font>IcoSize<font color="#000080">; </font>OldY <font color="#000080">:= </font>IcoSize<font color="#000080">; </font>wPos <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

   </font>FindFirst <font color="#000080">(</font>Paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">'\*.Ico'</font><font color="#000080">, </font>AnyFile<font color="#000080">, </font>DosFile<font color="#000080">);

   </font><font color="#FF0000"><b>WHILE </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
      BEGIN

        </b></font><font color="#008000"><i>{ List all icon file and display it }

        </i></font>Inc <font color="#000080">(</font>wPos<font color="#000080">);

        </font>arrNom<font color="#000080">[</font>wPos<font color="#000080">] := </font>DosFile<font color="#000080">.</font>Name<font color="#000080">;

        </font>Show_Ico <font color="#000080">(</font>Paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">'\'</font><font color="#000080">+</font>DosFile<font color="#000080">.</font>Name<font color="#000080">, </font>OldX<font color="#000080">, </font>OldY<font color="#000080">);

        </font><font color="#008000"><i>{ Process the screen coordinates for the next icon }

        </i></font><font color="#FF0000"><b>IF </b></font>OldX <font color="#000080">&lt; (</font><font color="#800000">640</font><font color="#000080">-(</font>IcoSize <font color="#FF0000"><b>Shl </b></font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>THEN
           </b></font>OldX <font color="#000080">:= </font>OldX <font color="#000080">+ </font>IcoSize
        <font color="#FF0000"><b>ELSE
           BEGIN
              </b></font>OldX <font color="#000080">:= </font>IcoSize<font color="#000080">;
              </font>OldY <font color="#000080">:= </font>OldY <font color="#000080">+ </font>IcoSize<font color="#000080">;
           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

        </font><font color="#FF0000"><b>IF </b></font>OldY <font color="#000080">= </font><font color="#800000">14</font><font color="#000080">*</font>IcoSize <font color="#FF0000"><b>THEN
          BEGIN
             </b></font>OldX <font color="#000080">:= </font>IcoSize<font color="#000080">;
             </font>OldY <font color="#000080">:= </font>IcoSize<font color="#000080">;
             </font>ClrScr<font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

        </font>FindNext <font color="#000080">(</font>DosFile<font color="#000080">);

   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Main program }

</i></font><font color="#FF0000"><b>BEGIN

   </b></font>GotoXy <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
   </font>TextAttr <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
   </font>Write <font color="#000080">(</font><font color="#800000">'IconView (c) AVONTURE Christophe    February 1996'</font><font color="#000080">);

   </font><font color="#008000"><i>{ If a parameter is specified, supposed that this parameter is a path
     name and try to display all icon files present in this directory }

   </i></font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>ParamCount <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      BEGIN

         </b></font><font color="#008000"><i>{ Initialize graphic mode 640*480 256 colors }

         </i></font><font color="#FF0000"><b>Asm
            </b></font><font color="#FF00FF">Mov Ax, 0012h
            Int 10h
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

         </font>Load_Icons<font color="#000080">;

         </font>TextAttr <font color="#000080">:= </font><font color="#800000">15</font><font color="#000080">;

         </font><font color="#FF0000"><b>REPEAT UNTIL </b></font>KEYPRESSED<font color="#000080">; </font>READKEY<font color="#000080">;

         </font><font color="#008000"><i>{ Restore 80*25 255 colors screen mode }

         </i></font><font color="#FF0000"><b>Asm
            </b></font><font color="#FF00FF">Mov Ax, 0003h
            Int 10h
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

       </font><font color="#FF0000"><b>END
    ELSE
       BEGIN

           </b></font><font color="#008000"><i>{ No parameters has been given to the program.  So show a little
             help. }

           </i></font>WriteLN <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
           </font>WriteLN <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
           </font>WriteLN <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
           </font>WriteLN <font color="#000080">(</font><font color="#800000">'You must specify the path where ICO files are stored.'</font><font color="#000080">);
           </font>WriteLN <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
           </font>WriteLN <font color="#000080">(</font><font color="#800000">'For instance, ICO_VIEW C:\WINDOWS\SYSTEM. '</font><font color="#000080">);
           </font>WriteLN <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
           </font>WriteLN <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);

           </font><font color="#FF0000"><b>REPEAT UNTIL </b></font>KEYPRESSED<font color="#000080">; </font>READKEY<font color="#000080">;

       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0252.PAS">Original</a><b>]</b></p></body>
</html>
