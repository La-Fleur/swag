<html>
<head><title> "Bresnaham Circle Algorithm" by JASON RENNIE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0173.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I can't get the Graphics Programming thingy, so can you explain to
&gt; theory for making circles with the above algorithms?  Is it possible to for
&gt; the sines and cosines and use another method because anything with sines an
&gt; cosines (without a lookup table) would be too slow.

I can give you the Bresenham algorithm adapted to 320x200x256 mode.  The
Bresenham method is very quick and only uses integer math so there are no
complex math functions to slow it down.  Yet it still draws accurate circles.
This code has been tested, but there were a few things I had to modify, so I
can't guarantee it will work.  Mail me back if for some reason it doesn't.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>Circle<font color="#000080">(</font>Cx<font color="#000080">, </font>Cy<font color="#000080">, </font>y <font color="#000080">: </font>integer<font color="#000080">; </font>color <font color="#000080">: </font>byte<font color="#000080">);

</font><font color="#008000"><i>{ Draws circle with center (Cx, Cy) and radius y }
{ Bresenham's circle algorithm implemented }
{ Edge-of-screen clipping implemented }

</i></font><font color="#FF0000"><b>const              </b></font><font color="#008000"><i>{ various and sundry lookup tables for efficiency }
  </i></font>Change <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer <font color="#000080">=
    ((</font><font color="#800000">1</font><font color="#000080">-</font>SW<font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">-</font>SW<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">+</font>SW<font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">+</font>SW<font color="#000080">, </font>SW<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>SW<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, -</font>SW<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, -</font>SW<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">),
     (</font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, </font>SW<font color="#000080">, </font>SW<font color="#000080">, -</font>SW<font color="#000080">, -</font>SW<font color="#000080">));
  </font>ChangeY <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer <font color="#000080">=
    ((-</font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">),
     (</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">));
  </font>ChangeX <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer <font color="#000080">=
    ((</font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">),
     (</font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">));

</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>D<font color="#000080">, </font>x <font color="#000080">: </font>integer<font color="#000080">;  </font><font color="#008000"><i>{int i, D = 3 - (y &lt;&lt; 1);}
  </i></font>TempNeg <font color="#000080">: </font>Boolean<font color="#000080">;  </font><font color="#008000"><i>{int x, tempneg;}
  </i></font>RealX<font color="#000080">, </font>RealY <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;  </font><font color="#008000"><i>{int realx[8];}
                                          {int realy[8];}
  
  </i></font>TempAddr <font color="#000080">: </font>word<font color="#000080">;
  </font>Addr <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;  </font><font color="#008000"><i>{unsigned int tempaddr, addr[8];}
  </i></font>ch <font color="#000080">: </font>char<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>D <font color="#000080">:= </font><font color="#800000">3 </font><font color="#000080">- (</font>y <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">);                  </font><font color="#008000"><i>{ initialize decision variable }
  </i></font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do begin             </b></font><font color="#008000"><i>{ set up coordinates of symmetry }
    </i></font>RealX<font color="#000080">[</font>i<font color="#000080">] := </font>Cx<font color="#000080">;                    </font><font color="#008000"><i>{    ___    }
    </i></font>RealY<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">] := </font>Cy <font color="#FF0000"><b>end</b></font><font color="#000080">;              </font><font color="#008000"><i>{   /3\   }
  </i></font>RealX<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">] := </font>Cx<font color="#000080">+</font>y<font color="#000080">;                    </font><font color="#008000"><i>{  /7\|/6\  }
  </i></font>RealX<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] := </font>RealX<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">];                </font><font color="#008000"><i>{  |-----|  }
  </i></font>RealX<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">] := </font>Cx<font color="#000080">-</font>y<font color="#000080">;                    </font><font color="#008000"><i>{  \5/|\4/  }
  </i></font>RealX<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">] := </font>RealX<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">];                </font><font color="#008000"><i>{   \1/   }
  </i></font>RealY<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>Cy<font color="#000080">+</font>y<font color="#000080">;                    </font><font color="#008000"><i>{    ---    }
  </i></font>RealY<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>RealY<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
  </font>RealY<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>Cy<font color="#000080">-</font>y<font color="#000080">;
  </font>RealY<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>RealY<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];

  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do                   </b></font><font color="#008000"><i>{ set up coordinate addresses }
    </i></font>Addr<font color="#000080">[</font>i<font color="#000080">] := </font>RealX<font color="#000080">[</font>i<font color="#000080">] + </font>SW<font color="#000080">*</font>RealY<font color="#000080">[</font>i<font color="#000080">];

  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov ax, $A000
    mov es, ax                            </font><font color="#008000"><i>{ set up segment }
    </i></font><font color="#FF00FF">xor di, di
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>x <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                              </font><font color="#008000"><i>{ start with relative x = 0 }
  </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>x <font color="#000080">&lt;= </font>y<font color="#000080">) </font><font color="#FF0000"><b>do begin              </b></font><font color="#008000"><i>{ keep it up until octants meet }

    </i></font>TempNeg <font color="#000080">:= (</font>D <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">);                </font><font color="#008000"><i>{ is decision var negative? }
    </i></font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do begin           </b></font><font color="#008000"><i>{ process all eight pixels }

      </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>RealX<font color="#000080">[</font>i<font color="#000080">]&gt;=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>RealX<font color="#000080">[</font>i<font color="#000080">]&lt;=</font>XMax<font color="#000080">) </font><font color="#FF0000"><b>and           </b></font><font color="#008000"><i>{ clipping }
          </i></font><font color="#000080">(</font>RealY<font color="#000080">[</font>i<font color="#000080">]&gt;=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>RealY<font color="#000080">[</font>i<font color="#000080">]&lt;=</font>YMax<font color="#000080">)) </font><font color="#FF0000"><b>then begin
    </b></font>TempAddr <font color="#000080">:= </font>Addr<font color="#000080">[</font>i<font color="#000080">];           </font><font color="#008000"><i>{ temp var for asm compatibility }
    </i></font><font color="#FF0000"><b>asm                            </b></font><font color="#008000"><i>{ display pixel }
      </i></font><font color="#FF00FF">mov di, TempAddr
      mov bl, Color
      mov es:[di], bl
        </font><font color="#FF0000"><b>end end</b></font><font color="#000080">;

      </font>addr<font color="#000080">[</font>i<font color="#000080">] := </font>Addr<font color="#000080">[</font>i<font color="#000080">] + </font>change<font color="#000080">[</font>ord<font color="#000080">(</font>tempneg<font color="#000080">)][</font>i<font color="#000080">];        </font><font color="#008000"><i>{ update address }
      </i></font>realx<font color="#000080">[</font>i<font color="#000080">] := </font>RealX<font color="#000080">[</font>i<font color="#000080">] + </font>changex<font color="#000080">[</font>ord<font color="#000080">(</font>tempneg<font color="#000080">)][</font>i<font color="#000080">];     </font><font color="#008000"><i>{ update x }
      </i></font>realy<font color="#000080">[</font>i<font color="#000080">] := </font>RealY<font color="#000080">[</font>i<font color="#000080">] + </font>changey<font color="#000080">[</font>ord<font color="#000080">(</font>tempneg<font color="#000080">)][</font>i<font color="#000080">] </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ update y }

    </i></font><font color="#FF0000"><b>if </b></font>TempNeg <font color="#FF0000"><b>then                   </b></font><font color="#008000"><i>{ if decision var is negative }
      </i></font>D <font color="#000080">:= </font>D <font color="#000080">+ (</font>x <font color="#FF0000"><b>shl </b></font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">6          </font><font color="#008000"><i>{ D := D + 4*x + 6 }

    </i></font><font color="#FF0000"><b>else begin                        </b></font><font color="#008000"><i>{ if decision va ris nonnegative }
      </i></font>y <font color="#000080">:= </font>y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;                         </font><font color="#008000"><i>{ decrement y }
      </i></font>D <font color="#000080">:= </font>D <font color="#000080">+ ((</font>x <font color="#000080">- </font>y<font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">10</font><font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ D := D * 4*(x-y) + 10 }

    </i></font>x <font color="#000080">:= </font>x <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; </font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0173.PAS">Original</a><b>]</b></p></body>
</html>
