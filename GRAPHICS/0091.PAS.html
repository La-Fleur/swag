<html>
<head><title> "Re: Virtual Reality." by JOHN SHIPLEY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0091.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
RE: Re: Virtual Reality.
BY: Bas van Gaalen to John Shipley on Fri Mar 25 1994 02:26 pm

 &gt; John Shipley wrote in a message to Bas van Gaalen:
 &gt; 
 &gt;  &gt; I posted it recently, so you must have seen it passing by...
 &gt;  JS&gt; You did? I read just about every post you write, I didn't
 &gt;  JS&gt; see any program by that name come by here.
 &gt; 
 &gt; I suppose it got lost. You're the second... Anyway, I posted it again. Check
 &gt; previous message... It should be there.

Hello Bas!

Yes, I got it today... basically the problem I saw with the code was lack of
optimization and it also looked like you were trying to do too much. You
didn't need all the asm. But it could be even faster if you included it. I'm
sending back my modified version of your DYCP program. The &quot;writecharasm&quot;
procedure was screwed up so I removed it and I will check it out at a later
time. I modified the &quot;writechar&quot; procedure which you had commented out.

-------8&lt;---------Snip---------8&lt;---------Snip---------8&lt;--------Snip---------

{$G+}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>different_y_char_position<font color="#000080">;

</font><font color="#008000"><i>(* Programmed by Bas van Gaalen, Holland, PD  *)
(* Modified by John Shipley, USA, PD 03/30/94 *)

</i></font><font color="#FF0000"><b>USES </b></font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>CONST </b></font>vseg <font color="#000080">: </font>WORD   <font color="#000080">= </font><font color="#800000">$a000</font><font color="#000080">;
      </font>txt  <font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">= </font><font color="#800000">'**** Well... 38 chars, let''s see. ****'</font><font color="#000080">;
                   </font><font color="#008000"><i>(*  12345678901234567890123456 78901234567890 *)
      </i></font>txt1 <font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">= </font><font color="#800000">'This is another Strng of 38 Characters'</font><font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>stab      <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
    </font>fseg<font color="#000080">,</font>fofs <font color="#000080">: </font>WORD<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>getfont<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>ASM
    </b></font><font color="#FF00FF">mov ax,1130h;
    mov bh,1;
    int 10h;
    mov fseg,es;
    mov fofs,bp;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>csin<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>BYTE<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do </b></font>stab<font color="#000080">[</font>i<font color="#000080">] := </font>round<font color="#000080">(</font>sin<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">*</font>i<font color="#000080">*</font>pi<font color="#000080">/</font><font color="#800000">255</font><font color="#000080">)*</font><font color="#800000">25</font><font color="#000080">)+</font><font color="#800000">40</font><font color="#000080">;</font><font color="#008000"><i>(*150*)
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>clear<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">: </font>WORD<font color="#000080">); </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>ASM
    </b></font><font color="#FF00FF">mov es,vseg
    mov dx,0
   @lout:
    mov cx,0
   @lin:
    mov ax,y
    add ax,dx
    shl ax,6
    mov di,ax
    shl ax,2
    add di,ax
    add di,x
    add di,cx
    xor ax,ax
    mov [es:di],ax
    add cx,2
    cmp cx,8
    jne @lin
    inc dx
    cmp dx,2 </font><font color="#008000"><i>(* Was 8 *)
    </i></font><font color="#FF00FF">jne @lout
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>writechar<font color="#000080">(</font>ch<font color="#000080">: </font>CHAR<font color="#000080">; </font>x<font color="#000080">,</font>y<font color="#000080">: </font>WORD<font color="#000080">; </font>col<font color="#000080">: </font>BYTE<font color="#000080">);
  </font><font color="#FF0000"><b>VAR </b></font>j<font color="#000080">,</font>k <font color="#000080">: </font>BYTE<font color="#000080">;
      </font>pre <font color="#000080">: </font>WORD<font color="#000080">;
      </font>opt <font color="#000080">: </font>WORD<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>pre <font color="#000080">:= </font>BYTE<font color="#000080">(</font>ch<font color="#000080">)*</font><font color="#800000">8</font><font color="#000080">; </font><font color="#008000"><i>(* Opt *)
    </i></font>clear<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">);      </font><font color="#008000"><i>(* Key *)
    </i></font><font color="#FF0000"><b>FOR </b></font>j<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">7 </font><font color="#FF0000"><b>DO
      FOR </b></font>k<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">7 </font><font color="#FF0000"><b>DO
        BEGIN
          </b></font>opt <font color="#000080">:= (</font>y<font color="#000080">+</font>j<font color="#000080">)*</font><font color="#800000">320</font><font color="#000080">+</font>x<font color="#000080">+</font>k<font color="#000080">;  </font><font color="#008000"><i>(* Opt *)
          </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>MEM<font color="#000080">[</font>fseg<font color="#000080">:</font>fofs<font color="#000080">+</font>pre<font color="#000080">+</font>j<font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font>k<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">128</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
            </b></font>MEM<font color="#000080">[</font><font color="#800000">$a000</font><font color="#000080">:</font>opt<font color="#000080">] := </font><font color="#800000">0 </font><font color="#008000"><i>(* Key *)
          </i></font><font color="#FF0000"><b>ELSE
            </b></font>MEM<font color="#000080">[</font><font color="#800000">$a000</font><font color="#000080">:</font>opt<font color="#000080">] := </font>col<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>INC<font color="#000080">(</font>y<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);   </font><font color="#008000"><i>(* Opt *)
    </i></font>clear<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">); </font><font color="#008000"><i>(* Key *)
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>dodycp<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>sctr<font color="#000080">,</font>i<font color="#000080">,</font>l<font color="#000080">: </font>BYTE<font color="#000080">;
      </font>a<font color="#000080">,</font>b<font color="#000080">,</font>c <font color="#000080">: </font>WORD<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>sctr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>l <font color="#000080">:= </font>LENGTH<font color="#000080">(</font>txt<font color="#000080">); </font><font color="#008000"><i>(* Opt *)
    </i></font><font color="#FF0000"><b>REPEAT
      WHILE </b></font><font color="#000080">(</font>PORT<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">8</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>DO</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>PORT<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">8</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>DO</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>l <font color="#FF0000"><b>DO
        BEGIN
          </b></font>a <font color="#000080">:= </font>i<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">;
          </font>b <font color="#000080">:= </font>stab<font color="#000080">[(</font>sctr<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">*</font>i<font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">255</font><font color="#000080">];
          </font>c <font color="#000080">:= </font>stab<font color="#000080">[</font>sctr<font color="#000080">+</font>i<font color="#000080">] </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">64</font><font color="#000080">;
          </font>INC<font color="#000080">(</font>c<font color="#000080">,</font><font color="#800000">32</font><font color="#000080">);
          </font>writechar<font color="#000080">(</font>txt<font color="#000080">[</font>i<font color="#000080">],</font>a<font color="#000080">,</font>b<font color="#000080">,</font>c<font color="#000080">);
          </font>INC<font color="#000080">(</font>b<font color="#000080">,</font><font color="#800000">110</font><font color="#000080">);
          </font>writechar<font color="#000080">(</font>txt1<font color="#000080">[</font>i<font color="#000080">],</font>a<font color="#000080">,</font>b<font color="#000080">,</font>c<font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>INC<font color="#000080">(</font>sctr<font color="#000080">);
    </font><font color="#FF0000"><b>UNTIL </b></font>KEYPRESSED<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>getfont<font color="#000080">;
  </font>csin<font color="#000080">;
  </font><font color="#FF0000"><b>ASM
    </b></font><font color="#FF00FF">mov ax,13h;
    int 10h;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>dodycp<font color="#000080">;
  </font>TEXTMODE<font color="#000080">(</font>lastmode<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0091.PAS">Original</a><b>]</b></p></body>
</html>
