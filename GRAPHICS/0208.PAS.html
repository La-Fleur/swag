<html>
<head><title> "PCX Viewer" by JAVIER PEREZ VIGO</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0208.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here you have the PCX source code. It works in 320x200 in 256 colors
I still haven't study the SVGA modes.

I hope it could serves you.

 JL&gt; Thanks in advance.

(In the other message i've send you the GIF routine (in two messages cos the
extension)

==============Cut===============================Cut========================}

      </i></font><font color="#FF0000"><b>PROGRAM </b></font>GPCX<font color="#000080">;      </font><font color="#008000"><i>{Por: Javier Perez Vigo 1994}
      </i></font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">,</font>graph<font color="#000080">,</font>dos<font color="#000080">;
      </font><font color="#FF0000"><b>TYPE
        </b></font>PFich<font color="#000080">=^</font>RFich<font color="#000080">;
        </font>RFich<font color="#000080">=</font><font color="#FF0000"><b>Record
          </b></font>Size<font color="#000080">:</font>Word<font color="#000080">;
          </font>Octeto<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">64999</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
          </font>Sig<font color="#000080">:</font>pFich<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>VAR
        </b></font>BORRA<font color="#000080">:</font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;
        </font>cadena<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">11</font><font color="#000080">];
        </font>f<font color="#000080">: </font>text<font color="#000080">;
       </font>TECLA<font color="#000080">:</font>BOOLEAN<font color="#000080">;
       </font>largo<font color="#000080">:</font>integer<font color="#000080">;
       </font>muu<font color="#000080">:</font>Longint<font color="#000080">;
       </font>ch<font color="#000080">:</font>char<font color="#000080">;
       </font>Fich<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
       </font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">:</font>Integer<font color="#000080">;
       </font>a<font color="#000080">,</font>b<font color="#000080">,</font>c<font color="#000080">:</font>Byte<font color="#000080">;
       </font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">;
       </font>GD<font color="#000080">,</font>GM<font color="#000080">,</font>a14<font color="#000080">:</font>Integer<font color="#000080">;
       </font>a17<font color="#000080">:</font>LongInt<font color="#000080">;
       </font>s<font color="#000080">,</font>F1<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
       </font>Primero<font color="#000080">,</font>Actual<font color="#000080">,</font>Siguiente<font color="#000080">:</font>PFich<font color="#000080">;
       </font>Count<font color="#000080">:</font>Word<font color="#000080">;
       </font>Pall<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">767</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
       </font>Reg<font color="#000080">:</font>Registers<font color="#000080">;
       </font><font color="#008000"><i>{$F+}

       </i></font><font color="#FF0000"><b>Procedure </b></font>Inicia<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>asm
        </b></font><font color="#FF00FF">mov ax,$13
        int $10
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>FUNCTION </b></font>EXISTE_ARCH<font color="#000080">(</font>Nombre<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">):</font>BOOLEAN<font color="#000080">;
         </font><font color="#FF0000"><b>VAR
           </b></font>F<font color="#000080">:</font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;
           </font>OK<font color="#000080">:</font>BOOLEAN<font color="#000080">;
         </font><font color="#FF0000"><b>BEGIN            </b></font><font color="#008000"><i>{ Existe_Arch }
           </i></font>Assign <font color="#000080">(</font>f<font color="#000080">,</font>Nombre<font color="#000080">);
           </font><font color="#008000"><i>{$I-}
           </i></font>Reset<font color="#000080">(</font>f<font color="#000080">);
           </font><font color="#008000"><i>{$I+}
           </i></font>OK<font color="#000080">:=</font>IOresult<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
           </font><font color="#FF0000"><b>If Not </b></font>OK <font color="#FF0000"><b>then
              </b></font>Existe_Arch<font color="#000080">:=</font>False
            <font color="#FF0000"><b>else
              begin
                </b></font>close<font color="#000080">(</font>f<font color="#000080">);
                </font>existe_Arch<font color="#000080">:=</font>True<font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>{ else }
         </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;             </font><font color="#008000"><i>{ Existe_Arch }

       </i></font><font color="#FF0000"><b>FUNCTION </b></font>DetectVga256<font color="#000080">:</font>integer<font color="#000080">;
        </font><font color="#FF0000"><b>begin
        </b></font>DetectVGA256<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#008000"><i>{$F-}

   
       </i></font><font color="#FF0000"><b>PROCEDURE </b></font>no_tecla<font color="#000080">;
        </font><font color="#FF0000"><b>var
          </b></font>cabeza_Tampon<font color="#000080">:</font>integer <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$041A</font><font color="#000080">;</font><font color="#008000"><i>{cabeza actual}
          </i></font>cola_Tampon<font color="#000080">:</font>integer <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$041C</font><font color="#000080">;</font><font color="#008000"><i>{cola actual}
        </i></font><font color="#FF0000"><b>begin
           </b></font>cola_Tampon<font color="#000080">:=</font>cabeza_Tampon<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


       </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{Bloque principal}
        </i></font>clrscr<font color="#000080">;
        </font>wRITELn<font color="#000080">(</font><font color="#800000">'   Utilidad de ficheros PCX'</font><font color="#000080">);
        </font>F1<font color="#000080">:=</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>F1<font color="#000080">)&lt;</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
       </b></font>F1<font color="#000080">:=</font>F1<font color="#000080">+</font><font color="#800000">'.pcx'</font><font color="#000080">;
        </font>Largo<font color="#000080">:=</font>LENGTH<font color="#000080">(</font>Paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
        </font><font color="#FF0000"><b>if </b></font>largo<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
         begin
          </b></font>Textcolor<font color="#000080">(</font>red<font color="#000080">);
          </font>writeLn<font color="#000080">(</font><font color="#800000">'Escriba nombre de fichero'</font><font color="#000080">);
          </font>TextColor<font color="#000080">(</font>white<font color="#000080">);
          </font>textcolor<font color="#000080">(</font>white<font color="#000080">);
          </font>writeLN<font color="#000080">;
          </font>halt<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>if not</b></font><font color="#000080">(</font>existe_arch<font color="#000080">(</font>f1<font color="#000080">)) </font><font color="#FF0000"><b>then
         BEGIN
           </b></font>TextColor<font color="#000080">(</font>RED<font color="#000080">);
           </font>WriteLn<font color="#000080">(</font><font color="#800000">' ­ No existe el fichero ORIGEN ! '</font><font color="#000080">);
           </font>TextColor<font color="#000080">(</font>WHITE<font color="#000080">);
           </font>writeLn<font color="#000080">;
           </font>Halt<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
         </font><font color="#FF0000"><b>END
      else
      begin
       </b></font>INICIA<font color="#000080">;
       </font>gm<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font>gd<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
       </font>initgraph<font color="#000080">(</font>gd<font color="#000080">,</font>gm<font color="#000080">,</font><font color="#800000">'c:\tp\bgi'</font><font color="#000080">); </font><font color="#008000"><i>{the directory where the Unit is}
       </i></font>x<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;</font>y<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font>Assign<font color="#000080">(</font>Fich<font color="#000080">,</font>F1<font color="#000080">);
       </font>Reset<font color="#000080">(</font>Fich<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
       </font>New<font color="#000080">(</font>Actual<font color="#000080">);

       </font>Primero<font color="#000080">:=</font>Actual<font color="#000080">;
       </font>BlockRead<font color="#000080">(</font>Fich<font color="#000080">,</font>Actual<font color="#000080">^.</font>Octeto<font color="#000080">,</font><font color="#800000">65000</font><font color="#000080">,</font>Actual<font color="#000080">^.</font>Size<font color="#000080">);
       </font><font color="#FF0000"><b>While not </b></font>EOF<font color="#000080">(</font>Fich<font color="#000080">) </font><font color="#FF0000"><b>do
        Begin
         </b></font>New<font color="#000080">(</font>Siguiente<font color="#000080">);
         </font>Actual<font color="#000080">^.</font>sig<font color="#000080">:=</font>Siguiente<font color="#000080">;
         </font>Actual<font color="#000080">:=</font>Siguiente<font color="#000080">;
         </font>BlockRead<font color="#000080">(</font>Fich<font color="#000080">,</font>Actual<font color="#000080">^.</font>Octeto<font color="#000080">,</font><font color="#800000">65000</font><font color="#000080">,</font>Actual<font color="#000080">^.</font>Size<font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font>Actual<font color="#000080">^.</font>Sig<font color="#000080">:=</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
       </font>Close<font color="#000080">(</font>Fich<font color="#000080">);
       </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do
        Begin
         </b></font>SetPalette<font color="#000080">(</font>i<font color="#000080">,</font>i<font color="#000080">);
         </font>Pall<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">*</font>i<font color="#000080">]:=</font>Actual<font color="#000080">^.</font>Octeto<font color="#000080">[</font>Actual<font color="#000080">^.</font>Size<font color="#000080">-</font><font color="#800000">768</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">*</font>i<font color="#000080">] </font><font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">;
        </font>Pall<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">*</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>Actual<font color="#000080">^.</font>Octeto<font color="#000080">[</font>Actual<font color="#000080">^.</font>Size<font color="#000080">-</font><font color="#800000">767</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">*</font>i<font color="#000080">] </font><font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">;
        </font>Pall<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">*</font>i<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]:=</font>Actual<font color="#000080">^.</font>Octeto<font color="#000080">[</font>Actual<font color="#000080">^.</font>Size<font color="#000080">-</font><font color="#800000">766</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">*</font>i<font color="#000080">] </font><font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">;

        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>reg<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$1012</font><font color="#000080">;
       </font>reg<font color="#000080">.</font>bx<font color="#000080">:=</font><font color="#800000">$00</font><font color="#000080">;
       </font>reg<font color="#000080">.</font>cx<font color="#000080">:=</font><font color="#800000">$100</font><font color="#000080">;
       </font>reg<font color="#000080">.</font>es<font color="#000080">:=</font>seg<font color="#000080">(</font>pall<font color="#000080">);
       </font>reg<font color="#000080">.</font>dx<font color="#000080">:=</font>ofs<font color="#000080">(</font>pall<font color="#000080">);
       </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>reg<font color="#000080">);
       </font>Count<font color="#000080">:=</font><font color="#800000">128</font><font color="#000080">;
       </font>Actual<font color="#000080">:=</font>Primero<font color="#000080">;
       </font>j<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>REPEAT
      </b></font>a<font color="#000080">:=</font>Actual<font color="#000080">^.</font>Octeto<font color="#000080">[</font>Count<font color="#000080">];
      </font>Inc<font color="#000080">(</font>Count<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>Count<font color="#000080">&gt;</font>Actual<font color="#000080">^.</font>Size <font color="#FF0000"><b>then
       BEGIN
         </b></font>Actual<font color="#000080">:=</font>Actual<font color="#000080">^.</font>Sig<font color="#000080">;
         </font>Count<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>a<font color="#000080">&gt;</font><font color="#800000">192 </font><font color="#FF0000"><b>then
      BEGIN
        </b></font>b<font color="#000080">:=</font>a<font color="#000080">-</font><font color="#800000">192</font><font color="#000080">;
        </font>a<font color="#000080">:=</font>Actual<font color="#000080">^.</font>Octeto<font color="#000080">[</font>Count<font color="#000080">];
        </font>Inc<font color="#000080">(</font>Count<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>Count<font color="#000080">&gt;</font>Actual<font color="#000080">^.</font>Size <font color="#FF0000"><b>then
        BEGIN
          </b></font>Actual<font color="#000080">:=</font>Actual<font color="#000080">^.</font>Sig<font color="#000080">;
          </font>Count<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END
       else
        </b></font>b<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
       </font><font color="#FF0000"><b>While </b></font>b<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do
       begin
         </b></font>dec<font color="#000080">(</font>b<font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font>a<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
           </b></font>mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font><font color="#800000">320</font><font color="#000080">*</font>Y<font color="#000080">+</font>X<font color="#000080">]:=</font>a<font color="#000080">;
         </font>Inc<font color="#000080">(</font>X<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>X<font color="#000080">&gt;</font><font color="#800000">319 </font><font color="#FF0000"><b>then
          begin
            </b></font>x<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
            </font>Inc<font color="#000080">(</font>y<font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Until</b></font><font color="#000080">(</font>Actual<font color="#000080">^.</font>sig<font color="#000080">=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Actual<font color="#000080">^.</font>size<font color="#000080">&lt;</font><font color="#800000">768</font><font color="#000080">+</font>count<font color="#000080">);
         </font>muu<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
         </font><font color="#FF0000"><b>repeat
            </b></font>NO_TECLA<font color="#000080">;
            </font>TECLA<font color="#000080">:=</font>KEYPRESSED<font color="#000080">;
            </font>muu<font color="#000080">:=</font>muu<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>muu<font color="#000080">=</font><font color="#800000">150000</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font>TECLA<font color="#000080">;

       </font><font color="#FF0000"><b>begin
          </b></font>textmode<font color="#000080">(</font>c80<font color="#000080">);
          </font>Halt<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0208.PAS">Original</a><b>]</b></p></body>
</html>
