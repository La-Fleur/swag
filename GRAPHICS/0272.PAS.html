<html>
<head><title> "A nice game against the computer" by BOSTJAN GABROVSEK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0272.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{If you have any questions please send me mail at OleRom@hotmail.com}
</i></font><font color="#FF0000"><b>Program </b></font>Worm<font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>GetMaxX <font color="#000080">= </font><font color="#800000">320</font><font color="#000080">;
      </font>GetMaxY <font color="#000080">= </font><font color="#800000">200</font><font color="#000080">;
      </font>Levo  <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
      </font>Desno <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
      </font>Gor   <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
      </font>Dol   <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
      </font>KeyPort <font color="#000080">= </font><font color="#800000">$60</font><font color="#000080">;
      </font>PortESCAPE <font color="#000080">= </font><font color="#800000">01</font><font color="#000080">;
      </font>PortLeft   <font color="#000080">= </font><font color="#800000">75</font><font color="#000080">;
      </font>PortRight  <font color="#000080">= </font><font color="#800000">77</font><font color="#000080">;
      </font>PortUp     <font color="#000080">= </font><font color="#800000">72</font><font color="#000080">;
      </font>PortDown   <font color="#000080">= </font><font color="#800000">80</font><font color="#000080">;
      </font>X <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">107</font><font color="#000080">;
      </font>Y <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;
      </font>Smer <font color="#000080">: </font>Byte <font color="#000080">= </font>Levo<font color="#000080">;
      </font>UserX <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">213</font><font color="#000080">;
      </font>UserY <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;
      </font>UserSmer <font color="#000080">: </font>Byte <font color="#000080">= </font>Gor<font color="#000080">;
      </font>Counter <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
      </font>Back <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;
</font><font color="#FF0000"><b>Type </b></font>ScreenType <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">200</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">320</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>Screen <font color="#000080">: </font>ScreenType <font color="#FF0000"><b>absolute </b></font><font color="#800000">$A000</font><font color="#000080">:</font><font color="#800000">$0000</font><font color="#000080">;
    </font>ScrBuff<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65535</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#FF0000"><b>absolute </b></font>Screen<font color="#000080">;
    </font>Fo <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetPal<font color="#000080">(</font>Color<font color="#000080">,</font>R<font color="#000080">,</font>G<font color="#000080">,</font>B<font color="#000080">:</font>Byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,03C8h
  mov al,[Color]
  out dx,al
  inc dx
  mov al,[R]
  out dx,al
  mov al,[G]
  out dx,al
  mov al,[B]
  out dx,al
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Delay<font color="#000080">(</font>ms<font color="#000080">:</font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax,1000
  mul ms
  mov cx,dx
  mov dx,ax
  mov ah,86h
  int 15h
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>WormExit<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>UserGameOver<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>SetPal<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">);
 </font>ReadLn<font color="#000080">;
 </font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>GameOver<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>SetPal<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">);
 </font>ReadLn<font color="#000080">;
 </font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>KeyPressed<font color="#000080">:</font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov bx,40h
  mov es,bx
  mov ax,word ptr es:[001Ch]
  sub ax,word ptr es:[001Ah]
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>EmptyKeyBuffer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 While </b></font>KeyPressed <font color="#FF0000"><b>do
  asm
   </b></font><font color="#FF00FF">xor ah,ah
   int 16h
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>LevoDesno <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>L<font color="#000080">, </font>D <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>L <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font>D <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>While </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font>L<font color="#000080">] = </font>Back <font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>L<font color="#000080">);
 </font><font color="#FF0000"><b>While </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font>D<font color="#000080">] = </font>Back <font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>D<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>D <font color="#000080">&gt; </font>L <font color="#FF0000"><b>then </b></font>LevoDesno <font color="#000080">:= </font>Desno <font color="#FF0000"><b>else </b></font>LevoDesno <font color="#000080">:= </font>Levo<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>GorDol <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>G<font color="#000080">, </font>D <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>G <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font>D <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>While </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">-</font>G<font color="#000080">,</font>X<font color="#000080">] = </font>Back <font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>G<font color="#000080">);
 </font><font color="#FF0000"><b>While </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">+</font>D<font color="#000080">,</font>X<font color="#000080">] = </font>Back <font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>D<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>D <font color="#000080">&gt; </font>G <font color="#FF0000"><b>then </b></font>GorDol <font color="#000080">:= </font>Dol <font color="#FF0000"><b>else </b></font>GorDol <font color="#000080">:= </font>Gor<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Function </b></font>TestLevoDesno <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>{Levo = True}
 </i></font><font color="#FF0000"><b>Label </b></font>Konec<font color="#000080">;
 </font><font color="#FF0000"><b>Var </b></font>AllCounter <font color="#000080">: </font>Word<font color="#000080">;
     </font>LeftCounter<font color="#000080">, </font>RightCounter <font color="#000080">: </font>Word<font color="#000080">;
     </font>Xc<font color="#000080">, </font>Yc <font color="#000080">: </font>Word<font color="#000080">;
     </font>Bc <font color="#000080">: </font>Boolean<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>TestLevoDesno <font color="#000080">:= </font>Gor<font color="#000080">;
  </font>AllCounter   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>LeftCounter  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>RightCounter <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Xc <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">65535 </font><font color="#FF0000"><b>do If </b></font>ScrBuff<font color="#000080">[</font>Xc<font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>AllCounter<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font>Back<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] = </font>Back<font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TestLevoDesno <font color="#000080">:= </font>Desno<font color="#000080">; </font><font color="#FF0000"><b>Goto </b></font>Konec<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font>Back<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font>Back<font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TestLevoDesno <font color="#000080">:= </font>Levo <font color="#000080">; </font><font color="#FF0000"><b>Goto </b></font>Konec<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font>Back<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font>Back<font color="#000080">) </font><font color="#FF0000"><b>and
     </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] &lt;&gt; </font>Back<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] = </font>Back<font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TestLevoDesno <font color="#000080">:= </font>Dol<font color="#000080">; </font><font color="#FF0000"><b>Goto </b></font>Konec<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font>Back<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font>Back<font color="#000080">) </font><font color="#FF0000"><b>and
     </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] = </font>Back<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] &lt;&gt; </font>Back<font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TestLevoDesno <font color="#000080">:= </font>Gor<font color="#000080">; </font><font color="#FF0000"><b>Goto </b></font>Konec<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font>Back<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] = </font>Back<font color="#000080">) </font><font color="#FF0000"><b>then
   Begin
    </b></font><font color="#008000"><i>{Test Levo...}
     </i></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">9</font><font color="#000080">;
     </font>Inc<font color="#000080">(</font>LeftCounter<font color="#000080">);
     </font>Bc <font color="#000080">:= </font>True<font color="#000080">;
     </font><font color="#FF0000"><b>While </b></font>Bc <font color="#FF0000"><b>do
     For </b></font>Yc <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font><font color="#800000">199 </font><font color="#FF0000"><b>do
      For </b></font>Xc <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font><font color="#800000">319 </font><font color="#FF0000"><b>do
       If </b></font>Screen<font color="#000080">[</font>Yc<font color="#000080">,</font>Xc<font color="#000080">] = </font><font color="#800000">9 </font><font color="#FF0000"><b>then
        Begin
         If </b></font>Screen<font color="#000080">[</font>Yc<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Xc<font color="#000080">] = </font>Back <font color="#FF0000"><b>then
          Begin
           </b></font>Inc<font color="#000080">(</font>LeftCounter<font color="#000080">);
           </font>Bc <font color="#000080">:= </font>True<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Konec<font color="#000080">:
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>Randomize<font color="#000080">;
 </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax,0013h
  int 10h
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>SetPal<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">); </font><font color="#008000"><i>{Svetlo zelena - konec}
</i></font>SetPal<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);  </font><font color="#008000"><i>{Temno zelena  - plac }
</i></font>SetPal<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);  </font><font color="#008000"><i>{Temo Temno zelena  - plac pri farbanju}
</i></font>SetPal<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);   </font><font color="#008000"><i>{Crna          - rob  }
</i></font>SetPal<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">40</font><font color="#000080">); </font><font color="#008000"><i>{Bela          - rob  }
</i></font>SetPal<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">); </font><font color="#008000"><i>{Rdeca         - user }
</i></font>SetPal<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);   </font><font color="#008000"><i>{Rdeca         - user }
</i></font>SetPal<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">); </font><font color="#008000"><i>{Modra         - worm }
</i></font>SetPal<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">50</font><font color="#000080">);   </font><font color="#008000"><i>{Modra         - worm }
</i></font>FillChar<font color="#000080">(</font>Screen<font color="#000080">,</font><font color="#800000">64000</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
</font><font color="#FF0000"><b>For </b></font>Fo <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>GetMaxX <font color="#FF0000"><b>do </b></font>Screen<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font>Fo<font color="#000080">] := </font><font color="#800000">6</font><font color="#000080">;
</font><font color="#FF0000"><b>For </b></font>Fo <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>GetMaxX <font color="#FF0000"><b>do </b></font>Screen<font color="#000080">[</font>GetMaxY<font color="#000080">,</font>Fo<font color="#000080">] := </font><font color="#800000">7</font><font color="#000080">;
</font><font color="#FF0000"><b>For </b></font>Fo <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>GetMaxY <font color="#FF0000"><b>do </b></font>Screen<font color="#000080">[</font>Fo<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">6</font><font color="#000080">;
</font><font color="#FF0000"><b>For </b></font>Fo <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>GetMaxY <font color="#FF0000"><b>do </b></font>Screen<font color="#000080">[</font>Fo<font color="#000080">,</font>GetMaxX<font color="#000080">] := </font><font color="#800000">7</font><font color="#000080">;
</font>Screen<font color="#000080">[</font>UserY<font color="#000080">,</font>UserX<font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;
</font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">] := </font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>Repeat Until </b></font>KeyPressed<font color="#000080">;
</font>EmptyKeyBuffer<font color="#000080">;
</font><font color="#FF0000"><b>Repeat
 Case </b></font>Port<font color="#000080">[</font>KeyPort<font color="#000080">] </font><font color="#FF0000"><b>of
  </b></font>PortESCAPE <font color="#000080">: </font>WormExit<font color="#000080">;
  </font>PortLeft   <font color="#000080">: </font>UserSmer <font color="#000080">:= </font>Levo<font color="#000080">;
  </font>PortRight  <font color="#000080">: </font>UserSmer <font color="#000080">:= </font>Desno<font color="#000080">;
  </font>PortUp     <font color="#000080">: </font>UserSmer <font color="#000080">:= </font>Gor<font color="#000080">;
  </font>PortDown   <font color="#000080">: </font>UserSmer <font color="#000080">:= </font>Dol<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Case </b></font>UserSmer <font color="#FF0000"><b>of
  </b></font>Desno <font color="#000080">: </font>Inc<font color="#000080">(</font>UserX<font color="#000080">);
  </font>Levo  <font color="#000080">: </font>Dec<font color="#000080">(</font>UserX<font color="#000080">);
  </font>Gor   <font color="#000080">: </font>Dec<font color="#000080">(</font>UserY<font color="#000080">);
  </font>Dol   <font color="#000080">: </font>Inc<font color="#000080">(</font>UserY<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{+++++++++++++++++++++++++++++++++++}
{++            Worm IQ            ++}
{+++++++++++++++++++++++++++++++++++}
 </i></font><font color="#FF0000"><b>Case </b></font>Smer <font color="#FF0000"><b>of
  </b></font>Levo  <font color="#000080">: </font><font color="#FF0000"><b>Begin
           </b></font>Fo <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
           </font><font color="#FF0000"><b>While </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font>Fo<font color="#000080">] = </font>Back <font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>Fo<font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font>Fo <font color="#000080">&lt; </font>Random<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">)+</font><font color="#800000">8 </font><font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>GorDol<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Desno <font color="#000080">: </font><font color="#FF0000"><b>Begin
           </b></font>Fo <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
           </font><font color="#FF0000"><b>While </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font>Fo<font color="#000080">] = </font>Back <font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>Fo<font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font>Fo <font color="#000080">&lt; </font>Random<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">)+</font><font color="#800000">8 </font><font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>GorDol<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Gor   <font color="#000080">: </font><font color="#FF0000"><b>Begin
           </b></font>Fo <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
           </font><font color="#FF0000"><b>While </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">-</font>Fo<font color="#000080">,</font>X<font color="#000080">] = </font>Back <font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>Fo<font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font>Fo <font color="#000080">&lt; </font>Random<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">)+</font><font color="#800000">8 </font><font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>LevoDesno
          <font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Dol   <font color="#000080">: </font><font color="#FF0000"><b>Begin
           </b></font>Fo <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
           </font><font color="#FF0000"><b>While </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">+</font>Fo<font color="#000080">,</font>X<font color="#000080">] = </font>Back <font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>Fo<font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font>Fo <font color="#000080">&lt; </font>Random<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">)+</font><font color="#800000">8 </font><font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>LevoDesno
          <font color="#FF0000"><b>End</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------}
{--            Worm IQ            --}
{-----------------------------------}
</i></font><font color="#FF0000"><b>Case </b></font>Smer <font color="#FF0000"><b>of
 </b></font>Levo<font color="#000080">: </font><font color="#FF0000"><b>Begin
        If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font>Back <font color="#FF0000"><b>then
         Begin
          If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Desno<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Gor<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Dol<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font>Desno<font color="#000080">: </font><font color="#FF0000"><b>Begin
        If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font>Back <font color="#FF0000"><b>then
         Begin
          If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Levo<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Gor<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Dol<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font>Gor<font color="#000080">: </font><font color="#FF0000"><b>Begin
        If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] &lt;&gt; </font>Back <font color="#FF0000"><b>then
         Begin
          If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Levo<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Desno<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Dol<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font>Dol<font color="#000080">: </font><font color="#FF0000"><b>Begin
        If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] &lt;&gt; </font>Back <font color="#FF0000"><b>then
         Begin
          If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Levo<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Desno<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">] = </font>Back <font color="#FF0000"><b>then </b></font>Smer <font color="#000080">:= </font>Gor<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Case </b></font>Smer <font color="#FF0000"><b>of
  </b></font>Levo  <font color="#000080">: </font>Dec<font color="#000080">(</font>X<font color="#000080">);
  </font>Desno <font color="#000080">: </font>Inc<font color="#000080">(</font>X<font color="#000080">);
  </font>Gor   <font color="#000080">: </font>Dec<font color="#000080">(</font>Y<font color="#000080">);
  </font>Dol   <font color="#000080">: </font>Inc<font color="#000080">(</font>Y<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>Inc<font color="#000080">(</font>Counter<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>Screen<font color="#000080">[</font>UserY<font color="#000080">,</font>UserX<font color="#000080">] &lt;&gt; </font>Back <font color="#FF0000"><b>then </b></font>UserGameOver<font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">] &lt;&gt; </font>Back <font color="#FF0000"><b>then </b></font>GameOver<font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Odd<font color="#000080">(</font>Counter<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Screen<font color="#000080">[</font>UserY<font color="#000080">,</font>UserX<font color="#000080">] := </font><font color="#800000">3 </font><font color="#FF0000"><b>else </b></font>Screen<font color="#000080">[</font>UserY<font color="#000080">,</font>UserX<font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Odd<font color="#000080">(</font>Counter<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">] := </font><font color="#800000">1 </font><font color="#FF0000"><b>else </b></font>Screen<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">] := </font><font color="#800000">2</font><font color="#000080">;
 </font>EmptyKeyBuffer<font color="#000080">;
 </font>Delay<font color="#000080">(</font><font color="#800000">25</font><font color="#000080">);
</font><font color="#FF0000"><b>Until </b></font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0272.PAS">Original</a><b>]</b></p></body>
</html>
