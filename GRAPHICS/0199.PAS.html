<html>
<head><title> "Re: PHONG Shading (PLASMA)" by ALEXIS DOMJAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0199.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 RK&gt; Is there anyone out there who has anything, on how to do PHONG shading in
 RK&gt; Pascal. (If it's possible in Pas..I've seen it done in C, but never in
 RK&gt; Pas)         ^^^.. I didn't have the time to grab the guys source
 RK&gt; code...:(

However I quote this message because I have some plasma stuff!

Here's a little configurable plasma unit! }

</i></font><font color="#FF0000"><b>UNIT </b></font>PLASMA<font color="#000080">;

</font><font color="#FF0000"><b>Interface


Procedure </b></font>InitPlasma<font color="#000080">(</font>NbLines <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>DoPlasma<font color="#000080">(</font>xx<font color="#000080">, </font>yy<font color="#000080">, </font>xs<font color="#000080">, </font>ys <font color="#000080">: </font>WORD<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>ClosePlasma<font color="#000080">;



</font><font color="#FF0000"><b>VAR
  </b></font>FT <font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">511</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
  </font>SINT <font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
  </font>I1<font color="#000080">,</font>A<font color="#000080">,</font>B<font color="#000080">,</font>D<font color="#000080">,</font>C<font color="#000080">,</font>OD<font color="#000080">,</font>COLOR <font color="#000080">:</font>BYTE<font color="#000080">;
  </font>X<font color="#000080">,</font>Y<font color="#000080">,</font>K<font color="#000080">,</font>I <font color="#000080">:</font>WORD<font color="#000080">;
  </font>clong   <font color="#000080">: </font>longint<font color="#000080">;


</font><font color="#FF0000"><b>Implementation

uses </b></font>crt<font color="#000080">;



</font><font color="#FF0000"><b>Procedure </b></font>ClosePlasma<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>ASM
    </b></font><font color="#FF00FF">mov dx,3d4h
    mov al,9
    out dx,al
    inc dx
    in al,dx
    and al,0e0h
    add al,2
    out dx,al
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;




</font><font color="#FF0000"><b>Procedure </b></font>InitPlasma<font color="#000080">(</font>nblines <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  ASM
    </b></font><font color="#FF00FF">mov dx,3d4h
    mov al,9
    out dx,al
    inc dx
    in al,dx
    and al,0e0h
    add al,nblines
    out dx,al
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>{DO TABLES}
  </i></font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">511 </font><font color="#FF0000"><b>DO </b></font>FT <font color="#000080">[</font>I<font color="#000080">]:=</font>ROUND <font color="#000080">(</font><font color="#800000">64</font><font color="#000080">+</font><font color="#800000">63</font><font color="#000080">*</font>SIN <font color="#000080">(</font>I<font color="#000080">/</font><font color="#800000">40.74</font><font color="#000080">));
  </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">255 </font><font color="#FF0000"><b>DO </b></font>SINT <font color="#000080">[</font>I<font color="#000080">]:=</font>ROUND <font color="#000080">(</font><font color="#800000">256</font><font color="#000080">+</font><font color="#800000">255</font><font color="#000080">*</font>SIN <font color="#000080">(</font>I<font color="#000080">/</font><font color="#800000">40.74</font><font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>DoPlasma<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>INC <font color="#000080">(</font>I1<font color="#000080">);                    </font><font color="#008000"><i>{GRID COUNTER}
  </i></font>DEC <font color="#000080">(</font>C<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font>INC <font color="#000080">(</font>OD<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>D<font color="#000080">:=</font>OD<font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>Y<font color="#000080">:=</font>yy <font color="#FF0000"><b>TO </b></font>yy<font color="#000080">+</font>ys <font color="#FF0000"><b>DO
    BEGIN
       </b></font>K<font color="#000080">:=</font>Y<font color="#000080">*</font><font color="#800000">320</font><font color="#008000"><i>{+Y AND 1}</i></font><font color="#000080">;     </font><font color="#008000"><i>{CALCULATE OFFSET AND ADD ONE EVERY SECOND LINE}
       {K:=K-(I1 AND 1)*320;}  {MOVE GRID ONE PIXEL DOWN EVERY SECOND FRAME}
       </i></font>INC <font color="#000080">(</font>D<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
       </font>A<font color="#000080">:=</font>SINT <font color="#000080">[(</font>C<font color="#000080">+</font>Y<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">255</font><font color="#000080">];
       </font>B<font color="#000080">:=</font>SINT <font color="#000080">[(</font>D<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">255</font><font color="#000080">];
         </font><font color="#FF0000"><b>FOR </b></font>X<font color="#000080">:=</font>xx <font color="#FF0000"><b>TO </b></font>xx<font color="#000080">+</font>xs <font color="#FF0000"><b>DO
           BEGIN
             </b></font>COLOR<font color="#000080">:=</font>FT<font color="#000080">[</font>A<font color="#000080">+</font>B<font color="#000080">] + </font>FT<font color="#000080">[</font>Y<font color="#000080">+</font>B<font color="#000080">];
             </font>clong<font color="#000080">:= </font>color <font color="#FF0000"><b>shl </b></font><font color="#800000">24 </font><font color="#000080">+ </font>color <font color="#FF0000"><b>shl </b></font><font color="#800000">16 </font><font color="#000080">+ </font>color <font color="#FF0000"><b>shl </b></font><font color="#800000">8 </font><font color="#000080">+ </font>color<font color="#000080">;
             </font><font color="#FF0000"><b>asm
               </b></font><font color="#FF00FF">mov ax, 0a000h
               mov es, ax
               mov di, k
               mov ah, color
               mov al, ah
               stosw
               stosw
              </font><font color="#008000"><i>{ mov es:[di], ax   }
             </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font>INC <font color="#000080">(</font>A<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">+</font>COLOR <font color="#FF0000"><b>SHR </b></font><font color="#800000">7</font><font color="#000080">);
             </font>INC <font color="#000080">(</font>B<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
             </font>INC <font color="#000080">(</font>K<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Begin
End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0199.PAS">Original</a><b>]</b></p></body>
</html>
