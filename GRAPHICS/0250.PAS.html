<html>
<head><title> "Another Fractal 3D" by RYAN JONES</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0250.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>Frac3d<font color="#000080">;

</font><font color="#008000"><i>{
	See Frac3D1.pas for info.

   Programmed by Ryan Jones (Dios@Rworld.Com)
}

</i></font><font color="#FF0000"><b>Uses
</b></font>	CRT<font color="#000080">;

</font><font color="#FF0000"><b>Const
</b></font>	ZInc <font color="#000080">= </font><font color="#800000">25</font><font color="#000080">;
   </font>ZOfs <font color="#000080">= </font><font color="#800000">256</font><font color="#000080">;
   </font>ZScale <font color="#000080">= </font><font color="#800000">256</font><font color="#000080">;
   </font>Sc <font color="#000080">= </font><font color="#800000">0.7</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
</b></font>	Triangle <font color="#000080">=
</font>   	<font color="#FF0000"><b>Record
</b></font>      	X1<font color="#000080">, </font>Y1<font color="#000080">, </font>Z1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">, </font>Z2<font color="#000080">, </font>X3<font color="#000080">, </font>Y3<font color="#000080">, </font>Z3 <font color="#000080">: </font>Real<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
</b></font>	Segment<font color="#000080">, </font>Ofset <font color="#000080">: </font>Word<font color="#000080">;
</font>	Tris <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Triangle<font color="#000080">;
   </font>Trin<font color="#000080">,
</font>	l<font color="#000080">, </font>n<font color="#000080">, </font>hn <font color="#000080">: </font>Word<font color="#000080">;
   </font>db <font color="#000080">: </font>Pointer<font color="#000080">;
   </font>Ch <font color="#000080">: </font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetScreenPtr<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Ptr<font color="#000080">);
</font>	<font color="#FF0000"><b>Begin
</b></font>   	Segment <font color="#000080">:= </font>Seg<font color="#000080">(</font>Ptr<font color="#000080">);
      </font>Ofset <font color="#000080">:= </font>Ofs<font color="#000080">(</font>Ptr<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetVideoMode<font color="#000080">( </font>N <font color="#000080">: </font>Byte <font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>Asm
      </b></font><font color="#FF00FF">MOV AH, 0
      MOV AL, N
      INT $10
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Credit<font color="#000080">;
</font>	<font color="#FF0000"><b>Var
</b></font>		St <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font>   	n <font color="#000080">: </font>Word<font color="#000080">;
</font>	<font color="#FF0000"><b>Begin
</b></font>   	SetVideoMode<font color="#000080">(</font><font color="#800000">$03</font><font color="#000080">);
      </font>Textcolor<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
      </font>Textbackground<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
      </font>St <font color="#000080">:= </font><font color="#800000">'Qsphsbnnfe!cz!Szbo!Kpoft/'</font><font color="#000080">;
      </font>n <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>Repeat
</b></font>      	St<font color="#000080">[</font>n<font color="#000080">] := </font>Chr<font color="#000080">(</font>Ord<font color="#000080">(</font>St<font color="#000080">[</font>n<font color="#000080">]) - </font><font color="#800000">1</font><font color="#000080">);
         </font>n <font color="#000080">:= </font>n <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>Until </b></font>n <font color="#000080">&gt; </font>Length<font color="#000080">(</font>St<font color="#000080">);
      </font>Writeln<font color="#000080">(</font>St<font color="#000080">);
      </font>Textcolor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
      </font>WriteLn<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>_Line<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">, </font>C <font color="#000080">: </font>Integer<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ It's more efficient than it looks}
   </i></font><font color="#FF0000"><b>Asm
      </b></font><font color="#FF00FF">CLI

      MOV AX, X2
      CMP AX, X1
      JNE @Sk
      MOV AX, Y2
      CMP AX, Y1
      JE @NoLine
      @Sk:

      MOV AX, X2
      CMP AX, X1
      JG @Skip
      MOV BX, X1
      MOV X2, BX
      MOV X1, AX
      MOV AX, Y2
      MOV BX, Y1
      MOV Y2, BX
      MOV Y1, AX
      @Skip:
      MOV DX, C      </font><font color="#008000"><i>{ Set DX To _GetColor }
      </i></font><font color="#FF00FF">MOV AX, Segment
      MOV ES, AX     </font><font color="#008000"><i>{ Set ES To $A000 }
      </i></font><font color="#FF00FF">MOV BX, Y1
      XCHG BH, BL
      MOV AX, BX
      SHR BX, 1
      SHR BX, 1
      ADD BX, AX
      ADD BX, X1   </font><font color="#008000"><i>{ Set BX == X + (Y*320) }
      </i></font><font color="#FF00FF">ADD BX, Ofset

      MOV SI, X2
      MOV DI, Y2
      SUB SI, X1
      SUB DI, Y1

      @ABCD:
      CMP DI, $8888
      JB @CD
      @AB:
      NEG DI
      CMP SI, DI
      JB @A
      @B:
      MOV CX, SI
      MOV AX, SI
      SHR AX, 1
      @Loopa:
      MOV ES:[BX], DL
      INC BX
      ADD AX, DI
      CMP AX, SI
      JLE @Skipa
      SUB BX, 320
      SUB AX, SI
      @Skipa:
      LOOP @Loopa
      JMP @Exit
      @A:
      MOV CX, DI
      MOV AX, DI
      SHR AX, 1
      @Loopb:
      MOV ES:[BX], DL
      SUB BX, 320
      ADD AX, SI
      CMP AX, DI
      JLE @Skipb
      ADD BX, 1
      SUB AX, DI
      @Skipb:
      LOOP @Loopb
      JMP @Exit
      @CD:
      CMP SI, DI
      JB @D
      @C:
      MOV CX, SI
      MOV AX, SI
      SHR AX, 1
      @Loopc:
      MOV ES:[BX], DL
      INC BX
      ADD AX, DI
      CMP AX, SI
      JLE @Skipc
      ADD BX, 320
      SUB AX, SI
      @Skipc:
      LOOP @Loopc
      JMP @Exit
      @D:
      MOV CX, DI
      MOV AX, DI
      SHR AX, 1
      @Loopd:
      MOV ES:[BX], DL
      ADD BX, 320
      ADD AX, SI 
      CMP AX, DI
      JLE @Skipd
      ADD BX, 1
      SUB AX, DI
      @Skipd:
      LOOP @Loopd
      JMP @Exit
      @NoLine:
      MOV AX, X2
      MOV BX, Y2
      MOV DX, C
      MOV BX, Y1
      XCHG BH, BL
      MOV AX, BX
      SHR BX, 1
      SHR BX, 1
      ADD BX, AX
      ADD BX, X1
      MOV AX, Segment
      MOV ES, AX

      @Exit:
      MOV ES:[BX], DL
      STI
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FillDW<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>A<font color="#000080">; </font>L <font color="#000080">: </font>Word<font color="#000080">; </font>Dw <font color="#000080">: </font>LongInt<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font>	<font color="#FF0000"><b>Asm
</b></font>   	<font color="#FF00FF">CLI
      CLD
      LES DI, A
      MOV CX, L
      DB $66; MOV AX, WORD PTR Dw
      DB $66; REP STOSW
      STI
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>MoveDW<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>A<font color="#000080">, </font>B<font color="#000080">; </font>L <font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font>	<font color="#FF0000"><b>Asm
</b></font>   	<font color="#FF00FF">CLI
      CLD
      PUSH DS
      LDS SI, A
      LES DI, B
      MOV CX, L
      DB $66; REP MOVSW
      POP DS
      STI
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ClipLine<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">, </font>x2<font color="#000080">, </font>y2<font color="#000080">, </font>c <font color="#000080">: </font>Word<font color="#000080">);
</font>	<font color="#FF0000"><b>Begin
</b></font>   	<font color="#FF0000"><b>If </b></font><font color="#000080">(</font>x1 <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x1 <font color="#000080">&lt; </font><font color="#800000">320</font><font color="#000080">) </font><font color="#FF0000"><b>and
</b></font>      	<font color="#000080">(</font>y1 <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y1 <font color="#000080">&lt; </font><font color="#800000">200</font><font color="#000080">) </font><font color="#FF0000"><b>and
         </b></font><font color="#000080">(</font>x2 <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x2 <font color="#000080">&lt; </font><font color="#800000">320</font><font color="#000080">) </font><font color="#FF0000"><b>and
         </b></font><font color="#000080">(</font>y2 <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y2 <font color="#000080">&lt; </font><font color="#800000">200</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>_Line<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">, </font>x2<font color="#000080">, </font>y2<font color="#000080">, </font>c<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>AddTris<font color="#000080">(</font>n <font color="#000080">: </font>Word<font color="#000080">);
</font>	<font color="#FF0000"><b>Var </b></font>OX1<font color="#000080">, </font>OY1<font color="#000080">, </font>OZ1<font color="#000080">, </font>OX2<font color="#000080">, </font>OY2<font color="#000080">, </font>OZ2<font color="#000080">, </font>OX3<font color="#000080">, </font>OY3<font color="#000080">, </font>OZ3 <font color="#000080">: </font>Real<font color="#000080">;
</font>	<font color="#FF0000"><b>Begin
</b></font>   	<font color="#FF0000"><b>With </b></font>Tris<font color="#000080">[</font>n<font color="#000080">] </font><font color="#FF0000"><b>Do
</b></font>      	<font color="#FF0000"><b>Begin
</b></font>         	OX1 <font color="#000080">:= </font>X1<font color="#000080">;
</font>         	OY1 <font color="#000080">:= </font>Y1<font color="#000080">;
</font>         	OZ1 <font color="#000080">:= </font>Z1<font color="#000080">;
</font>         	OX2 <font color="#000080">:= </font>X2<font color="#000080">;
</font>         	OY2 <font color="#000080">:= </font>Y2<font color="#000080">;
</font>         	OZ2 <font color="#000080">:= </font>Z2<font color="#000080">;
</font>         	OX3 <font color="#000080">:= </font>X3<font color="#000080">;
</font>         	OY3 <font color="#000080">:= </font>Y3<font color="#000080">;
</font>         	OZ3 <font color="#000080">:= </font>Z3<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>   	<font color="#FF0000"><b>With </b></font>Tris<font color="#000080">[</font>Trin<font color="#000080">] </font><font color="#FF0000"><b>Do
</b></font>      	<font color="#FF0000"><b>Begin
</b></font>         	X1 <font color="#000080">:= </font>OX1<font color="#000080">;
            </font>Y1 <font color="#000080">:= </font>OY1<font color="#000080">;
            </font>Z1 <font color="#000080">:= </font>OZ1<font color="#000080">+</font>ZInc<font color="#000080">;
</font>         	X2 <font color="#000080">:= </font>OX1<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OX2<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
            </font>Y2 <font color="#000080">:= </font>OY1<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OY2<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
            </font>Z2 <font color="#000080">:= </font>OZ2<font color="#000080">+</font>ZInc<font color="#000080">;
</font>         	X3 <font color="#000080">:= </font>OX1<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OX3<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
            </font>Y3 <font color="#000080">:= </font>OY1<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OY3<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
            </font>Z3 <font color="#000080">:= </font>OZ3<font color="#000080">+</font>ZInc<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>   	<font color="#FF0000"><b>With </b></font>Tris<font color="#000080">[</font>Trin<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>Do
</b></font>      	<font color="#FF0000"><b>Begin
</b></font>         	X1 <font color="#000080">:= </font>OX2<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OX1<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
</font>         	Y1 <font color="#000080">:= </font>OY2<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OY1<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
</font>         	Z1 <font color="#000080">:= </font>OZ1<font color="#000080">+</font>ZInc<font color="#000080">;
</font>         	X2 <font color="#000080">:= </font>OX2<font color="#000080">;
</font>         	Y2 <font color="#000080">:= </font>OY2<font color="#000080">;
</font>         	Z2 <font color="#000080">:= </font>OZ2<font color="#000080">+</font>ZInc<font color="#000080">;
</font>         	X3 <font color="#000080">:= </font>OX2<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OX3<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
</font>         	Y3 <font color="#000080">:= </font>OY2<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OY3<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
</font>         	Z3 <font color="#000080">:= </font>OZ3<font color="#000080">+</font>ZInc<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>   	<font color="#FF0000"><b>With </b></font>Tris<font color="#000080">[</font>Trin<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>Do
</b></font>      	<font color="#FF0000"><b>Begin
</b></font>         	X1 <font color="#000080">:= </font>OX3<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OX1<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
</font>         	Y1 <font color="#000080">:= </font>OY3<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OY1<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
</font>         	Z1 <font color="#000080">:= </font>OZ1<font color="#000080">+</font>ZInc<font color="#000080">;
</font>         	X2 <font color="#000080">:= </font>OX3<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OX2<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
</font>         	Y2 <font color="#000080">:= </font>OY3<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">+</font>OY2<font color="#000080">/</font><font color="#800000">3</font><font color="#000080">;
</font>         	Z2 <font color="#000080">:= </font>OZ2<font color="#000080">+</font>ZInc<font color="#000080">;
</font>         	X3 <font color="#000080">:= </font>OX3<font color="#000080">;
</font>         	Y3 <font color="#000080">:= </font>OY3<font color="#000080">;
</font>         	Z3 <font color="#000080">:= </font>OZ3<font color="#000080">+</font>ZInc<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Trin <font color="#000080">:= </font>Trin <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DrawTris<font color="#000080">;
</font>	<font color="#FF0000"><b>Var </b></font>SX1<font color="#000080">, </font>SY1<font color="#000080">, </font>SX2<font color="#000080">, </font>SY2<font color="#000080">, </font>SX3<font color="#000080">, </font>SY3<font color="#000080">, </font>n <font color="#000080">: </font>Word<font color="#000080">;
</font>	<font color="#FF0000"><b>Begin
</b></font>   	SetScreenPtr<font color="#000080">(</font>db<font color="#000080">^);
      </font>FillDW<font color="#000080">(</font>db<font color="#000080">^, </font><font color="#800000">16000</font><font color="#000080">, </font><font color="#800000">$00000000</font><font color="#000080">);
</font>   	n <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>   	<font color="#FF0000"><b>Repeat
</b></font>      	<font color="#FF0000"><b>With </b></font>Tris<font color="#000080">[</font>n<font color="#000080">] </font><font color="#FF0000"><b>Do
</b></font>         	<font color="#FF0000"><b>Begin
</b></font>		      	SX1 <font color="#000080">:= </font>Round<font color="#000080">((</font>ZScale<font color="#000080">*</font>X1<font color="#000080">)/(</font>Z1<font color="#000080">-</font>ZOfs<font color="#000080">));
</font>		      	SY1 <font color="#000080">:= </font>Round<font color="#000080">((</font>ZScale<font color="#000080">*</font>Y1<font color="#000080">)/(</font>Z1<font color="#000080">-</font>ZOfs<font color="#000080">));
</font>		      	SX2 <font color="#000080">:= </font>Round<font color="#000080">((</font>ZScale<font color="#000080">*</font>X2<font color="#000080">)/(</font>Z2<font color="#000080">-</font>ZOfs<font color="#000080">));
</font>		      	SY2 <font color="#000080">:= </font>Round<font color="#000080">((</font>ZScale<font color="#000080">*</font>Y2<font color="#000080">)/(</font>Z2<font color="#000080">-</font>ZOfs<font color="#000080">));
</font>		      	SX3 <font color="#000080">:= </font>Round<font color="#000080">((</font>ZScale<font color="#000080">*</font>X3<font color="#000080">)/(</font>Z3<font color="#000080">-</font>ZOfs<font color="#000080">));
</font>		      	SY3 <font color="#000080">:= </font>Round<font color="#000080">((</font>ZScale<font color="#000080">*</font>Y3<font color="#000080">)/(</font>Z3<font color="#000080">-</font>ZOfs<font color="#000080">));
</font>         	<font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>ClipLine<font color="#000080">(</font><font color="#800000">160</font><font color="#000080">+</font>SX1<font color="#000080">, </font><font color="#800000">100</font><font color="#000080">+</font>SY1<font color="#000080">, </font><font color="#800000">160</font><font color="#000080">+</font>SX2<font color="#000080">, </font><font color="#800000">100</font><font color="#000080">+</font>SY2<font color="#000080">, </font><font color="#800000">15</font><font color="#000080">);
         </font>ClipLine<font color="#000080">(</font><font color="#800000">160</font><font color="#000080">+</font>SX2<font color="#000080">, </font><font color="#800000">100</font><font color="#000080">+</font>SY2<font color="#000080">, </font><font color="#800000">160</font><font color="#000080">+</font>SX3<font color="#000080">, </font><font color="#800000">100</font><font color="#000080">+</font>SY3<font color="#000080">, </font><font color="#800000">15</font><font color="#000080">);
         </font>ClipLine<font color="#000080">(</font><font color="#800000">160</font><font color="#000080">+</font>SX3<font color="#000080">, </font><font color="#800000">100</font><font color="#000080">+</font>SY3<font color="#000080">, </font><font color="#800000">160</font><font color="#000080">+</font>SX1<font color="#000080">, </font><font color="#800000">100</font><font color="#000080">+</font>SY1<font color="#000080">, </font><font color="#800000">15</font><font color="#000080">);
         </font>n <font color="#000080">:= </font>n <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>Until </b></font>n <font color="#000080">= </font>Trin<font color="#000080">;
      </font>MoveDW<font color="#000080">(</font>db<font color="#000080">^, </font>Ptr<font color="#000080">(</font><font color="#800000">$A000</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">)^, </font><font color="#800000">16000</font><font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Rotate<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>X<font color="#000080">, </font>Y<font color="#000080">, </font>ang <font color="#000080">: </font>Real<font color="#000080">);
</font>	<font color="#FF0000"><b>Var </b></font>XX<font color="#000080">, </font>YY <font color="#000080">: </font>Real<font color="#000080">;
</font>	<font color="#FF0000"><b>Begin
</b></font>   	XX <font color="#000080">:= </font>X<font color="#000080">*</font>Cos<font color="#000080">(</font>ang<font color="#000080">)+</font>Y<font color="#000080">*</font>Sin<font color="#000080">(</font>ang<font color="#000080">);
      </font>YY <font color="#000080">:= </font>Y<font color="#000080">*</font>Cos<font color="#000080">(</font>ang<font color="#000080">)-</font>X<font color="#000080">*</font>Sin<font color="#000080">(</font>ang<font color="#000080">);
      </font>X <font color="#000080">:= </font>XX<font color="#000080">;
      </font>Y <font color="#000080">:= </font>YY<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>RotateTris<font color="#000080">(</font>ang <font color="#000080">: </font>Real<font color="#000080">);
</font>	<font color="#FF0000"><b>Var </b></font>n <font color="#000080">: </font>Word<font color="#000080">;
</font>	<font color="#FF0000"><b>Begin
</b></font>   	n <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>Repeat
</b></font>      	<font color="#FF0000"><b>With </b></font>Tris<font color="#000080">[</font>n<font color="#000080">] </font><font color="#FF0000"><b>Do
</b></font>         	<font color="#FF0000"><b>Begin
</b></font>            	Rotate<font color="#000080">(</font>X1<font color="#000080">, </font>Z1<font color="#000080">, </font>ang<font color="#000080">);
</font>            	Rotate<font color="#000080">(</font>X2<font color="#000080">, </font>Z2<font color="#000080">, </font>ang<font color="#000080">);
</font>            	Rotate<font color="#000080">(</font>X3<font color="#000080">, </font>Z3<font color="#000080">, </font>ang<font color="#000080">);
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>      	n <font color="#000080">:= </font>n <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>Until </b></font>n <font color="#000080">= </font>Trin<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>RotateTrisb<font color="#000080">(</font>ang <font color="#000080">: </font>Real<font color="#000080">);
</font>	<font color="#FF0000"><b>Var </b></font>n <font color="#000080">: </font>Word<font color="#000080">;
</font>	<font color="#FF0000"><b>Begin
</b></font>   	n <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>Repeat
</b></font>      	<font color="#FF0000"><b>With </b></font>Tris<font color="#000080">[</font>n<font color="#000080">] </font><font color="#FF0000"><b>Do
</b></font>         	<font color="#FF0000"><b>Begin
</b></font>            	Rotate<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>ang<font color="#000080">);
</font>            	Rotate<font color="#000080">(</font>X2<font color="#000080">, </font>Y2<font color="#000080">, </font>ang<font color="#000080">);
</font>            	Rotate<font color="#000080">(</font>X3<font color="#000080">, </font>Y3<font color="#000080">, </font>ang<font color="#000080">);
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>      	n <font color="#000080">:= </font>n <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>Until </b></font>n <font color="#000080">= </font>Trin<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>RotateTrisc<font color="#000080">(</font>ang <font color="#000080">: </font>Real<font color="#000080">);
</font>	<font color="#FF0000"><b>Var </b></font>n <font color="#000080">: </font>Word<font color="#000080">;
</font>	<font color="#FF0000"><b>Begin
</b></font>   	n <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>Repeat
</b></font>      	<font color="#FF0000"><b>With </b></font>Tris<font color="#000080">[</font>n<font color="#000080">] </font><font color="#FF0000"><b>Do
</b></font>         	<font color="#FF0000"><b>Begin
</b></font>            	Rotate<font color="#000080">(</font>Y1<font color="#000080">, </font>Z1<font color="#000080">, </font>ang<font color="#000080">);
</font>            	Rotate<font color="#000080">(</font>Y2<font color="#000080">, </font>Z2<font color="#000080">, </font>ang<font color="#000080">);
</font>            	Rotate<font color="#000080">(</font>Y3<font color="#000080">, </font>Z3<font color="#000080">, </font>ang<font color="#000080">);
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>      	n <font color="#000080">:= </font>n <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>Until </b></font>n <font color="#000080">= </font>Trin<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
</b></font>	SetVideoMode<font color="#000080">(</font><font color="#800000">$13</font><font color="#000080">);
   </font>GetMem<font color="#000080">(</font>db<font color="#000080">, </font><font color="#800000">64000</font><font color="#000080">);
   </font><font color="#FF0000"><b>With </b></font>Tris<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>Do
</b></font>   	<font color="#FF0000"><b>Begin
</b></font>      	X1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>      	Y1 <font color="#000080">:= </font><font color="#800000">86</font><font color="#000080">;
</font>      	Z1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>      	X2 <font color="#000080">:= </font><font color="#800000">100</font><font color="#000080">;
</font>      	Y2 <font color="#000080">:= -</font><font color="#800000">86</font><font color="#000080">;
</font>      	Z2 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>      	X3 <font color="#000080">:= -</font><font color="#800000">100</font><font color="#000080">;
</font>      	Y3 <font color="#000080">:= -</font><font color="#800000">86</font><font color="#000080">;
</font>      	Z3 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>X1 <font color="#000080">:= </font>X1 <font color="#000080">* </font>Sc<font color="#000080">;
   </font>Y1 <font color="#000080">:= </font>Y1 <font color="#000080">* </font>Sc<font color="#000080">;
   </font>Z1 <font color="#000080">:= </font>Z1 <font color="#000080">* </font>Sc<font color="#000080">;
   </font>X2 <font color="#000080">:= </font>X2 <font color="#000080">* </font>Sc<font color="#000080">;
   </font>Y2 <font color="#000080">:= </font>Y2 <font color="#000080">* </font>Sc<font color="#000080">;
   </font>Z2 <font color="#000080">:= </font>Z2 <font color="#000080">* </font>Sc<font color="#000080">;
   </font>X3 <font color="#000080">:= </font>X3 <font color="#000080">* </font>Sc<font color="#000080">;
   </font>Y3 <font color="#000080">:= </font>Y3 <font color="#000080">* </font>Sc<font color="#000080">;
   </font>Z3 <font color="#000080">:= </font>Z3 <font color="#000080">* </font>Sc<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>Trin <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font>l <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
   </font><font color="#FF0000"><b>Repeat
</b></font>   	n <font color="#000080">:= </font>hn<font color="#000080">;
      </font>hn <font color="#000080">:= </font>Trin<font color="#000080">;
</font>   	<font color="#FF0000"><b>Repeat
</b></font>      	AddTris<font color="#000080">(</font>n<font color="#000080">);
</font>      	n <font color="#000080">:= </font>n <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>Until </b></font>n <font color="#000080">= </font>hn<font color="#000080">;
</font>   	l <font color="#000080">:= </font>l <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>Until </b></font>l <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>Repeat
</b></font>   	n <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>   	<font color="#FF0000"><b>Repeat
</b></font>	   	DrawTris<font color="#000080">;
</font>	      RotateTris<font color="#000080">(</font>Pi<font color="#000080">/</font><font color="#800000">72</font><font color="#000080">);
         </font>n <font color="#000080">:= </font>n <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>Until </b></font>KeyPressed <font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>n <font color="#000080">= </font><font color="#800000">144</font><font color="#000080">);
</font>   	n <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>   	<font color="#FF0000"><b>Repeat
</b></font>	   	DrawTris<font color="#000080">;
</font>	      RotateTrisb<font color="#000080">(</font>Pi<font color="#000080">/</font><font color="#800000">72</font><font color="#000080">);
         </font>n <font color="#000080">:= </font>n <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>Until </b></font>KeyPressed <font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>n <font color="#000080">= </font><font color="#800000">144</font><font color="#000080">);
</font>   	n <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>   	<font color="#FF0000"><b>Repeat
</b></font>	   	DrawTris<font color="#000080">;
</font>	      RotateTrisc<font color="#000080">(</font>Pi<font color="#000080">/</font><font color="#800000">72</font><font color="#000080">);
         </font>n <font color="#000080">:= </font>n <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>Until </b></font>KeyPressed <font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>n <font color="#000080">= </font><font color="#800000">144</font><font color="#000080">);
   </font><font color="#FF0000"><b>Until </b></font>KeyPressed<font color="#000080">;
   </font><font color="#FF0000"><b>Repeat </b></font>Ch <font color="#000080">:= </font>ReadKey <font color="#FF0000"><b>Until Not </b></font>KeyPressed<font color="#000080">;
   </font>SetVideoMode<font color="#000080">(</font><font color="#800000">$03</font><font color="#000080">);
   </font>Credit<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0250.PAS">Original</a><b>]</b></p></body>
</html>
