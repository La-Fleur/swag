<html>
<head><title> "Kill Underscore" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CMDLINE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
This is another BAsm I've written to optimize my Program. Some of the
comma-delimited fields have the Underscore Character in the place of Spaces. It
is desirable For them to be replaced For use in my Program.

BeFore writing this Procedure I was using:

Procedure Kill_(Var Strng : String);
Repeat
  Subpos := Pos('_',String);
  if subpos &gt; 0
     then Strng[subpos] := ' ';
Until Killpos Subpos = 0;
end;

This was getting called approx 250,000 times in my project, and Turbo ProFiler
practically waved a red flag at me about it!  &lt;grin&gt;

This is my new Procedure which screams as Compared to the previous routine.

I am using TP 6.0 Professional.

-------------  Code Snippet begins  --------------
}
</i></font><font color="#FF0000"><b>Procedure </b></font>KILL_<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>STRNG<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ This Procedure KILLS Underscores from a String _and MODifIES THE orIGinAL_ }
</i></font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">LES DI, STRNG
  xor CX, CX
  MOV CL, [ES:DI] </font><font color="#008000"><i>{ Get String Length}
  </i></font><font color="#FF00FF">MOV AL, '_'
  inC DI  </font><font color="#008000"><i>{ Point to FIRST String Char }
  </i></font><font color="#FF00FF">CLD
@Scan_For_underscore_loop:
  SCASB
  JE @FOUND_UNDERSCorE
  LOOP @SCAN_For_UNDERSCorE_LOOP
  JMP @OUTTATHIS
@FOUND_UNDERSCorE:
  DEC DI
  MOV Byte PTR [ES:DI], ' '
  inc di
  jmp @scan_For_underscore_loop
(92 min left), (H)elp, More? @OUTTATHIS:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
Does anyone more knowledgable in Assembly than I am have any suggestions For
this Procedure?   I Realize I am working With the original copy of the String
with this Procedure, and modifying it to boot, but I am saving the time to copy
it to/from the stack when I am making the changes.    My Program doES take this
into account, and ONLY passes Strings to the procedure.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CMDLINE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p></body>
</html>
