<html>
<head><title> "Command Line Unit" by JIM WALSH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CMDLINE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>CmdLin<font color="#000080">;
</font><font color="#008000"><i>(*
   This unit will process command line flags, (/N -N)
        a) as present or absent (Is_Param)
        b) with an integer (eg. /N54 /X-76) (Param_Int)
        c) with a real number (eg /J-987.65) (Param_Real)
        d) with strings, including delimited strings with embedded spaces
           ( eg. /X&quot;This is the story!&quot; /YFred)

      Routines are included to count and return the parameters that
      aren't flags (Non_Flag_Count), and to return them without
      counting the flag parameters (Non_Flag_Param).

      So ( /X76 Filename.txt /N&quot;My name is Fred.&quot; George ) would count
      two non-flag params, #1 = filename.txt and #2 = george.

      This is completely public domain, all I want in return for your use
      is appreciation.  If you improve this unit, please let me know.
      Some possible improvements would be to allow embedded strings in
      non-flag parameters.  I haven't done this because I haven't needed
      it.


      Jim Walsh      CIS:72571,173

*)

</i></font><font color="#FF0000"><b>INTERFACE

  function </b></font>Is_Param<font color="#000080">(</font>flag<font color="#000080">:</font>Char<font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#008000"><i>{ Responds yes if the flag (ie N) is found in the command line (ie /N or -N) }

  </i></font><font color="#FF0000"><b>function </b></font>Param_Int<font color="#000080">(</font>flag<font color="#000080">:</font>Char<font color="#000080">) : </font>LongInt<font color="#000080">;
  </font><font color="#008000"><i>{ Returns the integer value after the parameter, ie -M100, or -M-123 }

  </i></font><font color="#FF0000"><b>function </b></font>Param_Real<font color="#000080">(</font>flag<font color="#000080">:</font>Char<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>{ Returns the Real value after the parameter, ie -X654.87, or -x-3.14159 }

  </i></font><font color="#FF0000"><b>function </b></font>Param_Text<font color="#000080">(</font>flag<font color="#000080">:</font>Char<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Returns the string after the parameter, ie -MHello -&gt; 'Hello',            }
  {  -m&quot;This is it, baby&quot; -&gt; 'This is it, baby', valid string delims='' &quot;&quot; [] }

  </i></font><font color="#FF0000"><b>function </b></font>Non_Flag_Param<font color="#000080">(</font>index<font color="#000080">:</font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Returns the indexth parameter, not preceded with a flag delimeter }
  { /X Text.txt /Y876.76 /G&quot;Yes sir!&quot; MeisterBrau /?                  }
  { For this command line 'Text.txt' is Non Flag Param #1,            }
  {    and 'MeisterBrau is #2.                                        }
  { NB: Delimeted Non flag parameters (eg &quot;Meister Brau&quot;)             }
  {  not currently supported.                                         }

  </i></font><font color="#FF0000"><b>function </b></font>Non_Flag_Count <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#008000"><i>{ Returns the number of non-flag type parameters }


</i></font><font color="#FF0000"><b>IMPLEMENTATION
const
  </b></font>flag_delims   <font color="#000080">: </font><font color="#FF0000"><b>Set of </b></font>Char <font color="#000080">= [</font><font color="#800000">'/'</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">];
  </font>no_of_string_delims <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>string_delim_type <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of record
                                       </b></font>start<font color="#000080">, </font>stop <font color="#000080">: </font>char
                                     <font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>string_delims <font color="#000080">: </font>string_delim_type <font color="#000080">= ((</font>start<font color="#000080">:</font><font color="#800000">#39</font><font color="#000080">; </font>stop<font color="#000080">:</font><font color="#800000">#39</font><font color="#000080">),
                                       (</font>start<font color="#000080">:</font><font color="#800000">#34</font><font color="#000080">; </font>stop<font color="#000080">:</font><font color="#800000">#34</font><font color="#000080">),
                                       (</font>start<font color="#000080">:</font><font color="#800000">'['</font><font color="#000080">; </font>stop<font color="#000080">:</font><font color="#800000">']'</font><font color="#000080">));


</font><font color="#FF0000"><b>function </b></font>LowerCaseChar<font color="#000080">(</font>c<font color="#000080">:</font>char<font color="#000080">):</font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>c<font color="#000080">&gt;=</font><font color="#800000">'A'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c<font color="#000080">&lt;=</font><font color="#800000">'Z'</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>LowerCaseChar<font color="#000080">:=</font>Char<font color="#000080">(</font>Ord<font color="#000080">(</font>c<font color="#000080">)+</font><font color="#800000">$20</font><font color="#000080">)
                           </font><font color="#FF0000"><b>Else </b></font>LowerCaseChar<font color="#000080">:=</font>c<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{----------------------------------------------------------------------------}
  </i></font><font color="#FF0000"><b>function </b></font>WhereFlagOccurs<font color="#000080">(</font>flag<font color="#000080">:</font>Char<font color="#000080">) : </font>integer<font color="#000080">;
  </font><font color="#008000"><i>{  returns the index number of the paramter where the flag occurs  }
  {  if the flag is never found, it returns 0                        }
  </i></font><font color="#FF0000"><b>var
    </b></font>ti1      <font color="#000080">: </font>integer<font color="#000080">;
    </font>finished <font color="#000080">: </font>boolean<font color="#000080">;
    </font>paramcnt <font color="#000080">: </font>integer<font color="#000080">;
    </font>ts1      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>flag<font color="#000080">:=</font>LowerCaseChar<font color="#000080">(</font>flag<font color="#000080">);
    </font>finished<font color="#000080">:=</font>false<font color="#000080">;
    </font>ti1<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font>paramcnt<font color="#000080">:=</font>ParamCount<font color="#000080">;
    </font><font color="#FF0000"><b>While Not</b></font><font color="#000080">(</font>finished<font color="#000080">) </font><font color="#FF0000"><b>Do begin
      If </b></font>ti1<font color="#000080">&gt;</font>paramcnt <font color="#FF0000"><b>Then begin
        </b></font>finished<font color="#000080">:=</font>true<font color="#000080">;
        </font>ti1<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>end Else begin
        </b></font>ts1<font color="#000080">:=</font>ParamStr<font color="#000080">(</font>ti1<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>ts1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>In </b></font>flag_delims<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>LowerCaseChar<font color="#000080">(</font>ts1<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">])=</font>flag<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>finished<font color="#000080">:=</font>true<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If Not</b></font><font color="#000080">(</font>finished<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>ti1<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{While}
    </i></font>WhereFlagOccurs<font color="#000080">:=</font>ti1<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{----------------------------------------------------------------------------}
  </i></font><font color="#FF0000"><b>function </b></font>Is_Param<font color="#000080">(</font>flag<font color="#000080">:</font>Char<font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    If </b></font>WhereFlagOccurs<font color="#000080">(</font>flag<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Is_Param<font color="#000080">:=</font>false <font color="#FF0000"><b>Else </b></font>Is_Param<font color="#000080">:=</font>true<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{----------------------------------------------------------------------------}
  </i></font><font color="#FF0000"><b>function </b></font>Param_Int<font color="#000080">(</font>flag<font color="#000080">:</font>Char<font color="#000080">) : </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>param_loc <font color="#000080">: </font>integer<font color="#000080">;
    </font>result    <font color="#000080">: </font>longint<font color="#000080">;
    </font>ts1       <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>ti1       <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>param_loc<font color="#000080">:=</font>WhereFlagOccurs<font color="#000080">(</font>flag<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>param_loc<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>result<font color="#000080">:=</font><font color="#800000">0
    </font><font color="#FF0000"><b>Else begin
      </b></font>ts1<font color="#000080">:=</font>ParamStr<font color="#000080">(</font>param_loc<font color="#000080">);     </font><font color="#008000"><i>{ Get the string }
      </i></font>ts1<font color="#000080">:=</font>Copy<font color="#000080">(</font>ts1<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);         </font><font color="#008000"><i>{ Get rid of the delim and the flag }
      </i></font>Val<font color="#000080">(</font>ts1<font color="#000080">,</font>result<font color="#000080">,</font>ti1<font color="#000080">);          </font><font color="#008000"><i>{ Make the value }
      </i></font><font color="#FF0000"><b>If </b></font>ti1<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>result<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;     </font><font color="#008000"><i>{ Make sure there is no error }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{If/Else}
    </i></font>Param_Int<font color="#000080">:=</font>result
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{----------------------------------------------------------------------------}
  </i></font><font color="#FF0000"><b>function </b></font>Param_Real<font color="#000080">(</font>flag<font color="#000080">:</font>Char<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>param_loc <font color="#000080">: </font>integer<font color="#000080">;
    </font>result    <font color="#000080">: </font>real<font color="#000080">;
    </font>ts1       <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>ti1       <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>param_loc<font color="#000080">:=</font>WhereFlagOccurs<font color="#000080">(</font>flag<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>param_loc<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>result<font color="#000080">:=</font><font color="#800000">0.0
    </font><font color="#FF0000"><b>Else begin
      </b></font>ts1<font color="#000080">:=</font>ParamStr<font color="#000080">(</font>param_loc<font color="#000080">);     </font><font color="#008000"><i>{ Get the string }
      </i></font>ts1<font color="#000080">:=</font>Copy<font color="#000080">(</font>ts1<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);         </font><font color="#008000"><i>{ Get rid of the delim and the flag }
      </i></font>Val<font color="#000080">(</font>ts1<font color="#000080">,</font>result<font color="#000080">,</font>ti1<font color="#000080">);          </font><font color="#008000"><i>{ Make the value }
      </i></font><font color="#FF0000"><b>If </b></font>ti1<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>result<font color="#000080">:=</font><font color="#800000">0.0</font><font color="#000080">;   </font><font color="#008000"><i>{ Make sure there is no error }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{If/Else}
    </i></font>Param_Real<font color="#000080">:=</font>result<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{----------------------------------------------------------------------}
  </i></font><font color="#FF0000"><b>function </b></font>Which_String_Delim<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>byte<font color="#000080">;
  </font><font color="#008000"><i>{ Returns the index of the strings first character in the array
    of string_delims, if the first char of S isn't a delim it returns 0 }
  </i></font><font color="#FF0000"><b>var
    </b></font>tc1 <font color="#000080">: </font>char<font color="#000080">;
    </font>tb1 <font color="#000080">: </font>byte<font color="#000080">;
    </font>finished <font color="#000080">: </font>boolean<font color="#000080">;
    </font>result   <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>tc1<font color="#000080">:=</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
    </font>tb1<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font>finished<font color="#000080">:=</font>false<font color="#000080">;
    </font><font color="#FF0000"><b>While Not</b></font><font color="#000080">(</font>finished<font color="#000080">) </font><font color="#FF0000"><b>Do begin
      If </b></font>tb1<font color="#000080">&gt;</font>no_of_string_delims <font color="#FF0000"><b>Then begin
        </b></font>result<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font>finished<font color="#000080">:=</font>true<font color="#000080">;
      </font><font color="#FF0000"><b>end Else begin
        If </b></font>tc1<font color="#000080">=</font>string_delims<font color="#000080">[</font>tb1<font color="#000080">].</font>start <font color="#FF0000"><b>Then begin
          </b></font>result<font color="#000080">:=</font>tb1<font color="#000080">;
          </font>finished<font color="#000080">:=</font>true<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If Not</b></font><font color="#000080">(</font>finished<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>tb1<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{While}
    </i></font>Which_String_Delim<font color="#000080">:=</font>result<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function Which_String}

{-------------------------------------------------------------------------}
  </i></font><font color="#FF0000"><b>function </b></font>Param_Text<font color="#000080">(</font>flag<font color="#000080">:</font>Char<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>param_loc <font color="#000080">: </font>integer<font color="#000080">;
    </font>param_cnt <font color="#000080">: </font>integer<font color="#000080">;
    </font>result    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>ts1       <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>ti1       <font color="#000080">: </font>integer<font color="#000080">;
    </font>s_delim   <font color="#000080">: </font>byte<font color="#000080">;          </font><font color="#008000"><i>{ This should be 0(no string), 1', 2&quot;, 3[ }
    </i></font>finished  <font color="#000080">: </font>boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>param_loc<font color="#000080">:=</font>WhereFlagOccurs<font color="#000080">(</font>flag<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>param_loc<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>result<font color="#000080">:=</font><font color="#800000">''
    </font><font color="#FF0000"><b>Else begin
      </b></font>ts1<font color="#000080">:=</font>ParamStr<font color="#000080">(</font>param_loc<font color="#000080">);     </font><font color="#008000"><i>{ Get the string }
      </i></font>ts1<font color="#000080">:=</font>Copy<font color="#000080">(</font>ts1<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);         </font><font color="#008000"><i>{ Get rid of the delim and the flag }
      { See if the first char of ts1 is one of the string_delims }
      </i></font>s_delim<font color="#000080">:=</font>Which_String_Delim<font color="#000080">(</font>ts1<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>s_delim<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>result<font color="#000080">:=</font>ts1
      <font color="#FF0000"><b>Else begin
        </b></font>result<font color="#000080">:=</font>Copy<font color="#000080">(</font>ts1<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);    </font><font color="#008000"><i>{ Drop the s_delim }
        </i></font>finished<font color="#000080">:=</font>false<font color="#000080">;
        </font>param_cnt<font color="#000080">:=</font>ParamCount<font color="#000080">;
        </font><font color="#FF0000"><b>While Not</b></font><font color="#000080">(</font>finished<font color="#000080">) </font><font color="#FF0000"><b>Do begin
          </b></font>Inc<font color="#000080">(</font>param_loc<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>param_loc<font color="#000080">&gt;</font>param_cnt <font color="#FF0000"><b>Then </b></font>finished<font color="#000080">:=</font>true
          <font color="#FF0000"><b>Else begin
            </b></font>ts1<font color="#000080">:=</font>ParamStr<font color="#000080">(</font>param_loc<font color="#000080">);
            </font><font color="#FF0000"><b>If </b></font>ts1<font color="#000080">[</font>Length<font color="#000080">(</font>ts1<font color="#000080">)]=</font>string_delims<font color="#000080">[</font>s_delim<font color="#000080">].</font>stop <font color="#FF0000"><b>Then </b></font>finished<font color="#000080">:=</font>true<font color="#000080">;
            </font>result<font color="#000080">:=</font>result<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">+</font>ts1<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ If/Else }
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ While }
        </i></font>result<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>Char<font color="#000080">(</font>Length<font color="#000080">(</font>result<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);      </font><font color="#008000"><i>{ Drop the last delimeter }
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ If/Else a delimited string }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ If/Else the flag is found }
    </i></font>Param_Text<font color="#000080">:=</font>result<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------------------------}
  </i></font><font color="#FF0000"><b>function </b></font>Non_Flag_Param<font color="#000080">(</font>index<font color="#000080">:</font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>param_cnt <font color="#000080">: </font>integer<font color="#000080">;
    </font>ti1       <font color="#000080">: </font>integer<font color="#000080">;
    </font>ts1       <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>finished  <font color="#000080">: </font>boolean<font color="#000080">;
    </font>cur_index <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>param_cnt<font color="#000080">:=</font>ParamCount<font color="#000080">;
    </font>cur_index<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font>ti1<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font>finished<font color="#000080">:=</font>false<font color="#000080">;
    </font><font color="#FF0000"><b>While Not</b></font><font color="#000080">(</font>finished<font color="#000080">) </font><font color="#FF0000"><b>Do begin
      </b></font>Inc<font color="#000080">(</font>ti1<font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>cur_index<font color="#000080">&gt;</font>param_cnt <font color="#FF0000"><b>Then begin
        </b></font>ts1<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font>finished<font color="#000080">:=</font>true<font color="#000080">;
      </font><font color="#FF0000"><b>end Else begin
        </b></font>ts1<font color="#000080">:=</font>ParamStr<font color="#000080">(</font>ti1<font color="#000080">);
        </font><font color="#FF0000"><b>If Not</b></font><font color="#000080">(</font>ts1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>flag_delims<font color="#000080">) </font><font color="#FF0000"><b>Then begin
          </b></font>Inc<font color="#000080">(</font>cur_index<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>cur_index<font color="#000080">=</font>index <font color="#FF0000"><b>Then </b></font>finished<font color="#000080">:=</font>true<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{If/Else}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{While}
    </i></font>Non_Flag_Param<font color="#000080">:=</font>ts1<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------------------------}
  </i></font><font color="#FF0000"><b>function </b></font>Non_Flag_Count <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>param_cnt <font color="#000080">: </font>integer<font color="#000080">;
    </font>result    <font color="#000080">: </font>integer<font color="#000080">;
    </font>ti1       <font color="#000080">: </font>integer<font color="#000080">;
    </font>ts1       <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>param_cnt<font color="#000080">:=</font>ParamCount<font color="#000080">;
    </font>result<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font>ti1<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>ti1<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>param_cnt <font color="#FF0000"><b>Do begin
      </b></font>ts1<font color="#000080">:=</font>ParamStr<font color="#000080">(</font>ti1<font color="#000080">);
      </font><font color="#FF0000"><b>If Not</b></font><font color="#000080">(</font>ts1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>flag_delims<font color="#000080">) </font><font color="#FF0000"><b>Then begin
        </b></font>Inc<font color="#000080">(</font>result<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{For}
    </i></font>Non_Flag_Count<font color="#000080">:=</font>result<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;




</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CMDLINE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p></body>
</html>
