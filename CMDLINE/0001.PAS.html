<html>
<head><title> "Get Command line INFO" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CMDLINE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; This leads me to a question that I've often wondered about, but never
&gt; Really bothered to ask anyone: why use a delimiter (commonly '/' or '-')
&gt; preceeding the parameter option?

How would you parse the following command tail:

COPY XYZZY.PAS V:\/S/P/O

if it was entered as

COPY XYZZY.PAS V:\SPO

The delimiter is there to - yes - delimit the parameter from the Text preceding
it.

(and BTW: All the code examples shown here won't take care of this problem,
since they don't allow imbedded parameters. Try this one instead:)
}

</i></font><font color="#FF0000"><b>Function </b></font>CAPS<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">PUSH    DS
  LDS     SI,S
  LES     DI,@Result
  CLD
  LODSB
  STOSB
  xor     CH,CH
  MOV     CL,AL
  JCXZ    @OUT
@LOOP:  LODSB
  CMP     AL,'a'
  JB      @NEXT
  CMP     AL,'z'
  JA      @NEXT
  SUB     AL,20h
@NEXT:  STOSB
  LOOP    @LOOP
@OUT:   POP   DS
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Switch<font color="#000080">(</font>C <font color="#000080">: </font>Char<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>CommandTail         <font color="#000080">: ^</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>P                   <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>CommandTail <font color="#000080">:= </font>PTR<font color="#000080">(</font>PrefixSeg<font color="#000080">, </font><font color="#800000">$0080</font><font color="#000080">);
  </font>P <font color="#000080">:= </font>POS<font color="#000080">(</font><font color="#800000">'/' </font><font color="#000080">+ </font>UpCase<font color="#000080">(</font>C<font color="#000080">), </font>CAPS<font color="#000080">(</font>CommandTail<font color="#000080">^));
  </font><font color="#FF0000"><b>if </b></font>P <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Switch <font color="#000080">:= </font>False
  <font color="#FF0000"><b>ELSE
  begin
    </b></font>Switch <font color="#000080">:= </font>True<font color="#000080">;
    </font>DELETE<font color="#000080">(</font>CommandTail<font color="#000080">^, </font>P<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">)
  </font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
The CAPS routine only converts the 'a' to 'z' range (I have one in my library
that converts all international Characters, but this was a simple one I could
Type in without looking in my library).

The Switch Function also has the added benefit that it strips off the switch
from the command line after having tested For it. This way, you should Program
your Programs in the following way:

[...]
}
</i></font><font color="#FF0000"><b>begin
  </b></font>GetSwitchs<font color="#000080">;
  </font>CopyFile<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">),</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">))
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
and the switches can then be at ANY place on the command line, and the Program
will still Function correctly.
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CMDLINE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p></body>
</html>
