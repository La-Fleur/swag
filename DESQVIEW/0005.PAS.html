<html>
<head><title> "DESQVIEW API Routines" by MIKE DICKSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DESQVIEW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
********************************************************************
*                                                                  *
*  DESQview API routines                                           *
*  for Turbo Pascal 6.0                                            *
*  by Jonathan L. Zarate                                           *
*  Released to the Public Domain                                   *
*                                                                  *
********************************************************************
}
{
  ** Please refer to Ralf Brown's Interrupt List
  ** for additional information.
}

</i></font><font color="#FF0000"><b>Unit </b></font>DV<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Type
 </b></font>Msg_Write2 <font color="#000080">= </font><font color="#FF0000"><b>record
               </b></font>len <font color="#000080">: </font>longint<font color="#000080">;
               </font>str <font color="#000080">: </font>pointer<font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>Msg_Write2_NewWin <font color="#000080">= </font><font color="#FF0000"><b>record
                      </b></font>len    <font color="#000080">: </font>longint<font color="#000080">;
                      </font>str    <font color="#000080">: </font>pointer<font color="#000080">;
                      </font>handle <font color="#000080">: </font>pointer<font color="#000080">;
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const
</b></font><font color="#008000"><i>{ Stream Types }
 </i></font>WinStream     <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">;
 </font>QueryStream   <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">;
 </font>ManagerStream <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">;

</font><font color="#008000"><i>{ Manager Streams }
 </i></font>MStream_MoveHoriz    <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">;     </font><font color="#008000"><i>{ horizontal movement  }
 </i></font>MStream_MoveVert     <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">;     </font><font color="#008000"><i>{ vertical movement  }
 </i></font>MStream_ChangeWidth  <font color="#000080">= </font><font color="#800000">$02</font><font color="#000080">;     </font><font color="#008000"><i>{ width change  }
 </i></font>MStream_ChangeHeight <font color="#000080">= </font><font color="#800000">$03</font><font color="#000080">;     </font><font color="#008000"><i>{ height change  }
 </i></font>MStream_ScrollHoriz  <font color="#000080">= </font><font color="#800000">$04</font><font color="#000080">;     </font><font color="#008000"><i>{ horizontal scroll  }
 </i></font>MStream_ScrollVert   <font color="#000080">= </font><font color="#800000">$05</font><font color="#000080">;     </font><font color="#008000"><i>{ vertical scroll  }
 </i></font>MStream_CloseWindow  <font color="#000080">= </font><font color="#800000">$06</font><font color="#000080">;     </font><font color="#008000"><i>{ close window option }
 </i></font>MStream_HideWindow   <font color="#000080">= </font><font color="#800000">$07</font><font color="#000080">;     </font><font color="#008000"><i>{ hide window option }
 </i></font>MStream_FreezeApp    <font color="#000080">= </font><font color="#800000">$08</font><font color="#000080">;     </font><font color="#008000"><i>{ freeze window option }
 </i></font>MStream_ScissorsMenu <font color="#000080">= </font><font color="#800000">$0E</font><font color="#000080">;     </font><font color="#008000"><i>{ scissors menu }
 </i></font>MStream_MainMenu     <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">;     </font><font color="#008000"><i>{ main DESQview menu }
 </i></font>MStream_SwitchWinMenu<font color="#000080">= </font><font color="#800000">$11</font><font color="#000080">;     </font><font color="#008000"><i>{ switch windows menu }
 </i></font>MStream_OpenWinMenu  <font color="#000080">= </font><font color="#800000">$12</font><font color="#000080">;     </font><font color="#008000"><i>{ open windows menu }
 </i></font>MStream_QuitMenu     <font color="#000080">= </font><font color="#800000">$13</font><font color="#000080">;     </font><font color="#008000"><i>{ quit menu }

{ Window/Query streams }
 </i></font>WStream_CursorRow    <font color="#000080">= </font><font color="#800000">$A0</font><font color="#000080">;     </font><font color="#008000"><i>{ Cursor row }
 </i></font>WStream_CursorColumn <font color="#000080">= </font><font color="#800000">$A1</font><font color="#000080">;     </font><font color="#008000"><i>{ Cursor Column }
 </i></font>WStream_ScrollTopRow <font color="#000080">= </font><font color="#800000">$A2</font><font color="#000080">;     </font><font color="#008000"><i>{ Top row of scrolling region }

{ DVError Constants }
 </i></font>DVErrorMouEither   <font color="#000080">= </font><font color="#800000">00</font><font color="#000080">;        </font><font color="#008000"><i>{ use either mouse buttons to remove window }
 </i></font>DVErrorMouRight    <font color="#000080">= </font><font color="#800000">32</font><font color="#000080">;        </font><font color="#008000"><i>{ use right mouse button to remove window }
 </i></font>DVErrorMouLeft     <font color="#000080">= </font><font color="#800000">64</font><font color="#000080">;        </font><font color="#008000"><i>{ use left mouse button to remove window }
 </i></font>DVErrorBeep        <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">;       </font><font color="#008000"><i>{ beep on error }
{ ----------------------- }

</i></font><font color="#FF0000"><b>const
 </b></font>InDV        <font color="#000080">: </font>boolean <font color="#000080">= </font>false<font color="#000080">;  </font><font color="#008000"><i>{ In DESQview flag }
 </i></font>DV_Version  <font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">$0000</font><font color="#000080">;     </font><font color="#008000"><i>{ DESQview version }

</i></font><font color="#FF0000"><b>var
 </b></font>DVArray     <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">80</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">; </font><font color="#008000"><i>{ stream array }

</i></font><font color="#FF0000"><b>function  </b></font>DVInit <font color="#000080">: </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DVGetVersion<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>DVGetShadowSeg<font color="#000080">( </font>VideoSeg <font color="#000080">: </font>word <font color="#000080">) : </font>word<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DVPause<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DVBeginC<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DVEndC<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>DVAPPNum <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DVSendMsg<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>_bh<font color="#000080">, </font>_bl <font color="#000080">: </font>byte<font color="#000080">; </font>size <font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>param<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVStream<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>mode <font color="#000080">: </font>byte<font color="#000080">; </font>params <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>DVGetHandle<font color="#000080">( </font>HandleType <font color="#000080">: </font>byte <font color="#000080">) : </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DVSound<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>frequency<font color="#000080">, </font>duration <font color="#000080">: </font>word <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVError<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>xsize<font color="#000080">, </font>ysize <font color="#000080">: </font>byte<font color="#000080">; </font>msg <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>params<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVAPILevel<font color="#000080">( </font>major<font color="#000080">, </font>minor <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVWrite<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>s <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVWriteln<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>s <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>DVNewWin<font color="#000080">( </font>x<font color="#000080">, </font>y <font color="#000080">: </font>word <font color="#000080">) : </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DVFree<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>DVTimer_New <font color="#000080">: </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DVTimer_Start<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>Time <font color="#000080">: </font>longint <font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>DVTimer_Len<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">) : </font>longint<font color="#000080">;
</font><font color="#008000"><i>{ ---- Window Streams ---- }
</i></font><font color="#FF0000"><b>procedure </b></font>DVClear<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVRedraw<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVResize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVMove<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>shortint <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVTitle<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>title <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVMove2<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>shortint <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVResize2<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>shortint <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVSetAttr<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>color <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVFrameAttr<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>color <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVFrameOn<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>b <font color="#000080">: </font>boolean <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVWinUnHide<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVWinHide<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVGotoXY<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVSetVirtualWinSize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#008000"><i>{ -- Manager Streams -- }
</i></font><font color="#FF0000"><b>procedure </b></font>DVAllow<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>command <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVDisallow<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>command <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVForeOnly<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>b <font color="#000080">: </font>boolean <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVMinWinSize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVMaxWinSize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVForceForeground<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVForceBackground<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVTopProcess<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVBottomProcess<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#008000"><i>{ ---- Query Streams ---- }
</i></font><font color="#FF0000"><b>procedure </b></font>DVQSize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVQPos<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x<font color="#000080">, </font>y <font color="#000080">: </font>shortint <font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DVQVirtualWinSize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>DVWhereX<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">) : </font>shortint<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>DVWhereY<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">) : </font>shortint<font color="#000080">;

</font><font color="#FF0000"><b>Implementation

function </b></font>DVInit <font color="#000080">: </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ get DESQview version &amp; get our window handle }
 </i></font>DVGetVersion<font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>InDV <font color="#FF0000"><b>then </b></font>DVInit<font color="#000080">:=</font>DVGetHandle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVGetVersion<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#008000"><i>{ get DESQview version/set InDV flag }
 </i></font><font color="#FF00FF">mov cx,'DE'
 mov dx,'SQ'
 mov ax,2b01h
 int 21h
 cmp al,0ffh
 je @GV1
 mov DV_Version,bx
 mov InDV,True
 jmp @GV2
@GV1:
 mov InDV,False
@GV2:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DVGetShadowSeg<font color="#000080">( </font>VideoSeg <font color="#000080">: </font>word <font color="#000080">) : </font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#008000"><i>{ get task's shadow buffer &amp; start shadowing }
 </i></font><font color="#FF00FF">mov ax,VideoSeg
 mov es,ax
 mov di,0
 mov ah,0feh
 int 10h
 mov ax,es
 </font><font color="#008000"><i>{ di=offset ??don't know if used?? }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVPause<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#008000"><i>{ give up CPU time }
 </i></font><font color="#FF00FF">mov ax,1000h
 int $15
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVBeginC<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#008000"><i>{ begin critical region }
 </i></font><font color="#FF00FF">mov ax,101bh
 int $15
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVEndC<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#008000"><i>{ end critical region }
 </i></font><font color="#FF00FF">mov ax,101ch
 int $15
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DVAPPNum <font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#008000"><i>{ get application's switch number }
 </i></font><font color="#FF00FF">mov ax,0de07h
 int 15h
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVSendMsg<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>_BH<font color="#000080">, </font>_BL <font color="#000080">: </font>byte<font color="#000080">;
                      </font>size <font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>param <font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">std           </font><font color="#008000"><i>{ string goes backwards }
 </i></font><font color="#FF00FF">mov dx,sp     </font><font color="#008000"><i>{ save sp }

 </i></font><font color="#FF00FF">mov cx,size   </font><font color="#008000"><i>{ load size of param }
 </i></font><font color="#FF00FF">jcxz @SM2     </font><font color="#008000"><i>{ if zero then don't push anything }

 </i></font><font color="#FF00FF">mov bx,ds     </font><font color="#008000"><i>{ save ds }

 </i></font><font color="#FF00FF">lds si,param  </font><font color="#008000"><i>{ load address of param }
 </i></font><font color="#FF00FF">add si,cx     </font><font color="#008000"><i>{ start from the top }
 </i></font><font color="#FF00FF">dec si        </font><font color="#008000"><i>{ minus 2 }
 </i></font><font color="#FF00FF">dec si        </font><font color="#008000"><i>{ ^^^^^^^ }
 </i></font><font color="#FF00FF">shr cx,1      </font><font color="#008000"><i>{ cx:=cx div 2 }
</i></font><font color="#FF00FF">@SM1:
 lodsw         </font><font color="#008000"><i>{ load 1 word }
 </i></font><font color="#FF00FF">push ax       </font><font color="#008000"><i>{ push it }
 </i></font><font color="#FF00FF">loop @SM1      </font><font color="#008000"><i>{ if cx &gt; 0 loop }

 </i></font><font color="#FF00FF">mov ds,bx     </font><font color="#008000"><i>{ restore ds }
</i></font><font color="#FF00FF">@SM2:
 les di,Handle </font><font color="#008000"><i>{ get handle }
 </i></font><font color="#FF00FF">mov ax,es     </font><font color="#008000"><i>{ move es to ax for compare }
 </i></font><font color="#FF00FF">cmp ax,0      </font><font color="#008000"><i>{ if segment is 0 then }
 </i></font><font color="#FF00FF">je @SM3       </font><font color="#008000"><i>{ don't push handle }
 </i></font><font color="#FF00FF">push es       </font><font color="#008000"><i>{ push segment }
 </i></font><font color="#FF00FF">push di       </font><font color="#008000"><i>{ push offset }
</i></font><font color="#FF00FF">@SM3:
 mov ah,$12
 mov bh,_bh
 mov bl,_bl
 int $15       </font><font color="#008000"><i>{ call dv }

 </i></font><font color="#FF00FF">cld           </font><font color="#008000"><i>{ string goes forward }
 </i></font><font color="#FF00FF">mov ax,sp     </font><font color="#008000"><i>{ calculate the number of }
 </i></font><font color="#FF00FF">mov cx,dx     </font><font color="#008000"><i>{ returned parameter(s) }
 </i></font><font color="#FF00FF">sub cx,ax     </font><font color="#008000"><i>{ in stack }

 </i></font><font color="#FF00FF">jcxz @SMX      </font><font color="#008000"><i>{ exit if none }
 </i></font><font color="#FF00FF">les di,param  </font><font color="#008000"><i>{ load address of param }
 </i></font><font color="#FF00FF">add di,size
 shr cx,1      </font><font color="#008000"><i>{ cx:=cx div 2 }
</i></font><font color="#FF00FF">@SM4:
 pop ax
 stosw
 loop @SM4
@SMX:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DVGetHandle<font color="#000080">( </font>HandleType <font color="#000080">: </font>byte <font color="#000080">) : </font>pointer<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#008000"><i>{ return object handle }
 </i></font><font color="#FF00FF">mov ah,$12
 mov bh,$00
 mov bl,HandleType
 int $15
 pop ax
 pop dx
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVSound<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>frequency<font color="#000080">, </font>duration <font color="#000080">: </font>word <font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#008000"><i>{ generate a sound }
 </i></font><font color="#FF00FF">mov ax,$1019
 mov bx,frequency
 mov cx,duration   </font><font color="#008000"><i>{ in 18.2 ticks/sec }
 </i></font><font color="#FF00FF">int $15
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVError<font color="#000080">( </font>handle <font color="#000080">: </font>pointer<font color="#000080">; </font>xsize<font color="#000080">, </font>ysize <font color="#000080">: </font>byte<font color="#000080">; </font>msg <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>params<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#008000"><i>{ pop-up an error box }
 {
   use DVERRORxxxxx for PARAMS
   example: DVError(Handle1, 80, 25, 'Don't Touch That!',
                    DVErrorMouEither+DVErrorBeep);
 }
 </i></font><font color="#FF00FF">mov ch,xsize
 mov cl,ysize;
 mov bh,params
 les dx,Handle
 mov dx,es
 les di,msg
 mov bl,es:[di]
 inc di
 mov ax,$101F
 int $15
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVAPILevel<font color="#000080">( </font>major<font color="#000080">, </font>minor <font color="#000080">: </font>byte <font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#008000"><i>{ define the minimum API revision level than the program requires }
 </i></font><font color="#FF00FF">mov bh,major
 mov bl,minor
 mov ax,0de0bh
 int 15h
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVStream<font color="#000080">( </font>handle <font color="#000080">: </font>pointer<font color="#000080">; </font>mode <font color="#000080">: </font>byte<font color="#000080">; </font>params <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
 </b></font>Msg <font color="#000080">: </font>Msg_Write2<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ send a stream of opcode(s) }
 </i></font>DVArray<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">$1B</font><font color="#000080">;
 </font>DVArray<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font>mode<font color="#000080">; </font><font color="#008000"><i>{ stream mode }
 </i></font>DVArray<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font>length<font color="#000080">(</font>params<font color="#000080">);
 </font>DVArray<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]:=</font><font color="#800000">00</font><font color="#000080">;
 </font>move<font color="#000080">(</font>params<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>DVArray<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">],</font>length<font color="#000080">(</font>params<font color="#000080">));
 </font><font color="#FF0000"><b>with </b></font>Msg <font color="#FF0000"><b>do
  begin
   </b></font>Str<font color="#000080">:=@</font>DVArray<font color="#000080">;
   </font>Len<font color="#000080">:=</font>Length<font color="#000080">(</font>params<font color="#000080">)+</font><font color="#800000">4</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>DVSendMsg<font color="#000080">(</font>Handle<font color="#000080">, </font><font color="#800000">$05</font><font color="#000080">, </font>ord<font color="#000080">((</font>handle<font color="#000080">=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)), </font>sizeof<font color="#000080">(</font>Msg<font color="#000080">), </font>Msg<font color="#000080">);
 </font><font color="#008000"><i>{ Meaning of &quot;ord((handle=nil))&quot; }
 { If handle=nil then return 1 else return 0 }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVWrite<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>s <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
 </b></font>Msg <font color="#000080">: </font>Msg_Write2<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ write a string }
 </i></font><font color="#FF0000"><b>with </b></font>Msg <font color="#FF0000"><b>do
  begin
   </b></font>str<font color="#000080">:=@</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
   </font>len<font color="#000080">:=</font>length<font color="#000080">(</font>s<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>DVSendMsg<font color="#000080">(</font>Handle<font color="#000080">, </font><font color="#800000">$05</font><font color="#000080">, </font>Ord<font color="#000080">((</font>Handle<font color="#000080">=</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)),  </font>Sizeof<font color="#000080">(</font>Msg<font color="#000080">), </font>Msg <font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVWriteln<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>s <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>DVWrite<font color="#000080">(</font>Handle<font color="#000080">, </font>s<font color="#000080">+</font><font color="#800000">#13#10 </font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DVNewWin<font color="#000080">( </font>x<font color="#000080">, </font>y <font color="#000080">: </font>word <font color="#000080">) : </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>Msg <font color="#000080">: </font>Msg_Write2_NewWin<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ allocate new window ( X and Y are the window's size &amp; virtual size }
 </i></font>DVArray<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">$1B</font><font color="#000080">;
 </font>DVArray<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font><font color="#800000">$00</font><font color="#000080">;
 </font>DVArray<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font><font color="#800000">$04</font><font color="#000080">;
 </font>DVArray<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]:=</font><font color="#800000">$00</font><font color="#000080">;
 </font>DVArray<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]:=</font><font color="#800000">$E6</font><font color="#000080">;
 </font>DVArray<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]:=</font>y<font color="#000080">; </font><font color="#008000"><i>{ Y-Size }
 </i></font>DVArray<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">]:=</font>x<font color="#000080">; </font><font color="#008000"><i>{ X-Size }
 </i></font><font color="#FF0000"><b>With </b></font>Msg <font color="#FF0000"><b>do
  begin
   </b></font>Len<font color="#000080">:=</font><font color="#800000">$07</font><font color="#000080">;
   </font>Str<font color="#000080">:=@</font>DVArray<font color="#000080">;
   </font>Handle<font color="#000080">:=</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
   </font>DVSendMsg<font color="#000080">( </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">, </font><font color="#800000">$05</font><font color="#000080">, </font><font color="#800000">$01</font><font color="#000080">, </font>Sizeof<font color="#000080">(</font>Msg<font color="#000080">)-</font><font color="#800000">4</font><font color="#000080">, </font>Msg<font color="#000080">);
   </font>DVNewWin<font color="#000080">:=</font>Handle<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVFree<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ free a handle (close a window/free a timer/etc..) }
 </i></font>DVSendMsg<font color="#000080">(</font>Handle<font color="#000080">, </font><font color="#800000">$02</font><font color="#000080">, </font><font color="#800000">$00</font><font color="#000080">, </font><font color="#800000">$00</font><font color="#000080">, </font>Handle <font color="#000080">);
 </font>Handle<font color="#000080">:=</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DVTimer_New <font color="#000080">: </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>Handle <font color="#000080">: </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ allocate a new timer }
 </i></font>DVSendMsg<font color="#000080">( </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">, </font><font color="#800000">$01</font><font color="#000080">, </font><font color="#800000">$0B</font><font color="#000080">, </font><font color="#800000">$00</font><font color="#000080">, </font>Handle <font color="#000080">);
 </font>DVTimer_New<font color="#000080">:=</font>Handle<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVTimer_Start<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>Time <font color="#000080">: </font>longint <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ start a timer countdown (TIME is in 1/100 of a second) }
 </i></font>DVSendMsg<font color="#000080">(</font>Handle<font color="#000080">, </font><font color="#800000">$0a</font><font color="#000080">, </font><font color="#800000">$00</font><font color="#000080">, </font>sizeof<font color="#000080">(</font>Time<font color="#000080">), </font>Time<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DVTimer_Len<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">) : </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>Len <font color="#000080">: </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ get current timer value (in 1/100 of a second) }
 </i></font>DVSendMsg<font color="#000080">(</font>Handle<font color="#000080">, </font><font color="#800000">$09</font><font color="#000080">, </font><font color="#800000">$00</font><font color="#000080">, </font><font color="#800000">$00</font><font color="#000080">, </font>Len<font color="#000080">);
 </font>DVTimer_Len<font color="#000080">:=</font>Len<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ---- Window Streams ---- }

</i></font><font color="#FF0000"><b>procedure </b></font>DVClear<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ clear window }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$E3</font><font color="#000080">))
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVRedraw<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ redraw window }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$E4</font><font color="#000080">))
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVResize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ resize window }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$C3</font><font color="#000080">)+</font>chr<font color="#000080">(</font>y<font color="#000080">)+</font>chr<font color="#000080">(</font>x<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVMove<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>shortint <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ move the window }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$C2</font><font color="#000080">)+</font>chr<font color="#000080">(</font>y<font color="#000080">)+</font>chr<font color="#000080">(</font>x<font color="#000080">))
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVTitle<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>title <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ change window title }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$EF</font><font color="#000080">)+</font>title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]+</font>title<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVMove2<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>shortint <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ set window position relative to the current position  }
 { use negative (-1) values to move up/left }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$CA</font><font color="#000080">)+</font>chr<font color="#000080">(</font>y<font color="#000080">)+</font>chr<font color="#000080">(</font>x<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVResize2<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>shortint <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ set window size relative to the current size  }
 { use negative (-1) values to shrink window }
 </i></font>DVStream<font color="#000080">(</font>handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$CB</font><font color="#000080">)+</font>chr<font color="#000080">(</font>y<font color="#000080">)+</font>chr<font color="#000080">(</font>x<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVSetAttr<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>color <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ set the output color }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$E2</font><font color="#000080">)+</font>chr<font color="#000080">(</font>color<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVFrameAttr<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>color <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ set the frame color }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$ED</font><font color="#000080">)+</font>chr<font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">)+</font>chr<font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">)+
          </font>chr<font color="#000080">(</font>color<font color="#000080">)+</font>chr<font color="#000080">(</font>color<font color="#000080">)+</font>chr<font color="#000080">(</font>color<font color="#000080">)+</font>chr<font color="#000080">(</font>color<font color="#000080">)+
          </font>chr<font color="#000080">(</font>color<font color="#000080">)+</font>chr<font color="#000080">(</font>color<font color="#000080">)+</font>chr<font color="#000080">(</font>color<font color="#000080">)+</font>chr<font color="#000080">(</font>color<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVFrameOn<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>b <font color="#000080">: </font>boolean <font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{ must use DVRedraw to remove the frame }
 </i></font><font color="#FF0000"><b>if </b></font>b <font color="#FF0000"><b>then </b></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$D6</font><font color="#000080">))
  </font><font color="#FF0000"><b>else </b></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$D7</font><font color="#000080">))
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVWinUnHide<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ unhide a window }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$D4</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVWinHide<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ hide a window }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$D5</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVGotoXY<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ positions the cursor at X, Y }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$C0</font><font color="#000080">)+</font>chr<font color="#000080">(</font>y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)+</font>chr<font color="#000080">(</font>x<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVSetVirtualWinSize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ set window's virtual size }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$AB</font><font color="#000080">)+</font>chr<font color="#000080">(</font>x<font color="#000080">));
 </font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>WinStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$AA</font><font color="#000080">)+</font>chr<font color="#000080">(</font>y<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ---- Query Streams ---- }

</i></font><font color="#FF0000"><b>procedure </b></font>DVQSize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ get the window size }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>QueryStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$C3</font><font color="#000080">));
 </font><font color="#008000"><i>{ result is in DVArray[6..7] }
 </i></font>y<font color="#000080">:=</font>DVArray<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">];
 </font>x<font color="#000080">:=</font>DVArray<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVQPos<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x<font color="#000080">, </font>y <font color="#000080">: </font>shortint <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ get the window position }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>QueryStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$C2</font><font color="#000080">));
 </font><font color="#008000"><i>{ result is in DVArray[6..7] }
 </i></font>y<font color="#000080">:=</font>DVArray<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">];
 </font>x<font color="#000080">:=</font>DVArray<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVQVirtualWinSize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ get virtual window size }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>QueryStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$AA</font><font color="#000080">));
 </font>Y<font color="#000080">:=</font>DVArray<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">];
 </font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>QueryStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$AB</font><font color="#000080">));
 </font>X<font color="#000080">:=</font>DVArray<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DVWhereX<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">) : </font>shortint<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ return the cursor's X position }
 </i></font>DVStream<font color="#000080">( </font>Handle<font color="#000080">, </font>QueryStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$A1</font><font color="#000080">) );
 </font>DVWhereX<font color="#000080">:=</font>DVArray<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DVWhereY<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">) : </font>shortint<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ return the cursor's Y position }
 </i></font>DVStream<font color="#000080">( </font>Handle<font color="#000080">, </font>QueryStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$A0</font><font color="#000080">) );
 </font>DVWhereY<font color="#000080">:=</font>DVArray<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ --- Manager Stream Procedures --- }

</i></font><font color="#FF0000"><b>procedure </b></font>DVAllow<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>command <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ disallow a command (see constants &quot;MStream_xxxxxx&quot;) }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>ManagerStream<font color="#000080">, </font>chr<font color="#000080">(</font>command<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVDisallow<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>command <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ disallow a command (see constants &quot;MStream_xxxxxx&quot;) }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>ManagerStream<font color="#000080">, </font>chr<font color="#000080">(</font>command<font color="#000080">+</font><font color="#800000">$20</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVForeOnly<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>b <font color="#000080">: </font>boolean <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ B=TRUE if application runs on foreground only }
 </i></font><font color="#FF0000"><b>if </b></font>b <font color="#FF0000"><b>then </b></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>ManagerStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$86</font><font color="#000080">))
  </font><font color="#FF0000"><b>else </b></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>ManagerStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$87</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVMinWinSize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ define window's minimum size }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>ManagerStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$88</font><font color="#000080">)+</font>chr<font color="#000080">(</font>y<font color="#000080">)+</font>chr<font color="#000080">(</font>x<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVMaxWinSize<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer<font color="#000080">; </font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ define window's maximum size }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>ManagerStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$89</font><font color="#000080">)+</font>chr<font color="#000080">(</font>y<font color="#000080">)+</font>chr<font color="#000080">(</font>x<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVForceForeground<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ force process to run into foreground }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>ManagerStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$C1</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVForceBackground<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ force process to run into background }
 </i></font>DVStream<font color="#000080">(</font>Handle<font color="#000080">, </font>ManagerStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$C9</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVTopProcess<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ make current window topmost in process }
 </i></font>DVStream<font color="#000080">( </font>Handle<font color="#000080">, </font>ManagerStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$C2</font><font color="#000080">) );
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DVBottomProcess<font color="#000080">( </font>Handle <font color="#000080">: </font>pointer <font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ make current window bottom-most in process }
 </i></font>DVStream<font color="#000080">( </font>Handle<font color="#000080">, </font>ManagerStream<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">$CA</font><font color="#000080">) );
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DESQVIEW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p></body>
</html>
