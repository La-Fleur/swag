<html>
<head><title> "Time SLICES for OS/2 & DV" by FRED COHEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DESQVIEW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: FRED COHEN
      Time Slices...

looking for routines for giving up time slices to
various multi-taskers, mainly DV and OS/2.  Please either
post them if they are small enough, or tell me where I can

You will need turbo pascal 6.0+ for this to compile.  It is easy to
convert over to regular pascal though.
}

</i></font><font color="#FF0000"><b>Const

  </b></font>MDOS <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;  </font><font color="#008000"><i>{ DOS               }
  </i></font>OS2  <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;  </font><font color="#008000"><i>{ OS/2 is installed }
  </i></font>WIN  <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;  </font><font color="#008000"><i>{ Windoze           }
  </i></font>DV   <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;  </font><font color="#008000"><i>{ DesqView          }

</i></font><font color="#FF0000"><b>Var

  </b></font>Ops            <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ Operating System OS/2/DOS/WIN/DV}


</i></font><font color="#FF0000"><b>PROCEDURE </b></font>giveslice<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">; </font><font color="#008000"><i>{Gives up remainder of clock cycle
                                 under dos, windows, os/2 }
  </i></font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">CMP ops,MDos </font><font color="#008000"><i>{ Compare to DOS }
    </i></font><font color="#FF00FF">JE @MSDOS    </font><font color="#008000"><i>{ Jump if = }
    </i></font><font color="#FF00FF">CMP ops,Dv   </font><font color="#008000"><i>{ Compare to Desqview }
    </i></font><font color="#FF00FF">JE @DESQVIEW </font><font color="#008000"><i>{ Jump if = }
    </i></font><font color="#FF00FF">CMP ops, Win </font><font color="#008000"><i>{ Compare to Windows }
    </i></font><font color="#FF00FF">JE @WINOS2   </font><font color="#008000"><i>{ Jump if = }
    </i></font><font color="#FF00FF">CMP ops, OS2 </font><font color="#008000"><i>{ Compart OS/2 }
    </i></font><font color="#FF00FF">JE @WINOS2   </font><font color="#008000"><i>{ Jump if = }
    </i></font><font color="#FF00FF">JMP @NONE    </font><font color="#008000"><i>{ None found, Jump to End }


 </i></font><font color="#FF00FF">@MSDOS:
    INT 28h   </font><font color="#008000"><i>{ Interupt 28h }
    </i></font><font color="#FF00FF">JMP @NONE </font><font color="#008000"><i>{ Jump to the end }

 </i></font><font color="#FF00FF">@DESQVIEW:
    MOV ax,1000h </font><font color="#008000"><i>{ AX = 1000h }
    </i></font><font color="#FF00FF">INT 15h      </font><font color="#008000"><i>{ Call Interupt 15h }
    </i></font><font color="#FF00FF">JMP @NONE    </font><font color="#008000"><i>{ Jump to the end }

 </i></font><font color="#FF00FF">@WINOS2:
    MOV AX, 1680h </font><font color="#008000"><i>{ AX = 1680h }
    </i></font><font color="#FF00FF">INT 2Fh       </font><font color="#008000"><i>{ Call Interupt 2Fh for Win-OS/2 TimeSlice }

 </i></font><font color="#FF00FF">@NONE:

</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{GiveSlice}

{***********}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>checkos<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Currently Supports DesqView, Microsoft Windows and IBM's OS/2 }

</i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ops, MDos </font><font color="#008000"><i>{ Default DOS }
  </i></font><font color="#FF00FF">mov ah, 30h   </font><font color="#008000"><i>{ AH = 30h }
  </i></font><font color="#FF00FF">int 21h  </font><font color="#008000"><i>{ dos version }
  </i></font><font color="#FF00FF">cmp al, 14h
  jae @IBMOS2 </font><font color="#008000"><i>{ Jump if &gt;= to 20 }


  </i></font><font color="#FF00FF">mov ax,2B01h
  mov cx,4445h
  mov dx,5351h
  int 21h </font><font color="#008000"><i>{ Desqview Installed? }
  </i></font><font color="#FF00FF">cmp al, 255
  jne @DesqView </font><font color="#008000"><i>{ Jump if AL &lt;&gt; 255 }

  </i></font><font color="#FF00FF">mov ax,160Ah
  int 2Fh </font><font color="#008000"><i>{ Windows Install?}
  </i></font><font color="#FF00FF">cmp ax, 0h
  je @Windows </font><font color="#008000"><i>{ If = Jump to Windows }
  </i></font><font color="#FF00FF">jmp @Finish </font><font color="#008000"><i>{ Nothing found, go to the end }

</i></font><font color="#FF00FF">@IBMOS2:
  mov Ops, Os2  </font><font color="#008000"><i>{ Set OS Value }
  </i></font><font color="#FF00FF">jmp @Finish

@DesqView:
  mov ops, Dv   </font><font color="#008000"><i>{ Set OS Value }
  </i></font><font color="#FF00FF">jmp @Finish

@Windows:
  mov ops, win  </font><font color="#008000"><i>{ Set OS Value }
  </i></font><font color="#FF00FF">jmp @Finish

@FINISH:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ checkos }

{***********  MORE  ********}

</i></font><font color="#FF0000"><b>procedure </b></font>GiveTimeSlice<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ GiveTimeSlice }
  </i></font><font color="#FF00FF">cmp   MultiTasker, DesqView
  je    @DVwait
  cmp   MultiTasker, Windows
  je    @WinOS2wait
  cmp   MultiTasker, OS2
  je    @WinOS2wait
  cmp   MultiTasker, NetWare
  je    @Netwarewait
  cmp   MultiTasker, DoubleDOS
  je    @DoubleDOSwait

@Doswait:
  int   $28
  jmp   @WaitDone

@DVwait:
  mov   AX, $1000
  int   $15
  jmp   @WaitDone

@DoubleDOSwait:
  mov   AX, $EE01
  int   $21
  jmp   @WaitDone

@WinOS2wait:
  mov   AX, $1680
  int   $2F
  jmp   @WaitDone

@Netwarewait:
  mov   BX, $000A
  int   $7A

@WaitDone:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ TimeSlice }

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DESQVIEW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p></body>
</html>
