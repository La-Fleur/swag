<html>
<head><title> "Hardware Cursor Unit" by BJ™RN FELTEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
{ CURSORUN.PAS }

</i></font><font color="#FF0000"><b>UNIT </b></font>cursorUnit<font color="#000080">;
</font><font color="#008000"><i>{
  Hey Guys and Gals! Please don't assume anything about what video
  mode I'm using on my computer! And, thus, don't tangle my
  cursor! This unit provides the =only= proper way to put the cursor
  on and off -- put the code you have been given by other people,
  that sets the cursor to some different, fixed states in order to
  show/hide it, where they all belong: in the Bit Bucket!
}

</i></font><font color="#FF0000"><b>INTERFACE

type      </b></font>cursorType <font color="#000080">= </font><font color="#FF0000"><b>record </b></font>eLine<font color="#000080">, </font>sLine<font color="#000080">: </font>byte <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var       </b></font>Cursor<font color="#000080">: </font>cursorType<font color="#000080">;
</font><font color="#008000"><i>{ since BP can't handle typecasting with macro functions,
  we'll also have use for this one: }
          </i></font>xCursor<font color="#000080">: </font>word <font color="#FF0000"><b>absolute </b></font>Cursor<font color="#000080">;
          </font>oldCursor<font color="#000080">: </font>word<font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>getCursor<font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>inline</b></font><font color="#000080">(
  </font><font color="#800000">$B7</font><font color="#000080">/</font><font color="#800000">0</font><font color="#000080">/             </font><font color="#008000"><i>{ mov bh,0  }
  </i></font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">3</font><font color="#000080">/             </font><font color="#008000"><i>{ mov ah,3  }
  </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/           </font><font color="#008000"><i>{ int 10h   }
  </i></font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$C8</font><font color="#000080">);          </font><font color="#008000"><i>{ mov ax,cx }
</i></font><font color="#FF0000"><b>procedure </b></font>setCursor<font color="#000080">(</font>C<font color="#000080">: </font>word<font color="#000080">); </font><font color="#FF0000"><b>inline</b></font><font color="#000080">(
  </font><font color="#800000">$59</font><font color="#000080">/               </font><font color="#008000"><i>{ pop cx    }
  </i></font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">1</font><font color="#000080">/             </font><font color="#008000"><i>{ mov ah,1  }
  </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">);          </font><font color="#008000"><i>{ int 10h   }
</i></font><font color="#FF0000"><b>procedure </b></font>cursorOn<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>cursorOff<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>blinkSlow<font color="#000080">; </font><font color="#008000"><i>{ those three won't work on EGA/VGA }
</i></font><font color="#FF0000"><b>procedure </b></font>blinkFast<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>blinkNormal<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

procedure </b></font>cursorOn<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>setCursor<font color="#000080">(</font>getCursor <font color="#FF0000"><b>and not </b></font><font color="#800000">$2000</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>cursorOff<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>setCursor<font color="#000080">(</font>getCursor <font color="#FF0000"><b>or </b></font><font color="#800000">$2000</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>blinkSlow<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>setCursor<font color="#000080">(</font>getCursor <font color="#FF0000"><b>and not </b></font><font color="#800000">$2000 </font><font color="#FF0000"><b>or </b></font><font color="#800000">$4000</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>blinkFast<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>setCursor<font color="#000080">(</font>getCursor <font color="#FF0000"><b>or </b></font><font color="#800000">$6000</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>blinkNormal<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>setCursor<font color="#000080">(</font>getCursor <font color="#FF0000"><b>and not </b></font><font color="#800000">$6000</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{ always save old cursor first }
   </i></font>oldCursor<font color="#000080">:=</font>getCursor
<font color="#FF0000"><b>END</b></font><font color="#000080">.  </font><font color="#008000"><i>{ of Unit init }


{- And here's a short test program, that'll show you how to use the
   unit cursorUnit -}

</i></font><font color="#FF0000"><b>program </b></font>TestCursor<font color="#000080">; </font><font color="#008000"><i>{ test of Cursor unit }
{$D-,E-,G+,I-,L-,S-}

</i></font><font color="#FF0000"><b>uses </b></font>cursorUnit<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>xCursor<font color="#000080">:=</font>getCursor<font color="#000080">;
  </font><font color="#FF0000"><b>with </b></font>Cursor <font color="#FF0000"><b>do begin
    </b></font>writeln<font color="#000080">;
    </font>writeln<font color="#000080">(</font><font color="#800000">'Present start- and endline of cursor:'</font><font color="#000080">,</font>sLine<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font>eLine<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">);
    </font>write  <font color="#000080">(</font><font color="#800000">'Change start to 0 to create block type '</font><font color="#000080">);
    </font>sLine<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;     </font>setCursor<font color="#000080">(</font>xCursor<font color="#000080">); </font>readln<font color="#000080">;
    </font>write  <font color="#000080">(</font><font color="#800000">'Make cursor a thin line '</font><font color="#000080">);
    </font>sLine<font color="#000080">:=</font>eLine<font color="#000080">; </font>setCursor<font color="#000080">(</font>xCursor<font color="#000080">); </font>readln<font color="#000080">;
    </font>write  <font color="#000080">(</font><font color="#800000">'Turn cursor off preserving present size '</font><font color="#000080">);
    </font>cursorOff<font color="#000080">;    </font>readln<font color="#000080">;
    </font>write  <font color="#000080">(</font><font color="#800000">'Notice how we get our thin cursor back '</font><font color="#000080">);
    </font>cursorOn<font color="#000080">;     </font>readln<font color="#000080">;
</font><font color="#008000"><i>{ those three won't work properly on EGA/VGA }
   {blinkSlow;    readln;
    blinkFast;    readln;
    blinkNormal;  readln}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>write<font color="#000080">(</font><font color="#800000">'Restore original cursor '</font><font color="#000080">);
  </font>setCursor<font color="#000080">(</font>oldCursor<font color="#000080">); </font>readln
<font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p></body>
</html>
