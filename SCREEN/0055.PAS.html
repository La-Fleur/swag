<html>
<head><title> "Asm Retrace" by SEAN PALMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0055.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;&gt; add a WAIT procedure in your program to wait for the
&gt;&gt; vertical retrace then your image will slide smoothly

&gt; I thought this was only a problem with CGA cards .. is that still
&gt; true?

&gt;&gt; It's no longer a PROBLEM per se. It doesn't cause snow anymore, but you
&gt;&gt; still get a jitter/flicker problem if you move an image
&gt;&gt; without waiting for retrace. Problem is that the memory
&gt;&gt; gets updated while the retrace is halfway down the

&gt; Where can I get source for such a wait procedure? Do you or JB? have
&gt; one?
}
</i></font><font color="#FF0000"><b>var
 </b></font>addr6845<font color="#000080">:</font>word <font color="#FF0000"><b>absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$63</font><font color="#000080">; </font><font color="#008000"><i>{bios's crtc ptr}
  {CRT Controller=+0}
  {CRT Status=+6}
  {Mode Control=+4}

</i></font><font color="#FF0000"><b>procedure </b></font>syncRetrace<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">mov ax,seg addr6845; mov es,ax;
 mov dx,es:[addr6845]; add dx,6; </font><font color="#008000"><i>{find crt status reg}
 {@LOOP1: in al,dx; test al,8; jnz @LOOP1;}
 </i></font><font color="#FF00FF">@LOOP2: in al,dx; test al,8; jz @LOOP2;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{
some people like to make sure the current retrace (if any) has ended before
waiting for one to begin. I find it unnecessary in practice. But if you wanna
do that, uncomment LOOP1.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0055.PAS">Original</a><b>]</b></p></body>
</html>
