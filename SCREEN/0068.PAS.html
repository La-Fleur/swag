<html>
<head><title> "Char At 80" by ANDREW EIGUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0068.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 SG&gt; Anybody know how to place a character at 80,25 in text mode without
 SG&gt; scrolling the screen?  TIA
}

</i></font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>ScreenHeight <font color="#000080">: </font>byte<font color="#000080">;   </font><font color="#008000"><i>{ screen height in characters (rows) }
  </i></font>ScreenWidth <font color="#000080">: </font>word<font color="#000080">;    </font><font color="#008000"><i>{ screen width in characters (columns) }
  </i></font>Screen <font color="#000080">: </font>pointer<font color="#000080">;      </font><font color="#008000"><i>{ screen pointer }

{ some usef00l routines }

</i></font><font color="#FF0000"><b>Function </b></font>ScrReadChar<font color="#000080">(</font>X<font color="#000080">,</font>Y <font color="#000080">: </font>BYTE<font color="#000080">) : </font>CHAR<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">LES DI,Screen
  XOR AH,AH
  MOV AL,Y
  DEC AX
  MUL ScreenWidth
  SHL AX,1
  XOR DH,DH
  MOV DL,X
  SHL DX,1
  DEC DX
  DEC DX
  ADD AX,DX
  MOV DI,AX
  MOV AL,BYTE PTR [ES:DI]
  </font><font color="#008000"><i>{ScrReadChar := Char(Ptr(Seg(Screen^),
    (Y - 1) * ScreenWidth * 2 + (X * 2) - 2)^)}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ ScrReadChar }

</i></font><font color="#FF0000"><b>Procedure </b></font>ScrWriteChar<font color="#000080">(</font>X<font color="#000080">,</font>Y <font color="#000080">: </font>BYTE<font color="#000080">; </font>Ch <font color="#000080">: </font>CHAR<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">LES DI,Screen
  XOR AH,AH
  MOV AL,Y
  DEC AX
  MUL ScreenWidth
  SHL AX,1
  XOR DH,DH
  MOV DL,X
  SHL DX,1
  DEC DX
  DEC DX
  ADD AX,DX
  MOV DI,AX
  MOV AL,Ch
  MOV BYTE PTR [ES:DI],AL
  </font><font color="#008000"><i>{Char(Ptr(Seg(Screen^),
    (Y - 1) * ScreenWidth * 2 + (X * 2) - 2)^) := Ch}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ ScrWriteChar }

</i></font><font color="#FF0000"><b>Function </b></font>ScrReadAttr<font color="#000080">(</font>X<font color="#000080">,</font>Y <font color="#000080">: </font>BYTE<font color="#000080">) : </font>BYTE<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">LES DI,Screen
  XOR AH,AH
  MOV AL,Y
  DEC AX
  MUL ScreenWidth
  SHL AX,1
  XOR DH,DH
  MOV DL,X
  SHL DX,1
  DEC DX
  ADD AX,DX
  MOV DI,AX
  MOV AL,BYTE PTR [ES:DI]
  </font><font color="#008000"><i>{ScrReadAttr := TTextAttr(Ptr(Seg(Screen^),
    (Y - 1) * ScreenWidth * 2 + (X * 2) - 1)^)}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ ScrReadAttr }

</i></font><font color="#FF0000"><b>Procedure </b></font>ScrWriteAttr<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Color <font color="#000080">: </font>BYTE<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">LES DI,Screen
  XOR AH,AH
  MOV AL,Y
  DEC AX
  MUL ScreenWidth
  SHL AX,1
  XOR DH,DH
  MOV DL,X
  SHL DX,1
  DEC DX
  ADD AX,DX
  MOV DI,AX
  MOV AL,Color
  MOV BYTE PTR [ES:DI],AL
  </font><font color="#008000"><i>{TTextAttr(Ptr(Seg(Screen^),
    (Y - 1) * ScreenWidth * 2 + (X * 2) - 1)^) := Color}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ ScrWriteAttr }

{ and finally in your program... }

</i></font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{ initialize ScreenHeight, ScreenWidth and Screen... }
  </i></font><font color="#FF0000"><b>if </b></font>LastMode <font color="#000080">= </font>Mono <font color="#FF0000"><b>then
    </b></font>Screen <font color="#000080">:= </font>Ptr<font color="#000080">(</font><font color="#800000">$B000</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Screen <font color="#000080">:= </font>Ptr<font color="#000080">(</font><font color="#800000">$B800</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LastMode <font color="#FF0000"><b>and </b></font>Font8x8<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>ScreenHeight <font color="#000080">:= </font>Mem<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0084</font><font color="#000080">] </font><font color="#FF0000"><b>else </b></font>ScreenHeight <font color="#000080">:= </font><font color="#800000">25</font><font color="#000080">;
  </font>ScreenWidth <font color="#000080">:= </font>MemW<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$004A</font><font color="#000080">];

  </font><font color="#008000"><i>{ do whatever you want, for example: }
    </i></font>ScrWriteChar<font color="#000080">(</font>ScreenWidth<font color="#000080">, </font>ScreenHeight<font color="#000080">, </font><font color="#800000">'A'</font><font color="#000080">);
    </font>ScrWriteAttr<font color="#000080">(</font>ScreenWidth<font color="#000080">, </font>ScreenHeight<font color="#000080">, </font>LightGray <font color="#000080">);

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0068.PAS">Original</a><b>]</b></p></body>
</html>
