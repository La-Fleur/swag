<html>
<head><title> "Grabbing Screen Output" by KELLY SMALL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0041.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
KELLY SMALL

Ok here's a quick example of how you can control the screen
output during an Exec.  BAsically you hook Int $29 which is an
internal bios hook For screen output.  Any Character that would
go to the screen is intercepted by the Interrupt handler and then
TP's Write Procedure is used to output the Charcater to the
screen.  Please note that this will only work With the Crt Unit
and it's direct screen Write methods, not output via the Dos
device..  Of course I assume you are using the Crt Unit since you
are also using the Window Procedure.  if the Program you exec
Uses direct screen Writes then this routine will not work.
}

</i></font><font color="#FF0000"><b>Program </b></font>WinHold<font color="#000080">;
</font><font color="#008000"><i>{$M 8096,0,0}
</i></font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>OldIntVect <font color="#000080">: </font>Pointer<font color="#000080">;

</font><font color="#008000"><i>{F+}
</i></font><font color="#FF0000"><b>Procedure </b></font>Int29Handler<font color="#000080">(</font>AX<font color="#000080">, </font>BX<font color="#000080">, </font>CX<font color="#000080">, </font>DX<font color="#000080">, </font>SI<font color="#000080">, </font>DI<font color="#000080">, </font>DS<font color="#000080">, </font>ES<font color="#000080">, </font>BP <font color="#000080">: </font>Word<font color="#000080">); </font>Interrupt<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Dummy <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Asm
    </b></font><font color="#FF00FF">Sti
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Write<font color="#000080">(</font>Char<font color="#000080">(</font>Lo<font color="#000080">(</font>Ax<font color="#000080">)));
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">Cli
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$F-}

</i></font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'this line better stay put'</font><font color="#000080">);
  </font>Window<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">);
  </font>GetIntVec<font color="#000080">(</font><font color="#800000">$29</font><font color="#000080">, </font>OldIntVect<font color="#000080">);            </font><font color="#008000"><i>{ Save the old vector }
  </i></font>SetIntVec<font color="#000080">(</font><font color="#800000">$29</font><font color="#000080">, @</font>Int29Handler<font color="#000080">);         </font><font color="#008000"><i>{ Install interrupt handler }
  </i></font>SwapVectors<font color="#000080">;
  </font>Exec<font color="#000080">(</font>GetEnv<font color="#000080">(</font><font color="#800000">'COMSPEC'</font><font color="#000080">),</font><font color="#800000">'/c dir /p'</font><font color="#000080">);
  </font>SwapVectors<font color="#000080">;
  </font>SetIntVec<font color="#000080">(</font><font color="#800000">$29</font><font color="#000080">, </font>OldIntVect<font color="#000080">);            </font><font color="#008000"><i>{ Restore the interrupt }
  </i></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">80</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">);
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'2nd line I hope'</font><font color="#000080">);
  </font>ReadLn<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0041.PAS">Original</a><b>]</b></p></body>
</html>
