<html>
<head><title> "ScreenBuffer Object" by STEFAN XENOS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: STEFAN XENOS
Subj: ScreenBuffer Object

Notes:
  - 0,0 is recognised as the top-left corner of the screen.
  - They seem to work perfectly when only popping one thing up at once.
}

</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Type
 </b></font>TScreenBuf <font color="#000080">= </font><font color="#FF0000"><b>Object
  Constructor </b></font>Init <font color="#000080">(</font>NewX<font color="#000080">,</font>NewY<font color="#000080">,</font>NewHeight<font color="#000080">,</font>NewWidth<font color="#000080">:</font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>Destructor </b></font>Done<font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>KillBuffer<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>Clip<font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>Paste<font color="#000080">;
  </font><font color="#FF0000"><b>Private
   </b></font>Buffer <font color="#000080">:</font>Pointer<font color="#000080">;
   </font>Size <font color="#000080">:</font>Byte<font color="#000080">;
   </font>x<font color="#000080">,
   </font>y<font color="#000080">,
   </font>Height<font color="#000080">,
   </font>Width <font color="#000080">:</font>Byte<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
 </b></font>MaxX<font color="#000080">,
 </font>MaxY <font color="#000080">:</font>Byte<font color="#000080">;
 </font>ScreenSeg <font color="#000080">:</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GoXY <font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 </b></font>gotoXY <font color="#000080">(</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FillWith <font color="#000080">(</font>aChar<font color="#000080">:</font>Char<font color="#000080">);
</font><font color="#FF0000"><b>Var
 </b></font>offset<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>ClrScr<font color="#000080">;
 </font><font color="#FF0000"><b>For </b></font>offset <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>maxx<font color="#000080">*</font>maxy
  <font color="#FF0000"><b>do </b></font>move <font color="#000080">(</font>aChar<font color="#000080">,</font>Ptr <font color="#000080">(</font>ScreenSeg<font color="#000080">,</font>offset<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">)^,</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{TScreenBuf}
</i></font><font color="#FF0000"><b>Constructor </b></font>TScreenBuf<font color="#000080">.</font>Init <font color="#000080">(</font>NewX<font color="#000080">,</font>NewY<font color="#000080">,</font>NewHeight<font color="#000080">,</font>NewWidth<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 </b></font>x <font color="#000080">:= </font>newx<font color="#000080">;
 </font>y <font color="#000080">:= </font>newy<font color="#000080">;
 </font>height <font color="#000080">:= </font>newheight<font color="#000080">;
 </font>width <font color="#000080">:= </font>newwidth<font color="#000080">;
 </font>Buffer <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
 </font>KillBuffer<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Destructor </b></font>TScreenBuf<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>KillBuffer<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TScreenBuf<font color="#000080">.</font>KillBuffer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 If </b></font>Buffer <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil
  then </b></font>FreeMem <font color="#000080">(</font>Buffer<font color="#000080">,</font>Size<font color="#000080">);
 </font>Size <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>Buffer <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TScreenBuf<font color="#000080">.</font>Clip<font color="#000080">;
</font><font color="#FF0000"><b>Var
 </b></font>ScanY <font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>KillBuffer<font color="#000080">;
 </font>Size <font color="#000080">:= </font>Height<font color="#000080">*</font>Width<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">;
 </font>GetMem <font color="#000080">(</font>Buffer<font color="#000080">,</font>Size<font color="#000080">);
 </font><font color="#FF0000"><b>For </b></font>ScanY <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Height
  <font color="#FF0000"><b>do begin
   </b></font>Move <font color="#000080">(</font>Ptr <font color="#000080">(</font>ScreenSeg<font color="#000080">,(</font>Y<font color="#000080">*</font>MaxX<font color="#000080">+</font>ScanY<font color="#000080">*</font>MaxX<font color="#000080">+</font>X<font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">)^,
    </font>Ptr <font color="#000080">(</font>Seg <font color="#000080">(</font>Buffer<font color="#000080">^),</font>Ofs<font color="#000080">(</font>Buffer<font color="#000080">^)+(</font>ScanY<font color="#000080">*</font>Width<font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">)^,</font>Width<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TScreenBuf<font color="#000080">.</font>Paste<font color="#000080">;
</font><font color="#FF0000"><b>Var
 </b></font>ScanY <font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 For </b></font>ScanY <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Height
  <font color="#FF0000"><b>do begin
   </b></font>Move <font color="#000080">(</font>Ptr <font color="#000080">(</font>Seg <font color="#000080">(</font>Buffer<font color="#000080">^),</font>Ofs<font color="#000080">(</font>Buffer<font color="#000080">^)+(</font>ScanY<font color="#000080">*</font>Width<font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">)^,
    </font>Ptr <font color="#000080">(</font>ScreenSeg<font color="#000080">,(</font>Y<font color="#000080">*</font>MaxX<font color="#000080">+</font>ScanY<font color="#000080">*</font>MaxX<font color="#000080">+</font>X<font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">)^,</font>Width<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
 </b></font>Clip <font color="#000080">:</font>TScreenBuf<font color="#000080">;

</font><font color="#FF0000"><b>Begin
 if </b></font>Lastmode <font color="#000080">= </font>Mono
  <font color="#FF0000"><b>then </b></font>screenSeg <font color="#000080">:= </font><font color="#800000">$B000          </font><font color="#008000"><i>{Mono}
 </i></font><font color="#FF0000"><b>else </b></font>screenSeg <font color="#000080">:= </font><font color="#800000">$B800</font><font color="#000080">;          </font><font color="#008000"><i>{Colour}
 </i></font><font color="#FF0000"><b>if </b></font>Lastmode
  <font color="#FF0000"><b>and </b></font>font8x8 <font color="#000080">&lt;&gt; </font><font color="#800000">0
  </font><font color="#FF0000"><b>then </b></font>MaxY <font color="#000080">:= </font><font color="#800000">50                  </font><font color="#008000"><i>{25X80}
 </i></font><font color="#FF0000"><b>else </b></font>MaxY <font color="#000080">:= </font><font color="#800000">25</font><font color="#000080">;                  </font><font color="#008000"><i>{50X80}
 </i></font>MaxX <font color="#000080">:= </font><font color="#800000">80</font><font color="#000080">;

 </font>textcolor <font color="#000080">(</font>darkgray<font color="#000080">);
 </font>textbackground <font color="#000080">(</font>lightgray<font color="#000080">);
 </font>FillWith <font color="#000080">(</font><font color="#800000">#178</font><font color="#000080">);
 </font>textcolor <font color="#000080">(</font>yellow<font color="#000080">);
 </font>textbackground <font color="#000080">(</font>blue<font color="#000080">);
 </font>Clip<font color="#000080">.</font>Init <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">);
 </font>Clip<font color="#000080">.</font>Clip<font color="#000080">;
 </font>goXY <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">);
 </font>Write <font color="#000080">(</font><font color="#800000">'Hit ENTER to continue'</font><font color="#000080">);
 </font><font color="#FF0000"><b>While </b></font>Readkey <font color="#000080">&lt;&gt; </font><font color="#800000">#13 </font><font color="#FF0000"><b>do</b></font><font color="#000080">;
 </font>Clip<font color="#000080">.</font>Paste<font color="#000080">;
 </font>Clip<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p></body>
</html>
