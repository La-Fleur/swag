<html>
<head><title> "Multipurpose Screen Unit" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0080.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>screenio<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses </b></font>crt<font color="#000080">,</font>dos<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>SHFTR   <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>SHFTL   <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>CTRL    <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
  </font>ALT     <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;
  </font>SCRL    <font color="#000080">= </font><font color="#800000">16</font><font color="#000080">;
  </font>NUML    <font color="#000080">= </font><font color="#800000">32</font><font color="#000080">;
  </font>CAPL    <font color="#000080">= </font><font color="#800000">64</font><font color="#000080">;
  </font>INS     <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">;
  </font>_BKSPC  <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;
  </font>_ESC    <font color="#000080">= </font><font color="#800000">27</font><font color="#000080">;
  </font>_UP     <font color="#000080">= </font><font color="#800000">328</font><font color="#000080">;
  </font>_DN     <font color="#000080">= </font><font color="#800000">336</font><font color="#000080">;
  </font>_RIGHT  <font color="#000080">= </font><font color="#800000">333</font><font color="#000080">;
  </font>_LEFT   <font color="#000080">= </font><font color="#800000">331</font><font color="#000080">;
  </font>_PGUP   <font color="#000080">= </font><font color="#800000">329</font><font color="#000080">;
  </font>_PGDN   <font color="#000080">= </font><font color="#800000">337</font><font color="#000080">;
  </font>_HOME   <font color="#000080">= </font><font color="#800000">327</font><font color="#000080">;
  </font>_END    <font color="#000080">= </font><font color="#800000">335</font><font color="#000080">;
  </font>_DEL    <font color="#000080">= </font><font color="#800000">339</font><font color="#000080">;
  </font>_INS    <font color="#000080">= </font><font color="#800000">338</font><font color="#000080">;
  </font>_F1     <font color="#000080">= </font><font color="#800000">315</font><font color="#000080">;
  </font>_F2     <font color="#000080">= </font><font color="#800000">316</font><font color="#000080">;
  </font>_F3     <font color="#000080">= </font><font color="#800000">317</font><font color="#000080">;
  </font>_F4     <font color="#000080">= </font><font color="#800000">318</font><font color="#000080">;
  </font>_F5     <font color="#000080">= </font><font color="#800000">319</font><font color="#000080">;
  </font>_F6     <font color="#000080">= </font><font color="#800000">320</font><font color="#000080">;
  </font>_F7     <font color="#000080">= </font><font color="#800000">321</font><font color="#000080">;
  </font>_F8     <font color="#000080">= </font><font color="#800000">322</font><font color="#000080">;
  </font>_F9     <font color="#000080">= </font><font color="#800000">323</font><font color="#000080">;
  </font>_F10    <font color="#000080">= </font><font color="#800000">324</font><font color="#000080">;
  </font>single  <font color="#000080">= </font><font color="#800000">'&Uacute;&Auml;&iquest;&sup3;&Agrave;&Ugrave;'</font><font color="#000080">;
  </font>double  <font color="#000080">= </font><font color="#800000">'&Eacute;&Iacute;&raquo;&ordm;&Egrave;&frac14;'</font><font color="#000080">;
  </font>bellsnd <font color="#000080">= </font><font color="#800000">50</font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>ScreenType <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">80</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;
  </font>str2  <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font>str10 <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
  </font>str20 <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
  </font>str80 <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];

</font><font color="#FF0000"><b>procedure </b></font>InitScrn<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>CenterNum<font color="#000080">(</font>Num <font color="#000080">: </font>longint<font color="#000080">;</font>Len <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>FileOpen<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Fn      <font color="#000080">: </font>text<font color="#000080">;
                      </font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>FileVOpen<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Fn      <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
                      </font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>Get_Key <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>GetKeyScan<font color="#000080">(</font>SCANBYTE <font color="#000080">: </font>BYTE<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>GetText<font color="#000080">(</font>Left<font color="#000080">,</font>Top<font color="#000080">,</font>Right<font color="#000080">,</font>Bottom<font color="#000080">:</font>INTEGER<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>dest<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>PutText<font color="#000080">(</font>Left<font color="#000080">,</font>Top<font color="#000080">,</font>Right<font color="#000080">,</font>Bottom<font color="#000080">:</font>INTEGER<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Source<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>GetChar<font color="#000080">(</font>X<font color="#000080">,</font>Y           <font color="#000080">: </font>integer<font color="#000080">;           </font><font color="#008000"><i>{ Display Coord }
                  </i></font><font color="#FF0000"><b>var </b></font>Character <font color="#000080">: </font>char<font color="#000080">;              </font><font color="#008000"><i>{ the character }
                  </i></font><font color="#FF0000"><b>var </b></font>COLOR     <font color="#000080">: </font>integer<font color="#000080">);          </font><font color="#008000"><i>{ its Attribute }
</i></font><font color="#FF0000"><b>procedure </b></font>Scroll<font color="#000080">(  </font>Direction <font color="#000080">: </font>Char<font color="#000080">;   </font><font color="#008000"><i>{ Direction U=Up D=Down }
                   </i></font>Number<font color="#000080">,             </font><font color="#008000"><i>{ Number of lines to be scrolled }
                   </i></font>COLOR<font color="#000080">,              </font><font color="#008000"><i>{ Attribute for the blank lines created }
                   </i></font>XLeft<font color="#000080">,              </font><font color="#008000"><i>{ Column in the upper left corner }
                   </i></font>YLeft<font color="#000080">,              </font><font color="#008000"><i>{ line in the upper left corner }
                   </i></font>XRight<font color="#000080">,             </font><font color="#008000"><i>{ Column in the lower right corner }
                   </i></font>YRight     <font color="#000080">: </font>integer<font color="#000080">);  </font><font color="#008000"><i>{ Line in lower right corner }
</i></font><font color="#FF0000"><b>procedure </b></font>WriteXY<font color="#000080">(</font>X<font color="#000080">,</font>Y <font color="#000080">: </font>Byte<font color="#000080">;</font>Str <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DrawBox<font color="#000080">(</font>Title<font color="#000080">,</font>BoxDef <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>TopX<font color="#000080">,</font>TopY<font color="#000080">,</font>BotX<font color="#000080">,</font>BotY<font color="#000080">,</font>Shadow<font color="#000080">,</font>Border<font color="#000080">,</font>WindC <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>Parse<font color="#000080">(</font>ParseChr <font color="#000080">: </font>char<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>SelMenu<font color="#000080">(</font>Xpos<font color="#000080">,</font>Ypos<font color="#000080">,</font>NormColor<font color="#000080">,</font>HighColor<font color="#000080">,</font>BordColor<font color="#000080">,</font>Box <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>MenuName<font color="#000080">,</font>MenuS <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>Trim_Str<font color="#000080">(</font>InputStr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>soundbell<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>InValidInput<font color="#000080">(</font>Prompt <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>ClearInvalid<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>ErrPrompt <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>implementation

var
  </b></font>Screen <font color="#000080">: ^</font>ScreenType<font color="#000080">;
  </font>vinput <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">240</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>soundbell<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>sound<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">);
    </font>delay<font color="#000080">(</font>bellsnd<font color="#000080">);
    </font>nosound<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>InValidInput<font color="#000080">(</font>Prompt <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>xpos<font color="#000080">,</font>oldx<font color="#000080">,</font>oldy<font color="#000080">,</font>attr <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>GetText<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>vinput<font color="#000080">);
    </font>attr <font color="#000080">:= </font>textattr<font color="#000080">;
    </font>oldx <font color="#000080">:= </font>wherex<font color="#000080">;
    </font>oldy <font color="#000080">:= </font>wherey<font color="#000080">;
    </font>textattr <font color="#000080">:= </font><font color="#800000">$5f</font><font color="#000080">;
    </font>xpos <font color="#000080">:= </font><font color="#800000">80</font><font color="#000080">-</font><font color="#800000">3</font><font color="#000080">-</font>length<font color="#000080">(</font>prompt<font color="#000080">);
    </font>DrawBox<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font>Single<font color="#000080">,</font>xpos<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$5f</font><font color="#000080">,</font><font color="#800000">$5f</font><font color="#000080">);
    </font>gotoxy<font color="#000080">(</font>xpos<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
    </font>write<font color="#000080">(</font>prompt<font color="#000080">);
    </font>textattr <font color="#000080">:= </font>attr<font color="#000080">;
    </font>gotoxy<font color="#000080">(</font>oldx<font color="#000080">,</font>oldy<font color="#000080">);
    </font>ErrPrompt <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ClearInvalid<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>ErrPrompt <font color="#000080">:= </font>False<font color="#000080">;
    </font>PutText<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>vinput<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>InitScrn<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    IF </b></font>LastMode <font color="#000080">= </font>Mono <font color="#FF0000"><b>THEN </b></font>Screen <font color="#000080">:= </font>Ptr<font color="#000080">(</font><font color="#800000">$b000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)
      </font><font color="#FF0000"><b>ELSE </b></font>Screen<font color="#000080">:=</font>Ptr<font color="#000080">(</font><font color="#800000">$b800</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Trim_Str<font color="#000080">(</font>InputStr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>count  <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>count <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font>InputStr<font color="#000080">[</font>count<font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>do
      begin
        </b></font>Delete<font color="#000080">(</font>InputStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font>inc<font color="#000080">(</font>count<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>count <font color="#000080">:= </font>Length<font color="#000080">(</font>InputStr<font color="#000080">);
    </font><font color="#FF0000"><b>while </b></font>InputStr<font color="#000080">[</font>count<font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>do
      begin
        </b></font>Delete<font color="#000080">(</font>InputStr<font color="#000080">,</font>Length<font color="#000080">(</font>InputStr<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
        </font>dec<font color="#000080">(</font>count<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Trim_Str <font color="#000080">:= </font>InputStr<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>CenterNum<font color="#000080">(</font>Num <font color="#000080">: </font>longint<font color="#000080">;</font>Len <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>Tstr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>SLen<font color="#000080">,</font>TVal <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Str<font color="#000080">(</font>Num<font color="#000080">,</font>Tstr<font color="#000080">);
    </font>SLen <font color="#000080">:= </font>Length<font color="#000080">(</font>Tstr<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>SLen <font color="#000080">&lt; </font>Len <font color="#FF0000"><b>then
      repeat
        </b></font>Insert<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>Tstr<font color="#000080">,</font>Slen<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
        </font>inc<font color="#000080">(</font>Slen<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>SLen <font color="#000080">&lt; </font>Len <font color="#FF0000"><b>then </b></font>Insert<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>Tstr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font>inc<font color="#000080">(</font>Slen<font color="#000080">);
      </font><font color="#FF0000"><b>until </b></font>Slen <font color="#000080">&gt;= </font>Len <font color="#FF0000"><b>else if </b></font>Slen <font color="#000080">&gt; </font>Len <font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>Tstr<font color="#000080">,</font>Len<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Slen<font color="#000080">-</font>Len<font color="#000080">);
    </font>Centernum <font color="#000080">:= </font>Tstr<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FileVOpen<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Fn      <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
                      </font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Boolean function that returns True if the file exists;otherwise,
 it returns False. Closes the file if it exists. }
</i></font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{$I-}
 </i></font>Assign<font color="#000080">(</font>Fn<font color="#000080">, </font>FileName<font color="#000080">);

 </font>FileMode <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;  </font><font color="#008000"><i>{ Set file access to read/write }
 </i></font>Reset<font color="#000080">(</font>Fn<font color="#000080">);
 </font><font color="#008000"><i>{$I+}
 </i></font>FileVOpen <font color="#000080">:= (</font>IOResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FileName <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ FileExists }

</i></font><font color="#FF0000"><b>function </b></font>FileOpen<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Fn      <font color="#000080">: </font>text<font color="#000080">;
                      </font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Boolean function that returns True if the file exists;otherwise,
 it returns False. Closes the file if it exists. }
</i></font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{$I-}
 </i></font>Assign<font color="#000080">(</font>Fn<font color="#000080">, </font>FileName<font color="#000080">);

 </font>FileMode <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;  </font><font color="#008000"><i>{ Set file access to read/write }
 </i></font>Reset<font color="#000080">(</font>Fn<font color="#000080">);
 </font><font color="#008000"><i>{$I+}
 </i></font>FileOpen <font color="#000080">:= (</font>IOResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FileName <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ FileExists }

</i></font><font color="#FF0000"><b>function </b></font>Get_Key <font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>Var </b></font>CH <font color="#000080">: </font>Char<font color="#000080">;
      </font>Int <font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>CH <font color="#000080">:= </font>ReadKey<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>CH <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>then
      begin
        </b></font>CH <font color="#000080">:= </font>ReadKey<font color="#000080">;
        </font>int <font color="#000080">:= </font>Ord<font color="#000080">(</font>CH<font color="#000080">);
        </font>inc<font color="#000080">(</font>int<font color="#000080">,</font><font color="#800000">256</font><font color="#000080">);
      </font><font color="#FF0000"><b>end else </b></font>Int <font color="#000080">:= </font>Ord<font color="#000080">(</font>CH<font color="#000080">);
    </font>Get_Key <font color="#000080">:= </font>Int<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>GetKeyScan<font color="#000080">(</font>SCANBYTE <font color="#000080">: </font>BYTE<font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$2</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">,</font>Regs<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Regs<font color="#000080">.</font>al <font color="#FF0000"><b>and </b></font>SCANBYTE <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>GetKeyScan <font color="#000080">:= </font>true
      <font color="#FF0000"><b>else </b></font>GetKeyScan <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>GetText<font color="#000080">(</font>Left<font color="#000080">,</font>Top<font color="#000080">,</font>Right<font color="#000080">,</font>Bottom<font color="#000080">:</font>INTEGER<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>dest<font color="#000080">);
  </font><font color="#FF0000"><b>TYPE
    </b></font>DestType <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2000</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>WORD<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>d      <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2000</font><font color="#000080">;
    </font>x      <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">80</font><font color="#000080">;
    </font>y      <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>d <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>FOR </b></font>y<font color="#000080">:=</font>Top <font color="#FF0000"><b>TO </b></font>Bottom <font color="#FF0000"><b>DO
      FOR </b></font>x<font color="#000080">:= </font>Left <font color="#FF0000"><b>TO </b></font>Right <font color="#FF0000"><b>DO
        BEGIN
          </b></font>DestType<font color="#000080">(</font>Dest<font color="#000080">)[</font>d<font color="#000080">] := </font>Screen<font color="#000080">^[</font>y<font color="#000080">,</font>x<font color="#000080">];
          </font>inc<font color="#000080">(</font>d<font color="#000080">);
        </font><font color="#FF0000"><b>END
  END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>PutText<font color="#000080">(</font>Left<font color="#000080">,</font>Top<font color="#000080">,</font>Right<font color="#000080">,</font>Bottom<font color="#000080">:</font>INTEGER<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Source<font color="#000080">);
  </font><font color="#FF0000"><b>TYPE
    </b></font>SourceType <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2000</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>WORD<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>x      <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">80</font><font color="#000080">;
    </font>y      <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">;
    </font>s      <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2000</font><font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>s <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>FOR </b></font>y <font color="#000080">:= </font>Top <font color="#FF0000"><b>TO </b></font>Bottom <font color="#FF0000"><b>DO
      FOR </b></font>x <font color="#000080">:= </font>Left <font color="#FF0000"><b>TO </b></font>Right <font color="#FF0000"><b>DO
        BEGIN
          </b></font>Screen<font color="#000080">^[</font>y<font color="#000080">,</font>x<font color="#000080">] := </font>SourceType<font color="#000080">(</font>Source<font color="#000080">)[</font>s<font color="#000080">];
          </font>inc<font color="#000080">(</font>s<font color="#000080">);
        </font><font color="#FF0000"><b>END
  END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GetChar<font color="#000080">(</font>X<font color="#000080">,</font>Y           <font color="#000080">: </font>integer<font color="#000080">;           </font><font color="#008000"><i>{ Display Coord }
                  </i></font><font color="#FF0000"><b>var </b></font>Character <font color="#000080">: </font>char<font color="#000080">;              </font><font color="#008000"><i>{ the character }
                  </i></font><font color="#FF0000"><b>var </b></font>COLOR     <font color="#000080">: </font>integer<font color="#000080">);          </font><font color="#008000"><i>{ its Attribute }
  </i></font><font color="#FF0000"><b>var
    </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;           </font><font color="#008000"><i>{ Register-Variable for the Interrupt }

</i></font><font color="#FF0000"><b>begin
  </b></font>gotoxy<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);                  </font><font color="#008000"><i>{ cursor on the position indicated }
  </i></font>Regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;                 </font><font color="#008000"><i>{ Get Function number for char. and Attribute }
  </i></font>Regs<font color="#000080">.</font>bh <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                 </font><font color="#008000"><i>{ display page }
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);               </font><font color="#008000"><i>{ Invoke DOS registers }
  </i></font>Character <font color="#000080">:= </font>chr<font color="#000080">(</font>Regs<font color="#000080">.</font>al<font color="#000080">);    </font><font color="#008000"><i>{ ASCII-Code of character }
  </i></font>COLOR <font color="#000080">:= </font>Regs<font color="#000080">.</font>ah<font color="#000080">;             </font><font color="#008000"><i>{ Attribute of the character }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Scroll<font color="#000080">(  </font>Direction <font color="#000080">: </font>Char<font color="#000080">;   </font><font color="#008000"><i>{ Direction U=Up D=Down }
                   </i></font>Number<font color="#000080">,             </font><font color="#008000"><i>{ Number of lines to be scrolled }
                   </i></font>COLOR<font color="#000080">,              </font><font color="#008000"><i>{ Attribute for the blank lines created }
                   </i></font>XLeft<font color="#000080">,              </font><font color="#008000"><i>{ Column in the upper left corner }
                   </i></font>YLeft<font color="#000080">,              </font><font color="#008000"><i>{ line in the upper left corner }
                   </i></font>XRight<font color="#000080">,             </font><font color="#008000"><i>{ Column in the lower right corner }
                   </i></font>YRight     <font color="#000080">: </font>integer<font color="#000080">);  </font><font color="#008000"><i>{ Line in lower right corner }

</i></font><font color="#FF0000"><b>var </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;       </font><font color="#008000"><i>{ Register variable for calling Interrupt }

</i></font><font color="#FF0000"><b>begin
  if </b></font>Direction <font color="#000080">= </font><font color="#800000">'U' </font><font color="#FF0000"><b>then
    </b></font>Regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">6                        </font><font color="#008000"><i>{ Scroll Up }
  </i></font><font color="#FF0000"><b>else </b></font>Regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;                    </font><font color="#008000"><i>{ Scroll Down }
  </i></font>Regs<font color="#000080">.</font>al <font color="#000080">:= </font>Number<font color="#000080">;
  </font>Regs<font color="#000080">.</font>bh <font color="#000080">:= </font>COLOR<font color="#000080">;                     </font><font color="#008000"><i>{ Color of empty line(s) }
  </i></font>Regs<font color="#000080">.</font>ch <font color="#000080">:= </font>YLeft<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;                   </font><font color="#008000"><i>{ Upper left }
  </i></font>Regs<font color="#000080">.</font>cl <font color="#000080">:= </font>XLeft<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;                   </font><font color="#008000"><i>{ coordinates }
  </i></font>Regs<font color="#000080">.</font>dh <font color="#000080">:= </font>YRight<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;                  </font><font color="#008000"><i>{ Lower right }
  </i></font>Regs<font color="#000080">.</font>dl <font color="#000080">:= </font>XRight<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;                  </font><font color="#008000"><i>{ coordinates }
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);                       </font><font color="#008000"><i>{ Call BIOS-Video-Interrupt }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>WriteXY<font color="#000080">(</font>X<font color="#000080">,</font>Y <font color="#000080">: </font>Byte<font color="#000080">;</font>Str <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>GotoXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);
    </font>Write<font color="#000080">(</font>Str<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DrawBox<font color="#000080">(</font>Title<font color="#000080">,</font>BoxDef <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>TopX<font color="#000080">,</font>TopY<font color="#000080">,</font>BotX<font color="#000080">,</font>BotY<font color="#000080">,</font>Shadow<font color="#000080">,</font>Border<font color="#000080">,</font>WindC <font color="#000080">: </font>byte<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>count<font color="#000080">,</font>space<font color="#000080">,
    </font>TX<font color="#000080">,</font>TY<font color="#000080">,</font>BX<font color="#000080">,</font>BY<font color="#000080">,</font>OldC <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>OldC <font color="#000080">:= </font>Textattr<font color="#000080">;
    </font>TX <font color="#000080">:= </font>Lo<font color="#000080">(</font>WindMin<font color="#000080">);
    </font>TY <font color="#000080">:= </font>Hi<font color="#000080">(</font>WindMin<font color="#000080">);
    </font>BX <font color="#000080">:= </font>Lo<font color="#000080">(</font>WindMax<font color="#000080">);
    </font>BY <font color="#000080">:= </font>Hi<font color="#000080">(</font>WindMax<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>Shadow <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
        </b></font>TextAttr <font color="#000080">:= </font>Shadow<font color="#000080">;
        </font>Window<font color="#000080">(</font>TopX<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>TopY<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>BotX<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>BotY<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
        </font>clrscr<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>TextAttr <font color="#000080">:= </font>WindC<font color="#000080">;
    </font>Window<font color="#000080">(</font>TopX<font color="#000080">,</font>TopY<font color="#000080">,</font>BotX<font color="#000080">,</font>BotY<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>windC <font color="#000080">&lt;&gt; </font><font color="#800000">$00 </font><font color="#FF0000"><b>then </b></font>clrscr<font color="#000080">;
    </font>Window<font color="#000080">(</font>TX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>TY<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>BX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>BY<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
    </font>TextAttr <font color="#000080">:= </font>Border<font color="#000080">;

    </font>WriteXY<font color="#000080">(</font>TopX<font color="#000080">,</font>TopY<font color="#000080">,</font>BoxDef<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
    </font><font color="#FF0000"><b>for </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>BotX<font color="#000080">-</font>TopX<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
      </b></font>write<font color="#000080">(</font>BoxDef<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
    </font>write<font color="#000080">(</font>BoxDef<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]);

    </font><font color="#FF0000"><b>For </b></font>count <font color="#000080">:= </font>TopY<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>BotY<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
      begin
        </b></font>WriteXY<font color="#000080">(</font>TopX<font color="#000080">,</font>Count<font color="#000080">,</font>BoxDef<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
        </font>WriteXY<font color="#000080">(</font>BotX<font color="#000080">,</font>Count<font color="#000080">,</font>BoxDef<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>WriteXY<font color="#000080">(</font>TopX<font color="#000080">,</font>BotY<font color="#000080">,</font>BoxDef<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]);
    </font><font color="#FF0000"><b>for </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>BotX<font color="#000080">-</font>TopX<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
      </b></font>write<font color="#000080">(</font>BoxDef<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
    </font>write<font color="#000080">(</font>BoxDef<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]);

    </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>Title<font color="#000080">)+</font><font color="#800000">2 </font><font color="#000080">&lt; (</font>BotX<font color="#000080">-</font>TopX<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>GotoXY<font color="#000080">(</font>TopX<font color="#000080">+ (</font>Round<font color="#000080">((</font>BotX<font color="#000080">-</font>TopX<font color="#000080">)/</font><font color="#800000">2</font><font color="#000080">) - </font>Round<font color="#000080">((</font>Length<font color="#000080">(</font>Title<font color="#000080">)/</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">)) ,</font>TopY<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>Title <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>Title<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>TextAttr <font color="#000080">:= </font>OldC<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Parse<font color="#000080">(</font>ParseChr <font color="#000080">: </font>char<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>count <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>count <font color="#000080">:= </font>Pos<font color="#000080">(</font>ParseChr<font color="#000080">,</font>Str<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>count <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
        </b></font>Parse <font color="#000080">:= </font>Copy<font color="#000080">(</font>Str<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>count<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
        </font>Str   <font color="#000080">:= </font>Copy<font color="#000080">(</font>Str<font color="#000080">,</font>count<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Length<font color="#000080">(</font>Str<font color="#000080">)-</font>count<font color="#000080">);
      </font><font color="#FF0000"><b>end else </b></font>Parse <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>SelMenu<font color="#000080">(</font>Xpos<font color="#000080">,</font>Ypos<font color="#000080">,</font>NormColor<font color="#000080">,</font>HighColor<font color="#000080">,</font>BordColor<font color="#000080">,</font>Box <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>MenuName<font color="#000080">,</font>MenuS <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>type
    </b></font>MenuRec <font color="#000080">= </font><font color="#FF0000"><b>record
      </b></font>mstr  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
      </font>xpos <font color="#000080">: </font>byte<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>Selection <font color="#000080">: </font>integer<font color="#000080">;
    </font>x<font color="#000080">,</font>lastm<font color="#000080">,</font>lastx<font color="#000080">,
    </font>y<font color="#000080">,</font>Xlen    <font color="#000080">: </font>byte<font color="#000080">;
    </font>MenuArr   <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">20</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>MenuRec<font color="#000080">;
    </font>CH        <font color="#000080">: </font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>lastm <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>lastX <font color="#000080">:= </font>xpos<font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
      </b></font>inc<font color="#000080">(</font>LastM<font color="#000080">);
      </font>MenuArr<font color="#000080">[</font>LastM<font color="#000080">].</font>mstr <font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">+</font>Parse<font color="#000080">(</font><font color="#800000">'|'</font><font color="#000080">,</font>MenuS<font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">;
      </font>MenuArr<font color="#000080">[</font>LastM<font color="#000080">].</font>xpos <font color="#000080">:= </font>LastX<font color="#000080">;
      </font>LastX <font color="#000080">:= </font>Length<font color="#000080">(</font>MenuArr<font color="#000080">[</font>LastM<font color="#000080">].</font>mstr<font color="#000080">)+</font>LastX<font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font>MenuS <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;
    </font>x <font color="#000080">:= </font>Length<font color="#000080">(</font>MenuArr<font color="#000080">[</font>LastM<font color="#000080">].</font>mstr<font color="#000080">)+</font>MenuArr<font color="#000080">[</font>LastM<font color="#000080">].</font>xpos<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>Box <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>DrawBox<font color="#000080">(</font>MenuName<font color="#000080">,</font>single<font color="#000080">,</font>Xpos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Ypos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>x<font color="#000080">,</font>Ypos<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>BordColor<font color="#000080">,</font>NormColor<font color="#000080">);
    </font>Gotoxy<font color="#000080">(</font>Xpos<font color="#000080">,</font>Ypos<font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>lastM <font color="#FF0000"><b>do
      </b></font>Write<font color="#000080">(</font>MenuArr<font color="#000080">[</font>x<font color="#000080">].</font>mstr<font color="#000080">);
    </font>x <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>repeat
      case </b></font>selection <font color="#FF0000"><b>of
        </b></font><font color="#800000">333 </font><font color="#000080">: </font>inc<font color="#000080">(</font>x<font color="#000080">);
        </font><font color="#800000">331 </font><font color="#000080">: </font>dec<font color="#000080">(</font>x<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>x <font color="#000080">= </font>lastm<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>x <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>x <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>x <font color="#000080">:= </font>lastm<font color="#000080">;
      </font>textattr <font color="#000080">:= </font>HighColor<font color="#000080">;
      </font>WriteXY<font color="#000080">(</font>MenuArr<font color="#000080">[</font>x<font color="#000080">].</font>xpos<font color="#000080">,</font>Ypos<font color="#000080">,</font>MenuArr<font color="#000080">[</font>x<font color="#000080">].</font>mstr<font color="#000080">);
      </font>gotoxy<font color="#000080">(</font>menuArr<font color="#000080">[</font>x<font color="#000080">].</font>xpos<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Ypos<font color="#000080">);
      </font>selection <font color="#000080">:= </font>Get_Key<font color="#000080">;
      </font>gotoxy<font color="#000080">(</font>menuArr<font color="#000080">[</font>x<font color="#000080">].</font>xpos<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Ypos<font color="#000080">);
      </font>textattr <font color="#000080">:= </font>NormColor<font color="#000080">;
      </font>WriteXY<font color="#000080">(</font>MenuArr<font color="#000080">[</font>x<font color="#000080">].</font>xpos<font color="#000080">,</font>Ypos<font color="#000080">,</font>MenuArr<font color="#000080">[</font>x<font color="#000080">].</font>mstr<font color="#000080">);
    </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>selection <font color="#000080">&gt; </font><font color="#800000">333</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>selection <font color="#000080">&lt; </font><font color="#800000">331</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>selection <font color="#000080">= </font><font color="#800000">13 </font><font color="#FF0000"><b>then
      begin
        </b></font>y <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
        </font><font color="#FF0000"><b>while </b></font>y <font color="#000080">&lt; </font>Length<font color="#000080">(</font>MenuArr<font color="#000080">[</font>x<font color="#000080">].</font>mstr<font color="#000080">)-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
          begin
            </b></font>Ch <font color="#000080">:= </font>MenuArr<font color="#000080">[</font>x<font color="#000080">].</font>mstr<font color="#000080">[</font>y<font color="#000080">];
            </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>CH <font color="#000080">&gt;= </font><font color="#800000">'A'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>CH <font color="#000080">&lt;= </font><font color="#800000">'Z'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>SelMenu <font color="#000080">:= </font>CH<font color="#000080">;
            </font>inc<font color="#000080">(</font>y<font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end else </b></font>SelMenu <font color="#000080">:= </font>Chr<font color="#000080">(</font>Selection<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>keyval <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ErrPrompt <font color="#000080">:= </font>False<font color="#000080">;
  </font>InitScrn<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0080.PAS">Original</a><b>]</b></p></body>
</html>
