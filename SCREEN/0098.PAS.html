<html>
<head><title> "Suppressing Screen Output" by CHRIS AUSTIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0098.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 GH&gt; I want to suppress the screen output of an archiver
Well I have a idea how you would do that.... What you need to do is tap into
interrupt $21 and check if AH=9, if it does that means that dos is calling the
print_string (or whatever its called) function. So if you detect that, just
return, otherwise jump onto DOS and let it process that. so you would set that
up just b4 you exec, then exec, then restore the original interrupt. Heres
some code I made. It doesn't work but I think it comes fairly close.....
}

</i></font><font color="#FF0000"><b>Unit </b></font>DosTrap<font color="#000080">;
 </font><font color="#FF0000"><b>Interface
  Var </b></font>Int21Save <font color="#000080">: </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;        </font><font color="#008000"><i>{Pointer to the old 1C.                  }

</i></font><font color="#FF0000"><b>Procedure </b></font>InstallInt21h<font color="#000080">;            </font><font color="#008000"><i>{Install the interrupt routine for $1C.
}</i></font><font color="#FF0000"><b>Procedure </b></font>RestoreInt21h<font color="#000080">;            </font><font color="#008000"><i>{Restore the original interrupt for $1C.
}</i></font><font color="#FF0000"><b>Procedure </b></font>Suppress<font color="#000080">(</font>ProgramName<font color="#000080">,
                   </font>CommandLine<font color="#000080">:
                       </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Implementation
 Uses </b></font>CRT<font color="#000080">,
      </font>DOS<font color="#000080">;

</font><font color="#008000"><i>{$F+,S-}
</i></font><font color="#FF0000"><b>Procedure </b></font>IntHandler<font color="#000080">;
 </font>Interrupt<font color="#000080">;
  </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">Cmp   AH,0
    PushF
    Je    @Done
    Call  Int21Save
   @Done:
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{$F-,S-}

</i></font><font color="#FF0000"><b>Procedure </b></font>InstallInt21h<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>GetIntVec<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,@</font>Int21Save<font color="#000080">);
  </font>SetIntVec<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>Addr<font color="#000080">(</font>IntHandler<font color="#000080">));
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>RestoreInt21h<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>SetIntVec<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,@</font>Int21Save<font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Suppress<font color="#000080">(</font>ProgramName<font color="#000080">, </font>CommandLine <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
</b></font>InstallInt21h<font color="#000080">;
</font>SwapVectors<font color="#000080">;
</font>Exec<font color="#000080">(</font>ProgramName<font color="#000080">, </font>CommandLine<font color="#000080">);
</font>SwapVectors<font color="#000080">;
</font>RestoreInt21h<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
--------&gt; </font>A sample <font color="#FF0000"><b>program </b></font>using it<font color="#000080">...
</font><font color="#008000"><i>{$M $4000,0,0 }   { 16K stack, no heap }
</i></font><font color="#FF0000"><b>Uses </b></font>DosTrap<font color="#000080">, </font>Dos<font color="#000080">,</font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>ClrScr<font color="#000080">;
</font>WriteLn<font color="#000080">(</font><font color="#800000">'Exec''ing'</font><font color="#000080">);
</font>Suppress<font color="#000080">(</font><font color="#800000">'C:\pkunzip.exe'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
</font>WriteLn<font color="#000080">(</font><font color="#800000">'Done.'</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
----------------&gt;</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0098.PAS">Original</a><b>]</b></p></body>
</html>
