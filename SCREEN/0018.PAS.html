<html>
<head><title> "Three FAST write Routines" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ THREE DIFFERENT WAYS TO WRITE TO SCREEN WITH ROW AND COLUMN }
{ TWO ARE VERY FAST AND ALLOW COLOR }

</i></font><font color="#FF0000"><b>procedure </b></font>QWrite<font color="#000080">( </font>Column<font color="#000080">, </font>Line <font color="#000080">, </font>Color <font color="#000080">: </font>byte<font color="#000080">; </font>S <font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">);

</font><font color="#FF0000"><b>var
   </b></font>VMode  <font color="#000080">: </font>BYTE <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$0040 </font><font color="#000080">: </font><font color="#800000">$0049</font><font color="#000080">; </font><font color="#008000"><i>{ Video mode: Mono=7, Color=0-3 }
   </i></font>NumCol <font color="#000080">: </font>WORD <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$0040 </font><font color="#000080">: </font><font color="#800000">$004A</font><font color="#000080">; </font><font color="#008000"><i>{ Number of CRT columns (1-based) }
   </i></font>VSeg   <font color="#000080">: </font>WORD<font color="#000080">;
   </font>OfsPos <font color="#000080">: </font>integer<font color="#000080">;  </font><font color="#008000"><i>{ offset position of the character in video RAM }
   </i></font>vPos   <font color="#000080">: </font>integer<font color="#000080">;
   </font>sLen   <font color="#000080">: </font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font>S<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  If </b></font>VMode <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>THEN </b></font>VSeg <font color="#000080">:= </font><font color="#800000">$B000 </font><font color="#FF0000"><b>ELSE </b></font>VSeg <font color="#000080">:= </font><font color="#800000">$B800</font><font color="#000080">;
  </font>OfsPos   <font color="#000080">:= (((</font>pred<font color="#000080">(</font>Line<font color="#000080">) * </font>NumCol<font color="#000080">) + </font>pred<font color="#000080">(</font>Column<font color="#000080">)) * </font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>vPos <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>pred<font color="#000080">(</font>sLen<font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>MemW<font color="#000080">[</font>VSeg <font color="#000080">: (</font>OfsPos <font color="#000080">+ (</font>vPos <font color="#000080">* </font><font color="#800000">2</font><font color="#000080">))] :=
                     (</font>Color <font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>byte<font color="#000080">(</font>S<font color="#000080">[</font>succ<font color="#000080">(</font>vPos<font color="#000080">)])
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>fastwrite<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>f<font color="#000080">, </font>b<font color="#000080">: </font>byte<font color="#000080">; </font>s <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);

</font><font color="#008000"><i>{ Does a direct video write -- extremely fast.
  X, Y = screen location of first byte;
  S = string to display;
  F = foreground color;
  B = background color. }

</i></font><font color="#FF0000"><b>type  </b></font>videolocation <font color="#000080">= </font><font color="#FF0000"><b>record    </b></font><font color="#008000"><i>{ the layout of a two-byte video location }
        </i></font>videodata<font color="#000080">: </font>char<font color="#000080">;        </font><font color="#008000"><i>{ character displayed }
        </i></font>videoattribute<font color="#000080">: </font>byte<font color="#000080">;   </font><font color="#008000"><i>{ attributes }
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>cnter<font color="#000080">: </font>byte<font color="#000080">;
    </font>videosegment<font color="#000080">: </font>word<font color="#000080">;         </font><font color="#008000"><i>{ the location of video memory }
    </i></font>monosystem<font color="#000080">: </font>boolean<font color="#000080">;        </font><font color="#008000"><i>{ mono vs. color }
    </i></font>vidptr<font color="#000080">: ^</font>videolocation<font color="#000080">;     </font><font color="#008000"><i>{ pointer to video locations }

</i></font><font color="#FF0000"><b>begin

</b></font><font color="#008000"><i>{ Find the memory location where the string will be displayed at, according to
  the monitor type and screen location.  Then associate the pointer VIDPTR with
  that memory location: VIDPTR is a pointer to type VIDEOLOCATION.  Insert a
  character and attribute; now go to the next character and video location. }

  </i></font>monosystem <font color="#000080">:= (</font>lastmode <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">]);
  </font><font color="#FF0000"><b>if </b></font>monosystem <font color="#FF0000"><b>then </b></font>videosegment <font color="#000080">:= </font><font color="#800000">$b000 </font><font color="#FF0000"><b>else </b></font>videosegment <font color="#000080">:= </font><font color="#800000">$b800</font><font color="#000080">;
  </font>vidptr <font color="#000080">:= </font>ptr<font color="#000080">(</font>videosegment<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">*(</font><font color="#800000">80</font><font color="#000080">*(</font>y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) + (</font>x <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)));
  </font><font color="#FF0000"><b>for </b></font>cnter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>vidptr<font color="#000080">^.</font>videoattribute <font color="#000080">:= (</font>b <font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">) + </font>f<font color="#000080">;  </font><font color="#008000"><i>{ high nibble=bg; lo nibble=fg }
    </i></font>vidptr<font color="#000080">^.</font>videodata <font color="#000080">:= </font>s<font color="#000080">[</font>cnter<font color="#000080">];            </font><font color="#008000"><i>{ put character at location }
    </i></font>inc<font color="#000080">(</font>vidptr<font color="#000080">);                              </font><font color="#008000"><i>{ go to next video location }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Print<font color="#000080">(</font>x<font color="#000080">,</font>y <font color="#000080">: </font>Byte<font color="#000080">; </font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  ASM
  </b></font><font color="#FF00FF">MOV DH, Y    </font><font color="#008000"><i>{ DH = Row (Y) }
  </i></font><font color="#FF00FF">MOV DL, X    </font><font color="#008000"><i>{ DL = Column (X) }
  </i></font><font color="#FF00FF">DEC DH       </font><font color="#008000"><i>{ Adjust For Zero-based Bios routines }
  </i></font><font color="#FF00FF">DEC DL       </font><font color="#008000"><i>{ Turbo Crt.GotoXY is 1-based }
  </i></font><font color="#FF00FF">MOV BH,0     </font><font color="#008000"><i>{ Display page 0 }
  </i></font><font color="#FF00FF">MOV AH,2     </font><font color="#008000"><i>{ Call For SET CURSOR POSITION }
  </i></font><font color="#FF00FF">INT 10h
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font>WRITE<font color="#000080">(</font>S<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SCREEN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p></body>
</html>
