<html>
<head><title> "ST-CASE3.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here's a few routines you might find useful For your name problem.
I call the Function &quot;UpperName&quot; whenever the user presses a
valid Text key in a name field, but it can also be called just
once after the entire input String is entered.
}

(* First, some general routines: *)
(* ----------------------------- *)

</i></font><font color="#FF0000"><b>Function  </b></font>FindStrLength<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{ Finds &quot;S&quot;'s length, not counting trailing spaces }
</i></font><font color="#FF0000"><b>Var
  </b></font>StrLen<font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>S<font color="#000080">;
  </font>I     <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>I <font color="#000080">:= </font>StrLen<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>StrLen <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    For </b></font>I <font color="#000080">:= </font>StrLen <font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
      if </b></font>S<font color="#000080">[</font>I<font color="#000080">] &lt;&gt; </font><font color="#800000">' ' </font><font color="#FF0000"><b>then
        </b></font>Break<font color="#000080">;
  </font>FindStrLength <font color="#000080">:= </font>I<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ FindStrLength }

</i></font><font color="#FF0000"><b>Function </b></font>WordDelimiter<font color="#000080">(</font>C<font color="#000080">: </font>Char<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ -Checks if &quot;C&quot; qualifies as a String Word-delimiter }
</i></font><font color="#FF0000"><b>Const
  </b></font>WordDels<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">34</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">=
    </font><font color="#800000">#32#9#13#10#39',./?;:&quot;&lt;&gt;[]{}-=\+|()*%@&amp;^$#!~'</font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>WordDelimiter <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">34 </font><font color="#FF0000"><b>do
    if </b></font>C <font color="#000080">= </font>WordDels<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>then
    begin
      </b></font>WordDelimiter <font color="#000080">:= </font>True<font color="#000080">;
      </font>Break<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ WordDelimiter }

</i></font><font color="#FF0000"><b>Function  </b></font>ParceWord<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Ind<font color="#000080">, </font>L<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Returns the next Word from &quot;Ind&quot; index in &quot;S&quot; }
</i></font><font color="#FF0000"><b>Var
  </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ParceWord <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>I <font color="#000080">:= </font>Ind<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font>Ind <font color="#FF0000"><b>to </b></font>L <font color="#FF0000"><b>do
    if </b></font>WordDelimiter<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>then
    begin
      </b></font>ParceWord <font color="#000080">:= </font>Copy<font color="#000080">(</font>S<font color="#000080">, </font>Ind<font color="#000080">, </font>I<font color="#000080">-</font>Ind<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
      </font>Break<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ ParceWord }


(* Now down to business: *)
(* --------------------- *)

</i></font><font color="#FF0000"><b>Procedure </b></font>UpperName<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#008000"><i>{ Converts the first Character in Words to upper Case letters }
</i></font><font color="#FF0000"><b>Var
  </b></font>I<font color="#000080">, </font>L<font color="#000080">: </font>Integer<font color="#000080">;
  </font>St  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>L <font color="#000080">:= </font>FindStrLength<font color="#000080">(</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>L <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font>L <font color="#FF0000"><b>downto </b></font><font color="#800000">2 </font><font color="#FF0000"><b>do
    if </b></font>WordDelimiter<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>then
    begin
      </b></font>St <font color="#000080">:= </font>StUpCase<font color="#000080">(</font>ParceWord<font color="#000080">(</font>S<font color="#000080">, </font>I<font color="#000080">, </font>L<font color="#000080">));
      </font><font color="#008000"><i>{ you can put in exception Words here... }
      </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>St <font color="#000080">= </font><font color="#800000">'DE'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>St <font color="#000080">= </font><font color="#800000">'DEN'</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font><font color="#008000"><i>{ ie: Markis de Bleuchamp or van den Haag }
         </i></font>S<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'d'
      </font><font color="#FF0000"><b>else
        </b></font>S<font color="#000080">[</font>I<font color="#000080">] := </font>UpCase<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">]);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>UpCase<font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ UpperName }

{
(The Function &quot;StupCase&quot; is from TurboPower Tpro, but any
routine that converts a String to upper Case letters will do).

Please note that I had to modify this source beFore
posting it here (it was full of norwegian name style
identifiers that only would've confused you), so it's not
tested in the current Form and may contain bugs.
...But I'm sure you get the general idea.  :-)

posting it here (it was full of norwegian name style
identifiers that only would've confused you), so it's not
tested in the current Form and may contain bugs.
...But I'm sure you get the general idea.  :-)
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
