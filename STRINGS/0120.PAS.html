<html>
<head><title> "FAST Delete String Procedure" by DAVOR DUNDOVIC</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0120.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 I am offering you my DelStr procedure. It's written in assembler
 (BASM), behaves just like standard Delete procedure only a LOT
 faster. I hope you'll find it interesting (and good) enough to
 include it in STRINGS.SWG.
}

 </i></font><font color="#FF0000"><b>procedure </b></font>DelStr<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>Const </b></font>Index<font color="#000080">, </font>Count <font color="#000080">: </font>byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">push ds
    mov cl,Count
    or cl,cl
    jz @Exit
    lds ax,S
    les ax,S
    mov bx,ax
    push ax
    mov al,Index
    xor ah,ah
    xor ch,ch
    add ax,cx
    dec ax
    mov cl,byte ptr [bx]
    cmp ax,cx
    pop ax
    ja @Exit
    je @To_End
    mov cl,Index
    xor ch,ch
    add ax,cx
    mov di,ax
    mov cl,Count
    xor ch,ch
    add ax,cx
    mov si,ax
    mov cl,byte ptr [bx]
    sub cl,Count
    xor ch,ch
    or cx,cx
    jz @Empty
    cld
    rep movsb
    mov cl,byte ptr [bx]
    sub cl,Count
 @Empty:
    mov byte ptr [bx],cl
    jmp @Exit
 @To_End:
    mov cl,Index
    dec cl
    mov byte ptr [bx],cl
 @Exit:
    pop ds
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0120.PAS">Original</a><b>]</b></p></body>
</html>
