<html>
<head><title> "BASIC String Functions" by JOSEPH COUSINS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0113.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{  File:  Basics.Pas }
{+------------------------------------------------------------------+}
{: Unit  : Basics   ( BASIC functions in Turbo Pascal )             :}
{+------------------------------------------------------------------+}
{: Author : Joseph L. Cousins                                       :}
{:                                                                  :}
{:    for : Sierra Consultants                                      :}
{:          3500 Hawthorne Road                                     :}
{:          Fredericksburg, Virginia 22407-6819                     :}
{:          (703) 785-9472, (703) 786-2316                          :}
{:          CompuServe ID = [70245,374]                             :}
{:          Internet      = jcousins@ix.netcom.com                  :}
{:                                                                  :}
{: Copyright (c) 1992-95 by Sierra Consultants  All Rights Reserved :}
{:                                                                  :}
{+------------------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Unit </b></font>Basics<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses
    </b></font>Dos<font color="#000080">,
    </font>CRT<font color="#000080">,
    </font>Printer<font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+------------------------------------------------------------------+}
{: The following are the descriptions of the Functions and Procedures}
{+------------------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Left<font color="#000080">(</font>inString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>numChars <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Right<font color="#000080">(</font>inString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>numChars <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Len<font color="#000080">(</font>inString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>LTrim<font color="#000080">(</font>inString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>RTrim<font color="#000080">(</font>inString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Trim<font color="#000080">(</font>inString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Empty<font color="#000080">(</font>inString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>SubStr<font color="#000080">(</font>inString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>numChars<font color="#000080">, </font>strSize <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>PutStr<font color="#000080">(</font>inString<font color="#000080">,</font>putString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>where<font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Stuff<font color="#000080">(</font>putString<font color="#000080">, </font>inString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>where<font color="#000080">: </font>Integer<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Lower<font color="#000080">(</font>inString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Upper<font color="#000080">(</font>inString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Instr<font color="#000080">(</font>Temp_Item<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>From<font color="#000080">, </font>Size<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>NoTrailZeros<font color="#000080">(</font>tempStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>MkStr<font color="#000080">(</font>I<font color="#000080">,</font>W<font color="#000080">:</font>Integer<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Spaces<font color="#000080">(</font>i<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>LeadZeros<font color="#000080">(</font>inString <font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Str2Bin<font color="#000080">(</font>inString <font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>IfStr<font color="#000080">( </font>Text<font color="#000080">, </font>Pattern <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>PrnOk <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>LPrint<font color="#000080">(</font>PrnString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Eject<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Beep<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Time <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Date <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Month <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>WeekDay <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>DayOfWeek<font color="#000080">( </font>Day <font color="#000080">: </font>Integer <font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>DateStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Fix<font color="#000080">(</font>x <font color="#000080">: </font>Real<font color="#000080">): </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Int<font color="#000080">(</font>x <font color="#000080">: </font>Real<font color="#000080">): </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>OCT<font color="#000080">( </font>Value <font color="#000080">: </font>Longint <font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Hex<font color="#000080">( </font>Value <font color="#000080">: </font>Longint <font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>ASC<font color="#000080">( </font>inString <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>RAD<font color="#000080">( </font>Degrees <font color="#000080">: </font>Real <font color="#000080">): </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>DEG<font color="#000080">( </font>Radians <font color="#000080">: </font>Real <font color="#000080">): </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>LOG<font color="#000080">( </font>x <font color="#000080">: </font>Real <font color="#000080">): </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>SGN<font color="#000080">( </font>x <font color="#000080">: </font>Integer <font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>DefSeg<font color="#000080">( </font>SegValue <font color="#000080">: </font>Integer <font color="#000080">);
</font><font color="#FF0000"><b>Function </b></font>Peek<font color="#000080">( </font>Offset <font color="#000080">: </font>Word <font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>PeekW<font color="#000080">( </font>Offset <font color="#000080">: </font>Word <font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>PeekL<font color="#000080">( </font>Offset <font color="#000080">: </font>Word <font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Poke<font color="#000080">( </font>Offset<font color="#000080">: </font>Word<font color="#000080">; </font>Value <font color="#000080">: </font>Byte <font color="#000080">);
</font><font color="#FF0000"><b>Function </b></font>TAN<font color="#000080">( </font>x <font color="#000080">: </font>Real <font color="#000080">): </font>Real<font color="#000080">;  </font><font color="#008000"><i>{ input must be in radians }
</i></font><font color="#FF0000"><b>Function </b></font>Input<font color="#000080">( </font>prompt <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>InputS<font color="#000080">( </font>prompt <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>InputI<font color="#000080">( </font>prompt <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>InputR<font color="#000080">( </font>prompt <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>PrintAT<font color="#000080">(</font>Row<font color="#000080">, </font>Col <font color="#000080">: </font>Word<font color="#000080">; </font>Tex <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Print<font color="#000080">(</font>Tex <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>CursorOn<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>CursorOff<font color="#000080">;
</font><font color="#008000"><i>{.pa}
</i></font><font color="#FF0000"><b>const

  </b></font>WeekDays <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of String </b></font><font color="#000080">=
                         (</font><font color="#800000">'Sunday'</font><font color="#000080">,</font><font color="#800000">'Monday'</font><font color="#000080">,</font><font color="#800000">'Tuesday'</font><font color="#000080">,</font><font color="#800000">'Wednesday'</font><font color="#000080">,
                          </font><font color="#800000">'Thursday'</font><font color="#000080">,</font><font color="#800000">'Friday'</font><font color="#000080">,</font><font color="#800000">'Saturday'</font><font color="#000080">);

  </font>Months   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of String </b></font><font color="#000080">=
                          (</font><font color="#800000">'January'</font><font color="#000080">,</font><font color="#800000">'February'</font><font color="#000080">,</font><font color="#800000">'March'</font><font color="#000080">,</font><font color="#800000">'April'</font><font color="#000080">,</font><font color="#800000">'May'</font><font color="#000080">,
                           </font><font color="#800000">'June'</font><font color="#000080">,</font><font color="#800000">'July'</font><font color="#000080">,</font><font color="#800000">'August'</font><font color="#000080">,</font><font color="#800000">'September'</font><font color="#000080">,</font><font color="#800000">'October'</font><font color="#000080">,
                           </font><font color="#800000">'November'</font><font color="#000080">,</font><font color="#800000">'December'</font><font color="#000080">);
  </font>CR <font color="#000080">= </font>Chr<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">);
  </font>LF <font color="#000080">= </font>Chr<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
  </font>FF <font color="#000080">= </font>Chr<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">);
  </font>ESC <font color="#000080">= </font>Chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">);
  </font>BS <font color="#000080">= </font>Chr<font color="#000080">(</font><font color="#800000">08</font><font color="#000080">);
  </font>Space <font color="#000080">= </font><font color="#800000">' '</font><font color="#000080">;
  </font>Yes <font color="#000080">= </font>True<font color="#000080">;
  </font>No <font color="#000080">= </font>False<font color="#000080">;

</font><font color="#FF0000"><b>Var
   </b></font>Segment  <font color="#000080">: </font>Word<font color="#000080">;         </font><font color="#008000"><i>{ Preset to zero }
   </i></font>GMT      <font color="#000080">: </font>Boolean<font color="#000080">;
   </font>Suppress <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Implementation

</b></font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  PrnOk ( checks status of printer )        :}
{+-------------------------------------------------------+}
{:    Syntax : PrnOk                                     :}
{:                                                       :}
{:    Action : Test printer status through MSDOS and     :}
{:             returns TRUE if printer is available.     :}
{:                                                       :}
{: Result Type :  Boolean                                :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>PrnOk<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Rg <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Rg<font color="#000080">.</font>AH    <font color="#000080">:= </font><font color="#800000">$02</font><font color="#000080">;  </font><font color="#008000"><i>{ Get Status }
  </i></font>Rg<font color="#000080">.</font>DX    <font color="#000080">:= </font><font color="#800000">$0000</font><font color="#000080">; </font><font color="#008000"><i>{ Use printer 0 }
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$17</font><font color="#000080">,</font>Rg<font color="#000080">);  </font><font color="#008000"><i>{ MsDos Service request    }
  </i></font>PrnOk <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Rg<font color="#000080">.</font>AH <font color="#000080">&lt;&gt; </font><font color="#800000">$90 </font><font color="#FF0000"><b>then
    </b></font>PrnOk <font color="#000080">:= </font>False
<font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}

{+-------------------------------------------------------+}
{: Procedure : LPrint ( Print string to printer )        :}
{+-------------------------------------------------------+}
{:    Syntax : LPrint ( &lt;expS1&gt; )                        :}
{:                                                       :}
{:     Where : &lt;expS1&gt; = String expression               :}
{:                                                       :}
{:    Action : Sends the string expression to the printer:}
{:             using the MSDOS interrupt 17h.            :}
{:                                                       :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Procedure </b></font>LPrint<font color="#000080">(</font>PrnString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>Pi<font color="#000080">,</font>Pj <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Rg <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>PrnOk <font color="#FF0000"><b>then
    Begin
      </b></font>PrnString <font color="#000080">:= </font>PrnString<font color="#000080">+</font>CR<font color="#000080">+</font>LF<font color="#000080">;
      </font>Pj <font color="#000080">:= </font>Ord<font color="#000080">(</font>PrnString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
      </font><font color="#FF0000"><b>For </b></font>Pi <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Pj <font color="#FF0000"><b>Do
        Begin
          </b></font>Rg<font color="#000080">.</font>AL <font color="#000080">:= </font>Ord<font color="#000080">(</font>PrnString<font color="#000080">[</font>Pi<font color="#000080">]);
          </font>Rg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
          </font>Rg<font color="#000080">.</font>DX <font color="#000080">:= </font><font color="#800000">$0000</font><font color="#000080">;
          </font>Intr<font color="#000080">(</font><font color="#800000">$17</font><font color="#000080">,</font>Rg<font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}

</i></font><font color="#FF0000"><b>Procedure </b></font>Eject<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>LPrint<font color="#000080">(</font>FF<font color="#000080">);   </font><font color="#008000"><i>{ do an eject on printer}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Beep<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">07</font><font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+---------------------------------------------------------------------+}
{: Function FIX   -    Truncates x to an integer                       :}
{+---------------------------------------------------------------------+}
{: format :    v = FIX(x)                                              :}
{:                         FIX strips all  digits to the right of the  :}
{:                         decimal point and returns the value of the  :}
{:                         digits to the left of the decimal point.    :}
{:                                                                     :}
{:  The difference between FIX and INT is that FIX does not return the :}
{:  next lower number when x is negative.                              :}
{+---------------------------------------------------------------------+}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Fix<font color="#000080">(</font>x <font color="#000080">: </font>Real<font color="#000080">): </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Fix <font color="#000080">:= </font>x <font color="#000080">- </font>Frac<font color="#000080">(</font>x<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+---------------------------------------------------------------------+}
{: Function INT   -    Truncates x to an integer                       :}
{+---------------------------------------------------------------------+}
{: format :    v = INT(x)                                              :}
{:                         INT strips all  digits to the right of the  :}
{:                         decimal point and returns the value of the  :}
{:                         digits to the left of the decimal point.    :}
{:                                                                     :}
{:  The difference between FIX and INT is that FIX does not return the :}
{:  next lower number when x is negative.                              :}
{+---------------------------------------------------------------------+}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Int<font color="#000080">(</font>x <font color="#000080">: </font>Real<font color="#000080">): </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>x <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    If </b></font>Frac<font color="#000080">(</font>x<font color="#000080">) &gt;= </font><font color="#800000">0.5 </font><font color="#FF0000"><b>Then
      </b></font>Int <font color="#000080">:= (</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) - </font>Frac<font color="#000080">(</font>x<font color="#000080">)
    </font><font color="#FF0000"><b>Else
      </b></font>Int <font color="#000080">:= </font>Fix<font color="#000080">(</font>x<font color="#000080">)
  </font><font color="#FF0000"><b>Else
    </b></font>Int <font color="#000080">:= </font>Fix<font color="#000080">(</font>x<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-----------------------------------------------------------+}
{: Procedure:    T i m e  ( convert system time to string )  :}
{+-----------------------------------------------------------+}
{:   This Procedure Builds the current time of day by getting:}
{: the time from DOS and converting it To ascii.             :}
{+-----------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Time<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>AmPm <font color="#000080">: </font>Char<font color="#000080">;
   </font>Hr<font color="#000080">, </font>Mn<font color="#000080">, </font>Sc<font color="#000080">, </font>Sc100 <font color="#000080">: </font>Word<font color="#000080">;
   </font>t1<font color="#000080">, </font>t2<font color="#000080">, </font>t3 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GetTime<font color="#000080">(</font>Hr<font color="#000080">,</font>Mn<font color="#000080">,</font>Sc<font color="#000080">,</font>Sc100<font color="#000080">);
  </font>AmPm <font color="#000080">:= </font><font color="#800000">'a'</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Hr <font color="#000080">&gt;= </font><font color="#800000">12 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>AmPm <font color="#000080">:= </font><font color="#800000">'p'</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>GMT <font color="#000080">= </font>False <font color="#FF0000"><b>then
        Begin
          If </b></font>Hr <font color="#000080">&gt; </font><font color="#800000">12 </font><font color="#FF0000"><b>Then
            </b></font>Hr <font color="#000080">:= </font>Hr <font color="#000080">- </font><font color="#800000">12</font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Str<font color="#000080">(</font>Hr<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>t1<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>GMT <font color="#FF0000"><b>then
    If </b></font>Hr <font color="#000080">&lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>Then
      </b></font>t1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>Chr<font color="#000080">(</font><font color="#800000">48</font><font color="#000080">);
  </font>Str<font color="#000080">(</font>Mn<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>t2<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Mn <font color="#000080">&lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>Then
    </b></font>t2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>Chr<font color="#000080">(</font><font color="#800000">48</font><font color="#000080">);
  </font>Str<font color="#000080">(</font>Sc<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>t3<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Sc <font color="#000080">&lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>Then
    </b></font>t3<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>Chr<font color="#000080">(</font><font color="#800000">48</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>GMT <font color="#FF0000"><b>Then
    </b></font>AmPm <font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">;
  </font>Time <font color="#000080">:= </font>t1<font color="#000080">+</font><font color="#800000">':'</font><font color="#000080">+</font>t2<font color="#000080">+</font><font color="#800000">':'</font><font color="#000080">+</font>t3<font color="#000080">+</font>AmPm<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-----------------------------------------------------------+}
{: Procedure:    D a t e   ( convert system date to ascii )  :}
{+-----------------------------------------------------------+}
{:   This Procedure Builds the current Date by getting the   :}
{: date from DOS and converting it To an ascii string.       :}
{+-----------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Date <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>Y<font color="#000080">,</font>M<font color="#000080">,</font>D<font color="#000080">,</font>Week  <font color="#000080">: </font>Word<font color="#000080">;
   </font>t1<font color="#000080">, </font>t2<font color="#000080">, </font>t3 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GetDate<font color="#000080">(</font>Y<font color="#000080">,</font>M<font color="#000080">,</font>D<font color="#000080">,</font>Week<font color="#000080">);
  </font>Str<font color="#000080">(</font>M<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>t1<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>M <font color="#000080">&lt; </font><font color="#800000">10  </font><font color="#FF0000"><b>Then
    </b></font>t1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
  </font>Str<font color="#000080">(</font>D<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>t2<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>D <font color="#000080">&lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>Then
    </b></font>t2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
  </font>Str<font color="#000080">(</font>Y<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font>t3<font color="#000080">);
  </font>Date <font color="#000080">:= </font>t1<font color="#000080">+</font><font color="#800000">'/'</font><font color="#000080">+</font>t2<font color="#000080">+</font><font color="#800000">'/'</font><font color="#000080">+</font>t3<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}

{+-------------------------------------------------------+}
{: Function :  Month   ( get name of month )             :}
{+-------------------------------------------------------+}
{:    Syntax : Month                                     :}
{:                                                       :}
{:    Action : Obtains date from MSDOS and returns the   :}
{:             ASCII string containing the Name of the   :}
{:             current Month.                            :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Month <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>Y<font color="#000080">,</font>M<font color="#000080">,</font>D<font color="#000080">,</font>Week  <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GetDate<font color="#000080">(</font>Y<font color="#000080">,</font>M<font color="#000080">,</font>D<font color="#000080">,</font>Week<font color="#000080">);
  </font>Month <font color="#000080">:= </font>Months<font color="#000080">[</font>M<font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  WeekDay ( get day of week )               :}
{+-------------------------------------------------------+}
{:    Syntax : WeekDay                                   :}
{:                                                       :}
{:    Action : Obtains date from MSDOS and returns the   :}
{:             ASCII string containing the Name of the   :}
{:             current Day of the Week.                  :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>WeekDay <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>Y<font color="#000080">,</font>M<font color="#000080">,</font>D<font color="#000080">,</font>Week  <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GetDate<font color="#000080">(</font>Y<font color="#000080">,</font>M<font color="#000080">,</font>D<font color="#000080">,</font>Week<font color="#000080">);
  </font>WeekDay <font color="#000080">:= </font>WeekDays<font color="#000080">[</font>Week<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  DayOfWeek  ( Get Day of the Week )        :}
{+-------------------------------------------------------+}
{:    Syntax : DayOfWeek ( &lt;expN1&gt; )                     :}
{:                                                       :}
{:    Action : Uses Day input value to obtain Weekday    :}
{:             ASCII string from constant array.         :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>DayOfWeek<font color="#000080">( </font>Day <font color="#000080">: </font>Integer <font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>DayOfWeek <font color="#000080">:= </font>WeekDays<font color="#000080">[</font>Day<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  DateStr  ( return date string )           :}
{+-------------------------------------------------------+}
{:    Syntax : DateStr                                   :}
{:                                                       :}
{:    Action : Obtains date from MSDOS and returns the   :}
{:             ASCII string containing the Month, the    :}
{:             Day, the Year and the Day-of-Week         :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>DateStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>Y<font color="#000080">,</font>M<font color="#000080">,</font>D<font color="#000080">,</font>Week  <font color="#000080">: </font>Word<font color="#000080">;
   </font>t1<font color="#000080">, </font>t2<font color="#000080">, </font>t3 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GetDate<font color="#000080">(</font>Y<font color="#000080">,</font>M<font color="#000080">,</font>D<font color="#000080">,</font>Week<font color="#000080">);
  </font>Str<font color="#000080">(</font>M<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>t1<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>M <font color="#000080">&lt; </font><font color="#800000">10  </font><font color="#FF0000"><b>Then
    </b></font>t1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
  </font>Str<font color="#000080">(</font>D<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>t2<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>D <font color="#000080">&lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>Then
    </b></font>t2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
  </font>Str<font color="#000080">(</font>Y<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font>t3<font color="#000080">);
  </font>DateStr <font color="#000080">:= </font>Months<font color="#000080">[</font>M<font color="#000080">]+</font><font color="#800000">' '</font><font color="#000080">+</font>t2<font color="#000080">+</font><font color="#800000">', '</font><font color="#000080">+</font>t3<font color="#000080">+</font><font color="#800000">' - '</font><font color="#000080">+</font>WeekDay<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  LEFT                                      :}
{+-------------------------------------------------------+}
{:    Syntax : LEFT ( &lt;expC&gt; , &lt;expN&gt; )                  :}
{:                                                       :}
{:     where : &lt;expC&gt; = character string                 :}
{:             &lt;expN&gt; = number of characters to return   :}
{:                      Integer value                    :}
{:                                                       :}
{:    Action : Returns a specified number of characters  :}
{:             in the character string &lt;expC&gt;, starting  :}
{:             from the leftmost character.              :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Left<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Left <font color="#000080">:= </font>Copy<font color="#000080">(</font>inString<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>numChars<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  RIGHT                                     :}
{+-------------------------------------------------------+}
{:    Syntax : RIGHT ( &lt;expC&gt; , &lt;expN&gt; )                 :}
{:                                                       :}
{:     where : &lt;expC&gt; = character string                 :}
{:             &lt;expN&gt; = number of characters to return   :}
{:                      Integer value                    :}
{:                                                       :}
{:    Action : Returns the rightmost &lt;expN&gt; portion of a :}
{:             character string &lt;expC&gt;                   :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Right<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>index <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>numChars <font color="#000080">&gt;= </font>Length<font color="#000080">(</font>inString<font color="#000080">) </font><font color="#FF0000"><b>Then
    </b></font>Right <font color="#000080">:= </font>inString
  <font color="#FF0000"><b>Else
    Begin
      </b></font>index <font color="#000080">:= </font>Length<font color="#000080">(</font>inString<font color="#000080">) - </font>numChars<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
      </font>Right <font color="#000080">:= </font>Copy<font color="#000080">(</font>inString<font color="#000080">,</font>index<font color="#000080">,</font>numChars<font color="#000080">)
    </font><font color="#FF0000"><b>End
End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  LEN                                       :}
{+-------------------------------------------------------+}
{:    Syntax : LEN ( &lt;expC&gt; )                            :}
{:                                                       :}
{:     where : &lt;expC&gt; = character string                 :}
{:                                                       :}
{:    Action : Returns the dynamic length of character   :}
{:             string &lt;expC&gt;.  Nonprinting characters    :}
{:             and blanks are counted.                   :}
{:                                                       :}
{: Result Type :  Integer                                :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Len<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Len <font color="#000080">:=  </font>Ord<font color="#000080">(</font>inString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  LTRIM                                     :}
{+-------------------------------------------------------+}
{:    Syntax : LTRIM ( &lt;expC1&gt; )                         :}
{:                                                       :}
{:     where : &lt;expC1&gt; = character string                :}
{:                                                       :}
{:    Action : Returns &lt;expC1&gt; with all leading SPACES   :}
{:             (blanks) removed.                         :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>LTrim<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>p <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>p <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>inString<font color="#000080">[</font>p<font color="#000080">] = </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>p <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>inString<font color="#000080">)) </font><font color="#FF0000"><b>Do
    </b></font>inc<font color="#000080">( </font>p <font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>p <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Move<font color="#000080">( </font>inString<font color="#000080">[</font>p<font color="#000080">], </font>inString<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>inString<font color="#000080">)) - </font>p<font color="#000080">);
      </font>dec<font color="#000080">(</font>inString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>pred<font color="#000080">(</font>p<font color="#000080">));
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>LTrim <font color="#000080">:= </font>inString<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  RTRIM                                     :}
{+-------------------------------------------------------+}
{:    Syntax : RTRIM ( &lt;expC1&gt; )                         :}
{:                                                       :}
{:     where : &lt;expC1&gt; = character string                :}
{:                                                       :}
{:    Action : Returns &lt;expC1&gt; with all trailing SPACES  :}
{:             (blanks) removed.                         :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>RTrim<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  While </b></font>inString<font color="#000080">[</font>Length<font color="#000080">(</font>inString<font color="#000080">)] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>Do
    </b></font>dec<font color="#000080">( </font>inString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] );
  </font>RTrim <font color="#000080">:= </font>inString<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  Trim                                      :}
{+-------------------------------------------------------+}
{:    Syntax :  Trim ( &lt;expC1&gt; )                         :}
{:                                                       :}
{:     where : &lt;expC1&gt; = character string                :}
{:                                                       :}
{:    Action : Returns &lt;expC1&gt; with all trailing SPACES  :}
{:             (blanks) removed.                         :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Trim<font color="#000080">( </font>inString <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Trim <font color="#000080">:= </font>RTrim<font color="#000080">( </font>inString <font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  EMPTY                                     :}
{+-------------------------------------------------------+}
{:    Syntax : EMPTY ( &lt;expC1&gt; )                         :}
{:                                                       :}
{:     where : &lt;expC1&gt; = character string                :}
{:                                                       :}
{:    Action : Returns TRUE if &lt;expC1&gt; contains only     :}
{:             SPACES (blanks).                          :}
{:                                                       :}
{: Result Type :  Boolean                                :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Empty<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>index <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>index <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Empty <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>index <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>inString<font color="#000080">))</font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>index <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
    Begin
      If </b></font>inString<font color="#000080">[</font>index<font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>Then
</b></font>	inc<font color="#000080">(</font>index<font color="#000080">)
      </font><font color="#FF0000"><b>Else
</b></font>	<font color="#FF0000"><b>Begin
</b></font>	  Empty <font color="#000080">:= </font>False<font color="#000080">;
</font>	  index <font color="#000080">:= </font><font color="#800000">0
</font>	<font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  SUBSTR                                    :}
{+-------------------------------------------------------+}
{:    Syntax : SUBSTR ( &lt;expC&gt;, &lt;expN1&gt;[, &lt;expN2&gt;] )     :}
{:                                                       :}
{:     where : &lt;expC&gt; = character string                 :}
{:             &lt;expN1&gt;,&lt;expN2&gt; = numeric value (Byte)    :}
{:                                                       :}
{:    Action : Returns a string of length &lt;expN2&gt; from   :}
{:             &lt;expC&gt;, beginning with the &lt;expN1&gt;th      :}
{:             character.  The &lt;expN1&gt; and &lt;expN2&gt; must  :}
{:             be in the range 1 to 255.  If &lt;expN2&gt; is  :}
{:             omitted or if there is fewer than &lt;expN2&gt; :}
{:             characters to the right of the &lt;expN1&gt;th  :}
{:             character, all rightmost characters       :}
{:             beginning with the &lt;expN1&gt;th character are:}
{:             returned.  If &lt;expN1&gt; is greater than the :}
{:             number of characters in &lt;expC&gt;, SUBSTR    :}
{:             returns a null string.                    :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>SubStr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>SubStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>inString<font color="#000080">, </font>numChars<font color="#000080">, </font>StrSize <font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  PUTSTR                                    :}
{+-------------------------------------------------------+}
{:    Syntax : PUTSTR ( &lt;expC1&gt;, &lt;expC2&gt;, &lt;expN1&gt; )      :}
{:                                                       :}
{:     where : &lt;expC1&gt;,&lt;expC2&gt; = character string        :}
{:             &lt;expN1&gt; = numeric value (Byte)            :}
{:                                                       :}
{:    Action : Replaces a portion of one string &lt;expC1&gt;  :}
{:             with another string &lt;expC2&gt;.  The         :}
{:             characters in &lt;expC1&gt; beginning at        :}
{:             position &lt;expN1&gt; are replaced by the      :}
{:             characters in &lt;expC2&gt;.  The number of     :}
{:             characters replaced is equal to the length:}
{:             of string &lt;expC2&gt;.  However, the          :}
{:             replacement of characters never goes      :}
{:             beyond the original length of &lt;expC1&gt;.    :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>PutStr<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>index<font color="#000080">, </font>j <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>index <font color="#000080">:= </font>Ord<font color="#000080">(</font>putString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);    </font><font color="#008000"><i>{ get size of input string}
  </i></font><font color="#FF0000"><b>For </b></font>j <font color="#000080">:= </font>where <font color="#FF0000"><b>to </b></font>where <font color="#000080">+ (</font>index<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>inString<font color="#000080">[</font>j<font color="#000080">] := </font>putString<font color="#000080">[(</font>j<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)-</font>where<font color="#000080">];
  </font>PutStr <font color="#000080">:= </font>inString<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  Stuff                                     :}
{+-------------------------------------------------------+}
{:    Syntax : Stuff  ( &lt;expC1&gt;, &lt;expC2&gt;, &lt;expN1&gt; )      :}
{:                                                       :}
{:     where : &lt;expC1&gt;,&lt;expC2&gt; = character string        :}
{:             &lt;expN1&gt; = numeric value (Byte)            :}
{:                                                       :}
{:    Action : Replaces a portion of one string &lt;expC2&gt;  :}
{:             with another string &lt;expC1&gt;.  The         :}
{:             characters in &lt;expC2&gt; beginning at        :}
{:             position &lt;expN1&gt; are replaced by the      :}
{:             characters in &lt;expC1&gt;.  The number of     :}
{:             characters replaced is equal to the length:}
{:             of string &lt;expC1&gt;.  However, the          :}
{:             replacement of characters never goes      :}
{:             beyond the original length of &lt;expC2&gt;.    :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Stuff<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Insert<font color="#000080">(</font>putString<font color="#000080">, </font>inString<font color="#000080">, </font>where<font color="#000080">);
  </font>Stuff <font color="#000080">:= </font>inString<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  LOWER                                     :}
{+-------------------------------------------------------+}
{:    Syntax : LOWER ( &lt;expC1&gt; )                         :}
{:                                                       :}
{:     where : &lt;expC1&gt; = character string                :}
{:                                                       :}
{:    Action : Returns the specified character           :}
{:             expression &lt;expC1&gt; in lowercase.          :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Lower<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>index <font color="#000080">: </font>Byte<font color="#000080">;  </font>tempString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Const
    </b></font>Upset <font color="#000080">= [</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">];
    </font>LowSet <font color="#000080">= [</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">];
</font><font color="#FF0000"><b>Begin
  For </b></font>index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>inString<font color="#000080">) </font><font color="#FF0000"><b>do
    Begin
      If </b></font>inString<font color="#000080">[</font>index<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>UpSet <font color="#FF0000"><b>Then
</b></font>	tempString<font color="#000080">[</font>index<font color="#000080">] := </font>Chr<font color="#000080">(</font>Ord<font color="#000080">(</font>inString<font color="#000080">[</font>index<font color="#000080">])+</font><font color="#800000">32</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else
</b></font>	TempString<font color="#000080">[</font>index<font color="#000080">] := </font>inString<font color="#000080">[</font>index<font color="#000080">];
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Lower <font color="#000080">:= </font>tempString<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  UPPER                                     :}
{+-------------------------------------------------------+}
{:    Syntax : UPPER ( &lt;expC1&gt; )                         :}
{:                                                       :}
{:     where : &lt;expC1&gt; = character string                :}
{:                                                       :}
{:    Action : Returns the specified character           :}
{:             expression &lt;expC1&gt; in uppercase.          :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Upper<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>index <font color="#000080">: </font>Byte<font color="#000080">;
  </font>tempString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  For </b></font>index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>inString<font color="#000080">) </font><font color="#FF0000"><b>do
     </b></font>tempString<font color="#000080">[</font>index<font color="#000080">] := </font>UpCase<font color="#000080">(</font>inString<font color="#000080">[</font>index<font color="#000080">]);
  </font>tempString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>inString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];
  </font>Upper <font color="#000080">:= </font>tempString<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-----------------------------------------------------------+}
{: Function:    I n s t r  ( Instring )                      :}
{+-----------------------------------------------------------+}
{:   This function extracts a string beginning at pointer    :}
{: From in string Temp_Item for Size chars and returns Value.:}
{+-----------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Instr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Instr <font color="#000080">:= </font>Copy<font color="#000080">(</font>Temp_Item<font color="#000080">, </font>From<font color="#000080">, </font>Size<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  NoTrailZeros                              :}
{+-------------------------------------------------------+}
{:    Syntax : NoTrailZeros ( &lt;expC1&gt; )                  :}
{:                                                       :}
{:     where : &lt;expC1&gt; = character string                :}
{:                                                       :}
{:    Action : Removes trailing Zeros from the specified :}
{:             expression &lt;expC1&gt;.                       :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>NoTrailZeros<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>index <font color="#000080">: </font>Integer<font color="#000080">;
  </font>tempString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  While </b></font>tempStr<font color="#000080">[</font>Length<font color="#000080">(</font>tempStr<font color="#000080">)] = </font><font color="#800000">'0' </font><font color="#FF0000"><b>Do
    </b></font>tempStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Length<font color="#000080">(</font>tempStr<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
  </font>NoTrailZeros <font color="#000080">:= </font>tempStr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  MkStr        ( Make String )              :}
{+-------------------------------------------------------+}
{:    Syntax : MkStr ( &lt;expN1&gt;, &lt;expN2&gt; )                :}
{:                                                       :}
{:     where : &lt;expN1&gt;,&lt;expN2&gt; = numeric values (integer):}
{:                                                       :}
{:    Action : Makes a string of length &lt;expN2&gt; from     :}
{:             Integer expression &lt;expN1&gt;.               :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>MkStr<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>temp1 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Str<font color="#000080">(</font>I<font color="#000080">:</font>W<font color="#000080">,</font>temp1<font color="#000080">);
  </font>MKStr <font color="#000080">:= </font>temp1<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  Spaces                                    :}
{+-------------------------------------------------------+}
{:    Syntax : Spaces ( &lt;expN1&gt; )                        :}
{:                                                       :}
{:     where : &lt;expN1&gt; = numeric value ( Byte )          :}
{:                                                       :}
{:    Action : Makes a string of length &lt;expN1&gt; which    :}
{:             contains Space characters.                :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Spaces<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>zip <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">255</font><font color="#000080">];
</font><font color="#FF0000"><b>Begin
  </b></font>FillChar<font color="#000080">(</font>zip<font color="#000080">,</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
  </font>zip<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>i<font color="#000080">);
  </font>Spaces <font color="#000080">:= </font>Zip<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  LeadZeros                                 :}
{+-------------------------------------------------------+}
{:    Syntax : LeadZeros ( &lt;expC1&gt; )                     :}
{:                                                       :}
{:     where : &lt;expC1&gt; = character string input          :}
{:                                                       :}
{:    Action : replace the leading spaces in a string    :}
{:             with ASCII Zeros.                         :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>LeadZeros<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>inString<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>do
    Begin
      </b></font>inString<font color="#000080">[</font>i<font color="#000080">] := </font>Chr<font color="#000080">(</font><font color="#800000">48</font><font color="#000080">);
      </font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>LeadZeros <font color="#000080">:= </font>inString<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  Str2Bin ( String to Binary )              :}
{+-------------------------------------------------------+}
{:    Syntax : Str2Bin ( &lt;expC1&gt; )                       :}
{:                                                       :}
{:     where : &lt;expC1&gt; = Character string                :}
{:                                                       :}
{:    Action : converts a string containing an ASCII     :}
{:             numeric value to an number.               :}
{:                                                       :}
{: Result Type :  Real                                   :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Str2Bin<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Real<font color="#000080">;
  </font>k <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Val<font color="#000080">(</font>inString<font color="#000080">,</font>i<font color="#000080">,</font>k<font color="#000080">);
  </font>Str2Bin <font color="#000080">:= </font>i<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  IfStr ( If StringB in StringA )           :}
{+-------------------------------------------------------+}
{:    Syntax : IfStr (&lt;expC1&gt;,&lt;expC2&gt;)                   :}
{:                                                       :}
{:     where : &lt;expC1&gt; = Character string                :}
{:             &lt;expC2&gt; = Character string                :}
{:                                                       :}
{:    Action : Determines if &lt;expC2&gt; exists within       :}
{:             &lt;expC1&gt;.                                  :}
{:                                                       :}
{: Result Type :  Integer                                :}
{: Result Values :  0 = char not in stringA              :}
{:                  1-n = position of &lt;expC2&gt; within     :}
{:                        &lt;expC1&gt;                        :}
{:                                                       :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>IfStr<font color="#000080">( </font>Text<font color="#000080">, </font>Pattern  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>IfStr <font color="#000080">:= </font>Pos<font color="#000080">( </font>Pattern<font color="#000080">, </font>Text <font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  Oct   Binary to Octal                     :}
{+-------------------------------------------------------+}
{:    Syntax : Oct ( &lt;expN1&gt; )                           :}
{:                                                       :}
{:     where : &lt;expN1&gt; = Binary number of type Longint   :}
{:                                                       :}
{:    Action : Converts a binary number of type Longint  :}
{:             to a String containing 11 octal Digits.   :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>OCT<font color="#000080">( </font>Value <font color="#000080">: </font>Longint <font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
  </font>j <font color="#000080">: </font>Word<font color="#000080">;
  </font>t1   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>f <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>Value <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Value <font color="#000080">:= </font>Value <font color="#000080">- </font><font color="#800000">$80000000</font><font color="#000080">;
      </font>F <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>End
  Else
    </b></font>F <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">11 </font><font color="#FF0000"><b>DownTo </b></font><font color="#800000">2 </font><font color="#FF0000"><b>Do
    Begin
      </b></font>j <font color="#000080">:= </font>Value <font color="#FF0000"><b>Mod </b></font><font color="#800000">8</font><font color="#000080">;
      </font>Value <font color="#000080">:= </font>Value <font color="#FF0000"><b>Div </b></font><font color="#800000">8</font><font color="#000080">;
      </font>t1<font color="#000080">[</font>i<font color="#000080">] := </font>Chr<font color="#000080">( </font>j<font color="#000080">+</font><font color="#800000">48 </font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>f <font color="#FF0000"><b>Then
    </b></font>Value <font color="#000080">:= </font>Value <font color="#000080">+ </font><font color="#800000">$2</font><font color="#000080">;
  </font>j <font color="#000080">:= </font>Value <font color="#FF0000"><b>Mod </b></font><font color="#800000">8</font><font color="#000080">;
  </font>t1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>Chr<font color="#000080">( </font>j<font color="#000080">+</font><font color="#800000">48 </font><font color="#000080">);
  </font>t1<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">);
  </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Suppress <font color="#FF0000"><b>Then
    While </b></font>t1<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'0' </font><font color="#FF0000"><b>Do
      Begin
        </b></font>t1<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;
        </font>inc<font color="#000080">( </font>i <font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>OCT <font color="#000080">:= </font>LTrim<font color="#000080">( </font>t1 <font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  Hex   Binary to Hex                       :}
{+-------------------------------------------------------+}
{:    Syntax : Hex ( &lt;expN1&gt; )                           :}
{:                                                       :}
{:     where : &lt;expN1&gt; = Binary number of type Longint   :}
{:                                                       :}
{:    Action : Converts a binary number of type Longint  :}
{:             to a String containing 8 Hex Digits.      :}
{:                                                       :}
{: Result Type :  String                                 :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Hex<font color="#000080">( </font>Value <font color="#000080">: </font>Longint <font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>t1 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>i <font color="#000080">: </font>Integer<font color="#000080">;
   </font>j <font color="#000080">: </font>Word<font color="#000080">;
   </font>f <font color="#000080">: </font>Boolean<font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>HexChr<font color="#000080">( </font>HexNibble <font color="#000080">: </font>Byte <font color="#000080">): </font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    If </b></font>HexNibble <font color="#000080">&lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>then
      </b></font>HexChr <font color="#000080">:= </font>Chr<font color="#000080">(</font>HexNibble<font color="#000080">+</font><font color="#800000">48</font><font color="#000080">)
    </font><font color="#FF0000"><b>Else
      </b></font>HexChr <font color="#000080">:= </font>Chr<font color="#000080">(</font>HexNibble<font color="#000080">+</font><font color="#800000">55</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  If </b></font>Value <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Value <font color="#000080">:= </font>Value <font color="#000080">- </font><font color="#800000">$80000000</font><font color="#000080">;
      </font>F <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>End
  Else
    </b></font>F <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">8 </font><font color="#FF0000"><b>DownTo </b></font><font color="#800000">2 </font><font color="#FF0000"><b>Do
    Begin
      </b></font>j <font color="#000080">:= </font>Value <font color="#FF0000"><b>Mod </b></font><font color="#800000">16</font><font color="#000080">;
      </font>Value <font color="#000080">:= </font>Value <font color="#FF0000"><b>Div </b></font><font color="#800000">16</font><font color="#000080">;
      </font>t1<font color="#000080">[</font>i<font color="#000080">] := </font>HexChr<font color="#000080">( </font>j <font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>f <font color="#FF0000"><b>Then
    </b></font>Value <font color="#000080">:= </font>Value <font color="#000080">+ </font><font color="#800000">$8</font><font color="#000080">;
  </font>j <font color="#000080">:= </font>Value <font color="#FF0000"><b>Mod </b></font><font color="#800000">16</font><font color="#000080">;
  </font>t1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>HexChr<font color="#000080">( </font>j <font color="#000080">);
  </font>t1<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">);
  </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Suppress <font color="#FF0000"><b>Then
    While </b></font>t1<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'0' </font><font color="#FF0000"><b>Do
      Begin
        </b></font>t1<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;
        </font>inc<font color="#000080">( </font>i <font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>HEX <font color="#000080">:= </font>LTrim<font color="#000080">( </font>t1 <font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  ASC   Get ASCII code from String          :}
{+-------------------------------------------------------+}
{:    Syntax : ASC ( &lt;expS1&gt; )                           :}
{:                                                       :}
{:     where : &lt;expS1&gt; = ASCII String                    :}
{:                                                       :}
{:    Action : Returns the numeric value of the first    :}
{:             character of the String expression.       :}
{:                                                       :}
{: Result Type :  Byte                                   :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>ASC<font color="#000080">( </font>inString <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">) : </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>Length<font color="#000080">( </font>inString <font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>ASC <font color="#000080">:= </font>Ord<font color="#000080">( </font>inString<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] )
  </font><font color="#FF0000"><b>Else
    </b></font>ASC <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  RAD   Convert from Degrees to Radians     :}
{+-------------------------------------------------------+}
{:    Syntax : RAD ( &lt;expR1&gt; )                           :}
{:                                                       :}
{:     where : &lt;expR1&gt; = Degrees of type Real            :}
{:                                                       :}
{:    Action : Converts a number (REAL) containing       :}
{:             Degrees to one expressed as Radians.      :}
{:                                                       :}
{: Result Type :  Real                                   :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>RAD<font color="#000080">( </font>Degrees <font color="#000080">: </font>Real <font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>RAD <font color="#000080">:= </font>Degrees <font color="#000080">* ( </font>Pi <font color="#000080">/ </font><font color="#800000">180 </font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  DEG   Convert from Radians to Degrees     :}
{+-------------------------------------------------------+}
{:    Syntax : DEG ( &lt;expR1&gt; )                           :}
{:                                                       :}
{:     where : &lt;expR1&gt; = Radians of type Real            :}
{:                                                       :}
{:    Action : Converts a number (REAL) containing       :}
{:             Radians to one expressed as Degrees.      :}
{:                                                       :}
{: Result Type :  Real                                   :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>DEG<font color="#000080">( </font>Radians <font color="#000080">: </font>Real <font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>DEG <font color="#000080">:= </font>Radians <font color="#000080">* ( </font><font color="#800000">180 </font><font color="#000080">/ </font>Pi <font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  LOG   Returns the Log                     :}
{+-------------------------------------------------------+}
{:    Syntax : DEG ( &lt;expR1&gt; )                           :}
{:                                                       :}
{:     where : &lt;expR1&gt; = number to obtain Log of         :}
{:                                                       :}
{:    Action : Returns the natural Logarithm of the      :}
{:             argument.                                 :}
{:                                                       :}
{: Result Type :  Real                                   :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>LOG<font color="#000080">( </font>x <font color="#000080">: </font>Real <font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>LOG <font color="#000080">:= </font>LN<font color="#000080">( </font>x <font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  SGN   Returns the Sign of argument        :}
{+-------------------------------------------------------+}
{:    Syntax : DEG ( &lt;expI1&gt; )                           :}
{:                                                       :}
{:     where : &lt;expI1&gt; = number to obtain Sign of        :}
{:                                                       :}
{:    Action : If &lt;expI1&gt; is positive SGN returns 1      :}
{:             If &lt;expI1&gt; is zero     SGN returns 0      :}
{:             If &lt;expI1&gt; is negative SGN returns -1     :}
{:                                                       :}
{: Result Type :  Integer                                :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>SGN<font color="#000080">( </font>x <font color="#000080">: </font>Integer <font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>x <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>SGN <font color="#000080">:= </font><font color="#800000">0
  </font><font color="#FF0000"><b>Else
    If </b></font>x <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
      </b></font>SGN <font color="#000080">:= -</font><font color="#800000">1
    </font><font color="#FF0000"><b>Else
      </b></font>SGN <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{:Procedure :  DEFSEG  (assign current segment register) :}
{+-------------------------------------------------------+}
{:    Syntax : DEFSEG ( &lt;expI1&gt; )                        :}
{:                                                       :}
{:     where : &lt;expI1&gt; = Integer value of Segment Reg    :}
{:                       Segment = Global Variable       :}
{:    Action : Assigns &lt;expI1&gt; to the Segment Register   :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Procedure </b></font>DefSeg<font color="#000080">( </font>SegValue <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>Segment <font color="#000080">:= </font>SegValue<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  Peek  Get contents of memory address      :}
{+-------------------------------------------------------+}
{:    Syntax : Peek ( &lt;expW1&gt; )                          :}
{:                                                       :}
{:     where : &lt;expW1&gt; = Offset of memory address of     :}
{:                       type Word                       :}
{:                                                       :}
{:    Action : Gets contents of memory address as        :}
{:             Segment:Offset.                           :}
{:                                                       :}
{: Result Type :  Byte                                   :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>Peek<font color="#000080">( </font>Offset <font color="#000080">: </font>Word <font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Peek <font color="#000080">:= </font>Mem<font color="#000080">[</font>Segment<font color="#000080">:</font>Offset<font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  PeekW  Get contents of memory address     :}
{+-------------------------------------------------------+}
{:    Syntax : PeekW  ( &lt;expW1&gt; )                        :}
{:                                                       :}
{:     where : &lt;expW1&gt; = Offset of memory address of     :}
{:                       type Word                       :}
{:                                                       :}
{:    Action : Gets contents of memory address as        :}
{:             Segment:Offset.                           :}
{:                                                       :}
{: Result Type :  Word                                   :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>PeekW<font color="#000080">( </font>Offset <font color="#000080">: </font>Word <font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>PeekW <font color="#000080">:= </font>MemW<font color="#000080">[</font>Segment<font color="#000080">:</font>Offset<font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
{+-------------------------------------------------------+}
{: Function :  PeekL  Get contents of memory address     :}
{+-------------------------------------------------------+}
{:    Syntax : PeekL ( &lt;expW1&gt; )                         :}
{:                                                       :}
{:     where : &lt;expW1&gt; = Offset of memory address of     :}
{:                       type Word                       :}
{:                                                       :}
{:    Action : Gets contents of memory address as        :}
{:             Segment:Offset.                           :}
{:                                                       :}
{: Result Type :  Longint                                :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>PeekL<font color="#000080">( </font>Offset <font color="#000080">: </font>Word <font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>PeekL <font color="#000080">:= </font>MemL<font color="#000080">[</font>Segment<font color="#000080">:</font>Offset<font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Procedure : Poke  Put contents of memory address      :}
{+-------------------------------------------------------+}
{:    Syntax : Poke ( &lt;expW1&gt;, &lt;expB1&gt; )                 :}
{:                                                       :}
{:     where : &lt;expW1&gt; = Offset of memory address of     :}
{:                       type Word                       :}
{:                                                       :}
{:             &lt;expB1&gt; = Byte of data to poke            :}
{:                                                       :}
{:    Action : Pokes contents of memory address.         :}
{:                                                       :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Procedure </b></font>Poke<font color="#000080">( </font>Offset<font color="#000080">: </font>Word<font color="#000080">; </font>Value <font color="#000080">: </font>Byte <font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>Mem<font color="#000080">[</font>Segment<font color="#000080">:</font>Offset<font color="#000080">] := </font>Value<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{+-------------------------------------------------------+}
{: Function :  TAN   Computes Tangent of Angle           :}
{+-------------------------------------------------------+}
{:    Syntax : TAN ( &lt;expR1&gt; )                           :}
{:                                                       :}
{:     where : &lt;expR1&gt; = number to obtain TAN of         :}
{:                                                       :}
{:    Action : Returns the Tangent of angle in radians   :}
{:                                                       :}
{: Result Type :  Real                                   :}
{+-------------------------------------------------------+}
</i></font><font color="#FF0000"><b>Function </b></font>TAN<font color="#000080">( </font>x <font color="#000080">: </font>Real <font color="#000080">) : </font>Real<font color="#000080">;  </font><font color="#008000"><i>{ input must be in radians }
</i></font><font color="#FF0000"><b>Begin
  </b></font>TAN <font color="#000080">:= </font>Sin<font color="#000080">(</font>x<font color="#000080">)*(</font><font color="#800000">1</font><font color="#000080">/</font>Cos<font color="#000080">(</font>x<font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{.pa}
</i></font><font color="#FF0000"><b>Function </b></font>Input<font color="#000080">( </font>prompt <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>t1 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Write<font color="#000080">(</font>prompt<font color="#000080">);
  </font>ReadLn<font color="#000080">(</font>t1<font color="#000080">);
  </font>Input <font color="#000080">:= </font>t1<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>InputS<font color="#000080">( </font>prompt <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>t1 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Write<font color="#000080">(</font>prompt<font color="#000080">);
  </font>ReadLn<font color="#000080">(</font>t1<font color="#000080">);
  </font>InputS <font color="#000080">:= </font>t1<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>InputI<font color="#000080">( </font>prompt <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>t1 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Write<font color="#000080">(</font>Prompt<font color="#000080">);
  </font>ReadLn<font color="#000080">(</font>t1<font color="#000080">);
  </font>InputI <font color="#000080">:= </font>Trunc<font color="#000080">( </font>Str2Bin<font color="#000080">( </font>t1 <font color="#000080">) );
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>InputR<font color="#000080">( </font>prompt <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>t1 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Write<font color="#000080">(</font>Prompt<font color="#000080">);
  </font>ReadLn<font color="#000080">(</font>t1<font color="#000080">);
  </font>InputR <font color="#000080">:= </font>Str2Bin<font color="#000080">( </font>t1 <font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PrintAT<font color="#000080">(</font>Row<font color="#000080">, </font>Col <font color="#000080">: </font>word<font color="#000080">; </font>Tex <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>GotoXY<font color="#000080">(</font>Row<font color="#000080">,</font>col<font color="#000080">);
  </font>Write<font color="#000080">(</font>Tex<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Print<font color="#000080">(</font>Tex <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>WriteLn<font color="#000080">(</font>Tex<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{.pa}
</i></font><font color="#FF0000"><b>Procedure </b></font>CursorOn<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Rg <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Rg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Rg<font color="#000080">.</font>CH <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Rg<font color="#000080">.</font>CL <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Rg<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CursorOff<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Rg <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Rg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Rg<font color="#000080">.</font>CH <font color="#000080">:= </font><font color="#800000">$20</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Rg<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Segment <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>GMT <font color="#000080">:= </font>False<font color="#000080">;
  </font>Suppress <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0113.PAS">Original</a><b>]</b></p></body>
</html>
