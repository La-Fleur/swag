<html>
<head><title> "String Conversions" by GREG ESTABROOKS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0070.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{***********************************************************************}
</i></font><font color="#FF0000"><b>UNIT </b></font>Strings<font color="#000080">;           </font><font color="#008000"><i>{  String Conversion Routines,                  }
                        {  Last Updated Dec 07/93                       }
                        {  Copyright (C) 1993, Greg Estabrooks          }
                        {  NOTE: Requires TP 6.0+ to compile.           }
</i></font><font color="#FF0000"><b>INTERFACE
</b></font><font color="#008000"><i>(************************************************************************)
</i></font><font color="#FF0000"><b>CONST
     </b></font>HexList <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR <font color="#000080">=</font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>BHex<font color="#000080">( </font>V <font color="#000080">:</font>BYTE <font color="#000080">) :</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WHex<font color="#000080">( </font>V <font color="#000080">:</font>WORD <font color="#000080">) :</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>LHex<font color="#000080">( </font>Long <font color="#000080">:</font>LONGINT <font color="#000080">) :</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>UpperCase<font color="#000080">( </font><font color="#FF0000"><b>VAR </b></font>UpStr <font color="#000080">:</font><font color="#FF0000"><b>STRING </b></font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>LowerCase<font color="#000080">( </font><font color="#FF0000"><b>VAR </b></font>LoStr <font color="#000080">:</font><font color="#FF0000"><b>STRING </b></font><font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION
</b></font><font color="#008000"><i>(************************************************************************)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>HiWord<font color="#000080">( </font>Long <font color="#000080">:</font>LONGINT <font color="#000080">) :</font>WORD<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                      </font><font color="#008000"><i>{ Routine to return high word of a LongInt.       }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Mov AX,Long.WORD[2]              </font><font color="#008000"><i>{ Move High word into AX.            }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LoWord<font color="#000080">( </font>Long <font color="#000080">:</font>LONGINT <font color="#000080">) :</font>WORD<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                      </font><font color="#008000"><i>{ Routine to return low word of a LongInt.        }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Mov AX,Long.WORD[0]              </font><font color="#008000"><i>{ Move low word into AX.             }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>BHex<font color="#000080">( </font>V <font color="#000080">:</font>BYTE <font color="#000080">) :</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                       </font><font color="#008000"><i>{ Routine to convert a byte to a Hex string.     }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>BHex <font color="#000080">:= </font>HexList<font color="#000080">[</font>V <font color="#FF0000"><b>Shr </b></font><font color="#800000">4</font><font color="#000080">] + </font>HexList<font color="#000080">[</font>V <font color="#FF0000"><b>Mod </b></font><font color="#800000">16</font><font color="#000080">];
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>WHex<font color="#000080">( </font>V <font color="#000080">:</font>WORD <font color="#000080">) :</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                       </font><font color="#008000"><i>{ Routine to convert a word to a Hex string.     }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>WHex <font color="#000080">:= </font>Bhex<font color="#000080">(</font>Hi<font color="#000080">(</font>V<font color="#000080">)) + </font>BHex<font color="#000080">(</font>Lo<font color="#000080">(</font>V<font color="#000080">));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LHex<font color="#000080">( </font>Long <font color="#000080">:</font>LONGINT <font color="#000080">) :</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                       </font><font color="#008000"><i>{ Routine to convert a longint to a Hex string.  }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>LHex <font color="#000080">:= </font>WHex<font color="#000080">(</font>HiWord<font color="#000080">(</font>Long<font color="#000080">))+</font>WHex<font color="#000080">(</font>LoWord<font color="#000080">(</font>Long<font color="#000080">));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>UpperCase<font color="#000080">( </font><font color="#FF0000"><b>VAR </b></font>UpStr <font color="#000080">:</font><font color="#FF0000"><b>STRING </b></font><font color="#000080">); </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                     </font><font color="#008000"><i>{  Routine to convert string to uppercase          }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Push ES                       </font><font color="#008000"><i>{  Save Registers to be used            }
  </i></font><font color="#FF00FF">Push DI
  Push CX
  LES DI,UpStr                  </font><font color="#008000"><i>{  Point ES:DI to string to be converted}
  </i></font><font color="#FF00FF">Sub CX,CX                     </font><font color="#008000"><i>{  Clear CX                             }
  </i></font><font color="#FF00FF">Mov CL,ES:[DI]                </font><font color="#008000"><i>{  Load Length of string for looping    }
  </i></font><font color="#FF00FF">Cmp CX,0                      </font><font color="#008000"><i>{  Check for a clear string             }
  </i></font><font color="#FF00FF">JE @Exit                      </font><font color="#008000"><i>{  If it was then exit                  }
</i></font><font color="#FF00FF">@ReadStr:
  Inc DI                        </font><font color="#008000"><i>{  Point to next Character              }
  </i></font><font color="#FF00FF">Cmp BYTE PTR ES:[DI],'z'      </font><font color="#008000"><i>{  If Character above 'z' jump to end of}
  </i></font><font color="#FF00FF">Ja @LoopEnd                   </font><font color="#008000"><i>{  loop.                                }
  </i></font><font color="#FF00FF">Cmp BYTE PTR ES:[DI],'a'      </font><font color="#008000"><i>{  if below 'a' jump to end of loop.    }
  </i></font><font color="#FF00FF">Jb @LoopEnd
  Sub BYTE PTR ES:[DI],32       </font><font color="#008000"><i>{  If not make it upper case            }
</i></font><font color="#FF00FF">@LoopEnd:
  Loop @ReadStr                 </font><font color="#008000"><i>{  Loop Until done                      }
</i></font><font color="#FF00FF">@Exit:
  Pop CX                        </font><font color="#008000"><i>{  Restore registers                    }
  </i></font><font color="#FF00FF">Pop DI
  Pop ES
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{UpperCase}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>LowerCase<font color="#000080">( </font><font color="#FF0000"><b>VAR </b></font>LoStr <font color="#000080">:</font><font color="#FF0000"><b>STRING </b></font><font color="#000080">); </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                     </font><font color="#008000"><i>{  Routine to convert a string to lower case       }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Push ES                       </font><font color="#008000"><i>{  Save Registers to be used            }
  </i></font><font color="#FF00FF">Push DI
  Push CX
  LES DI,LoStr                  </font><font color="#008000"><i>{  Point ES:DI to string to be converted}
  </i></font><font color="#FF00FF">Sub CX,CX                     </font><font color="#008000"><i>{  Clear CX                             }
  </i></font><font color="#FF00FF">Mov CL,ES:[DI]                </font><font color="#008000"><i>{  Load Length of string for looping    }
  </i></font><font color="#FF00FF">Cmp CX,0                      </font><font color="#008000"><i>{  Check for a clear string             }
  </i></font><font color="#FF00FF">JE @Exit                      </font><font color="#008000"><i>{  If it was then exit                  }
</i></font><font color="#FF00FF">@ReadStr:
  Inc DI                        </font><font color="#008000"><i>{  Point to next Character              }
  </i></font><font color="#FF00FF">Cmp BYTE PTR ES:[DI],'Z'      </font><font color="#008000"><i>{  If Character above 'Z' jump to end of}
  </i></font><font color="#FF00FF">Ja @LoopEnd                   </font><font color="#008000"><i>{  loop.                                }
  </i></font><font color="#FF00FF">Cmp BYTE PTR ES:[DI],'A'      </font><font color="#008000"><i>{  if below 'A' jump to end of loop.    }
  </i></font><font color="#FF00FF">Jb @LoopEnd
  Add BYTE PTR ES:[DI],32       </font><font color="#008000"><i>{  If not make it Lower case            }
</i></font><font color="#FF00FF">@LoopEnd:
  Loop @ReadStr                 </font><font color="#008000"><i>{  Loop Until done                      }
</i></font><font color="#FF00FF">@Exit:
  Pop CX                        </font><font color="#008000"><i>{  Restore registers                    }
  </i></font><font color="#FF00FF">Pop DI
  Pop ES
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{LowerCase}

</i></font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.
</font><font color="#008000"><i>{***********************************************************************}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0070.PAS">Original</a><b>]</b></p></body>
</html>
