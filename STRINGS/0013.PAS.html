<html>
<head><title> "STR-INFO.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Functions returning Strings are generally space wasters.  For example,
suppose you have :

Function UpCaseStr(s : String) : String;

if you're implementing it in plain Pascal, you'll need 1024 Bytes of data
at a minimum:
- 256 Bytes are allocated For &quot;s&quot;, the Formal parameter
- 256 Bytes For a local copy of &quot;s&quot; since it was passed as a value parameter
- 256 Bytes For a local Variable of the Type String, working storage to build
      the Function result
- 256 Bytes For assigning the result to the Function result
      (as in: &quot;UpCaseStr := Result&quot;).

You can cut this figure by 50% by taking the following steps:
- (Version 7) Change the parameter header into
  &quot;Function UpCaseStr(Const s : String) : String&quot;.  Provided you don't
  change &quot;s&quot;, no local copy of the String will be created.
- (Version 6) Implement the routine in Assembler.  Requires knowledge of
  Asm, of course - but it generally will do away With the need of allocating
  256 Bytes of working storage.

Now you have reduced data space to 512 Bytes: it has become a basic
input-output Function.  One question remains: it is necessary to load the
String to examine the result of such a Function.  Suppose we want to figure out
whether the user has entered a switch on the command line: do we need a
Variable of the Type String to acComplish this?  You don't.  The following
snippet of code will show how: using a 2 Bytes macro, we'll convert a String
into a Pointer to a String.  You only have to dereference the Pointer to get
the result - and save 256 Bytes of data space in the process.
}

</i></font><font color="#FF0000"><b>Type
  </b></font>PString      <font color="#000080">= ^</font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StrPtr<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>PString<font color="#000080">;

</font><font color="#FF0000"><b>InLine</b></font><font color="#000080">(
  </font><font color="#800000">$58</font><font color="#000080">/         </font><font color="#008000"><i>{ POP  AX }
  </i></font><font color="#800000">$5A</font><font color="#000080">);        </font><font color="#008000"><i>{ POP  DX }

</i></font><font color="#FF0000"><b>Var
  </b></font>i            <font color="#000080">: </font>Integer<font color="#000080">;
  </font>sp           <font color="#000080">: </font>PString<font color="#000080">;
  </font>QuietFlag    <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ParamCount <font color="#FF0000"><b>Do
    begin
      </b></font>sp <font color="#000080">:= </font>StrPtr<font color="#000080">(</font>ParamStr<font color="#000080">(</font>i<font color="#000080">));
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>sp<font color="#000080">^[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'/'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>UpCase<font color="#000080">(</font>sp<font color="#000080">^[</font><font color="#800000">2</font><font color="#000080">]) = </font><font color="#800000">'Q'</font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>QuietFlag <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#008000"><i>{ Et cetera }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p></body>
</html>
