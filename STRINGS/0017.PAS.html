<html>
<head><title> "WILDCRD2.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Does anyone know how to pass a wildcard Filename to a parameter String and
&gt; have the code grab the actual full Filename?

not quite, but close.  Consider the Function Wild below.  if you should do a
findfirst/findnext and run the Function wild on each found name you get what
you want.
}

</i></font><font color="#FF0000"><b>Function </b></font>Wild<font color="#000080">(</font>FileName<font color="#000080">, </font>Card <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{Returns True if the wildcard description in 'card' matches 'flname'
according to Dos wildcard principles.  The 'card' String MUST have a period!
Example: Wild('test.tat','t*.t?t' returns True}
</i></font><font color="#FF0000"><b>Var
 </b></font>c        <font color="#000080">: </font>Char<font color="#000080">;
 </font>p<font color="#000080">,</font>i<font color="#000080">,</font>n<font color="#000080">,</font>l  <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Wild <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#008000"><i>{test For special Case first}
  </i></font><font color="#FF0000"><b>if </b></font>Card <font color="#000080">= </font><font color="#800000">'*.*' </font><font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;
  </font>Wild <font color="#000080">:= </font>False<font color="#000080">;
  </font>p <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>Card<font color="#000080">);
  </font>i <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>FileName<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>p <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Invalid use of Function &quot;wild&quot;.  Program halted.'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Wild card must contain a period.'</font><font color="#000080">);
    </font>Halt<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{test the situation beFore the period}
  </i></font>n <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>c <font color="#000080">:= </font>UpCase<font color="#000080">(</font>Card<font color="#000080">[</font>n<font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font>c <font color="#000080">= </font><font color="#800000">'*' </font><font color="#FF0000"><b>then
      </b></font>n <font color="#000080">:= </font>p
    <font color="#FF0000"><b>else
    if </b></font><font color="#000080">(</font>upCase<font color="#000080">(</font>FileName<font color="#000080">[</font>n<font color="#000080">]) = </font>c<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>c <font color="#000080">= </font><font color="#800000">'?'</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>inc<font color="#000080">(</font>n<font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>n <font color="#000080">&gt;= </font>p<font color="#000080">;

  </font><font color="#008000"><i>{Now check after the period}
  </i></font>n <font color="#000080">:= </font>p <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{one position past the period of the wild card}
  </i></font>l <font color="#000080">:= </font>Length<font color="#000080">(</font>FileName<font color="#000080">);
  </font>Inc<font color="#000080">(</font>i<font color="#000080">); </font><font color="#008000"><i>{one position past the period of the Filename}
  </i></font><font color="#FF0000"><b>Repeat
    if </b></font>n <font color="#000080">&gt; </font>Length<font color="#000080">(</font>Card<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>Exit<font color="#000080">;
    </font>c <font color="#000080">:= </font>UpCase<font color="#000080">(</font>Card<font color="#000080">[</font>n<font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font>c <font color="#000080">= </font><font color="#800000">'*' </font><font color="#FF0000"><b>then
      </b></font>i <font color="#000080">:= </font>l <font color="#000080">+ </font><font color="#800000">1 </font><font color="#008000"><i>{in order to end the loop}
    </i></font><font color="#FF0000"><b>else
    if </b></font><font color="#000080">(</font>UpCase<font color="#000080">(</font>FileName<font color="#000080">[</font>i<font color="#000080">]) = </font>c<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>c <font color="#000080">= </font><font color="#800000">'?'</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>Inc<font color="#000080">(</font>n<font color="#000080">);
      </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end
    else
      </b></font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>i <font color="#000080">&gt; </font>l<font color="#000080">;

  </font>Wild <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p></body>
</html>
