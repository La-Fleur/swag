<html>
<head><title> "Format Number Strings" by GAYLE DAVIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Uses </b></font>DOS<font color="#000080">, </font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>VAR </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>CommaString <font color="#000080">(</font>number <font color="#000080">: </font>longint<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>TempStr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>OrgLen <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Str <font color="#000080">(</font>number<font color="#000080">, </font>tempstr<font color="#000080">);
    </font>OrgLen <font color="#000080">:= </font>Length <font color="#000080">(</font>tempstr<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>OrgLen <font color="#000080">&gt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then
      begin
        if </b></font>OrgLen <font color="#000080">&lt; </font><font color="#800000">7 </font><font color="#FF0000"><b>then
          </b></font>Insert <font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>tempstr<font color="#000080">, </font>Length <font color="#000080">(</font>tempstr<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>OrgLen <font color="#000080">&gt;= </font><font color="#800000">7 </font><font color="#FF0000"><b>then
          begin
            </b></font>Insert <font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>tempstr<font color="#000080">, </font>length <font color="#000080">(</font>tempstr<font color="#000080">) - </font><font color="#800000">5</font><font color="#000080">);
            </font>Insert <font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>tempstr<font color="#000080">, </font>length <font color="#000080">(</font>tempstr<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>CommaString <font color="#000080">:= </font>tempstr<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>FmtStr <font color="#000080">(</font>STR<font color="#000080">, </font>Fmt <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
</b></font>TempStr <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font>I<font color="#000080">, </font>J <font color="#000080">: </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
</b></font>TempStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>POS <font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>Fmt<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    BEGIN
    </b></font>FmtStr <font color="#000080">:= </font>STR<font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>LENGTH <font color="#000080">(</font>STR<font color="#000080">) &lt;= </font><font color="#800000">3 </font><font color="#FF0000"><b>THEN </b></font>EXIT<font color="#000080">;
    </font>J <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font>LENGTH <font color="#000080">(</font>STR<font color="#000080">) </font><font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">1 </font><font color="#FF0000"><b>DO
        BEGIN
        </b></font>TempStr <font color="#000080">:= </font>STR <font color="#000080">[</font>i<font color="#000080">] + </font>TempStr<font color="#000080">;
        </font>INC <font color="#000080">(</font>j<font color="#000080">);
        </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>J <font color="#FF0000"><b>MOD </b></font><font color="#800000">3 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>TempStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>TempStr <font color="#000080">:= </font><font color="#800000">',' </font><font color="#000080">+ </font>TempStr<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>WHILE </b></font>TempStr <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">',' </font><font color="#FF0000"><b>DO
          </b></font>TempStr <font color="#000080">:= </font>COPY <font color="#000080">(</font>TempStr<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font>LENGTH <font color="#000080">(</font>TempStr<font color="#000080">) );
    </font><font color="#FF0000"><b>END ELSE
        BEGIN
        </b></font>J <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH <font color="#000080">(</font>Fmt<font color="#000080">) </font><font color="#FF0000"><b>DO
        BEGIN
            IF NOT </b></font><font color="#000080">(</font>Fmt <font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'#'</font><font color="#000080">, </font><font color="#800000">'!'</font><font color="#000080">, </font><font color="#800000">'@'</font><font color="#000080">, </font><font color="#800000">'*'</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN
            BEGIN
                </b></font>TempStr <font color="#000080">[</font>I<font color="#000080">] := </font>Fmt <font color="#000080">[</font>I<font color="#000080">] ;  </font><font color="#008000"><i>{force any none format charcters into string}
                 </i></font>J <font color="#000080">:= </font>SUCC <font color="#000080">(</font>J<font color="#000080">);
            </font><font color="#FF0000"><b>END
            ELSE    </b></font><font color="#008000"><i>{format character}
            </i></font><font color="#FF0000"><b>BEGIN
                IF </b></font>I <font color="#000080">- </font>J <font color="#000080">&lt;= </font>LENGTH <font color="#000080">(</font>STR<font color="#000080">) </font><font color="#FF0000"><b>THEN
                   </b></font>TempStr <font color="#000080">[</font>I<font color="#000080">] := </font>STR <font color="#000080">[</font>I <font color="#000080">- </font>J<font color="#000080">]
                </font><font color="#FF0000"><b>ELSE
                   </b></font>TempStr <font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;    </font><font color="#008000"><i>{pad with underlines}
            </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

        </font>TempStr <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>CHAR <font color="#000080">(</font>LENGTH <font color="#000080">(</font>Fmt<font color="#000080">) );  </font><font color="#008000"><i>{set initial byte to string length}
        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font>FmtStr <font color="#000080">:= </font>Tempstr<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{Func FmtStr}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>FmtReal<font color="#000080">(</font>Num <font color="#000080">: </font>REAL<font color="#000080">; </font>FMT <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>Tmp <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>STR <font color="#000080">(</font>Num <font color="#000080">: </font><font color="#800000">12 </font><font color="#000080">: </font><font color="#800000">2</font><font color="#000080">, </font>Tmp<font color="#000080">);
  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>Tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">])) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Tmp <font color="#000080">&gt; </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>DO </b></font>DELETE<font color="#000080">(</font>Tmp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>FmtReal <font color="#000080">:= </font>FmtStr<font color="#000080">(</font>Tmp<font color="#000080">, </font>FMT<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(*

Hi boys,

These routines are fairly simple to understand and should work for you in
in just about any situation.  I've used them for years, and I've found
them to be the answer to all my needs.

If you need more help with these, just call !!

Gayle
*)



</i></font><font color="#FF0000"><b>BEGIN
</b></font>ClrScr<font color="#000080">;
</font>WriteLn<font color="#000080">(</font>CommaString<font color="#000080">(</font><font color="#800000">123456789</font><font color="#000080">));   </font><font color="#008000"><i>{ Format any type of INTEGER }
</i></font>WriteLn<font color="#000080">(</font>FmtReal<font color="#000080">(</font><font color="#800000">1234567.89</font><font color="#000080">,</font><font color="#800000">'##,###,###,###.##'</font><font color="#000080">));  </font><font color="#008000"><i>{ Format Type REAL with decimals }
</i></font>WriteLn<font color="#000080">(</font>FmtStr<font color="#000080">(</font><font color="#800000">'2198758811'</font><font color="#000080">,</font><font color="#800000">'(###) ###-####'</font><font color="#000080">)); </font><font color="#008000"><i>{ Format a Phone number }
</i></font>WriteLn<font color="#000080">(</font>FmtStr<font color="#000080">(</font><font color="#800000">'062593'</font><font color="#000080">,</font><font color="#800000">'##/##/##'</font><font color="#000080">)); </font><font color="#008000"><i>{ Format a date number }
</i></font>Readkey<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p></body>
</html>
