<html>
<head><title> "String Input/Output" by BOJAN LANDEKIC</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0118.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ *** Handles string in/output and various conversion routines
  ***
}

</i></font><font color="#FF0000"><b>Unit </b></font>StrIO<font color="#000080">;



</font><font color="#FF0000"><b>INTERFACE

Uses </b></font>Vars<font color="#000080">;

     </font><font color="#FF0000"><b>FUNCTION </b></font>StatusBar<font color="#000080">(</font>total<font color="#000080">, </font>amt<font color="#000080">, </font>barlength<font color="#000080">: </font>longint<font color="#000080">): </font>St80<font color="#000080">;
     </font><font color="#008000"><i>{FUNCTION StatusBar(total, amt : longint): St80;}
     </i></font><font color="#FF0000"><b>FUNCTION </b></font>ITOA<font color="#000080">(</font>i<font color="#000080">: </font>longint<font color="#000080">): </font>St40<font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>ATOI<font color="#000080">(</font>s<font color="#000080">: </font>St40<font color="#000080">): </font>LongInt<font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>UpCase<font color="#000080">(</font>c<font color="#000080">: </font>Char<font color="#000080">): </font>Char<font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>UCase<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>RepStr<font color="#000080">(</font>Times<font color="#000080">: </font>Byte<font color="#000080">; </font>Which<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Strip_Path<font color="#000080">(</font>Fullfilename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Leading_Zero<font color="#000080">(</font>Number<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Digits<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Read_Str<font color="#000080">(</font>StrLen     <font color="#000080">: </font>Byte<font color="#000080">;
                       </font>InputFg<font color="#000080">,
                       </font>InputBg    <font color="#000080">: </font>Integer<font color="#000080">;
                       </font>Hidden<font color="#000080">,
                       </font>Spaces     <font color="#000080">: </font>Char<font color="#000080">;
                       </font>SpinWanted<font color="#000080">,
                       </font>Display<font color="#000080">,
                       </font>Upper<font color="#000080">,
                       </font>OnlyNumbers<font color="#000080">,
                       </font>AutoReturn <font color="#000080">: </font>Boolean<font color="#000080">;
                       </font><font color="#FF0000"><b>Default    </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>PROCEDURE </b></font>Flush_Keyboard_Buffer<font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Right_Pad<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>MaxLength<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Right_Strip<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Right_Justify<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>sl<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>CommaNum <font color="#000080">(</font>I <font color="#000080">: </font>LongInt<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Strip_Filename<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;


</font><font color="#FF0000"><b>CONST
     </b></font>Str_Yes  <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">'Yes'</font><font color="#000080">;
     </font>Str_No   <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">'No'</font><font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>CharStr<font color="#000080">(</font>HowMuch<font color="#000080">: </font>Byte<font color="#000080">; </font>WithWhatChar<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{
 *** fills charStr with withwhatchar to the howmuch
 ***
}
         </i></font><font color="#FF0000"><b>Var
            </b></font>j       <font color="#000080">: </font>Integer<font color="#000080">;
            </font>TempStr <font color="#000080">: </font>St80<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>TempStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>HowMuch <font color="#FF0000"><b>Do
                  </b></font>Insert<font color="#000080">(</font>WithWhatChar<font color="#000080">, </font>TempStr<font color="#000080">, </font>J<font color="#000080">);
              </font>CharStr <font color="#000080">:= </font>TempStr<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;




</font><font color="#FF0000"><b>FUNCTION </b></font>StatusBar<font color="#000080">(</font>total<font color="#000080">, </font>amt<font color="#000080">, </font>barlength<font color="#000080">: </font>longint<font color="#000080">): </font>St80<font color="#000080">;
</font><font color="#008000"><i>{         Const
              BarLength = 30;}

         </i></font><font color="#FF0000"><b>Var
            </b></font>a<font color="#000080">,
            </font>b<font color="#000080">,
            </font>c<font color="#000080">,
            </font>d       <font color="#000080">: </font>longint<font color="#000080">;
            </font>sD      <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{for conversion}
            </i></font>percent <font color="#000080">: </font>real<font color="#000080">;
            </font>st      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              If </b></font><font color="#000080">(</font>total <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>amt <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                 Begin
                      </b></font>StatusBar <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                      </font>Exit<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Amt <font color="#000080">&gt; </font>Total<font color="#000080">) </font><font color="#FF0000"><b>Then
                 </b></font>amt <font color="#000080">:= </font>total<font color="#000080">;
              </font>Percent <font color="#000080">:= </font>Amt <font color="#000080">/ </font>Total <font color="#000080">* (</font>Barlength <font color="#000080">* </font><font color="#800000">10</font><font color="#000080">);
              </font>a <font color="#000080">:= </font>trunc<font color="#000080">(</font>percent<font color="#000080">);
              </font>b <font color="#000080">:= </font>a <font color="#FF0000"><b>div </b></font><font color="#800000">10</font><font color="#000080">;
              </font>c <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
              </font>percent <font color="#000080">:= </font>amt <font color="#000080">/ </font>total <font color="#000080">* </font><font color="#800000">100</font><font color="#000080">;
              </font>d <font color="#000080">:= </font>trunc<font color="#000080">(</font>percent<font color="#000080">);
              </font>Str<font color="#000080">(</font>d<font color="#000080">, </font>sD<font color="#000080">);
              </font>st <font color="#000080">:= </font><font color="#800000">' (' </font><font color="#000080">+ </font>sD <font color="#000080">+ </font><font color="#800000">'%)'</font><font color="#000080">;
              </font>StatusBar <font color="#000080">:= </font>CharStr<font color="#000080">(</font>b <font color="#000080">* </font>c<font color="#000080">, </font><font color="#800000">#219</font><font color="#000080">) + </font>CharStr<font color="#000080">(</font>Barlength <font color="#000080">- (</font>b <font color="#000080">* </font>c<font color="#000080">), </font><font color="#800000">#176</font><font color="#000080">) + </font>st<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;




</font><font color="#FF0000"><b>FUNCTION </b></font>ITOA<font color="#000080">(</font>i<font color="#000080">: </font>longint<font color="#000080">): </font>St40<font color="#000080">;
</font><font color="#008000"><i>{
 *** Converts integers into alphanumericals or strings
 ***
}
         </i></font><font color="#FF0000"><b>Var
            </b></font>stTemp<font color="#000080">: </font>St20<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>Str<font color="#000080">(</font>i<font color="#000080">, </font>stTemp<font color="#000080">);
              </font>ITOA <font color="#000080">:= </font>stTemp<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>ATOI<font color="#000080">(</font>s<font color="#000080">: </font>St40<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#008000"><i>{
 *** Converts a string into a integer/real
 ***
}
         </i></font><font color="#FF0000"><b>Var
            </b></font>Code<font color="#000080">: </font>Integer<font color="#000080">;
            </font>lTemp<font color="#000080">: </font>LongInt<font color="#000080">;
            </font>rTemp<font color="#000080">: </font>Real<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>Val<font color="#000080">(</font>s<font color="#000080">, </font>rTemp<font color="#000080">, </font>Code<font color="#000080">);
              </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Code <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                 </b></font>rTemp <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>lTemp <font color="#000080">:= </font>Trunc<font color="#000080">(</font>rTemp<font color="#000080">);
              </font>ATOI <font color="#000080">:= </font>lTemp<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>UpCase<font color="#000080">(</font>C<font color="#000080">: </font>Char<font color="#000080">): </font>Char<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">; </font><font color="#008000"><i>{ will replace TP's built-in upcase }
         </i></font><font color="#FF0000"><b>ASM
            </b></font><font color="#FF00FF">MOV DL, C
            MOV AX, $6520
            INT $21
            MOV AL, DL           </font><font color="#008000"><i>{ function result in AL                 }
         </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>UCase<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{
 *** Converts any string(s) into upper case letters
 ***
}
         </i></font><font color="#FF0000"><b>Var
            </b></font>J <font color="#000080">: </font>Integer<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>Do
                  </b></font>s<font color="#000080">[</font>J<font color="#000080">] := </font>StrIo<font color="#000080">.</font>UpCase<font color="#000080">(</font>s<font color="#000080">[</font>J<font color="#000080">]);
              </font>UCase <font color="#000080">:= </font>S<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>RepStr<font color="#000080">(</font>Times<font color="#000080">: </font>Byte<font color="#000080">; </font>Which<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Var
            </b></font>J        <font color="#000080">: </font>Byte<font color="#000080">;
            </font>tString  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>tString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Times <font color="#FF0000"><b>Do
                  </b></font>tString <font color="#000080">:= </font>tString <font color="#000080">+ </font>Which<font color="#000080">;
              </font>RepStr <font color="#000080">:= </font>tString<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>Strip_Path<font color="#000080">(</font>Fullfilename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Var
            </b></font>tString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>tString <font color="#000080">:= </font>FullFilename<font color="#000080">;
              </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">, </font>tString<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Do
                    </b></font>Delete<font color="#000080">(</font>tString<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">, </font>tString<font color="#000080">));
              </font>Strip_Path <font color="#000080">:= </font>tString<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{
 Makes sure that NUMBER is DIGITS digits.  Ie if DIGITS = 10 and NUMBER = 29
 the result is 0000000029, 10 DIGITS :) Simple hugh?
}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Leading_Zero<font color="#000080">(</font>Number<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Digits<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Var
            </b></font>tString   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;             </font><font color="#008000"><i>{temporary zero holding spot}
            </i></font>NeedZeros <font color="#000080">: </font>Integer<font color="#000080">;            </font><font color="#008000"><i>{Number of zeros needed}
            </i></font>J         <font color="#000080">: </font>Byte<font color="#000080">;               </font><font color="#008000"><i>{for the FOR-LOOP}

         </i></font><font color="#FF0000"><b>Begin
              </b></font>tString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font>NeedZeros <font color="#000080">:= </font>Digits <font color="#000080">- </font>Length<font color="#000080">(</font>Number<font color="#000080">);
              </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>NeedZeros <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                 Begin
                      for </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>NeedZeros <font color="#FF0000"><b>Do
                          </b></font>tString <font color="#000080">:= </font>tString <font color="#000080">+ </font><font color="#800000">'0'</font><font color="#000080">;
                      </font>tString <font color="#000080">:= </font>tString <font color="#000080">+ </font>Number<font color="#000080">;
                 </font><font color="#FF0000"><b>End
              Else
                  </b></font>tString <font color="#000080">:= </font>Number<font color="#000080">;

              </font>Leading_Zero <font color="#000080">:= </font>tString<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>Read_Str<font color="#000080">(</font>StrLen     <font color="#000080">: </font>Byte<font color="#000080">;
                  </font>InputFg<font color="#000080">,
                  </font>InputBg    <font color="#000080">: </font>Integer<font color="#000080">;
                  </font>Hidden<font color="#000080">,
                  </font>Spaces     <font color="#000080">: </font>Char<font color="#000080">;
                  </font>SpinWanted<font color="#000080">,
                  </font>Display<font color="#000080">,
                  </font>Upper<font color="#000080">,
                  </font>OnlyNumbers<font color="#000080">,
                  </font>AutoReturn <font color="#000080">: </font>Boolean<font color="#000080">;
                  </font><font color="#FF0000"><b>Default    </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{
 *** Gets string from local/remote
     StrLen - String length
     InputFg - Foreground for input
     InputBg - Background for input
     Hidden - character to display instead of entered characters or #0
     Spaces - Character to display where nothing is written.
     Display - Display output
     Upper - force upper case
     OnlyNumbers - Characters between 0-9 are allowed, nothing else
     AutoReturn - Wheter to hig enter automatically after STRLENth character
     SpinWanted - Wheter or not to spin a character
     Default - Text displayed as if user/modem typed it in.
 ***
}
         </i></font><font color="#FF0000"><b>Var
            </b></font>ChIn    <font color="#000080">: </font>Char<font color="#000080">;         </font><font color="#008000"><i>{character read in}
            </i></font>StrCount<font color="#000080">: </font>Integer<font color="#000080">;      </font><font color="#008000"><i>{current location in string}
            </i></font>J       <font color="#000080">: </font>Integer<font color="#000080">;      </font><font color="#008000"><i>{used in For-loop combo}
            </i></font>TempStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;       </font><font color="#008000"><i>{temporary string}
            </i></font>OldX<font color="#000080">,
            </font>OldY<font color="#000080">,
            </font>OldFg<font color="#000080">,
            </font>OldBg    <font color="#000080">: </font>Word<font color="#000080">;         </font><font color="#008000"><i>{save coordinates}
            </i></font>SpinCount<font color="#000080">: </font>Byte<font color="#000080">;

         </font><font color="#FF0000"><b>Const
              </b></font>Spin   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char <font color="#000080">= (</font><font color="#800000">'|'</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font><font color="#800000">'\'</font><font color="#000080">);

         </font><font color="#FF0000"><b>Begin
              </b></font>TempStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font>ChIn <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
              </font>StrCount <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>SpinCount <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

              </font><font color="#FF0000"><b>if Default </b></font><font color="#000080">&lt;&gt; </font><font color="#800000">#0 </font><font color="#FF0000"><b>Then
                 Begin
                      </b></font>TempStr <font color="#000080">:= </font><font color="#FF0000"><b>Default</b></font><font color="#000080">;
                      </font>StrCount <font color="#000080">:= </font>Length<font color="#000080">(</font>TempStr<font color="#000080">);
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                Begin
                     </b></font>OldX <font color="#000080">:= </font>WhereX<font color="#000080">;
                     </font>OldY <font color="#000080">:= </font>WhereY<font color="#000080">;
                     </font>OldFg <font color="#000080">:= </font>TextAttr <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">;
                     </font>OldBg <font color="#000080">:= </font>TextAttr <font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">;
                     </font>TextColor<font color="#000080">(</font>InputFg<font color="#000080">);  </font>TextBackground<font color="#000080">(</font>InputBg<font color="#000080">);
                     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Spaces <font color="#000080">&lt; </font><font color="#800000">#32</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                        </b></font>Spaces <font color="#000080">:= </font><font color="#800000">#32</font><font color="#000080">;
                     </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>StrLen <font color="#FF0000"><b>Do
                         </b></font>Write<font color="#000080">(</font>Spaces<font color="#000080">);
                     </font>GotoXY<font color="#000080">(</font>OldX<font color="#000080">, </font>OldY<font color="#000080">);
                     </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font><font color="#FF0000"><b>Default </b></font><font color="#000080">&lt;&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                        Begin
                             For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font><font color="#FF0000"><b>Default</b></font><font color="#000080">) </font><font color="#FF0000"><b>Do
                                 If </b></font><font color="#000080">(</font>Hidden <font color="#000080">&lt;&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                                    </b></font>Write<font color="#000080">(</font>Hidden<font color="#000080">)
                                 </font><font color="#FF0000"><b>Else
                                     </b></font>Write<font color="#000080">(</font><font color="#FF0000"><b>Default</b></font><font color="#000080">[</font>J<font color="#000080">]);
                        </font><font color="#FF0000"><b>End
                End</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>Repeat
                    Repeat
                          If </b></font>SpinWanted <font color="#FF0000"><b>Then
                             Begin
                                  </b></font>Inc<font color="#000080">(</font>SpinCount<font color="#000080">);
                                  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>SpinCount <font color="#000080">&gt; </font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                                     </b></font>SpinCount <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                                  </font>Write<font color="#000080">(</font>Spin<font color="#000080">[</font>SpinCount<font color="#000080">]);
                                  </font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                                  </font>Delay<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">);
                                  </font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
                                  </font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                    </font><font color="#FF0000"><b>Until </b></font>Keypressed<font color="#000080">;
                    </font>ChIn <font color="#000080">:= </font>Readkey<font color="#000080">;

                    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>ChIn <font color="#000080">= </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                       </b></font>Exit<font color="#000080">;

                    </font><font color="#FF0000"><b>If </b></font>Upper <font color="#FF0000"><b>then
                       </b></font>ChIn <font color="#000080">:= </font>Upcase<font color="#000080">(</font>ChIn<font color="#000080">);

                    </font><font color="#FF0000"><b>Case </b></font>UpCase<font color="#000080">(</font>ChIn<font color="#000080">) </font><font color="#FF0000"><b>Of
                        </b></font><font color="#800000">#19</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{left arrow}
                                   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>StrCount <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                                      Begin
                                           </b></font>Dec<font color="#000080">(</font>StrCount<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                                           </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                                              </b></font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                         </font><font color="#800000">#4</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{right arrow}
                                   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>StrCount <font color="#000080">&lt; </font>StrLen<font color="#000080">) </font><font color="#FF0000"><b>Then
                                      Begin
                                           </b></font>Inc<font color="#000080">(</font>StrCount<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                                           </font>Insert<font color="#000080">(</font><font color="#800000">#32</font><font color="#000080">, </font>TempStr<font color="#000080">, </font>StrCount<font color="#000080">);
                                           </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                                              </b></font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                         </font><font color="#800000">#8</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                                  If </b></font><font color="#000080">(</font>StrCount <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                                     Begin
                                          </b></font>Dec<font color="#000080">(</font>StrCount<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                                          </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                                            Begin
                                                 </b></font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                                                 </font>Write<font color="#000080">(</font>Spaces<font color="#000080">);
                                                 </font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                                            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                          </font>Delete<font color="#000080">(</font>TempStr<font color="#000080">, </font>Length<font color="#000080">(</font>TempStr<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
                                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                  </font>ChIn <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                         </font><font color="#800000">#13</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                                   If </b></font>Display <font color="#FF0000"><b>Then
                                      </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>WhereY <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
                              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                       </font><font color="#800000">#32</font><font color="#000080">..</font><font color="#800000">#255</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                                       If </b></font><font color="#000080">(</font>StrCount <font color="#000080">&lt; </font>StrLen<font color="#000080">) </font><font color="#FF0000"><b>Then
                                          Begin
                                               If </b></font>OnlyNumbers <font color="#FF0000"><b>Then
                                                  Begin
                                                       Case </b></font>ChIn <font color="#FF0000"><b>Of
                                                       </b></font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">, </font><font color="#800000">'.'</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                                                                           </b></font>Inc<font color="#000080">(</font>StrCount<font color="#000080">);
                                                                           </font>Insert<font color="#000080">(</font>ChIn<font color="#000080">, </font>TempStr<font color="#000080">, </font>StrCount<font color="#000080">);
                                                                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                                       </font><font color="#FF0000"><b>Else </b></font><font color="#008000"><i>{anything except numbers}
                                                           </i></font>ChIn <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
                                                       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                                  </font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{if onlynumbers then}
                                               </i></font><font color="#FF0000"><b>Else
                                                   Begin
                                                       </b></font>Inc<font color="#000080">(</font>StrCount<font color="#000080">);
                                                       </font>Insert<font color="#000080">(</font>ChIn<font color="#000080">, </font>TempStr<font color="#000080">, </font>StrCount<font color="#000080">);
                                                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                          </font><font color="#FF0000"><b>End
                                       Else
                                           </b></font>ChIn <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
                                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>Else
                            </b></font>ChIn <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
                         </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{case}

                         </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>StrCount <font color="#000080">= </font>StrLen<font color="#000080">) </font><font color="#FF0000"><b>Then
                            Begin
                                 If </b></font>AutoReturn <font color="#FF0000"><b>Then
                                    Begin
                                         </b></font>ChIn <font color="#000080">:= </font><font color="#800000">#13</font><font color="#000080">;
                                         </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>WhereY <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
                                    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                         </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>ChIn <font color="#000080">&lt;&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                            if </b></font><font color="#000080">(</font>Hidden <font color="#000080">&gt; </font><font color="#800000">#32</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font><font color="#008000"><i>{space or no pw}
                               </i></font>Write<font color="#000080">(</font>Hidden<font color="#000080">)
                            </font><font color="#FF0000"><b>Else
                                </b></font>Write<font color="#000080">(</font>ChIn<font color="#000080">);
              </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>ChIn <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>ChIn <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">);

              </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                 Begin
                      </b></font>TextColor<font color="#000080">(</font>OldFg<font color="#000080">);
                      </font>TextBackground<font color="#000080">(</font>OldBg<font color="#000080">);
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font>Read_Str <font color="#000080">:= </font>TempStr<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#FF0000"><b>PROCEDURE </b></font>Flush_Keyboard_Buffer<font color="#000080">;
          </font><font color="#FF0000"><b>Var
             </b></font>ChIn        <font color="#000080">: </font>Char<font color="#000080">;        </font><font color="#008000"><i>{for clearing the keyboard buffer}

          </i></font><font color="#FF0000"><b>Begin
               While </b></font>Keypressed <font color="#FF0000"><b>Do
                     </b></font>ChIn <font color="#000080">:= </font>ReadKey<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>Right_Pad<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>MaxLength<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Const
              </b></font>tString <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;
              </font>HowMany <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
              </font>J       <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>J <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>HowMany <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>tString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

              </font><font color="#008000"><i>{check for greater then number strings}
              </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>s<font color="#000080">) &gt; </font>MaxLength<font color="#000080">) </font><font color="#FF0000"><b>Then
                 Begin
                      </b></font>tString <font color="#000080">:= </font>Copy<font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>MaxLength<font color="#000080">);
                      </font>Exit<font color="#000080">;
                 </font><font color="#FF0000"><b>End
              Else
                  Begin
                       </b></font>HowMany <font color="#000080">:= (</font>MaxLength <font color="#000080">- </font>Length<font color="#000080">(</font>s<font color="#000080">));
                       </font><font color="#FF0000"><b>Repeat
                             </b></font>Inc<font color="#000080">(</font>J<font color="#000080">);
                             </font>tString <font color="#000080">:= </font>tString <font color="#000080">+ </font><font color="#800000">#32</font><font color="#000080">;
                       </font><font color="#FF0000"><b>Until </b></font>J <font color="#000080">&gt;= </font>HowMany<font color="#000080">;
                       </font>tString <font color="#000080">:= </font>s <font color="#000080">+ </font>tString<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font>Right_Pad <font color="#000080">:= </font>tString<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Right_Strip<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Var
            </b></font>StrLen<font color="#000080">,
            </font>Count        <font color="#000080">: </font>Byte<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>StrLen <font color="#000080">:= </font>Length<font color="#000080">(</font>s<font color="#000080">);
              </font>Count  <font color="#000080">:= </font>StrLen <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
              </font><font color="#FF0000"><b>Repeat
                    </b></font>Dec<font color="#000080">(</font>Count<font color="#000080">);
              </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>s<font color="#000080">[</font>Count<font color="#000080">] &lt;&gt; </font><font color="#800000">#32</font><font color="#000080">);
              </font>Delete<font color="#000080">(</font>s<font color="#000080">, </font>Count <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>StrLen <font color="#000080">- </font>Count<font color="#000080">);
              </font>Right_Strip <font color="#000080">:= </font>S<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Right_Justify<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>sl<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Var
            </b></font>tString2<font color="#000080">,
            </font>tString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
            </font>Where<font color="#000080">,
            </font>HowMuch<font color="#000080">: </font>Byte<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>tString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font>tString2 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font>tString <font color="#000080">:= </font>s<font color="#000080">;
              </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>tString<font color="#000080">) &gt; </font>Sl <font color="#FF0000"><b>Then
                 Begin
                      </b></font>tString2 <font color="#000080">:= </font>Copy<font color="#000080">(</font>tString<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Sl<font color="#000080">);
                      </font>Right_Justify <font color="#000080">:= </font>tString2<font color="#000080">;
                      </font>Exit<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font>Where <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
              </font>Where <font color="#000080">:= </font>sl <font color="#000080">- </font>Length<font color="#000080">(</font>tString<font color="#000080">);

              </font>FillChar<font color="#000080">(</font>tString2<font color="#000080">, </font>Where<font color="#000080">, </font><font color="#800000">#32</font><font color="#000080">);
              </font>Insert<font color="#000080">(</font>tString<font color="#000080">, </font>tString2<font color="#000080">, </font>Where<font color="#000080">);
              </font>Delete<font color="#000080">(</font>tString2<font color="#000080">, </font>Where <font color="#000080">+ </font>Length<font color="#000080">(</font>tString<font color="#000080">), </font>Length<font color="#000080">(</font>tString2<font color="#000080">) - (</font>Where <font color="#000080">+ </font>Length<font color="#000080">(</font>tString<font color="#000080">)) + </font><font color="#800000">1</font><font color="#000080">);
              </font>Right_Justify <font color="#000080">:= </font>tString2<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>CommaNum <font color="#000080">(</font>I <font color="#000080">: </font>LongInt<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
    </b></font>TmpString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>Counter<font color="#000080">, </font>Tester <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TmpString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>Counter   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Tester    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Str <font color="#000080">(</font>i<font color="#000080">, </font>TmpString<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Counter <font color="#000080">:= </font>Length <font color="#000080">(</font>TmpString<font color="#000080">) </font><font color="#FF0000"><b>Downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>Do
  Begin
    </b></font>Inc <font color="#000080">(</font>Tester<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Tester <font color="#000080">= </font><font color="#800000">3 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Tester <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>Dec <font color="#000080">(</font>Counter<font color="#000080">);
      </font>TmpString <font color="#000080">:= </font>Copy <font color="#000080">(</font>TmpString<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Counter<font color="#000080">) + </font><font color="#800000">','
                 </font><font color="#000080">+ </font>Copy <font color="#000080">(</font>TmpString<font color="#000080">, </font>Counter <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>Length <font color="#000080">(</font>TmpString<font color="#000080">) );
      </font>Inc <font color="#000080">(</font>Counter<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>TmpString<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">',' </font><font color="#FF0000"><b>THEN </b></font>DELETE<font color="#000080">(</font>TmpString<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>CommaNum <font color="#000080">:= </font>TmpString<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{Returns the path from C:\BLOB\SHOOT\DIS.THD would give you C:\BLOB\SHOOT}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Strip_Filename<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Var
            </b></font>SlashPos  <font color="#000080">: </font>Byte<font color="#000080">;
            </font>tString   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>tString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

              </font>SlashPos <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">, </font>S<font color="#000080">);
              </font><font color="#FF0000"><b>If </b></font>SlashPos <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
                 Begin
                      </b></font>Strip_Filename <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                      </font>Exit<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font><font color="#FF0000"><b>Repeat
                    </b></font>SlashPos <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">, </font>S<font color="#000080">);
                    </font>tString <font color="#000080">:= </font>tString <font color="#000080">+ </font>Copy<font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>SlashPos<font color="#000080">);
                    </font>Delete<font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>SlashPos<font color="#000080">);
              </font><font color="#FF0000"><b>Until </b></font>SlashPos <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
              </font>Strip_FIlename <font color="#000080">:= </font>tString<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0118.PAS">Original</a><b>]</b></p></body>
</html>
