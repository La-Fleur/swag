<html>
<head><title> "LONG String Arrays" by WIM VAN VOLLENHOVEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0076.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
GV&gt; Hi Wim,
Hi Greg...

GV&gt; It wouldn't be difficult to write Pos, Copy, Assign, etc., which
GV&gt; operate on an ARRAY OF CHAR -- using the ASCIIZ scheme, or a length
GV&gt; WORD (rather than length byte) at array elements [0] and [1].

As you can see in a other message has wim van der vegt written a
complete unit with these functions :-)

it was a 'little' bit reprogramming to implement these new functions but
it was worth while &lt;g&gt;

GV&gt; Greg_
Thanx for your answer, Wim

here is the code :
}

</i></font><font color="#FF0000"><b>Unit </b></font>MyStr<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE


Const
  </b></font>maxlength  <font color="#000080">= </font><font color="#800000">512</font><font color="#000080">;
  </font>nul        <font color="#000080">= </font><font color="#800000">#00</font><font color="#000080">;
  </font>cr         <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">;
  </font>lf         <font color="#000080">= </font><font color="#800000">#10</font><font color="#000080">;
  </font>sp         <font color="#000080">= </font><font color="#800000">#32</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>indexrange <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">..</font>maxlength<font color="#000080">;
  </font>stringtype <font color="#000080">= </font><font color="#FF0000"><b>Record
                 </b></font>length <font color="#000080">: </font>indexrange<font color="#000080">;
                 </font>chars  <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>maxlength<font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>char<font color="#000080">;
               </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function  </b></font>Long_Length<font color="#000080">(</font>s <font color="#000080">: </font>stringtype<font color="#000080">) : </font>indexrange<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Long_Readln<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>f <font color="#000080">: </font>text<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>l <font color="#000080">: </font>stringtype<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Long_Write<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>f <font color="#000080">: </font>text<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>l <font color="#000080">: </font>stringtype<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Long_Writeln<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>f <font color="#000080">: </font>text<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>l <font color="#000080">: </font>stringtype<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Long_Copy<font color="#000080">(</font>s <font color="#000080">: </font>stringtype<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>d <font color="#000080">: </font>stringtype<font color="#000080">; </font>index<font color="#000080">,</font>count <font color="#000080">: </font>indexrange<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Long_Concat<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>d <font color="#000080">: </font>stringtype<font color="#000080">;</font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION
</b></font><font color="#008000"><i>{---------------------------------------------------------}
{  Author  : Ir. G.W. van der Vegt                        }
{  Project : Longer strings                               }
{  Source  : Pascal + Data Structures by Dale/Lilly       }
{            ISBN 0-669-07239-7                           }
{---------------------------------------------------------}
{  Modified to give less errors and act more like TP's    }
{  functions. Can be made more efficient by using move,   }
{  moving the inc of length's out of the for loops and    }
{  not using the Length function to calc the length but   }
{  use the field in the record. etc.                      }
{---------------------------------------------------------}
{  Because Turbo Pascal's Functions won't return records  }
{  most of the Turbo Pascal String functions equivalents  }
{  can only be procedures.                                }
{---------------------------------------------------------}
{  The code hasn't been tested well yet so expect some    }
{  errors to be in it. All I have detected are fixed.     }
{  For testing set maxlength at 20 or 30.                 }
{---------------------------------------------------------}


</i></font><font color="#FF0000"><b>Function </b></font>Long_Length<font color="#000080">(</font>s <font color="#000080">: </font>stringtype<font color="#000080">) : </font>indexrange<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Long_Length<font color="#000080">:=</font>s<font color="#000080">.</font>length<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Long_Readln<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>f <font color="#000080">: </font>text<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>l <font color="#000080">: </font>stringtype<font color="#000080">);

</font><font color="#FF0000"><b>Begin
  </b></font>l<font color="#000080">.</font>length<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>Fillchar<font color="#000080">(</font>l<font color="#000080">.</font>chars<font color="#000080">,</font>maxlength<font color="#000080">,</font>sp<font color="#000080">);
  </font><font color="#FF0000"><b>While NOT</b></font><font color="#000080">(</font>Eoln<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font>Eof<font color="#000080">(</font>f<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>l<font color="#000080">.</font>length<font color="#000080">&lt;</font>maxlength<font color="#000080">) </font><font color="#FF0000"><b>Do
    Begin
      </b></font>Inc<font color="#000080">(</font>l<font color="#000080">.</font>length<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font>System<font color="#000080">.</font>Read<font color="#000080">(</font>f<font color="#000080">,</font>l<font color="#000080">.</font>chars<font color="#000080">[</font>l<font color="#000080">.</font>length<font color="#000080">]);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>IF Not</b></font><font color="#000080">(</font>eof<font color="#000080">(</font>f<font color="#000080">)) </font><font color="#FF0000"><b>Then </b></font>System<font color="#000080">.</font>readln<font color="#000080">(</font>f<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Long_Write<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>f <font color="#000080">: </font>text<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>l <font color="#000080">: </font>stringtype<font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>pos <font color="#000080">: </font>indexrange<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  For </b></font>pos<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Long_Length<font color="#000080">(</font>l<font color="#000080">) </font><font color="#FF0000"><b>DO
    </b></font>System<font color="#000080">.</font>Write<font color="#000080">(</font>f<font color="#000080">,</font>l<font color="#000080">.</font>chars<font color="#000080">[</font>pos<font color="#000080">]);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Long_Writeln<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>f <font color="#000080">: </font>text<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>l <font color="#000080">: </font>stringtype<font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>pos <font color="#000080">: </font>indexrange<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  For </b></font>pos<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Long_Length<font color="#000080">(</font>l<font color="#000080">) </font><font color="#FF0000"><b>DO
    </b></font>System<font color="#000080">.</font>Write<font color="#000080">(</font>f<font color="#000080">,</font>l<font color="#000080">.</font>chars<font color="#000080">[</font>pos<font color="#000080">]);
  </font>System<font color="#000080">.</font>Write<font color="#000080">(</font>f<font color="#000080">,</font>cr<font color="#000080">,</font>lf<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Long_Copy<font color="#000080">(</font>s <font color="#000080">: </font>stringtype<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>d <font color="#000080">: </font>stringtype<font color="#000080">; </font>index<font color="#000080">,</font>count <font color="#000080">: </font>indexrange<font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>poss<font color="#000080">,
  </font>posd <font color="#000080">: </font>indexrange<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>d<font color="#000080">.</font>length<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>Fillchar<font color="#000080">(</font>d<font color="#000080">.</font>chars<font color="#000080">,</font>maxlength<font color="#000080">,</font>sp<font color="#000080">);

  </font>posd<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>poss<font color="#000080">:=</font>index<font color="#000080">;

  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>posd<font color="#000080">&lt;</font>count<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>poss<font color="#000080">&lt;=</font>maxlength<font color="#000080">) </font><font color="#FF0000"><b>Do
    Begin
      </b></font>Inc<font color="#000080">(</font>d<font color="#000080">.</font>length<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font>Inc<font color="#000080">(</font>posd<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font>d<font color="#000080">.</font>chars<font color="#000080">[</font>posd<font color="#000080">]:=</font>s<font color="#000080">.</font>chars<font color="#000080">[</font>poss<font color="#000080">];
      </font>Inc<font color="#000080">(</font>poss<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Long_Concat<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>d <font color="#000080">: </font>stringtype<font color="#000080">;</font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>posd<font color="#000080">,
  </font>poss <font color="#000080">: </font>indexrange<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>posd<font color="#000080">:=</font>Long_Length<font color="#000080">(</font>d<font color="#000080">);
  </font>poss<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>posd<font color="#000080">&lt;</font>maxlength<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>poss<font color="#000080">&lt;</font>Length<font color="#000080">(</font>s<font color="#000080">)) </font><font color="#FF0000"><b>Do
    Begin
      </b></font>Inc<font color="#000080">(</font>poss<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font>Inc<font color="#000080">(</font>posd<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font>d<font color="#000080">.</font>chars<font color="#000080">[</font>posd<font color="#000080">]:=</font>s<font color="#000080">[</font>poss<font color="#000080">];
      </font>Inc<font color="#000080">(</font>d<font color="#000080">.</font>length<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#008000"><i>(*
Var
  inf : text;
  s,d : stringtype;

Begin
  Assign(inf,'LSTRING.PAS');
  Reset(inf);
  While NOT(eof(inf)) Do
    Begin
      Readln(inf,s);
      Copy(s,d,1,4);
      Writeln(output,s);
      Writeln(output,d);
      Concat(d,s);
      Writeln(output,d);
    End;
*)

</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0076.PAS">Original</a><b>]</b></p></body>
</html>
