<html>
<head><title> "Assembler to get String Length" by VARIOUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0121.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 JP&gt; How do you get the length of a string using assembler? I've tried
 JP&gt; this, but it doesn't work. I was told the first two bytes hold the
 JP&gt; string length. Is this correct?
}

</i></font><font color="#FF0000"><b>function </b></font>len<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>byte<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">les di,s
  mov al,es:byte ptr [di]
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>or </b></font>this<font color="#000080">:

</font><font color="#FF0000"><b>function </b></font>len<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>byte<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push ds
  lds si,s
  mov al,byte ptr [si]
  pop ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{PETER LOUWEN,Re: Assembler to get leng}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Len1<font color="#000080">(</font><font color="#FF0000"><b>CONST </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">): </font>byte<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM </b></font><font color="#FF00FF">push ds
    lds si, Str   </font><font color="#008000"><i>{ -- DS:SI now holds @Str. }
    </i></font><font color="#FF00FF">lodsb         </font><font color="#008000"><i>{ -- AL := (DS:SI)^.       }
    </i></font><font color="#FF00FF">pop ds
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Len2<font color="#000080">(</font><font color="#FF0000"><b>CONST </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">): </font>byte<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM </b></font><font color="#FF00FF">les di, Str         </font><font color="#008000"><i>{ -- ES:DI now holds @Str. }
    </i></font><font color="#FF00FF">mov al, es:[di]     </font><font color="#008000"><i>{ -- AL := (ES:DI)^.       }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font>The second method <font color="#FF0000"><b>is </b></font>slightly faster <font color="#FF0000"><b>on </b></font>my machine<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0121.PAS">Original</a><b>]</b></p></body>
</html>
