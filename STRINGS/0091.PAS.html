<html>
<head><title> "Flipping a String" by LUIS MEZQUITA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0091.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Procedure </b></font>ReverseString<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>byte<font color="#000080">; </font>c<font color="#000080">:</font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>j<font color="#000080">:=</font>Length<font color="#000080">(</font>s<font color="#000080">);
 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>j <font color="#FF0000"><b>div </b></font><font color="#800000">2 </font><font color="#FF0000"><b>do
  begin
   </b></font>c<font color="#000080">:=</font>s<font color="#000080">[</font>i<font color="#000080">];
   </font>s<font color="#000080">[</font>i<font color="#000080">]:=</font>s<font color="#000080">[</font>j<font color="#000080">];
   </font>s<font color="#000080">[</font>j<font color="#000080">]:=</font>c<font color="#000080">;
   </font>dec<font color="#000080">(</font>j<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ---- BASM 'pointer oriented' version ------------------------------ }
</i></font><font color="#FF0000"><b>Procedure </b></font>ReverseAString<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
        </b></font><font color="#FF00FF">lds SI,s
        mov AL,[SI]
        xor AH,AH
        mov DI,SI
        inc SI                  </font><font color="#008000"><i>{ SI points to start of s }
        </i></font><font color="#FF00FF">add DI,AX               </font><font color="#008000"><i>{ DI points to end of s }

</i></font><font color="#FF00FF">@@0:    cmp SI,DI               </font><font color="#008000"><i>{ while SI=DI do ... }
        </i></font><font color="#FF00FF">jae @@1

        mov AL,[SI]
        mov AH,[DI]
        mov [SI],AH
        mov [DI],AL
        inc SI
        dec DI
        jmp @@0
@@1:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Version #2 }

</i></font><font color="#FF0000"><b>Procedure </b></font>ReverseAString<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
                </b></font><font color="#FF00FF">push DS
                cld
                lds SI,s
                mov DI,SI
                lodsb
                xor AH,AH
                add DI,AX               </font><font color="#008000"><i>{ DI points to end of s }
</i></font><font color="#FF00FF">@ReverseLoop:   cmp SI,DI               </font><font color="#008000"><i>{ while SI=DI do ... }
                </i></font><font color="#FF00FF">jae @ReverseExit
                mov AL,[SI]
                mov AH,[DI]
                mov [SI],AH
                mov [DI],AL
                inc SI
                dec DI
                jmp @ReverseLoop
@ReverseExit:   pop DS
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FlipStr<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
                </b></font><font color="#FF00FF">push DS
                cld
                les DI,@Result
                lds SI,s
                lodsb
                stosb
                mov CL,AL
                xor CH,CH
                add DI,CX
@FlipLoop:      and CL,CL
                jz @FlipExit
                lodsb
                dec DI
                mov ES:[DI],AL
                dec CL
                jmp @FlipLoop
@FlipExit:      pop DS
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0091.PAS">Original</a><b>]</b></p></body>
</html>
