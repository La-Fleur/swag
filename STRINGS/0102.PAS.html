<html>
<head><title> "String A in String B" by SWAG SUPPORT GROUP</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0102.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ Good'ol'times, when I could make my database programs in Clipper... Now I'm
stuck with TP...:) Well, anyway, I remember a small symbol, $, which, when
placed between two different strings checked if the first existed &quot;in&quot; the
second. That's what this does. Checks if A exists in B. Upper/Lower case
ignored (although it can be easily changed to take that into account).
Useful to search by text keywords in databases. Returns True if A exists in B,
false if it doesn't.
Portuguese freeware, by Luis Evaristo Fonseca, Thunderball Software 1994
}

{****************************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>upstring<font color="#000080">(</font>a<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>aux<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>i<font color="#000080">:</font>integer<font color="#000080">;                          </font><font color="#008000"><i>{converts a string to uppercase}
</i></font><font color="#FF0000"><b>begin
  </b></font>aux<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>a<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
      </b></font>aux<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>ord<font color="#000080">(</font>aux<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">);
      </font>aux<font color="#000080">[</font>i<font color="#000080">]:=</font>upcase<font color="#000080">(</font>a<font color="#000080">[</font>i<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>upstring<font color="#000080">:=</font>aux<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}

</i></font><font color="#FF0000"><b>function </b></font>a_in_b<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>conta<font color="#000080">,</font>conta2<font color="#000080">,</font>conta3<font color="#000080">:</font>integer<font color="#000080">;
    </font>a1<font color="#000080">,</font>b1<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>aux<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
    </b></font>aux<font color="#000080">:=</font>false<font color="#000080">;                         </font><font color="#008000"><i>{tests if a is in b, returns true if}
    </i></font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>a<font color="#000080">)&lt;=</font>length<font color="#000080">(</font>b<font color="#000080">) </font><font color="#FF0000"><b>then        </b></font><font color="#008000"><i>{it is, false if it doesn't}
    </i></font><font color="#FF0000"><b>begin
        </b></font>a1<font color="#000080">:=</font>upstring<font color="#000080">(</font>a<font color="#000080">);
        </font>b1<font color="#000080">:=</font>upstring<font color="#000080">(</font>b<font color="#000080">);
        </font><font color="#FF0000"><b>for </b></font>conta<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>b<font color="#000080">) </font><font color="#FF0000"><b>do
        begin
            if </b></font>b1<font color="#000080">[</font>conta<font color="#000080">]=</font>a1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>then
            begin
                </b></font>aux<font color="#000080">:=</font>true<font color="#000080">;
                </font><font color="#FF0000"><b>for </b></font>conta2<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>a<font color="#000080">) </font><font color="#FF0000"><b>do
                begin
                    if </b></font><font color="#000080">(</font>a1<font color="#000080">[</font>conta2<font color="#000080">]&lt;&gt;</font>b1<font color="#000080">[</font>conta2<font color="#000080">+</font>conta<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>then
                       </b></font>aux<font color="#000080">:=</font>false<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>if </b></font>aux<font color="#000080">=</font>true <font color="#FF0000"><b>then
                    </b></font>exit<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>a_in_b<font color="#000080">:=</font>aux<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0102.PAS">Original</a><b>]</b></p></body>
</html>
