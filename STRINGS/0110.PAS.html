<html>
<head><title> "MS-DOS Contry-Specific Upper Case" by HORST KRAEMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0110.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I did, as I said &quot;I couldn't get anything to work&quot;. No functions that
&gt; I called returned the expected results, or maybe I wasn't doing something
&gt; correctly, in any case it would be easier if someone was to post
&gt; information on how I do something like this:

There is an easy way to convert strings using the national conversion tables
using DOS function $6521 (4.0 up). I'm using these two implementations:

  MS-DOS function $6521
  Version 4.0 up
  Converts string at address DS:DX
  of length CX
}

</i></font><font color="#FF0000"><b>procedure </b></font>cap<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#008000"><i>{ converts string S to uppercase
  procedure version
}
</i></font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push ds
  lds  si,s
  mov  cl,[si]
  xor  ch,ch
  jcxz @Exit
  lea  dx,[si+1]
  mov  ax,$6521
  int  21h
@Exit:
  pop ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>fcap<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#008000"><i>(* TP 7.0
function fcap(const s:string):string;
*)
{ converts string S to uppercase
  function version
}
</i></font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push ds
  lds  si,s
  cld
  lodsb
  mov  cl,al
  xor  ch,ch
  jcxz @Exit
  les  di,@Result
  stosb
  mov  dx,di
  push cx
  rep  movsb
  push es
  pop  ds
  pop  cx
  mov  ax,$6521
  int  21h
@Exit:
  pop ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0110.PAS">Original</a><b>]</b></p></body>
</html>
