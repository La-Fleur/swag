<html>
<head><title> "LTRIM & assembler" by PETER OGDEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0129.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
In a message dated Wednesday March 13 1996, Mario Polycarpou of 3:690/354
wrote:
 DR&gt;&gt; function LTrim(S: string): string;
 DR&gt;&gt; var C: Byte;
 DR&gt;&gt; begin
 DR&gt;&gt; for C := 1 to Length(S) do if S[C+1]&lt;&gt;#32 then Break;
 DR&gt;&gt; LTrim := Copy(S,C,255);
 DR&gt;&gt; end;

 MP&gt;  Sorry mate but that's crap. Have a play with this...

 MP&gt; {-+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--}
 MP&gt; FUNCTION TrimL(S:String):String;     {Trim left}
 MP&gt; VAR X:Integer;
 MP&gt; BEGIN
 MP&gt;  X:=1;
 MP&gt;  WHILE S[X]=#32 DO Inc(X);
 MP&gt;  TrimL:=Copy(S,X,Length(S));
 MP&gt; END;
 MP&gt; {-+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--}

OK, by my calculations, TrimL is about 10% faster - try this, it's about twice
as fast as Marios:
*)

</i></font><font color="#FF0000"><b>function </b></font>StripLBStr <font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;

</font><font color="#FF0000"><b>asm
      </b></font><font color="#FF00FF">mov  dx, ds     </font><font color="#008000"><i>{ Save DS Register }
      </i></font><font color="#FF00FF">cld
      les  di, [S]    </font><font color="#008000"><i>{ ES:DI =&gt; Source }
      </i></font><font color="#FF00FF">mov  al, es:[DI]</font><font color="#008000"><i>{ Load Length of String }
      </i></font><font color="#FF00FF">inc  di
      sub  cx, cx     </font><font color="#008000"><i>{ Set CX to Zero }
      </i></font><font color="#FF00FF">mov  cl, al     </font><font color="#008000"><i>{ CX &lt;- No. of Bytes }
      </i></font><font color="#FF00FF">jcxz @1         </font><font color="#008000"><i>{ if Null String then Terminate }
      </i></font><font color="#FF00FF">mov  ax, ' '    </font><font color="#008000"><i>{ Store ' ' in AX }
      </i></font><font color="#FF00FF">repz scasb      </font><font color="#008000"><i>{ Scan String until no Space or string scan complete }
      </i></font><font color="#FF00FF">jz   @3
      inc  cx
      dec  di
      push es
      pop  ds
      mov  si, di
  @3: mov  al, cl
  @1: les  di, @Result</font><font color="#008000"><i>{ ES:DI =&gt; Destination }
      </i></font><font color="#FF00FF">stosb           </font><font color="#008000"><i>{ store length byte }
      </i></font><font color="#FF00FF">jcxz @2         </font><font color="#008000"><i>{ if CX = 0 then done }
      </i></font><font color="#FF00FF">movsb           </font><font color="#008000"><i>{ Move first char so stay word aligned }
      </i></font><font color="#FF00FF">dec  cx
      jcxz @2
      shr  cx,1       </font><font color="#008000"><i>{ CX &lt;- CX div 2 }
      </i></font><font color="#FF00FF">rep  movsw      </font><font color="#008000"><i>{ move rest as words }
      </i></font><font color="#FF00FF">jnc  @2         </font><font color="#008000"><i>{ if carry then odd number }
      </i></font><font color="#FF00FF">movsb           </font><font color="#008000"><i>{ so move the odd one }
  </i></font><font color="#FF00FF">@2: mov  ds, dx     </font><font color="#008000"><i>{ Restore DS Register }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0129.PAS">Original</a><b>]</b></p></body>
</html>
