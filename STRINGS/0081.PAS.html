<html>
<head><title> "General String Library" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0081.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>STR_STF<font color="#000080">;
  </font><font color="#008000"><i>{**------------------------------------------------**}
  {**    STRING Library OPERATIONS                   **}
  {**    Version 1.2                                 **}
  {**            Added Pos_Reverse                   **}
  {**    Version 1.1 (sped-ups)                      **}
  {**                (delete_duplicate_Chars_in_str) **}
  {**            Added Int_To_Str_Zero_Fill          **}
  {**------------------------------------------------**}

{$O-,F+}

</i></font><font color="#FF0000"><b>INTERFACE
</b></font><font color="#008000"><i>{**************************************************************}
{* Trim   removes leading/trailing blanks.                    *}
{*                                                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>TRIM        <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>TRIM_Leading_Only <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>TRIM_Trailing_Only <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>TRIM_Quotes <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* Right_Justify adds leading blanks.                         *}
{*    NOTE: does not handle cases when                        *}
{*                   Size_To_Be &lt; ACTUAL NUMBER OF CHARACTERS *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Right_Justify <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Size_To_Be <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#008000"><i>{***************************************************************}
{* Center_Str   centers the characters in the string based     *}
{*              upon the size/midpoint specified.              *}
{***************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Center_Str <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Output_Size <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* Change_Case changes the case of the string to UPPER.       *}
{*                                                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>CHANGE_CASE <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>Lower_Case <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* Int_To_Str returns the number converted into ascii chars.  *}
{*                                                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Int_To_Str  <font color="#000080">(</font>Num <font color="#000080">: </font>LongInt<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>Int_To_Str_Zero_Fill  <font color="#000080">(</font>Num <font color="#000080">: </font>LongInt<font color="#000080">; </font>Fill <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>Int_Num_Digits <font color="#000080">(</font>Num <font color="#000080">: </font>LongInt<font color="#000080">) : </font>integer<font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* Pos_Reverse returns the last occurance of the string       *}
{*     just before the specified start pos!                   *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Pos_Reverse <font color="#000080">(</font>Str        <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                      </font>Delimiter  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                      </font>Start_At   <font color="#000080">: </font>integer<font color="#000080">) : </font>integer<font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* Find_Char   returns the position of the char               *}
{*                                                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Find_Char   <font color="#000080">(</font>Str      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                      </font>Char_Is  <font color="#000080">: </font>char<font color="#000080">;
                      </font>Start_At <font color="#000080">: </font>integer<font color="#000080">) : </font>INTEGER<font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* Delete_The_Char   delete all occurances of the char        *}
{*                                                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Delete_The_Char
                     <font color="#000080">(</font>Str      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                      </font>Char_Is  <font color="#000080">: </font>char<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* Replace_Str_Into  inserts the small string into the        *}
{*                   org_str at the position specified        *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Replace_Str_Into <font color="#000080">(</font>Org_Str     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
                           </font>Small_Str   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                           </font>Start<font color="#000080">, </font>Stop <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* procedure Get_Word_Around_Position                         *}
{*     returns the word based AROUND the position specified   *}
{*     Searches for blanks around the start_pos               *}
{*        looking left then right.                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Get_Word_Around_Position
                     <font color="#000080">(</font>Str                    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                      </font>Start_Pos              <font color="#000080">: </font>integer<font color="#000080">;
                      </font>Leftmost_Char_Boundry  <font color="#000080">: </font>integer<font color="#000080">;
                      </font>Rightmost_Char_Boundry <font color="#000080">: </font>integer<font color="#000080">;
                      </font><font color="#FF0000"><b>VAR </b></font>Found_Left_Pos     <font color="#000080">: </font>integer<font color="#000080">;
                      </font><font color="#FF0000"><b>VAR </b></font>Found_Word_Size    <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* returns a string with duplicate chars deleted.             *}
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Delete_Duplicate_Chars_In_Str <font color="#000080">(</font>Str            <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                                        </font>Limit_In_A_Row <font color="#000080">: </font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* returns a string filled with the character specified       *}
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Fill_String<font color="#000080">(</font>Len <font color="#000080">: </font>Byte<font color="#000080">; </font>Ch <font color="#000080">: </font>Char<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* Truncates a string to a specified length                   *}
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Trunc_Str<font color="#000080">(</font>TString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>{**************************************************************}
{* Pads a string to a specified length with a specified character }
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Pad_Char<font color="#000080">(</font>PString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Ch <font color="#000080">: </font>Char<font color="#000080">; </font>Len <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;


</font><font color="#008000"><i>{**************************************************************}
{* Left-justify a string within a certain width               *}
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Left_Justify_Str <font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Width <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;


</font><font color="#008000"><i>{**************************************************************}
{* Note that &quot;Count&quot; is the number of *WORDS* to fill.        *}
{* So e.g. you'd use                                          *}
{* &quot;FillWord(My_Int_Array, SizeOf(My_Int_Array) DIV 2, 1);&quot;   *}
{*      by Neil Rubenking                                     *}
{**************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>FillWord <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Dest<font color="#000080">; </font>Count<font color="#000080">, </font>What <font color="#000080">: </font>Word<font color="#000080">);


</font><font color="#008000"><i>{**************************************************************}
{**************************************************************}
{**************************************************************}
</i></font><font color="#FF0000"><b>IMPLEMENTATION

</b></font><font color="#008000"><i>{**************************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Min<font color="#000080">(</font>N1<font color="#000080">, </font>N2 <font color="#000080">: </font>Longint<font color="#000080">) : </font>Longint<font color="#000080">;
</font><font color="#008000"><i>{ Returns the smaller of two numbers }
</i></font><font color="#FF0000"><b>begin
  if </b></font>N1 <font color="#000080">&lt;= </font>N2 <font color="#FF0000"><b>then
    </b></font>Min <font color="#000080">:= </font>N1
  <font color="#FF0000"><b>else
    </b></font>Min <font color="#000080">:= </font>N2<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Min }

(*
{**************************************************************************}
function Max(N1, N2 : Longint) : Longint;
{ Returns the larger of two numbers }
begin
  if N1 &gt;= N2 then
    Max := N1
  else
    Max := N2;
end; { Max }
*)

{**************************************************************}
{* returns a string filled with the character specified       *}
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Fill_String<font color="#000080">(</font>Len <font color="#000080">: </font>Byte<font color="#000080">; </font>Ch <font color="#000080">: </font>Char<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  IF </b></font><font color="#000080">(</font>Len <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>S<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Len<font color="#000080">);
      </font>FillChar<font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Len<font color="#000080">, </font>Ch<font color="#000080">);
      </font>Fill_String <font color="#000080">:= </font>S<font color="#000080">;
    </font><font color="#FF0000"><b>END
  ELSE </b></font>Fill_String <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ FillString }

{**************************************************************}
{* Truncates a string to a specified length                   *}
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Trunc_Str<font color="#000080">(</font>TString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>TString<font color="#000080">) &gt; </font>Len<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font><font color="#008000"><i>{Delete(TString, Succ(Len), Length(TString) - Len);}
      {Move(TString[Succ(Len)+(LENGTH(TString)-Len)], TString[Succ(Len)],
           Succ(Length(TString)) - Succ(Len) - Length(TString) - Len));}
      </i></font>Move<font color="#000080">(</font>TString<font color="#000080">[</font>LENGTH<font color="#000080">(</font>TString<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">], </font>TString<font color="#000080">[</font>Succ<font color="#000080">(</font>Len<font color="#000080">)], </font><font color="#800000">2</font><font color="#000080">*</font>Len<font color="#000080">);
      </font>Dec<font color="#000080">(</font>TString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>Length<font color="#000080">(</font>TString<font color="#000080">) - </font>Len<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Str_Stf<font color="#000080">.</font>Trunc_Str <font color="#000080">:= </font>TString<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ TruncStr }

{**************************************************************}
{* Pads a string to a specified length with a specified character }
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Pad_Char<font color="#000080">(</font>PString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Ch <font color="#000080">: </font>Char<font color="#000080">; </font>Len <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>CurrLen <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>CurrLen <font color="#000080">:= </font>Min<font color="#000080">(</font>Length<font color="#000080">(</font>PString<font color="#000080">), </font>Len<font color="#000080">);
  </font>PString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Len<font color="#000080">);
  </font>FillChar<font color="#000080">(</font>PString<font color="#000080">[</font>Succ<font color="#000080">(</font>CurrLen<font color="#000080">)], </font>Len <font color="#000080">- </font>CurrLen<font color="#000080">, </font>Ch<font color="#000080">);
  </font>Pad_Char <font color="#000080">:= </font>PString<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ PadChar }

{**************************************************************}
{* Left-justify a string within a certain width               *}
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Left_Justify_Str<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Width <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Left_Justify_Str <font color="#000080">:= </font>Str_Stf<font color="#000080">.</font>Pad_Char<font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>Width<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Left_Justify_Str }

{**************************************************************}
{* Trim   removes leading/trailing blanks.                    *}
{*                                                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>TRIM <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">((</font>i <font color="#000080">&lt; </font>LENGTH<font color="#000080">(</font>Str<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">))
    </font><font color="#FF0000"><b>DO </b></font>INC<font color="#000080">(</font>i<font color="#000080">);

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>i <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font><font color="#008000"><i>{Str := COPY (Str, i, Length(Str));}
      </i></font>Move <font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">], </font>Str<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Succ<font color="#000080">(</font>LENGTH<font color="#000080">(</font>Str<font color="#000080">))-</font>i<font color="#000080">);
      </font>DEC <font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>pred<font color="#000080">(</font>i<font color="#000080">));
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>LENGTH<font color="#000080">(</font>str<font color="#000080">)] = </font><font color="#800000">' '</font><font color="#000080">)
    </font><font color="#FF0000"><b>DO </b></font>DEC <font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);

  </font>Trim <font color="#000080">:= </font>Str<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{trim}

{**************************************************************}
{* Trim_Lead   removes leading blanks.                        *}
{*                                                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>TRIM_Leading_Only <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">((</font>i <font color="#000080">&lt; </font>LENGTH<font color="#000080">(</font>Str<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">))
    </font><font color="#FF0000"><b>DO </b></font>INC<font color="#000080">(</font>i<font color="#000080">);

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>i <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font><font color="#008000"><i>{Str := COPY (Str, i, Length(Str));}
      </i></font>Move <font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">], </font>Str<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Succ<font color="#000080">(</font>LENGTH<font color="#000080">(</font>Str<font color="#000080">))-</font>i<font color="#000080">);
      </font>DEC <font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>pred<font color="#000080">(</font>i<font color="#000080">));
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>Trim_Leading_Only <font color="#000080">:= </font>Str<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{trim_leading_Only}

{***************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>TRIM_Trailing_Only <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  WHILE </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>LENGTH<font color="#000080">(</font>str<font color="#000080">)] = </font><font color="#800000">' '</font><font color="#000080">)
    </font><font color="#FF0000"><b>DO </b></font>DEC <font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);

  </font>Trim_Trailing_Only <font color="#000080">:= </font>Str<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{trim}

{***************************************************************}
{*------------------------------------------------------*}
{* Trim off any lead/trail quotes!                      *}
{*------------------------------------------------------*}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>TRIM_Quotes <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  IF </b></font><font color="#000080">((</font>LENGTH<font color="#000080">(</font>Str<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'&quot;'</font><font color="#000080">)) </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>Move <font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">], </font>Str<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>pred<font color="#000080">(</font>LENGTH<font color="#000080">(</font>Str<font color="#000080">)));
      </font>DEC <font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>LENGTH<font color="#000080">(</font>Str<font color="#000080">)] = </font><font color="#800000">'&quot;'</font><font color="#000080">)
        </font><font color="#FF0000"><b>THEN </b></font>DEC<font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
</i></font>Trim_Quotes <font color="#000080">:= </font>Str<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Trim_Quotes}

{***************************************************************}
{* Right_Justify adds leading blanks.                          *}
{*    NOTE: does not handle cases when                         *}
{*                    Size_To_Be &lt; ACTUAL NUMBER OF CHARACTERS *}
{***************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Right_Justify <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Size_To_Be <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>Temp_Str  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Temp_Str <font color="#000080">:= </font>TRIM <font color="#000080">(</font>Str<font color="#000080">);   </font><font color="#008000"><i>{to assure proper length--and NON-BLANK}
  </i></font>Right_Justify <font color="#000080">:= </font>Str_Stf<font color="#000080">.</font>Left_Justify_Str
                               <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">, </font>Size_To_Be <font color="#000080">- </font>Length<font color="#000080">(</font>Str<font color="#000080">)) + </font>Str<font color="#000080">;

</font><font color="#008000"><i>{  WHILE ((LENGTH(Temp_Str) &gt; 0) AND
         ( (Size_To_Be &gt; LENGTH (Temp_Str)) OR
           (Temp_Str[Size_To_Be] = ' ') ) )
    DO Temp_Str := ' '+ COPY (Temp_Str, 1, Size_To_Be-1);
  Right_Justify := Temp_Str;}

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{right_justify}

{***************************************************************}
{* Center_Str   centers the characters in the string based     *}
{*              upon the size/midpoint specified.              *}
{***************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Center_Str <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Output_Size <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>Ret_Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>Size    <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font><font color="#008000"><i>{ blank out returning string}
  </i></font>Ret_Str <font color="#000080">:= </font>Str_Stf<font color="#000080">.</font>Fill_String<font color="#000080">(</font>Output_Size<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">);
  </font><font color="#008000"><i>{FillChar (Ret_Str, output_size, ' ');
   Ret_Str[0] := chr(Output_Size);}

  </i></font>Str <font color="#000080">:= </font>TRIM <font color="#000080">(</font>Str<font color="#000080">);
  </font>Size <font color="#000080">:= </font>LENGTH <font color="#000080">(</font>Str<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Output_Size <font color="#000080">&lt;= </font>Size<font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Ret_Str <font color="#000080">:= </font>Str
  <font color="#FF0000"><b>ELSE
    BEGIN
      </b></font>Insert <font color="#000080">(</font>Str<font color="#000080">, </font>Ret_Str<font color="#000080">, (((</font>Output_Size <font color="#000080">- </font>Size<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">));
      </font>Ret_Str <font color="#000080">:= </font>COPY <font color="#000080">(</font>Ret_Str<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>OutPut_Size<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Center_Str <font color="#000080">:= </font>Ret_Str<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{center_str}

{**************************************************************}
{* Change_Case changes the case of the string to UPPER.       *}
{*                                                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Change_Case <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>LENGTH <font color="#000080">(</font>Str<font color="#000080">)
    </font><font color="#FF0000"><b>do </b></font>Str<font color="#000080">[</font>i<font color="#000080">] := </font>UpCase<font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">]);
  </font>Change_Case <font color="#000080">:= </font>Str<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{change_case}

{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Lower_Case <font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>LENGTH <font color="#000080">(</font>Str<font color="#000080">)
    </font><font color="#FF0000"><b>do IF </b></font><font color="#000080">((</font>ORD <font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">]) &gt;= </font><font color="#800000">65</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>ORD<font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">]) &lt;= </font><font color="#800000">90</font><font color="#000080">))
         </font><font color="#FF0000"><b>THEN </b></font>Str<font color="#000080">[</font>i<font color="#000080">] := </font>CHR<font color="#000080">(</font>ORD<font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">])+</font><font color="#800000">32</font><font color="#000080">);
  </font>Lower_Case <font color="#000080">:= </font>Str<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{lower_case}

{**************************************************************}
{* Int_To_Str returns the number converted into ascii chars.  *}
{*                                                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Int_To_Str  <font color="#000080">(</font>Num <font color="#000080">: </font>LongInt<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Temp_Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>STR<font color="#000080">(</font>Num<font color="#000080">, </font>Temp_Str<font color="#000080">);
  </font>Int_To_Str <font color="#000080">:= </font>Temp_Str<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{int_to_str}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Int_To_Str_Zero_Fill  <font color="#000080">(</font>Num <font color="#000080">: </font>LongInt<font color="#000080">; </font>Fill <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Temp_Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>Len <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>STR<font color="#000080">(</font>Num<font color="#000080">, </font>Temp_Str<font color="#000080">);
  </font>Len <font color="#000080">:= </font>LENGTH<font color="#000080">(</font>Temp_Str<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Len <font color="#000080">&lt; </font>Fill<font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Temp_Str <font color="#000080">:= </font>Fill_String<font color="#000080">(</font>Fill<font color="#000080">-</font>Len<font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">)+</font>Temp_Str<font color="#000080">;
  </font>Int_To_Str_Zero_Fill <font color="#000080">:= </font>Temp_Str<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{int_to_str_zero_fill}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Int_Num_Digits <font color="#000080">(</font>Num <font color="#000080">: </font>LongInt<font color="#000080">) : </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>Tens<font color="#000080">, </font>Digits <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>Num <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Int_Num_Digits <font color="#000080">:= </font><font color="#800000">1
  </font><font color="#FF0000"><b>ELSE
    BEGIN
      </b></font>Tens <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>Digits <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">((</font>Num <font color="#FF0000"><b>DIV </b></font>Tens<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
      BEGIN
        </b></font>INC <font color="#000080">(</font>Digits<font color="#000080">);
        </font>Tens <font color="#000080">:= </font>Tens <font color="#000080">* </font><font color="#800000">10</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{while}

      </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Digits <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">)
        </font><font color="#FF0000"><b>THEN </b></font>DEC <font color="#000080">(</font>Digits<font color="#000080">);
      </font>Int_Num_Digits <font color="#000080">:= </font>Digits<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{if}

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{int_num_digits}

{**************************************************************}
{* Pos_Reverse returns the last occurance of the string       *}
{*     just before the specified start pos!                   *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Pos_Reverse <font color="#000080">(</font>Str        <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                      </font>Delimiter  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                      </font>Start_At   <font color="#000080">: </font>integer<font color="#000080">) : </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>Temp_Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>Found_Pos<font color="#000080">, </font>Found_Pos_0 <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Temp_Str <font color="#000080">:= </font>COPY<font color="#000080">(</font>Str<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Start_At<font color="#000080">);  </font><font color="#008000"><i>{dont use move since ?start_at &lt;length?}
  </i></font>Found_Pos_0 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>REPEAT
    </b></font>Found_Pos <font color="#000080">:= </font>POS <font color="#000080">(</font>Delimiter<font color="#000080">, </font>Temp_Str<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Found_Pos <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>Found_Pos_0 <font color="#000080">:= </font>Found_Pos_0<font color="#000080">+</font>Found_Pos<font color="#000080">;
        </font><font color="#008000"><i>{Temp_Str := COPY(Temp_Str, Found_Pos+1, LENGTH(Temp_Str));}
        </i></font>Move <font color="#000080">(</font>Temp_Str<font color="#000080">[</font>Found_Pos<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">], </font>Temp_Str<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>LENGTH<font color="#000080">(</font>Str<font color="#000080">)-</font>Found_Pos<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
        </font>DEC <font color="#000080">(</font>Temp_Str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>Found_Pos<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>Found_Pos <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
  </font>Pos_Reverse <font color="#000080">:= </font>Found_Pos_0<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{pos_reverse}

{**************************************************************}
{* Find_Char   returns the position of the char               *}
{*                                                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Find_Char <font color="#000080">(</font>Str      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                    </font>Char_Is  <font color="#000080">: </font>char<font color="#000080">;
                    </font>Start_At <font color="#000080">: </font>integer<font color="#000080">) : </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>Loc <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Loc <font color="#000080">:= </font>POS <font color="#000080">(</font>Char_Is<font color="#000080">, </font>COPY<font color="#000080">(</font>Str<font color="#000080">, </font>Start_At<font color="#000080">, </font>LENGTH<font color="#000080">(</font>STR<font color="#000080">)));
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Loc <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Loc <font color="#000080">:= </font>Loc <font color="#000080">+ </font>Start_At <font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>Find_Char <font color="#000080">:= </font>Loc<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{function Find_Char}

{**************************************************************}
{* Delete_The_Char   delete all occurances of the char        *}
{*                                                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Delete_The_Char <font color="#000080">(</font>Str      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                          </font>Char_Is  <font color="#000080">: </font>char<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>Loc <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Loc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>REPEAT
    </b></font>Loc <font color="#000080">:= </font>POS <font color="#000080">(</font>Char_Is<font color="#000080">, </font>Str<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Loc <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font><font color="#008000"><i>{DELETE (Str, Loc, 1);}
        </i></font>Move<font color="#000080">(</font>Str<font color="#000080">[</font>Succ<font color="#000080">(</font>Loc<font color="#000080">)], </font>Str<font color="#000080">[</font>Loc<font color="#000080">], </font>Length<font color="#000080">(</font>Str<font color="#000080">)-</font>Loc<font color="#000080">);
        </font>Dec<font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>Loc <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);

  </font>Delete_The_Char <font color="#000080">:= </font>STR<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{function Delete_The_Char}

{**************************************************************}
{* Replace_Str_Into  inserts the small string into the        *}
{*                   org_str at the position specified        *}
{**************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Replace_Str_Into <font color="#000080">(</font>Org_Str     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
                           </font>Small_Str   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                           </font>Start<font color="#000080">, </font>Stop <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Temp_Small_Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  IF </b></font><font color="#000080">(</font>Start <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Start <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>LENGTH<font color="#000080">(</font>Small_Str<font color="#000080">) &gt;= (</font>Stop<font color="#000080">-</font>Start<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">))
    </font><font color="#FF0000"><b>THEN </b></font>Temp_Small_Str <font color="#000080">:= </font>Small_Str
  <font color="#FF0000"><b>ELSE </b></font>Temp_Small_Str <font color="#000080">:= </font>Small_Str <font color="#000080">+
                       </font>Fill_String <font color="#000080">( (</font>Stop<font color="#000080">-</font>Start<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">-</font>LENGTH<font color="#000080">(</font>Small_Str<font color="#000080">)), </font><font color="#800000">' '</font><font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Start <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Replace_Str_Into <font color="#000080">:= </font>Copy <font color="#000080">(</font>Org_Str<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, (</font>Start <font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)) +
                             </font>Copy <font color="#000080">(</font>Temp_Small_Str<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, (</font>Stop<font color="#000080">-</font>Start<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">))+
                             </font>Copy <font color="#000080">(</font>Org_Str<font color="#000080">, (</font>Stop<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) , </font>LENGTH<font color="#000080">(</font>Org_Str<font color="#000080">))
    </font><font color="#FF0000"><b>ELSE </b></font>Replace_Str_Into <font color="#000080">:= </font>Copy <font color="#000080">(</font>Temp_Small_Str<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, (</font>Stop<font color="#000080">-</font>Start<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)) +
                             </font>Copy <font color="#000080">(</font>Org_Str<font color="#000080">, </font>Stop<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>LENGTH<font color="#000080">(</font>Org_Str<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Replace_Str_into}

{**************************************************************}
{* procedure Get_Word_Around_Position                         *}
{*     returns the word based AROUND the position specified   *}
{*     Searches for blanks around the start_pos               *}
{*        looking left then right.                            *}
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Get_Word_Around_Position
                               <font color="#000080">(</font>Str                    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                                </font>Start_Pos              <font color="#000080">: </font>integer<font color="#000080">;
                                </font>Leftmost_Char_Boundry  <font color="#000080">: </font>integer<font color="#000080">;
                                </font>Rightmost_Char_Boundry <font color="#000080">: </font>integer<font color="#000080">;
                                </font><font color="#FF0000"><b>VAR </b></font>Found_Left_Pos     <font color="#000080">: </font>integer<font color="#000080">;
                                </font><font color="#FF0000"><b>VAR </b></font>Found_Word_Size    <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>adjust         <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  IF </b></font><font color="#000080">((</font>Start_Pos <font color="#000080">&lt;= </font>LENGTH<font color="#000080">(</font>Str<font color="#000080">))) </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>Get_Word_Around_Position <font color="#000080">:= </font>Str<font color="#000080">[</font>Start_Pos<font color="#000080">];
      </font>Found_Left_Pos <font color="#000080">:= </font>Start_Pos<font color="#000080">;
      </font>Found_Word_Size <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>END

  ELSE        </b></font><font color="#008000"><i>{* Bad Params! *}
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>Get_Word_Around_Position <font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">;
      </font>Found_Left_Pos           <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>Found_Word_Size          <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>Start_Pos<font color="#000080">] &lt;&gt; </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font><font color="#008000"><i>{************************************************}
      {*  FIRST: find left-most position              *}
      {************************************************}
      </i></font>adjust <font color="#000080">:= </font>Start_Pos <font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>adjust <font color="#000080">&gt;= </font>leftmost_char_boundry<font color="#000080">) </font><font color="#FF0000"><b>and
             </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>adjust<font color="#000080">] &lt;&gt; </font><font color="#800000">' '</font><font color="#000080">))
        </font><font color="#FF0000"><b>do </b></font>adjust <font color="#000080">:= </font>adjust <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>adjust <font color="#000080">= </font>leftmost_char_boundry<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>adjust<font color="#000080">] &lt;&gt; </font><font color="#800000">' '</font><font color="#000080">))
        </font><font color="#FF0000"><b>then </b></font>Found_Left_Pos <font color="#000080">:= </font>adjust
        <font color="#FF0000"><b>else </b></font>Found_Left_Pos <font color="#000080">:= </font>adjust <font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;

      </font><font color="#008000"><i>{************************************************}
      {*  find right-most position                    *}
      {************************************************}
      </i></font>adjust <font color="#000080">:= </font>Start_Pos <font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>adjust <font color="#000080">&lt;= </font>Rightmost_Char_Boundry<font color="#000080">) </font><font color="#FF0000"><b>and
              </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>adjust<font color="#000080">] &lt;&gt; </font><font color="#800000">' '</font><font color="#000080">))
        </font><font color="#FF0000"><b>do </b></font>adjust <font color="#000080">:= </font>adjust <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;

      </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>adjust <font color="#000080">= </font>Rightmost_char_boundry<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>adjust<font color="#000080">] &lt;&gt; </font><font color="#800000">' '</font><font color="#000080">))
        </font><font color="#FF0000"><b>then </b></font>Found_Word_Size <font color="#000080">:= </font>adjust <font color="#000080">- </font>Found_Left_Pos <font color="#000080">+</font><font color="#800000">1
        </font><font color="#FF0000"><b>else </b></font>Found_Word_Size <font color="#000080">:= </font>adjust <font color="#000080">- </font>Found_Left_Pos<font color="#000080">;

      </font>Get_Word_Around_Position <font color="#000080">:= </font>Copy <font color="#000080">(</font>Str<font color="#000080">, </font>Found_Left_Pos<font color="#000080">, </font>Found_Word_Size<font color="#000080">);

    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{get_word_around_position}

{**************************************************************}
{* returns a string with duplicate chars deleted.             *}
{**************************************************************}
</i></font><font color="#FF0000"><b>function </b></font>Delete_Duplicate_Chars_In_Str <font color="#000080">(</font>Str            <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                                        </font>Limit_In_A_Row <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Curr_Pos       <font color="#000080">: </font>integer<font color="#000080">;
  </font>i              <font color="#000080">: </font>integer<font color="#000080">;
  </font>Same_Chars     <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin

  IF </b></font><font color="#000080">(</font>Limit_In_A_Row <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN       </b></font><font color="#008000"><i>{* must catch or infinite loop *}
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>Delete_Duplicate_Chars_In_Str <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>Curr_Pos        <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">((</font>Curr_Pos<font color="#000080">+</font>Limit_In_A_Row<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) &lt;= </font>LENGTH<font color="#000080">(</font>Str<font color="#000080">)) </font><font color="#FF0000"><b>DO
    BEGIN

      </b></font><font color="#008000"><i>{*---------------------------------------*}
      {* Quickly look for at least 2 in a row! *}
      {*---------------------------------------*}
      </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(((</font>Curr_Pos<font color="#000080">+</font>Limit_In_A_Row<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) &lt;= </font>LENGTH<font color="#000080">(</font>Str<font color="#000080">)) </font><font color="#FF0000"><b>AND
             </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>Curr_Pos<font color="#000080">] &lt;&gt; </font>Str<font color="#000080">[</font>Succ<font color="#000080">(</font>Curr_Pos<font color="#000080">)]))
        </font><font color="#FF0000"><b>DO </b></font>INC<font color="#000080">(</font>Curr_Pos<font color="#000080">);

      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>Curr_Pos<font color="#000080">+</font>Limit_In_A_Row<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) &lt;= </font>LENGTH<font color="#000080">(</font>Str<font color="#000080">)) </font><font color="#FF0000"><b>THEN
        BEGIN
          </b></font>i <font color="#000080">:= </font>Curr_Pos<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
          </font>Same_Chars <font color="#000080">:= </font>TRUE<font color="#000080">;
          </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">((</font>Same_Chars<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= (</font>Curr_Pos<font color="#000080">+</font>Limit_In_A_Row<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)))
            </font><font color="#FF0000"><b>DO IF </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>Curr_Pos<font color="#000080">] &lt;&gt; </font>Str<font color="#000080">[</font>i<font color="#000080">])
                 </font><font color="#FF0000"><b>THEN </b></font>Same_Chars <font color="#000080">:= </font>FALSE
                 <font color="#FF0000"><b>ELSE </b></font>INC<font color="#000080">(</font>i<font color="#000080">);

          </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Same_Chars<font color="#000080">) </font><font color="#FF0000"><b>THEN
            BEGIN
              </b></font>Move<font color="#000080">(</font>Str<font color="#000080">[</font>Curr_Pos<font color="#000080">+</font>Limit_In_A_Row<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">], </font>Str<font color="#000080">[</font>Curr_Pos<font color="#000080">],
                                </font>Length<font color="#000080">(</font>Str<font color="#000080">)-(</font>Curr_Pos<font color="#000080">+</font>Limit_In_A_Row<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">));
              </font>Dec<font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>Pred<font color="#000080">(</font>Limit_In_A_Row<font color="#000080">));
            </font><font color="#FF0000"><b>END
          ELSE </b></font>Inc<font color="#000080">(</font>Curr_Pos<font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{while}

  </i></font>Delete_Duplicate_Chars_In_Str <font color="#000080">:= </font>Str<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{delete_duplicate_chars_in_str}

{*
       Note that &quot;Count&quot; is the number of *WORDS* to fill.  So e.g. you'd
use &quot;FillWord(My_Int_Array, SizeOf(My_Int_Array) DIV 2, 1);&quot;
      by Neil Rubenking *}
{**************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>FillWord<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Dest<font color="#000080">; </font>Count<font color="#000080">, </font>What <font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>ASM
    </b></font><font color="#FF00FF">LES DI, Dest    </font><font color="#008000"><i>{ES:DI points to destination}
    </i></font><font color="#FF00FF">MOV CX, Count   </font><font color="#008000"><i>{count in CX}
    </i></font><font color="#FF00FF">MOV AX, What    </font><font color="#008000"><i>{word to fill with in AX}
    </i></font><font color="#FF00FF">CLD             </font><font color="#008000"><i>{forward direction}
    </i></font><font color="#FF00FF">REP STOSW       </font><font color="#008000"><i>{perform the fill}
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{fillWord}

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">. </font><font color="#008000"><i>{unit str_stf}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0081.PAS">Original</a><b>]</b></p></body>
</html>
