<html>
<head><title> "Excellent Strings Unit for TP" by JOHAN LARSSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0137.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ EFLIB | Extended Function Library (C) Johan Larsson, 1992 - 1997
          All rights reserved. E-mail to jola@ts.umu.se.

          FREE STRING ROUTINE UNIT - SWAG RELEASE, June 1997.

  --------
  SYNOPSIS
  --------
  This is some of the string routines in an early release of EFLIB,
  the application framework for Borland Pascal with full OOP design.
  These routines are donated to the public domain and may freely be
  used, modified and distributed - in any way.

  THERE IS NO WARRANTY TO GO WITH THIS FREE STRING UNIT, NOR IS
  ANY SUPPORT AVAILABLE FOR THESE PROCEDURES.

  -------------------
  ABOUT EFLIB STRINGS
  -------------------
  This unit is donated to the public domain since EFLIB contains
  a 100% OO string engine, introduced in release 3 of EFLIB. This
  engine features sophisticated text structures, dynamic allocations,
  pattern matching, search algorithms (Boyer-Moore as well as KMP),
  extended text tokens, hyper strings, formatted strings and so on ...


  **********************************************************************
  |                                                                    |
  |  This program is DEVELOPED WITH EFLIB. EFLIB is a SOPHISTICATED    |
  |  OBJECT ORIENTED TOOLKIT for Borland Pascal. EFLIB contains        |
  |  hundreds of features, including ...                               |
  |                                                                    |
  |    o  Classic data structures       o  Data streams (in-/output)   |
  |    o  Full GUI                      o  Mathematics (matrixes, etc) |
  |    o  Windows, browsers, editors    o  Text handling               |
  |                                                                    |
  |  EFLIB combines the flexibility of the Borland C++ Class Library   |
  |  with features similar to Borland Turbo Vision.                    |
  |                                                                    |
  |  You can DOWNLOAD EFLIB together with 1 MB of kernel SOURCE CODE   |
  |  on Internet; http://www.ts.umu.se/~jola/EFLIB/. If you have any   |
  |  questions, write an e-mail to jola@ts.umu.se.                     |
  |                                                                    |
  **********************************************************************  }


</i></font><font color="#FF0000"><b>UNIT </b></font>FREESTRI<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

type </b></font>tCharSet <font color="#000080">= </font><font color="#FF0000"><b>set of </b></font>char<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>BackwardPos <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>CountPos <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Count <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>ForwardPos <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>IsCharactersInString <font color="#000080">(</font>Chars <font color="#000080">: </font>tCharSet<font color="#000080">; </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>IsInString <font color="#000080">(</font>SubString <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>Occurrence <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>Replace <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Data<font color="#000080">, </font>SubString1<font color="#000080">, </font>SubString2 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SearchPos <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringBackwardPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringCentered <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringCountPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Count <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringDoubled <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringFill <font color="#000080">(</font>Count <font color="#000080">: </font>byte<font color="#000080">; </font>SubString <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringFixed <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>FixedLength <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringFixedCentered <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>FixedLength <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringFixedRight <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>FixedLength <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringForwardPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringOccurrence <font color="#000080">(</font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringReplace <font color="#000080">(</font>Data<font color="#000080">, </font>SubString1<font color="#000080">, </font>SubString2 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringSearchPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringSpace <font color="#000080">(</font>Count <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringStripped <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StringZeroStripped <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>Fill <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Count <font color="#000080">: </font>byte<font color="#000080">; </font>SubString <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>StringRemoveLead <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Character <font color="#000080">: </font>char<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>StringRemoveTrail <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Character <font color="#000080">: </font>char<font color="#000080">);


</font><font color="#FF0000"><b>IMPLEMENTATION


</b></font><font color="#008000"><i>{ *****************************************
  *             Procedures                *
  ***************************************** }


{ Returns the position of a substring, beginning at specified position and
  searching forward }
</i></font><font color="#FF0000"><b>function </b></font>ForwardPos <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Position <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font>StartPosition <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>StartPosition <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
     </font>Position <font color="#000080">:= </font>Pos <font color="#000080">(</font>SubString<font color="#000080">, </font>Copy <font color="#000080">(</font>Data<font color="#000080">, </font>StartPosition<font color="#000080">, </font>Length<font color="#000080">(</font>Data<font color="#000080">) - </font>StartPosition <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">));
     </font><font color="#FF0000"><b>if </b></font>Position <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>ForwardPos <font color="#000080">:= </font>Pred<font color="#000080">(</font>Position <font color="#000080">+ </font>StartPosition<font color="#000080">)
        </font><font color="#FF0000"><b>else </b></font>ForwardPos <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{ Not found }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns the position of a substring, beginning at specified position and
  searching forward }
</i></font><font color="#FF0000"><b>function </b></font>StringForwardPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>StringForwardPos <font color="#000080">:= </font>ForwardPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data<font color="#000080">, </font>StartPosition<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns the position of a substring, beginning at specified position and
  searching backward }
</i></font><font color="#FF0000"><b>function </b></font>BackwardPos <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font>StartPosition <font color="#000080">&gt; </font>Length<font color="#000080">(</font>Data<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>StartPosition <font color="#000080">:= </font>Length<font color="#000080">(</font>Data<font color="#000080">);
     </font>BackwardPos <font color="#000080">:= </font>Pos <font color="#000080">(</font>SubString<font color="#000080">, </font>Copy <font color="#000080">(</font>Data<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>StartPosition<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns the position of a substring, beginning at specified position and
  searching backward }
</i></font><font color="#FF0000"><b>function </b></font>StringBackwardPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>StringBackwardPos <font color="#000080">:= </font>BackwardPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data<font color="#000080">, </font>StartPosition<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns the position of a character closests to a certain position }
</i></font><font color="#FF0000"><b>function </b></font>SearchPos <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>ForwardIndex<font color="#000080">, </font>BackwardIndex <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>ForwardIndex  <font color="#000080">:= </font>ForwardPos  <font color="#000080">(</font>SubString<font color="#000080">, </font>Data<font color="#000080">, </font>StartPosition<font color="#000080">);
     </font>BackwardIndex <font color="#000080">:= </font>BackwardPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data<font color="#000080">, </font>StartPosition<font color="#000080">);
     </font><font color="#008000"><i>{ Return the position to the closest found substring }
     </i></font><font color="#FF0000"><b>if </b></font>StartPosition<font color="#000080">-</font>ForwardIndex <font color="#000080">&gt;= </font>BackwardIndex<font color="#000080">-</font>StartPosition <font color="#FF0000"><b>then
        </b></font>SearchPos <font color="#000080">:= </font>ForwardIndex <font color="#FF0000"><b>else </b></font>SearchPos <font color="#000080">:= </font>BackwardIndex<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns the position of a character closests to a certain position }
</i></font><font color="#FF0000"><b>function </b></font>StringSearchPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartPosition <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>StringSearchPos <font color="#000080">:= </font>SearchPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data<font color="#000080">, </font>StartPosition<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns the position of a numbered substring in a string (for example,
  if Count is set to two, the position of the second location of the substring
  is returned). }
</i></font><font color="#FF0000"><b>function </b></font>CountPos <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Count <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Index <font color="#000080">: </font>integer<font color="#000080">; </font>Position <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>Position <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{ Reset search position }
     </i></font><font color="#FF0000"><b>for </b></font>Index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Count <font color="#FF0000"><b>do
         </b></font>Position <font color="#000080">:= </font>ForwardPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data<font color="#000080">, </font>Succ<font color="#000080">(</font>Position<font color="#000080">));
     </font>CountPos <font color="#000080">:= </font>Position<font color="#000080">; </font><font color="#008000"><i>{ Zero if not found }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns the position of a numbered substring in a string (for example,
  if Count is set to two, the position of the second location of the substring
  is returned). }
</i></font><font color="#FF0000"><b>function </b></font>StringCountPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Count <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>StringCountPos <font color="#000080">:= </font>CountPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data<font color="#000080">, </font>Count<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns the number of occurrences of a substring inside a string }
</i></font><font color="#FF0000"><b>function </b></font>Occurrence <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Count<font color="#000080">, </font>Position <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>{ Reset position and counter }
     </i></font>Position <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>Count    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#008000"><i>{ Search for substring and go forward if one is found }
     </i></font><font color="#FF0000"><b>repeat
           </b></font>Position <font color="#000080">:= </font>ForwardPos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data<font color="#000080">, </font>Succ<font color="#000080">(</font>Position<font color="#000080">));
           </font><font color="#FF0000"><b>if </b></font>Position <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Inc <font color="#000080">(</font>Count<font color="#000080">);
     </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>Position <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
     </font>Occurrence <font color="#000080">:= </font>Count<font color="#000080">; </font><font color="#008000"><i>{ Return number of occurrences }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns the number of occurrences of a substring inside a string }
</i></font><font color="#FF0000"><b>function </b></font>StringOccurrence <font color="#000080">(</font>SubString<font color="#000080">, </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>StringOccurrence <font color="#000080">:= </font>Occurrence <font color="#000080">(</font>SubString<font color="#000080">, </font>Data<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns TRUE if substring is found inside string }
</i></font><font color="#FF0000"><b>function </b></font>IsInString <font color="#000080">(</font>SubString <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>IsInString <font color="#000080">:= (</font>Pos <font color="#000080">(</font>SubString<font color="#000080">, </font>Data<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns TRUE if any character in specified set is found inside string }
</i></font><font color="#FF0000"><b>function </b></font>IsCharactersInString <font color="#000080">(</font>Chars <font color="#000080">: </font>tCharSet<font color="#000080">; </font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Index <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>IsCharactersInString <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#008000"><i>{ Assume that no character is found }
     </i></font><font color="#FF0000"><b>for </b></font>Index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Data<font color="#000080">) </font><font color="#FF0000"><b>do
         if </b></font>Data<font color="#000080">[</font>Index<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>Chars <font color="#FF0000"><b>then begin
            </b></font><font color="#008000"><i>{ Character in set found - break }
            </i></font>IsCharactersInString <font color="#000080">:= </font>TRUE<font color="#000080">;
            </font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Replaces a sub-string in a string with another sub-string }
</i></font><font color="#FF0000"><b>function </b></font>Replace <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Data<font color="#000080">, </font>SubString1<font color="#000080">, </font>SubString2 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Index<font color="#000080">, </font>Position <font color="#000080">: </font>integer<font color="#000080">; </font>TempString <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>{ Reset index variable and clear temporary string }
     </i></font>Index <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>TempString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
     </font><font color="#FF0000"><b>while </b></font>Index <font color="#000080">&lt; </font>Length<font color="#000080">(</font>Data<font color="#000080">) </font><font color="#FF0000"><b>do begin
           </b></font>Inc <font color="#000080">(</font>Index<font color="#000080">); </font><font color="#008000"><i>{ Go forward one step }
           </i></font>Position <font color="#000080">:= </font>ForwardPos <font color="#000080">(</font>SubString1<font color="#000080">, </font>Data<font color="#000080">, </font>Index<font color="#000080">);
           </font><font color="#008000"><i>{ Copy data if not search string found }
           </i></font><font color="#FF0000"><b>if </b></font>Index <font color="#000080">&lt;&gt; </font>Position <font color="#FF0000"><b>then </b></font>TempString <font color="#000080">:= </font>TempString <font color="#000080">+ </font>Data<font color="#000080">[</font>Index<font color="#000080">]
              </font><font color="#FF0000"><b>else begin
                   </b></font><font color="#008000"><i>{ Replace SubString1 with SubString2 }
                   </i></font>TempString <font color="#000080">:= </font>TempString <font color="#000080">+ </font>SubString2<font color="#000080">;
                   </font>Index <font color="#000080">:= </font>Position <font color="#000080">+ </font>Pred<font color="#000080">(</font>Length <font color="#000080">(</font>SubString1<font color="#000080">));
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>Replace <font color="#000080">:= </font>TempString<font color="#000080">; </font><font color="#008000"><i>{ Return replaced string }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Replaces a sub-string in a string with another sub-string }
</i></font><font color="#FF0000"><b>function </b></font>StringReplace <font color="#000080">(</font>Data<font color="#000080">, </font>SubString1<font color="#000080">, </font>SubString2 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>StringReplace <font color="#000080">:= </font>Replace <font color="#000080">(</font>Data<font color="#000080">, </font>SubString1<font color="#000080">, </font>SubString2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{ Generates a string filled with specified number of copies of the
  specified substring. }
</i></font><font color="#FF0000"><b>procedure </b></font>Fill <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Count <font color="#000080">: </font>byte<font color="#000080">; </font>SubString <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>Index <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>Data <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; </font><font color="#008000"><i>{ Clear data string }
     </i></font><font color="#FF0000"><b>if </b></font>Length<font color="#000080">(</font>SubString<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then begin
        </b></font><font color="#008000"><i>{ Use memory filling if data is a character }
        </i></font><font color="#FF0000"><b>if </b></font>Count <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>FillChar <font color="#000080">(</font>Data<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Count<font color="#000080">, </font>Ord<font color="#000080">(</font>SubString<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]));
        </font>Data<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Count<font color="#000080">); </font><font color="#008000"><i>{ Set string length }
     </i></font><font color="#FF0000"><b>end else for </b></font>Index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Count <font color="#FF0000"><b>do </b></font>Data <font color="#000080">:= </font>Data <font color="#000080">+ </font>SubString<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Generates a string filled with specified number of copies of the
  specified substring. }
</i></font><font color="#FF0000"><b>function </b></font>StringFill <font color="#000080">(</font>Count <font color="#000080">: </font>byte<font color="#000080">; </font>SubString <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>TempString <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>{ Avoid overlap of filling - use temporary string for filling }
     </i></font>Fill <font color="#000080">(</font>TempString<font color="#000080">, </font>Count<font color="#000080">, </font>SubString<font color="#000080">);
     </font>StringFill <font color="#000080">:= </font>TempString<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Generates a string containing specified number of blank spaces }
</i></font><font color="#FF0000"><b>function </b></font>StringSpace <font color="#000080">(</font>Count <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>StringSpace <font color="#000080">:= </font>StringFill <font color="#000080">(</font>Count<font color="#000080">, </font><font color="#800000">#32</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Removes all leading characters in string }
</i></font><font color="#FF0000"><b>procedure </b></font>StringRemoveLead <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Character <font color="#000080">: </font>char<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>Length <font color="#000080">: </font>byte <font color="#FF0000"><b>absolute </b></font>Data<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>{ Delete all leading characters }
     </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Data<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font>Character<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Length <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Delete <font color="#000080">(</font>Data<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Removes all trailing characters in string }
</i></font><font color="#FF0000"><b>procedure </b></font>StringRemoveTrail <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Character <font color="#000080">: </font>char<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>Length <font color="#000080">: </font>byte <font color="#FF0000"><b>absolute </b></font>Data<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>{ Delete all trailing characters }
     </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Data<font color="#000080">[</font>Length<font color="#000080">] = </font>Character<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Length <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Dec <font color="#000080">(</font>Length<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Removes blank spaces before and after text inside a string }
</i></font><font color="#FF0000"><b>function </b></font>StringStripped <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>{ Delete all leading and trailing spaces }
     </i></font>StringRemoveLead <font color="#000080">(</font>Data<font color="#000080">, </font><font color="#800000">#32</font><font color="#000080">);
     </font>StringRemoveTrail <font color="#000080">(</font>Data<font color="#000080">, </font><font color="#800000">#32</font><font color="#000080">);
     </font><font color="#008000"><i>{ Return stripped string }
     </i></font>StringStripped <font color="#000080">:= </font>Data<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Removes leading and trailing zeroes from a text string }
</i></font><font color="#FF0000"><b>function </b></font>StringZeroStripped <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>{ Delete all leading and trailing zeroes }
     </i></font>StringRemoveLead <font color="#000080">(</font>Data<font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">);
     </font>StringRemoveTrail <font color="#000080">(</font>Data<font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">);
     </font><font color="#008000"><i>{ Remove comma signs or add one leading zero if comma first in string }
     </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Data<font color="#000080">[</font>Length<font color="#000080">(</font>Data<font color="#000080">)] = </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Delete <font color="#000080">(</font>Data<font color="#000080">, </font>Length<font color="#000080">(</font>Data<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{ Delete last character }
     </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Data<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Data <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>Data<font color="#000080">;
     </font>StringZeroStripped <font color="#000080">:= </font>Data<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Centers text inside a string }
</i></font><font color="#FF0000"><b>function </b></font>StringCentered <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>FixSpace<font color="#000080">, </font>StrippedStr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>StartLength <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>StrippedStr <font color="#000080">:= </font>StringStripped<font color="#000080">(</font>Data<font color="#000080">); </font><font color="#008000"><i>{ Removes leading and trailing spaces }
     { Calculate number of spaces available for centering }
     </i></font>FixSpace    <font color="#000080">:= </font>StringSpace<font color="#000080">((</font>Length<font color="#000080">(</font>Data<font color="#000080">) - </font>Length<font color="#000080">(</font>StrippedStr<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
     </font>StartLength <font color="#000080">:= </font>Length<font color="#000080">(</font>Data<font color="#000080">);
     </font>Data        <font color="#000080">:= </font>FixSpace <font color="#000080">+ </font>StrippedStr <font color="#000080">+ </font>FixSpace<font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>Length<font color="#000080">(</font>Data<font color="#000080">) &lt;  </font>StartLength <font color="#FF0000"><b>then </b></font>Data <font color="#000080">:= </font>Chr<font color="#000080">(</font><font color="#800000">32</font><font color="#000080">) + </font>Data<font color="#000080">;
     </font>StringCentered <font color="#000080">:= </font>Data<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Fixes the length of a string by inserting spaces or removing characters }
</i></font><font color="#FF0000"><b>function </b></font>StringFixed <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>FixedLength <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Length <font color="#000080">: </font>byte <font color="#FF0000"><b>absolute </b></font>Data<font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font><font color="#000080">(</font>Data <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Data <font color="#000080">:= </font>Copy <font color="#000080">(</font>Data<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>FixedLength<font color="#000080">);
     </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Length <font color="#000080">&lt; </font>FixedLength<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Insert <font color="#000080">(</font><font color="#800000">#32</font><font color="#000080">, </font>Data<font color="#000080">, </font>Succ<font color="#000080">(</font>Length<font color="#000080">));
     </font>StringFixed <font color="#000080">:= </font>Data<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Centers and fixes the length of a string }
</i></font><font color="#FF0000"><b>function </b></font>StringFixedCentered <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>FixedLength <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>StringFixedCentered <font color="#000080">:= </font>StringCentered<font color="#000080">(</font>StringFixed<font color="#000080">(</font>Data<font color="#000080">, </font>FixedLength<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Right justifies and fixes the length of a string }
</i></font><font color="#FF0000"><b>function </b></font>StringFixedRight <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>FixedLength <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font>FixedLength <font color="#000080">&gt;= </font>Length<font color="#000080">(</font>Data<font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>StringFixedRight <font color="#000080">:= </font>StringSpace <font color="#000080">(</font>FixedLength <font color="#000080">- </font>Length<font color="#000080">(</font>Data<font color="#000080">)) + </font>Data
     <font color="#FF0000"><b>else </b></font>StringFixedRight <font color="#000080">:= </font>StringFixed <font color="#000080">(</font>Data<font color="#000080">, </font>FixedLength<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Inserts one blank space between each character inside string }
</i></font><font color="#FF0000"><b>function </b></font>StringDoubled <font color="#000080">(</font>Data <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Index <font color="#000080">: </font>byte<font color="#000080">; </font>TempString <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>TempString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>Index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Data<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>TempString <font color="#000080">:= </font>TempString <font color="#000080">+ </font>Data<font color="#000080">[</font>Index<font color="#000080">] + </font><font color="#800000">#32</font><font color="#000080">;
     </font>StringDoubled <font color="#000080">:= </font>Copy <font color="#000080">(</font>TempString<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pred<font color="#000080">(</font>Length<font color="#000080">(</font>TempString<font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">. </font><font color="#008000"><i>{ unit }

{ (C) Johan Larsson, 1992 - 1997. Donated to the public domain. No warranty. }</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0137.PAS">Original</a><b>]</b></p></body>
</html>
