<html>
<head><title> "WILDCRD1.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>wild_card<font color="#000080">;

</font><font color="#FF0000"><b>Var
   </b></font>check<font color="#000080">:</font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Wild<font color="#000080">(</font>flname<font color="#000080">,</font>card<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{Returns True if the wildcard description in 'card' matches 'flname'
according to Dos wildcard principles.  The 'card' String MUST have a period!
Example: Wild('test.tat','t*.t?t' returns True}

</i></font><font color="#FF0000"><b>Var
   </b></font>name<font color="#000080">,</font>temp<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
   </font>c<font color="#000080">:</font>Char<font color="#000080">;
   </font>p<font color="#000080">,</font>i<font color="#000080">,</font>n<font color="#000080">,</font>l<font color="#000080">:</font>Byte<font color="#000080">;
   </font>period<font color="#000080">:</font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
    </b></font>wild<font color="#000080">:=</font>True<font color="#000080">;
    </font><font color="#008000"><i>{test For special Case first}
    </i></font><font color="#FF0000"><b>if </b></font>flname<font color="#000080">=</font><font color="#800000">'*.*' </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
    </font>wild<font color="#000080">:=</font>False<font color="#000080">;
    </font>p<font color="#000080">:=</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>card<font color="#000080">);
    </font>i<font color="#000080">:=</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>flname<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>p <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>period<font color="#000080">:=</font>True <font color="#FF0000"><b>else </b></font>Exit<font color="#000080">; </font><font color="#008000"><i>{not a valid wildcard if no period}
    </i></font>N<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
       if </b></font>card<font color="#000080">[</font>n<font color="#000080">]=</font><font color="#800000">'*' </font><font color="#FF0000"><b>then </b></font>n<font color="#000080">:=</font>p<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>else
        if </b></font><font color="#000080">(</font>upCase<font color="#000080">(</font>flname<font color="#000080">[</font>n<font color="#000080">]) &lt;&gt; </font>upCase<font color="#000080">(</font>card<font color="#000080">[</font>n<font color="#000080">])) </font><font color="#FF0000"><b>then
         if </b></font>card<font color="#000080">[</font>n<font color="#000080">]&lt;&gt;</font><font color="#800000">'?' </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
                </font>inc<font color="#000080">(</font>n<font color="#000080">);
    </font><font color="#FF0000"><b>Until </b></font>n<font color="#000080">&gt;=</font>p<font color="#000080">;
    </font>n<font color="#000080">:=</font>p<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{one position past the period of the wild card}
    </i></font>l<font color="#000080">:=</font>length<font color="#000080">(</font>flname<font color="#000080">);
    </font>inc<font color="#000080">(</font>i<font color="#000080">); </font><font color="#008000"><i>{one position past the period of the Filename}
    </i></font><font color="#FF0000"><b>Repeat
    if </b></font>n <font color="#000080">&gt; </font>length<font color="#000080">(</font>card<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
    </font>c<font color="#000080">:=</font>upCase<font color="#000080">(</font>card<font color="#000080">[</font>n<font color="#000080">]);
         </font><font color="#FF0000"><b>if </b></font>c<font color="#000080">=</font><font color="#800000">'*' </font><font color="#FF0000"><b>then </b></font>i<font color="#000080">:=</font>l<font color="#000080">+</font><font color="#800000">1 </font><font color="#008000"><i>{in order to end the loop}
          </i></font><font color="#FF0000"><b>else
             if </b></font><font color="#000080">(</font>upCase<font color="#000080">(</font>flname<font color="#000080">[</font>i<font color="#000080">]) = </font>c<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>c <font color="#000080">= </font><font color="#800000">'?'</font><font color="#000080">) </font><font color="#FF0000"><b>then
                begin
                </b></font>inc<font color="#000080">(</font>n<font color="#000080">);
                </font>inc<font color="#000080">(</font>i<font color="#000080">);
                </font><font color="#FF0000"><b>end
             else </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>Until </b></font>i <font color="#000080">&gt; </font>l<font color="#000080">;

    </font>wild<font color="#000080">:=</font>True<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>check<font color="#000080">:=</font>False<font color="#000080">;
  </font>check<font color="#000080">:=</font>wild<font color="#000080">(</font><font color="#800000">'TEST.Tat'</font><font color="#000080">,</font><font color="#800000">'T*.T?T'</font><font color="#000080">); </font><font color="#008000"><i>{True}
  </i></font>Writeln<font color="#000080">(</font>check<font color="#000080">);
  </font>check<font color="#000080">:=</font>wild<font color="#000080">(</font><font color="#800000">'TEST.Taq'</font><font color="#000080">,</font><font color="#800000">'T*.T?T'</font><font color="#000080">);  </font><font color="#008000"><i>{False}
  </i></font>Writeln<font color="#000080">(</font>check<font color="#000080">);
  </font>check<font color="#000080">:=</font>wild<font color="#000080">(</font><font color="#800000">'12345678.pkt'</font><font color="#000080">,</font><font color="#800000">'*.pkt'</font><font color="#000080">); </font><font color="#008000"><i>{True}
  </i></font>Writeln<font color="#000080">(</font>check<font color="#000080">);
  </font>check<font color="#000080">:=</font>wild<font color="#000080">(</font><font color="#800000">'test.tat'</font><font color="#000080">,</font><font color="#800000">'T*.t?'</font><font color="#000080">);  </font><font color="#008000"><i>{False}
  </i></font>Writeln<font color="#000080">(</font>check<font color="#000080">);
  </font>check<font color="#000080">:=</font>wild<font color="#000080">(</font><font color="#800000">'12345678.pkt'</font><font color="#000080">,</font><font color="#800000">'1234?678.*'</font><font color="#000080">); </font><font color="#008000"><i>{True}
  </i></font>Writeln<font color="#000080">(</font>check<font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p></body>
</html>
