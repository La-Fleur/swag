<html>
<head><title> "Removing Spaces" by BOB SWART</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0116.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>TrimStr<font color="#000080">;
</font><font color="#008000"><i>{$B-}
{
     File: TrimStr
   Author: Bob Swart [100434,2072]
  Purpose: routines for removing leading/trailing spaces from strings,
           and to take parts of left/right of string (a la Basic).
  Version: 2.0

  LTrim()    - Remove all spaces from the left side of a string
  RTrim()    - Remove all spaces from the right side of a string
  Trim()     - Remove all extraneous spaces from a string
  RightStr() - Take a certain portion of the right side of a string
  LeftStr()  - Take a certain portion of the left side of a string
  MidStr()   - Take the middle portion of a string

}
</i></font><font color="#FF0000"><b>interface
Const
  </b></font>Space <font color="#000080">= </font><font color="#800000">#$20</font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>LTrim<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>RTrim<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>Trim<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">):  </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>RightStr<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Size<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>LeftStr<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Size<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>MidStr<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Size<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

  function </b></font>LTrim<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>len<font color="#000080">: </font>Byte <font color="#FF0000"><b>absolute </b></font>Str<font color="#000080">;
      </font>i<font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>len<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">] = </font>Space<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font>LTrim <font color="#000080">:= </font>Copy<font color="#000080">(</font>Str<font color="#000080">,</font>i<font color="#000080">,</font>len<font color="#000080">)
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{LTrim}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>RTrim<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>len<font color="#000080">: </font>Byte <font color="#FF0000"><b>absolute </b></font>Str<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    while </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>len<font color="#000080">] = </font>Space<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Dec<font color="#000080">(</font>len<font color="#000080">);
    </font>RTrim <font color="#000080">:= </font>Str
  <font color="#FF0000"><b>end </b></font><font color="#008000"><i>{RTrim}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>Trim<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Trim <font color="#000080">:= </font>LTrim<font color="#000080">(</font>RTrim<font color="#000080">(</font>Str<font color="#000080">))
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{Trim}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>RightStr<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Size<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>len<font color="#000080">: </font>Byte <font color="#FF0000"><b>absolute </b></font>Str<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>Size <font color="#000080">&gt; </font>len <font color="#FF0000"><b>then </b></font>Size <font color="#000080">:= </font>len<font color="#000080">;
    </font>RightStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>Str<font color="#000080">,</font>len<font color="#000080">-</font>Size<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Size<font color="#000080">)
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{RightStr}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>LeftStr<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Size<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>LeftStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>Str<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Size<font color="#000080">)
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{LeftStr}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>MidStr<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Size<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>len<font color="#000080">: </font>Byte <font color="#FF0000"><b>absolute </b></font>Str<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>Size <font color="#000080">&gt; </font>len <font color="#FF0000"><b>then </b></font>Size <font color="#000080">:= </font>len<font color="#000080">;
    </font>MidStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>Str<font color="#000080">,((</font>len <font color="#000080">- </font>Size<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font>Size<font color="#000080">)
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{MidStr}</i></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0116.PAS">Original</a><b>]</b></p></body>
</html>
