<html>
<head><title> "String Centering" by GUY MCLOUGHLIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
===========================================================================
 BBS: Canada Remote Systems
Date: 06-25-93 (13:52)             Number: 25767
From: GUY MCLOUGHLIN               Refer#: NONE
  To: CHRIS PRIEDE                  Recvd: NO
Subj: STRING CENTERING ROUTINES      Conf: (552) R-TP
---------------------------------------------------------------------------

  Hi, Chris:

CP&gt;Ideally such function should be written in assembly, but since this
CP&gt;is Pascal conference and I've flooded it with my assembly code enough
CP&gt;lately, we will use plain Turbo Pascal.

  Try running this program using your routine and the one I posted,
  you might notice something &quot;funny&quot; about the ouput displayed. &lt;g&gt;
*)

{$A+,B-,D-,E-,F-,G-,I-,L-,N-,O-,P-,Q-,R-,S-,T-,V-,X+}
{$M 1024,0,0}

</i></font><font color="#FF0000"><b>program </b></font>DemoStringRoutines<font color="#000080">;

</font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>FCenter<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>W<font color="#000080">: </font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>SpaceCnt<font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>Length<font color="#000080">(</font>S<font color="#000080">) &lt; </font>W <font color="#FF0000"><b>then
      begin
        </b></font>SpaceCnt <font color="#000080">:= (</font>W <font color="#000080">- </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
        </font>Move<font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">+</font>SpaceCnt<font color="#000080">], </font>Length<font color="#000080">(</font>S<font color="#000080">));
        </font>FillChar<font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>SpaceCnt<font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">);
        </font>S<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">) + </font>SpaceCnt<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>FCenter <font color="#000080">:= </font>S<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

              </font><font color="#008000"><i>(* Set these constants according to your needs.         *)
  </i></font><font color="#FF0000"><b>const
    </b></font>BlankChar   <font color="#000080">= </font><font color="#800000">'-'</font><font color="#000080">;
    </font>ScreenWidth <font color="#000080">= </font><font color="#800000">80</font><font color="#000080">;

    </font><font color="#008000"><i>(***** Create video-display string with input string centered.    *)
    (*                                                                *)
    </i></font><font color="#FF0000"><b>function </b></font>CenterVidStr<font color="#000080">(</font><font color="#008000"><i>{input} </i></font>InText <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#008000"><i>{output} </i></font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>InsertPos <font color="#000080">: </font>byte<font color="#000080">;
      </font>TempStr   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>begin
              </b></font><font color="#008000"><i>(* Initialize TempStr.                                  *)
      </i></font>TempStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(</font>ScreenWidth<font color="#000080">);
      </font>fillchar<font color="#000080">(</font>TempStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>ScreenWidth<font color="#000080">, </font>BlankChar<font color="#000080">);

              </font><font color="#008000"><i>(* Calculate string insertion position.                 *)
      </i></font>InsertPos <font color="#000080">:= </font>succ<font color="#000080">((</font>ScreenWidth <font color="#000080">- </font>length<font color="#000080">(</font>InText<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);

              </font><font color="#008000"><i>(* Insert text in the center of TempStr.                *)
      </i></font>move<font color="#000080">(</font>InText<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>TempStr<font color="#000080">[</font>InsertPos<font color="#000080">], </font>length<font color="#000080">(</font>InText<font color="#000080">));

              </font><font color="#008000"><i>(* Return function result.                              *)
      </i></font>CenterVidStr <font color="#000080">:= </font>TempStr

    <font color="#FF0000"><b>end</b></font><font color="#000080">;      </font><font color="#008000"><i>(* CenterVidStr.                                        *)

</i></font><font color="#FF0000"><b>var
  </b></font>TempStr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>Clrscr<font color="#000080">;
  </font>fillchar<font color="#000080">(</font>TempStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font><font color="#800000">30</font><font color="#000080">, </font><font color="#800000">'X'</font><font color="#000080">);
  </font>TempStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#30</font><font color="#000080">;
  </font>writeln<font color="#000080">(</font>FCenter<font color="#000080">(</font>TempStr<font color="#000080">, </font><font color="#800000">80</font><font color="#000080">));
  </font>writeln<font color="#000080">(</font>CenterVidStr<font color="#000080">(</font>TempStr<font color="#000080">))
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

  ...</font>I tried timing these two routines <font color="#FF0000"><b>on </b></font>my PC <font color="#000080">(</font>Recently upgraded
  <font color="#FF0000"><b>to </b></font>a <font color="#800000">386</font>dx<font color="#000080">-</font><font color="#800000">40 </font>AMD motherboard<font color="#000080">), </font><font color="#FF0000"><b>and </b></font>here are the results<font color="#000080">:

 </font>Compiler <font color="#000080">&sup3; </font>Length <font color="#000080">&sup3; </font>Your routine <font color="#000080">&sup3; </font>My routine <font color="#000080">&sup3; </font>Ratio
<font color="#000080">&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Aring;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Aring;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Aring;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Aring;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
 </font>TP <font color="#800000">7     </font><font color="#000080">&sup3;   </font><font color="#800000">30   </font><font color="#000080">&sup3;    </font><font color="#800000">0.03167   </font><font color="#000080">&sup3;   </font><font color="#800000">0.04043  </font><font color="#000080">&sup3; </font><font color="#800000">1.28
</font><font color="#000080">&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Aring;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Aring;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Aring;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Aring;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
 </font><font color="#FF0000"><b>PASCAL</b></font><font color="#000080">+  &sup3;   </font><font color="#800000">30   </font><font color="#000080">&sup3;    </font><font color="#800000">0.02037   </font><font color="#000080">&sup3;   </font><font color="#800000">0.01959  </font><font color="#000080">&sup3; </font><font color="#800000">0.96

 </font><font color="#000080">*** </font>Both functions were called <font color="#FF0000"><b>in </b></font>a loop <font color="#800000">1000 </font>times <font color="#FF0000"><b>on </b></font>each run<font color="#000080">,
     </font>result was discarded <font color="#000080">(</font><font color="#800000">$</font>X<font color="#000080">+ </font>directive<font color="#000080">).

 </font><font color="#FF0000"><b>For </b></font>curiosity sake I<font color="#800000">'ll post the StonyBrook PASCAL+ machine-code
 </font>listing <font color="#FF0000"><b>in </b></font>the next <font color="#FF0000"><b>message</b></font><font color="#000080">.
                               - </font>Guy
<font color="#000080">---
 &thorn; </font>DeLuxe<font color="#000080">&yacute;/</font><font color="#800000">386 1.25 #5060 </font><font color="#000080">&thorn;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to STRINGS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p></body>
</html>
