<html>
<head><title> "Dialogs in TVision" by KEN BURROWS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;&gt;&gt; In a Turbo Vision DIALOG form, how do you (re)select the FIRST editable
&gt;&gt;&gt; data field FROM ANYWHERES IN the DIALOG?

&gt;&gt; You don't select it. You let IT select itself. Since all the views
&gt;&gt; inserted into the dialog are descendents of TView, then they all
&gt;&gt; have a select method.

&gt; Nice Idea, too bad it's not that simple 8-(

It rarely is with TV.
}
</i></font><font color="#FF0000"><b>Program </b></font>SelectAView_2<font color="#000080">; </font><font color="#008000"><i>{tested. The only thing this does, is work}

   { If you want to have an object select itself, without haveing
     to explicitly define itself first, you must begin with an
     object that KNOWS how to select itself.
     Since Select is a method of the TView object, any descendent
     will know how.

     A method is then needed by the object,
     that contains the object that must select itself,
     to get its, request that it select itself
     to the object that must select itself.

     Use the evBroadcast event.

     The object, that contain the object that must select itself,
     generates a broadcast event onto it's event tree. (random shot
     in the dark) This broadcast, requests that any object that
     is set to select itself on the events command, should accept the
     broadcast.... , and then select itself.

     This is accomplished by taking your last instance definition
     of a object that you are inserting into your event queue and
     descending it once more to overide its HandleEvent method.

     In my example, I've used a simple TDialog and inserted a
     bunch of of TInputLine's and a TButton that generates an
     EvCommand of 'SelectFirst', and descended the HandleEvent
     to generate a evBroadCast event, to broadcast the SelectFirst
     Command.

     The TinputLine descendent, TMyLine, is directly descended
     from the type of object that I am linking into this TDialog
     objects event queue.

     Within a 'For i = 1 to 4' Loop, the TDialogs constructor
     will insert a TMyLine type, that will select itself whenever
     an evBroadCast event, broadcasts a SelectFirst command.

     As long as this object is a descendent of a TView, the
     TDialog will accept it, and treat like any other object.

     A TButton is installed to provide a method of generating
     an evBroadCast event that broadcasts a SelectFirst command.
   }


</i></font><font color="#FF0000"><b>uses </b></font>Objects<font color="#000080">,</font>App<font color="#000080">,</font>Dialogs<font color="#000080">,</font>Views<font color="#000080">,</font>Drivers<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>MyDlg <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
            </font><font color="#FF0000"><b>constructor </b></font>init<font color="#000080">;
            </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>MyLine <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TInputLine<font color="#000080">)
             </font>Selector <font color="#000080">: </font>Word<font color="#000080">;
             </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>bounds<font color="#000080">:</font>Trect<font color="#000080">;</font>AMaxLen<font color="#000080">:</font>Integer<font color="#000080">;
                              </font>SelectKey<font color="#000080">:</font>Word<font color="#000080">);
             </font><font color="#FF0000"><b>Procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>PMyLine <font color="#000080">= ^</font>MyLine<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>SelectFirst <font color="#000080">= </font><font color="#800000">1000</font><font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>MyLine<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>bounds<font color="#000080">:</font>Trect<font color="#000080">;</font>AMaxLen<font color="#000080">:</font>Integer<font color="#000080">;
                        </font>SelectKey<font color="#000080">:</font>Word<font color="#000080">);
   </font><font color="#FF0000"><b>Begin
     Inherited </b></font>Init<font color="#000080">(</font>Bounds<font color="#000080">,</font>AMaxLen<font color="#000080">);
     </font>EventMask <font color="#000080">:= </font>EventMask <font color="#FF0000"><b>or </b></font>evBroadcast<font color="#000080">;
     </font>Selector <font color="#000080">:= </font>SelectKey<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>MyLine<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">);
   </font><font color="#FF0000"><b>Begin
     inherited </b></font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
     </font><font color="#FF0000"><b>if   </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>What <font color="#000080">= </font>EvBroadcast<font color="#000080">) </font><font color="#FF0000"><b>and
          </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>Command <font color="#000080">= </font>Selector<font color="#000080">)
     </font><font color="#FF0000"><b>then </b></font>Select<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>MyDlg<font color="#000080">.</font>Init<font color="#000080">;
   </font><font color="#FF0000"><b>var </b></font>r<font color="#000080">:</font>trect<font color="#000080">;
       </font>i<font color="#000080">:</font>integer<font color="#000080">;
   </font><font color="#FF0000"><b>Begin
     </b></font>r<font color="#000080">.</font>assign<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
     </font><font color="#FF0000"><b>inherited </b></font>init<font color="#000080">(</font>r<font color="#000080">,</font><font color="#800000">'test dialog'</font><font color="#000080">);
     </font>options <font color="#000080">:= </font>options <font color="#FF0000"><b>or </b></font>ofcentered<font color="#000080">;
     </font>getextent<font color="#000080">(</font>r<font color="#000080">);
     </font>r<font color="#000080">.</font>grow<font color="#000080">(-</font><font color="#800000">3</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">);
     </font>r<font color="#000080">.</font>b<font color="#000080">.</font>y <font color="#000080">:= </font>r<font color="#000080">.</font>a<font color="#000080">.</font>y <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
        begin
          if   </b></font>i <font color="#000080">= </font><font color="#800000">2
          </font><font color="#FF0000"><b>then </b></font>insert<font color="#000080">(</font>new<font color="#000080">(</font>PMyLine<font color="#000080">,</font>init<font color="#000080">(</font>r<font color="#000080">,</font>size<font color="#000080">.</font>x<font color="#000080">,</font>SelectFirst<font color="#000080">)))
          </font><font color="#FF0000"><b>else </b></font>insert<font color="#000080">(</font>New<font color="#000080">(</font>PInputLine<font color="#000080">,</font>init<font color="#000080">(</font>r<font color="#000080">,</font>size<font color="#000080">.</font>x<font color="#000080">)));
          </font>inc<font color="#000080">(</font>r<font color="#000080">.</font>a<font color="#000080">.</font>y<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>inc<font color="#000080">(</font>r<font color="#000080">.</font>b<font color="#000080">.</font>y<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>inc<font color="#000080">(</font>r<font color="#000080">.</font>b<font color="#000080">.</font>y<font color="#000080">);
     </font>inc<font color="#000080">(</font>r<font color="#000080">.</font>a<font color="#000080">.</font>x<font color="#000080">,(</font>size<font color="#000080">.</font>x <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">) - </font><font color="#800000">14</font><font color="#000080">);
     </font>dec<font color="#000080">(</font>r<font color="#000080">.</font>b<font color="#000080">.</font>x<font color="#000080">,(</font>size<font color="#000080">.</font>x <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">) - </font><font color="#800000">13</font><font color="#000080">);
     </font>insert<font color="#000080">(</font>new<font color="#000080">(</font>Pbutton<font color="#000080">,</font>init<font color="#000080">(</font>r<font color="#000080">,</font><font color="#800000">'~S~elect FirstLine'</font><font color="#000080">,
                             </font>SelectFirst<font color="#000080">,</font>bfdefault<font color="#000080">)));
     </font>SelectNext<font color="#000080">(</font>False<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>MyDlg<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">);
   </font><font color="#FF0000"><b>Begin
     inherited </b></font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
     </font><font color="#FF0000"><b>if   </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>What <font color="#000080">= </font>EvCommand<font color="#000080">) </font><font color="#FF0000"><b>and
          </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>Command <font color="#000080">= </font>SelectFirst<font color="#000080">)
     </font><font color="#FF0000"><b>then Message</b></font><font color="#000080">(</font>owner<font color="#000080">,</font>evBroadcast<font color="#000080">,</font>Event<font color="#000080">.</font>Command<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>a <font color="#000080">: </font>TApplication<font color="#000080">;
  </font>m <font color="#000080">: </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>PMyDlg <font color="#000080">= ^</font>MyDlg<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>m <font color="#000080">:= </font>memavail<font color="#000080">;
  </font><font color="#FF0000"><b>with </b></font>a <font color="#FF0000"><b>do
  begin
    </b></font>Init<font color="#000080">;
    </font>ExecuteDialog<font color="#000080">(</font>new<font color="#000080">(</font>PMyDlg<font color="#000080">,</font>init<font color="#000080">),</font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
    </font>done<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>memavail <font color="#000080">&lt;&gt; </font>m <font color="#FF0000"><b>then </b></font>writeln<font color="#000080">(</font><font color="#800000">'memory allocation/deallocation error'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p></body>
</html>
