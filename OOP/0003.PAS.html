<html>
<head><title> "DELAYDLG.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&plusmn;Hello.  I was toying around With TVision, trying to make derive an Object fr
&plusmn;TDialog which would be a simple 'Delay box' (i.e. a message would display, t
&plusmn;the box would cmOK itself after two seconds).  I tried a simple Delay() comm
&plusmn;in HandleEvent, which seemed to work fine, but when I held down the mouse bu
&plusmn;on the menu, it locked up and sometimes my memory manager woudl report crazy
&plusmn;error messages.  Can anyone offer a suggestion on how to do this safely?  Th
&plusmn;are certain situations when clicking an 'OK' button is just a hassle.  Thank

Try trapping the mouse events in the HandleEvent method of the dialog
box.
}

</i></font><font color="#FF0000"><b>Type
  </b></font>tDelayDialog <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>tDialog<font color="#000080">)
    </font><font color="#FF0000"><b>Procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event <font color="#000080">: </font>tEvent<font color="#000080">); </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>tDelayDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event <font color="#000080">: </font>tEvent<font color="#000080">);
</font><font color="#FF0000"><b>Const
  </b></font>cDelay <font color="#000080">= </font><font color="#800000">2000</font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Event<font color="#000080">.</font>What <font color="#FF0000"><b>and </b></font>evMouse <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>(* This filters out mouse   *)
                                      (* events before they reach *)
                                      (* the parent               *)
  </i></font><font color="#FF0000"><b>ELSE
  begin
    </b></font>Delay<font color="#000080">(</font>cDelay<font color="#000080">);
    </font>Event<font color="#000080">.</font>Command <font color="#000080">:= </font>cmOK<font color="#000080">;          </font><font color="#008000"><i>(* Set up the command       *)
    </i></font><font color="#FF0000"><b>INHERITED </b></font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);   </font><font color="#008000"><i>(* Let the parent handle it *)
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p></body>
</html>
