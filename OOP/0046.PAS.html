<html>
<head><title> "Event Handling in Turbo Vision" by KEN BURROWS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0046.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I got a problem here. This procedure below ,derived from Tapplication, is
&gt; just idling. It won't do the command assigned to Pbutton. There's something
&gt; missing (I'm new with programming in Turbo Vision). The only things it does
&gt; it's to show my button and close my window back. The commands are defined
&gt; in &gt; the HandleEvent of the Tapplication. My objective is to be able to
&gt; open a new &gt; PDialog on top of this one by the command selected.

Your problem is the way you are implementing your dialog. There is no
handleevent method to handle the events of the buttons. Create a tdialog
and fully define and flesh it out, and then execute it from the application.
}

</i></font><font color="#FF0000"><b>Program </b></font>ButtonTester<font color="#000080">; </font><font color="#008000"><i>{Tested}
</i></font><font color="#FF0000"><b>Uses </b></font>App<font color="#000080">,</font>Objects<font color="#000080">,</font>Drivers<font color="#000080">,</font>Views<font color="#000080">,</font>Dialogs<font color="#000080">,</font>msgbox<font color="#000080">;
</font><font color="#FF0000"><b>Type
   </b></font>SelDialog <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
                 </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>bounds<font color="#000080">:</font>TRect<font color="#000080">;</font>ATitle<font color="#000080">:</font>TTitleStr<font color="#000080">);
                 </font><font color="#FF0000"><b>Procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>SelDialogPtr <font color="#000080">= ^</font>SelDialog<font color="#000080">;
</font><font color="#FF0000"><b>Const
  </b></font>cmCD_Roms      <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;
  </font>cmDiskets      <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;
  </font>cmHard_drive   <font color="#000080">= </font><font color="#800000">102</font><font color="#000080">;
  </font>cmMemory       <font color="#000080">= </font><font color="#800000">103</font><font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>SelDialog<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>bounds<font color="#000080">:</font>TRect<font color="#000080">;</font>ATitle<font color="#000080">:</font>TTitleStr<font color="#000080">);
   </font><font color="#FF0000"><b>var </b></font>r <font color="#000080">: </font>trect<font color="#000080">;
   </font><font color="#FF0000"><b>Begin
     inherited </b></font>init<font color="#000080">(</font>Bounds<font color="#000080">,</font>ATitle<font color="#000080">);
     </font>getextent<font color="#000080">(</font>r<font color="#000080">); </font>r<font color="#000080">.</font>grow<font color="#000080">(-</font><font color="#800000">2</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">); </font>r<font color="#000080">.</font>b<font color="#000080">.</font>y <font color="#000080">:= </font>r<font color="#000080">.</font>a<font color="#000080">.</font>y <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
     </font>insert<font color="#000080">(</font>new<font color="#000080">(</font>PButton<font color="#000080">,</font>init<font color="#000080">(</font>r<font color="#000080">,</font><font color="#800000">'~C~D Roms'</font><font color="#000080">,</font>cmCD_Roms<font color="#000080">,</font>bfnormal<font color="#000080">)));
     </font>inc<font color="#000080">(</font>r<font color="#000080">.</font>a<font color="#000080">.</font>y<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>inc<font color="#000080">(</font>r<font color="#000080">.</font>b<font color="#000080">.</font>y<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
     </font>insert<font color="#000080">(</font>new<font color="#000080">(</font>PButton<font color="#000080">,</font>init<font color="#000080">(</font>r<font color="#000080">,</font><font color="#800000">'~D~iskettes'</font><font color="#000080">,</font>cmDiskets<font color="#000080">,</font>bfnormal<font color="#000080">)));
     </font>inc<font color="#000080">(</font>r<font color="#000080">.</font>a<font color="#000080">.</font>y<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>inc<font color="#000080">(</font>r<font color="#000080">.</font>b<font color="#000080">.</font>y<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
     </font>insert<font color="#000080">(</font>new<font color="#000080">(</font>PButton<font color="#000080">,</font>init<font color="#000080">(</font>r<font color="#000080">,</font><font color="#800000">'~H~ard Drives'</font><font color="#000080">,</font>cmHard_Drive<font color="#000080">,</font>bfnormal<font color="#000080">)));
     </font>inc<font color="#000080">(</font>r<font color="#000080">.</font>a<font color="#000080">.</font>y<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>inc<font color="#000080">(</font>r<font color="#000080">.</font>b<font color="#000080">.</font>y<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
     </font>insert<font color="#000080">(</font>new<font color="#000080">(</font>PButton<font color="#000080">,</font>init<font color="#000080">(</font>r<font color="#000080">,</font><font color="#800000">'~M~emory'</font><font color="#000080">,</font>cmMemory<font color="#000080">,</font>bfnormal<font color="#000080">)));
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SelDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">);
   </font><font color="#FF0000"><b>Begin
     inherited </b></font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
     </font><font color="#FF0000"><b>if   </b></font><font color="#000080">(</font>event<font color="#000080">.</font>what <font color="#000080">= </font>evcommand<font color="#000080">) </font><font color="#FF0000"><b>and
          </b></font><font color="#000080">(</font>event<font color="#000080">.</font>command <font color="#FF0000"><b>in </b></font><font color="#000080">[</font>cmCD_Roms<font color="#000080">,</font>cmDiskets<font color="#000080">,</font>cmHard_Drive<font color="#000080">,</font>cmMemory<font color="#000080">])
     </font><font color="#FF0000"><b>then </b></font>EndModal<font color="#000080">(</font>event<font color="#000080">.</font>command<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>MyApp <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
            </font><font color="#FF0000"><b>procedure </b></font>run<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>function </b></font>GetSelection<font color="#000080">:</font>word<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>MyApp<font color="#000080">.</font>GetSelection<font color="#000080">:</font>Word<font color="#000080">;
   </font><font color="#FF0000"><b>var </b></font>p<font color="#000080">:</font>SelDialogPtr<font color="#000080">;
       </font>r<font color="#000080">:</font>Trect<font color="#000080">;
   </font><font color="#FF0000"><b>Begin
     </b></font>r<font color="#000080">.</font>assign<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">);
     </font>new<font color="#000080">(</font>p<font color="#000080">,</font>init<font color="#000080">(</font>r<font color="#000080">,</font><font color="#800000">'Select [esc to quit]'</font><font color="#000080">));
     </font>p<font color="#000080">^.</font>options <font color="#000080">:= </font>p<font color="#000080">^.</font>options <font color="#FF0000"><b>or </b></font>ofCentered<font color="#000080">;
     </font><font color="#FF0000"><b>if   </b></font>p <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil
     then begin
            </b></font>GetSelection <font color="#000080">:= </font>ExecView<font color="#000080">(</font>p<font color="#000080">);
            </font>dispose<font color="#000080">(</font>p<font color="#000080">,</font>done<font color="#000080">);
          </font><font color="#FF0000"><b>end
     else </b></font>GetSelection <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>MyApp<font color="#000080">.</font>Run<font color="#000080">;
   </font><font color="#FF0000"><b>var </b></font>w   <font color="#000080">:</font>word<font color="#000080">;
       </font>stop<font color="#000080">:</font>boolean<font color="#000080">;
   </font><font color="#FF0000"><b>Begin
     </b></font>stop <font color="#000080">:= </font>false<font color="#000080">;
     </font><font color="#FF0000"><b>Repeat
       </b></font>w <font color="#000080">:= </font>GetSelection<font color="#000080">;
       </font><font color="#FF0000"><b>case </b></font>w <font color="#FF0000"><b>of
       </b></font>cmCD_Roms    <font color="#000080">: </font>messagebox<font color="#000080">(</font><font color="#800000">#3'Selected CD Roms'</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>mfokbutton<font color="#000080">);
       </font>cmDiskets    <font color="#000080">: </font>messagebox<font color="#000080">(</font><font color="#800000">#3'Selected Diskettes'</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>mfokbutton<font color="#000080">);
       </font>cmHard_drive <font color="#000080">: </font>messagebox<font color="#000080">(</font><font color="#800000">#3'Selected Hard Drives'</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>mfokbutton<font color="#000080">);
       </font>cmMemory     <font color="#000080">: </font>messagebox<font color="#000080">(</font><font color="#800000">#3'Selected Memory'</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>mfokbutton<font color="#000080">);
       </font><font color="#FF0000"><b>else </b></font>stop <font color="#000080">:= </font>true<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Until </b></font>Stop<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>mApp <font color="#000080">: </font>MyApp<font color="#000080">;
    </font>m   <font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>m <font color="#000080">:= </font>memavail<font color="#000080">;
  </font><font color="#FF0000"><b>with </b></font>mApp <font color="#FF0000"><b>do begin </b></font>init<font color="#000080">; </font>run<font color="#000080">; </font>done<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>m <font color="#000080">&lt;&gt; </font>memavail <font color="#FF0000"><b>then </b></font>writeln<font color="#000080">(</font><font color="#800000">'heap ''a trouble'</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0046.PAS">Original</a><b>]</b></p></body>
</html>
