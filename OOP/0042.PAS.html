<html>
<head><title> "String List Object" by RANDALL WOODMAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>filelist<font color="#000080">;
</font><font color="#008000"><i>{
  Contains Object List for keeping a list of files.
}
</i></font><font color="#FF0000"><b>INTERFACE
USES </b></font>DOS<font color="#000080">, </font>OPString<font color="#000080">;

</font><font color="#FF0000"><b>TYPE  </b></font>CmdPtr <font color="#000080">= ^</font>CmdRec<font color="#000080">;
      </font>CmdRec <font color="#000080">= </font><font color="#FF0000"><b>RECORD
          </b></font>CmdStr <font color="#000080">: </font>PathStr<font color="#000080">;  </font><font color="#008000"><i>{79 char to allow for maximum path length}
          </i></font>Next   <font color="#000080">: </font>CmdPtr<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>List   <font color="#000080">= </font><font color="#FF0000"><b>OBJECT
          </b></font>First<font color="#000080">, </font>Last<font color="#000080">, </font>Current <font color="#000080">: </font>CmdPtr<font color="#000080">;
          </font>ListCount <font color="#000080">: </font>Word<font color="#000080">;

          </font><font color="#FF0000"><b>CONSTRUCTOR </b></font>Init<font color="#000080">;
          </font><font color="#FF0000"><b>Procedure </b></font>AddName<font color="#000080">( </font>Name <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">);
          </font><font color="#FF0000"><b>Procedure </b></font>SortList<font color="#000080">;
          </font><font color="#FF0000"><b>Procedure </b></font>SortListReverse<font color="#000080">;
          </font><font color="#FF0000"><b>Function </b></font>Compare<font color="#000080">( </font>A<font color="#000080">, </font>B <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
          </font><font color="#FF0000"><b>Function </b></font>FirstName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>Function </b></font>LastName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>Function </b></font>CurrentName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>Function </b></font>NextName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>Function </b></font>TotalCount <font color="#000080">: </font>Word<font color="#000080">;
          </font><font color="#FF0000"><b>Procedure </b></font>ClearList<font color="#000080">;
          </font><font color="#FF0000"><b>Function </b></font>InList<font color="#000080">( </font>Name <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>CheckCase <font color="#000080">: </font>Boolean <font color="#000080">) : </font>Boolean<font color="#000080">;
          </font><font color="#FF0000"><b>DESTRUCTOR </b></font>Done<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

CONSTRUCTOR </b></font>LIST<font color="#000080">.</font>INIT<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FIRST <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
  </font>LAST <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
  </font>CURRENT <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
  </font>LISTCOUNT <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>LIST<font color="#000080">.</font>ADDNAME<font color="#000080">( </font>NAME <font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">);
  </font><font color="#008000"><i>{ Add a new CmdRec to the list }
</i></font><font color="#FF0000"><b>VAR
  </b></font>TempCmdPtr <font color="#000080">: </font>CmdPtr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>NEW<font color="#000080">(</font>TempCmdPtr<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>First <font color="#000080">= </font><font color="#FF0000"><b>NIL then begin
    </b></font>First <font color="#000080">:= </font>TempCmdPtr<font color="#000080">;
    </font>Current <font color="#000080">:= </font>TempCmdPtr<font color="#000080">;
  </font><font color="#FF0000"><b>end else
    </b></font>Last<font color="#000080">^.</font>Next <font color="#000080">:= </font>TempCmdPtr<font color="#000080">;
  </font>TempCmdPtr<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
  </font>TempCmdPtr<font color="#000080">^.</font>CmdStr <font color="#000080">:= </font>Name<font color="#000080">;
  </font>Last <font color="#000080">:= </font>TempCmdPtr<font color="#000080">;
  </font>INC<font color="#000080">(</font>ListCount<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>LIST<font color="#000080">.</font>SORTLIST<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>TempCmdPtr <font color="#000080">: </font>CmdPtr<font color="#000080">;
  </font>P<font color="#000080">, </font>Q <font color="#000080">: </font>CmdPtr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  if </b></font><font color="#000080">(</font>First <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>First<font color="#000080">^.</font>Next <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>EXIT<font color="#000080">;
  </font>TempCmdPtr <font color="#000080">:= </font>First<font color="#000080">;
  </font>First <font color="#000080">:= </font>First<font color="#000080">^.</font>Next<font color="#000080">;
  </font>TempCmdPtr<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>repeat
     </b></font>p <font color="#000080">:= </font>TempCmdPtr<font color="#000080">;

     </font><font color="#FF0000"><b>if not </b></font>Compare<font color="#000080">( </font>p<font color="#000080">^.</font>CmdStr<font color="#000080">, </font>First<font color="#000080">^.</font>CmdStr <font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          </b></font>TempCmdPtr <font color="#000080">:= </font>First<font color="#000080">;
          </font>First <font color="#000080">:= </font>First<font color="#000080">^.</font>Next<font color="#000080">;
          </font>TempCmdPtr<font color="#000080">^.</font>Next <font color="#000080">:= </font>p<font color="#000080">;
        </font><font color="#FF0000"><b>end
     else
     begin
       while </b></font><font color="#000080">(</font>compare<font color="#000080">( </font>p<font color="#000080">^.</font>CmdStr<font color="#000080">, </font>First<font color="#000080">^.</font>CmdStr <font color="#000080">) </font><font color="#FF0000"><b>AND
             </b></font><font color="#000080">(</font>p <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">)) </font><font color="#FF0000"><b>do
       begin
         </b></font>q <font color="#000080">:= </font>p<font color="#000080">;
         </font>p <font color="#000080">:= </font>p<font color="#000080">^.</font>Next<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

       </font><font color="#FF0000"><b>if </b></font>p <font color="#000080">= </font><font color="#FF0000"><b>NIL then
       begin
         </b></font>p <font color="#000080">:= </font>First<font color="#000080">;
         </font>First <font color="#000080">:= </font>First<font color="#000080">^.</font>Next<font color="#000080">;
         </font>q<font color="#000080">^.</font>Next <font color="#000080">:= </font>p<font color="#000080">;
         </font>p<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>end
         else
       begin
         </b></font>q<font color="#000080">^.</font>next <font color="#000080">:= </font>First<font color="#000080">;
         </font>First <font color="#000080">:= </font>First<font color="#000080">^.</font>next<font color="#000080">;
         </font>q<font color="#000080">^.</font>next<font color="#000080">^.</font>next <font color="#000080">:= </font>p<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>First <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;

  </font>First <font color="#000080">:= </font>TempCmdPtr<font color="#000080">;
  </font>Current <font color="#000080">:= </font>First<font color="#000080">;
  </font>Last <font color="#000080">:= </font>First<font color="#000080">;

  </font><font color="#FF0000"><b>repeat
  </b></font>Last <font color="#000080">:= </font>Last<font color="#000080">^.</font>Next<font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>Last<font color="#000080">^.</font>Next <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>LIST<font color="#000080">.</font>SORTLISTREVERSE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>TempCmdPtr <font color="#000080">: </font>CmdPtr<font color="#000080">;
  </font>CheckPtr   <font color="#000080">: </font>CmdPtr<font color="#000080">;
  </font>tempstr    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  if </b></font><font color="#000080">(</font>First <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>First<font color="#000080">^.</font>Next <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>EXIT<font color="#000080">;
  </font>TempCmdPtr <font color="#000080">:= </font>First<font color="#000080">;
  </font>CheckPtr <font color="#000080">:= </font>First<font color="#000080">^.</font>Next<font color="#000080">;

  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>TempCmdPtr <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>DO
  BEGIN
    While </b></font><font color="#000080">(</font>CheckPtr <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font><font color="#008000"><i>{ if the tempcmdptr string is less then the checkptr string }
      </i></font><font color="#FF0000"><b>If </b></font>compare<font color="#000080">(</font>TempCmdPtr<font color="#000080">^.</font>CmdStr<font color="#000080">, </font>CheckPtr<font color="#000080">^.</font>CmdStr<font color="#000080">) </font><font color="#FF0000"><b>then
      BEGIN
        </b></font><font color="#008000"><i>{ then swap the strings }
        </i></font>tempstr <font color="#000080">:= </font>tempCmdPtr<font color="#000080">^.</font>cmdstr<font color="#000080">;           </font><font color="#008000"><i>{ save temp's string }
        </i></font>TempCmdPtr<font color="#000080">^.</font>cmdStr <font color="#000080">:= </font>CheckPtr<font color="#000080">^.</font>Cmdstr<font color="#000080">; </font><font color="#008000"><i>{ assign check's string to temp
        CheckPtr^.Cmdstr := tempstr;            { assign tempptr's string to ch
      end;
      CheckPtr := Checkptr^.next;               { get a pointer to next node }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ while checkptr }
    </i></font>TempCmdPtr <font color="#000080">:= </font>TempCmdPtr<font color="#000080">^.</font>Next<font color="#000080">;             </font><font color="#008000"><i>{ get the next compairson base 
  end; { while tempcmdptr }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ SortListReverse }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>LIST<font color="#000080">.</font>COMPARE<font color="#000080">( </font>A<font color="#000080">, </font>B <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Compare <font color="#000080">:= (</font>CompUCString<font color="#000080">( </font>A<font color="#000080">,</font>B <font color="#000080">) = </font>Less<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>LIST<font color="#000080">.</font>FIRSTNAME <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  if </b></font>First <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL then begin
    </b></font>FirstName <font color="#000080">:= </font>First<font color="#000080">^.</font>CmdStr<font color="#000080">;
    </font>Current <font color="#000080">:= </font>First<font color="#000080">;
  </font><font color="#FF0000"><b>end else
    </b></font>FirstName <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LIST<font color="#000080">.</font>LASTNAME <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  if </b></font>Last <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL then begin
    </b></font>LastName <font color="#000080">:= </font>Last<font color="#000080">^.</font>CmdStr<font color="#000080">;
    </font>Current <font color="#000080">:= </font>Last<font color="#000080">;
  </font><font color="#FF0000"><b>end else
    </b></font>LastName <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LIST<font color="#000080">.</font>CURRENTNAME <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  if </b></font>Current <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL then
    </b></font>CurrentName <font color="#000080">:= </font>Current<font color="#000080">^.</font>CmdStr
  <font color="#FF0000"><b>else
    </b></font>CurrentName <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LIST<font color="#000080">.</font>NEXTNAME <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  if </b></font><font color="#000080">(</font>Current <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>Then begin
    </b></font>Current <font color="#000080">:= </font>Current<font color="#000080">^.</font>Next<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Current <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>NextName <font color="#000080">:= </font>Current<font color="#000080">^.</font>CmdStr
    <font color="#FF0000"><b>else
      </b></font>NextName <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>end else
    </b></font>NextName <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LIST<font color="#000080">.</font>TOTALCOUNT <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>TotalCount <font color="#000080">:= </font>ListCount<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>LIST<font color="#000080">.</font>CLEARLIST<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  if </b></font>First <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL then
    repeat
      </b></font>Current <font color="#000080">:= </font>First<font color="#000080">^.</font>Next<font color="#000080">;
      </font>Dispose<font color="#000080">(</font>First<font color="#000080">);
      </font>First <font color="#000080">:= </font>Current<font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font>First <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>Last <font color="#000080">:= </font>First<font color="#000080">;
  </font>ListCount <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>List<font color="#000080">.</font>InList<font color="#000080">(</font>Name<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>CheckCase <font color="#000080">: </font>Boolean<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ returns true if string was in list }
</i></font><font color="#FF0000"><b>VAR
  </b></font>TempPtr <font color="#000080">: </font>CmdPtr<font color="#000080">;
  </font>OK      <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Ok <font color="#000080">:= </font>false<font color="#000080">;
  </font>TempPtr <font color="#000080">:= </font>Current<font color="#000080">;
  </font>Current <font color="#000080">:= </font>First<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>checkCase <font color="#FF0000"><b>then </b></font>OK <font color="#000080">:= (</font>CompString<font color="#000080">(</font>FirstName<font color="#000080">,</font>Name<font color="#000080">) = </font>Equal<font color="#000080">)
  </font><font color="#FF0000"><b>Else </b></font>Ok <font color="#000080">:= (</font>CompUCString<font color="#000080">(</font>FirstName<font color="#000080">,</font>Name<font color="#000080">) = </font>Equal<font color="#000080">);
  </font><font color="#FF0000"><b>If Not </b></font>OK <font color="#FF0000"><b>then
  BEGIN
    While </b></font><font color="#000080">(</font>Current <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>AND Not </b></font>OK <font color="#FF0000"><b>DO
    If </b></font>CheckCase <font color="#FF0000"><b>then </b></font>OK <font color="#000080">:= (</font>CompString<font color="#000080">(</font>NextName<font color="#000080">,</font>Name<font color="#000080">) = </font>Equal<font color="#000080">)
    </font><font color="#FF0000"><b>Else </b></font>OK <font color="#000080">:= (</font>CompUCString<font color="#000080">(</font>NextName<font color="#000080">,</font>Name<font color="#000080">) = </font>Equal<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>InList <font color="#000080">:= </font>OK<font color="#000080">;
  </font>Current <font color="#000080">:= </font>TempPtr<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>DESTRUCTOR </b></font>LIST<font color="#000080">.</font>DONE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>ClearList<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p></body>
</html>
