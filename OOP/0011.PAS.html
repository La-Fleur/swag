<html>
<head><title> "OOP-WIND.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
     I'm still rather new (hence unexperienced) to this development
environment. Since the number of users of the Pascal For Windows product
is very limited in Belgium, I have little opportUnity to exchange ideas
and talk about problems. ThereFore, I dare to ask the following question
directly on the US-BBS.

     I contacted Borland Belgium With the following question:
Is it possible to create an MDI-Interface, which consists of TDlgWindow's
(Even of different Types of DialogWindows).
The Program printed below was their answer. However, possibly because of
my limited experience in the field, this Program does not seem to work on
my Computer running the Borland Pascal 7.0 .

     Could someone explain why the Program below does not create dialog-
Windows as MDI client Windows of the main MDI Window (when I select the
&quot;create&quot;-menu element), but instead only normal client Windows.
}

{********************************************************}
{   MDI - Programm of TDlgWindow - ChildWindows          }
{                                                        }
{   This is an adapted version of the Borland demo       }
{   Programm  MDIAPP.PAS of Borland Pascal 7.0           }
{********************************************************}
</i></font><font color="#FF0000"><b>Program </b></font>MDI<font color="#000080">;
</font><font color="#008000"><i>{$R MDIAPP.RES}
</i></font><font color="#FF0000"><b>Uses
  </b></font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Strings<font color="#000080">, </font>OWindows<font color="#000080">, </font>ODialogs<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font><font color="#008000"><i>{ Define a TApplication descendant }
  </i></font>TMDIApp <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>Procedure </b></font>InitMainWindow<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PMyMDIChild <font color="#000080">= ^</font>TMyMDIChild<font color="#000080">;
  </font>TMyMDIChild <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TDlgWindow<font color="#000080">)
    </font>Num <font color="#000080">: </font>Integer<font color="#000080">;
    </font>CanCloseCheckBox <font color="#000080">: </font>PCheckBox<font color="#000080">;
    </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">(</font>AParent<font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>AName<font color="#000080">: </font>PChar<font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Function </b></font>CanClose<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PMyMDIWindow <font color="#000080">= ^</font>TMyMDIWindow<font color="#000080">;
  </font>TMyMDIWindow <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TMDIWindow<font color="#000080">)
    </font><font color="#FF0000"><b>Procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Function </b></font>CreateChild<font color="#000080">: </font>PWindowsObject<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{**********************  MDI Child  ************************}
  </i></font><font color="#FF0000"><b>Constructor </b></font>TMyMDIChild<font color="#000080">.</font>Init<font color="#000080">(</font>AParent<font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>AName<font color="#000080">: </font>PChar<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    inherited </b></font>Init<font color="#000080">(</font>AParent<font color="#000080">, </font>AName<font color="#000080">);
    </font>New<font color="#000080">(</font>CanCloseCheckBox<font color="#000080">, </font>Init<font color="#000080">(@</font>Self<font color="#000080">, </font><font color="#800000">102</font><font color="#000080">, </font><font color="#800000">'Can Close'</font><font color="#000080">,
                               </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">200</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>TMyMDIChild<font color="#000080">.</font>SetupWindow<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    inherited </b></font>SetupWindow<font color="#000080">;
    </font>CanCloseCheckBox<font color="#000080">^.</font>Check<font color="#000080">;
    </font>ShowWindow<font color="#000080">(</font>HWindow<font color="#000080">, </font>CmdShow<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>TMyMDIChild<font color="#000080">.</font>CanClose<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>CanClose <font color="#000080">:= </font>CanCloseCheckBox<font color="#000080">^.</font>GetCheck <font color="#000080">= </font>bf_Checked<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{*****************  MDI Window  ******************}
  </i></font><font color="#FF0000"><b>Procedure </b></font>TMyMDIWindow<font color="#000080">.</font>SetupWindow<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>NewChild <font color="#000080">: </font>PMyMDIChild<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    inherited </b></font>SetupWindow<font color="#000080">;
    </font>CreateChild<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>TMyMDIWindow<font color="#000080">.</font>CreateChild<font color="#000080">: </font>PWindowsObject<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>CreateChild <font color="#000080">:= </font>Application<font color="#000080">^.</font>MakeWindow<font color="#000080">(</font>New<font color="#000080">(</font>PMyMDIChild<font color="#000080">,
                                           </font>Init<font color="#000080">(@</font>Self<font color="#000080">, </font>PChar<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">))));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMDIApp<font color="#000080">.</font>InitMainWindow<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MainWindow <font color="#000080">:= </font>New<font color="#000080">(</font>PMDIWindow<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">'MDI ConFormist'</font><font color="#000080">,
                                </font>LoadMenu<font color="#000080">(</font>HInstance<font color="#000080">, </font><font color="#800000">'MDIMenu'</font><font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>MDIApp<font color="#000080">: </font>TMDIApp<font color="#000080">;

</font><font color="#008000"><i>{ Run the MDIApp }
</i></font><font color="#FF0000"><b>begin
  </b></font>MDIApp<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#800000">'MDIApp'</font><font color="#000080">);
  </font>MDIApp<font color="#000080">.</font>Run<font color="#000080">;
  </font>MDIApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
***************************************************************************
                 Content of the MDIAPP.RES File
***************************************************************************
}
</i></font>MDIMENU MENU
<font color="#FF0000"><b>begin
        </b></font>POPUP <font color="#000080">&quot;&amp;</font>MDI Children<font color="#000080">&quot;
        </font><font color="#FF0000"><b>begin
                </b></font>MENUITEM <font color="#000080">&quot;</font>C<font color="#000080">&amp;</font>reate<font color="#000080">&quot;, </font><font color="#800000">24339
                </font>MENUITEM <font color="#000080">&quot;&amp;</font>Cascade<font color="#000080">&quot;, </font><font color="#800000">24337
                </font>MENUITEM <font color="#000080">&quot;&amp;</font>Tile<font color="#000080">&quot;, </font><font color="#800000">24336
                </font>MENUITEM <font color="#000080">&quot;</font>Arrange <font color="#000080">&amp;</font>Icons<font color="#000080">&quot;, </font><font color="#800000">24335
                </font>MENUITEM <font color="#000080">&quot;</font>C<font color="#000080">&amp;</font>lose All<font color="#000080">&quot;, </font><font color="#800000">24338
        </font><font color="#FF0000"><b>end
end

</b></font><font color="#800000">1 </font>DIALOG <font color="#800000">18</font><font color="#000080">, </font><font color="#800000">18</font><font color="#000080">, </font><font color="#800000">142</font><font color="#000080">, </font><font color="#800000">92
</font>STYLE DS_SYSMODAL <font color="#000080">| </font>WS_CHILD <font color="#000080">| </font>WS_VISIBLE <font color="#000080">| </font>WS_CAPTION <font color="#000080">|
                    </font>WS_MinIMIZEBOX <font color="#000080">| </font>WS_MAXIMIZEBOX
<font color="#FF0000"><b>CLASS </b></font><font color="#000080">&quot;</font>BorDlg<font color="#000080">&quot;
</font>CAPTION <font color="#000080">&quot;</font>TEST<font color="#000080">&quot;
</font><font color="#FF0000"><b>begin
        </b></font>CHECKBOX <font color="#000080">&quot;</font>Text<font color="#000080">&quot;, </font><font color="#800000">101</font><font color="#000080">, </font><font color="#800000">26</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">28</font><font color="#000080">, </font><font color="#800000">12
        </font>LText <font color="#000080">&quot;</font>Text<font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">34</font><font color="#000080">, </font><font color="#800000">48</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">8
        </font>CONTROL <font color="#000080">&quot;</font>Text<font color="#000080">&quot;, </font><font color="#800000">102</font><font color="#000080">, &quot;</font>BorStatic<font color="#000080">&quot;, </font><font color="#800000">0 </font><font color="#000080">| </font>WS_CHILD <font color="#000080">|
                                              </font>WS_VISIBLE<font color="#000080">, </font><font color="#800000">33</font><font color="#000080">, </font><font color="#800000">70</font><font color="#000080">, </font><font color="#800000">66</font><font color="#000080">, </font><font color="#800000">8
</font><font color="#FF0000"><b>END
</b></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p></body>
</html>
