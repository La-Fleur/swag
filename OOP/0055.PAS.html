<html>
<head><title> "Example of TV Dir Collection" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0055.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$X+}
</i></font><font color="#FF0000"><b>Program </b></font>ExampleProgram<font color="#000080">;
</font><font color="#008000"><i>{$M $8000,0,655360}
</i></font><font color="#FF0000"><b>Uses </b></font>Drivers<font color="#000080">, </font>Objects<font color="#000080">, </font>Views<font color="#000080">, </font>App<font color="#000080">, </font>Menus<font color="#000080">, </font>Dialogs<font color="#000080">, </font>Dos<font color="#000080">;
  </font><font color="#FF0000"><b>Const
    </b></font>cmLeft <font color="#000080">=  </font><font color="#800000">101</font><font color="#000080">;

  </font><font color="#FF0000"><b>Type
    </b></font>PDirCollection <font color="#000080">= ^</font>TDirCollection<font color="#000080">;
    </font>TDirCollection <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TSortedCollection<font color="#000080">)
      </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">;
      </font><font color="#FF0000"><b>Function </b></font>Compare<font color="#000080">(</font>Key1<font color="#000080">, </font>Key2<font color="#000080">: </font>Pointer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>FreeItem<font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font>PMStaticText <font color="#000080">= ^</font>TMStaticText<font color="#000080">;
    </font>TMStaticText <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TStaticText<font color="#000080">)
      </font><font color="#FF0000"><b>Function </b></font>GetPalette<font color="#000080">: </font>PPalette<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font>PTestDialog <font color="#000080">= ^</font>TTestDialog<font color="#000080">;
    </font>TTestDialog <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
      </font><font color="#FF0000"><b>Function </b></font>Valid<font color="#000080">(</font>Command<font color="#000080">: </font>Word<font color="#000080">): </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font>TTestMain <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
      </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>InitStatusLine<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>Run<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#008000"><i>{-------------- TDirCollection -------}
    </i></font><font color="#FF0000"><b>Constructor </b></font>TDirCollection<font color="#000080">.</font>Init<font color="#000080">;
      </font><font color="#FF0000"><b>Var
        </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;
        </font>Info<font color="#000080">: </font>SearchRec<font color="#000080">;
        </font>S<font color="#000080">: ^</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Begin
        </b></font>TCollection<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">);
        </font>FindFirst<font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">, </font>AnyFile<font color="#000080">, </font>Info<font color="#000080">);
        </font><font color="#FF0000"><b>While </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do
          Begin
            </b></font>New<font color="#000080">(</font>S<font color="#000080">);
            </font>S<font color="#000080">^:=</font>Info<font color="#000080">.</font>Name<font color="#000080">;
            </font>Insert<font color="#000080">(</font>S<font color="#000080">);
            </font>FindNext<font color="#000080">(</font>Info<font color="#000080">);
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Function </b></font>TDirCollection<font color="#000080">.</font>Compare<font color="#000080">(</font>Key1<font color="#000080">, </font>Key2<font color="#000080">: </font>Pointer<font color="#000080">): </font>Integer<font color="#000080">;
      </font><font color="#FF0000"><b>Begin
        If String</b></font><font color="#000080">(</font>Key1<font color="#000080">^)&lt;</font><font color="#FF0000"><b>String</b></font><font color="#000080">(</font>Key2<font color="#000080">^) </font><font color="#FF0000"><b>then </b></font>Compare<font color="#000080">:=-</font><font color="#800000">1
        </font><font color="#FF0000"><b>Else If String</b></font><font color="#000080">(</font>Key1<font color="#000080">^)&gt;</font><font color="#FF0000"><b>String</b></font><font color="#000080">(</font>Key2<font color="#000080">^) </font><font color="#FF0000"><b>then </b></font>Compare<font color="#000080">:=</font><font color="#800000">1
        </font><font color="#FF0000"><b>Else </b></font>Compare<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Procedure </b></font>TDirCollection<font color="#000080">.</font>FreeItem<font color="#000080">(</font>Item<font color="#000080">:</font>Pointer<font color="#000080">);
      </font><font color="#FF0000"><b>Type
        </b></font>PString <font color="#000080">= ^</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Begin
        </b></font>Dispose<font color="#000080">(</font>PString<font color="#000080">(</font>Item<font color="#000080">));
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


  </font><font color="#008000"><i>{-------------- TStaticText ----------}
    </i></font><font color="#FF0000"><b>Function </b></font>TMStaticText<font color="#000080">.</font>GetPalette<font color="#000080">: </font>PPalette<font color="#000080">;
      </font><font color="#FF0000"><b>Begin
        </b></font>GetPalette <font color="#000080">:= </font>TView<font color="#000080">.</font>GetPalette<font color="#008000"><i>{@cMenuBar}</i></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#008000"><i>{-------- TTestDialog --------}
  </i></font><font color="#FF0000"><b>Function </b></font>TTestDialog<font color="#000080">.</font>Valid<font color="#000080">(</font>Command<font color="#000080">: </font>Word<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>Valid<font color="#000080">:=</font>False<font color="#000080">;
      </font><font color="#FF0000"><b>Case </b></font>Command <font color="#FF0000"><b>of
        </b></font>cmLeft<font color="#000080">:;
      </font><font color="#FF0000"><b>Else
        </b></font>Valid<font color="#000080">:=</font>true<font color="#000080">;
      </font><font color="#FF0000"><b>End
    End</b></font><font color="#000080">;

  </font><font color="#008000"><i>{-------- TTestMain ----------}
  </i></font><font color="#FF0000"><b>Constructor </b></font>TTestMain<font color="#000080">.</font>Init<font color="#000080">;
    </font><font color="#FF0000"><b>Var
      </b></font>StaticText<font color="#000080">: </font>PMStaticText<font color="#000080">;
      </font>R<font color="#000080">: </font>TRect<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>TApplication<font color="#000080">.</font>Init<font color="#000080">;
      </font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
      </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y<font color="#000080">:=</font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
      </font>StaticText<font color="#000080">:= </font>New<font color="#000080">(</font>PMStaticText<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'                         Welcome to Turbo Vision'</font><font color="#000080">));
      </font>Insert<font color="#000080">(</font>StaticText<font color="#000080">);
      </font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
      </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y<font color="#000080">:=</font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
      </font>StaticText<font color="#000080">:= </font>New<font color="#000080">(</font>PMStaticText<font color="#000080">,</font>Init<font color="#000080">(</font>R<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">));
      </font>Insert<font color="#000080">(</font>StaticText<font color="#000080">);
      </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">70</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">79</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>TTestMain<font color="#000080">.</font>InitStatusLine<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
    End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>TTestMain<font color="#000080">.</font>Run<font color="#000080">;
    </font><font color="#FF0000"><b>Var
      </b></font>Dialog<font color="#000080">: </font>PTestDialog<font color="#000080">;
      </font>ListBox<font color="#000080">: </font>PListBox<font color="#000080">;
      </font>DirCollection<font color="#000080">: </font>PDirCollection<font color="#000080">;
      </font>ScrollBar<font color="#000080">: </font>PScrollBar<font color="#000080">;
      </font>R<font color="#000080">:</font>TRect<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">);
      </font>Dialog <font color="#000080">:= </font>New<font color="#000080">(</font>PTestDialog<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'My Dialog'</font><font color="#000080">));

      </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
      </font>ScrollBar<font color="#000080">:=</font>New<font color="#000080">(</font>PScrollBar<font color="#000080">,</font>Init<font color="#000080">(</font>R<font color="#000080">));
      </font>Dialog<font color="#000080">^.</font>Insert<font color="#000080">(</font>ScrollBar<font color="#000080">);
      </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
      </font>ListBox<font color="#000080">:= </font>New<font color="#000080">(</font>PListBox<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>ScrollBar<font color="#000080">));
      </font>Dialog<font color="#000080">^.</font>Insert<font color="#000080">(</font>ListBox<font color="#000080">);
      </font>DirCollection<font color="#000080">:=</font>New<font color="#000080">(</font>PDirCollection<font color="#000080">, </font>Init<font color="#000080">);
      </font>ListBox<font color="#000080">^.</font>NewList<font color="#000080">(</font>DirCollection<font color="#000080">);
      </font>DeskTop<font color="#000080">^.</font>ExecView<font color="#000080">(</font>Dialog<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Var
    </b></font>TestMain<font color="#000080">: </font>TTestMain<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>TestMain<font color="#000080">.</font>Init<font color="#000080">;
    </font>TestMain<font color="#000080">.</font>Run<font color="#000080">;
    </font>TestMain<font color="#000080">.</font>Done<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0055.PAS">Original</a><b>]</b></p></body>
</html>
