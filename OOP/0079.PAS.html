<html>
<head><title> "Execute a Popup Menu at ?" by KAI BOELLERT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0079.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;I'm new to Pascal and Turbo Vision and I am writing a program that
&gt;needs pop-up menus.  I've tried several times to use TMenuBox objects
&gt;but have had no luck at all.  Could someone please point me in the
&gt;right direction?  I am looking for a good Turbo Vision tutorial or a
&gt;short example using TMEnuBox with submenus from the first pop-up menu.

You can create popup menus using an instance of the TMenuPopup class.
For a complete reference of this class have a look at the online help
because the (german) manual doesn't describes TMenuPopup.

Use the following procedure to execute a popup menu:
}
</i></font><font color="#FF0000"><b>procedure </b></font>ExecutePopupMenu <font color="#000080">(</font>At<font color="#000080">:</font>TPoint<font color="#000080">; </font>PopupMenu<font color="#000080">:</font>PMenuPopup<font color="#000080">);
  </font><font color="#008000"><i>{ shows the &quot;PopupMenu&quot; at the position &quot;At&quot; }
</i></font><font color="#FF0000"><b>var
  </b></font>Bounds <font color="#000080">: </font>TRect<font color="#000080">;
  </font>D      <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Application<font color="#000080">^.</font>ValidView<font color="#000080">(</font>PopupMenu<font color="#000080">) &lt;&gt; </font><font color="#FF0000"><b>nil then
  begin
    </b></font>D<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font>Inc<font color="#000080">(</font>At<font color="#000080">.</font>Y<font color="#000080">);              
    </font>Application<font color="#000080">^.</font>GetBounds<font color="#000080">(</font>Bounds<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>At<font color="#000080">.</font>Y <font color="#000080">+ </font>PopupMenu<font color="#000080">^.</font>Size<font color="#000080">.</font>Y <font color="#000080">&gt; </font>Bounds<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#FF0000"><b>then 
    begin
      </b></font>Dec<font color="#000080">(</font>At<font color="#000080">.</font>Y<font color="#000080">, </font>PopupMenu<font color="#000080">^.</font>Size<font color="#000080">.</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>At<font color="#000080">.</font>Y <font color="#000080">&lt; </font>Bounds<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#FF0000"><b>then
      begin
        </b></font>At<font color="#000080">.</font>Y<font color="#000080">:=</font>Bounds<font color="#000080">.</font>A<font color="#000080">.</font>Y<font color="#000080">;
        </font>Inc<font color="#000080">(</font>At<font color="#000080">.</font>X<font color="#000080">); </font>D<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>At<font color="#000080">.</font>X <font color="#000080">+ </font>PopupMenu<font color="#000080">^.</font>Size<font color="#000080">.</font>X <font color="#000080">&gt; </font>Bounds<font color="#000080">.</font>B<font color="#000080">.</font>X <font color="#FF0000"><b>then    
      </b></font>Dec<font color="#000080">(</font>At<font color="#000080">.</font>X<font color="#000080">, </font>PopupMenu<font color="#000080">^.</font>Size<font color="#000080">.</font>X<font color="#000080">+</font>D<font color="#000080">);
    </font>Application<font color="#000080">^.</font>MakeLocal<font color="#000080">(</font>At<font color="#000080">, </font>At<font color="#000080">);
    </font>PopupMenu<font color="#000080">^.</font>MoveTo<font color="#000080">(</font>At<font color="#000080">.</font>X<font color="#000080">, </font>At<font color="#000080">.</font>Y<font color="#000080">);    
    </font>Application<font color="#000080">^.</font>Insert<font color="#000080">(</font>PopupMenu<font color="#000080">);   
    </font><font color="#FF0000"><b>Message</b></font><font color="#000080">(</font>PopupMenu<font color="#000080">, </font>evBroadcast<font color="#000080">, </font>cmCommandSetChanged<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>Message</b></font><font color="#000080">(</font>PopupMenu<font color="#000080">, </font>evCommand<font color="#000080">, </font>cmMenu<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
    </font>DisposeMenu<font color="#000080">(</font>PopupMenu<font color="#000080">^.</font>Menu<font color="#000080">);                
    </font>Dispose<font color="#000080">(</font>PopupMenu<font color="#000080">, </font>Done<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>Before executing the popup menu this <font color="#FF0000"><b>procedure is </b></font>doing some
calculations <font color="#FF0000"><b>to </b></font>guarantee that regardless <font color="#FF0000"><b>of </b></font>the parameter <font color="#000080">&quot;</font>At<font color="#000080">&quot; </font>the
popup menu <font color="#FF0000"><b>is </b></font>always showed within the current screen boundaries <font color="#FF0000"><b>of
</b></font><font color="#000080">&quot;</font>Application<font color="#000080">&quot;.

- </font>Kai



</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0079.PAS">Original</a><b>]</b></p></body>
</html>
