<html>
<head><title> "A T.V. Progress box example" by BRAD PRENDERGAST</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

 Program Name : MyPBDmo2.Pas
 Written By   : Brad Prendergast
 E-Mail       : mrealm@ici.net
 Web Page     : http://www.ici.net/cust_pages/mrealm/BANDP.HTM
 Program
 Compilation  : Borland Turbo Pascal 7.0

 Program Description :
   This sample program displays the creation and usage of a progress box.
   This progress box shows the percentage complete of a certain action.
   This demonstration is a very basic application and is meant to be used as
   an informative tool and built upon.  The process can be terminated at any
   time prior to reaching 100% by pressing ctrl-break.  Please pardon the
   lack of commenting, if you have any questions feel free to email me.

 =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}

</i></font><font color="#FF0000"><b>Program </b></font>PBDemo2<font color="#000080">;

</font><font color="#008000"><i>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}
{ These are the standard set of compiler directives I opt to use }

{$DEFINE DEBUG}
{$DEFINE Error_Checking}
  {$IFDEF Error_Checking}
    {$I+}  {L I/O Checking            }
    {$Q+}  {L Overflow Checking       }
    {$R+}  {L Range Checking          }
    {$S+}  {L Stack Overflow Checking }
  {$ELSE}
    {$I-}  {L I/O Checking            }
    {$Q-}  {L Overflow Checking       }
    {$R-}  {L Range Checking          }
    {$S-}  {L Stack Overflow Checking }
  {$ENDIF}
{$UNDEF Error_Checking}

  {$IFDEF DEBUG}
    {$D+}  {G Debug Information              }
    {$L+}  {G Local Symbol Information       }
    {$Y+}  {G Symbolic Reference Information }
  {$ELSE}
    {$D-}  {G Debug Information              }
    {$L-}  {G Local Symbol Information       }
    {$Y-}  {G Symbolic Reference Information }
  {$ENDIF}

{$A+}  {G Align Data}
{$B-}  {L Short Circuit Boolean Evaluation   }
{$E-}  {G Disable Emulation                  }
{$F+}  {L Allow Far Calls                    }
{$G+}  {G Generate 80286 Code                }
{$N-}  {G Disable Numeric Processing         }
{$P+}  {G Enable Open Parameters             }
{$O+}  {G Overlay                            }
{$T-}  {G Type @ Operator                    }
{$V+}  {L Var String Checking                }
{$X+}  {G Extended Syntax Enabled            }

{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}

  </i></font><font color="#FF0000"><b>uses
    </b></font>Dialogs<font color="#000080">, </font>App<font color="#000080">, </font>Objects<font color="#000080">, </font>Views<font color="#000080">, </font>Drivers<font color="#000080">;

  </font><font color="#FF0000"><b>type
    </b></font>PMyDialog      <font color="#000080">= ^</font>TMyDialog<font color="#000080">;
    </font>TMyDialog      <font color="#000080">= </font><font color="#FF0000"><b>Object </b></font><font color="#000080">( </font>TDialog <font color="#000080">)
                   </font>ondone<font color="#000080">,
                   </font>onbreak      <font color="#000080">: </font>boolean<font color="#000080">;
                   </font>displayline  <font color="#000080">: </font>PStaticText<font color="#000080">;
                   </font>progress<font color="#000080">,
                   </font>percentage<font color="#000080">,
                   </font>total        <font color="#000080">: </font>longint<font color="#000080">;
                   </font>status       <font color="#000080">: </font>word<font color="#000080">;
                   </font><font color="#FF0000"><b>Constructor </b></font>Init <font color="#000080">( </font>mdtitle <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>totaltodo <font color="#000080">: </font>longint <font color="#000080">);
                   </font><font color="#FF0000"><b>Function </b></font>Update <font color="#000080">( </font>currperc <font color="#000080">: </font>longint <font color="#000080">) : </font>word<font color="#000080">;
                   </font><font color="#FF0000"><b>Procedure </b></font>SetHitAnyKeyMode<font color="#000080">(</font>mode <font color="#000080">: </font>integer<font color="#000080">; </font>enable <font color="#000080">: </font>boolean<font color="#000080">);
                   </font><font color="#FF0000"><b>Procedure </b></font>HitAnyKey<font color="#000080">;
                   </font><font color="#FF0000"><b>Procedure </b></font>Draw<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>TMyApplication <font color="#000080">= </font><font color="#FF0000"><b>Object </b></font><font color="#000080">(</font>TApplication<font color="#000080">)
                   </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">;
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>var
    </b></font>mydemo <font color="#000080">: </font>TMyApplication<font color="#000080">;

  </font><font color="#FF0000"><b>const
    </b></font>mdok   <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
    </font>mddone <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
    </font>mdbreak <font color="#000080">=</font><font color="#800000">2</font><font color="#000080">;
</font><font color="#008000"><i>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}

  </i></font><font color="#FF0000"><b>Constructor </b></font>TMyDialog<font color="#000080">.</font>Init<font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>r <font color="#000080">: </font>TRect<font color="#000080">;
      </font>p <font color="#000080">: </font>PParamText<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>r<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">41</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">);
      </font><font color="#FF0000"><b>Inherited </b></font>Init <font color="#000080">( </font>r<font color="#000080">, </font>mdtitle <font color="#000080">);
      </font>options <font color="#000080">:= </font>options <font color="#000080">+ </font>ofcentered<font color="#000080">;
      </font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
      </font>r<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
      </font>r<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
      </font>r<font color="#000080">.</font>Grow<font color="#000080">(-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
      </font>p <font color="#000080">:= </font>New<font color="#000080">(</font>PParamText<font color="#000080">, </font>Init<font color="#000080">(</font>r<font color="#000080">,  </font><font color="#800000">#3'%3d percent complete.'</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">));
      </font>p<font color="#000080">^.</font>ParamList <font color="#000080">:= @</font>percentage<font color="#000080">;
      </font>displayline <font color="#000080">:= </font>p<font color="#000080">;
      </font>Insert<font color="#000080">(</font>p<font color="#000080">);
      </font>total <font color="#000080">:= </font>totaltodo<font color="#000080">;
      </font>Update<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
      </font>Desktop<font color="#000080">^.</font>Insert<font color="#000080">(@</font>self<font color="#000080">);
      </font>TDialog<font color="#000080">.</font>Draw<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}

  </i></font><font color="#FF0000"><b>Function </b></font>TMyDialog<font color="#000080">.</font>Update <font color="#000080">( </font>currperc <font color="#000080">: </font>longint <font color="#000080">):</font>word<font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>event<font color="#000080">: </font>TEvent<font color="#000080">;
      </font>c    <font color="#000080">: </font>char<font color="#000080">;

    </font><font color="#FF0000"><b>Begin
      </b></font>progress <font color="#000080">:= </font>currperc<font color="#000080">;
      </font>percentage <font color="#000080">:= (</font>progress<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font>total<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Progress <font color="#000080">= </font>Total <font color="#FF0000"><b>then </b></font>Status <font color="#000080">:= </font>mdDone
        <font color="#FF0000"><b>else if </b></font>CtrlBreakHit <font color="#FF0000"><b>then
          begin
            </b></font>status <font color="#000080">:= </font>mdbreak<font color="#000080">;
            </font>CtrlBreakHit <font color="#000080">:= </font>False<font color="#000080">;
            </font>GetEvent<font color="#000080">(</font>event<font color="#000080">);
          </font><font color="#FF0000"><b>end
        else </b></font>status <font color="#000080">:= </font>mdok<font color="#000080">;
     </font>DrawView<font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Status <font color="#000080">= </font>mdDone<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>OnDone <font color="#FF0000"><b>then </b></font>HitAnyKey<font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Status <font color="#000080">= </font>mdBreak<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>OnBreak <font color="#FF0000"><b>then </b></font>HitAnyKey<font color="#000080">;
     </font>Update <font color="#000080">:= </font>Status<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}

  </i></font><font color="#FF0000"><b>Procedure </b></font>TmyDialog<font color="#000080">.</font>SetHitAnyKeyMode<font color="#000080">(</font>mode<font color="#000080">: </font>integer<font color="#000080">; </font>enable<font color="#000080">: </font>boolean<font color="#000080">);
     </font><font color="#FF0000"><b>begin
       case </b></font>mode <font color="#FF0000"><b>of
         </b></font>mdBreak<font color="#000080">: </font>OnBreak <font color="#000080">:= </font>enable<font color="#000080">;
         </font>mdDone <font color="#000080">: </font>OnDone  <font color="#000080">:= </font>enable<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}

  </i></font><font color="#FF0000"><b>Procedure </b></font>TMyDialog<font color="#000080">.</font>HitAnyKey<font color="#000080">;
    </font><font color="#FF0000"><b>var
    </b></font>event <font color="#000080">: </font>TEvent<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      If </b></font><font color="#000080">(((</font>Status<font color="#000080">=</font>mdDone<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>OnDone<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">((</font>Status<font color="#000080">=</font>mdBreak<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>OnBreak<font color="#000080">)) </font><font color="#FF0000"><b>then
      repeat
        </b></font>GetEvent<font color="#000080">(</font>Event<font color="#000080">)
      </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>What <font color="#000080">&lt;&gt; </font>evNothing<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}

  </i></font><font color="#FF0000"><b>Procedure </b></font>Tmydialog<font color="#000080">.</font>Draw<font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>buf <font color="#000080">: </font>TDrawBUffer<font color="#000080">;
      </font>r   <font color="#000080">: </font>TRect<font color="#000080">;
    </font><font color="#FF0000"><b>begin
     </b></font>GetExtent<font color="#000080">(</font>r<font color="#000080">);
     </font>r<font color="#000080">.</font>Grow<font color="#000080">(-</font><font color="#800000">1</font><font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">);
     </font>r<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">:= </font>r<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
     </font>Dec<font color="#000080">(</font>r<font color="#000080">.</font>B<font color="#000080">.</font>X<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>Status <font color="#000080">= </font>mdDone <font color="#FF0000"><b>then </b></font>MoveCStr<font color="#000080">(</font>buf<font color="#000080">, </font><font color="#800000">'      Successful: ~Press Any Key~      '</font><font color="#000080">,</font><font color="#800000">$9F1F</font><font color="#000080">)
     </font><font color="#FF0000"><b>else
       if </b></font>Status <font color="#000080">= </font>mdBreak <font color="#FF0000"><b>then </b></font>MoveCStr<font color="#000080">(</font>buf<font color="#000080">, </font><font color="#800000">'      Cancelled: ~Press Any Key~       '</font><font color="#000080">,</font><font color="#800000">$9F1F</font><font color="#000080">)
       </font><font color="#FF0000"><b>else </b></font>MoveStr<font color="#000080">(</font>buf<font color="#000080">, </font><font color="#800000">'     Press Ctrl-Break to Cancel       '</font><font color="#000080">,</font><font color="#800000">$1F</font><font color="#000080">);
     </font>displayline<font color="#000080">^.</font>DrawView<font color="#000080">;
     </font>WriteLine<font color="#000080">(</font>R<font color="#000080">.</font>A<font color="#000080">.</font>X<font color="#000080">, </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y<font color="#000080">, </font>R<font color="#000080">.</font>B<font color="#000080">.</font>X<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>buf<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}

  </i></font><font color="#FF0000"><b>Constructor </b></font>TMyApplication<font color="#000080">.</font>Init<font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>md <font color="#000080">: </font>PMyDialog<font color="#000080">;
      </font>i  <font color="#000080">: </font>longint<font color="#000080">;

    </font><font color="#FF0000"><b>begin
      Inherited </b></font>Init<font color="#000080">;
      </font>i <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>md <font color="#000080">:= </font>New <font color="#000080">( </font>PMyDialog<font color="#000080">, </font>Init <font color="#000080">( </font><font color="#800000">'Progress Demo'</font><font color="#000080">, </font><font color="#800000">50000</font><font color="#000080">));
      </font>md<font color="#000080">^.</font>SetHitAnyKeyMode<font color="#000080">(</font>mdBreak<font color="#000080">,</font>true<font color="#000080">);
      </font>md<font color="#000080">^.</font>SetHitAnyKeyMode<font color="#000080">(</font>mdDone<font color="#000080">,</font>true<font color="#000080">);
     </font><font color="#FF0000"><b>repeat
        </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
        </font>md<font color="#000080">^.</font>Update<font color="#000080">(</font>i<font color="#000080">);
      </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>md<font color="#000080">^.</font>Status <font color="#000080">= </font>mddone<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>md<font color="#000080">^.</font>Status<font color="#000080">=</font>mdBreak<font color="#000080">);
      </font>Dispose<font color="#000080">(</font>md<font color="#000080">, </font>done<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>mydemo<font color="#000080">.</font>Init<font color="#000080">;
  </font>mydemo<font color="#000080">.</font>Run<font color="#000080">;
  </font>mydemo<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p></body>
</html>
