<html>
<head><title> "Scrollbar Object" by WILLEM VAN DE VIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0047.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I recently made a SCROLLBAR object. it's pretty good and draws it's strings
directly to videomemory so no flashing etc.
}

</i></font><font color="#FF0000"><b>UNIT </b></font>scroller<font color="#000080">;

</font><font color="#008000"><i>{ scrolbar.init(left, top, maxright, maxbottom, startvalue)
 if maxright and maxbottom are high enough
 the windowsize will be adjusted automatically to
 the longest string in the data-array.
 Mind that the scroller stops counting as soon as
 an empty string is encountered, and everything below
 it will not be displayed.
 in order to save memory your application may write
 directly to scrollbar.data.

 scrollbar.return contains the return value, i.e. the index
 of the chosen element in the data-array.

  scroll.bar.incr/decr take an integer and increases/decreases
 scrollbar.return

  scrollbar.update should be called after each scrollbar.incr/decr
 to display the changes.

  scrollbar.borderhit is a boolean that becomes true
 when the user attempts to go past the first/last item in
 the list. This should be used BEFORE scrollbar.update, as
 that procedure sets both booleans to False.
  scrollbar.stop closes the window and restores the screen.

  willem van de vis
  s0730076@let.rug.nl

}

</i></font><font color="#FF0000"><b>Interface

const </b></font>max <font color="#000080">= </font><font color="#800000">200</font><font color="#000080">;
      </font>maxwidth <font color="#000080">= </font><font color="#800000">20</font><font color="#000080">;
</font><font color="#FF0000"><b>type
   </b></font>scrolldata <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>max<font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font>maxwidth<font color="#000080">];

</font><font color="#FF0000"><b>type </b></font>Scrollbar <font color="#000080">=
  </font><font color="#FF0000"><b>object
   private </b></font><font color="#008000"><i>{erase private and public for tp6.0}
    </i></font>top<font color="#000080">,
    </font>bottom<font color="#000080">,
    </font>left<font color="#000080">,
    </font>right<font color="#000080">,
    </font>total<font color="#000080">,
    </font>width<font color="#000080">,
    </font>len<font color="#000080">,
    </font>y<font color="#000080">,
    </font>b  <font color="#000080">: </font>integer<font color="#000080">;
    </font><font color="#FF0000"><b>public
    </b></font>data <font color="#000080">: </font>scrolldata<font color="#000080">;
    </font>return <font color="#000080">: </font>integer<font color="#000080">;
    </font>borderhit<font color="#000080">: </font>boolean<font color="#000080">;
                </font><font color="#FF0000"><b>constructor </b></font>init<font color="#000080">(</font>ileft<font color="#000080">,</font>itop<font color="#000080">, </font>iright<font color="#000080">,</font>ibottom<font color="#000080">,</font>iq<font color="#000080">: </font>integer<font color="#000080">);

    </font><font color="#FF0000"><b>destructor  </b></font>stop<font color="#000080">;
    </font><font color="#FF0000"><b>procedure   </b></font>update<font color="#000080">;
    </font><font color="#FF0000"><b>procedure   </b></font>incr<font color="#000080">(</font>i <font color="#000080">: </font>integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure   </b></font>decr<font color="#000080">(</font>d <font color="#000080">: </font>integer<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Implementation
uses </b></font>win<font color="#000080">, </font>crt<font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>scrollbar<font color="#000080">.</font>init<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>q <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin

 if </b></font>ibottom <font color="#000080">&gt; </font><font color="#800000">24 </font><font color="#FF0000"><b>then </b></font>ibottom <font color="#000080">:= </font><font color="#800000">24</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>itop <font color="#000080">&lt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>itop <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>ileft <font color="#000080">&lt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>ileft <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>iright <font color="#000080">&gt; </font><font color="#800000">78 </font><font color="#FF0000"><b>then </b></font>iright <font color="#000080">:= </font><font color="#800000">78</font><font color="#000080">;

    </font>return <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>b      <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>y      <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font>bottom <font color="#000080">:= </font>ibottom<font color="#000080">;
 </font>top    <font color="#000080">:= </font>itop<font color="#000080">;
 </font>len    <font color="#000080">:= (</font>bottom <font color="#000080">- </font>top<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
 </font>left   <font color="#000080">:= </font>ileft<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
 </font>right  <font color="#000080">:= </font>iright<font color="#000080">;
 </font>borderhit <font color="#000080">:= </font>false<font color="#000080">;
 </font>total <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font>width <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

 </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>total <font color="#000080">&lt;= </font>max<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>data<font color="#000080">[</font>total<font color="#000080">] &lt;&gt; </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>do
 begin
  if </b></font>length<font color="#000080">(</font>data<font color="#000080">[</font>total<font color="#000080">]) &gt; </font>width <font color="#FF0000"><b>then </b></font>width <font color="#000080">:= </font>length<font color="#000080">(</font>data<font color="#000080">[</font>total<font color="#000080">]);
  </font>data<font color="#000080">[</font>total<font color="#000080">] := </font>data<font color="#000080">[</font>total<font color="#000080">] +
 </font><font color="#800000">'                                                                   '</font><font color="#000080">;
  </font>inc<font color="#000080">(</font>total<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>dec<font color="#000080">(</font>total<font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font>total <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>total <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>width <font color="#000080">&lt; </font>right <font color="#000080">- </font>ileft <font color="#FF0000"><b>then </b></font>right <font color="#000080">:= </font>left <font color="#000080">+ </font>width
      <font color="#FF0000"><b>else </b></font>width <font color="#000080">:= </font>right<font color="#000080">-</font>ileft<font color="#000080">;
      </font>dec<font color="#000080">(</font>right<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>total <font color="#000080">&lt; </font>bottom <font color="#000080">- </font>itop <font color="#FF0000"><b>then </b></font>bottom <font color="#000080">:= </font>itop <font color="#000080">+ </font>total<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
      </font>open_win<font color="#000080">(</font>ileft<font color="#000080">, </font>itop<font color="#000080">, </font>right<font color="#000080">, </font>bottom<font color="#000080">, </font>lightgray<font color="#000080">, </font>blue<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>iq <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
    </b></font>scrollbar<font color="#000080">.</font>incr<font color="#000080">(</font>iq<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>scrollbar<font color="#000080">.</font>stop<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>close_win<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>scrollbar<font color="#000080">.</font>decr<font color="#000080">;
</font><font color="#FF0000"><b>begin
 if </b></font>return <font color="#000080">- </font>d <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
  </b></font>d <font color="#000080">:= </font>return<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>dec<font color="#000080">(</font>return<font color="#000080">,</font>d<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y <font color="#000080">- </font>d <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
   </b></font>b <font color="#000080">:= </font>return<font color="#000080">;
   </font>y <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
    </b></font>dec<font color="#000080">(</font>y<font color="#000080">,</font>d<font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font>d <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>borderhit <font color="#000080">:= </font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>scrollbar<font color="#000080">.</font>incr<font color="#000080">;
</font><font color="#FF0000"><b>begin
 if </b></font>return <font color="#000080">+ </font>i <font color="#000080">&gt; </font>total <font color="#FF0000"><b>then
 </b></font>i <font color="#000080">:= </font>total <font color="#000080">- </font>return<font color="#000080">;

  </font>inc<font color="#000080">(</font>return<font color="#000080">,</font>i<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y <font color="#000080">+ </font>i <font color="#000080">&gt; </font>len<font color="#000080">) </font><font color="#FF0000"><b>then
  begin
  </b></font>b <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">+ </font>return <font color="#000080">- </font>len<font color="#000080">;
   </font>y <font color="#000080">:= </font>len<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
    </b></font>inc<font color="#000080">(</font>y<font color="#000080">,</font>i<font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font>i <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>borderhit <font color="#000080">:= </font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>scrollbar<font color="#000080">.</font>update<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>borderhit <font color="#000080">:= </font>false<font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>b  <font color="#FF0000"><b>to </b></font>b <font color="#000080">+ </font>len<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
  if </b></font>i <font color="#000080">&lt;= </font>total <font color="#FF0000"><b>then

   if </b></font>i <font color="#000080">- </font>b <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">= </font>y <font color="#FF0000"><b>then
     </b></font>writeline<font color="#000080">(</font>data<font color="#000080">[</font>i<font color="#000080">],</font>left<font color="#000080">, </font>top<font color="#000080">+</font>i<font color="#000080">-</font>b<font color="#000080">, </font>width<font color="#000080">, </font>white<font color="#000080">,</font>black<font color="#000080">)
    </font><font color="#FF0000"><b>else
     </b></font>writeline<font color="#000080">(</font>data<font color="#000080">[</font>i<font color="#000080">],</font>left<font color="#000080">, </font>top<font color="#000080">+</font>i<font color="#000080">-</font>b<font color="#000080">, </font>width<font color="#000080">, </font>lightgray<font color="#000080">,</font>blue<font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>Mind that no pointers are used so there <font color="#FF0000"><b>IS </b></font>a max <font color="#FF0000"><b>to </b></font>the number <font color="#FF0000"><b>of </b></font>lines
displayed<font color="#000080">. </font>It may be neccesary <font color="#FF0000"><b>to </b></font>adjust width en right etc<font color="#000080">.

</font>an example <font color="#FF0000"><b>of </b></font>an application<font color="#000080">:

</font><font color="#FF0000"><b>uses </b></font>scroller<font color="#000080">,</font>ill<font color="#000080">,</font>crt<font color="#000080">,</font>win<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>scrol  <font color="#000080">: </font>scrollbar<font color="#000080">;
 </font>r   <font color="#000080">: </font>char<font color="#000080">;
 </font>chosen <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
 </font>F  <font color="#000080">: </font>TEXT<font color="#000080">;
 </font>q  <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin

</b></font>assign<font color="#000080">(</font>f<font color="#000080">, </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
</font>reset<font color="#000080">(</font>f<font color="#000080">);
</font>q <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

</font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>eof<font color="#000080">(</font>f<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>q <font color="#000080">&lt; </font><font color="#800000">500</font><font color="#000080">) </font><font color="#FF0000"><b>do
begin
 </b></font>readln<font color="#000080">(</font>f<font color="#000080">,</font>scrol<font color="#000080">.</font>data<font color="#000080">[</font>q<font color="#000080">]);
 </font><font color="#FF0000"><b>if </b></font>scrol<font color="#000080">.</font>data<font color="#000080">[</font>q<font color="#000080">] &lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
 </b></font>inc<font color="#000080">(</font>q<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>close<font color="#000080">(</font>f<font color="#000080">);

</font>ini_win<font color="#000080">;

</font>scrol<font color="#000080">.</font>init<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);

</font>r <font color="#000080">:= </font><font color="#800000">'!'</font><font color="#000080">;



</font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>r <font color="#000080">&lt;&gt; </font>chr<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>r <font color="#000080">&lt;&gt; </font>chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">)) </font><font color="#FF0000"><b>do
begin

 if </b></font>scrol<font color="#000080">.</font>borderhit <font color="#FF0000"><b>then </b></font>brom<font color="#000080">;
 </font>scrol<font color="#000080">.</font>update<font color="#000080">;
 </font>r <font color="#000080">:= </font>readkey<font color="#000080">;
 </font><font color="#FF0000"><b>case </b></font>r <font color="#FF0000"><b>of
  </b></font>chr<font color="#000080">(</font><font color="#800000">72</font><font color="#000080">) : </font>scrol<font color="#000080">.</font>decr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font>chr<font color="#000080">(</font><font color="#800000">80</font><font color="#000080">) : </font>scrol<font color="#000080">.</font>incr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font>chr<font color="#000080">(</font><font color="#800000">73</font><font color="#000080">) : </font>scrol<font color="#000080">.</font>decr<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
  </font>chr<font color="#000080">(</font><font color="#800000">81</font><font color="#000080">) : </font>scrol<font color="#000080">.</font>incr<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);

 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>chosen <font color="#000080">:= </font>scrol<font color="#000080">.</font>data<font color="#000080">[</font>scrol<font color="#000080">.</font>return<font color="#000080">];
</font>scrol<font color="#000080">.</font>stop<font color="#000080">;
</font><font color="#FF0000"><b>if </b></font>r <font color="#000080">&lt;&gt; </font>chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">) </font><font color="#FF0000"><b>then
begin
 </b></font>writeln<font color="#000080">(</font>chosen<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0047.PAS">Original</a><b>]</b></p></body>
</html>
