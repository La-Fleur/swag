<html>
<head><title> "CENTRDLG.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 &gt; The title says it all. What is the accepted way of bringing up a dialog
 &gt; box in the centre of the screen.
}
</i></font><font color="#FF0000"><b>Procedure </b></font>CenterDlg <font color="#000080">(</font>HWindow <font color="#000080">: </font>HWnd<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>R       <font color="#000080">: </font>TRect<font color="#000080">;
  </font>X       <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Y       <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Frame   <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Caption <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Frame   <font color="#000080">:= </font>GetSystemMetrics <font color="#000080">(</font>sm_CxFrame<font color="#000080">) * </font><font color="#800000">2</font><font color="#000080">;
  </font>Caption <font color="#000080">:= </font>GetSystemMetrics <font color="#000080">(</font>sm_CyCaption<font color="#000080">);
  </font>GetClientRect <font color="#000080">(</font>HWindow<font color="#000080">, </font>R<font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>R <font color="#FF0000"><b>do
    begin
    </b></font>X <font color="#000080">:= ((</font>GetSystemMetrics <font color="#000080">(</font>sm_CxScreen<font color="#000080">) - (</font>Right <font color="#000080">- </font>Left<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
    </font>Y <font color="#000080">:= ((</font>GetSystemMetrics <font color="#000080">(</font>sm_CyScreen<font color="#000080">) - (</font>Bottom <font color="#000080">- </font>Top<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
    </font>MoveWindow <font color="#000080">(</font>HWindow<font color="#000080">, </font>X<font color="#000080">, </font>Y <font color="#000080">- ((</font>Caption <font color="#000080">+ </font>Frame<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">),
      </font>Right <font color="#000080">+ </font>Frame<font color="#000080">, </font>Bottom <font color="#000080">+ </font>Frame <font color="#000080">+ </font>Caption<font color="#000080">, </font>False<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{
 Execute this Function from the dialog's SetupWindow method.
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p></body>
</html>
