<html>
<head><title> "Printing A tcollection" by BRIAN RICHARDSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0038.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>unit </b></font>BPrint<font color="#000080">;
</font><font color="#FF0000"><b>interface
uses </b></font>Objects<font color="#000080">, </font>Prt<font color="#000080">;   </font><font color="#008000"><i>{ Prt is included after! }
</i></font><font color="#FF0000"><b>procedure </b></font>PrintCollection<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Port <font color="#000080">: </font>word<font color="#000080">; </font>P <font color="#000080">: </font>PStringCollection<font color="#000080">); 
</font><font color="#FF0000"><b>implementation 
uses </b></font>MsgBox<font color="#000080">, </font>Views<font color="#000080">; 
</font><font color="#FF0000"><b>function </b></font>WriteStr<font color="#000080">(</font>Port <font color="#000080">: </font>word<font color="#000080">; </font>Str <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>boolean<font color="#000080">; 
</font><font color="#FF0000"><b>var </b></font>x <font color="#000080">: </font>boolean<font color="#000080">; 
    </font>q <font color="#000080">: </font>word<font color="#000080">;
    </font>i <font color="#000080">: </font>byte<font color="#000080">; 
</font><font color="#FF0000"><b>begin 
    repeat 
        </b></font>x <font color="#000080">:= </font>Ready<font color="#000080">(</font>Port<font color="#000080">); 
        </font><font color="#FF0000"><b>if not </b></font>x <font color="#FF0000"><b>then </b></font>q <font color="#000080">:= </font>MessageBox<font color="#000080">(^</font>C<font color="#800000">'Printer not Ready.  Try Again?'</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, 
                           </font>mfYesButton <font color="#000080">+ </font>mfNoButton <font color="#000080">+ </font>mfError<font color="#000080">); 
    </font><font color="#FF0000"><b>until </b></font>x <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>q <font color="#000080">= </font>cmNo<font color="#000080">); 
    </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Ready<font color="#000080">(</font>Port<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>q <font color="#000080">&lt;&gt; </font>cmNo<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i <font color="#000080">&lt;&gt; </font>Length<font color="#000080">(</font>Str<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do begin 
        </b></font>x <font color="#000080">:= </font>Ready<font color="#000080">(</font>Port<font color="#000080">); 
        </font><font color="#FF0000"><b>if not </b></font>x <font color="#FF0000"><b>then </b></font>q <font color="#000080">:= </font>MessageBox<font color="#000080">(^</font>C<font color="#800000">'Printer Error!  Try Again?'</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, 
                           </font>mfYesButton <font color="#000080">+ </font>mfNoButton <font color="#000080">+ </font>mfError<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>q <font color="#000080">&lt;&gt; </font>cmNo <font color="#FF0000"><b>then 
            if </b></font>WriteChar<font color="#000080">(</font>Port<font color="#000080">, </font>Str<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
    </font>WriteStr <font color="#000080">:= </font>False<font color="#000080">; 
    </font><font color="#FF0000"><b>if </b></font>Ready<font color="#000080">(</font>Port<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>q <font color="#000080">&lt;&gt; </font>cmNo<font color="#000080">) </font><font color="#FF0000"><b>then begin 
        </b></font>WriteChar<font color="#000080">(</font>Port<font color="#000080">, </font><font color="#800000">#13</font><font color="#000080">); 
        </font>WriteChar<font color="#000080">(</font>Port<font color="#000080">, </font><font color="#800000">#10</font><font color="#000080">); 
        </font>WriteStr <font color="#000080">:= </font>True<font color="#000080">; 
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>procedure </b></font>PrintCollection<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Port <font color="#000080">: </font>word<font color="#000080">; </font>P <font color="#000080">: </font>PStringCollection<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>x <font color="#000080">: </font>integer<font color="#000080">; 
    </font>q <font color="#000080">: </font>word<font color="#000080">; 
</font><font color="#FF0000"><b>begin 
    </b></font>q <font color="#000080">:= </font>MessageBox<font color="#000080">(^</font>C<font color="#800000">'To print, ready your printer and Press OK'</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, 
         </font>mfInformation <font color="#000080">+ </font>mfOkCancel<font color="#000080">); 
    </font><font color="#FF0000"><b>if </b></font>q <font color="#000080">= </font>cmOk <font color="#FF0000"><b>then begin 
        </b></font>x <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">; 
        </font><font color="#FF0000"><b>repeat 
            </b></font>inc<font color="#000080">(</font>x<font color="#000080">); 
        </font><font color="#FF0000"><b>until not </b></font>WriteStr<font color="#000080">(</font>Port<font color="#000080">, </font>PString<font color="#000080">(</font>P<font color="#000080">^.</font>At<font color="#000080">(</font>x<font color="#000080">))^) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>X <font color="#000080">= </font>P<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ----          CUT HERE  -------- }

</i></font><font color="#FF0000"><b>unit </b></font>Prt<font color="#000080">;
</font><font color="#FF0000"><b>interface 
uses </b></font>objects<font color="#000080">; 
</font><font color="#FF0000"><b>const 
    </b></font>Lpt1        <font color="#000080">=   </font><font color="#800000">0</font><font color="#000080">;                  </font>Lpt2        <font color="#000080">=   </font><font color="#800000">1</font><font color="#000080">; 
    </font>Lpt3        <font color="#000080">=   </font><font color="#800000">2</font><font color="#000080">;                  </font>lf          <font color="#000080">= </font><font color="#800000">#10</font><font color="#000080">; 
    </font>cr          <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">;                  </font>pTimeOut    <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">; 
    </font>pIOError    <font color="#000080">= </font><font color="#800000">$08</font><font color="#000080">;                  </font>pNoPaper    <font color="#000080">= </font><font color="#800000">$20</font><font color="#000080">; 
    </font>pNotBusy    <font color="#000080">= </font><font color="#800000">$80</font><font color="#000080">;
    </font>pTestAll    <font color="#000080">= </font>pTimeOut <font color="#000080">+ </font>pIOError <font color="#000080">+ </font>pNoPaper<font color="#000080">; 
</font><font color="#FF0000"><b>function </b></font>WriteChar<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>APort <font color="#000080">: </font>word<font color="#000080">; </font>s <font color="#000080">: </font>char<font color="#000080">): </font>boolean<font color="#000080">; 
</font><font color="#FF0000"><b>function </b></font>Ready<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>APort <font color="#000080">: </font>word<font color="#000080">): </font>boolean<font color="#000080">; 
</font><font color="#FF0000"><b>function </b></font>Status<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>APort <font color="#000080">: </font>word<font color="#000080">): </font>byte<font color="#000080">; 
</font><font color="#FF0000"><b>procedure </b></font>InitPrinter<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>APort <font color="#000080">: </font>word<font color="#000080">); 
</font><font color="#FF0000"><b>implementation 
procedure </b></font>InitPrinter<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>APort <font color="#000080">: </font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>asm 
    </b></font><font color="#FF00FF">mov     ah, 1 
    mov     bx, APort
    int     17h 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>Status<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>APort <font color="#000080">: </font>word<font color="#000080">): </font>byte<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>asm 
    </b></font><font color="#FF00FF">mov     ah, 2                   </font><font color="#008000"><i>{ Service 2 - Printer Status } 
    </i></font><font color="#FF00FF">mov     dx, APort             </font><font color="#008000"><i>{ Printer Port               } 
    </i></font><font color="#FF00FF">int     17h                     </font><font color="#008000"><i>{ ROM Printer Services       } 
    </i></font><font color="#FF00FF">mov     al, ah                  </font><font color="#008000"><i>{ Set function value         } 
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>function </b></font>Ready<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>APort <font color="#000080">: </font>word<font color="#000080">): </font>boolean<font color="#000080">; 
</font><font color="#FF0000"><b>begin 
    </b></font>Ready <font color="#000080">:= </font>Status<font color="#000080">(</font>APort<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>pTestAll <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">; 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>function </b></font>WriteChar<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>APort <font color="#000080">: </font>word<font color="#000080">; </font>s <font color="#000080">: </font>char<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin 
    if </b></font>Ready<font color="#000080">(</font>APort<font color="#000080">) </font><font color="#FF0000"><b>then 
     asm 
        </b></font><font color="#FF00FF">mov     ah, 0               </font><font color="#008000"><i>{ Printer Service - Write Char } 
        </i></font><font color="#FF00FF">mov     al, s               </font><font color="#008000"><i>{ Char to write                } 
        </i></font><font color="#FF00FF">mov     dx, APort           </font><font color="#008000"><i>{ Printer Port                 }
        </i></font><font color="#FF00FF">int     17h                 </font><font color="#008000"><i>{ ROM Printer Services         } 
        </i></font><font color="#FF00FF">mov     al, 0               </font><font color="#008000"><i>{ Set procedure to false       } 
        </i></font><font color="#FF00FF">and     ah, 1               </font><font color="#008000"><i>{ Check for Error              } 
        </i></font><font color="#FF00FF">jnz     @</font><font color="#FF0000"><b>End                </b></font><font color="#008000"><i>{ Jump to end if error         } 
        </i></font>mov     al<font color="#000080">, </font><font color="#800000">1               </font><font color="#008000"><i>{ Set procedure to true        } 
       </i></font><font color="#000080">@</font><font color="#FF0000"><b>End</b></font><font color="#000080">:
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ----------------   CUT HERE --------------------- }
{
    Here's a sample test program so you don't have to write one yourself
    :).
}

</i></font><font color="#FF0000"><b>uses </b></font>BPrint<font color="#000080">, </font>Prt<font color="#000080">;
 
</font><font color="#FF0000"><b>function </b></font>Int2Str<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>i <font color="#000080">: </font>longint<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>var </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>begin 
   </b></font>Str<font color="#000080">(</font>i<font color="#000080">, </font>s<font color="#000080">); 
   </font>Int2Str <font color="#000080">:= </font>s<font color="#000080">; 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>var </b></font>x <font color="#000080">: </font>integer<font color="#000080">; 
    </font>q <font color="#000080">: </font>PStringCollection<font color="#000080">; 
</font><font color="#FF0000"><b>begin 
    </b></font>q <font color="#000080">:= </font>New<font color="#000080">(</font>PStringCollection<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">)); 
    </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">64 </font><font color="#FF0000"><b>do </b></font>q<font color="#000080">^.</font>Insert<font color="#000080">(</font>NewStr<font color="#000080">(</font>Int2Str<font color="#000080">(</font>Random<font color="#000080">(</font><font color="#800000">4000</font><font color="#000080">)))); 
    </font>PrintCollection<font color="#000080">(</font>Lpt1 <font color="#008000"><i>{Change for your printer}</i></font><font color="#000080">, </font>q<font color="#000080">); 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">. 
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0038.PAS">Original</a><b>]</b></p></body>
</html>
