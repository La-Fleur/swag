<html>
<head><title> "Passing method as OBJect" by STUART MACLEAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Stuart Maclean

Hi there, I've found a neat way of passing an Object a method of its own
class, which it then executes. The idea comes from Smalltalk's
change/update mechanism For dependencies under the MVC paradigm.

Works under TP6.
}

</i></font><font color="#FF0000"><b>Type
  </b></font>DependentPtr <font color="#000080">= ^</font>Dependent<font color="#000080">;

  </font>Dependent <font color="#000080">= </font><font color="#FF0000"><b>Object
                Procedure </b></font>Update<font color="#000080">(</font>p <font color="#000080">: </font>Pointer<font color="#000080">);
                </font><font color="#FF0000"><b>Procedure </b></font>SomeMethod<font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Model <font color="#000080">= </font><font color="#FF0000"><b>Object
            </b></font>dep <font color="#000080">: </font>DependentPtr<font color="#000080">;
            </font><font color="#FF0000"><b>Procedure </b></font>Change<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Dependent<font color="#000080">.</font>Update<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">les di, self
  push es
  push di
  call dWord ptr p
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Dependent<font color="#000080">.</font>SomeMethod<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{ do something here }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Model<font color="#000080">.</font>Change<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>dep<font color="#000080">^.</font>Update<font color="#000080">(@</font>Dependent<font color="#000080">.</font>Somemethod<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>m <font color="#000080">: </font>Model<font color="#000080">;
  </font>d <font color="#000080">: </font>Dependent<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>m<font color="#000080">.</font>dep <font color="#000080">:= @</font>d<font color="#000080">; </font><font color="#008000"><i>{ add d as a dependent of m }
  </i></font>m<font color="#000080">.</font>Change<font color="#000080">;  </font><font color="#008000"><i>{ caUses d to be updated }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p></body>
</html>
