<html>
<head><title> "TV Broadcast Message" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0053.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
   This program will create two modaless dialog boxes and will
   allow only one Dialog2 dialog to be created at any time.

   Additionally, it will demonstrate how to broadcast messages to
   background windows and update information without changing
   the selected dialog.

}
{$X+}

</i></font><font color="#FF0000"><b>Program </b></font>DialogCommunication<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>Objects<font color="#000080">, </font>Drivers<font color="#000080">, </font>Views<font color="#000080">, </font>Menus<font color="#000080">, </font>Dialogs<font color="#000080">, </font>App<font color="#000080">, </font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>cmDialog1 <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;
  </font>cmDialog2 <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;
  </font>cmDialog1Button <font color="#000080">= </font><font color="#800000">200</font><font color="#000080">;
  </font>cmDialog2Button <font color="#000080">= </font><font color="#800000">201</font><font color="#000080">;

</font><font color="#FF0000"><b>type

 </b></font>PHelloApp <font color="#000080">= ^</font>THelloApp<font color="#000080">;
  </font>THelloApp <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>MakeDialog<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>InitMenuBar<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>InitStatusLine<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PMyDialog1 <font color="#000080">= ^</font>TMyDialog1<font color="#000080">;
  </font>TMyDialog1 <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>MakeDialog2<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PMyDialog2 <font color="#000080">= ^</font>TMyDialog2<font color="#000080">;
  </font>TMyDialog2 <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TMyDialog1<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyDialog1<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>AreYouThere<font color="#000080">: </font>PView<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>TDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evCommand <font color="#FF0000"><b>then
    begin
      case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
         </b></font>cmDialog1Button<font color="#000080">:
           </font><font color="#FF0000"><b>begin
             </b></font>AreYouThere<font color="#000080">:= </font><font color="#FF0000"><b>Message</b></font><font color="#000080">(</font>DeskTop<font color="#000080">, </font>evBroadcast<font color="#000080">, </font>cmDialog2<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
             </font><font color="#FF0000"><b>if </b></font>AreYouThere <font color="#000080">= </font><font color="#FF0000"><b>nil then
                </b></font>MakeDialog2
              <font color="#FF0000"><b>else
                </b></font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
           </font><font color="#FF0000"><b>end
      else
        </b></font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyDialog1<font color="#000080">.</font>MakeDialog2<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Dialog2<font color="#000080">: </font>PMyDialog2<font color="#000080">;
  </font>R<font color="#000080">: </font>TRect<font color="#000080">;
  </font>Button<font color="#000080">: </font>PButton<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);
  </font>Dialog2<font color="#000080">:= </font>New<font color="#000080">(</font>PMyDialog2<font color="#000080">, </font>init<font color="#000080">(</font>R<font color="#000080">,</font><font color="#800000">'Dialog2'</font><font color="#000080">));
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
  </font>Button<font color="#000080">:= </font>New<font color="#000080">(</font>PButton<font color="#000080">,</font>Init<font color="#000080">(</font>R<font color="#000080">,</font><font color="#800000">'Beep'</font><font color="#000080">, </font>cmDialog2Button<font color="#000080">, </font>bfdefault<font color="#000080">));
  </font>Dialog2<font color="#000080">^.</font>Insert<font color="#000080">(</font>Button<font color="#000080">);
  </font>DeskTop<font color="#000080">^.</font>Insert<font color="#000080">(</font>Dialog2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyDialog2<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
    </b></font>cmDialog2<font color="#000080">: </font><font color="#FF0000"><b>begin
                 </b></font>sound<font color="#000080">(</font><font color="#800000">2000</font><font color="#000080">); </font>delay<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">); </font>nosound<font color="#000080">;
                 </font>Title<font color="#000080">:=</font>newstr<font color="#000080">(</font><font color="#800000">'Hello world'</font><font color="#000080">);
                 </font>ReDraw<font color="#000080">;
                 </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>TDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evCommand <font color="#FF0000"><b>then
    begin
      case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
         </b></font>cmDialog2Button<font color="#000080">: </font><font color="#FF0000"><b>begin
                            </b></font>Sound<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">); </font>delay<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">); </font>NoSound<font color="#000080">;
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>else
        </b></font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ THelloApp }

</i></font><font color="#FF0000"><b>procedure </b></font>THelloApp<font color="#000080">.</font>MakeDialog<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>R<font color="#000080">:</font>TRect<font color="#000080">;
  </font>Button1<font color="#000080">: </font>PButton<font color="#000080">;
  </font>Dialog1<font color="#000080">: </font>PMyDialog1<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">65</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">);
  </font>Dialog1<font color="#000080">:= </font>New<font color="#000080">(</font>PMyDialog1<font color="#000080">, </font>init<font color="#000080">(</font>R<font color="#000080">,</font><font color="#800000">'Dialog1'</font><font color="#000080">));
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">38</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">);
  </font>Button1<font color="#000080">:= </font>New<font color="#000080">(</font>PButton<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">,</font><font color="#800000">'Call Dialog2'</font><font color="#000080">, </font>cmDialog1Button<font color="#000080">, </font>bfDefault<font color="#000080">));
  </font>Dialog1<font color="#000080">^.</font>Insert<font color="#000080">(</font>Button1<font color="#000080">);
  </font>DeskTop<font color="#000080">^.</font>Insert<font color="#000080">(</font>Dialog1<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>THelloApp<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>TApplication<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evCommand <font color="#FF0000"><b>then
    begin
      case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
         </b></font>cmDialog1<font color="#000080">:</font><font color="#FF0000"><b>begin
                     </b></font>MakeDialog<font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>else
        </b></font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>THelloApp<font color="#000080">.</font>InitMenuBar<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>MenuBar <font color="#000080">:= </font>New<font color="#000080">(</font>PMenuBar<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font>NewMenu<font color="#000080">(
    </font>NewSubMenu<font color="#000080">(</font><font color="#800000">'~O~pen Dialogs'</font><font color="#000080">, </font>hcNoContext<font color="#000080">, </font>NewMenu<font color="#000080">(
      </font>NewItem<font color="#000080">(</font><font color="#800000">'~D~ialog1'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>cmDialog1<font color="#000080">, </font>hcNoContext<font color="#000080">,
      </font>NewLine<font color="#000080">(
      </font>NewItem<font color="#000080">(</font><font color="#800000">'E~x~it'</font><font color="#000080">, </font><font color="#800000">'Alt-X'</font><font color="#000080">, </font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">,
        </font>hcNoContext<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)))), </font><font color="#FF0000"><b>nil</b></font><font color="#000080">))));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>THelloApp<font color="#000080">.</font>InitStatusLine<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>StatusLine <font color="#000080">:= </font>New<font color="#000080">(</font>PStatusLine<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">,
    </font>NewStatusDef<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$FFFF</font><font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">, </font>kbF10<font color="#000080">, </font>cmMenu<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~Alt-X~ Exit'</font><font color="#000080">, </font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)), </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>HelloWorld<font color="#000080">: </font>THelloApp<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>HelloWorld<font color="#000080">.</font>Init<font color="#000080">;
  </font>HelloWorld<font color="#000080">.</font>Run<font color="#000080">;
  </font>HelloWorld<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0053.PAS">Original</a><b>]</b></p></body>
</html>
