<html>
<head><title> "Different Colors in Turbo Vision" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Program </b></font>ColorTV<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>Objects<font color="#000080">, </font>Drivers<font color="#000080">, </font>Views<font color="#000080">, </font>Menus<font color="#000080">, </font>Dialogs<font color="#000080">, </font>App<font color="#000080">, </font>StdInput<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>cmButton  <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;
  </font>cmNewWin  <font color="#000080">= </font><font color="#800000">102</font><font color="#000080">;
  </font>cmNewDlg  <font color="#000080">= </font><font color="#800000">103</font><font color="#000080">;

  </font>WinCount <font color="#000080">: </font>integer <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;  </font><font color="#008000"><i>{ number of current windows }

</i></font><font color="#FF0000"><b>type

  </b></font>PApp <font color="#000080">= ^</font>TApp<font color="#000080">;
  </font>TApp <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>InitMenuBar<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>InitStatusLine<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event <font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>NewWindow<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>NewDialog<font color="#000080">;
    </font><font color="#FF0000"><b>function  </b></font>GetPalette <font color="#000080">: </font>PPalette<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PWin <font color="#000080">= ^</font>TWin<font color="#000080">;
  </font>TWin <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TWindow<font color="#000080">)
    </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font>Bounds<font color="#000080">: </font>TRect<font color="#000080">; </font>WinTitle<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
                     </font>WindowNo<font color="#000080">: </font>Word<font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>GetPalette <font color="#000080">: </font>PPalette<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PInLine <font color="#000080">= ^</font>TInLine<font color="#000080">;
  </font>TInLine <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TInputReal<font color="#000080">)
    </font><font color="#FF0000"><b>function </b></font>GetPalette <font color="#000080">: </font>PPalette<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PDlg <font color="#000080">= ^</font>TDlg<font color="#000080">;
  </font>TDlg <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
    </font><font color="#FF0000"><b>function </b></font>GetPalette <font color="#000080">: </font>PPalette<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{ TWin }
</i></font><font color="#FF0000"><b>constructor </b></font>TWin<font color="#000080">.</font>Init<font color="#000080">(</font>Bounds<font color="#000080">: </font>TRect<font color="#000080">; </font>WinTitle<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

                      </font>WindowNo<font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>R <font color="#000080">: </font>TRect<font color="#000080">;
  </font>MyInputLine <font color="#000080">: </font>PInLine<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Str<font color="#000080">(</font>WindowNo<font color="#000080">, </font>S<font color="#000080">);
  </font>TWindow<font color="#000080">.</font>Init<font color="#000080">(</font>Bounds<font color="#000080">, </font>WinTitle <font color="#000080">+ </font><font color="#800000">' ' </font><font color="#000080">+ </font>S<font color="#000080">, </font>wnNoNumber<font color="#000080">);
  </font>GetClipRect<font color="#000080">(</font>Bounds<font color="#000080">);
  </font>Bounds<font color="#000080">.</font>Grow<font color="#000080">(-</font><font color="#800000">1</font><font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">);

  </font><font color="#008000"><i>{ insert input string }
  </i></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
  </font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PInLine<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">12</font><font color="#000080">)));

  </font><font color="#008000"><i>{ insert button }
  </i></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">);
  </font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PButton<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'~O~k'</font><font color="#000080">, </font>cmButton<font color="#000080">, </font>bfDefault<font color="#000080">)));

  </font><font color="#008000"><i>{ move to the top }
  </i></font>SelectNext<font color="#000080">(</font>false<font color="#000080">);


</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TWin<font color="#000080">.</font>GetPalette <font color="#000080">: </font>PPalette<font color="#000080">;
</font><font color="#008000"><i>{ add color indexes to TWin to allow button to be displayed in }
{ the window.  notice that TButton's palette starts mapping    }
{ from 10 - 15, and TWindow's palette runs from 1 - 8, there-  }
{ fore add the indexes for the button on the end of TWin       }
{ palettes.                                                    }
</i></font><font color="#FF0000"><b>const
  </b></font>CWin <font color="#000080">= </font>CBlueWindow <font color="#000080">+ </font><font color="#800000">#0#41#42#43#44#45#64</font><font color="#000080">;
  </font>PWin <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font>Length<font color="#000080">(</font>CWin<font color="#000080">)] = </font>CWin<font color="#000080">;
</font><font color="#FF0000"><b>begin

  </b></font>GetPalette <font color="#000080">:= @ </font>PWin<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ TApp }
</i></font><font color="#FF0000"><b>procedure </b></font>TApp<font color="#000080">.</font>InitMenuBar<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Menu<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetExtent<font color="#000080">(</font>Menu<font color="#000080">);
  </font>Menu<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">:= </font>Menu<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>MenuBar <font color="#000080">:= </font>New<font color="#000080">(</font>PMenuBar<font color="#000080">, </font>Init<font color="#000080">(</font>Menu<font color="#000080">, </font>NewMenu<font color="#000080">(
    </font>NewSubMenu<font color="#000080">(</font><font color="#800000">'~W~indow'</font><font color="#000080">, </font>hcNoContext<font color="#000080">, </font>NewMenu<font color="#000080">(
      </font>NewItem<font color="#000080">(</font><font color="#800000">'~W~indow'</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">, </font>kbF4<font color="#000080">, </font>cmNewWin<font color="#000080">, </font>hcNoContext<font color="#000080">,
      </font>NewItem<font color="#000080">(</font><font color="#800000">'~D~ialog'</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">, </font>kbF5<font color="#000080">, </font>cmNewDlg<font color="#000080">, </font>hcNoContext<font color="#000080">,
      </font>NewLine<font color="#000080">(
      </font>NewItem<font color="#000080">(</font><font color="#800000">'~C~lose'</font><font color="#000080">, </font><font color="#800000">'Alt-F3'</font><font color="#000080">, </font>kbAltF3<font color="#000080">, </font>cmClose<font color="#000080">, </font>hcNoContext<font color="#000080">,
      </font>NewItem<font color="#000080">(</font><font color="#800000">'E~x~it'</font><font color="#000080">, </font><font color="#800000">'Alt-X'</font><font color="#000080">, </font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">, </font>hcNoContext<font color="#000080">,

      </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)))))),
    </font><font color="#FF0000"><b>nil</b></font><font color="#000080">))));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TApp<font color="#000080">.</font>InitStatusLine<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Line<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetExtent<font color="#000080">(</font>Line<font color="#000080">);
  </font>Line<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">:= </font>Line<font color="#000080">.</font>B<font color="#000080">.</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>StatusLine <font color="#000080">:= </font>New<font color="#000080">(</font>PStatusLine<font color="#000080">, </font>Init<font color="#000080">(</font>Line<font color="#000080">,
    </font>NewStatusDef<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$FFFF</font><font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">, </font>kbF10<font color="#000080">, </font>cmMenu<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~Alt-X~ Exit'</font><font color="#000080">, </font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~F4~ Window'</font><font color="#000080">, </font>kbF4<font color="#000080">, </font>cmNewWin<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~F5~ Dialog'</font><font color="#000080">, </font>kbF5<font color="#000080">, </font>cmNewDlg<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~Alt-F3~ Close'</font><font color="#000080">, </font>kbAltF3<font color="#000080">, </font>cmClose<font color="#000080">,
      </font><font color="#FF0000"><b>nil</b></font><font color="#000080">))))),

    </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TApp<font color="#000080">.</font>NewWindow<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Window <font color="#000080">: </font>PWin<font color="#000080">;
  </font>Box    <font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Inc<font color="#000080">(</font>WinCount<font color="#000080">);
  </font>Box<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
  </font>Box<font color="#000080">.</font>Move<font color="#000080">(</font>Random<font color="#000080">(</font><font color="#800000">34</font><font color="#000080">), </font>Random<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">));
  </font>Window <font color="#000080">:= </font>New<font color="#000080">(</font>PWin<font color="#000080">, </font>Init<font color="#000080">(</font>Box<font color="#000080">, </font><font color="#800000">'Test Window'</font><font color="#000080">, </font>WinCount<font color="#000080">));
  </font>DeskTop<font color="#000080">^.</font>Insert<font color="#000080">(</font>Window<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TApp<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>TApplication<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evCommand <font color="#FF0000"><b>then
  begin
    case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
      </b></font>cmNewWin <font color="#000080">: </font>NewWindow<font color="#000080">;
      </font>cmNewDlg <font color="#000080">: </font>NewDialog<font color="#000080">;

      </font>cmButton <font color="#000080">: ;
    </font><font color="#FF0000"><b>else
      </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TApp<font color="#000080">.</font>NewDialog<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Dialog     <font color="#000080">: </font>PDlg<font color="#000080">;
  </font>R          <font color="#000080">: </font>TRect<font color="#000080">;
  </font>C          <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin

  </b></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">55</font><font color="#000080">, </font><font color="#800000">13</font><font color="#000080">);
  </font>Dialog <font color="#000080">:= </font>New<font color="#000080">(</font>PDlg<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'Test Dialog'</font><font color="#000080">));

  </font><font color="#FF0000"><b>with </b></font>Dialog<font color="#000080">^ </font><font color="#FF0000"><b>do
  begin

    </b></font><font color="#008000"><i>{ message }
    </i></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
    </font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PStaticText<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'Error Message'</font><font color="#000080">)));

    </font><font color="#008000"><i>{ insert button }
    </i></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">);
    </font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PButton<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'~O~k'</font><font color="#000080">, </font>cmOK<font color="#000080">, </font>bfDefault<font color="#000080">)));


  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>C <font color="#000080">:= </font>DeskTop<font color="#000080">^.</font>ExecView<font color="#000080">(</font>Dialog<font color="#000080">);

  </font>Dispose<font color="#000080">(</font>Dialog<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TApp<font color="#000080">.</font>GetPalette <font color="#000080">: </font>PPalette<font color="#000080">;
</font><font color="#008000"><i>{ this is the palette that all other views are mapped to. }
{ the first 64 (0..63) are defined, any other colors are  }
{ added from 64 on.  the #$10 is for TWin for the back-   }
{ ground color for the button.  from $47 on maps the new  }
{ color for TDlg and its views.                           }
</i></font><font color="#FF0000"><b>const
  </b></font>CApp <font color="#000080">= </font>CColor <font color="#000080">+ </font><font color="#800000">#$10#$47#$4E#$40#$4F#$30#$3E</font><font color="#000080">;

  </font>PApp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font>Length<font color="#000080">(</font>CApp<font color="#000080">)] = </font>CApp<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetPalette <font color="#000080">:= @ </font>PApp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ TInLine }
</i></font><font color="#FF0000"><b>function </b></font>TInLine<font color="#000080">.</font>GetPalette <font color="#000080">: </font>PPalette<font color="#000080">;
</font><font color="#008000"><i>{ color indexes into TWin color palette }
</i></font><font color="#FF0000"><b>const
  </b></font>CInLine <font color="#000080">= </font><font color="#800000">#4#4#3#3</font><font color="#000080">;
  </font>PInLine <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font>Length<font color="#000080">(</font>CInLine<font color="#000080">)] = </font>CInLine<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetPalette <font color="#000080">:= @ </font>PInLine<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ TDlg }
</i></font><font color="#FF0000"><b>function </b></font>TDlg<font color="#000080">.</font>GetPalette <font color="#000080">: </font>PPalette<font color="#000080">;
</font><font color="#008000"><i>{ when replacing colors for a view must replace the entire   }
{ string.  notice that any color &gt; 63 maps to a user defined }
{ color from TApp's palette (65 = $47, 66 = $4E, etc.).      }

{ i.e.                                                       }
{ index 2, the active frame maps to 65 which is color $47    }
{          (or grey on red).                                 }
{ index 3, the frame icon maps to 66-&gt;$4E (yellow on red).   }
{ index 46, the button shadow maps to 67-&gt;$40 (black on rec).}
{ index 37, the statictext maps to 68-&gt;$47 (white on red).   }
{           (no reason 46 is before 38).                     }
{ index 41-43, button stuff 69-&gt;$30 (cyan on black).         }

{ index 45, button shortcut 70-&gt;$3E (cyan on yellow).        }
</i></font><font color="#FF0000"><b>const
  </b></font>CDlg <font color="#000080">= </font><font color="#800000">#32#65#66#35#36#68#38#39#40#69#69#69#44#70#67#47#48#49 </font><font color="#000080">+
         </font><font color="#800000">#50#51#52#53#54#55#56#57#58#59#60#61#62#63</font><font color="#000080">;
  </font>PDlg <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font>Length<font color="#000080">(</font>CDlg<font color="#000080">)] = </font>CDlg<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>GetPalette <font color="#000080">:= @ </font>PDlg<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>MyApp <font color="#000080">: </font>TApp<font color="#000080">;

</font><font color="#008000"><i>{ main }
</i></font><font color="#FF0000"><b>begin

  </b></font>MyApp<font color="#000080">.</font>Init<font color="#000080">;
  </font>MyApp<font color="#000080">.</font>Run<font color="#000080">;
  </font>MyApp<font color="#000080">.</font>Done<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p></body>
</html>
