<html>
<head><title> "FILEDLG2.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;Really like to see is a Real world example.  In particular a
&gt;collection of Filenames in the current directory sorted and  the
&gt;ability to scroll these Strings vertically.  I don't want to go

I don't know if this will help that much, but it does what you requested
&lt;g&gt;...  This Compiled in Real mode under BP7 and ran without problems. Although
untested in TP6, it should run fine.
}
</i></font><font color="#FF0000"><b>Program </b></font>Example<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>App<font color="#000080">,
  </font>Dialogs<font color="#000080">,
  </font>Drivers<font color="#000080">,
  </font>Menus<font color="#000080">,
  </font>MsgBox<font color="#000080">,
  </font>Objects<font color="#000080">,
  </font>StdDlg<font color="#000080">,
  </font>Views<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>cmAbout       <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>TExampleApp <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>Procedure </b></font>CM_About<font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>CM_Open<font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>InitStatusLine<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TExampleApp<font color="#000080">.</font>CM_About<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MessageBox<font color="#000080">(
    ^</font>C<font color="#800000">'Example O-O Program' </font><font color="#000080">+ </font><font color="#800000">#13 </font><font color="#000080">+ </font><font color="#800000">#13 </font><font color="#000080">+
    ^</font>C<font color="#800000">'by Bill Himmelstoss (1:112/57)'</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>mfInFormation <font color="#000080">+ </font>mfOkButton
  <font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TExampleApp<font color="#000080">.</font>CM_Open<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>FileDialog<font color="#000080">: </font>PFileDialog<font color="#000080">;
  </font>Filename<font color="#000080">: </font>FNameStr<font color="#000080">;
  </font>Result<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FileDialog <font color="#000080">:= </font>New<font color="#000080">(</font>PFileDialog<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">, </font><font color="#800000">'Open a File'</font><font color="#000080">, </font><font color="#800000">'~N~ame'</font><font color="#000080">,
    </font>fdOpenButton<font color="#000080">, </font><font color="#800000">100</font><font color="#000080">));
  </font><font color="#008000"><i>{$ifDEF VER70}
  </i></font>Result <font color="#000080">:= </font>ExecuteDialog<font color="#000080">(</font>FileDialog<font color="#000080">, @</font>Filename<font color="#000080">);
  </font><font color="#008000"><i>{$endif}
  {$ifDEF VER60}
  </i></font>Result <font color="#000080">:= </font>cmCancel<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>ValidView<font color="#000080">(</font>FileDialog<font color="#000080">) &lt;&gt; </font><font color="#FF0000"><b>nil then
    </b></font>Result <font color="#000080">:= </font>Desktop<font color="#000080">^.</font>ExecView<font color="#000080">(</font>FileDialog<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Result <font color="#000080">&lt;&gt; </font>cmCancel <font color="#FF0000"><b>then
    </b></font>FileDialog<font color="#000080">^.</font>GetFilename<font color="#000080">(</font>Filename<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>FileDialog<font color="#000080">, </font>Done<font color="#000080">);
  </font><font color="#008000"><i>{$endif}
  </i></font><font color="#FF0000"><b>if </b></font>Result <font color="#000080">&lt;&gt; </font>cmCancel <font color="#FF0000"><b>then
    </b></font>MessageBox<font color="#000080">(^</font>C<font color="#800000">'You chose '</font><font color="#000080">+</font>Filename<font color="#000080">+</font><font color="#800000">'.'</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>mfInFormation <font color="#000080">+ </font>mfOkButton<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TExampleApp<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{$ifDEF VER60}
  </i></font>TApplication<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#008000"><i>{$endif}
  {$ifDEF VER70}
  </i></font><font color="#FF0000"><b>inherited </b></font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#008000"><i>{$endif}

  </i></font><font color="#FF0000"><b>Case </b></font>Event<font color="#000080">.</font>What <font color="#FF0000"><b>of
    </b></font>evCommand<font color="#000080">:
    </font><font color="#FF0000"><b>begin
      Case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
        </b></font>cmAbout<font color="#000080">: </font>CM_About<font color="#000080">;
        </font>cmOpen<font color="#000080">: </font>CM_Open<font color="#000080">;
      </font><font color="#FF0000"><b>else
        </b></font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>TExampleApp<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{$ifDEF VER60}
  </i></font>TApplication<font color="#000080">.</font>Init<font color="#000080">;
  </font><font color="#008000"><i>{$endif}
  {$ifDEF VER70}
  </i></font><font color="#FF0000"><b>inherited </b></font>Init<font color="#000080">;
  </font><font color="#008000"><i>{$endif}

  </i></font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font>Event<font color="#000080">.</font>What <font color="#000080">:= </font>evCommand<font color="#000080">;
  </font>Event<font color="#000080">.</font>Command <font color="#000080">:= </font>cmAbout<font color="#000080">;
  </font>PutEvent<font color="#000080">(</font>Event<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TExampleApp<font color="#000080">.</font>InitStatusLine<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
  </font>StatusLine <font color="#000080">:= </font>New<font color="#000080">(</font>PStatusLine<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">,
    </font>NewStatusDef<font color="#000080">(</font><font color="#800000">$0000</font><font color="#000080">, </font><font color="#800000">$FFFF</font><font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~F3~ Open'</font><font color="#000080">, </font>kbF3<font color="#000080">, </font>cmOpen<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~Alt+X~ Exit'</font><font color="#000080">, </font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">,
    </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)),
  </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>ExampleApp<font color="#000080">: </font>TExampleApp<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ExampleApp<font color="#000080">.</font>Init<font color="#000080">;
  </font>ExampleApp<font color="#000080">.</font>Run<font color="#000080">;
  </font>ExampleApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p></body>
</html>
