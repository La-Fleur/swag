<html>
<head><title> "Two TVision dialogs on the screen" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0078.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
  The following  program demonstrates one technique for placing
  two dialogs on the screen at the same time in a Turbo Vision
  application. The key to this process is to make the first
  dialog a modeless dialog, and then the second can be either
  modal or modeless, depending on your needs. In this case,
  the second dialog is modal.

  When a modal dialog is on the screen, the user must close it
  before getting access to the other features in an application.

  For instance, a user cannot use the main programs menu while
  modal dialog is on the screen. This is not true of modeless
  dialogs. Modal dialogs are started with ExecView or ExecDialog.
  Modeless dialogs are &quot;Inserted&quot; into the desktop.
}

{$X+}
</i></font><font color="#FF0000"><b>Program </b></font>TwoDlgs<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>App<font color="#000080">,
  </font>Dialogs<font color="#000080">,
  </font>Drivers<font color="#000080">,
  </font>Menus<font color="#000080">,
  </font>MsgBox<font color="#000080">,
  </font>Views<font color="#000080">,
  </font>Objects<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>cmDialogBox <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;
  </font>cmPress2 <font color="#000080">= </font><font color="#800000">102</font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>Consistency <font color="#000080">= (</font>Solid<font color="#000080">, </font>Runny<font color="#000080">, </font>Melted<font color="#000080">);
  </font>Cheese <font color="#000080">= (</font>None<font color="#000080">, </font>Hvarti<font color="#000080">, </font>Tilset<font color="#000080">, </font>Jarlsberg<font color="#000080">);



  </font>PTrainDialog <font color="#000080">= ^</font>TTrainDialog<font color="#000080">;
  </font>TTrainDialog <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
    </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font>Bounds<font color="#000080">: </font>TRect<font color="#000080">; </font>ATitle<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Press2<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>TMyApp <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>InitMenuBar<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>InitStatusLine<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>DialogBox<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TTrainDialog<font color="#000080">.</font>Init<font color="#000080">(</font>Bounds<font color="#000080">: </font>TRect<font color="#000080">; </font>ATitle<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>var
  </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
  </font>Control<font color="#000080">: </font>PView<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>TDialog<font color="#000080">.</font>Init<font color="#000080">(</font>Bounds<font color="#000080">, </font>ATitle<font color="#000080">);

  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, (</font>Bounds<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">- </font>Bounds<font color="#000080">.</font>A<font color="#000080">.</font>Y<font color="#000080">) - </font><font color="#800000">12</font><font color="#000080">,
     (</font>Bounds<font color="#000080">.</font>B<font color="#000080">.</font>X <font color="#000080">- </font>Bounds<font color="#000080">.</font>A<font color="#000080">.</font>X<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">,
     (</font>Bounds<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">- </font>Bounds<font color="#000080">.</font>A<font color="#000080">.</font>Y<font color="#000080">) - </font><font color="#800000">3</font><font color="#000080">);
  </font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PButton<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'Click Here'</font><font color="#000080">,
     </font>cmPress2<font color="#000080">, </font>bfNormal<font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TTrainDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>TDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Event<font color="#000080">.</font>What <font color="#000080">= </font>EvCommand <font color="#FF0000"><b>then begin
    case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
      </b></font>cmPress2<font color="#000080">: </font>Press2<font color="#000080">;
      </font><font color="#FF0000"><b>else </b></font>Exit<font color="#000080">;

    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TTrainDialog<font color="#000080">.</font>Press2<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>D<font color="#000080">: </font>PDialog<font color="#000080">;
  </font>R<font color="#000080">: </font>TRect<font color="#000080">;
  </font>Control<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">48</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">74</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">);
  </font>D <font color="#000080">:= </font>New<font color="#000080">(</font>PDialog<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'Another Dialog'</font><font color="#000080">));
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">22</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">);
  </font>D<font color="#000080">^.</font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PButton<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'Click To Close'</font><font color="#000080">,
      </font>cmOk<font color="#000080">, </font>bfDefault<font color="#000080">)));

  </font>Control <font color="#000080">:= </font>DeskTop<font color="#000080">^.</font>ExecView<font color="#000080">(</font>D<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>D<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TMyApp<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>TApplication<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);

</font><font color="#FF0000"><b>begin
  </b></font>TApplication<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Event<font color="#000080">.</font>What <font color="#000080">= </font>EvCommand <font color="#FF0000"><b>then begin
    case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
      </b></font>cmDialogBox<font color="#000080">: </font>DialogBox<font color="#000080">;
    </font><font color="#FF0000"><b>else
      </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>InitMenuBar<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>MenuBar <font color="#000080">:= </font>New<font color="#000080">(</font>PMenuBar<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font>NewMenu<font color="#000080">(
    </font>NewSubMenu<font color="#000080">(</font><font color="#800000">'~F~ile'</font><font color="#000080">, </font>hcNoContext<font color="#000080">, </font>NewMenu<font color="#000080">(
      </font>NewItem<font color="#000080">(</font><font color="#800000">'~D~ialogs'</font><font color="#000080">, </font><font color="#800000">'Alt-D'</font><font color="#000080">, </font>kbAltD<font color="#000080">,
           </font>cmDialogBox<font color="#000080">, </font>hcNoContext<font color="#000080">,

      </font>NewLine<font color="#000080">(
      </font>NewItem<font color="#000080">(</font><font color="#800000">'E~x~it'</font><font color="#000080">, </font><font color="#800000">'Alt-X'</font><font color="#000080">, </font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">, </font>hcNoContext<font color="#000080">,
      </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)))),
    </font><font color="#FF0000"><b>nil</b></font><font color="#000080">))
  ));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>InitStatusLine<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
  </font>StatusLine <font color="#000080">:= </font>New<font color="#000080">(</font>PStatusLine<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">,
    </font>NewStatusDef<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$FFFF</font><font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">, </font>kbF10<font color="#000080">, </font>cmMenu<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~Alt-X~ Exit'</font><font color="#000080">, </font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~Alt-D~ Dialog'</font><font color="#000080">, </font>kbAltD<font color="#000080">, </font>cmDialogBox<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~Alt-F3~ Close'</font><font color="#000080">, </font>kbAltF3<font color="#000080">, </font>cmClose<font color="#000080">,

      </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)))),
    </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)
  ));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>DialogBox<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
  </font>D<font color="#000080">: </font>PDialog<font color="#000080">;
  </font>Control<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">);
  </font>D <font color="#000080">:= </font>New<font color="#000080">(</font>PTrainDialog<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'Training Dialog'</font><font color="#000080">));
  </font>DeskTop<font color="#000080">^.</font>Insert<font color="#000080">(</font>D<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>A<font color="#000080">: </font>TMyApp<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>A<font color="#000080">.</font>Init<font color="#000080">;
  </font>A<font color="#000080">.</font>Run<font color="#000080">;
  </font>A<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


 

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0078.PAS">Original</a><b>]</b></p></body>
</html>
