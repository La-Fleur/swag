<html>
<head><title> "T.V. Rubberband Example" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0074.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{************************************************}
{                                                }
{   Turbo Pascal for Windows                     }
{   Tips &amp; Techniques Demo Program               }
{   Copyright (c) 1991 by Borland International  }
{                                                }
{************************************************}

</i></font><font color="#FF0000"><b>Program </b></font>Rubberband<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>WObjects<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TApp  <font color="#000080">= </font><font color="#FF0000"><b>object </b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>InitMainWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PRubberWin <font color="#000080">= ^</font>TRubberWin<font color="#000080">;
  </font>TRubberWin <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TWindow<font color="#000080">)
    </font>DC <font color="#000080">: </font>HDC<font color="#000080">;
    </font>PS <font color="#000080">: </font>TPaintStruct<font color="#000080">;
    </font>ABrush<font color="#000080">: </font>hBrush<font color="#000080">;
    </font>APen<font color="#000080">: </font>hPen<font color="#000080">;
    </font>OTrack<font color="#000080">, </font>Track <font color="#000080">: </font>boolean<font color="#000080">;
    </font>NextX<font color="#000080">, </font>NextY<font color="#000080">, </font>OrgX<font color="#000080">, </font>OrgY<font color="#000080">, </font>PrevX<font color="#000080">, </font>PrevY<font color="#000080">, </font>X<font color="#000080">, </font>Y<font color="#000080">, </font>SX<font color="#000080">, </font>SY <font color="#000080">: </font>longint<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Destroy<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>WMLButtonDown<font color="#000080">(</font><font color="#FF0000"><b>var Message</b></font><font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>wm_First <font color="#000080">+ </font>wm_LButtonDown<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>WMLButtonUp<font color="#000080">(</font><font color="#FF0000"><b>var Message</b></font><font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>wm_First <font color="#000080">+ </font>wm_LButtonUp<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>WMMouseMove<font color="#000080">(</font><font color="#FF0000"><b>var Message</b></font><font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>wm_First <font color="#000080">+ </font>wm_MouseMove<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TApp<font color="#000080">.</font>InitMainWindow<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MainWindow <font color="#000080">:= </font>New<font color="#000080">(</font>PRubberWin<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">,</font><font color="#800000">'RUBBER BAND'</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TRubberWin<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>TWindow<font color="#000080">.</font>Destroy<font color="#000080">;
  </font>DeleteObject<font color="#000080">(</font>ABrush<font color="#000080">);
  </font>DeleteObject<font color="#000080">(</font>APen<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TRubberWin<font color="#000080">.</font>SetupWindow<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Track <font color="#000080">:= </font>False<font color="#000080">;
  </font>OTrack <font color="#000080">:= </font>True<font color="#000080">;
  </font>OrgX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>OrgY <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>PrevX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>PrevY <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>X <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Y <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>SX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>SY <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>ABrush <font color="#000080">:= </font>CreateSolidBrush<font color="#000080">(</font>RGB<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">));
  </font>APen <font color="#000080">:= </font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>RGB<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">255</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TRubberWin<font color="#000080">.</font>WMLButtonDown<font color="#000080">(</font><font color="#FF0000"><b>var Message</b></font><font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Track <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>with Message do
  begin
    </b></font>PrevX <font color="#000080">:= </font>lParamLo<font color="#000080">;
    </font>PrevY <font color="#000080">:= </font>lParamHi<font color="#000080">;
    </font>OrgX <font color="#000080">:= </font>PrevX<font color="#000080">;
    </font>OrgY <font color="#000080">:= </font>PrevY<font color="#000080">;

    </font><font color="#FF0000"><b>if </b></font>OTrack <font color="#FF0000"><b>then
    begin
      </b></font>SX <font color="#000080">:= </font>lParamLo<font color="#000080">;
      </font>SY <font color="#000080">:= </font>lParamHi<font color="#000080">;
      </font>OTrack <font color="#000080">:= </font>False<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>SetCapture<font color="#000080">(</font>HWindow<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TRubberWin<font color="#000080">.</font>WMLButtonUp<font color="#000080">(</font><font color="#FF0000"><b>var Message</b></font><font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>OldPen<font color="#000080">: </font>HPen<font color="#000080">;
  </font>OldBrush<font color="#000080">: </font>HBrush<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Track <font color="#000080">:= </font>False<font color="#000080">;
  </font>OTrack <font color="#000080">:= </font>True<font color="#000080">;
  </font>ReleaseCapture<font color="#000080">;
  </font>X <font color="#000080">:= </font>integer<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">.</font>lParamLo<font color="#000080">);
  </font>Y <font color="#000080">:= </font>integer<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">.</font>lParamHi<font color="#000080">);
  </font>DC <font color="#000080">:= </font>GetDC<font color="#000080">(</font>HWindow<font color="#000080">);
  </font>OldPen <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>DC<font color="#000080">, </font>APen<font color="#000080">);
  </font>OldBrush <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>DC<font color="#000080">, </font>ABrush<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>OrgX <font color="#000080">&lt;&gt; </font>X<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>OrgY <font color="#000080">&lt;&gt; </font>Y<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Ellipse<font color="#000080">(</font>DC<font color="#000080">, </font>OrgX<font color="#000080">, </font>OrgY<font color="#000080">, </font>X<font color="#000080">, </font>Y<font color="#000080">);
  </font>SelectObject<font color="#000080">(</font>DC<font color="#000080">, </font>OldPen<font color="#000080">);
  </font>SelectObject<font color="#000080">(</font>DC<font color="#000080">, </font>OldBrush<font color="#000080">);
  </font>ReleaseDC<font color="#000080">(</font>HWindow<font color="#000080">, </font>DC<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TRubberWin<font color="#000080">.</font>WMMouseMove<font color="#000080">(</font><font color="#FF0000"><b>var Message</b></font><font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Track <font color="#FF0000"><b>then
  begin
    </b></font>NextX <font color="#000080">:= </font>integer<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">.</font>lParamLo<font color="#000080">);
    </font>NextY <font color="#000080">:= </font>integer<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">.</font>lParamHi<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>NextX <font color="#000080">&lt;&gt; </font>PrevX<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>NextY <font color="#000080">&lt;&gt; </font>PrevY<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>DC <font color="#000080">:= </font>GetDC<font color="#000080">(</font>HWindow<font color="#000080">);
      </font>SetROP2<font color="#000080">(</font>DC<font color="#000080">, </font>r2_NOT<font color="#000080">);
      </font>SelectObject<font color="#000080">(</font>DC<font color="#000080">, </font>GetStockObject<font color="#000080">(</font>null_Brush<font color="#000080">));
      </font>Ellipse<font color="#000080">(</font>DC<font color="#000080">, </font>OrgX<font color="#000080">, </font>OrgY<font color="#000080">, </font>PrevX<font color="#000080">, </font>PrevY<font color="#000080">);
      </font>PrevX <font color="#000080">:= </font>NextX<font color="#000080">;
      </font>PrevY <font color="#000080">:= </font>NextY<font color="#000080">;
      </font>Ellipse<font color="#000080">(</font>DC<font color="#000080">, </font>SX<font color="#000080">, </font>SY<font color="#000080">, </font>PrevX<font color="#000080">, </font>PrevY<font color="#000080">);
      </font>ReleaseDC<font color="#000080">(</font>HWindow<font color="#000080">, </font>DC<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>App<font color="#000080">: </font>TApp<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>App<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#800000">'Rubber Band'</font><font color="#000080">);
  </font>App<font color="#000080">.</font>Run<font color="#000080">;
  </font>App<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0074.PAS">Original</a><b>]</b></p></body>
</html>
