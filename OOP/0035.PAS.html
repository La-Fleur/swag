<html>
<head><title> "Extended TV GADGETS" by DONN AULT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0035.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{********************************************************************}
{                                                                    }
{ Author:     Donn Ault                                              }
{ Date:       12/18/91                                               }
{ Purpose:    Extend clock view to show am/pm                        }
{             Extend heap view to include commas (more readable)     }
{ Copyright:  Donated to the public domain                           }
{                                                                    }
{ Notes:                                                             }
{  + In your main program you will need more space for the expanded  }
{    views.  The old clock uses 9 characters while the new           }
{    clock uses 12.  The old heap viewer uses 9 while the new one    }
{    uses 13.  Change the R.B.X occordingly.                         }
{                                                                    }
{********************************************************************}

</i></font><font color="#FF0000"><b>unit </b></font>xgadgets<font color="#000080">;

</font><font color="#008000"><i>{$F+,O+,S-,D-}

</i></font><font color="#FF0000"><b>interface

uses </b></font>Dos<font color="#000080">, </font>Objects<font color="#000080">, </font>Views<font color="#000080">, </font>App<font color="#000080">, </font>gadgets<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>PXHeapView <font color="#000080">= ^</font>TXHeapView<font color="#000080">;
  </font>TXHeapView <font color="#000080">= </font><font color="#FF0000"><b>object </b></font><font color="#000080">(</font>THeapView<font color="#000080">)
    </font><font color="#FF0000"><b>Procedure </b></font>Draw<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Function  </b></font>Comma <font color="#000080">( </font>N <font color="#000080">: </font>LongInt <font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>PXClockView <font color="#000080">= ^</font>TXClockView<font color="#000080">;
  </font>TXClockView <font color="#000080">= </font><font color="#FF0000"><b>Object </b></font><font color="#000080">(</font>TClockView<font color="#000080">)
    </font>am <font color="#000080">: </font>Char<font color="#000080">;
    </font><font color="#FF0000"><b>Function </b></font>FormatTimeStr <font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>Draw<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

uses </b></font>Drivers<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TXHeapView<font color="#000080">.</font>Comma <font color="#000080">( </font>n <font color="#000080">: </font>LongInt<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>num<font color="#000080">, </font>loc <font color="#000080">: </font>Byte<font color="#000080">;
    </font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>t <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Str <font color="#000080">(</font>n<font color="#000080">,</font>s<font color="#000080">);
  </font>Str <font color="#000080">(</font>n<font color="#000080">:</font>Size<font color="#000080">.</font>X<font color="#000080">,</font>t<font color="#000080">);

  </font>num <font color="#000080">:= </font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">3</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">3</font><font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>dec <font color="#000080">(</font>num<font color="#000080">);

  </font>delete <font color="#000080">(</font>t<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>num<font color="#000080">);
  </font>loc <font color="#000080">:= </font>length<font color="#000080">(</font>t<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">;

  </font><font color="#FF0000"><b>while </b></font>num <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  Begin
    </b></font>Insert <font color="#000080">(</font><font color="#800000">','</font><font color="#000080">,</font>t<font color="#000080">,</font>loc<font color="#000080">);
    </font>dec <font color="#000080">(</font>num<font color="#000080">);
    </font>dec <font color="#000080">(</font>loc<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>Comma <font color="#000080">:= </font>t<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TXHeapView<font color="#000080">.</font>Draw<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>B<font color="#000080">: </font>TDrawBuffer<font color="#000080">;
  </font>C<font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>OldMem <font color="#000080">:= </font>MemAvail<font color="#000080">;

  </font>S <font color="#000080">:= </font>Comma <font color="#000080">(</font>OldMem<font color="#000080">);
  </font>C <font color="#000080">:= </font>GetColor<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
  </font>MoveChar<font color="#000080">(</font>B<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>C<font color="#000080">, </font>Size<font color="#000080">.</font>X<font color="#000080">);
  </font>MoveStr<font color="#000080">(</font>B<font color="#000080">, </font>S<font color="#000080">, </font>C<font color="#000080">);
  </font>WriteLine<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Size<font color="#000080">.</font>X<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>B<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TXClockView<font color="#000080">.</font>Draw<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>B<font color="#000080">: </font>TDrawBuffer<font color="#000080">;
  </font>C<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>C <font color="#000080">:= </font>GetColor<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
  </font>MoveChar<font color="#000080">(</font>B<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>C<font color="#000080">, </font>Size<font color="#000080">.</font>X<font color="#000080">);
  </font>MoveStr<font color="#000080">(</font>B<font color="#000080">, </font>TimeStr <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">+</font>am<font color="#000080">+</font><font color="#800000">'m'</font><font color="#000080">, </font>C<font color="#000080">);     </font><font color="#008000"><i>{ Modified line }
  </i></font>WriteLine<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Size<font color="#000080">.</font>X<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>B<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TXClockView<font color="#000080">.</font>FormatTimeStr <font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  if </b></font>h <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  Begin
    </b></font>h <font color="#000080">:= </font><font color="#800000">12</font><font color="#000080">;
    </font>am <font color="#000080">:= </font><font color="#800000">'a'</font><font color="#000080">;
  </font><font color="#FF0000"><b>End
  Else if </b></font>h <font color="#000080">&gt; </font><font color="#800000">12 </font><font color="#FF0000"><b>then
  Begin
    </b></font>dec <font color="#000080">(</font>h<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
    </font>am <font color="#000080">:= </font><font color="#800000">'p'</font><font color="#000080">;
  </font><font color="#FF0000"><b>End
  Else </b></font>am <font color="#000080">:= </font><font color="#800000">'a'</font><font color="#000080">;
  </font>FormatTimeStr <font color="#000080">:= </font>TClockView<font color="#000080">.</font>FormatTimeStr <font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0035.PAS">Original</a><b>]</b></p></body>
</html>
