<html>
<head><title> "Defining array sizes" by KEN.BURROWS@TELOS.ORG</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 RJS&gt; Just a quick question... In the variable declaration field, you define
 RJS&gt; an array with array [0..9] of foo, But let's say I didn't know exactly
 RJS&gt; how big the array was going to be... How would I declare an array with
 RJS&gt; a variable endpoint?

There are a couple of ways around this, and they employ the use of pointers,
which in turn, require a little additional code to maintain. If you are useing
Borlands Pascal 6 or 7, the tCollection objects work quite well, or else make
use of linked lists. There is still the option of using a variable lengthed
array too.

As an example,
}
{$A+,B-,D-,E-,F+,G-,I-,L-,N-,O-,P-,Q-,R-,S-,T-,V-,X+,Y-}
{$M 16384,0,655360}
</i></font><font color="#FF0000"><b>Program </b></font>VariableArrayETC<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>objects<font color="#000080">;
</font><font color="#FF0000"><b>Type
   </b></font>Data <font color="#000080">= </font><font color="#FF0000"><b>Record
            </b></font>name <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
            </font>age  <font color="#000080">: </font>integer<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>VArray <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Data<font color="#000080">;   </font><font color="#008000"><i>{variable sized array}
  </i></font>VAPtr  <font color="#000080">= ^</font>Varray<font color="#000080">;

  </font>VLPtr <font color="#000080">= ^</font>VList<font color="#000080">;                 </font><font color="#008000"><i>{linked list}
  </i></font>VList <font color="#000080">= </font><font color="#FF0000"><b>Record
            </b></font>rec <font color="#000080">: </font>Data<font color="#000080">;
            </font>next<font color="#000080">,
            </font>prev<font color="#000080">: </font>VLPtr<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>DataPtr <font color="#000080">= ^</font>data<font color="#000080">;                </font><font color="#008000"><i>{OOP types from the objects unit}
  </i></font>VObj    <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>tCollection<font color="#000080">)
              </font><font color="#FF0000"><b>procedure </b></font>FreeItem<font color="#000080">(</font>item<font color="#000080">:</font>pointer<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>VObjPtr <font color="#000080">= ^</font>VObj<font color="#000080">;
              </font><font color="#FF0000"><b>Procedure </b></font>VObj<font color="#000080">.</font>FreeItem<font color="#000080">(</font>item<font color="#000080">:</font>pointer<font color="#000080">);
                 </font><font color="#FF0000"><b>begin
                   </b></font>dispose<font color="#000080">(</font>DataPtr<font color="#000080">(</font>item<font color="#000080">));
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>MakeTestFile<font color="#000080">;
   </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>integer<font color="#000080">;
       </font>f<font color="#000080">:</font><font color="#FF0000"><b>file of </b></font>Data<font color="#000080">;
       </font>d<font color="#000080">:</font>data<font color="#000080">;
   </font><font color="#FF0000"><b>Begin
     </b></font>writeln<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'blank name will exit'</font><font color="#000080">);
     </font>assign<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'test.dat'</font><font color="#000080">);
     </font>rewrite<font color="#000080">(</font>f<font color="#000080">);
     </font>fillchar<font color="#000080">(</font>d<font color="#000080">,</font>sizeof<font color="#000080">(</font>d<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
     </font><font color="#FF0000"><b>repeat
       </b></font>write<font color="#000080">(</font><font color="#800000">'name : '</font><font color="#000080">); </font>readln<font color="#000080">(</font>d<font color="#000080">.</font>name<font color="#000080">);
       </font><font color="#FF0000"><b>if   </b></font>d<font color="#000080">.</font>name <font color="#000080">&lt;&gt; </font><font color="#800000">''
       </font><font color="#FF0000"><b>then begin
              repeat
                </b></font>write<font color="#000080">(</font><font color="#800000">'age : '</font><font color="#000080">); </font>readln<font color="#000080">(</font>d<font color="#000080">.</font>age<font color="#000080">);
              </font><font color="#FF0000"><b>until </b></font>ioresult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
              </font>write<font color="#000080">(</font>f<font color="#000080">,</font>d<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>until </b></font>d<font color="#000080">.</font>name <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;
     </font>close<font color="#000080">(</font>f<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>VariableArrayExample<font color="#000080">; </font><font color="#008000"><i>{turn Range Checking off...}
   </i></font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;
       </font>v<font color="#000080">:</font>VAPtr<font color="#000080">;
       </font>i<font color="#000080">,</font>res<font color="#000080">:</font>integer<font color="#000080">;
       </font>d<font color="#000080">:</font>data<font color="#000080">;
       </font>m<font color="#000080">:</font>longint<font color="#000080">;
   </font><font color="#FF0000"><b>Begin
     </b></font>writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'output of variable array ... '</font><font color="#000080">);
     </font>m <font color="#000080">:= </font>memavail<font color="#000080">;
     </font>assign<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'test.dat'</font><font color="#000080">);
     </font>reset<font color="#000080">(</font>f<font color="#000080">,</font>sizeof<font color="#000080">(</font>data<font color="#000080">));
     </font>getmem<font color="#000080">(</font>v<font color="#000080">,</font>filesize<font color="#000080">(</font>f<font color="#000080">)*</font>SizeOf<font color="#000080">(</font>Data<font color="#000080">));
     </font>blockRead<font color="#000080">(</font>f<font color="#000080">,</font>v<font color="#000080">^,</font>filesize<font color="#000080">(</font>f<font color="#000080">),</font>res<font color="#000080">);
     </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>res <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
        begin
          </b></font>writeln<font color="#000080">(</font>v<font color="#000080">^[</font>i<font color="#000080">].</font>name<font color="#000080">);
          </font>writeln<font color="#000080">(</font>v<font color="#000080">^[</font>i<font color="#000080">].</font>age<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>freemem<font color="#000080">(</font>v<font color="#000080">,</font>filesize<font color="#000080">(</font>f<font color="#000080">)*</font>SizeOf<font color="#000080">(</font>Data<font color="#000080">));
     </font>close<font color="#000080">(</font>f<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>m <font color="#000080">&lt;&gt; </font>memavail <font color="#FF0000"><b>then </b></font>writeln<font color="#000080">(</font><font color="#800000">'heap ''a trouble...'</font><font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>LinkedListExample<font color="#000080">;
   </font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font><font color="#FF0000"><b>file of </b></font>Data<font color="#000080">;
       </font>curr<font color="#000080">,</font>hold <font color="#000080">: </font>VLPtr<font color="#000080">;
       </font>m<font color="#000080">:</font>longint<font color="#000080">;
   </font><font color="#FF0000"><b>Begin
     </b></font>curr <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">; </font>hold <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
     </font>writeln<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'Linked List example ... '</font><font color="#000080">);
     </font>m <font color="#000080">:= </font>memavail<font color="#000080">;
     </font>assign<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'test.dat'</font><font color="#000080">);
     </font>reset<font color="#000080">(</font>f<font color="#000080">);
     </font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>do
        begin
          </b></font>new<font color="#000080">(</font>curr<font color="#000080">);
          </font>curr<font color="#000080">^.</font>prev <font color="#000080">:= </font>hold<font color="#000080">;
          </font>read<font color="#000080">(</font>f<font color="#000080">,</font>curr<font color="#000080">^.</font>rec<font color="#000080">);
          </font>curr<font color="#000080">^.</font>next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>hold <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then </b></font>hold<font color="#000080">^.</font>next <font color="#000080">:= </font>curr<font color="#000080">;
          </font>hold <font color="#000080">:= </font>curr<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>close<font color="#000080">(</font>f<font color="#000080">);
    </font>hold <font color="#000080">:= </font>curr<font color="#000080">;
    </font><font color="#FF0000"><b>if   </b></font>hold <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil
    then begin
           while </b></font>hold<font color="#000080">^.</font>prev <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do </b></font>hold <font color="#000080">:= </font>hold<font color="#000080">^.</font>prev<font color="#000080">;
           </font><font color="#FF0000"><b>while </b></font>hold <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
           begin
             </b></font>writeln<font color="#000080">(</font>hold<font color="#000080">^.</font>rec<font color="#000080">.</font>name<font color="#000080">);
             </font>writeln<font color="#000080">(</font>hold<font color="#000080">^.</font>rec<font color="#000080">.</font>age<font color="#000080">);
             </font>hold <font color="#000080">:= </font>hold<font color="#000080">^.</font>next<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font>hold <font color="#000080">:= </font>curr<font color="#000080">;
           </font><font color="#FF0000"><b>while </b></font>hold <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
             begin
               </b></font>hold <font color="#000080">:= </font>curr<font color="#000080">^.</font>prev<font color="#000080">;
               </font>dispose<font color="#000080">(</font>curr<font color="#000080">);
               </font>curr <font color="#000080">:= </font>hold<font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>m <font color="#000080">&lt;&gt; </font>memavail <font color="#FF0000"><b>then </b></font>writeln<font color="#000080">(</font><font color="#800000">'heap ''a trouble...'</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>tCollectionExample<font color="#000080">;  </font><font color="#008000"><i>{requires the object unit}
   </i></font><font color="#FF0000"><b>var </b></font>p<font color="#000080">:</font>VObjPtr<font color="#000080">;
       </font>d<font color="#000080">:</font>DataPtr<font color="#000080">;
       </font>f<font color="#000080">:</font><font color="#FF0000"><b>file of </b></font>Data<font color="#000080">;
       </font>m<font color="#000080">:</font>longint<font color="#000080">;
   </font><font color="#FF0000"><b>procedure </b></font>WriteEm<font color="#000080">(</font>dp<font color="#000080">:</font>DataPtr<font color="#000080">); </font><font color="#FF0000"><b>far</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>begin
        </b></font>writeln<font color="#000080">(</font>dp<font color="#000080">^.</font>name<font color="#000080">);
        </font>writeln<font color="#000080">(</font>dp<font color="#000080">^.</font>age<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>begin
     </b></font>writeln<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'object tCollection example ... '</font><font color="#000080">);
     </font>m <font color="#000080">:= </font>memavail<font color="#000080">;
     </font>assign<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'test.dat'</font><font color="#000080">);
     </font>new<font color="#000080">(</font>p<font color="#000080">,</font>init<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
     </font>reset<font color="#000080">(</font>f<font color="#000080">);
     </font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>do
        begin
          </b></font>new<font color="#000080">(</font>d<font color="#000080">);
          </font>system<font color="#000080">.</font>read<font color="#000080">(</font>f<font color="#000080">,</font>d<font color="#000080">^);
          </font>p<font color="#000080">^.</font>insert<font color="#000080">(</font>d<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>close<font color="#000080">(</font>f<font color="#000080">);
     </font>p<font color="#000080">^.</font>forEach<font color="#000080">(@</font>WriteEm<font color="#000080">);
     </font>dispose<font color="#000080">(</font>p<font color="#000080">,</font>done<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>m <font color="#000080">&lt;&gt; </font>memavail <font color="#FF0000"><b>then </b></font>writeln<font color="#000080">(</font><font color="#800000">'heap ''a trouble...'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Begin
  </b></font>maketestfile<font color="#000080">;
  </font>variablearrayexample<font color="#000080">;
  </font>linkedListExample<font color="#000080">;
  </font>tcollectionExample<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p></body>
</html>
