<html>
<head><title> "Valid Directories" by LARRY HADLEY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
   For you TV programmers out there, here is a neat little
   TValidator object for you - it verifies that the DIRECTORY
   entered in a TInputLine is valid and currently exists.
}

</i></font><font color="#FF0000"><b>Unit </b></font>DirValid<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

Uses
  </b></font>Objects<font color="#000080">,
  </font>Validate<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>PDirValidator <font color="#000080">= ^</font>TDirValidator<font color="#000080">;
  </font>TDirValidator <font color="#000080">= </font><font color="#FF0000"><b>OBJECT</b></font><font color="#000080">(</font>TValidator<font color="#000080">)
    </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;

    </font><font color="#FF0000"><b>procedure </b></font>Error<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>IsValid<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

Uses
  </b></font>Dos<font color="#000080">,
  </font>MsgBox<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ExistDir<font color="#000080">(</font>d <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>S <font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font><font color="#008000"><i>{$I-}
  </i></font>FindFirst<font color="#000080">(</font>d<font color="#000080">, </font>Directory<font color="#000080">, </font>S<font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>if </b></font>DOSError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  BEGIN
    if </b></font>Directory <font color="#000080">= (</font>S<font color="#000080">.</font>attr <font color="#FF0000"><b>and </b></font>Directory<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>ExistDir <font color="#000080">:= </font>TRUE
    <font color="#FF0000"><b>ELSE
      </b></font>ExistDir <font color="#000080">:= </font>FALSE<font color="#000080">;
    </font><font color="#FF0000"><b>END
  ELSE
    </b></font>ExistDir <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TDirValidator<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Init<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure   </b></font>TDirValidator<font color="#000080">.</font>Error<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MessageBox<font color="#000080">(</font><font color="#800000">'Directory does not exist!'</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>mfError <font color="#000080">+ </font>mfOKButton<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function    </b></font>TDirValidator<font color="#000080">.</font>IsValid<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>d <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>s<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then  </b></font><font color="#008000"><i>{always return TRUE when entry string is empty}
  </i></font><font color="#FF0000"><b>begin
    </b></font>IsValid <font color="#000080">:= </font>TRUE<font color="#000080">;
    </font>EXIT<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>d <font color="#000080">:= </font>s<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>s<font color="#000080">[</font>Length<font color="#000080">(</font>d<font color="#000080">)] = </font><font color="#800000">'\' </font><font color="#FF0000"><b>then
    </b></font>Delete<font color="#000080">(</font>d<font color="#000080">, </font>Length<font color="#000080">(</font>d<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{allows flexibility - TV &amp; TP expect
                               paths to NOT terminate in a \ }
  </i></font><font color="#FF0000"><b>if </b></font>ExistDir<font color="#000080">(</font>d<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>IsValid <font color="#000080">:= </font>TRUE   <font color="#008000"><i>{directory exists}
  </i></font><font color="#FF0000"><b>else
    </b></font>IsValid <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#008000"><i>{directory does not exist}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p></body>
</html>
