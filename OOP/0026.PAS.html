<html>
<head><title> "Efficient Turbo Vision" by BRIAN RICHARDSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: BRIAN RICHARDSON
Subj: Efficient Tv2
---------------------------------------------------------------------------
 On 10-08-93 FRANK DERKS wrote to ALL...

  Hello All,

  for those who have read my other message (Efficient TV, Thu 07). Maybe
  some of you can expand on the following idea. How do I create a
  'dynamic' pick list box: a box that is displayed only when I have

  Or maybe more simple : what I'm after is a sort of inputline-object
  which can be cycled through a number of predefined values. }

</i></font><font color="#FF0000"><b>uses </b></font>objects<font color="#000080">, </font>app<font color="#000080">, </font>dialogs<font color="#000080">, </font>drivers<font color="#000080">;

</font><font color="#FF0000"><b>type
   </b></font>PRoomInputLine <font color="#000080">= ^</font>TRoomInputLine<font color="#000080">;
   </font>TRoomInputLine <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TInputLine<font color="#000080">)
     </font>StatusList <font color="#000080">: </font>PStringCollection<font color="#000080">;
     </font>Index      <font color="#000080">: </font>integer<font color="#000080">;

     </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Bounds<font color="#000080">: </font>TRect<font color="#000080">; </font>AMaxLen<font color="#000080">: </font>integer<font color="#000080">;
                      </font>AStatusList <font color="#000080">: </font>PStringCollection<font color="#000080">);
     </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event <font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>procedure </b></font>Up<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>procedure </b></font>Down<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>PRoomDialog <font color="#000080">= ^</font>TRoomDialog<font color="#000080">;
   </font>TRoomDialog <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
      </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font>List <font color="#000080">: </font>PStringCollection<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TRoomInputLine<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Bounds <font color="#000080">: </font>TRect<font color="#000080">; </font>AMaxLen<font color="#000080">: </font>Integer<font color="#000080">;
                              </font>AStatusList <font color="#000080">: </font>PStringCollection<font color="#000080">);
</font><font color="#FF0000"><b>begin
   inherited </b></font>Init<font color="#000080">(</font>Bounds<font color="#000080">, </font>AMaxLen<font color="#000080">);
   </font>StatusList <font color="#000080">:= </font>AStatusList<font color="#000080">;
   </font>Index <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>SetData<font color="#000080">(</font>PString<font color="#000080">(</font>StatusList<font color="#000080">^.</font>At<font color="#000080">(</font>Index<font color="#000080">))^);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TRoomInputLine<font color="#000080">.</font>Up<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>Index <font color="#000080">:= (</font>Index <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Mod </b></font>StatusList<font color="#000080">^.</font>Count<font color="#000080">;
   </font>SetData<font color="#000080">(</font>PString<font color="#000080">(</font>StatusList<font color="#000080">^.</font>At<font color="#000080">(</font>Index<font color="#000080">))^);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TRoomInputLine<font color="#000080">.</font>Down<font color="#000080">;
</font><font color="#FF0000"><b>begin
   if </b></font>Index <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Index <font color="#000080">:= (</font>StatusList<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>else
   </b></font>Dec<font color="#000080">(</font>Index<font color="#000080">);
   </font>SetData<font color="#000080">(</font>PString<font color="#000080">(</font>StatusList<font color="#000080">^.</font>At<font color="#000080">(</font>Index<font color="#000080">))^);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TRoomInputLine<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>begin
   if </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evKeyDown<font color="#000080">) </font><font color="#FF0000"><b>then begin
      case </b></font>Event<font color="#000080">.</font>KeyCode <font color="#FF0000"><b>of
         </b></font>kbUp     <font color="#000080">: </font>Up<font color="#000080">;
         </font>kbDown   <font color="#000080">: </font>Down<font color="#000080">;
      </font><font color="#FF0000"><b>else
      inherited </b></font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#FF0000"><b>end else
   inherited </b></font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TRoomDialog<font color="#000080">.</font>Init<font color="#000080">(</font>List <font color="#000080">: </font>PStringCollection<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">);
   </font><font color="#FF0000"><b>inherited </b></font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">);
   </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
   </font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PRoomInputLine<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font>List<font color="#000080">)));
   </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">);
   </font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PRoomInputLine<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font>List<font color="#000080">)));

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>RoomApp  <font color="#000080">: </font>TApplication<font color="#000080">;
   </font>List     <font color="#000080">: </font>PStringCollection<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>RoomApp<font color="#000080">.</font>Init<font color="#000080">;
   </font>List <font color="#000080">:= </font>New<font color="#000080">(</font>PStringCollection<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">));
   </font><font color="#FF0000"><b>with </b></font>List<font color="#000080">^ </font><font color="#FF0000"><b>do begin
      </b></font>Insert<font color="#000080">(</font>NewStr<font color="#000080">(</font><font color="#800000">'Vacant'</font><font color="#000080">)); </font>Insert<font color="#000080">(</font>NewStr<font color="#000080">(</font><font color="#800000">'Occupied'</font><font color="#000080">));
      </font>Insert<font color="#000080">(</font>NewStr<font color="#000080">(</font><font color="#800000">'Cleaning'</font><font color="#000080">));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>Application<font color="#000080">^.</font>ExecuteDialog<font color="#000080">(</font>New<font color="#000080">(</font>PRoomDialog<font color="#000080">, </font>Init<font color="#000080">(</font>List<font color="#000080">)), </font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
   </font>Dispose<font color="#000080">(</font>List<font color="#000080">, </font>Done<font color="#000080">);
   </font>RoomApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p></body>
</html>
