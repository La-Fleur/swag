<html>
<head><title> "TV Pick list example" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0058.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
The following example is to demonstrate the use of a Pick List.
This Pick List will read a line of data and validate the field
as well as keep a history of valid commands.
}
{$X+}
</i></font><font color="#FF0000"><b>Program </b></font>PickListExample<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>Objects<font color="#000080">, </font>App<font color="#000080">, </font>Menus<font color="#000080">, </font>Drivers<font color="#000080">, </font>Views<font color="#000080">, </font>Dialogs<font color="#000080">, </font>MsgBox<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>YourKeySet <font color="#000080">= </font><font color="#FF0000"><b>set of </b></font>char<font color="#000080">;

</font><font color="#FF0000"><b>const
   </b></font>cmMakeDialog <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;
   </font>ValidSet  <font color="#000080">: </font>YourKeySet <font color="#000080">= [</font><font color="#800000">#0</font><font color="#000080">..</font><font color="#800000">#31</font><font color="#000080">,</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">];

</font><font color="#FF0000"><b>type

  </b></font>PFInputLine <font color="#000080">= ^</font>TFInputLine<font color="#000080">;
  </font>TFInputLine <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TInputLine<font color="#000080">)
    </font>ValidKeys <font color="#000080">: </font>YourKeySet<font color="#000080">;
    </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Bounds<font color="#000080">: </font>TRect<font color="#000080">; </font>AMaxLen<font color="#000080">: </font>integer<font color="#000080">;
                     </font>ChrSet<font color="#000080">: </font>YourKeySet<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>GetData<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Rec<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetData<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Rec<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>DataSize<font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>PMyApp <font color="#000080">= ^</font>TMyApp<font color="#000080">;
</font>TMyApp <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
  </font><font color="#FF0000"><b>procedure </b></font>InitMenuBar<font color="#000080">;</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>InitStatusLine<font color="#000080">;</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>MakeDialog<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TFInputLine<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Bounds<font color="#000080">: </font>TRect<font color="#000080">; </font>AMaxLen<font color="#000080">: </font>integer<font color="#000080">;
                             </font>ChrSet<font color="#000080">: </font>YourKeySet<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>TInputLine<font color="#000080">.</font>Init<font color="#000080">(</font>Bounds<font color="#000080">,</font>AMaxLen<font color="#000080">);
  </font>ValidKeys<font color="#000080">:= </font>ChrSet<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFInputLine<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Number <font color="#000080">: </font>longint<font color="#000080">;
  </font>Code <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  case </b></font>Event<font color="#000080">.</font>What <font color="#FF0000"><b>of
    </b></font>evKeyDown <font color="#000080">:
      </font><font color="#FF0000"><b>begin
        if not</b></font><font color="#000080">(</font>Event<font color="#000080">.</font>CharCode <font color="#FF0000"><b>in </b></font>ValidKeys<font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">)
         </font><font color="#FF0000"><b>else
           if </b></font>Data<font color="#000080">^ &lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
             begin
               </b></font>val<font color="#000080">(</font>Data<font color="#000080">^, </font>Number<font color="#000080">, </font>Code<font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Code <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Number <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Number <font color="#000080">&gt; </font><font color="#800000">65535</font><font color="#000080">) </font><font color="#FF0000"><b>then
                 begin
                   </b></font>Data<font color="#000080">^ := </font><font color="#800000">''</font><font color="#000080">;
                   </font>MessageBox<font color="#000080">(</font><font color="#800000">'Valid number is 0 to 65536.'</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>mfOkButton<font color="#000080">);
                   </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>TInputLine<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFInputLine<font color="#000080">.</font>GetData<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Rec<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Code <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Val<font color="#000080">(</font>Data<font color="#000080">^,</font>word<font color="#000080">(</font>Rec<font color="#000080">), </font>Code<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFInputLine<font color="#000080">.</font>SetData<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Rec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Str<font color="#000080">(</font>word<font color="#000080">(</font>Rec<font color="#000080">),</font>Data<font color="#000080">^);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TFInputLine<font color="#000080">.</font>DataSize<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DataSize <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>word<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>InitMenuBar<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>MenuBar <font color="#000080">:= </font>New<font color="#000080">(</font>PMenuBar<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font>NewMenu<font color="#000080">(
    </font>NewSubMenu<font color="#000080">(</font><font color="#800000">'~T~est'</font><font color="#000080">, </font>hcNoContext<font color="#000080">, </font>NewMenu<font color="#000080">(
      </font>NewItem<font color="#000080">(</font><font color="#800000">'~D~ialog'</font><font color="#000080">,</font><font color="#800000">'F2'</font><font color="#000080">,</font>kbF2<font color="#000080">,</font>cmMakeDialog<font color="#000080">,</font>hcNoContext<font color="#000080">,
      </font>NewLine<font color="#000080">(
      </font>NewItem<font color="#000080">(</font><font color="#800000">'E~x~it'</font><font color="#000080">, </font><font color="#800000">'Alt-X'</font><font color="#000080">, </font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">, </font>hcNoContext<font color="#000080">,
      </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)))),</font><font color="#FF0000"><b>nil</b></font><font color="#000080">))));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>MakeDialog<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>R <font color="#000080">: </font>TRect<font color="#000080">;
 </font>Dialog <font color="#000080">: </font>PDialog<font color="#000080">;
 </font>D <font color="#000080">: </font>word<font color="#000080">;
 </font>InputLine <font color="#000080">: </font>PInputLine<font color="#000080">;
 </font>Lable<font color="#000080">,</font>Hist <font color="#000080">: </font>PView<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
 </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">);
 </font>Dialog <font color="#000080">:= </font>New<font color="#000080">(</font>PDialog<font color="#000080">,</font>Init<font color="#000080">(</font>R<font color="#000080">,</font><font color="#800000">'Demo Dialog'</font><font color="#000080">));
 </font><font color="#FF0000"><b>With </b></font>Dialog<font color="#000080">^ </font><font color="#FF0000"><b>do
   begin
     </b></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
     </font>InputLine <font color="#000080">:= </font>New<font color="#000080">(</font>PFInputLine<font color="#000080">,</font>Init<font color="#000080">(</font>R<font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font>ValidSet<font color="#000080">));
     </font>Insert<font color="#000080">(</font>InputLine<font color="#000080">);
     </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
     </font>Lable <font color="#000080">:= </font>New<font color="#000080">(</font>PLabel<font color="#000080">,</font>Init<font color="#000080">(</font>R<font color="#000080">,</font><font color="#800000">'InputLine'</font><font color="#000080">,</font>Inputline<font color="#000080">));
     </font>Insert<font color="#000080">(</font>Lable<font color="#000080">);
     </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
     </font>Hist <font color="#000080">:= </font>New<font color="#000080">(</font>PHistory<font color="#000080">,</font>Init<font color="#000080">(</font>R<font color="#000080">,</font>InputLine<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">));
     </font>Insert<font color="#000080">(</font>Hist<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>D <font color="#000080">:= </font>Desktop<font color="#000080">^.</font>ExecView<font color="#000080">(</font>Dialog<font color="#000080">);
 </font>Dispose<font color="#000080">(</font>Dialog<font color="#000080">,</font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>InitStatusLine<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>R <font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
 </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
 </font>StatusLine <font color="#000080">:=  </font>New<font color="#000080">(</font>PStatusLine<font color="#000080">,</font>Init<font color="#000080">(</font>R<font color="#000080">,
                  </font>NewStatusDef<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">$FFFF</font><font color="#000080">,
                    </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~A~lt-X'</font><font color="#000080">,</font>kbAltX<font color="#000080">,</font>cmQuit<font color="#000080">,
                </font><font color="#FF0000"><b>nil</b></font><font color="#000080">),</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>TApplication<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evCommand <font color="#FF0000"><b>then
  begin
    case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
      </b></font>cmMakeDialog<font color="#000080">: </font>MakeDialog<font color="#000080">;
    </font><font color="#FF0000"><b>else
      </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
 </b></font>MyApp<font color="#000080">: </font>TMyApp<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>MyApp<font color="#000080">.</font>Init<font color="#000080">;
 </font>MyApp<font color="#000080">.</font>Run<font color="#000080">;
 </font>MyApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0058.PAS">Original</a><b>]</b></p></body>
</html>
