<html>
<head><title> "TV Password Unit" by MARK VAN LEEUWEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0057.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>Passwd<font color="#000080">;
</font><font color="#008000"><i>{***************************************************************************
Written by Mark S. Van Leeuwen.
This Code is Public Domain.
Please Include my Name in any application that uses this code.
***************************************************************************}

</i></font><font color="#FF0000"><b>Interface

Uses </b></font>Objects<font color="#000080">,</font>Dialogs<font color="#000080">,</font>Views<font color="#000080">,</font>Drivers<font color="#000080">;

</font><font color="#FF0000"><b>Type
</b></font>PPasswordLine<font color="#000080">=^</font>TPasswordLine<font color="#000080">;
</font>TPasswordLine<font color="#000080">=</font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TInputline<font color="#000080">)
</font>Data1  <font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Bounds <font color="#000080">:</font>TRect<font color="#000080">; </font>AMaxLen <font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>GetData<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rec<font color="#000080">);</font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetData<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rec<font color="#000080">);</font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event <font color="#000080">:</font>TEvent<font color="#000080">);</font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Implementation

</b></font><font color="#008000"><i>{**************** Constructor for the Password Inputline Data **************}
</i></font><font color="#FF0000"><b>Constructor </b></font>TPasswordLine<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Bounds <font color="#000080">:</font>TRect<font color="#000080">; </font>AMaxlen <font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
</b></font>Data1<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
</font>TInputline<font color="#000080">.</font>Init<font color="#000080">(</font>Bounds<font color="#000080">,</font>AMaxLen<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{******************* Get Data from Procedure *******************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>TPasswordLine<font color="#000080">.</font>GetData<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rec<font color="#000080">);
</font><font color="#FF0000"><b>Begin
String</b></font><font color="#000080">(</font>Rec<font color="#000080">):=</font>Data1<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************** Set Data to Procedure **********************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>TPasswordLine<font color="#000080">.</font>SetData<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rec<font color="#000080">);
</font><font color="#FF0000"><b>Begin
</b></font>Data1<font color="#000080">:=</font><font color="#FF0000"><b>String</b></font><font color="#000080">(</font>Rec<font color="#000080">);
</font>SelectAll<font color="#000080">(</font>True<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{******************** Handle Inputline Event *******************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>TPasswordLine<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event <font color="#000080">:</font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>Var
</b></font>C <font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
</font><font color="#FF0000"><b>Begin
  With </b></font>Event <font color="#FF0000"><b>Do
    If </b></font><font color="#000080">(</font>What <font color="#000080">= </font>evKeyDown<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>KeyCode <font color="#000080">= </font>kbEsc<font color="#000080">) </font><font color="#FF0000"><b>Then
    Begin
      </b></font>What <font color="#000080">:= </font>Command<font color="#000080">;
      </font>Command <font color="#000080">:= </font>cmClose<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>Case </b></font>Event<font color="#000080">.</font>What <font color="#FF0000"><b>Of
    </b></font>evKeyDown<font color="#000080">:
      </font><font color="#FF0000"><b>Begin
         If</b></font><font color="#000080">(</font>UpCase<font color="#000080">(</font>Event<font color="#000080">.</font>CharCode<font color="#000080">) </font><font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">,</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">]) </font><font color="#FF0000"><b>Then
           Begin
         </b></font>C<font color="#000080">:=</font>Event<font color="#000080">.</font>CharCode<font color="#000080">;
         </font>Data1<font color="#000080">:=</font>Concat<font color="#000080">(</font>Data1<font color="#000080">,</font>C<font color="#000080">);
         </font>Event<font color="#000080">.</font>CharCode<font color="#000080">:=</font><font color="#800000">'*'</font><font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>If</b></font><font color="#000080">(</font>Event<font color="#000080">.</font>KeyCode <font color="#000080">= </font>kbBack<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>KeyCode <font color="#000080">= </font>kbDel<font color="#000080">) </font><font color="#FF0000"><b>Then
          Begin
          If</b></font><font color="#000080">(</font>Integer<font color="#000080">(</font>Data1<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>Then
            Begin
            </b></font>Dec<font color="#000080">(</font>Data1<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font>Event<font color="#000080">.</font>KeyCode<font color="#000080">:=</font>kbBack<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>evBroadcast<font color="#000080">:
      </font><font color="#FF0000"><b>Begin
      End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>TInputLine<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font><font color="#008000"><i>{ -----------------   DEMO ---------------- }

</i></font><font color="#FF0000"><b>Program </b></font>TestPwd<font color="#000080">;

</font><font color="#008000"><i>{***************************************************************************
Written by Mark S. Van Leeuwen.
This Code is Public Domain.
This is a Test Program that shows the use of the unit.
Please Include my Name in any application that uses this code.
***************************************************************************}

</i></font><font color="#FF0000"><b>Uses </b></font>Objects<font color="#000080">,</font>App<font color="#000080">,</font>Dialogs<font color="#000080">,</font>Drivers<font color="#000080">,</font>Passwd<font color="#000080">,</font>Views<font color="#000080">,</font>StdDlg<font color="#000080">,</font>MsgBox<font color="#000080">,</font>Menus<font color="#000080">;

</font><font color="#FF0000"><b>Const
</b></font>cmPassword <font color="#000080">= </font><font color="#800000">1001</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
</b></font>PTestApp<font color="#000080">=^</font>TTestApp<font color="#000080">;
</font>TTestApp<font color="#000080">=</font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
</font><font color="#FF0000"><b>Procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">);</font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>InitStatusLine<font color="#000080">;</font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TTestApp<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Password<font color="#000080">;
</font><font color="#FF0000"><b>Var
 </b></font>D         <font color="#000080">: </font>PDialog<font color="#000080">;
 </font>Control   <font color="#000080">: </font>Word<font color="#000080">;
 </font>A         <font color="#000080">: </font>PView<font color="#000080">;
 </font>R         <font color="#000080">: </font>TRect<font color="#000080">;
 </font>S         <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">08</font><font color="#000080">);
  </font>D <font color="#000080">:= </font>New<font color="#000080">(</font>PDialog<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'Enter Password'</font><font color="#000080">));
  </font><font color="#FF0000"><b>With </b></font>D<font color="#000080">^ </font><font color="#FF0000"><b>Do
  Begin
  </b></font>Options <font color="#000080">:= </font>Options <font color="#FF0000"><b>or </b></font>ofCentered<font color="#000080">;

    </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">02</font><font color="#000080">, </font><font color="#800000">05</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">07</font><font color="#000080">);
    </font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PButton<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'O~K'</font><font color="#000080">, </font>cmOk<font color="#000080">, </font>bfDefault<font color="#000080">)));

    </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">05</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">07</font><font color="#000080">);
    </font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PButton<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'~C~ancel'</font><font color="#000080">, </font>cmCancel<font color="#000080">, </font>bfNormal<font color="#000080">)));

    </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">02</font><font color="#000080">,</font><font color="#800000">03</font><font color="#000080">,</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">04</font><font color="#000080">);
    </font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PStaticText<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">,</font><font color="#800000">'Password is not Displayed.'</font><font color="#000080">)));

    </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">02</font><font color="#000080">,</font><font color="#800000">02</font><font color="#000080">,</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">03</font><font color="#000080">);
    </font>A<font color="#000080">:= </font>New<font color="#000080">(</font>PPasswordLine<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">,</font><font color="#800000">10</font><font color="#000080">));
    </font>Insert<font color="#000080">(</font>A<font color="#000080">);
    </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">02</font><font color="#000080">,</font><font color="#800000">01</font><font color="#000080">,</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">02</font><font color="#000080">);
    </font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>Plabel<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">,</font><font color="#800000">'Enter Password:'</font><font color="#000080">,</font>A<font color="#000080">)));

   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Control<font color="#000080">:=</font>Desktop<font color="#000080">^.</font>ExecView<font color="#000080">(</font>D<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>Control <font color="#000080">&lt;&gt; </font>cmCancel <font color="#FF0000"><b>THEN
      Begin
      </b></font>A<font color="#000080">^.</font>GetData<font color="#000080">(</font>S<font color="#000080">);
      </font>MessageBox<font color="#000080">(</font>S<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>mfInformation<font color="#000080">+</font>mfOkButton<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Dispose<font color="#000080">(</font>D<font color="#000080">, </font>Done<font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
 </b></font>TApplication<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>case </b></font>Event<font color="#000080">.</font>What <font color="#FF0000"><b>of
    </b></font>evCommand<font color="#000080">:
      </font><font color="#FF0000"><b>begin
        case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
         </b></font>cmPassword             <font color="#000080">: </font>Password<font color="#000080">;
         </font><font color="#FF0000"><b>else
          </b></font>Exit<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{***************************************************************************}
{**************** Application Status Line Procedure ************************}
{***************************************************************************}
 </i></font><font color="#FF0000"><b>Procedure </b></font>TTestApp<font color="#000080">.</font>InitStatusLine<font color="#000080">;
 </font><font color="#FF0000"><b>Var
 </b></font>R <font color="#000080">:</font>Trect<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
  </font>StatusLine <font color="#000080">:= </font>New<font color="#000080">(</font>PStatusLine<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">,
    </font>NewStatusDef<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$FFFF</font><font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~F1~ Help'</font><font color="#000080">, </font>kbF1<font color="#000080">, </font>cmHelp<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~F2~ Password'</font><font color="#000080">, </font>kbF2<font color="#000080">, </font>cmPassword<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~F10~ Menu'</font><font color="#000080">, </font>kbF10<font color="#000080">, </font>cmMenu<font color="#000080">,
      </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~Alt-X~ Exit'</font><font color="#000080">, </font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)))), </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Var
</b></font>TMyApp  <font color="#000080">:</font>TTestApp<font color="#000080">;

</font><font color="#FF0000"><b>Begin
</b></font>TMyapp<font color="#000080">.</font>Init<font color="#000080">;
</font>TMyapp<font color="#000080">.</font>Run<font color="#000080">;
</font>TMyapp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0057.PAS">Original</a><b>]</b></p></body>
</html>
