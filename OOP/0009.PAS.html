<html>
<head><title> "OOP-HTKY.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Yes, event oriented Programming is very easy using OOP, but as it
&gt; comes to TVision, if you need to add your own events, you're stuck. I
&gt; just wanted to implement the Windows-style ALT-Press-ALT-Release
&gt; event, that activates the Window menu, and I'd had to modify the
&gt; Drivers.pas sourceFile to implement it, so I have to find other keys
&gt; to activate the menu bar :-(

this Really stimulated me so I sat down and implemented the following *without*
messing around in DRIVERS.PAS in -believe it or not- 15 minutes!  :-)))
}
</i></font><font color="#FF0000"><b>Program </b></font>tryalt<font color="#000080">;

</font><font color="#FF0000"><b>Uses </b></font>drivers<font color="#000080">,</font>Objects<font color="#000080">,</font>views<font color="#000080">,</font>menus<font color="#000080">,</font>app<font color="#000080">,</font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>altmask <font color="#000080">= </font><font color="#800000">$8</font><font color="#000080">;
</font><font color="#FF0000"><b>Var   </b></font>k4017 <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$17</font><font color="#000080">;

</font><font color="#FF0000"><b>Type  </b></font>tmyapp <font color="#000080">= </font><font color="#FF0000"><b>Object </b></font><font color="#000080">(</font>TApplication<font color="#000080">)
        </font>AltPressed<font color="#000080">,
        </font>IgnoreAlt<font color="#000080">: </font>Boolean<font color="#000080">;
        </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">;
        </font><font color="#FF0000"><b>Procedure </b></font>InitMenuBar<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>Procedure </b></font>GetEvent <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>Procedure </b></font>Idle<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ low-level Function; returns True when &lt;Alt&gt; is being pressed }
</i></font><font color="#FF0000"><b>Function </b></font>AltDown<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>AltDown <font color="#000080">:= (</font>k4017 <font color="#FF0000"><b>and </b></font>altmask<font color="#000080">) = </font>altmask
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>tmyapp<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>init<font color="#000080">;
  </font>AltPressed <font color="#000080">:= </font>False<font color="#000080">;
  </font>IgnoreAlt <font color="#000080">:= </font>False
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Tmyapp<font color="#000080">.</font>InitMenuBar<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>MenuBar <font color="#000080">:= </font>New <font color="#000080">(</font>PMenuBar<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font>NewMenu <font color="#000080">(
    </font>NewSubMenu <font color="#000080">(</font><font color="#800000">'~&eth;~'</font><font color="#000080">, </font>hcNoConText<font color="#000080">, </font>NewMenu <font color="#000080">(
      </font>NewItem <font color="#000080">(</font><font color="#800000">'~A~bout LA-Copy...'</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">, </font>kbNoKey<font color="#000080">, </font>cmQuit<font color="#000080">, </font>hcNoConText<font color="#000080">,
      </font>NewLine <font color="#000080">(
      </font>NewItem <font color="#000080">(</font><font color="#800000">'~D~OS Shell'</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">, </font>kbNoKey<font color="#000080">, </font>cmQuit<font color="#000080">, </font>hcNoConText<font color="#000080">,
      </font>NewItem <font color="#000080">(</font><font color="#800000">'E~x~it'</font><font color="#000080">, </font><font color="#800000">'Alt-X'</font><font color="#000080">, </font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">, </font>hcNoConText<font color="#000080">,
      </font><font color="#FF0000"><b>nil</b></font><font color="#000080">))))),
    </font>NewSubMenu <font color="#000080">(</font><font color="#800000">'~R~ead'</font><font color="#000080">, </font>hcNoConText<font color="#000080">, </font>NewMenu <font color="#000080">(
      </font>NewItem <font color="#000080">(</font><font color="#800000">'~D~isk...'</font><font color="#000080">, </font><font color="#800000">'F5'</font><font color="#000080">, </font>kbF5<font color="#000080">, </font>cmQuit<font color="#000080">, </font>hcNoConText<font color="#000080">,
      </font>NewItem <font color="#000080">(</font><font color="#800000">'~I~mage File...'</font><font color="#000080">, </font><font color="#800000">'F6'</font><font color="#000080">, </font>kbF6<font color="#000080">, </font>cmQuit<font color="#000080">, </font>hcNoConText<font color="#000080">,
      </font>NewItem <font color="#000080">(</font><font color="#800000">'~S~ector...'</font><font color="#000080">, </font><font color="#800000">'F7'</font><font color="#000080">, </font>kbF7<font color="#000080">, </font>cmQuit<font color="#000080">, </font>hcNoConText<font color="#000080">,
      </font>NewLine <font color="#000080">(
      </font>NewItem <font color="#000080">(</font><font color="#800000">'~F~ree up used memory'</font><font color="#000080">, </font><font color="#800000">'F4'</font><font color="#000080">, </font>kbF4<font color="#000080">, </font>cmQuit<font color="#000080">, </font>hcNoConText<font color="#000080">,
      </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)))))),
    </font><font color="#008000"><i>(* more menus in the original :-) *)
    </i></font><font color="#FF0000"><b>nil</b></font><font color="#000080">)))));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ modified GetEvent to allow direct usage of Alt-Hotkey }
</i></font><font color="#FF0000"><b>Procedure </b></font>tmyapp<font color="#000080">.</font>GetEvent <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>GetEvent <font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>What <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>evKeyboard <font color="#FF0000"><b>or </b></font>evMessage<font color="#000080">)) &lt;&gt; </font>evnothing <font color="#FF0000"><b>then
    </b></font>IgnoreAlt <font color="#000080">:= </font>True               <font color="#008000"><i>{ in Case of keypress or command ignore }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                                </font><font color="#008000"><i>{ Until &lt;Alt&gt; next time released }

</i></font><font color="#FF0000"><b>Procedure </b></font>tmyapp<font color="#000080">.</font>Idle<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Idle<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>AltDown <font color="#FF0000"><b>then                      </b></font><font color="#008000"><i>{ &lt;Alt&gt; key is down }
    </i></font>AltPressed <font color="#000080">:= </font>True                   <font color="#008000"><i>{ remember this }
  </i></font><font color="#FF0000"><b>else begin                           </b></font><font color="#008000"><i>{ &lt;Alt&gt; is released (again?) }
    </i></font><font color="#FF0000"><b>if </b></font>AltPressed <font color="#FF0000"><b>then begin             </b></font><font color="#008000"><i>{ yes, again. }
      </i></font><font color="#FF0000"><b>if not </b></font>IgnoreAlt <font color="#FF0000"><b>then begin        </b></font><font color="#008000"><i>{ but: did they use Alt-Hotkey? }
        </i></font>Event<font color="#000080">.</font>What <font color="#000080">:= </font>evCommand<font color="#000080">;           </font><font color="#008000"><i>{ no, let's activate the menu! }
        </i></font>Event<font color="#000080">.</font>Command <font color="#000080">:= </font>cmMenu<font color="#000080">;
        </font>PutEvent <font color="#000080">(</font>Event<font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>AltPressed <font color="#000080">:= </font>False<font color="#000080">;                 </font><font color="#008000"><i>{ however, &lt;Alt&gt; is up again }
    </i></font>IgnoreAlt <font color="#000080">:= </font>False                   <font color="#008000"><i>{ so we don't need to ignore it }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                                   </font><font color="#008000"><i>{ the next time &lt;Alt&gt; is released }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>myapp<font color="#000080">: </font>tmyapp<font color="#000080">;     </font><font color="#008000"><i>{ create an Object of class 'tmyapp' }

</i></font><font color="#FF0000"><b>begin
  </b></font>myapp<font color="#000080">.</font>init<font color="#000080">;     </font><font color="#008000"><i>{ you know these three lines, don't you? &lt;g&gt; }
  </i></font>myapp<font color="#000080">.</font>run<font color="#000080">;
  </font>myapp<font color="#000080">.</font>done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
For convenience I copied the first three menus from my diskcopy clone so don't
get confused about the items :-).  This Program does not emulate Completely
Windows' behaviour, however, it's a good start. Tell me if this is what you
wanted! I didn't test it excessively but it does work in this fairly simple
Program For activating menus by &lt;Alt&gt;. The only thing not implemented is
'closing' the menu bar by a second &lt;Alt&gt; stroke.
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
