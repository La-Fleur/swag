<html>
<head><title> "XCDIALOG.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Johan: this code may help you out.  Keep With it, the learning curve
on TV is very steep.  Try the Fidonet TV Forum in Europe, or better
yet, the Compuserve BPascalA Forum.
}
{xcdialog.int}

{$X+}

</i></font><font color="#FF0000"><b>Unit </b></font>xcdialog<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses
  </b></font>Objects<font color="#000080">,</font>Drivers<font color="#000080">,</font>Views<font color="#000080">,</font>Menus<font color="#000080">,</font>Dialogs<font color="#000080">,</font>MsgBox<font color="#000080">,</font>App<font color="#000080">,</font>Crt<font color="#000080">,</font>Printer<font color="#000080">,
  </font>TVXCVars<font color="#000080">, </font>FmtLine<font color="#000080">, </font>XCMapL<font color="#000080">, </font>TVCalcL<font color="#000080">, </font>TVXCHelp<font color="#000080">, </font>File_ioL<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>PAspDialog <font color="#000080">= ^</font>TAspDialog<font color="#000080">;
  </font>TAspDialog <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PExitDialog <font color="#000080">= ^</font>TExitDialog<font color="#000080">;
  </font>TExitDialog <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ExitDialog<font color="#000080">;  </font><font color="#008000"><i>{asks user whether s/he want to quit or not}

</i></font><font color="#FF0000"><b>Implementation


Procedure </b></font>ExitDialog<font color="#000080">;
</font><font color="#008000"><i>{&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;&thorn;}
</i></font><font color="#FF0000"><b>Var
   </b></font>Dlg                       <font color="#000080">: </font>PAspDialog <font color="#000080">;
   </font>R                         <font color="#000080">: </font>TRect <font color="#000080">;
   </font>Control<font color="#000080">, </font>Labl             <font color="#000080">: </font>PView <font color="#000080">;
   </font>Event                     <font color="#000080">: </font>TEvent<font color="#000080">;
   </font>iStart                    <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>R<font color="#000080">.</font>Assign <font color="#000080">( </font><font color="#800000">10 </font><font color="#000080">, </font><font color="#800000">2 </font><font color="#000080">, </font><font color="#800000">60 </font><font color="#000080">, </font><font color="#800000">12 </font><font color="#000080">) ;
   </font>New <font color="#000080">( </font>Dlg <font color="#000080">, </font>Init <font color="#000080">( </font>R <font color="#000080">, </font><font color="#800000">'Exit Confirmation'</font><font color="#000080">) ) ;

   </font>iStart<font color="#000080">:= (</font><font color="#800000">50 </font><font color="#000080">- </font>length<font color="#000080">(</font><font color="#800000">'Are you SURE you want to Exit?'</font><font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
   </font><font color="#008000"><i>{centre Text}

   </i></font>R<font color="#000080">.</font>Assign <font color="#000080">( </font>iStart <font color="#000080">, </font><font color="#800000">3 </font><font color="#000080">, </font><font color="#800000">48 </font><font color="#000080">, </font><font color="#800000">4 </font><font color="#000080">) ;
   </font>Control <font color="#000080">:= </font>New <font color="#000080">( </font>PStaticText <font color="#000080">, </font>Init <font color="#000080">( </font>R <font color="#000080">, </font>length<font color="#000080">(</font><font color="#800000">'Are you SURE'
                    </font><font color="#000080">+</font><font color="#800000">' you want to Exit?' </font><font color="#000080">) ) ;
   </font>Dlg<font color="#000080">^.</font>Insert <font color="#000080">( </font>Control <font color="#000080">) ;

   </font>R<font color="#000080">.</font>Assign <font color="#000080">( </font><font color="#800000">10 </font><font color="#000080">, </font><font color="#800000">7 </font><font color="#000080">, </font><font color="#800000">21 </font><font color="#000080">, </font><font color="#800000">9 </font><font color="#000080">) ;
   </font>Control<font color="#000080">:= </font>New <font color="#000080">( </font>PButton <font color="#000080">, </font>Init <font color="#000080">( </font>R <font color="#000080">, </font>Words<font color="#000080">^.</font>get<font color="#000080">(</font>numYes<font color="#000080">) ,
                    </font>cmOK <font color="#000080">, </font>bfDefault <font color="#000080">) ) ;
   </font>Control<font color="#000080">^.</font>HelpCtx          <font color="#000080">:= </font>hcEnter <font color="#000080">;
   </font>Dlg<font color="#000080">^.</font>Insert <font color="#000080">( </font>Control <font color="#000080">) ;

   </font>R<font color="#000080">.</font>Assign <font color="#000080">( </font><font color="#800000">23 </font><font color="#000080">, </font><font color="#800000">7 </font><font color="#000080">, </font><font color="#800000">36 </font><font color="#000080">, </font><font color="#800000">9 </font><font color="#000080">) ;
   </font>Control <font color="#000080">:= </font>New <font color="#000080">( </font>PButton<font color="#000080">,</font>Init<font color="#000080">(</font>R <font color="#000080">, </font><font color="#800000">'Cancel'</font><font color="#000080">, </font>cmCancel <font color="#000080">, </font>bfNormal <font color="#000080">) ) ;
   </font>Control<font color="#000080">^.</font>HelpCtx          <font color="#000080">:= </font>hcCancelBtn <font color="#000080">;
   </font>Dlg<font color="#000080">^.</font>Insert <font color="#000080">( </font>Control <font color="#000080">) ;

   </font>Dlg<font color="#000080">^.</font>SelectNext <font color="#000080">( </font>False <font color="#000080">) ;

   </font><font color="#FF0000"><b>if  </b></font>Desktop<font color="#000080">^.</font>ExecView <font color="#000080">(</font>Dlg<font color="#000080">)  &lt;&gt; </font>cmCancel <font color="#FF0000"><b>then
   begin
    </b></font>Event<font color="#000080">.</font>What     <font color="#000080">:= </font>evCommand<font color="#000080">;
    </font>Event<font color="#000080">.</font>Command  <font color="#000080">:= </font>cmQuit<font color="#000080">;
    </font>Application<font color="#000080">^.</font>PutEvent<font color="#000080">(</font>Event<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>Dispose<font color="#000080">(</font>Dlg<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p></body>
</html>
