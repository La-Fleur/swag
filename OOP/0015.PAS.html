<html>
<head><title> "OOPOBJS.PAS" by SCOTT RAMSAY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>OopObjs<font color="#000080">;

</font><font color="#008000"><i>{ OOPOBJS.PAS  Version 1.1 Copyright 1992 Scott D. Ramsay }

{  OOPOBJS.PAS is free! Go crazy. }
{  When I was learning Linked-List in High School, I thought that I'd only  }
{ need it in boring stuff like database Programming.  Doubled linked-list,  }
{ is a great way to handle multiple Objects For games.  Throw in some OOP   }
{ design and Volia!  Easy managable sprites.                                }
{  I give this code to Public Domain.  Use it as you see fit.  Just include }
{ the first comment line when distributing the source code, Thanks.         }

{  Changes from 1.0:                                                        }
{    Added new parameter in method checkhit.                                }
{          Var item:pobj                                                    }
{      Is a Pointer to the Object which called the checkhit                 }

</i></font><font color="#FF0000"><b>Interface

Type
  </b></font>plist   <font color="#000080">= ^</font>tlist<font color="#000080">;
  </font>PObjs   <font color="#000080">= ^</font>tobjs<font color="#000080">;
  </font>tobjs   <font color="#000080">= </font><font color="#FF0000"><b>Object
              </b></font>nx<font color="#000080">,</font>ny<font color="#000080">,                       </font><font color="#008000"><i>{ Sprite Position               }
              </i></font>flp<font color="#000080">,                         </font><font color="#008000"><i>{ Sprite number (For animation) }
              </i></font>nrx<font color="#000080">,                         </font><font color="#008000"><i>{ I Forget what this does       }
              </i></font>num_sprite<font color="#000080">,                  </font><font color="#008000"><i>{ Num of sprites per Objects    }
              </i></font>timeo<font color="#000080">,                       </font><font color="#008000"><i>{ How long this Object lasts    }
              </i></font>pointage     <font color="#000080">: </font>Integer<font color="#000080">;      </font><font color="#008000"><i>{ Score value (For gamers)      }
              </i></font>mapcolor     <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{ Color For radar display       }
              </i></font>id<font color="#000080">,                          </font><font color="#008000"><i>{ I Forget this one too         }
              </i></font>explo<font color="#000080">,                       </font><font color="#008000"><i>{ True if the Object is explodin}
              </i></font>overshow     <font color="#000080">: </font>Boolean<font color="#000080">;      </font><font color="#008000"><i>{ See: Procedure DRAWITEMS      }
              </i></font>powner       <font color="#000080">: </font>plist<font color="#000080">;        </font><font color="#008000"><i>{ The PLIST node which this     }
                                           {  Object belongs               }
              </i></font><font color="#FF0000"><b>Constructor </b></font>init<font color="#000080">(</font>vx<font color="#000080">,</font>vy<font color="#000080">:</font>Integer<font color="#000080">);
              </font><font color="#FF0000"><b>Procedure </b></font>drawitemObject<font color="#000080">;</font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>Procedure </b></font>calcitemObject<font color="#000080">;</font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>Function </b></font>checkhit<font color="#000080">(</font>hx<font color="#000080">,</font>hy<font color="#000080">:</font>Integer<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>item<font color="#000080">:</font>pobjs<font color="#000080">):</font>Boolean<font color="#000080">;</font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>Destructor </b></font>done<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>PobjMov <font color="#000080">= ^</font>tobjMov<font color="#000080">;
  </font>tobjMov <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>tobjs<font color="#000080">)
              </font>ndx<font color="#000080">,</font>ndy <font color="#000080">: </font>Integer<font color="#000080">;
              </font><font color="#FF0000"><b>Constructor </b></font>init<font color="#000080">(</font>vx<font color="#000080">,</font>vy<font color="#000080">,</font>vdx<font color="#000080">,</font>vdy<font color="#000080">:</font>Integer<font color="#000080">);
              </font><font color="#FF0000"><b>Procedure </b></font>calcitemObject<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>tlist <font color="#000080">= </font><font color="#FF0000"><b>Record
            </b></font>item      <font color="#000080">: </font>pobjs<font color="#000080">;
            </font>prev<font color="#000080">,</font>next <font color="#000080">: </font>plist<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>pkill <font color="#000080">= ^</font>tkill<font color="#000080">;
  </font>tkill <font color="#000080">= </font><font color="#FF0000"><b>Record
            </b></font>tk   <font color="#000080">: </font>plist<font color="#000080">;
            </font>next <font color="#000080">: </font>pkill<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>addp<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">,</font>nkend<font color="#000080">,</font>p<font color="#000080">:</font>plist<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>deletep<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">,</font>nkend<font color="#000080">,</font>p<font color="#000080">:</font>plist<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>calcitems<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">:</font>plist<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>drawitems<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">:</font>plist<font color="#000080">;</font>over<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>add2kill_list<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>kill<font color="#000080">:</font>pkill<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>i<font color="#000080">:</font>plist<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>cleankill_list<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>kill<font color="#000080">:</font>pkill<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">,</font>nkend<font color="#000080">:</font>plist<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>clean_plist<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">,</font>nkend<font color="#000080">:</font>plist<font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Procedure </b></font>calcitems<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">:</font>plist<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>p <font color="#000080">: </font>plist<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>p <font color="#000080">:= </font>nkbeg<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>p<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil do
    begin
      </b></font>p<font color="#000080">^.</font>item<font color="#000080">^.</font>calcitemObject<font color="#000080">;
      </font>p <font color="#000080">:= </font>p<font color="#000080">^.</font>next<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>drawitems<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">:</font>plist<font color="#000080">;</font>over<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#008000"><i>{
  This Procedure is usually called from:  (GMorPH.PAS)
     Tmorph.pre_map
     Tmorph.post_map
  The OVER flag tells when this Object should be drawn.  Behind
   geomorph or infront of the geomorph.
}
</i></font><font color="#FF0000"><b>Var
  </b></font>p <font color="#000080">: </font>plist<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>p <font color="#000080">:= </font>nkbeg<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>p<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil do
    begin
      if </b></font><font color="#000080">(</font>p<font color="#000080">^.</font>item<font color="#000080">^.</font>overshow<font color="#000080">=</font>over<font color="#000080">)
        </font><font color="#FF0000"><b>then </b></font>p<font color="#000080">^.</font>item<font color="#000080">^.</font>drawitemObject<font color="#000080">;
      </font>p <font color="#000080">:= </font>p<font color="#000080">^.</font>next<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>clean_plist<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">,</font>nkend<font color="#000080">:</font>plist<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>p<font color="#000080">,</font>p2 <font color="#000080">: </font>plist<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>p <font color="#000080">:= </font>nkbeg<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>p<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil do
    begin
      </b></font>p2 <font color="#000080">:= </font>p<font color="#000080">;
      </font>p <font color="#000080">:= </font>p<font color="#000080">^.</font>next<font color="#000080">;
      </font>dispose<font color="#000080">(</font>p2<font color="#000080">^.</font>item<font color="#000080">,</font>done<font color="#000080">);
      </font>dispose<font color="#000080">(</font>p2<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>nkbeg <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>nkend <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>addp<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">,</font>nkend<font color="#000080">,</font>p<font color="#000080">:</font>plist<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>p<font color="#000080">^.</font>next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>nkend<font color="#000080">=</font><font color="#FF0000"><b>nil
    then
      begin
        </b></font>nkbeg <font color="#000080">:= </font>p<font color="#000080">;
        </font>nkend <font color="#000080">:= </font>p<font color="#000080">;
        </font>p<font color="#000080">^.</font>prev <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end
    else
      begin
        </b></font>p<font color="#000080">^.</font>prev <font color="#000080">:= </font>nkend<font color="#000080">;
        </font>nkend<font color="#000080">^.</font>next <font color="#000080">:= </font>p<font color="#000080">;
        </font>nkend <font color="#000080">:= </font>p<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>deletep<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">,</font>nkend<font color="#000080">,</font>p<font color="#000080">:</font>plist<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>nkbeg<font color="#000080">=</font>nkend
    <font color="#FF0000"><b>then
      begin
        </b></font>nkbeg <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
        </font>nkend <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end
    else
  if </b></font>nkbeg<font color="#000080">=</font>p
    <font color="#FF0000"><b>then
      begin
        </b></font>nkbeg <font color="#000080">:= </font>nkbeg<font color="#000080">^.</font>next<font color="#000080">;
        </font>nkbeg<font color="#000080">^.</font>prev <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end
    else
  if </b></font>nkend<font color="#000080">=</font>p
    <font color="#FF0000"><b>then
      begin
        </b></font>nkend <font color="#000080">:= </font>nkend<font color="#000080">^.</font>prev<font color="#000080">;
        </font>nkend<font color="#000080">^.</font>next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end
    else
      begin
        </b></font>p<font color="#000080">^.</font>next<font color="#000080">^.</font>prev <font color="#000080">:= </font>p<font color="#000080">^.</font>prev<font color="#000080">;
        </font>p<font color="#000080">^.</font>prev<font color="#000080">^.</font>next <font color="#000080">:= </font>p<font color="#000080">^.</font>next<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>dispose<font color="#000080">(</font>p<font color="#000080">^.</font>item<font color="#000080">,</font>done<font color="#000080">);
  </font>dispose<font color="#000080">(</font>p<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>cleankill_list<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>kill<font color="#000080">:</font>pkill<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>nkbeg<font color="#000080">,</font>nkend<font color="#000080">:</font>plist<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>p<font color="#000080">,</font>p2 <font color="#000080">: </font>pkill<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>p <font color="#000080">:= </font>kill<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>p<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil do
    begin
      </b></font>p2 <font color="#000080">:= </font>p<font color="#000080">;
      </font>p <font color="#000080">:= </font>p<font color="#000080">^.</font>next<font color="#000080">;
      </font>deletep<font color="#000080">(</font>nkbeg<font color="#000080">,</font>nkend<font color="#000080">,</font>p2<font color="#000080">^.</font>tk<font color="#000080">);
      </font>dispose<font color="#000080">(</font>p2<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>kill <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>add2kill_list<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>kill<font color="#000080">:</font>pkill<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>i<font color="#000080">:</font>plist<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>p <font color="#000080">: </font>pkill<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>new<font color="#000080">(</font>p<font color="#000080">);
  </font>p<font color="#000080">^.</font>tk <font color="#000080">:= </font>i<font color="#000080">;
  </font>p<font color="#000080">^.</font>next <font color="#000080">:= </font>kill<font color="#000080">;
  </font>kill <font color="#000080">:= </font>p
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(**) { tobjs Methods }

</i></font><font color="#FF0000"><b>Constructor </b></font>tobjs<font color="#000080">.</font>init<font color="#000080">(</font>vx<font color="#000080">,</font>vy<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>nx <font color="#000080">:= </font>vx<font color="#000080">; </font>ny <font color="#000080">:= </font>vy<font color="#000080">; </font>num_sprite <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>mapcolor <font color="#000080">:= </font><font color="#800000">$fb</font><font color="#000080">; </font>pointage <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>flp <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>overshow <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Destructor </b></font>tobjs<font color="#000080">.</font>done<font color="#000080">;
</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>tobjs<font color="#000080">.</font>drawitemObject<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ i.e.
     fbitdraw(nx,ny,pic[flip]^);
  }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>tobjs<font color="#000080">.</font>calcitemObject<font color="#000080">;
</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>tobjs<font color="#000080">.</font>checkhit<font color="#000080">(</font>hx<font color="#000080">,</font>hy<font color="#000080">:</font>Integer<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>item<font color="#000080">:</font>pobjs<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">;

</font><font color="#008000"><i>(**) { tobjMov methods }

</i></font><font color="#FF0000"><b>Constructor </b></font>tobjMov<font color="#000080">.</font>init<font color="#000080">(</font>vx<font color="#000080">,</font>vy<font color="#000080">,</font>vdx<font color="#000080">,</font>vdy<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>nx <font color="#000080">:= </font>vx<font color="#000080">; </font>ny <font color="#000080">:= </font>vy<font color="#000080">; </font>ndx <font color="#000080">:= </font>vdx<font color="#000080">; </font>ndy <font color="#000080">:= </font>vdy<font color="#000080">;
  </font>mapcolor <font color="#000080">:= </font><font color="#800000">$fb</font><font color="#000080">; </font>pointage <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>flp <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>overshow <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>tobjMov<font color="#000080">.</font>calcitemObject<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ These are just simple examples of what should go in the methods }
  </i></font>inc<font color="#000080">(</font>nx<font color="#000080">,</font>ndx<font color="#000080">); </font>inc<font color="#000080">(</font>ny<font color="#000080">,</font>ndy<font color="#000080">);
  </font>flp <font color="#000080">:= (</font>flp<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)</font><font color="#FF0000"><b>mod </b></font>num_sprite<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p></body>
</html>
