<html>
<head><title> "More On T.V. Listboxes" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0071.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
The following example will demonstrate how to create a listbox
of file items and enable the user to double click on any item and
produce a Message Box with the listbox item selected.
}
{$X+}
</i></font><font color="#FF0000"><b>Program </b></font>Simple_ListBox<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>Objects<font color="#000080">, </font>Drivers<font color="#000080">, </font>Views<font color="#000080">, </font>Menus<font color="#000080">, </font>Dialogs<font color="#000080">, </font>App<font color="#000080">, </font>Crt<font color="#000080">, </font>Dos<font color="#000080">, </font>MsgBox<font color="#000080">;

</font><font color="#FF0000"><b>Const
 </b></font>cmNewCollect <font color="#000080">= </font><font color="#800000">102</font><font color="#000080">;
 </font>DisableNewcollect<font color="#000080">: </font>TCommandSet <font color="#000080">= [</font><font color="#800000">102</font><font color="#000080">];

</font><font color="#FF0000"><b>Type

 </b></font>Tmyapp <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>Tapplication<font color="#000080">)
     </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">;
     </font><font color="#FF0000"><b>Procedure </b></font>Initstatusline<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Procedure </b></font>Initmenubar<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Procedure </b></font>NewCollect<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>PListBox <font color="#000080">= ^</font>RListBox<font color="#000080">;
  </font>RListBox <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TlistBox<font color="#000080">)
    </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Bounds<font color="#000080">:</font>TRect<font color="#000080">; </font>ANumCols<font color="#000080">:</font>Word<font color="#000080">; </font>AScrollBar<font color="#000080">:
                         </font>PScrollBar<font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>Process<font color="#000080">;
    </font><font color="#FF0000"><b>Destructor </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>PMyDialog <font color="#000080">= ^</font>MyDialog<font color="#000080">;
  </font>Mydialog <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>Tdialog<font color="#000080">)
    </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>bounds<font color="#000080">:</font>trect<font color="#000080">; </font>MyTitle<font color="#000080">:</font>ttitlestr<font color="#000080">);
    </font><font color="#FF0000"><b>Destructor </b></font>done<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>NameList<font color="#000080">: </font>PstringCollection<font color="#000080">;
  </font>Plist<font color="#000080">: ^</font>Rlistbox<font color="#000080">;
  </font>MyApp<font color="#000080">: </font>Tmyapp<font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>Mydialog<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Bounds<font color="#000080">:</font>TRect<font color="#000080">; </font>MyTitle<font color="#000080">: </font>TTitleStr<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>TDialog<font color="#000080">.</font>Init<font color="#000080">(</font>Bounds<font color="#000080">, </font>MyTitle<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Destructor </b></font>Mydialog<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TDialog<font color="#000080">.</font>done<font color="#000080">;
  </font>Dispose<font color="#000080">(</font>NameList<font color="#000080">, </font>Done<font color="#000080">);
  </font>EnableCommands<font color="#000080">(</font>DisableNewCollect<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>MyDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Index<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>Double <font color="#000080">= </font>true<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evNothing<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>sound<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">);
      </font>delay<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">);
      </font>nosound<font color="#000080">;
      </font>Index<font color="#000080">:=(</font>Plist<font color="#000080">^.</font>Focused<font color="#000080">);
      </font>Messagebox<font color="#000080">(</font>Plist<font color="#000080">^.</font>GetText<font color="#000080">(</font>Index<font color="#000080">,</font><font color="#800000">20</font><font color="#000080">) ,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>mfOkButton<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>TMyapp<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TApplication<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>RListBox<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Bounds<font color="#000080">:</font>TRect<font color="#000080">; </font>ANumCols<font color="#000080">:</font>Word<font color="#000080">;</font>AScrollBar<font color="#000080">:
                          </font>PScrollBar<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>TListBox<font color="#000080">.</font>Init<font color="#000080">(</font>Bounds<font color="#000080">, </font>ANumCols<font color="#000080">, </font>AScrollBar<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Destructor </b></font>RListBox<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Tlistbox<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyApp<font color="#000080">.</font>InitStatusLine<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>R<font color="#000080">:</font>Trect<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>Statusline <font color="#000080">:=</font>new<font color="#000080">(</font>Pstatusline<font color="#000080">, </font>init<font color="#000080">(</font>R<font color="#000080">,
  </font>NewStatusDef<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">$FFFF</font><font color="#000080">,
  </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~Alt-X~ Exit'</font><font color="#000080">,</font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">,
  </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~F10~ Menu'</font><font color="#000080">,</font>kbF10<font color="#000080">,</font>cmMenu<font color="#000080">,
  </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)),</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)
  ));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Rlistbox<font color="#000080">.</font>Process<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>DirInfo<font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>NameList<font color="#000080">:=</font>New<font color="#000080">(</font>Pstringcollection<font color="#000080">,</font>Init<font color="#000080">(</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">));
  </font><font color="#FF0000"><b>With </b></font>NameList<font color="#000080">^ </font><font color="#FF0000"><b>do
  Begin
    </b></font>FindFirst<font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">, </font>Archive<font color="#000080">, </font>DirInfo<font color="#000080">);
    </font><font color="#FF0000"><b>while </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
      Begin
        </b></font>Insert<font color="#000080">(</font>Newstr<font color="#000080">(</font>Dirinfo<font color="#000080">.</font>Name<font color="#000080">));
        </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyApp<font color="#000080">.</font>NewCollect<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>MyBox<font color="#000080">: </font>PMyDialog<font color="#000080">;
  </font>R <font color="#000080">: </font>TRect<font color="#000080">;
  </font>pBor <font color="#000080">: ^</font>TScrollBar<font color="#000080">;
  </font>Col<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Plist<font color="#000080">^.</font>Process<font color="#000080">;
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);
  </font>MyBox <font color="#000080">:= </font>New<font color="#000080">(</font>PmyDialog<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'Scroll Collection'</font><font color="#000080">));
  </font>Col<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">41</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">);
  </font>PBor<font color="#000080">:= </font>New<font color="#000080">(</font>Pscrollbar<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">));
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">);
  </font>Plist<font color="#000080">:=</font>New<font color="#000080">(</font>PListbox<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">,</font>Col<font color="#000080">,</font>PBor<font color="#000080">));
  </font>Plist<font color="#000080">^.</font>Newlist<font color="#000080">(</font>Namelist<font color="#000080">);
  </font>MyBox<font color="#000080">^.</font>Insert<font color="#000080">(</font>PBor<font color="#000080">);
  </font>MyBox<font color="#000080">^.</font>Insert<font color="#000080">(</font>PList<font color="#000080">);
  </font>Desktop<font color="#000080">^.</font>insert<font color="#000080">(</font>myBox<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyApp<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>TApplication<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evCommand <font color="#FF0000"><b>then
    Begin
      case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
        </b></font>cmNewCollect<font color="#000080">: </font><font color="#FF0000"><b>Begin
                        </b></font>DisableCommands<font color="#000080">(</font>DisableNewCollect<font color="#000080">);
                        </font>Newcollect<font color="#000080">;
                      </font><font color="#FF0000"><b>End
      else
        </b></font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
        </font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyApp<font color="#000080">.</font>InitMenubar<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>R<font color="#000080">:</font>Trect<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
  </font>MenuBar <font color="#000080">:=</font>new<font color="#000080">(</font>PMenubar<font color="#000080">, </font>init<font color="#000080">(</font>R<font color="#000080">, </font>Newmenu<font color="#000080">(
  </font>NewSubMenu<font color="#000080">(</font><font color="#800000">'~L~istbox Menu'</font><font color="#000080">,</font>hcnocontext<font color="#000080">, </font>Newmenu<font color="#000080">(
  </font>NewItem<font color="#000080">(</font><font color="#800000">'~B~ox'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font>kbF9<font color="#000080">,</font>cmnewcollect<font color="#000080">,</font>hcnocontext<font color="#000080">,
  </font>NewLine<font color="#000080">(
  </font>NewItem<font color="#000080">(</font><font color="#800000">'~E~xit'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font>kbf10<font color="#000080">,</font>cmquit<font color="#000080">,</font>hcnocontext<font color="#000080">,
  </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)))), </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">))));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>MyApp<font color="#000080">.</font>Init<font color="#000080">;
  </font>MyApp<font color="#000080">.</font>Run<font color="#000080">;
  </font>MyApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0071.PAS">Original</a><b>]</b></p></body>
</html>
