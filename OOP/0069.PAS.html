<html>
<head><title> "Create a Listbox and Get a Double Click" by BORLAND</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0069.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
672: How to Create a Listbox and Get a Double Click
   Pascal   All       TI-09/30/94

Demonstrates handling double click on a
listbox.

  PRODUCT  :  Pascal                                 NUMBER  :  672
  VERSION  :  All
       OS  :  DOS
     DATE  :  September 30, 1994                       PAGE  :  1/1

    TITLE  :  How to Create a Listbox and Get a Double Click
{

The following example demonstrates how to create a listbox
of file items and enable the user to double click on any item.
This produces a Message Box containing the listbox selected

item.

}
{$X+}
</i></font><font color="#FF0000"><b>Program </b></font>Simple_ListBox<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>Objects<font color="#000080">, </font>Drivers<font color="#000080">, </font>Views<font color="#000080">, </font>Menus<font color="#000080">, </font>Dialogs<font color="#000080">, </font>App<font color="#000080">, </font>Crt<font color="#000080">, </font>Dos<font color="#000080">, </font>MsgBox<font color="#000080">;

</font><font color="#FF0000"><b>Const
 </b></font>cmNewCollect <font color="#000080">= </font><font color="#800000">102</font><font color="#000080">;

</font><font color="#FF0000"><b>Type

 </b></font>TMyApp <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
     </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">;
     </font><font color="#FF0000"><b>Procedure </b></font>Initstatusline<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Procedure </b></font>Initmenubar<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Procedure </b></font>NewCollect<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>PListBox <font color="#000080">= ^</font>RListBox<font color="#000080">;
  </font>RListBox <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TListBox<font color="#000080">)
    </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Bounds<font color="#000080">:</font>TRect<font color="#000080">; </font>ANumCols<font color="#000080">:</font>Word<font color="#000080">; </font>AScrollBar<font color="#000080">:

                         </font>PScrollBar<font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>Process<font color="#000080">;
    </font><font color="#FF0000"><b>Destructor </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>PMyDialog <font color="#000080">= ^</font>MyDialog<font color="#000080">;
  </font>MyDialog <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
    </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Bounds<font color="#000080">: </font>TRect<font color="#000080">; </font>MyTitle<font color="#000080">:</font>TTitleStr<font color="#000080">);
    </font><font color="#FF0000"><b>Destructor </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>NameList<font color="#000080">: </font>PStringCollection<font color="#000080">;
  </font>PList<font color="#000080">: ^</font>Rlistbox<font color="#000080">;
  </font>MyApp<font color="#000080">: </font>TMyApp<font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>Mydialog<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Bounds<font color="#000080">:</font>TRect<font color="#000080">; </font>MyTitle<font color="#000080">: </font>TTitleStr<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>TDialog<font color="#000080">.</font>Init<font color="#000080">(</font>Bounds<font color="#000080">, </font>MyTitle<font color="#000080">);

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Destructor </b></font>Mydialog<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TDialog<font color="#000080">.</font>Done<font color="#000080">;
  </font>Dispose<font color="#000080">(</font>NameList<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>MyDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">:</font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Index<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>Double <font color="#000080">= </font>true<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evNothing<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>sound<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">);
      </font>delay<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">);
      </font>nosound<font color="#000080">;
      </font>Index<font color="#000080">:=(</font>PList<font color="#000080">^.</font>Focused<font color="#000080">);
      </font>Messagebox<font color="#000080">(</font>PList<font color="#000080">^.</font>GetText<font color="#000080">(</font>Index<font color="#000080">,</font><font color="#800000">20</font><font color="#000080">) ,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>mfOkButton<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>TMyApp<font color="#000080">.</font>Init<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>TApplication<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>RListBox<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Bounds<font color="#000080">:</font>TRect<font color="#000080">; </font>ANumCols<font color="#000080">:</font>Word<font color="#000080">;
</font>AScrollBar<font color="#000080">:
                          </font>PScrollBar<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>TListBox<font color="#000080">.</font>Init<font color="#000080">(</font>Bounds<font color="#000080">, </font>ANumCols<font color="#000080">, </font>AScrollBar<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Destructor </b></font>RListBox<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TListBox<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyApp<font color="#000080">.</font>InitStatusLine<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>R<font color="#000080">:</font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>Statusline <font color="#000080">:=</font>new<font color="#000080">(</font>PStatusLine<font color="#000080">, </font>init<font color="#000080">(</font>R<font color="#000080">,
  </font>NewStatusDef<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">$FFFF</font><font color="#000080">,
  </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~Alt-X~ Exit'</font><font color="#000080">,</font>kbAltX<font color="#000080">, </font>cmQuit<font color="#000080">,

  </font>NewStatusKey<font color="#000080">(</font><font color="#800000">'~F10~ Menu'</font><font color="#000080">,</font>kbF10<font color="#000080">,</font>cmMenu<font color="#000080">,
  </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)),</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)
  ));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>RListBox<font color="#000080">.</font>Process<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>DirInfo<font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>NameList<font color="#000080">:=</font>New<font color="#000080">(</font>PStringCollection<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">));
  </font><font color="#FF0000"><b>With </b></font>NameList<font color="#000080">^ </font><font color="#FF0000"><b>do
  Begin
    </b></font>FindFirst<font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">, </font>Archive<font color="#000080">, </font>DirInfo<font color="#000080">);
    </font><font color="#FF0000"><b>while </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
      Begin
        </b></font>Insert<font color="#000080">(</font>Newstr<font color="#000080">(</font>Dirinfo<font color="#000080">.</font>Name<font color="#000080">));
        </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyApp<font color="#000080">.</font>NewCollect<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>MyBox<font color="#000080">: </font>PMyDialog<font color="#000080">;
  </font>R<font color="#000080">: </font>TRect<font color="#000080">;
  </font>PBorland<font color="#000080">: ^</font>TScrollBar<font color="#000080">;

  </font>Col<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Plist<font color="#000080">^.</font>Process<font color="#000080">;
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);
  </font>MyBox <font color="#000080">:= </font>New<font color="#000080">(</font>PMyDialog<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'Scroll Collection'</font><font color="#000080">));
  </font>Col<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">41</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">);
  </font>PBorland<font color="#000080">:= </font>New<font color="#000080">(</font>PScrollBar<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">));
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">);
  </font>Plist<font color="#000080">:=</font>New<font color="#000080">(</font>PListbox<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">,</font>Col<font color="#000080">,</font>PBorland<font color="#000080">));
  </font>Plist<font color="#000080">^.</font>Newlist<font color="#000080">(</font>Namelist<font color="#000080">);
  </font>MyBox<font color="#000080">^.</font>Insert<font color="#000080">(</font>PBorland<font color="#000080">);
  </font>MyBox<font color="#000080">^.</font>Insert<font color="#000080">(</font>PList<font color="#000080">);
  </font>Desktop<font color="#000080">^.</font>Insert<font color="#000080">(</font>MyBox<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyApp<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>TApplication<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evCommand <font color="#FF0000"><b>then
    Begin
      case </b></font>Event<font color="#000080">.</font>Command <font color="#FF0000"><b>of
        </b></font>cmNewCollect<font color="#000080">: </font>Newcollect<font color="#000080">;
      </font><font color="#FF0000"><b>else
        </b></font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
        </font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>ClearEvent<font color="#000080">(</font>Event<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyApp<font color="#000080">.</font>InitMenubar<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
  </font>MenuBar <font color="#000080">:=</font>new<font color="#000080">(</font>PMenubar<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font>Newmenu<font color="#000080">(
  </font>NewSubMenu<font color="#000080">(</font><font color="#800000">'~L~istbox Menu'</font><font color="#000080">, </font>hcNoContext<font color="#000080">, </font>Newmenu<font color="#000080">(
  </font>NewItem<font color="#000080">(</font><font color="#800000">'~B~ox'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font>kbF9<font color="#000080">, </font>cmnewcollect<font color="#000080">, </font>hcnocontext<font color="#000080">,
  </font>NewLine<font color="#000080">(

  </font>NewItem<font color="#000080">(</font><font color="#800000">'~E~xit'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">, </font>kbf10<font color="#000080">, </font>cmquit<font color="#000080">, </font>hcnocontext<font color="#000080">,
  </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)))), </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">))));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;








</font>PRODUCT  <font color="#000080">:  </font>Turbo <font color="#FF0000"><b>Pascal                           </b></font>NUMBER  <font color="#000080">:  </font><font color="#800000">672
</font>VERSION  <font color="#000080">:  </font><font color="#800000">6.0
     </font>OS  <font color="#000080">:  </font>MS<font color="#000080">/</font>PC DOS
   DATE  <font color="#000080">:  </font>June <font color="#800000">23</font><font color="#000080">, </font><font color="#800000">1994                            </font>PAGE  <font color="#000080">:  </font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">5

  </font>TITLE  <font color="#000080">:  </font>How <font color="#FF0000"><b>to </b></font>Create a Listbox <font color="#FF0000"><b>and </b></font>Get a Double Click




<font color="#FF0000"><b>Begin
  </b></font>MyApp<font color="#000080">.</font>Init<font color="#000080">;
  </font>MyApp<font color="#000080">.</font>Run<font color="#000080">;
  </font>MyApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.


</font>DISCLAIMER<font color="#000080">: </font>You have the right <font color="#FF0000"><b>to </b></font>use this technical information
subject <font color="#FF0000"><b>to </b></font>the terms <font color="#FF0000"><b>of </b></font>the No<font color="#000080">-</font>Nonsense License Statement that

you received <font color="#FF0000"><b>with </b></font>the Borland product <font color="#FF0000"><b>to </b></font>which this information
pertains<font color="#000080">.
</font>PACHXA296<font color="#000080">:</font>PACHXA296


</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0069.PAS">Original</a><b>]</b></p></body>
</html>
