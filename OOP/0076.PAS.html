<html>
<head><title> "Turbo Vision" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0076.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>program </b></font>TV132<font color="#000080">;

</font><font color="#008000"><i>{ this program shows how to put a Turbo Vision application in
  132 column mode.  it is written specifically for an ATI VGA
  card but can be modified for other cards.  also your mouse
  drive must be able to support 132 columns. }

{$X+}
</i></font><font color="#FF0000"><b>uses
   </b></font>objects<font color="#000080">, </font>drivers<font color="#000080">, </font>views<font color="#000080">, </font>app<font color="#000080">, </font>dialogs <font color="#000080">, </font>menus<font color="#000080">, </font>dos<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>cm_DoIt <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;

</font><font color="#FF0000"><b>type
   </b></font>PMyApp <font color="#000080">= ^</font>TMyApp<font color="#000080">;
   </font>TMyApp <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
     </font><font color="#FF0000"><b>procedure </b></font>InitMenuBar<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>procedure </b></font>InitScreen<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>procedure </b></font>CMDoIt<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>PMyDialog <font color="#000080">= ^</font>TMyDialog<font color="#000080">;
   </font>TMyDialog <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
     </font><font color="#FF0000"><b>procedure </b></font>InitFrame<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>procedure </b></font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>PMyFrame <font color="#000080">= ^</font>TMyFrame<font color="#000080">;
   </font>TMyFrame <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TFrame<font color="#000080">)
     </font><font color="#FF0000"><b>procedure </b></font>Draw<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyFrame<font color="#000080">.</font>Draw<font color="#000080">;
</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyDialog<font color="#000080">.</font>InitFrame<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>TDialog<font color="#000080">.</font>InitFrame<font color="#000080">;
</font><font color="#008000"><i>(*

  R.Assign(0, 0, Size.X, Size.Y);
  Frame := new(PMyFrame, init(R));
*)
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>CMDoIt<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>D<font color="#000080">: </font>PMyDialog<font color="#000080">;
  </font>ILine <font color="#000080">: </font>PInputLine<font color="#000080">;
  </font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">);
  </font>new<font color="#000080">(</font>D<font color="#000080">, </font>init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'Do It'</font><font color="#000080">));
  </font>D<font color="#000080">^.</font>SetState<font color="#000080">(</font>sfShadow<font color="#000080">, </font>false<font color="#000080">);
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">19</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
  </font>new<font color="#000080">(</font>ILine<font color="#000080">, </font>init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">20</font><font color="#000080">));
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">19</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
  </font>D<font color="#000080">^.</font>Insert<font color="#000080">(</font>Iline<font color="#000080">);
  </font>D<font color="#000080">^.</font>Insert<font color="#000080">(</font>new<font color="#000080">(</font>PInputline<font color="#000080">, </font>init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">20</font><font color="#000080">)));
  </font>R<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">);
  </font>D<font color="#000080">^.</font>Insert<font color="#000080">(</font>new<font color="#000080">(</font>PButton<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font><font color="#800000">'~O~k'</font><font color="#000080">, </font>cmOk<font color="#000080">, </font>bfDefault<font color="#000080">)));

  </font>Iline<font color="#000080">^.</font>Select<font color="#000080">;
  </font>Desktop<font color="#000080">^.</font>ExecView<font color="#000080">(</font>D<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evKeyDown <font color="#FF0000"><b>then
    if </b></font>Event<font color="#000080">.</font>KeyCode <font color="#000080">= </font>kbEnter <font color="#FF0000"><b>then
      </b></font>Event<font color="#000080">.</font>KeyCode <font color="#000080">:= </font>kbTab<font color="#000080">;
  </font>TDialog<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>InitMenuBar<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>R<font color="#000080">:</font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetExtent<font color="#000080">(</font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>B<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>A<font color="#000080">.</font>Y <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>MenuBar <font color="#000080">:= </font>New<font color="#000080">(</font>PMenuBar<font color="#000080">, </font>Init<font color="#000080">(</font>R<font color="#000080">, </font>NewMenu<font color="#000080">(
    </font>NewItem<font color="#000080">(</font><font color="#800000">'~D~o it'</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">, </font>kbNoKey<font color="#000080">, </font>cm_DoIt<font color="#000080">, </font>hcNoContext<font color="#000080">,
    </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)
  )));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>HandleEvent<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Event<font color="#000080">: </font>TEvent<font color="#000080">);

</font><font color="#FF0000"><b>begin
  </b></font>TApplication<font color="#000080">.</font>HandleEvent<font color="#000080">(</font>Event<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Event<font color="#000080">.</font>What <font color="#000080">= </font>evCommand <font color="#FF0000"><b>then
    if </b></font>Event<font color="#000080">.</font>Command <font color="#000080">= </font>cm_DoIt <font color="#FF0000"><b>then
    begin
      </b></font>CMDoIt<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>InitScreen<font color="#000080">;
</font><font color="#008000"><i>{ this procedure is specific to an ATI VGA Card, you may need to
  modify if you have a different video card. }
</i></font><font color="#FF0000"><b>begin
  </b></font>TApplication<font color="#000080">.</font>InitScreen<font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov ah, 0
    mov al, 23H
    int 10H
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ScreenMode <font color="#000080">:= </font><font color="#800000">$23</font><font color="#000080">;
  </font>ScreenHeight <font color="#000080">:= </font><font color="#800000">25</font><font color="#000080">;
  </font>ScreenWidth <font color="#000080">:= </font><font color="#800000">132</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var

  </b></font>MyApp<font color="#000080">: </font>TMyApp<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>MyApp<font color="#000080">.</font>Init<font color="#000080">;
  </font>MyApp<font color="#000080">.</font>Run<font color="#000080">;
  </font>MyApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0076.PAS">Original</a><b>]</b></p></body>
</html>
