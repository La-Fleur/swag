<html>
<head><title> "SORTCOLL.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
This post is just to demonstrate a very simple sorted collection using
non-Object Types With the collection.  If it is needed to store itself
to a stream, it will need additional over-ridden methods to do that.
I'm just posting this, because I wrote it several days ago to implement
a simple Variable system in a script language For a menu Program that I
wrote, and I was looking For an *easier* way to maintain the Variable
list than With a linked list.  To my astonishment, today, I needed a
similar structure, and (ohmygosh) I found that I could *re-use* this
code, by merely deriving a child class and adding another method or so.
This is the first time that I have ever *re-used* an Object Type that I
have modified.  Of course, I haven't been actually using TurboVision for
more than a month or so, so I haven't had much of a chance, but it is
very nice to see that when people talk about &quot;Object oriented
Programming paradigm&quot;, they are not ONLY speaking in big Words, but that
they also (apparently) are telling the truth.

I'm not taking any responsibility if this overWrites your interrupt
vector table, so be carefull.  If you find any mistakes, or actually
modify this code to become more usefull, I'd appreciate it if you could
tell me- actually determining the best way to implement a new Object
class is kind of difficult For me since I've only been doing this for
about a month, trying to squeeze it in along With school and a job.

Here's the code...
{********* STARTS HERE **********}
{ Unit: STROBJ.PAS
  WRITTEN BY: Brian Pape
  DATE: 03/28/93
  Copyright 1993 by Brian Pape and Alphawave Technologies
  This Unit contains String Type Objects
}
{$P+}  { Enable open String parameters.  Replace by $V- For TP 6.0 or lower }
</i></font><font color="#FF0000"><b>Unit </b></font>strobj<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses
  </b></font>Objects<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>str20 <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];

  </font>PVarType <font color="#000080">= ^</font>TVarType<font color="#000080">;
  </font>TVarType <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>name  <font color="#000080">: </font>str20<font color="#000080">;
    </font>value <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ TVarType }

  </i></font>PVarCollection <font color="#000080">= ^</font>TVarCollection<font color="#000080">;
  </font>TVarCollection <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TSortedCollection<font color="#000080">)
    </font><font color="#FF0000"><b>Constructor </b></font>init<font color="#000080">(</font>Alimit<font color="#000080">,</font>Adelta<font color="#000080">:</font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>Function </b></font>KeyOf<font color="#000080">(</font>item<font color="#000080">:</font>Pointer<font color="#000080">):</font>Pointer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Function </b></font>Compare<font color="#000080">(</font>Key1<font color="#000080">,</font>Key2<font color="#000080">:</font>Pointer<font color="#000080">):</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>freeitem<font color="#000080">(</font>Item<font color="#000080">:</font>Pointer<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;

    </font><font color="#008000"><i>{ This Function will return the value of a Variable in a TVarCollection }
    </i></font><font color="#FF0000"><b>Function </b></font>getVar<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;

    </font><font color="#008000"><i>{ Adds a PVarType Record to the collection, without having to manually
      create, and allocate memory for, a Record Type }
    </i></font><font color="#FF0000"><b>Procedure </b></font>add<font color="#000080">(</font>aname<font color="#000080">:</font>str20<font color="#000080">;</font>avalue<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ TVarCollection }

</i></font><font color="#FF0000"><b>Implementation

Constructor </b></font>TVarCollection<font color="#000080">.</font>init<font color="#000080">(</font>ALimit<font color="#000080">,</font>ADelta<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>init<font color="#000080">(</font>ALimit<font color="#000080">,</font>ADelta<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ TVarCollection.init }

</i></font><font color="#FF0000"><b>Function </b></font>TVarCollection<font color="#000080">.</font>KeyOf<font color="#000080">(</font>item<font color="#000080">:</font>Pointer<font color="#000080">):</font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>KeyOf <font color="#000080">:= @(</font>TVarType<font color="#000080">(</font>item<font color="#000080">^).</font>name<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ TVarCollection.KeyOf }

</i></font><font color="#FF0000"><b>Function </b></font>TVarCollection<font color="#000080">.</font>Compare<font color="#000080">(</font>Key1<font color="#000080">,</font>Key2<font color="#000080">:</font>Pointer<font color="#000080">):</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if String</b></font><font color="#000080">(</font>Key1<font color="#000080">^) &gt; </font><font color="#FF0000"><b>String</b></font><font color="#000080">(</font>Key2<font color="#000080">^) </font><font color="#FF0000"><b>then
    </b></font>Compare <font color="#000080">:= </font><font color="#800000">1
  </font><font color="#FF0000"><b>else if String</b></font><font color="#000080">(</font>Key1<font color="#000080">^) = </font><font color="#FF0000"><b>String</b></font><font color="#000080">(</font>Key2<font color="#000080">^) </font><font color="#FF0000"><b>then
    </b></font>Compare <font color="#000080">:= </font><font color="#800000">0
  </font><font color="#FF0000"><b>else </b></font>Compare <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ TVarCollection.Compare }

</i></font><font color="#FF0000"><b>Procedure </b></font>TVarCollection<font color="#000080">.</font>freeitem<font color="#000080">(</font>Item<font color="#000080">:</font>Pointer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>dispose<font color="#000080">(</font>Item<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ freeitem }

</i></font><font color="#FF0000"><b>Function </b></font>TVarCollection<font color="#000080">.</font>getVar<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>t <font color="#000080">: </font>TVarType<font color="#000080">;
  </font>where <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>t<font color="#000080">.</font>name <font color="#000080">:= </font>s<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Search<font color="#000080">(@</font>t<font color="#000080">,</font>where<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>getVar <font color="#000080">:= </font>TVarType<font color="#000080">(</font>at<font color="#000080">(</font>where<font color="#000080">)^).</font>value
  <font color="#FF0000"><b>else
    </b></font>getVar <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ getVar }


</i></font><font color="#FF0000"><b>Procedure </b></font>TVarCollection<font color="#000080">.</font>add<font color="#000080">(</font>aname<font color="#000080">:</font>str20<font color="#000080">;</font>avalue<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>rec <font color="#000080">: </font>PVarType<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>rec <font color="#000080">:= </font>new<font color="#000080">(</font>PVarType<font color="#000080">);
  </font>rec<font color="#000080">^.</font>name <font color="#000080">:= </font>aname<font color="#000080">;
  </font>rec<font color="#000080">^.</font>value <font color="#000080">:= </font>avalue<font color="#000080">;
  </font>insert<font color="#000080">(</font>rec<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ add }

</i></font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.  </font><font color="#008000"><i>{ strobj }
{*********** endS HERE *************}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p></body>
</html>
