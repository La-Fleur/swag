<html>
<head><title> "Two Joysticks" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to JOYSTICK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">==============================================================================
 </font>BBS<font color="#000080">: &reg;&reg; </font>The Information <font color="#FF0000"><b>and </b></font>Technology Exchan
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>MATT CRILL                   Date<font color="#000080">: </font><font color="#800000">01</font><font color="#000080">-</font><font color="#800000">05</font><font color="#000080">&Auml;</font><font color="#800000">92 </font><font color="#000080">(</font><font color="#800000">23</font><font color="#000080">:</font><font color="#800000">03</font><font color="#000080">)
</font>From<font color="#000080">: </font>DANIEL CHURCHMAN           Number<font color="#000080">: </font><font color="#800000">4144   </font><font color="#000080">[</font><font color="#800000">101</font><font color="#000080">] </font><font color="#FF0000"><b>PASCAL
</b></font>Subj<font color="#000080">: </font>JOYSTICK <font color="#800000">1                 </font>Status<font color="#000080">: </font><font color="#FF0000"><b>Public
</b></font><font color="#000080">------------------------------------------------------------------------------
</font><font color="#FF0000"><b>Program </b></font>Joy<font color="#000080">;  </font><font color="#008000"><i>{ Read Joystick positions and button states }

</i></font><font color="#FF0000"><b>Uses </b></font>DOS<font color="#000080">, </font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>Buttons          <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>Joystick         <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;

  </font>JoyIntr          <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">$15</font><font color="#000080">;
  </font>JoyFunc          <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">$84</font><font color="#000080">;

  </font>CStart           <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{ To hold cursor start line }
  </i></font>CEnd             <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{ To hold cursor end line }

  </i></font>kX               <font color="#000080">: </font>Real <font color="#000080">= </font><font color="#800000">6.25</font><font color="#000080">; </font><font color="#008000"><i>{ constant for horizontal conversion }
  </i></font>kY               <font color="#000080">: </font>Real <font color="#000080">= </font><font color="#800000">20.0</font><font color="#000080">; </font><font color="#008000"><i>{ constant for vertical conversion }

  </i></font>LastKey          <font color="#000080">: </font>Char <font color="#000080">= </font><font color="#800000">' '</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font><font color="#008000"><i>{ Variables for Joystick 1 }
  </i></font>Joy1Vert         <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{ Vertical Position }
  </i></font>Joy1Hori         <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{ Horizontal Position }
  </i></font>Joy1But1         <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#008000"><i>{ Button 1 }
  </i></font>Joy1But2         <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#008000"><i>{ Button 2 }

  { Variables for Joystick 2 }
  </i></font>Joy2Vert         <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{ Vertical Position }
  </i></font>Joy2Hori         <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{ Horizontal Position }
  </i></font>Joy2But1         <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#008000"><i>{ Button 1 }
  </i></font>Joy2But2         <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#008000"><i>{ Button 2 }

  </i></font>Error            <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#008000"><i>{ We'll set this if the joystick isn't found }

  </i></font>Regs             <font color="#000080">: </font>Registers<font color="#000080">;
  </font>NewX<font color="#000080">, </font>NewY       <font color="#000080">: </font>Byte<font color="#000080">;
  </font>OldX<font color="#000080">, </font>OldY       <font color="#000080">: </font>Byte<font color="#000080">;
  </font>MinX<font color="#000080">, </font>MinY<font color="#000080">,
  </font>MaxX<font color="#000080">, </font>MaxY       <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#008000"><i>{ Checkjoy and CheckBut are really the only two procedures of real }
{ interest to you; the rest is just support code to do something   }
{ with the samples.                                                }


</i></font><font color="#FF0000"><b>Procedure </b></font>CheckJoy<font color="#000080">;
    </font><font color="#FF0000"><b>begin   </b></font><font color="#008000"><i>{ Prepare and make Int 15h, subfunction 84h call }
      </i></font><font color="#FF0000"><b>With </b></font>Regs <font color="#FF0000"><b>do
      begin
        </b></font>AH <font color="#000080">:= </font>JoyFunc<font color="#000080">;
        </font>DX <font color="#000080">:= </font>Joystick<font color="#000080">;  </font><font color="#008000"><i>{ Subfunction 1 = joystick }
        </i></font>Intr<font color="#000080">(</font>JoyIntr<font color="#000080">, </font>Regs<font color="#000080">);
        </font>Joy1Hori <font color="#000080">:= </font>AX<font color="#000080">;
        </font>Joy1Vert <font color="#000080">:= </font>BX<font color="#000080">;
        </font>Joy2Hori <font color="#000080">:= </font>CX<font color="#000080">;
        </font>Joy2Vert <font color="#000080">:= </font>DX<font color="#000080">;
        </font>Error <font color="#000080">:= ((</font>Flags <font color="#FF0000"><b>AND </b></font>FCarry<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CheckBut<font color="#000080">;
    </font><font color="#FF0000"><b>Const
      </b></font>MaskJ1B1     <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">;
      </font>MaskJ1B2     <font color="#000080">= </font><font color="#800000">$20</font><font color="#000080">;
      </font>MaskJ2B1     <font color="#000080">= </font><font color="#800000">$40</font><font color="#000080">;
      </font>MaskJ2B2     <font color="#000080">= </font><font color="#800000">$80</font><font color="#000080">;
    </font><font color="#FF0000"><b>begin   </b></font><font color="#008000"><i>{ Prepare and make Int 15h, subfunction 84h call }
      </i></font><font color="#FF0000"><b>With </b></font>Regs <font color="#FF0000"><b>do
      begin
        </b></font>AH <font color="#000080">:= </font>JoyFunc<font color="#000080">;
        </font>DX <font color="#000080">:= </font>Buttons<font color="#000080">;  </font><font color="#008000"><i>{ Subfunction 0 = buttons }
        </i></font>Intr<font color="#000080">(</font>JoyIntr<font color="#000080">, </font>Regs<font color="#000080">);
        </font>Joy1But1 <font color="#000080">:= (</font>AL <font color="#FF0000"><b>AND </b></font>MaskJ1B1<font color="#000080">) &lt;&gt; </font>MaskJ1B1<font color="#000080">;
        </font>Joy1But2 <font color="#000080">:= (</font>AL <font color="#FF0000"><b>AND </b></font>MaskJ1B2<font color="#000080">) &lt;&gt; </font>MaskJ1B2<font color="#000080">;
        </font>Joy2But1 <font color="#000080">:= (</font>AL <font color="#FF0000"><b>AND </b></font>MaskJ2B1<font color="#000080">) &lt;&gt; </font>MaskJ2B1<font color="#000080">;
        </font>Joy2But2 <font color="#000080">:= (</font>AL <font color="#FF0000"><b>AND </b></font>MaskJ2B2<font color="#000080">) &lt;&gt; </font>MaskJ2B2<font color="#000080">;
        </font>Error <font color="#000080">:= ((</font>Flags <font color="#FF0000"><b>AND </b></font>FCarry<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Calibrate<font color="#000080">;
    </font><font color="#FF0000"><b>Var
      </b></font>n            <font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font><font color="#008000"><i>{ Calibrate joystick 1 }
      </i></font>CheckJoy<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Error <font color="#FF0000"><b>then
      begin
        </b></font>Write<font color="#000080">(</font><font color="#800000">'No Joystick(s) found - terminating program'</font><font color="#000080">);
        </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Joy1Vert <font color="#000080">+ </font>Joy1Hori<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Joystick 1 Absent'</font><font color="#000080">)
      </font><font color="#FF0000"><b>else
        </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Joystick 1 Present'</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Joy2Vert <font color="#000080">+ </font>Joy2Hori<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Joystick 2 Absent'</font><font color="#000080">)
      </font><font color="#FF0000"><b>else
        </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Joystick 2 Present'</font><font color="#000080">);

</font><font color="#008000"><i>(*      { Get centre joystick values for X and Y }
      Write('Hold joystick in centre position and press a button');
      Repeat
        CheckBut
      Until (Joy1But1 OR Joy1But2);
      CentreX := 0;
      CentreY := 0;
      For n := 1 to 10 do
      begin
        CheckJoy;
        CentreX := CentreX + Joy1Hori;
        CentreY := CentreY + Joy1Vert;
      end;
      CentreX := CentreX DIV 10;
      CentreY := CentreY DIV 10;
      While (Joy1But1 OR Joy1But2) do  { Wait till button released }
      begin
        CheckBut
      end;
      Writeln('  -  ',CentreX,':',CentreY);
*)

      { Get minimum joystick values for X and Y }
      </i></font>Write<font color="#000080">(</font><font color="#800000">'Hold joystick in upper-left position and press a button'</font><font color="#000080">);
      </font><font color="#FF0000"><b>Repeat
        </b></font>CheckBut
      <font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Joy1But1 <font color="#FF0000"><b>OR </b></font>Joy1But2<font color="#000080">);
      </font>MinX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>MinY <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do  </b></font><font color="#008000"><i>{ Sample over time for accuracy }
      </i></font><font color="#FF0000"><b>begin
        </b></font>CheckJoy<font color="#000080">;
        </font><font color="#008000"><i>{ Bias the reading slightly to ensure }
        { we can always reach coord 1,1 }
        </i></font>MinX <font color="#000080">:= </font>MinX <font color="#000080">+ </font>Word<font color="#000080">(</font>Round<font color="#000080">(</font>Joy1Hori <font color="#000080">* </font><font color="#800000">1.1</font><font color="#000080">));
        </font>MinY <font color="#000080">:= </font>MinY <font color="#000080">+ </font>Word<font color="#000080">(</font>Round<font color="#000080">(</font>Joy1Vert <font color="#000080">* </font><font color="#800000">1.1</font><font color="#000080">))
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>MinX <font color="#000080">:= </font>MinX <font color="#FF0000"><b>DIV </b></font><font color="#800000">10</font><font color="#000080">;
      </font>MinY <font color="#000080">:= </font>MinY <font color="#FF0000"><b>DIV </b></font><font color="#800000">10</font><font color="#000080">;
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Joy1But1 <font color="#FF0000"><b>OR </b></font>Joy1But2<font color="#000080">) </font><font color="#FF0000"><b>do  </b></font><font color="#008000"><i>{ Wait till button released }
      </i></font><font color="#FF0000"><b>begin
        </b></font>CheckBut
      <font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Writeln<font color="#000080">(</font><font color="#800000">'  -  '</font><font color="#000080">,</font>MinX<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">,</font>MinY<font color="#000080">);

      </font><font color="#008000"><i>{ Get maximum joystick values for X and Y }
      </i></font>Write<font color="#000080">(</font><font color="#800000">'Hold joystick in bottom-right position and press a button'</font><font color="#000080">);
      </font><font color="#FF0000"><b>Repeat
        </b></font>CheckBut
      <font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Joy1But1 <font color="#FF0000"><b>OR </b></font>Joy1But2<font color="#000080">);
      </font>MaxX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>MaxY <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do   </b></font><font color="#008000"><i>{ Sample over time for accuracy }
      </i></font><font color="#FF0000"><b>begin
        </b></font>CheckJoy<font color="#000080">;
        </font><font color="#008000"><i>{ Bias the reading slightly to ensure }
        { we can always reach coord 80,25 }
        </i></font>MaxX <font color="#000080">:= </font>MaxX <font color="#000080">+ </font>Word<font color="#000080">(</font>Round<font color="#000080">(</font>Joy1Hori <font color="#000080">* </font><font color="#800000">0.95</font><font color="#000080">));
        </font>MaxY <font color="#000080">:= </font>MaxY <font color="#000080">+ </font>Word<font color="#000080">(</font>Round<font color="#000080">(</font>Joy1Vert <font color="#000080">* </font><font color="#800000">0.95</font><font color="#000080">))
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>MaxX <font color="#000080">:= </font>MaxX <font color="#FF0000"><b>DIV </b></font><font color="#800000">10</font><font color="#000080">;
      </font>MaxY <font color="#000080">:= </font>MaxY <font color="#FF0000"><b>DIV </b></font><font color="#800000">10</font><font color="#000080">;
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Joy1But1 <font color="#FF0000"><b>OR </b></font>Joy1But2<font color="#000080">) </font><font color="#FF0000"><b>do  </b></font><font color="#008000"><i>{ Wait till button released }
      </i></font><font color="#FF0000"><b>begin
        </b></font>CheckBut
      <font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Writeln<font color="#000080">(</font><font color="#800000">'  -  '</font><font color="#000080">,</font>MaxX<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">,</font>MaxY<font color="#000080">);

      </font><font color="#008000"><i>{ Important to note that the following calculations of kX and   }
      { kY is done linearly.  This is not really correct, as you'll   }
      { see by the fact that when centred, your screen coords are     }
      { NOT 40,13.  The reason is that the resistors in joysticks     }
      { work on a logarithmic scale.  My knowledge of logs is too     }
      { rusty to build this in properly, so I've skipped it.  What    }
      { you should do is derive the log that correctly passes through }
      { minimum, maximum AND centre.  This way, the joystick, centred }
      { will correctly position your screen coord dead centre, and    }
      { you can still reach the extremes as well.                     }

      </i></font>kX <font color="#000080">:= (</font>MaxX <font color="#000080">- </font>MinX<font color="#000080">) / </font><font color="#800000">80</font><font color="#000080">;
      </font>kY <font color="#000080">:= (</font>MaxY <font color="#000080">- </font>MinY<font color="#000080">) / </font><font color="#800000">25</font><font color="#000080">;
      </font>Writeln<font color="#000080">(</font><font color="#800000">'kX = '</font><font color="#000080">, </font>kX<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'     kY = '</font><font color="#000080">,</font>kY<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);

    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

[</font>Continued<font color="#000080">]


--- </font>Msged<font color="#000080">/</font>sq
 <font color="#000080">* </font>Origin<font color="#000080">: </font>C<font color="#000080">&amp;</font>O Systems<font color="#000080">, </font>Brisbane<font color="#000080">, </font>AUSTRALIA <font color="#000080">(</font><font color="#800000">3</font><font color="#000080">:</font><font color="#800000">640</font><font color="#000080">/</font><font color="#800000">777</font><font color="#000080">)
==============================================================================
 </font>BBS<font color="#000080">: &reg;&reg; </font>The Information <font color="#FF0000"><b>and </b></font>Technology Exchan
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>MATT CRILL                   Date<font color="#000080">: </font><font color="#800000">01</font><font color="#000080">-</font><font color="#800000">05</font><font color="#000080">&Auml;</font><font color="#800000">92 </font><font color="#000080">(</font><font color="#800000">23</font><font color="#000080">:</font><font color="#800000">04</font><font color="#000080">)
</font>From<font color="#000080">: </font>DANIEL CHURCHMAN           Number<font color="#000080">: </font><font color="#800000">4145   </font><font color="#000080">[</font><font color="#800000">101</font><font color="#000080">] </font><font color="#FF0000"><b>PASCAL
</b></font>Subj<font color="#000080">: </font>JOYSTICK <font color="#800000">2                 </font>Status<font color="#000080">: </font><font color="#FF0000"><b>Public
</b></font><font color="#000080">------------------------------------------------------------------------------
</font><font color="#FF0000"><b>Procedure </b></font>SetCoord<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      If </b></font>Joy1Hori <font color="#000080">&lt; </font>MinX <font color="#FF0000"><b>then </b></font>NewX <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>else
        </b></font>NewX <font color="#000080">:= </font>Byte<font color="#000080">(</font>Round<font color="#000080">((</font>Joy1Hori <font color="#000080">- </font>MinX<font color="#000080">) / </font>kX<font color="#000080">));
      </font><font color="#FF0000"><b>If </b></font>Joy1Vert <font color="#000080">&lt; </font>MinY <font color="#FF0000"><b>then </b></font>NewY <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>else
        </b></font>NewY <font color="#000080">:= </font>Byte<font color="#000080">(</font>Round<font color="#000080">((</font>Joy1Vert <font color="#000080">- </font>MinY<font color="#000080">) / </font>kY<font color="#000080">));

      </font><font color="#FF0000"><b>If </b></font>NewX <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>NewX <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>NewX <font color="#000080">&gt; </font><font color="#800000">80 </font><font color="#FF0000"><b>then </b></font>NewX <font color="#000080">:= </font><font color="#800000">80</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>NewY <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>NewY <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>NewY <font color="#000080">&gt; </font><font color="#800000">25 </font><font color="#FF0000"><b>then </b></font>NewY <font color="#000080">:= </font><font color="#800000">25</font><font color="#000080">;

    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>MoveIndicator<font color="#000080">;
    </font><font color="#FF0000"><b>begin

      </b></font><font color="#008000"><i>{ If the position has changed, clean up old indicator }
      </i></font><font color="#FF0000"><b>If NOT </b></font><font color="#000080">((</font>OldX <font color="#000080">= </font>NewX<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>OldY <font color="#000080">= </font>NewY<font color="#000080">)) </font><font color="#FF0000"><b>then
      begin

        </b></font><font color="#008000"><i>{ Turn off indicator at old position }
        </i></font><font color="#FF0000"><b>With </b></font>Regs <font color="#FF0000"><b>do
        begin
          </b></font><font color="#008000"><i>{ First, move cursor to old position }
          </i></font>AH <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;   </font><font color="#008000"><i>{ Set cursor position                }
          </i></font>BH <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;   </font><font color="#008000"><i>{ Assume page 0                      }
          </i></font>DH <font color="#000080">:= </font>OldY <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{ This value must be zero-based }
          </i></font>DL <font color="#000080">:= </font>OldX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{ This one too                  }
          </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);

          </font><font color="#008000"><i>{ Now change the attribute }
          </i></font>AH <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;   </font><font color="#008000"><i>{ Read what character is there now                  }
          </i></font>BH <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;   </font><font color="#008000"><i>{ I'm assuming page 0                               }
          </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);  </font><font color="#008000"><i>{AH now holds the attribute, AL the character }
          </i></font>AH <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;   </font><font color="#008000"><i>{ Write Character and Attribute, AL is ok, so...    }
          </i></font>BL <font color="#000080">:= </font><font color="#800000">31</font><font color="#000080">;  </font><font color="#008000"><i>{ ...only change the attribute                      }
          </i></font>BH <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;   </font><font color="#008000"><i>{ Again, assume page 0                              }
          </i></font>CX <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;   </font><font color="#008000"><i>{ Number of characters to write                     }
          </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">)
        </font><font color="#FF0000"><b>end
      end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{ Always refresh the current position }

      </i></font><font color="#FF0000"><b>With </b></font>Regs <font color="#FF0000"><b>do
      begin
        </b></font><font color="#008000"><i>{ Next, move cursor to new position }
        </i></font>AH <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;   </font><font color="#008000"><i>{ Set cursor position                }
        </i></font>BH <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;   </font><font color="#008000"><i>{ Assume page 0                      }
        </i></font>DH <font color="#000080">:= </font>NewY <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{ This value must be zero-based }
        </i></font>DL <font color="#000080">:= </font>NewX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{ This one too                  }
        </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);

        </font><font color="#008000"><i>{ Then, turn on indicator at NEW position }
        </i></font>AH <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;   </font><font color="#008000"><i>{ Read what character is there now                  }
        </i></font>BH <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;   </font><font color="#008000"><i>{ I'm assuming page 0                               }
        </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);  </font><font color="#008000"><i>{AH now holds the attribute, AL the character }
        </i></font>AH <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;   </font><font color="#008000"><i>{ Write Character and Attribute, AL is ok, so...    }
        </i></font>BL <font color="#000080">:= </font><font color="#800000">112</font><font color="#000080">; </font><font color="#008000"><i>{ ...change the attribute to black on grey          }
        </i></font>BH <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;   </font><font color="#008000"><i>{ Again, assume page 0                              }
        </i></font>CX <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;   </font><font color="#008000"><i>{ Number of characters to write                     }
        </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">)

      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>InitScreen<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>GotoXY<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">);
      </font>Write<font color="#000080">(</font><font color="#800000">'Joystick 1        Joystick 2'</font><font color="#000080">);
      </font>GotoXY<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
      </font>Write<font color="#000080">(</font><font color="#800000">'X :'</font><font color="#000080">);
      </font>GotoXY<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
      </font>Write<font color="#000080">(</font><font color="#800000">'Y :'</font><font color="#000080">);
      </font>GotoXY<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">);
      </font>Write<font color="#000080">(</font><font color="#800000">'Buttons :'</font><font color="#000080">);
      </font>GotoXY<font color="#000080">(</font><font color="#800000">16</font><font color="#000080">,</font><font color="#800000">16</font><font color="#000080">);
      </font>Write<font color="#000080">(</font><font color="#800000">'Error ='</font><font color="#000080">);
      </font>GotoXY<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">);
      </font>Write<font color="#000080">(</font><font color="#800000">'Press &quot;C&quot; to reCalibrate your joystick'</font><font color="#000080">);

      </font><font color="#FF0000"><b>With </b></font>Regs <font color="#FF0000"><b>do
      begin      </b></font><font color="#008000"><i>{ First, save present cursor configuration }

        </i></font>AH <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">; </font><font color="#008000"><i>{ Read cursor pos and config }
        </i></font>BH <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{ Assuming we are using page 0 }
        </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
        </font>CStart <font color="#000080">:= </font>CH<font color="#000080">; </font><font color="#008000"><i>{ Starting line of cursor }
        </i></font>CEnd   <font color="#000080">:= </font>CL<font color="#000080">; </font><font color="#008000"><i>{ Ending line of cursor }
        { DH holds cursor row }
        { DL holds cursor column }

        { Now turn the cursor off - we hope! }

        </i></font>AH <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;  </font><font color="#008000"><i>{ Set cursor type }
        </i></font>CH <font color="#000080">:= </font><font color="#800000">$20</font><font color="#000080">; </font><font color="#008000"><i>{ Should cause the cursor to disappear }
        </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);

      </font><font color="#FF0000"><b>end
    end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetKey<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      If </b></font>KeyPressed <font color="#FF0000"><b>then
      begin
        </b></font>LastKey <font color="#000080">:= </font>ReadKey<font color="#000080">;  </font><font color="#008000"><i>{ Read the key in the buffer       }
        </i></font><font color="#FF0000"><b>If </b></font>LastKey <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{ The key is an extended character }
          </i></font>LastKey <font color="#000080">:= </font>ReadKey <font color="#008000"><i>{ Read the extended value          }
      </i></font><font color="#FF0000"><b>end else
        </b></font>LastKey <font color="#000080">:= </font><font color="#800000">#0
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

[</font>Continued<font color="#000080">]

--- </font>Msged<font color="#000080">/</font>sq
 <font color="#000080">* </font>Origin<font color="#000080">: </font>C<font color="#000080">&amp;</font>O Systems<font color="#000080">, </font>Brisbane<font color="#000080">, </font>AUSTRALIA <font color="#000080">(</font><font color="#800000">3</font><font color="#000080">:</font><font color="#800000">640</font><font color="#000080">/</font><font color="#800000">777</font><font color="#000080">)
==============================================================================
 </font>BBS<font color="#000080">: &reg;&reg; </font>The Information <font color="#FF0000"><b>and </b></font>Technology Exchan
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>MATT CRILL                   Date<font color="#000080">: </font><font color="#800000">01</font><font color="#000080">-</font><font color="#800000">05</font><font color="#000080">&Auml;</font><font color="#800000">92 </font><font color="#000080">(</font><font color="#800000">23</font><font color="#000080">:</font><font color="#800000">05</font><font color="#000080">)
</font>From<font color="#000080">: </font>DANIEL CHURCHMAN           Number<font color="#000080">: </font><font color="#800000">4146   </font><font color="#000080">[</font><font color="#800000">101</font><font color="#000080">] </font><font color="#FF0000"><b>PASCAL
</b></font>Subj<font color="#000080">: </font>JOYSTICK <font color="#800000">3                 </font>Status<font color="#000080">: </font><font color="#FF0000"><b>Public
</b></font><font color="#000080">------------------------------------------------------------------------------
</font><font color="#FF0000"><b>begin
  </b></font>TextAttr <font color="#000080">:= </font><font color="#800000">31</font><font color="#000080">;  </font><font color="#008000"><i>{ White on Blue - my favourite :-) }
  </i></font>ClrScr<font color="#000080">;

  </font>Calibrate<font color="#000080">;
  </font>SetCoord<font color="#000080">;

  </font>InitScreen<font color="#000080">;

  </font><font color="#FF0000"><b>Repeat
    </b></font>GetKey<font color="#000080">;  </font><font color="#008000"><i>{ Simply load the variable LastKey with }
             { a keystroke if one is available       }
    </i></font>CheckJoy<font color="#000080">;
    </font>CheckBut<font color="#000080">;
    </font>OldX <font color="#000080">:= </font>NewX<font color="#000080">;
    </font>OldY <font color="#000080">:= </font>NewY<font color="#000080">;
    </font>SetCoord<font color="#000080">;
    </font>GotoXY<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
    </font>Write<font color="#000080">(</font>Joy1Hori<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">);
    </font>GotoXY<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
    </font>Write<font color="#000080">(</font>Joy1Vert<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">);
    </font>GotoXY<font color="#000080">(</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">);
    </font>Write<font color="#000080">((</font>Joy1But1<font color="#000080">):</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">,(</font>Joy1But2<font color="#000080">):</font><font color="#800000">5</font><font color="#000080">);

    </font>GotoXY<font color="#000080">(</font><font color="#800000">44</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
    </font>Write<font color="#000080">(</font>Joy2Hori<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">);
    </font>GotoXY<font color="#000080">(</font><font color="#800000">44</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
    </font>Write<font color="#000080">(</font>Joy2Vert<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">);
    </font>GotoXY<font color="#000080">(</font><font color="#800000">51</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">);
    </font>Write<font color="#000080">(</font>Byte<font color="#000080">(</font>Joy2But1<font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">,</font>Byte<font color="#000080">(</font>Joy2But2<font color="#000080">));

    </font>GotoXY<font color="#000080">(</font><font color="#800000">37</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">);
    </font>Write<font color="#000080">(</font>NewX<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">,</font>NewY<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);

    </font>GotoXY<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">16</font><font color="#000080">);
    </font>Write<font color="#000080">(</font>Error<font color="#000080">:</font><font color="#800000">5</font><font color="#000080">);

    </font>Writeln<font color="#000080">;
    </font>MoveIndicator<font color="#000080">;

    </font><font color="#FF0000"><b>If </b></font>UpCase<font color="#000080">(</font>LastKey<font color="#000080">) = </font><font color="#800000">'C' </font><font color="#FF0000"><b>then
    begin
      </b></font>ClrScr<font color="#000080">;
      </font>Calibrate<font color="#000080">;
      </font>InitScreen
    <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Until </b></font>LastKey <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">;

  </font><font color="#FF0000"><b>With </b></font>Regs <font color="#FF0000"><b>do
  begin      </b></font><font color="#008000"><i>{ Restore original cursor configuration }

    </i></font>AH <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;  </font><font color="#008000"><i>{ Set cursor type }
    </i></font>CH <font color="#000080">:= </font>CStart<font color="#000080">; </font><font color="#008000"><i>{ Original cursor start line }
    </i></font>CL <font color="#000080">:= </font>CEnd<font color="#000080">;   </font><font color="#008000"><i>{ Original cursor end line }
    </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
    </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.



[</font><font color="#FF0000"><b>End of </b></font>code<font color="#000080">]
--- </font>Msged<font color="#000080">/</font>sq
 <font color="#000080">* </font>Origin<font color="#000080">: </font>C<font color="#000080">&amp;</font>O Systems<font color="#000080">, </font>Brisbane<font color="#000080">, </font>AUSTRALIA <font color="#000080">(</font><font color="#800000">3</font><font color="#000080">:</font><font color="#800000">640</font><font color="#000080">/</font><font color="#800000">777</font><font color="#000080">)
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to JOYSTICK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p></body>
</html>
