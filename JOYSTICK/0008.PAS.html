<html>
<head><title> "Joystick Routines" by WESLEY R. ELSBERRY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to JOYSTICK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Can anybody give me any info on how to read signals from pins on say
&gt; COM2: or from LPT1: or even from The joystick port? I think it has
&gt; been done with the PORT command or something, but what are the values
&gt; to use to read them with?

As mentioned in the Neural_Net Echo:
}

</i></font><font color="#FF0000"><b>UNIT </b></font>joys<font color="#000080">;

</font><font color="#008000"><i>{Joystick interface for Turbo Pascal.}
{Copyright 1993 by Wesley R. Elsberry.  Released for noncommercial use.}
{NO WARRANTY.}

</i></font><font color="#FF0000"><b>INTERFACE

VAR
  </b></font>xcor<font color="#000080">, </font>ycor<font color="#000080">,
  </font>fire1<font color="#000080">, </font>fire2 <font color="#000080">: </font>WORD<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>joy<font color="#000080">;     </font><font color="#008000"><i>{ basic info for first joystick }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>testjoy<font color="#000080">; </font><font color="#008000"><i>{ minimal test routine }

</i></font><font color="#FF0000"><b>IMPLEMENTATION

</b></font><font color="#008000"><i>{ Significant aid was had from the example given in:
  programm to read joystick : turbo c 2.0 - Jean-Yves Vinet }

</i></font><font color="#FF0000"><b>CONST
  </b></font>JOYPORT <font color="#000080">= </font><font color="#800000">$201</font><font color="#000080">;
  </font>STROUT  <font color="#000080">= </font><font color="#800000">$FF</font><font color="#000080">;
  </font>STRCMP  <font color="#000080">= </font><font color="#800000">$FFFF</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>inread<font color="#000080">,
  </font>temp   <font color="#000080">: </font>BYTE<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>joy<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>done <font color="#000080">: </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>done <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font>xcor <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>ycor <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>port<font color="#000080">[</font>JOYPORT<font color="#000080">] := </font>STROUT<font color="#000080">;

  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>done<font color="#000080">) </font><font color="#FF0000"><b>DO
  BEGIN
    if </b></font><font color="#000080">((</font>port<font color="#000080">[</font>JOYPORT<font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>done <font color="#000080">:= </font>TRUE<font color="#000080">;
    </font>INC<font color="#000080">(</font>xcor<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>xcor <font color="#000080">= </font>STRCMP<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>done <font color="#000080">:= </font>true<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>port<font color="#000080">[</font>JOYPORT<font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">2</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO </b></font><font color="#000080">;

  </font>done <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font>port<font color="#000080">[</font>JOYPORT<font color="#000080">] := </font>STROUT<font color="#000080">;

  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>done<font color="#000080">) </font><font color="#FF0000"><b>DO
  BEGIN
    if </b></font><font color="#000080">((</font>port<font color="#000080">[</font>JOYPORT<font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">2</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>done <font color="#000080">:= </font>TRUE<font color="#000080">;
    </font>INC<font color="#000080">(</font>ycor<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ycor <font color="#000080">= </font>STRCMP<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>done <font color="#000080">:= </font>TRUE<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>inread <font color="#000080">:= </font>port<font color="#000080">[</font>JOYPORT<font color="#000080">];

  </font><font color="#008000"><i>{ Button A at $10, B at $20, C at $40, D at $80. }
  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>inread <font color="#FF0000"><b>AND </b></font><font color="#800000">$10</font><font color="#000080">) &lt;&gt; </font><font color="#800000">$10</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>fire1 <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>inread <font color="#FF0000"><b>AND </b></font><font color="#800000">$20</font><font color="#000080">) &lt;&gt; </font><font color="#800000">$20</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>fire2 <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{If you want to grab the second joystick values, the X coordinate
should be gotten from comparing port[JOYPORT] to 4, the Y coordinate
from comparing port[JOYPORT] to 8.}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>testjoy<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  while </b></font>TRUE <font color="#FF0000"><b>do
  BEGIN
    </b></font>joy<font color="#000080">;
    </font>WRITELN<font color="#000080">(</font>xcor <font color="#000080">: </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">'  '</font><font color="#000080">, </font>ycor<font color="#000080">, </font><font color="#800000">'  '</font><font color="#000080">, </font>fire1<font color="#000080">, </font><font color="#800000">'  '</font><font color="#000080">, </font>fire2<font color="#000080">);
    </font>xcor  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>ycor  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>fire1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>fire2 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font><font color="#008000"><i>{No initialization required.}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{
The above was a pretty quick and dirty approach to grabbing values
off the game card.  I'm sure that there are better means of doing it,
but I haven't put in the time to find them.  Interestingly enough,
the Turbo C version mentioned in the comments of the unit above does
not give as large a value for the maximum displacement of a joystick,
which is an indicator that the Turbo Pascal code is faster than its
equivalent Turbo C counterpart.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to JOYSTICK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p></body>
</html>
