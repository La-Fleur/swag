<html>
<head><title> "Very GOOD menu system" by AVONTURE CHRISTOPHE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ NOTE :  DEMO at the bottom of this unit
          also UMOUSE needed here is in MOUSE.SWG }

{
  AUTHOR             : Christophe.AVONTURE@is.belgacom.be

  AIM                : Makes the creation of menu very, very easy.

  WRITTEN DATE       : Tuesday   March 12 1996
  LAST MODIFICATION  : Wednesday March 14 MARS 1996

  !!!  NEVER MODIFY THIS UNIT.  !!!

  -CONTACT ME IF YOU WANT TRANSLATION INTO ENGLISH-
}

</i></font><font color="#FF0000"><b>Unit </b></font>Menu<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

TYPE

   </b></font><font color="#008000"><i>{ D‚finition d'un type procedure }

   </i></font>TProcedure     <font color="#000080">= </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;

   </font><font color="#008000"><i>{ RŠglemente la longueur d'une option d'un menu. }

   </i></font>TMenuOption    <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">25</font><font color="#000080">];

   </font><font color="#008000"><i>{ Les menus d‚roulants sont pr‚vus pour fonctionner en mode texte 80*25 ou
     en mode graphique 640*480 }

   </i></font>cgVideoMode <font color="#000080">= (</font>cgTextMod<font color="#000080">, </font>cgGraphMod<font color="#000080">);


</font><font color="#FF0000"><b>CONST

   </b></font><font color="#008000"><i>{ C'est cette variable qui d‚terminera la fin du menu.  Le meilleur
     emploi est dans un menu File; option Exit }

   </i></font>bEXIT <font color="#000080">: </font>Boolean <font color="#000080">= </font>FALSE<font color="#000080">;

   </font><font color="#008000"><i>{ D‚clare au programme que le menu doit se faire en mode texte 80*25 }

   </i></font>cgMode <font color="#000080">: </font>cgVideoMode <font color="#000080">= </font>cgTextMod<font color="#000080">;

   </font><font color="#008000"><i>{ Attribut couleur du menu principal }

   </i></font>cgMainMenuAttr  <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">112</font><font color="#000080">;

   </font><font color="#008000"><i>{ Attribut couleur du menu principal : Lettre surbrillance}

   </i></font>cgMainMenuAttrS <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">116</font><font color="#000080">;

   </font><font color="#008000"><i>{ Attribut couleur des sous-menus lorsqu'ils sont s‚lectionn‚s }

   </i></font>cgSubMenuAttr   <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">33</font><font color="#000080">;

   </font><font color="#008000"><i>{ Attribut couleur des sous-menus lorsqu'ils sont s‚lectionn‚s :
     Lettre surbrillance }

   </i></font>cgSubMenuAttrS  <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">44</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR

   </b></font><font color="#008000"><i>{ Cette variable servira … stocker le nom du sous-menu qui est
     actuellement d‚pli‚ afin de ne pas le d‚plier … nouveau lorsqu'on
     s‚lectionne une autre option dans ce mˆme sous-menu. }

   </i></font>cgActualSubMenu   <font color="#000080">: </font>TMenuOption<font color="#000080">;

   </font><font color="#008000"><i>{ Cette variable servira … stocker le nom de l'option qui est
     actuellement s‚lectionn‚e afin de remettre son attribut couleur en
     cgSubMenuAttr. }

   </i></font>cgActualOption    <font color="#000080">: </font>Byte<font color="#000080">;

   </font><font color="#008000"><i>{ Tableau global: contient le nom de toutes les options du menu g‚n‚ral,
     c'est-…-dire qu'il contient tous les lib‚ll‚s des diff‚rents sous-menus
     pr‚sents. }

   </i></font>cgMenu            <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>TMenuOption<font color="#000080">;

   </font><font color="#008000"><i>{ Pr‚sentation sous forme de tableau du menu principal. Ce tableau sera
     compl‚t‚ dynamiquement lors du RUNTIME par le contenu de la constante
     cgMainMenu o— les diff‚rents sous-menus sont s‚par‚s par des blancs. }

   </i></font>cgSubMenu         <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>TMenuOption<font color="#000080">;

   </font><font color="#008000"><i>{ Message qui viendra s'‚crire dans la ligne de statut pour chacune des
     options ou chacun des sous-menus. }

   </i></font>cgMessage         <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font><font color="#000080">^</font><font color="#FF0000"><b>String</b></font><font color="#000080">;

   </font><font color="#008000"><i>{ Nombre de sous-menu apparraissant dans le menu principal.  Cette valeur
     est automatiquement calcul‚ par le programme. }

   </i></font>cgSubMenuNumber  <font color="#000080">: </font>Byte<font color="#000080">;

   </font><font color="#008000"><i>{ Tableau global: contient toutes les proc‚dures pour tous les sous-menus
     du menu g‚n‚ral.  C'est via ce tableau que l'on pourra acc‚der aux
     handler des diff‚rentes options pr‚sentes dans le menu g‚n‚ral. }

   </i></font>cgMenuProc        <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>TProcedure<font color="#000080">;

   </font><font color="#008000"><i>{ Contiendra, pour un sous-menu donn‚, la liste de toutes les proc‚dures
     qui sont associ‚s aux options de ce sous-menu. }

   </i></font>cgSubMenuProc     <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>TProcedure<font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>ShowSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">, </font>cgOption <font color="#000080">: </font>TMenuOption<font color="#000080">; </font>cgMessage <font color="#000080">: </font>Pointer<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>MainMenuHandle<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteBarMenu<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>CopyPage <font color="#000080">(</font>Source<font color="#000080">, </font>Cible <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Cursor_Hide<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>Cursor_Show<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>Run_Menu<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION  </b></font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu <font color="#000080">: </font>TMenuOption<font color="#000080">) : </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

USES </b></font>Crt<font color="#000080">, </font>uMouse<font color="#000080">;  </font><font color="#008000"><i>{ FOUND IN MOUSE.SWG}

</i></font><font color="#FF0000"><b>CONST

   </b></font><font color="#008000"><i>{ Sauvegarde du nombre de handler nouvellement ajout‚ afin de pouvoir les
     retirer lorsque l'on passera … un autre sous-menu. }

   </i></font>OldNumberHandler <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR

   </b></font><font color="#008000"><i>{ Menu principal.  Obligatoirement inf‚rieur ou ‚gal … 100 caractŠres.
     Th‚oriquement, cette taille devrait ˆtre de 80 caractŠres mais comme
     il se peut que l'on utilise des '&amp;' pour pr‚fixer certaines lettres,
     on devra alors tenir compte d'une taille plus grande que 80. }

   </i></font>cgMainMenu        <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">100</font><font color="#000080">];
   </font>cgMainMenu2       <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">100</font><font color="#000080">];

   </font><font color="#008000"><i>{ Cette variable servira … stocker le nom du sous-menu qui est
     actuellement d‚pli‚ afin de ne pas le d‚plier … nouveau lorsqu'on
     s‚lectionne une autre option dans ce mˆme sous-menu. }

   </i></font>cgOldSubMenu      <font color="#000080">: </font>TMenuOption<font color="#000080">;

   </font><font color="#008000"><i>{ Cette variable servira … stocker le nom de l'option qui est
     actuellement s‚lectionn‚e afin de remettre son attribut couleur en
     cgSubMenuAttr. }

   </i></font>cgOldOption       <font color="#000080">: </font>TMenuOption<font color="#000080">;


</font><font color="#008000"><i>{ ************************************************************************ }
{ * Sauvegarde la page ‚cran source dans la page ‚cran destination.      * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>CopyPage <font color="#000080">(</font>Source<font color="#000080">, </font>Cible <font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>BEGIN

    </b></font>Move <font color="#000080">(</font>Mem<font color="#000080">[</font><font color="#800000">$B800</font><font color="#000080">:</font>Source <font color="#FF0000"><b>Shl </b></font><font color="#800000">12</font><font color="#000080">], </font>Mem<font color="#000080">[</font><font color="#800000">$B800</font><font color="#000080">:</font>Cible <font color="#FF0000"><b>Shl </b></font><font color="#800000">12</font><font color="#000080">], </font><font color="#800000">4096</font><font color="#000080">);

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Lorsque le clic de la souris se fait dans une surface non d‚limit‚e, * }
{ * on peut associer une proc‚dure qui sera charg‚e de rafraŒchir l'‚cran* }
{ * ou tout autre chose.  Dans ce cas, le sous-menu sera repli‚.         * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>OtherArea<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

</b></font><font color="#008000"><i>{   CopyPage (1, 0);}

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Ote les blancs se trouvant devant et derriŠre un mot                 * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>AllTrim <font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

    WHILE </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>DO
       </b></font>Delete <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

    </font><font color="#FF0000"><b>WHILE </b></font>s<font color="#000080">[</font>Length<font color="#000080">(</font>s<font color="#000080">)] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>DO
       </b></font>Delete <font color="#000080">(</font>s<font color="#000080">, </font>Length<font color="#000080">(</font>s<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);

    </font>AllTrim <font color="#000080">:= </font>s<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Proc‚dure bidon: assign‚e par d‚faut … toutes les nouvelles options  * }
{ * cr‚‚es ou … tous nouveaux sous-menus.                                * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>hNULL<font color="#000080">;  </font><font color="#FF0000"><b>FAR</b></font><font color="#000080">; </font><font color="#FF0000"><b>BEGIN END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Affiche le texte fournit comme paramŠtre … la position courante du   * }
{ * curseur en prenant soin de retirer tous les &quot;&amp;&quot;.                     * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ShowText <font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>VAR
   </b></font>OldAttr <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

    </b></font><font color="#008000"><i>{ Sauvegarde l'attribut de couleur actuel }

    </i></font>OldAttr <font color="#000080">:= </font>TextAttr<font color="#000080">;

    </font><font color="#008000"><i>{ Masque le curseur de la souris afin de ne pas ‚crire dessus. }

    </i></font>Mouse_Hide<font color="#000080">;

    </font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">, </font>S<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
       BEGIN

          </b></font><font color="#008000"><i>{ Il faut traiter les diff‚rents '&amp;' pr‚sents dans le texte. }

          </i></font><font color="#FF0000"><b>REPEAT

                </b></font><font color="#008000"><i>{ Ecriture de la partie de texte se situant avant le '&amp;' }

                </i></font>TextAttr <font color="#000080">:= </font>OldAttr<font color="#000080">;
                </font>Write <font color="#000080">(</font>Copy <font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">, </font>S<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));

                </font><font color="#008000"><i>{ Ecriture de la lettre pr‚fix‚e par le '&amp;' dans une autre
                  couleur. }

                </i></font><font color="#FF0000"><b>IF </b></font>OldAttr <font color="#000080">= </font>cgMainMenuAttr <font color="#FF0000"><b>THEN
                   </b></font>TextAttr <font color="#000080">:= </font>cgMainMenuAttrS
                <font color="#FF0000"><b>ELSE
                   </b></font>TextAttr <font color="#000080">:= </font>cgSubMenuAttrS<font color="#000080">;

                </font>Delete <font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">, </font>S<font color="#000080">));
                </font>Write <font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);

                </font><font color="#008000"><i>{ Effacement du '&amp;' }

                </i></font>Delete <font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

          </font><font color="#FF0000"><b>UNTIL </b></font>Pos<font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">, </font>S<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">;

          </font>TextAttr <font color="#000080">:= </font>OldAttr<font color="#000080">;
          </font>Write <font color="#000080">(</font>S<font color="#000080">);

       </font><font color="#FF0000"><b>END
    ELSE
       </b></font>Write <font color="#000080">(</font>S<font color="#000080">);

    </font><font color="#008000"><i>{ R‚affiche le curseur de la souris. }

    </i></font>Mouse_Show<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Retourne une chaŒne de caractŠres sans les  &quot;&amp;&quot;.                     * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Remove_Ampersand <font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   WHILE </b></font>Pos <font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">, </font>s<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
     </b></font>Delete <font color="#000080">(</font>s<font color="#000080">, (</font>Pos<font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">, </font>s<font color="#000080">)), </font><font color="#800000">1</font><font color="#000080">);

   </font>Remove_Ampersand <font color="#000080">:= </font>s<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Affiche le menu principal.                                           * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>WriteBarMenu<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>I <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

    </b></font>S <font color="#000080">:= </font>cgMainMenu<font color="#000080">;
    </font>GotoXy <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font>TextAttr <font color="#000080">:= </font>cgMainMenuAttr<font color="#000080">;
    </font>Mouse_Hide<font color="#000080">;
    </font>ClrEol<font color="#000080">;
    </font>Mouse_Show<font color="#000080">;

    </font>ShowText <font color="#000080">(</font>cgMainMenu<font color="#000080">);

    </font><font color="#008000"><i>{ Affiche la barre d'‚tat }

    </i></font>GotoXy <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
    </font>Mouse_Hide<font color="#000080">;
    </font>ClrEol<font color="#000080">;
    </font>Mouse_Show<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Cette fonction retourne la position du sous-menu dans la chaŒne      * }
{ * cgMainMenu. Elle sera utile uniquement pour d‚terminer la colonne o— * }
{ * d‚bute le sous-menu … l'‚cran.                                       * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu <font color="#000080">: </font>TMenuOption<font color="#000080">) : </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>I <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   </b></font>GetPosSubMenu <font color="#000080">:= </font>Pos <font color="#000080">(</font>Remove_Ampersand<font color="#000080">(</font>cgSubMenu<font color="#000080">), </font>cgMainMenu2<font color="#000080">);

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Cette fonction va retourner 1 si c'est le tout premier sous-menu de  * }
{ * la barre de menus, 2 si c'est le second, ... ind‚pendamment du X     * }
{ * (colonne) dans cette mˆme barre.                                     * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu <font color="#000080">: </font>TMenuOption<font color="#000080">) : </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>I<font color="#000080">, </font>J <font color="#000080">: </font>Byte<font color="#000080">;
   </font>s    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>s2   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>bFin <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   </b></font>s    <font color="#000080">:= </font>cgMainMenu<font color="#000080">;
   </font>I    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>bFin <font color="#000080">:= </font>False<font color="#000080">;

   </font><font color="#FF0000"><b>REPEAT

      </b></font>Inc <font color="#000080">(</font>I<font color="#000080">);

      </font><font color="#FF0000"><b>WHILE </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>DO
         </b></font>Delete <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

      </font>J  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>s2 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

      </font><font color="#FF0000"><b>REPEAT
         </b></font>Inc <font color="#000080">(</font>J<font color="#000080">);
         </font>s2 <font color="#000080">:= </font>s2 <font color="#000080">+ </font>s<font color="#000080">[</font>J<font color="#000080">];
      </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>s<font color="#000080">[</font>J<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>J <font color="#000080">= </font>Length<font color="#000080">(</font>s<font color="#000080">));

      </font>Delete <font color="#000080">(</font>s2<font color="#000080">, </font>Length<font color="#000080">(</font>s2<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);

      </font><font color="#FF0000"><b>IF </b></font>s2 <font color="#000080">= </font>cgSubMenu <font color="#FF0000"><b>THEN
         </b></font>bFin <font color="#000080">:= </font>True
      <font color="#FF0000"><b>ELSE
         IF </b></font>I <font color="#000080">= </font>cgSubMenuNumber <font color="#FF0000"><b>THEN
            </b></font>bFin <font color="#000080">:= </font>True
         <font color="#FF0000"><b>ELSE
            </b></font>Delete <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>s2<font color="#000080">));

   </font><font color="#FF0000"><b>UNTIL </b></font>bFin<font color="#000080">;

   </font>GetOrderSubMenu <font color="#000080">:= </font>I<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Cette fonction va retourner 1 si c'est la toute premiŠre option du   * }
{ * sous-menu, 2 si c'est la seconde, ... ind‚pendamment du X (colonne). * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetOrderOptionMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">, </font>cgOption <font color="#000080">: </font>TMenuOption<font color="#000080">) : </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>I   <font color="#000080">: </font>Byte<font color="#000080">;
   </font>J   <font color="#000080">: </font>Integer<font color="#000080">;
   </font>Err <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   </b></font>Val <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu<font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>Low <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)])],
        </font>J<font color="#000080">, </font>err<font color="#000080">);

   </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= (</font>Low <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)]) + </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>TO </b></font>J <font color="#FF0000"><b>DO
      IF </b></font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">] = </font>cgOption <font color="#FF0000"><b>THEN
         </b></font>Break<font color="#000080">;

   </font>GetOrderOptionMenu <font color="#000080">:= </font>I <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>hAllOption<font color="#000080">;   </font><font color="#FF0000"><b>FAR</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN

   </b></font><font color="#008000"><i>{ Mise en surbrillance de l'option. }

   </i></font>cgActualOption <font color="#000080">:= (</font>cgMouse_Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Shr </b></font><font color="#800000">3</font><font color="#000080">;
   </font>ShowSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">[</font>GetOrderSubMenu<font color="#000080">(</font>cgActualSubMenu<font color="#000080">)],
                </font>cgMenu<font color="#000080">[</font>GetOrderSubMenu<font color="#000080">(</font>cgSubMenu<font color="#000080">[</font>GetOrderSubMenu<font color="#000080">(</font>cgActualSubMenu<font color="#000080">)]),</font>cgActualOption<font color="#000080">],
                </font>cgMessage<font color="#000080">[</font>GetOrderSubMenu<font color="#000080">(</font>cgActualSubMenu<font color="#000080">),</font>cgActualOption<font color="#000080">]);

   </font><font color="#008000"><i>{ Il ne faudra ex‚cuter le code que si l'utilisateur a relƒch‚ le bouton
     gauche de la souris et pas autrement. }

   </i></font><font color="#FF0000"><b>IF NOT </b></font>Mouse_ReleaseButton <font color="#000080">(</font>cgMouse_Left<font color="#000080">) </font><font color="#FF0000"><b>THEN
      </b></font>cgMenuProc<font color="#000080">[</font>GetOrderSubMenu<font color="#000080">(</font>cgActualSubMenu<font color="#000080">),</font>cgActualOption<font color="#000080">];
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * D‚plie un sous-menu.  Si le paramŠtre cgOption est sp‚cifi‚ (diff‚-  * }
{ * rent de ''), alors le sous-menu est d‚pli‚ et l'option donn‚e est    * }
{ * s‚lectionn‚e.                                                        * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ShowSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">, </font>cgOption <font color="#000080">: </font>TMenuOption<font color="#000080">; </font>cgMessage <font color="#000080">: </font>Pointer<font color="#000080">);

</font><font color="#FF0000"><b>VAR
   </b></font>I       <font color="#000080">: </font>Byte<font color="#000080">;
   </font>J       <font color="#000080">: </font>Word<font color="#000080">;
   </font>Max     <font color="#000080">: </font>Byte<font color="#000080">;
   </font>S       <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>Nbr     <font color="#000080">: </font>Integer<font color="#000080">;
   </font>Err     <font color="#000080">: </font>Integer<font color="#000080">;
   </font><font color="#FF0000"><b>Message </b></font><font color="#000080">: ^</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>SubMenu <font color="#000080">: ^</font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   </b></font><font color="#008000"><i>{ On va faire un rafraichissement de l'‚cran uniquement s'il y a lieu d'en
     faire un. }


   </i></font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">((</font>cgSubMenu <font color="#000080">= </font>cgOldSubMenu<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>cgOption <font color="#000080">= </font>cgOldOption<font color="#000080">)) </font><font color="#FF0000"><b>THEN
      BEGIN

         IF NOT </b></font><font color="#000080">(</font>cgSubMenu <font color="#000080">= </font>cgOldSubMenu<font color="#000080">) </font><font color="#FF0000"><b>THEN
            BEGIN

               </b></font>CopyPage <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);

               </font><font color="#008000"><i>{ Retire les anciens handler d'un autre sous-menu }

               </i></font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>oldNumberHandler <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                  FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>oldNumberHandler <font color="#FF0000"><b>DO
                     </b></font>Mouse_RemoveHandler<font color="#000080">;

               </font>WriteBarMenu<font color="#000080">;

               </font><font color="#008000"><i>{ Mise en surbrillance du sous-menu }

               </i></font>TextAttr <font color="#000080">:= </font>cgSubMenuAttr<font color="#000080">;

               </font>J <font color="#000080">:= </font>GetPosSubMenu<font color="#000080">(</font>Remove_Ampersand<font color="#000080">(</font>cgSubMenu<font color="#000080">));

               </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>J <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>J <font color="#000080">&lt; </font><font color="#800000">79</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                  BEGIN
                     </b></font>GotoXy <font color="#000080">(</font>J<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                     </font>ShowText <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">+</font>cgSubMenu<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">);
                  </font><font color="#FF0000"><b>END
               ELSE
                  IF </b></font><font color="#000080">(</font>J <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                     BEGIN
                        </b></font>GotoXy <font color="#000080">(</font>J<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                        </font>ShowText <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">+</font>cgSubMenu<font color="#000080">)
                     </font><font color="#FF0000"><b>END
                  ELSE
                     BEGIN
                        </b></font>GotoXy <font color="#000080">(</font>J<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                        </font>ShowText <font color="#000080">(</font>cgSubMenu<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">);
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

               </font><font color="#008000"><i>{ Lecture du nombre d'options dans ce sous-menu }

               </i></font>Val <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu<font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>Low <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)])],
                    </font>Nbr<font color="#000080">, </font>err<font color="#000080">);

               </font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>Nbr <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                  BEGIN

                     </b></font><font color="#008000"><i>{ Affichage des diff‚rentes options }

                     </i></font>TextAttr <font color="#000080">:= </font>cgMainMenuAttr<font color="#000080">;

                     </font>Max <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

                     </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font>Low <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)]) </font><font color="#FF0000"><b>TO </b></font>High <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)]) </font><font color="#FF0000"><b>DO
                        IF </b></font>Max <font color="#000080">&lt; </font>Length <font color="#000080">(</font>Remove_Ampersand<font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">])) </font><font color="#FF0000"><b>THEN
                           </b></font>Max <font color="#000080">:= </font>Length <font color="#000080">(</font>remove_ampersand<font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">]));

                     </font><font color="#008000"><i>{ Se positionne correctement pour l'affichage }

                     </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) + </font>Max <font color="#000080">+ </font><font color="#800000">4 </font><font color="#000080">&gt; </font><font color="#800000">80</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                        </b></font>GotoXy <font color="#000080">(</font><font color="#800000">80 </font><font color="#000080">- </font>Max <font color="#000080">- </font><font color="#800000">4 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">)
                     </font><font color="#FF0000"><b>ELSE
                        IF </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) - </font><font color="#800000">1 </font><font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                           </b></font>GotoXy <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">)
                        </font><font color="#FF0000"><b>ELSE
                           </b></font>GotoXy <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">);

                     </font>FillChar<font color="#000080">(</font>s<font color="#000080">, </font>Max<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">'&Auml;'</font><font color="#000080">);
                     </font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Max<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">);
                     </font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] :=  </font><font color="#800000">'&Uacute;'</font><font color="#000080">;
                     </font>s<font color="#000080">[</font>Length<font color="#000080">(</font>s<font color="#000080">)] := </font><font color="#800000">'&iquest;'</font><font color="#000080">;
                     </font>Mouse_Hide<font color="#000080">;
                     </font>Write <font color="#000080">(</font>S<font color="#000080">);
                     </font>Mouse_Show<font color="#000080">;


                     </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font>Low <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)])+</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Nbr <font color="#FF0000"><b>DO
                        BEGIN

                           </b></font><font color="#008000"><i>{ Se positionne correctement pour l'affichage }

                           </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) + </font>Max <font color="#000080">+ </font><font color="#800000">4 </font><font color="#000080">&gt; </font><font color="#800000">80</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                              </b></font>GotoXy <font color="#000080">(</font><font color="#800000">80 </font><font color="#000080">- </font>Max <font color="#000080">- </font><font color="#800000">4 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>I<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">)
                           </font><font color="#FF0000"><b>ELSE
                              IF </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) - </font><font color="#800000">1 </font><font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                                 </b></font>GotoXy <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">, </font>I<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">)
                              </font><font color="#FF0000"><b>ELSE
                                 </b></font>GotoXy <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">), </font>I<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);

                           </font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">] = </font><font color="#800000">'&Auml;'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                              BEGIN

                                 IF </b></font>Pos<font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">, </font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">]) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                                    </b></font>FillChar<font color="#000080">(</font>s<font color="#000080">, </font>Max<font color="#000080">+</font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">)
                                 </font><font color="#FF0000"><b>ELSE
                                    </b></font>FillChar<font color="#000080">(</font>s<font color="#000080">, </font>Max<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">);

                                 </font>s <font color="#000080">:= </font><font color="#800000">'&sup3; '</font><font color="#000080">+</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">];

                                 </font><font color="#FF0000"><b>IF </b></font>Pos<font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">, </font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">]) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                                    </b></font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Max<font color="#000080">+</font><font color="#800000">5</font><font color="#000080">)
                                 </font><font color="#FF0000"><b>ELSE
                                    </b></font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Max<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">);

                                 </font>s<font color="#000080">[</font>Length<font color="#000080">(</font>s<font color="#000080">)] := </font><font color="#800000">'&sup3;'</font><font color="#000080">;

                                 </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) + </font>Max <font color="#000080">&gt; </font><font color="#800000">80</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                                    </b></font>Mouse_AddHandler <font color="#000080">(</font><font color="#800000">80 </font><font color="#000080">- (</font>Max <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">), </font><font color="#800000">80</font><font color="#000080">, </font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>hAllOption<font color="#000080">)
                                 </font><font color="#FF0000"><b>ELSE
                                    </b></font>Mouse_AddHandler <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">,
                                       </font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">+</font>Max<font color="#000080">,
                                       </font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>hAllOption<font color="#000080">);
                              </font><font color="#FF0000"><b>END
                           ELSE
                              BEGIN
                                 </b></font>FillChar<font color="#000080">(</font>s<font color="#000080">, </font>Max<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">'&Auml;'</font><font color="#000080">);
                                 </font>s <font color="#000080">:= </font><font color="#800000">'&Atilde;'</font><font color="#000080">+</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">];
                                 </font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Max<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">);
                                 </font>s<font color="#000080">[</font>Length<font color="#000080">(</font>s<font color="#000080">)] := </font><font color="#800000">'&acute;'</font><font color="#000080">;
                             </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                           </font>ShowText <font color="#000080">(</font>s<font color="#000080">);
                        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

                     </font>FillChar<font color="#000080">(</font>s<font color="#000080">, </font>Max<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">'&Auml;'</font><font color="#000080">);
                     </font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Max<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">);
                     </font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] :=  </font><font color="#800000">'&Agrave;'</font><font color="#000080">;
                     </font>s<font color="#000080">[</font>Length<font color="#000080">(</font>s<font color="#000080">)] := </font><font color="#800000">'&Ugrave;'</font><font color="#000080">;

                     </font><font color="#008000"><i>{ Se positionne correctement pour l'affichage }

                     </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) + </font>Max <font color="#000080">+ </font><font color="#800000">4 </font><font color="#000080">&gt; </font><font color="#800000">80</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                        </b></font>GotoXy <font color="#000080">(</font><font color="#800000">80 </font><font color="#000080">- </font>Max <font color="#000080">- </font><font color="#800000">4 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>Nbr <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">)
                     </font><font color="#FF0000"><b>ELSE
                        IF </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) - </font><font color="#800000">1 </font><font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                           </b></font>GotoXy <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">, </font>Nbr<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">)
                        </font><font color="#FF0000"><b>ELSE
                           </b></font>GotoXy <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">), </font>Nbr<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);

                     </font>Mouse_Hide<font color="#000080">;
                     </font>Write <font color="#000080">(</font>S<font color="#000080">);
                     </font>Mouse_Show<font color="#000080">;

                     </font>cgOldOption <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

                     </font>OldNumberHandler <font color="#000080">:= </font>Nbr<font color="#000080">;

                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

            </font><font color="#FF0000"><b>END

         ELSE

            IF NOT </b></font><font color="#000080">(</font>cgoldOption <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
               BEGIN

                  </b></font>Max <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

                  </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font>Low <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)]) </font><font color="#FF0000"><b>TO </b></font>High <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)]) </font><font color="#FF0000"><b>DO
                     IF </b></font>Max <font color="#000080">&lt; </font>Length <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">]) </font><font color="#FF0000"><b>THEN
                        </b></font>Max <font color="#000080">:= </font>Length <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">]);

                  </font><font color="#008000"><i>{ R‚tablit l'attribut de l'option anciennement
                    s‚lectionn‚e }

                  </i></font>TextAttr <font color="#000080">:= </font>cgMainMenuAttr<font color="#000080">;

                  </font><font color="#008000"><i>{ Se positionne correctement pour l'affichage }

                  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) + </font>Max <font color="#000080">&gt; </font><font color="#800000">80</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                     </b></font>GotoXy <font color="#000080">(</font><font color="#800000">80 </font><font color="#000080">- </font>Max<font color="#000080">, </font>GetOrderOptionMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">,</font>cgOldOption<font color="#000080">))
                  </font><font color="#FF0000"><b>ELSE
                     IF NOT </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) - </font><font color="#800000">1 </font><font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                        </b></font>GotoXy <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">, </font>GetOrderOptionMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">,</font>cgOldOption<font color="#000080">))
                     </font><font color="#FF0000"><b>ELSE
                        </b></font>GotoXy <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">, </font>GetOrderOptionMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">,</font>cgOldOption<font color="#000080">));

                  </font>ShowText <font color="#000080">(</font>cgoldOption<font color="#000080">);

                  </font><font color="#008000"><i>{ Surligne la ligne jusqu'au cadre }

                  </i></font>S <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

                  </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font>Length<font color="#000080">(</font>cgoldOption<font color="#000080">)+</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Max <font color="#FF0000"><b>DO
                      </b></font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;

                  </font>Mouse_Hide<font color="#000080">;
                  </font>Write <font color="#000080">(</font>s<font color="#000080">);
                  </font>Mouse_Show<font color="#000080">;

                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

         </font>cgOldSubMenu  <font color="#000080">:= </font>cgSubMenu<font color="#000080">;

         </font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>cgOption <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
            BEGIN

               </b></font><font color="#008000"><i>{ Surligne l'option }

               </i></font>TextAttr <font color="#000080">:= </font>cgSubMenuAttr<font color="#000080">;

               </font>Max <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

               </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font>Low <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)]) </font><font color="#FF0000"><b>TO </b></font>High <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)]) </font><font color="#FF0000"><b>DO
                  IF </b></font>Max <font color="#000080">&lt; </font>Length <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">]) </font><font color="#FF0000"><b>THEN
                     </b></font>Max <font color="#000080">:= </font>Length <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">]);

               </font><font color="#008000"><i>{ Se positionne correctement pour l'affichage }

               </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) + </font>Max <font color="#000080">&gt; </font><font color="#800000">80</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                  </b></font>GotoXy <font color="#000080">(</font><font color="#800000">80 </font><font color="#000080">- </font>Max<font color="#000080">, </font>GetOrderOptionMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">,</font>cgOption<font color="#000080">))
               </font><font color="#FF0000"><b>ELSE
                  IF NOT </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) - </font><font color="#800000">1 </font><font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                     </b></font>GotoXy <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">, </font>GetOrderOptionMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">,</font>cgOption<font color="#000080">))
                  </font><font color="#FF0000"><b>ELSE
                     </b></font>GotoXy <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">, </font>GetOrderOptionMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">,</font>cgOption<font color="#000080">));

               </font>ShowText <font color="#000080">(</font>cgOption<font color="#000080">);

               </font><font color="#008000"><i>{ Surligne la ligne jusqu'au cadre }

               </i></font>Max <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

               </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font>Low <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)]) </font><font color="#FF0000"><b>TO </b></font>High <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">)]) </font><font color="#FF0000"><b>DO
                  IF </b></font>Max <font color="#000080">&lt; </font>Length <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">]) </font><font color="#FF0000"><b>THEN
                     </b></font>Max <font color="#000080">:= </font>Length <font color="#000080">(</font>cgMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">),</font>I<font color="#000080">]);

               </font>S <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

               </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font>Length<font color="#000080">(</font>cgOption<font color="#000080">)+</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Max <font color="#FF0000"><b>DO
                   </b></font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;

               </font>Mouse_Hide<font color="#000080">;
               </font>Write <font color="#000080">(</font>s<font color="#000080">);
               </font>Mouse_Show<font color="#000080">;

               </font>cgOldOption <font color="#000080">:= </font>cgOption<font color="#000080">;

            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

         </font>TextAttr <font color="#000080">:= </font>cgMainMenuAttr<font color="#000080">;
         </font>GotoXy <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">);
         </font>ClrEol<font color="#000080">;

         </font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>cgMessage <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>THEN
            BEGIN

                Message </b></font><font color="#000080">:= </font>cgMessage<font color="#000080">;
                </font>TextAttr <font color="#000080">:= </font>cgMainMenuAttr<font color="#000080">;
                </font>GotoXy <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">);
                </font>Mouse_Hide<font color="#000080">;
                </font>Write <font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">^);
                </font>Mouse_SHow<font color="#000080">;

            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Appel la proc‚dure correspondant au sous-menu s‚lectionn‚.           * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>HighLigthMainMenu <font color="#000080">(</font>st <font color="#000080">: </font>TMenuOption<font color="#000080">);

</font><font color="#FF0000"><b>BEGIN

    IF NOT </b></font><font color="#000080">(</font>st <font color="#000080">= </font>cgActualSubMenu<font color="#000080">) </font><font color="#FF0000"><b>THEN
       BEGIN
          </b></font>TextAttr <font color="#000080">:= </font>cgMainMenuAttr<font color="#000080">;
          </font>GotoXy <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
          </font>WriteBarMenu<font color="#000080">;
          </font>TextAttr <font color="#000080">:= </font>cgSubMenuAttr<font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>st<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
       NOT </b></font><font color="#000080">(</font>GetOrderSubMenu <font color="#000080">(</font>st<font color="#000080">) &gt; </font>cgSubMenuNumber<font color="#000080">) </font><font color="#FF0000"><b>THEN
       BEGIN

          </b></font><font color="#008000"><i>{ D‚plie le sous-menu }

          </i></font>cgActualSubMenu <font color="#000080">:= </font>cgSubMenu<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>st<font color="#000080">)];

          </font>ShowSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">[</font>GetOrderSubMenu<font color="#000080">(</font>cgActualSubMenu<font color="#000080">)],
                       </font><font color="#800000">''</font><font color="#000080">,</font>cgMessage<font color="#000080">[</font>GetOrderSubMenu<font color="#000080">(</font>cgActualSubMenu<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">]);

          </font><font color="#008000"><i>{ Appel au code qui se trouve sous le sous-menu uniquement si
            l'utilisateur a relƒch‚ le bouton de gauche de la souris }

          </i></font><font color="#FF0000"><b>IF NOT </b></font>Mouse_ReleaseButton <font color="#000080">(</font>cgMouse_Left<font color="#000080">) </font><font color="#FF0000"><b>THEN
             </b></font>cgSubMenuProc<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>st<font color="#000080">)];

        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Fournit le nom du sous-menu suivant (dans l'ordre de position) du    * }
{ * sous-menu dont le nom est fournit comme paramŠtre.                   * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetNextSubMenu <font color="#000080">(</font>OldSubMenu <font color="#000080">: </font>TMenuOption<font color="#000080">) : </font>TMenuOption<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>s     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>s1    <font color="#000080">: </font>TMenuOption<font color="#000080">;
   </font>I     <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   </b></font>s <font color="#000080">:= </font>cgMainMenu<font color="#000080">;

   </font>Delete <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font>OldSubMenu<font color="#000080">,</font>cgMainMenu<font color="#000080">)+</font>Length<font color="#000080">(</font>OldSubMenu<font color="#000080">));

   </font><font color="#FF0000"><b>WHILE </b></font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>DO
      </b></font>Delete <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

   </font>I <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

   </font>s1 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

   </font><font color="#FF0000"><b>WHILE NOT </b></font><font color="#000080">(</font>s<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>DO
      BEGIN
         IF NOT </b></font><font color="#000080">(</font>I <font color="#000080">&gt; </font>Length <font color="#000080">(</font>s<font color="#000080">)) </font><font color="#FF0000"><b>THEN
            </b></font>s1 <font color="#000080">:= </font>s1 <font color="#000080">+ </font>s<font color="#000080">[</font>I<font color="#000080">];
         </font>Inc <font color="#000080">(</font>I<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font>GetNextSubMenu <font color="#000080">:= </font>s1<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Fournit le nombre de sous-menu pr‚sent dans le menu principal.       * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetSubMenuNumber <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>I <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   </b></font>I <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>s <font color="#000080">:= </font>cgMainMenu<font color="#000080">;

   </font><font color="#FF0000"><b>REPEAT
      </b></font>Inc <font color="#000080">(</font>I<font color="#000080">);

      </font><font color="#FF0000"><b>WHILE </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>DO
         </b></font>Delete <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

      </font><font color="#FF0000"><b>REPEAT
         </b></font>Delete <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>s<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">);

   </font><font color="#FF0000"><b>UNTIL </b></font>Length<font color="#000080">(</font>s<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">;

   </font>GetSubMenuNumber <font color="#000080">:= </font>I<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Cette proc‚dure va se charger de lire le fichier MENU.INC afin de    * }
{ * compl‚ter ses tableaux.                                              * }
{ ************************************************************************ }


</i></font><font color="#FF0000"><b>PROCEDURE </b></font>InitAllSubMenu<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>fMenu <font color="#000080">: </font>Text<font color="#000080">;
   </font>S     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>SS    <font color="#000080">: </font>TMenuOption<font color="#000080">;
   </font>I     <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   </b></font>Assign <font color="#000080">(</font>fMenu<font color="#000080">, </font><font color="#800000">'MENU.INC'</font><font color="#000080">);
   </font>FileMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>Reset <font color="#000080">(</font>fMenu<font color="#000080">);

   </font>I <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

   </font><font color="#FF0000"><b>REPEAT

      </b></font>ReadLn <font color="#000080">(</font>fMenu<font color="#000080">, </font>s<font color="#000080">);

      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Copy <font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">) = </font><font color="#800000">'  '</font><font color="#000080">) </font><font color="#FF0000"><b>THEN

         </b></font><font color="#008000"><i>{ Il s'agit d'une option d'un sous-menu. }

         </i></font><font color="#FF0000"><b>BEGIN

            </b></font><font color="#008000"><i>{ Ajoute l'option dans le sous-menu. }

            </i></font>Inc <font color="#000080">(</font>I<font color="#000080">);
            </font>S <font color="#000080">:= </font>Alltrim<font color="#000080">(</font>s<font color="#000080">);
            </font>cgMenu<font color="#000080">[</font>cgSubMenuNumber<font color="#000080">,</font>I<font color="#000080">] := </font>S<font color="#000080">;

            </font><font color="#008000"><i>{ Par d‚faut, lorsque l'utilisateur cliquera sur cette option,
              la proc‚dure hNULL -c…d qui ne fait absolument rien- sera
              appel‚e. }

            </i></font>cgMenuProc<font color="#000080">[</font>cgSubMenuNumber<font color="#000080">,</font>I<font color="#000080">] := </font>hNULL<font color="#000080">;

         </font><font color="#FF0000"><b>END
      ELSE
         IF </b></font><font color="#000080">(</font>Copy <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">) = </font><font color="#800000">' -'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN

            </b></font><font color="#008000"><i>{ Il s'agit de la ligne d'aide du sous-menu ou de l'option qu'on
              vient tout juste de traiter }

            </i></font><font color="#FF0000"><b>BEGIN

               </b></font><font color="#008000"><i>{ Retire le trait d'union. }

               </i></font>Delete <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

               </font><font color="#008000"><i>{ Ajoute la ligne d'aide. }

               </i></font>S <font color="#000080">:= </font>Alltrim<font color="#000080">(</font>s<font color="#000080">);
               </font>GetMem <font color="#000080">(</font>cgMessage<font color="#000080">[</font>cgSubMenuNumber<font color="#000080">,</font>I<font color="#000080">], </font>Length<font color="#000080">(</font>s<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
               </font>cgMessage<font color="#000080">[</font>cgSubMenuNumber<font color="#000080">,</font>I<font color="#000080">]^:= </font>S<font color="#000080">;

            </font><font color="#FF0000"><b>END
      ELSE

         </b></font><font color="#008000"><i>{ Il s'agit d'un nouveau sous-menu. }

         </i></font><font color="#FF0000"><b>BEGIN

            </b></font><font color="#008000"><i>{ Sauvegarde le nombre d'options appartenant … ce sous-menu en
              position 0. }

            </i></font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>cgSubMenuNumber <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
               </b></font>Str <font color="#000080">(</font>I<font color="#000080">, </font>cgMenu<font color="#000080">[</font>cgSubMenuNumber<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]);

            </font><font color="#008000"><i>{ Ajoute le nouveau sous-menu. }

            </i></font>Inc <font color="#000080">(</font>cgSubMenuNumber<font color="#000080">);
            </font>S <font color="#000080">:= </font>Alltrim<font color="#000080">(</font>s<font color="#000080">);
            </font>cgSubMenu<font color="#000080">[</font>cgSubMenuNumber<font color="#000080">] := </font>S<font color="#000080">;

            </font><font color="#008000"><i>{ Associe par d‚faut le clic sur ce sous-menu … la proc‚dure
              hNULL }

            </i></font>cgSubMenuProc<font color="#000080">[</font>cgSubMenuNumber<font color="#000080">] := </font>hNULL<font color="#000080">;

            </font>I <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>UNTIL </b></font>Eof <font color="#000080">(</font>fMenu<font color="#000080">);

   </font><font color="#008000"><i>{ Sauvegarde le nombre d'options appartenant … ce sous-menu en
     position 0. }

   </i></font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>cgSubMenuNumber <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      </b></font>Str <font color="#000080">(</font>I<font color="#000080">, </font>cgMenu<font color="#000080">[</font>cgSubMenuNumber<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]);

   </font>Close <font color="#000080">(</font>fMenu<font color="#000080">);

   </font><font color="#008000"><i>{ Cr‚e la ligne de sous-menu. }

   </i></font>cgMainMenu <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

   </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>cgSubMenuNumber <font color="#FF0000"><b>DO
      </b></font>cgMainMenu <font color="#000080">:= </font>cgMainMenu <font color="#000080">+ </font>cgSubMenu<font color="#000080">[</font>I<font color="#000080">] + </font><font color="#800000">'  '</font><font color="#000080">;

   </font><font color="#008000"><i>{ Cr‚e la ligne de sous-menus en prenant soin de retirer tous les '&amp;'. }

   </i></font>cgMainMenu2 <font color="#000080">:= </font>cgMainMenu<font color="#000080">;

   </font><font color="#FF0000"><b>WHILE </b></font>Pos <font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">, </font>cgMainMenu2<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
      </b></font>Delete <font color="#000080">(</font>cgMainMenu2<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'&amp;'</font><font color="#000080">, </font>cgMainMenu2<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Proc‚dure de gestion du menu d‚roulant.  C'est elle qui sera appel‚e * }
{ * lorsque le clic de la souris se fera sur la toute premiŠre ligne de  * }
{ * l'‚cran.                                                             * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>MainMenuHandle<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>Old <font color="#000080">: </font>TMenuOption<font color="#000080">;
   </font>I   <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   </b></font>Old <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

   </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>cgSubMenuNumber <font color="#FF0000"><b>DO
      BEGIN

         </b></font>Old <font color="#000080">:= </font>GetNextSubMenu<font color="#000080">(</font>Old<font color="#000080">);
         </font><font color="#FF0000"><b>IF </b></font>Mouse_InArea <font color="#000080">(</font>GetPosSubMenu <font color="#000080">(</font>Old<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">,
              </font>GetPosSubMenu <font color="#000080">(</font>Old<font color="#000080">)+</font>Length <font color="#000080">(</font>Old<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
            BEGIN
               </b></font>HighLigthMainMenu <font color="#000080">(</font>Old<font color="#000080">);
               </font>Break<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Masque le curseur en mode texte.                                     * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Cursor_Hide<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;

</font><font color="#FF0000"><b>ASM

    </b></font><font color="#FF00FF">Mov  Ah, 01h
    Mov  Ch, 20
    Int  10h

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * R‚tablit le curseur en mode texte.                                   * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Cursor_Show<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;

</font><font color="#FF0000"><b>ASM

    </b></font><font color="#FF00FF">Mov  Ah, 01h
    Mov  Cl, 7
    Mov  Ch, 6
    Int  10h

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * Run_Menu va se faire fort de simplifier au MAXIMUM l'‚criture d'un   * }
{ * menu puisqu'il suffira d'associer dans le programme une association  * }
{ * entre l'option et la proc‚dure ad'hoc.  Une fois que les liens ont   * }
{ * ‚t‚ ‚tabli, il suffit d'appeler cette proc‚dure.                     * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Run_Menu<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>Ch <font color="#000080">: </font>Char<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   </b></font>TextAttr <font color="#000080">:= </font><font color="#800000">31</font><font color="#000080">;
   </font>ClrScr<font color="#000080">;

   </font>Cursor_Hide<font color="#000080">;

   </font><font color="#008000"><i>{ Signale que nous allons travailler avec des donn‚es de type caractŠre }

   </i></font>cgCoordonnees <font color="#000080">:= </font>cgCharacter<font color="#000080">;

   </font><font color="#008000"><i>{ Ajoute un handler … celui de la souris.  La r‚gion d‚limit‚e est celle
     de la barre de menus. }

   </i></font>Mouse_AddHandler <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">79</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>MainMenuHandle<font color="#000080">);

   </font><font color="#008000"><i>{ Affiche la barre de menu }

   </i></font>TextAttr <font color="#000080">:= </font>cgMainMenuAttr<font color="#000080">;
   </font>WriteBarMenu<font color="#000080">;

   </font>CopyPage <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

   </font><font color="#FF0000"><b>IF </b></font>bMouse_Exist <font color="#FF0000"><b>THEN
      BEGIN

         </b></font>Mouse_Show<font color="#000080">;

         </font><font color="#FF0000"><b>Repeat

            IF </b></font>Mouse_Pressed <font color="#000080">= </font>cgMouse_Left <font color="#FF0000"><b>THEN
               </b></font>Mouse_Handle
            <font color="#FF0000"><b>ELSE
               IF </b></font>Mouse_Pressed <font color="#000080">= </font>cgMouse_Right <font color="#FF0000"><b>THEN
                    </b></font>bEXIT <font color="#000080">:= </font>TRUE
               <font color="#FF0000"><b>ELSE IF </b></font>KeyPressed <font color="#FF0000"><b>THEN
                  BEGIN

                     </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">; </font><font color="#FF0000"><b>IF </b></font>Ch <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>THEN </b></font>Ch <font color="#000080">:= </font>Readkey<font color="#000080">;

                     </font><font color="#FF0000"><b>CASE </b></font>Ch <font color="#FF0000"><b>OF
                       </b></font><font color="#800000">#72 </font><font color="#000080">: ; </font><font color="#008000"><i>{UpArrow}
                       </i></font><font color="#800000">#80 </font><font color="#000080">: ; </font><font color="#008000"><i>{DownArrow}
                       </i></font><font color="#800000">#75 </font><font color="#000080">: ; </font><font color="#008000"><i>{LeftArrow}
                       </i></font><font color="#800000">#77 </font><font color="#000080">: ; </font><font color="#008000"><i>{RightArrow}
                     </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

         </font><font color="#FF0000"><b>Until </b></font>bEXIT<font color="#000080">;

         </font>Delay <font color="#000080">(</font><font color="#800000">250</font><font color="#000080">);

         </font>Mouse_Hide<font color="#000080">;
         </font>Mouse_Flush<font color="#000080">;

      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font>Cursor_Show<font color="#000080">;

   </font>TextAttr <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
   </font>ClrScr<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>VAR
   </b></font>I   <font color="#000080">: </font>Word<font color="#000080">;
   </font>Old <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   IF </b></font>bMouse_Exist <font color="#FF0000"><b>THEN
      BEGIN
         </b></font>Old <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
         </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>cgSubMenuNumber <font color="#FF0000"><b>DO
            BEGIN
               </b></font>Old <font color="#000080">:= </font>GetNextSubMenu<font color="#000080">(</font>Old<font color="#000080">);
               </font>cgSubMenu<font color="#000080">[</font>I<font color="#000080">] := </font>Old<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

         </font>InitAllSubMenu<font color="#000080">;

         </font>hClicNotInArea <font color="#000080">:= @</font>OtherArea<font color="#000080">;
      </font><font color="#FF0000"><b>END
   ELSE
      BEGIN
         </b></font>Writeln  <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
         </font>Writeln  <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
         </font>Writeln  <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
         </font>Writeln  <font color="#000080">(</font><font color="#800000">'Sorry, but a mouse driver is absolutly needed to run this program.'</font><font color="#000080">);
         </font>Writeln  <font color="#000080">(</font><font color="#800000">'So, please load a driver such as MOUSE.COM'</font><font color="#000080">);
         </font>Writeln  <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
         </font>Writeln  <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
         </font>Halt <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{ -------------------   DEMO  ---------------------- }
{   This program also needs MENU.INC which is below !! }

{ $A+,B-,D+,E+,F-,G-,I+,L+,N-,O-,P-,Q-,R-,S+,T-,V+,X+}
{$M 8384,0,655360}

</i></font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">, </font>uMouse<font color="#000080">, </font>Menu<font color="#000080">;  </font><font color="#008000"><i>{uMOUSE is found in MOUSE.SWG }

{ ************************************************************************ }
{ * This procedure set the bExit variable to TRUE : this tell to the menu* }
{ * engine to stop the process.                                          * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>hFileExit<font color="#000080">; </font><font color="#FF0000"><b>FAR</b></font><font color="#000080">; </font><font color="#FF0000"><b>BEGIN </b></font>bEXIT <font color="#000080">:= </font>True<font color="#000080">; </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ * This procedure is the &quot;About the author&quot; code                        * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>hAboutMe<font color="#000080">; </font><font color="#FF0000"><b>FAR</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>wOldAttr <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN

   </b></font><font color="#008000"><i>{ Hide the mouse pointer }

   </i></font>Mouse_Hide<font color="#000080">;

   </font><font color="#008000"><i>{ Save the screen }

   </i></font>CopyPage <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);

   </font><font color="#008000"><i>{ Show a little About text. }

   </i></font>wOldAttr <font color="#000080">:= </font>TextAttr<font color="#000080">;
   </font>TextAttr <font color="#000080">:= </font><font color="#800000">18</font><font color="#000080">;
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'&Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'&ordm;                            &ordm;&deg;'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'&ordm;    AVONTURE CHRISTOPHE     &ordm;&deg;'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'&ordm;        AVC  SOFTWARE       &ordm;&deg;'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'&ordm;   BD EDMOND MACHTENS 157   &ordm;&deg;'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'&ordm;       BOITE 53             &ordm;&deg;'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'&ordm;      B-1080 BRUXELLES      &ordm;&deg;'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'&ordm;         BELGIQUE           &ordm;&deg;'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'&ordm;                            &ordm;&deg;'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'&Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;&deg;'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'This program has been written by AVONTURE Christophe.'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">19</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'   And I distribute it *FREELY* *WITH ALL SOURCES*'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">' Please email me if you use it or anything else:'</font><font color="#000080">);
   </font>GotoXy <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">22</font><font color="#000080">);
   </font>Write <font color="#000080">(</font><font color="#800000">'Christophe.AVONTURE@is.belgacom.be'</font><font color="#000080">);

   </font><font color="#008000"><i>{ Restore the text color attribute }

   </i></font>TextAttr <font color="#000080">:= </font>wOldAttr<font color="#000080">;

   </font><font color="#008000"><i>{ Wait until the user pressed a mouse button }

   </i></font><font color="#FF0000"><b>REPEAT
   UNTIL NOT </b></font><font color="#000080">(</font>Mouse_Pressed <font color="#000080">= </font>cgMouse_None<font color="#000080">);

   </font><font color="#008000"><i>{ And clear the mouse buffer }

   </i></font>Mouse_Flush<font color="#000080">;

   </font><font color="#008000"><i>{ Restore the screen }

   </i></font>CopyPage <font color="#000080">(</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);

   </font><font color="#008000"><i>{ And reshow the mouse pointer }

   </i></font>Mouse_Show<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************ }
{ *                                                                      * }
{ *                              MAIN PROGRAM                            * }
{ *                                                                      * }
{ ************************************************************************ }

</i></font><font color="#FF0000"><b>BEGIN

   </b></font>ClrScr<font color="#000080">;

   </font>TextAttr <font color="#000080">:= </font><font color="#800000">15</font><font color="#000080">;

   </font>Writeln <font color="#000080">(</font><font color="#800000">'Christophe.AVONTURE@is.belgacom.be'</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">' Try the ''&thorn;'' menu and ''About the author'' option.'</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">' You can quit this program by File|Exit or right clic.'</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">' Sorry but the keyboard isn''t handle: only mouse events are'</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">' accepted.'</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">' The menu is coded into MENU.INC file and all modifications of'</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">' this file implies that you need to recompile the unit and your'</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">' program.'</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);

   </font><font color="#FF0000"><b>REPEAT
   UNTIL </b></font>KeyPressed<font color="#000080">;
   </font>ReadKey<font color="#000080">;

   </font><font color="#008000"><i>{
     The cgMenuProc array will contains all procedure references to your
     code.

     You must always respect the following call :

        cgMenuProc[GetOrderSubMenu (cgSubMenu[x]),xx] := xxx;

     The cgSubMenu[x] will return the indice of the menu option and the
     xx returns the submenu option.  The xxx is the name of the procedure.

     So, if you tried this examples, the first menu option is '&thorn;' and the
     second is 'File'.

     In the '&thorn;' menu, there are two submenu option : 'About' and 'About the
     author'.  So If I want access to the first submenu option of the '&thorn;'
     menu option, I only need to call the
        cgMenuProc[GetOrderSubMenu (cgSubMenu[1]),1]

     The cgSubMenu[1] indentifies the '&thorn;' menu option and the last 1
     identifies the submenu option.

     OK, if you have understand, the following assignation
        cgMenuProc[GetOrderSubMenu (cgSubMenu[1]),2] := hAboutMe;
     tells to the menu engine that you assign to the '&thorn;' &quot;About the author&quot;
     the procedure hAboutMe.

   }

   </i></font>cgMenuProc<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]),</font><font color="#800000">11</font><font color="#000080">] := </font>hFileExit<font color="#000080">;
   </font>cgMenuProc<font color="#000080">[</font>GetOrderSubMenu <font color="#000080">(</font>cgSubMenu<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]),</font><font color="#800000">2</font><font color="#000080">]  := </font>hAboutMe<font color="#000080">;

   </font><font color="#008000"><i>{
     Once the cgMenuProc array fill in, you can call the Run_Menu engine.
   }

   </i></font>Run_Menu<font color="#000080">;

   </font><font color="#008000"><i>{
     You can only arrived here if the bExist boolean value is set to TRUE.
     See the hFileExit procedure.
   }


</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{ -------------------   CUT  ---------------------- }
{ -------  SAVE AS MENU.INC -------- }
</i></font><font color="#000080">&amp;&thorn;
 -</font>System box
  <font color="#000080">&amp;</font>About
 <font color="#000080">-</font>Show general informations about this <font color="#FF0000"><b>program
  </b></font>A<font color="#000080">&amp;</font>bout the author
 <font color="#000080">-</font>Show general informations about author <font color="#FF0000"><b>of </b></font>this <font color="#FF0000"><b>program
</b></font><font color="#000080">&amp;</font><font color="#FF0000"><b>File
 </b></font><font color="#000080">-</font><font color="#FF0000"><b>File </b></font>utilities
  <font color="#000080">&amp;</font>New
 <font color="#000080">-</font>Create a new <font color="#FF0000"><b>file
  </b></font><font color="#000080">&amp;</font>Open<font color="#000080">...
 -</font>Open an existing <font color="#FF0000"><b>file
  </b></font><font color="#000080">&amp;</font>Save
 <font color="#000080">-</font>Save the <font color="#FF0000"><b>file
  </b></font>Save <font color="#000080">&amp;</font><font color="#FF0000"><b>as</b></font><font color="#000080">...
 -</font>Save the current <font color="#FF0000"><b>file </b></font>under a different name
  Save a<font color="#000080">&amp;</font>ll
 <font color="#000080">-</font>Save all modified files
  <font color="#000080">&Auml;
  &amp;</font>Change dir<font color="#000080">...
 -</font>Choose a new <font color="#FF0000"><b>default </b></font>directory
  <font color="#000080">&amp;</font>Print
 <font color="#000080">-</font>Print the contents <font color="#FF0000"><b>of </b></font>the active window
  P<font color="#000080">&amp;</font>rint setup<font color="#000080">...
 -</font>Choose printer filter <font color="#FF0000"><b>to </b></font>use <font color="#FF0000"><b>for </b></font>printing
  <font color="#000080">&amp;</font>Dos shell
 <font color="#000080">-</font>Temporarily exit <font color="#FF0000"><b>to </b></font>DOS
  E<font color="#000080">&amp;</font>xit
 <font color="#000080">-</font>Exit Turbo <font color="#FF0000"><b>Pascal
</b></font><font color="#000080">&amp;</font>Edit
 <font color="#000080">-</font>Edit utilities
  <font color="#000080">&amp;</font>Undo
 <font color="#000080">-</font>Undo the previous editor operation
  <font color="#000080">&amp;</font>Redo
 <font color="#000080">-</font>Redo the previous editor operation
  <font color="#000080">&Auml;
  </font>Cu<font color="#000080">&amp;</font>t
 <font color="#000080">-</font>Remove the selected text <font color="#FF0000"><b>and </b></font>put <font color="#FF0000"><b>in </b></font>into the clipboard
  <font color="#000080">&amp;</font>Copy
 <font color="#000080">-</font>Copy the selected text into the clipboard
  <font color="#000080">&amp;</font>Paste
 <font color="#000080">-</font>Insert selected text from the clipboard at the cursor position
  C<font color="#000080">&amp;</font>lear
 <font color="#000080">-</font>Delete the selected text
  <font color="#000080">&Auml;
  &amp;</font>Show clipboard
 <font color="#000080">-</font>Open the clipboard window
<font color="#000080">&amp;</font>Search
 <font color="#000080">-</font>Search utilities
  <font color="#000080">&amp;</font>Find<font color="#000080">...
 -</font>Search <font color="#FF0000"><b>for </b></font>text
  <font color="#000080">&amp;</font>Replace<font color="#000080">...
 -</font>Search <font color="#FF0000"><b>for </b></font>text <font color="#FF0000"><b>and </b></font>replace it <font color="#FF0000"><b>with </b></font>new text
  <font color="#000080">&amp;</font>Search again
 <font color="#000080">-</font><font color="#FF0000"><b>Repeat </b></font>the last Find <font color="#FF0000"><b>or </b></font>Replace command
  <font color="#000080">&Auml;
  &amp;</font>Go <font color="#FF0000"><b>to </b></font>line number<font color="#000080">...
 -</font>Move the cursor <font color="#FF0000"><b>to </b></font>a specified line number
  S<font color="#000080">&amp;</font>how last compile error
 <font color="#000080">-</font>Move the cursor <font color="#FF0000"><b>to </b></font>the position <font color="#FF0000"><b>of </b></font>the last compile error
  Find <font color="#000080">&amp;</font>error<font color="#000080">...
 -</font>Move the cursor <font color="#FF0000"><b>to </b></font>the position <font color="#FF0000"><b>of </b></font>a runtime error
  Find <font color="#000080">&amp;</font><font color="#FF0000"><b>procedure</b></font><font color="#000080">...
 -</font>Search <font color="#FF0000"><b>for </b></font>a <font color="#FF0000"><b>procedure or function </b></font>declaration <font color="#FF0000"><b>while </b></font>debugging
<font color="#000080">&amp;</font>Run
 <font color="#000080">-</font>Run utilities
  <font color="#000080">&amp;</font>Run
 <font color="#000080">-</font>Run the current <font color="#FF0000"><b>program
  </b></font><font color="#000080">&amp;</font>Step over
 <font color="#000080">-</font>Execute next statement<font color="#000080">, </font>skipping over the current <font color="#FF0000"><b>procedure
  </b></font><font color="#000080">&amp;</font>Trace into
 <font color="#000080">-</font>Execute next statement<font color="#000080">, </font>stopping within the current <font color="#FF0000"><b>procedure
  </b></font><font color="#000080">&amp;</font>Go <font color="#FF0000"><b>to </b></font>cursor
 <font color="#000080">-</font>Run <font color="#FF0000"><b>program </b></font>from the run bar <font color="#FF0000"><b>to </b></font>the cursor position
  <font color="#000080">&amp;</font><font color="#FF0000"><b>Program </b></font>reset
 <font color="#000080">-</font>Halt debugging session <font color="#FF0000"><b>and </b></font>release memory
  P<font color="#000080">&amp;</font>arameters<font color="#000080">...
 -</font><font color="#FF0000"><b>Set </b></font>command line parameters <font color="#FF0000"><b>to </b></font>be passed <font color="#FF0000"><b>to </b></font>the <font color="#FF0000"><b>program
</b></font><font color="#000080">&amp;</font>Compile
 <font color="#000080">-</font>Compile utilities
  <font color="#000080">&amp;</font>Compile
 <font color="#000080">-</font>Compile source <font color="#FF0000"><b>file
  </b></font><font color="#000080">&amp;</font>Make
 <font color="#000080">-</font>Rebuild source <font color="#FF0000"><b>file and </b></font>all other files that have been modified
  <font color="#000080">&amp;</font>Build
 <font color="#000080">-</font>Rebuild source <font color="#FF0000"><b>file and </b></font>all other files
  <font color="#000080">&Auml;
  &amp;</font>Destination Memory
 <font color="#000080">-</font>Specify wheter source <font color="#FF0000"><b>file is </b></font>compiled <font color="#FF0000"><b>to </b></font>memory <font color="#FF0000"><b>or </b></font>disk
  <font color="#000080">&amp;</font>Primary <font color="#FF0000"><b>file</b></font><font color="#000080">...
 -</font>Define the <font color="#FF0000"><b>file </b></font>that <font color="#FF0000"><b>is </b></font>the focus <font color="#FF0000"><b>of </b></font>Make <font color="#FF0000"><b>or </b></font>Build
  C<font color="#000080">&amp;</font>lear primary <font color="#FF0000"><b>file
 </b></font><font color="#000080">-</font>Clear the <font color="#FF0000"><b>file </b></font>previously <font color="#FF0000"><b>set with </b></font>Primary <font color="#FF0000"><b>file
  </b></font><font color="#000080">&Auml;
  &amp;</font>Information<font color="#000080">...
 -</font>Show status information
<font color="#000080">&amp;</font>Debug
 <font color="#000080">-</font>Debug utilities
  <font color="#000080">&amp;</font>BreakPoints<font color="#000080">...
 -</font><font color="#FF0000"><b>Set </b></font>conditionnal breakpoints
  <font color="#000080">&amp;</font>Call stack
 <font color="#000080">-</font>Show the procedures the <font color="#FF0000"><b>program </b></font>called <font color="#FF0000"><b>to </b></font>reach this point
  <font color="#000080">&amp;</font><font color="#FF0000"><b>Register
 </b></font><font color="#000080">-</font>Open the <font color="#FF0000"><b>register </b></font>window
  <font color="#000080">&amp;</font>Watch
 <font color="#000080">-</font>Open the Watch window
  <font color="#000080">&amp;</font>Output
 <font color="#000080">-</font>Open the Output window
  <font color="#000080">&amp;</font>User screen
 <font color="#000080">-</font>Swithc <font color="#FF0000"><b>to </b></font>the full<font color="#000080">-</font>screen user output
  <font color="#000080">&Auml;
  &amp;</font>Evaluate<font color="#000080">/</font>Modify<font color="#000080">...
 -</font>Evaluate a variable <font color="#FF0000"><b>or </b></font>expression <font color="#FF0000"><b>and </b></font>display <font color="#FF0000"><b>or </b></font>modify the value
  <font color="#000080">&amp;</font>Add watch<font color="#000080">...
 -</font>Insert a watch expression into the Watch window
  Add break<font color="#000080">&amp;</font>points<font color="#000080">...
 -</font>Add a breakpoint expression
<font color="#000080">&amp;</font>Tools
 <font color="#000080">-</font>Tools utilities
  <font color="#000080">&amp;</font>Messages
 <font color="#000080">-</font>Open the <font color="#FF0000"><b>message </b></font>window
  <font color="#000080">&amp;</font>Go <font color="#FF0000"><b>to </b></font>next
 <font color="#000080">-</font>Go <font color="#FF0000"><b>to </b></font>the next source position
  <font color="#000080">&amp;</font>Go <font color="#FF0000"><b>to </b></font>previous
 <font color="#000080">-</font>Go <font color="#FF0000"><b>to </b></font>the previous source position
  <font color="#000080">&Auml;
  &amp;</font>Grep
 <font color="#000080">-</font>User installed tool
<font color="#000080">&amp;</font>Options
 <font color="#000080">-</font>Options utilities
  <font color="#000080">&amp;</font>Compiler<font color="#000080">...
 -</font><font color="#FF0000"><b>Set default </b></font>compiler directives
  <font color="#000080">&amp;</font>Memory sizes<font color="#000080">...
 -</font><font color="#FF0000"><b>Set default </b></font>stack <font color="#FF0000"><b>and </b></font>heap sizes <font color="#FF0000"><b>for </b></font>generated programs
  <font color="#000080">&amp;</font>Linker<font color="#000080">...
 -</font><font color="#FF0000"><b>Set </b></font>linker options <font color="#000080">(</font>link buffer<font color="#000080">; .</font>MAP <font color="#FF0000"><b>file </b></font>options<font color="#000080">)
  </font>De<font color="#000080">&amp;</font>bugger<font color="#000080">...
 -</font><font color="#FF0000"><b>Set </b></font>debugger options <font color="#000080">(</font>standalone<font color="#000080">, </font>integrated<font color="#000080">, </font>display swapping<font color="#000080">)
  &amp;</font>Directories<font color="#000080">...
 -</font><font color="#FF0000"><b>Set </b></font>path <font color="#FF0000"><b>for </b></font>units<font color="#000080">, </font>inlude files<font color="#000080">, </font>OBJs<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>generated files
  <font color="#000080">&amp;</font>Tools<font color="#000080">...
 -</font>Create <font color="#FF0000"><b>or </b></font>change tools
  <font color="#000080">&Auml;
  &amp;</font>Environment
 <font color="#000080">-</font>Specify environment settings
  <font color="#000080">&Auml;
  &amp;</font>Open<font color="#000080">...
 -</font>Load options previously create <font color="#FF0000"><b>with </b></font>Save Options
  <font color="#000080">&amp;</font>Save
 <font color="#000080">-</font>Save all the settings you<font color="#800000">'ve made in the Options Menu
  </font>Save <font color="#000080">&amp;</font><font color="#FF0000"><b>as</b></font><font color="#000080">...
 -</font>Save all the settings <font color="#FF0000"><b>in </b></font>the Options Menu <font color="#FF0000"><b>to </b></font>another <font color="#FF0000"><b>file
</b></font><font color="#000080">&amp;</font>Window
 <font color="#000080">-</font>Window utilities
  <font color="#000080">&amp;</font>Tile
 <font color="#000080">-</font>Arrange windows <font color="#FF0000"><b>on </b></font>desktop by tiling
  C<font color="#000080">&amp;</font>ascade
 <font color="#000080">-</font>Arrange windows <font color="#FF0000"><b>on </b></font>desktop by cascading
  Cl<font color="#000080">&amp;</font>ose all
 <font color="#000080">-</font>Close all windows <font color="#FF0000"><b>on </b></font>desktop
  <font color="#000080">&amp;</font>Refresh display
 <font color="#000080">-</font>Redraw the screen
  <font color="#000080">&Auml;
  &amp;</font>Size<font color="#000080">/</font>Move
 <font color="#000080">-</font>Change the size <font color="#FF0000"><b>or </b></font>position <font color="#FF0000"><b>of </b></font>the active window
  <font color="#000080">&amp;</font>Zoom
 <font color="#000080">-</font>Enlarge <font color="#FF0000"><b>or </b></font>restore the size <font color="#FF0000"><b>of </b></font>the active window
  <font color="#000080">&amp;</font>Next
 <font color="#000080">-</font>Make the next window active
  <font color="#000080">&amp;</font>Previous
 <font color="#000080">-</font>Make the previous window active
  <font color="#000080">&amp;</font>Close
 <font color="#000080">-</font>Close the active window
  <font color="#000080">&Auml;
  &amp;</font>List<font color="#000080">...
 -</font>Show a list <font color="#FF0000"><b>of </b></font>all open windows
<font color="#000080">&amp;</font>Help
 <font color="#000080">-</font>Help utilities
  <font color="#000080">&amp;</font>Contents
 <font color="#000080">-</font>Show table <font color="#FF0000"><b>of </b></font>contents <font color="#FF0000"><b>for </b></font>online help
  <font color="#000080">&amp;</font>Index
 <font color="#000080">-</font>Show index <font color="#FF0000"><b>for </b></font>online help
  <font color="#000080">&Auml;
  &amp;</font>Topic search
 <font color="#000080">-</font>Display help <font color="#FF0000"><b>on </b></font>the word at the cursor
  <font color="#000080">&amp;</font>Previous topic
 <font color="#000080">-</font>Redisplay the last<font color="#000080">-</font>viewed online Help screen
  Using <font color="#000080">&amp;</font>help
 <font color="#000080">-</font>How <font color="#FF0000"><b>to </b></font>use online help
  <font color="#000080">&amp;</font>Files<font color="#000080">...
 -</font>Add <font color="#FF0000"><b>or </b></font>delete installated help files
  <font color="#000080">&Auml;
  </font>Compiler <font color="#000080">&amp;</font>directives
 <font color="#000080">-</font>Display help above the compiler directives
  <font color="#000080">&amp;</font>Reserved word
 <font color="#000080">-</font>Display Turbo <font color="#FF0000"><b>Pascal</b></font><font color="#800000">'s reserved words
  </font>Standard <font color="#000080">&amp;</font>units
 <font color="#000080">-</font>Display help about standard Turbo <font color="#FF0000"><b>Pascal </b></font>units
  Turbo <font color="#FF0000"><b>Pascal </b></font><font color="#000080">&amp;</font>Language
 <font color="#000080">-</font>Display help about Turbo <font color="#FF0000"><b>Pascal </b></font>language
  <font color="#000080">&amp;</font>Error messages
 <font color="#000080">-</font>Display help about the error messages
  <font color="#000080">&Auml;
  &amp;</font>About<font color="#000080">...
 -</font>Show version <font color="#FF0000"><b>and </b></font>copyright information

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p></body>
</html>
