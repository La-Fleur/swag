<html>
<head><title> "Vertical Menu Unit" by AVONTURE CHRISTOPHE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{

   Vertical menu unit.

   You can find my horizontal menu unit in the SWAG (since November 96).


               &Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;
               &ordm;                                        &ordm;&deg;
               &ordm;          AVONTURE CHRISTOPHE           &ordm;&deg;
               &ordm;              AVC SOFTWARE              &ordm;&deg;
               &ordm;     BOULEVARD EDMOND MACHTENS 157/53   &ordm;&deg;
               &ordm;           B-1080 BRUXELLES             &ordm;&deg;
               &ordm;              BELGIQUE                  &ordm;&deg;
               &ordm;                                        &ordm;&deg;
               &Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;&deg;
               &deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;


    This is one of my very best unit.  Please send me a postcard if you find
    it usefull.  Thanks in advance!

    ==&gt; Hey, is there somebody  in the United States of America?  I have &lt;==
    ==&gt; received postcard from severall country but none from the States &lt;==
    ==&gt;                           Be the first!                          &lt;==

}

</i></font><font color="#FF0000"><b>Unit </b></font>Menu<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>TCadre     <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>Choixxx   <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
      </font>Double    <font color="#000080">: </font>Tcadre <font color="#000080">= (</font><font color="#800000">'&Eacute;'</font><font color="#000080">,</font><font color="#800000">'&Iacute;'</font><font color="#000080">,</font><font color="#800000">'&raquo;'</font><font color="#000080">,</font><font color="#800000">'&ordm;'</font><font color="#000080">,</font><font color="#800000">'&ordm;'</font><font color="#000080">,</font><font color="#800000">'&Egrave;'</font><font color="#000080">,</font><font color="#800000">'&Iacute;'</font><font color="#000080">,</font><font color="#800000">'&frac14;'</font><font color="#000080">); </font><font color="#008000"><i>{ Cadre }

</i></font><font color="#FF0000"><b>Var </b></font>TMenu<font color="#000080">, </font>TMenu2 <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];

</font><font color="#008000"><i>{ Show a menu option.  Equivalent of @X,Y Prompt &quot;Texte&quot; of Clipper
}

</i></font><font color="#FF0000"><b>Procedure </b></font>Prompt <font color="#000080">(</font>X<font color="#000080">,</font>Y <font color="#000080">: </font>Word<font color="#000080">; </font>Option<font color="#000080">, </font>Aide <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#008000"><i>{ This function allowed the selection of an option.  You must first call
  the Prompt procedure and display all wanted options.  Then the MChoix
  function will made everything.

  If the user press the escape Key, the result will be 255
                        F1 key                         59
                        F2                             60
                        ..
                        F10                            68

  The return result is the index of the option in the TMenu array
}

</i></font><font color="#FF0000"><b>Function </b></font>MChoix <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Nombre <font color="#000080">: </font>Word<font color="#000080">) : </font>Byte<font color="#000080">;

</font><font color="#008000"><i>{ This procedure show an animated line at the specified screen coordinates

  For example,
     Scroll (25, 10, 70, 'You are a very good Pascal Programmer');
}

</i></font><font color="#FF0000"><b>Procedure </b></font>Scroll <font color="#000080">(</font>X<font color="#000080">, </font>Y0<font color="#000080">, </font>Y1 <font color="#000080">: </font>Byte<font color="#000080">; </font>Texte <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#008000"><i>{ Draw a cadre
}

</i></font><font color="#FF0000"><b>Procedure </b></font>Cadre <font color="#000080">(</font>ColD<font color="#000080">, </font>LigD<font color="#000080">, </font>ColF<font color="#000080">, </font>LigF<font color="#000080">, </font>Attr<font color="#000080">, </font>Back <font color="#000080">: </font>Byte<font color="#000080">; </font>Cad <font color="#000080">: </font>TCadre<font color="#000080">);

</font><font color="#008000"><i>{ Write a string at the specified screen coordinates and with the given
  color attribut
}

</i></font><font color="#FF0000"><b>Procedure </b></font>WriteStrXY <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>TAttr<font color="#000080">, </font>TBack <font color="#000080">: </font>Word<font color="#000080">; </font>Texte <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Var
   </b></font>TextBack  <font color="#000080">: </font>Byte<font color="#000080">;
   </font>Ch        <font color="#000080">: </font>Char<font color="#000080">;
   </font>sBlankLine<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Draw a cadre
}

</i></font><font color="#FF0000"><b>Procedure </b></font>Cadre <font color="#000080">(</font>ColD<font color="#000080">, </font>LigD<font color="#000080">, </font>ColF<font color="#000080">, </font>LigF<font color="#000080">, </font>Attr<font color="#000080">, </font>Back <font color="#000080">: </font>Byte<font color="#000080">; </font>Cad <font color="#000080">: </font>TCadre<font color="#000080">);

</font><font color="#FF0000"><b>Var
   </b></font>X<font color="#000080">, </font>Y<font color="#000080">, </font>I<font color="#000080">, </font>Longueur<font color="#000080">, </font>Hauteur <font color="#000080">: </font>Byte<font color="#000080">;
   </font>sLine <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin

     </b></font>X <font color="#000080">:= </font>WhereX<font color="#000080">;  </font>Y <font color="#000080">:= </font>WhereY<font color="#000080">;
     </font>Longueur <font color="#000080">:= (</font>ColF<font color="#000080">-</font>ColD<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">;
     </font>Hauteur  <font color="#000080">:= (</font>LigF<font color="#000080">-</font>LigD<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">;

     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">, </font>LigD<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);

     </font>FillChar <font color="#000080">(</font>sLine<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Longueur<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
     </font>sLine <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Longueur<font color="#000080">);
     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>LigD<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>sLine<font color="#000080">);

     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">+</font>Longueur<font color="#000080">, </font>LigD<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]);

     </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Hauteur <font color="#FF0000"><b>Do Begin
         </b></font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">, </font>LigD<font color="#000080">+</font>I<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);

         </font>FillChar <font color="#000080">(</font>sLine<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Longueur<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">);
         </font>sLine <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Longueur<font color="#000080">);
         </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>LigD<font color="#000080">+</font>I<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>sLine<font color="#000080">);

         </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">+</font>Longueur<font color="#000080">, </font>LigD<font color="#000080">+</font>I<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">, </font>LigF<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]);

     </font>FillChar <font color="#000080">(</font>sLine<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Longueur<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">]);
     </font>sLine <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Longueur<font color="#000080">);
     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>LigF<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>sLine<font color="#000080">);

     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">+</font>Longueur<font color="#000080">, </font>LigF<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">]);

     </font>GotoXy <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Write a string at the specified screen coordinates and with the given
  color attribut
}

</i></font><font color="#FF0000"><b>Procedure </b></font>WriteStrXY <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>TAttr<font color="#000080">, </font>TBack <font color="#000080">: </font>Word<font color="#000080">; </font>Texte <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Var </b></font>Offset   <font color="#000080">: </font>Word<font color="#000080">;
    </font>i        <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Attr     <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin

    </b></font>offset <font color="#000080">:= </font>Y <font color="#000080">* </font><font color="#800000">160 </font><font color="#000080">+ </font>X <font color="#FF0000"><b>Shl </b></font><font color="#800000">1</font><font color="#000080">;
    </font>Attr <font color="#000080">:= ((</font>TAttr<font color="#000080">+(</font>TBack <font color="#FF0000"><b>Shl </b></font><font color="#800000">4</font><font color="#000080">)) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">);

    </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length <font color="#000080">(</font>Texte<font color="#000080">) </font><font color="#FF0000"><b>do Begin
        </b></font>MemW<font color="#000080">[</font><font color="#800000">$B800</font><font color="#000080">:</font>Offset<font color="#000080">] := </font>Attr <font color="#FF0000"><b>or </b></font>Ord<font color="#000080">(</font>Texte<font color="#000080">[</font>i<font color="#000080">]);
        </font>Inc <font color="#000080">(</font>Offset<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Show a menu option.  Equivalent of @X,Y Prompt &quot;Texte&quot; of Clipper
}

</i></font><font color="#FF0000"><b>Procedure </b></font>Prompt <font color="#000080">(</font>X<font color="#000080">,</font>Y <font color="#000080">: </font>Word<font color="#000080">; </font>Option<font color="#000080">, </font>Aide <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font>WriteStrXy <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">, </font>TextAttr<font color="#000080">,</font>TextBack<font color="#000080">,</font>Option<font color="#000080">);
   </font>WriteStrXy <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font>TextAttr<font color="#000080">,</font>TextBack<font color="#000080">,</font>sBlankLine<font color="#000080">);
   </font>WriteStrXy <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font>TextAttr<font color="#000080">,</font>TextBack<font color="#000080">,</font>Aide<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ This function allowed the selection of an option.  You must first call
  the Prompt procedure and display all wanted options.  Then the MChoix
  function will made everything.

  If the user press the escape Key, the result will be 255
                        F1 key                         59
                        F2                             60
                        ..
                        F10                            68

  The return result is the index of the option in the TMenu array
}

</i></font><font color="#FF0000"><b>Function </b></font>MChoix <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Nombre <font color="#000080">: </font>Word<font color="#000080">) : </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin

    </b></font>GotoXy <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">+</font>Choixxx<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
    </font>TextBack <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
        </b></font>Prompt <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">+</font>Choixxx<font color="#000080">, </font>TMenu <font color="#000080">[</font>Choixxx<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">], </font>TMenu <font color="#000080">[</font>Choixxx<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]);
        </font>TextBack <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>Ch <font color="#000080">:= </font>Readkey<font color="#000080">; </font><font color="#FF0000"><b>If </b></font>Ch <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>then </b></font>Ch <font color="#000080">:= </font>Readkey<font color="#000080">;
        </font>Prompt <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">+</font>Choixxx<font color="#000080">, </font>TMenu <font color="#000080">[</font>Choixxx<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">], </font>TMenu <font color="#000080">[</font>Choixxx<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]);
        </font>TextBack <font color="#000080">:= </font><font color="#800000">05</font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Ch <font color="#000080">= </font><font color="#800000">#72</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
          If Not </b></font><font color="#000080">(</font>Choixxx <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin
            </b></font>GotoXy <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);                                          </font><font color="#008000"><i>{UpKey}
            </i></font>Dec <font color="#000080">(</font>choixxx<font color="#000080">);
          </font><font color="#FF0000"><b>End
          Else Begin
            </b></font>Choixxx <font color="#000080">:= </font>Nombre <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
            </font>GotoXy <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">+</font>Choixxx<font color="#000080">);
          </font><font color="#FF0000"><b>End
        End
        Else If </b></font><font color="#000080">(</font>Ch <font color="#000080">= </font><font color="#800000">#80</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
          If not </b></font><font color="#000080">(</font>Choixxx <font color="#000080">= </font>Nombre<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin
            </b></font>GotoXy <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
            </font>Inc <font color="#000080">(</font>Choixxx<font color="#000080">);                                          </font><font color="#008000"><i>{DownKey}
          </i></font><font color="#FF0000"><b>End
          Else Begin
            </b></font>Choixxx <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
            </font>GotoXy <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);
          </font><font color="#FF0000"><b>End
        End
        Else If </b></font><font color="#000080">(</font>Ch <font color="#000080">= </font><font color="#800000">#71</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin
           </b></font>GotoXy <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);                                               </font><font color="#008000"><i>{Home}
           </i></font>Choixxx <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>End
        Else If </b></font><font color="#000080">(</font>Ch <font color="#000080">= </font><font color="#800000">#79</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin
           </b></font>GotoXy <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">+</font>Nombre<font color="#000080">);                                         </font><font color="#008000"><i>{End}
           </i></font>Choixxx <font color="#000080">:= </font>Nombre<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Until </b></font><font color="#000080">((</font>ch <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ch <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">#59</font><font color="#000080">..</font><font color="#800000">#68</font><font color="#000080">]));
    </font><font color="#FF0000"><b>If </b></font>Ch <font color="#000080">= </font><font color="#800000">#27 </font><font color="#FF0000"><b>then </b></font>MChoix <font color="#000080">:= </font><font color="#800000">255
    </font><font color="#FF0000"><b>Else If </b></font>Ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">#59</font><font color="#000080">..</font><font color="#800000">#68</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font>MChoix <font color="#000080">:= </font>Ord<font color="#000080">(</font>Ch<font color="#000080">)
    </font><font color="#FF0000"><b>Else </b></font>MChoix <font color="#000080">:= </font>Choixxx <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ This procedure show an animated line at the specified screen coordinates

  For example,
     Scroll (25, 10, 70, 'You are a very good Pascal Programmer');
}

</i></font><font color="#FF0000"><b>Procedure </b></font>Scroll <font color="#000080">(</font>X<font color="#000080">, </font>Y0<font color="#000080">, </font>Y1 <font color="#000080">: </font>Byte<font color="#000080">; </font>Texte <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Type </b></font>TCell <font color="#000080">= </font><font color="#FF0000"><b>Record
         </b></font>C <font color="#000080">: </font>Char<font color="#000080">;
         </font>A <font color="#000080">: </font>Byte<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>TScreen <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">80</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>TCell<font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>Scr    <font color="#000080">: </font>TScreen <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$B800</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">;
    </font>I<font color="#000080">, </font>J   <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Tour   <font color="#000080">: </font>LongInt<font color="#000080">;

</font><font color="#FF0000"><b>Begin

   </b></font>I <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>Repeat
     While </b></font><font color="#000080">(</font>port<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">8</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Do</b></font><font color="#000080">;  </font><font color="#008000"><i>{ wait retrace }
     </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>port<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">8</font><font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Do</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font>Y0 <font color="#FF0000"><b>To </b></font><font color="#000080">(</font>Y1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Do
        </b></font>Scr<font color="#000080">[</font>X<font color="#000080">, </font>J<font color="#000080">] := </font>Scr<font color="#000080">[</font>X<font color="#000080">, </font>J<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];  </font><font color="#008000"><i>{ shift cell left }
     </i></font>Scr<font color="#000080">[</font>X<font color="#000080">, </font>Y1<font color="#000080">].</font>C <font color="#000080">:= </font>Texte<font color="#000080">[</font>I<font color="#000080">];      </font><font color="#008000"><i>{ add new cell }
     </i></font>Scr<font color="#000080">[</font>X<font color="#000080">, </font>Y1<font color="#000080">].</font>A <font color="#000080">:= </font><font color="#800000">14 </font><font color="#000080">+ (</font><font color="#800000">1 </font><font color="#000080">* </font><font color="#800000">16</font><font color="#000080">);
     </font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">+ (</font>I <font color="#FF0000"><b>mod </b></font>Length<font color="#000080">(</font>Texte<font color="#000080">));
   </font><font color="#FF0000"><b>Until </b></font>Keypressed<font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>FillChar <font color="#000080">(</font>sBlankLine<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font><font color="#800000">80</font><font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">);
   </font>sBlankLine<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#80</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ----------------------------- cut here --------------------------------- }
{

   Example of the vertical menu unit


               &Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;
               &ordm;                                        &ordm;&deg;
               &ordm;          AVONTURE CHRISTOPHE           &ordm;&deg;
               &ordm;              AVC SOFTWARE              &ordm;&deg;
               &ordm;     BOULEVARD EDMOND MACHTENS 157/53   &ordm;&deg;
               &ordm;           B-1080 BRUXELLES             &ordm;&deg;
               &ordm;              BELGIQUE                  &ordm;&deg;
               &ordm;                                        &ordm;&deg;
               &Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;&deg;
               &deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;

}

</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">, </font>Menu<font color="#000080">;

</font><font color="#FF0000"><b>Const
    </b></font>TextColor <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;   </font><font color="#008000"><i>{ Color Fore and Back color }
    </i></font>BackColor <font color="#000080">= </font><font color="#800000">01</font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>Choix<font color="#000080">, </font>I <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Lig      <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin

   </b></font><font color="#008000"><i>{ Draw the screen }

   </i></font>TextAttr <font color="#000080">:= </font>TextColor <font color="#000080">+ (</font>BackColor <font color="#FF0000"><b>Shl </b></font><font color="#800000">4</font><font color="#000080">);

   </font>ClrScr<font color="#000080">;

   </font>Cadre  <font color="#000080">(</font><font color="#800000">02</font><font color="#000080">, </font><font color="#800000">01</font><font color="#000080">, </font><font color="#800000">78</font><font color="#000080">, </font><font color="#800000">05</font><font color="#000080">, </font>TextColor<font color="#000080">, </font>BackColor<font color="#000080">, </font>Double<font color="#000080">);

   </font>WriteStrXy <font color="#000080">(</font><font color="#800000">04</font><font color="#000080">, </font><font color="#800000">03</font><font color="#000080">, </font>TextColor<font color="#000080">, </font>BackColor<font color="#000080">, </font><font color="#800000">'Vertical Unit Menu Sample.'</font><font color="#000080">);
   </font>WriteStrXy <font color="#000080">(</font><font color="#800000">04</font><font color="#000080">, </font><font color="#800000">04</font><font color="#000080">, </font>TextColor<font color="#000080">, </font>BackColor<font color="#000080">, </font><font color="#800000">'Try the '</font><font color="#000080">+
               </font><font color="#800000">'horizontal Menu Unit of AVONTURE Christophe -see in the SWAG- '</font><font color="#000080">);

   </font>Cadre <font color="#000080">(</font><font color="#800000">41</font><font color="#000080">, </font><font color="#800000">07</font><font color="#000080">, </font><font color="#800000">78</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font>TextColor<font color="#000080">, </font>BackColor<font color="#000080">, </font>Double<font color="#000080">);

   </font>WriteStrXy <font color="#000080">(</font><font color="#800000">43</font><font color="#000080">, </font><font color="#800000">09</font><font color="#000080">, </font>TextColor<font color="#000080">, </font>BackColor<font color="#000080">,
              </font><font color="#800000">'This is a little example to show'</font><font color="#000080">);

   </font>WriteStrXy <font color="#000080">(</font><font color="#800000">43</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font>TextColor<font color="#000080">, </font>BackColor<font color="#000080">, </font><font color="#800000">'you the feature of the menu unit.'</font><font color="#000080">);

   </font>WriteStrXy <font color="#000080">(</font><font color="#800000">43</font><font color="#000080">, </font><font color="#800000">13</font><font color="#000080">, </font>TextColor<font color="#000080">, </font>BackColor<font color="#000080">,
               </font><font color="#800000">'This menu unit has been written by'</font><font color="#000080">);

   </font>WriteStrXy <font color="#000080">(</font><font color="#800000">50</font><font color="#000080">, </font><font color="#800000">14</font><font color="#000080">, </font>TextColor<font color="#000080">, </font>BackColor<font color="#000080">, </font><font color="#800000">'AVONTURE Christophe'</font><font color="#000080">);

   </font>Cadre <font color="#000080">(</font><font color="#800000">02</font><font color="#000080">, </font><font color="#800000">07</font><font color="#000080">, </font><font color="#800000">38</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font>TextColor<font color="#000080">, </font>BackColor<font color="#000080">, </font>Double<font color="#000080">);

   </font>WriteStrXy <font color="#000080">(</font><font color="#800000">00</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font>TextColor<font color="#000080">, </font>BackColor<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">);

   </font><font color="#008000"><i>{ Set the menu option.  The first index is the option and the second, the
     help line
   }

   </i></font>TMenu <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'This is the first option'</font><font color="#000080">;
   </font>TMenu <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">'This option can be used in order to ...    :=) '</font><font color="#000080">;
   </font>TMenu <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'Send a postcard'</font><font color="#000080">;
   </font>TMenu <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">'... for me?  This idea is very good!  I wait news from you...'</font><font color="#000080">;
   </font>TMenu <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'This unit is great, isn''t it?'</font><font color="#000080">;
   </font>TMenu <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">'Happy to see that you can find this unit usefull...'</font><font color="#000080">;
   </font>TMenu <font color="#000080">[</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'Nice to meet you'</font><font color="#000080">;
   </font>TMenu <font color="#000080">[</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">'Hello, How are you?'</font><font color="#000080">;
   </font>TMenu <font color="#000080">[</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'Terminate this example'</font><font color="#000080">;
   </font>TMenu <font color="#000080">[</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">'You can also use the Escape key'</font><font color="#000080">;

   </font><font color="#008000"><i>{ Put the options on the screen: Column, line, option, help.
   }

   </i></font>Prompt <font color="#000080">(</font><font color="#800000">04</font><font color="#000080">, </font><font color="#800000">09</font><font color="#000080">, </font>TMenu <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">], </font>TMenu <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]);
   </font>Prompt <font color="#000080">(</font><font color="#800000">04</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font>TMenu <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">], </font>TMenu <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]);
   </font>Prompt <font color="#000080">(</font><font color="#800000">04</font><font color="#000080">, </font><font color="#800000">11</font><font color="#000080">, </font>TMenu <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">], </font>TMenu <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]);
   </font>Prompt <font color="#000080">(</font><font color="#800000">04</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font>TMenu <font color="#000080">[</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">], </font>TMenu <font color="#000080">[</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]);
   </font>Prompt <font color="#000080">(</font><font color="#800000">04</font><font color="#000080">, </font><font color="#800000">13</font><font color="#000080">, </font>TMenu <font color="#000080">[</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">], </font>TMenu <font color="#000080">[</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]);

   </font><font color="#008000"><i>{ Show a little string animation...
   }

   </i></font>Scroll <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">01</font><font color="#000080">, </font><font color="#800000">79</font><font color="#000080">, </font><font color="#800000">'WOW!!!   What a cool vertical menu unit...'</font><font color="#000080">+
           </font><font color="#800000">'                                                      '</font><font color="#000080">);

   </font><font color="#FF0000"><b>Repeat Until </b></font>KeyPressed<font color="#000080">; </font>ReadKey<font color="#000080">;

   </font><font color="#008000"><i>{ Clear the last line of the screen
   }

   </i></font>GotoXy <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">);
   </font>ClrEol<font color="#000080">;

   </font><font color="#008000"><i>{ Process the menu option selection
   }

   </i></font><font color="#FF0000"><b>Repeat

        </b></font><font color="#008000"><i>{ Call the menu handler with three argument :
            the first  is the start column of the first option
            the second is the start line of the first option
            the last   is the number of option in our menu
        }

        </i></font>Choix <font color="#000080">:= </font>MChoix <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);

        </font><font color="#008000"><i>{ Once the user has been pressed on a function key (F1 to F10), the
          escape key or the enter key, then the MChoix function will return
          a numeric value:

              59 to 68 if a function key has been pressed (59 = F1, ...)
              255 if the Escape key has been pressed
              a number from 1 to the option number; so if the user has
                 pressed the enter key on the third option, the return value
                 will be equal to 3.
        }

        </i></font>Str <font color="#000080">(</font>Choix<font color="#000080">, </font>Lig<font color="#000080">);
        </font>Lig <font color="#000080">:= </font><font color="#800000">'The selected option is : '</font><font color="#000080">+ </font>Lig<font color="#000080">;
        </font>WriteStrXy <font color="#000080">(</font><font color="#800000">43</font><font color="#000080">, </font><font color="#800000">17</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">01</font><font color="#000080">, </font>Lig<font color="#000080">);

        </font><font color="#008000"><i>{ I continue until the escape key is pressed or the 'Quit' option has
          been selected (this is the 5 option)
        }

   </i></font><font color="#FF0000"><b>Until </b></font><font color="#000080">((</font>Choix <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Choix <font color="#000080">= </font><font color="#800000">255</font><font color="#000080">));

   </font>ClrScr<font color="#000080">;


</font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p></body>
</html>
