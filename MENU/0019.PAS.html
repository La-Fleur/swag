<html>
<head><title> "Simple" by LAAT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Program </b></font>MyMenu<font color="#000080">;

</font><font color="#008000"><i>(*     Copyright(c) : 1997 JERMiC Sw
 *         Coded by : Laat (Laat@4u.net)
 *
 *        Hi, All!
 *
 *    Some time ago in my mind grew up one idea which found its
 *  implementation in following peace of code. The main idea is
 *  simple as 2by2is4 - processing menu.
 *    After looking at this source you maight find yourself
 *  wondering - what's up with this Laat, why's he doing all the
 *  things so complicated? Well, my answer is - you can
 *  cut/change/combinate this prog till you feel good and
 *  statisfied. Anyway, i made this version of program for
 *  myself, not even for use, just for seeing how these things
 *  look like meanwhile writing program.
 *    So, it is slightly possible that i will post some new (well,
 *  that depends on how to look at this topic) source with simplified
 *  version of menu rocessing.
 *
 *              As Yours as you want me to be,
 *                                        Laat
 *
 *                                              15/11/97
 *)
</i></font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>tItem <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>x<font color="#000080">, </font>y                <font color="#000080">: </font>Word<font color="#000080">;
    </font>HotKey              <font color="#000080">: </font>Char<font color="#000080">;
    </font>Data                <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>(* The same as UpCase applied to string-type *)
</i></font><font color="#FF0000"><b>Function </b></font>UpCaseS <font color="#000080">( </font>S <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var   </b></font>i            <font color="#000080">: </font>Integer<font color="#000080">;
      </font>Swaps        <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Swaps<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>S<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then
    For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Swaps<font color="#000080">:=</font>Swaps<font color="#000080">+</font>UpCase<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">]);
  </font>UpCaseS<font color="#000080">:=</font>Swaps<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CursorOff<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#008000"><i>(* Hides cursor *)
</i></font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">mov AH,$01
  mov CH,$20
  mov CL,$0
  int $10
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CursorOn<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#008000"><i>(* Shows cursor *)
</i></font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">mov AH,$01
  mov CH,$3
  mov CL,$4
  int $10
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>(*   Procedure used to make this program shorter (tired of writing TextColor
 * and TextBackGround together all the time).
 *)
</i></font><font color="#FF0000"><b>Procedure </b></font>Col <font color="#000080">( </font>_Fc<font color="#000080">, </font>_Bc<font color="#000080">: </font>Byte <font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>TextColor<font color="#000080">(</font>_Fc<font color="#000080">); </font>TextBackGround<font color="#000080">(</font>_Bc<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>(*   Function which executes given menu.
 *   Requires:
 *     _Arr       - Array of TItem type (see Type section);
 *     _Fg, _Bg   - Text and background colors of unselected items;
 *     _Fg1, _Bg1 - Text and background colors of selected items;
 *     Pos        - Start position of cursor in the menu by default;
 *     _N         - How much items there are in you menu.
 *   Returns:
 *     Number of chosen menu or value '0' if Esc has been pressed.
 *
 *)
</i></font><font color="#FF0000"><b>Function </b></font>ExecuteMenu <font color="#000080">( </font>_Arr<font color="#000080">: </font><font color="#FF0000"><b>Array of </b></font>tItem<font color="#000080">; </font>_Fg<font color="#000080">, </font>_Bg<font color="#000080">, </font>_Fg1<font color="#000080">, </font>_Bg1<font color="#000080">: </font>Byte<font color="#000080">; </font>_Pos<font color="#000080">: </font>Byte<font color="#000080">; </font>_N<font color="#000080">: </font>Byte <font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
</b></font><font color="#008000"><i>(*  _N,*) </i></font>_J<font color="#000080">, </font>_J1                       <font color="#000080">: </font>Integer<font color="#000080">;
  </font>_TheEnd<font color="#000080">, </font>_Ext<font color="#000080">, </font>_Esc<font color="#000080">, </font>_Found           <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>_Ch                                   <font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Draw<font color="#000080">; </font><font color="#008000"><i>(* Draws Menu _Arr *)
</i></font><font color="#FF0000"><b>Var
  </b></font>_i                                    <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  For </b></font>_i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>_N<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do Begin
    If </b></font>_Arr<font color="#000080">[</font>_I<font color="#000080">].</font>Y<font color="#000080">+</font>_i<font color="#000080">&gt;</font><font color="#800000">50</font><font color="#000080">-</font>_Arr<font color="#000080">[</font>_I<font color="#000080">].</font>Y <font color="#FF0000"><b>then </b></font>Break<font color="#000080">;
    </font>GotoXY<font color="#000080">(</font>_Arr<font color="#000080">[</font>_I<font color="#000080">].</font>X<font color="#000080">, </font>_Arr<font color="#000080">[</font>_I<font color="#000080">].</font>Y<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>_i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">&lt;&gt;</font>_Pos <font color="#FF0000"><b>then Begin
      </b></font>Col<font color="#000080">(</font>_Fg<font color="#000080">, </font>_Bg<font color="#000080">); </font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">+</font>_Arr<font color="#000080">[</font>_i<font color="#000080">].</font>Data<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">); </font>Col<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font>_Bg<font color="#000080">);
    </font><font color="#FF0000"><b>End Else Begin
      </b></font>Col<font color="#000080">(</font>_Fg1<font color="#000080">, </font>_Bg1<font color="#000080">); </font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">+</font>_Arr<font color="#000080">[</font>_i<font color="#000080">].</font>Data<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">); </font>Col<font color="#000080">( </font><font color="#800000">4</font><font color="#000080">, </font>_Bg1<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>GotoXY<font color="#000080">(</font>_Arr<font color="#000080">[</font>_i<font color="#000080">].</font>x<font color="#000080">+</font>Pos<font color="#000080">(</font>UpCase<font color="#000080">(</font>_Arr<font color="#000080">[</font>_i<font color="#000080">].</font>HotKey<font color="#000080">), </font>UpCaseS<font color="#000080">(</font>_Arr<font color="#000080">[</font>_i<font color="#000080">].</font>Data<font color="#000080">)),</font>_Arr<font color="#000080">[</font>_i<font color="#000080">].</font>y<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font>UpCase<font color="#000080">(</font>_Arr<font color="#000080">[</font>_i<font color="#000080">].</font>HotKey<font color="#000080">), </font>UpCaseS<font color="#000080">(</font>_Arr<font color="#000080">[</font>_i<font color="#000080">].</font>Data<font color="#000080">))&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Write<font color="#000080">(</font>_Arr<font color="#000080">[</font>_i<font color="#000080">].</font>Data<font color="#000080">[</font>Pos<font color="#000080">(</font>UpCase<font color="#000080">(</font>_Arr<font color="#000080">[</font>_i<font color="#000080">].</font>HotKey<font color="#000080">),</font>UpCaseS<font color="#000080">(</font>_Arr<font color="#000080">[</font>_i<font color="#000080">].</font>Data<font color="#000080">))]);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font><font color="#008000"><i>(*  _N:=SizeOf(_Arr) div 255; - this was useful till we got menu items
 *                              defined in Const section (such arrays
 *                              have fixed size, as you already know of
 *                              course).
 *)
  </i></font>_Esc<font color="#000080">:=</font>False<font color="#000080">; </font>_TheEnd<font color="#000080">:=</font>False<font color="#000080">; </font>_Found<font color="#000080">:=</font>False<font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>Draw<font color="#000080">; </font>_Ch<font color="#000080">:=</font>UpCase<font color="#000080">(</font>ReadKey<font color="#000080">);
    </font><font color="#FF0000"><b>Case </b></font>_Ch <font color="#FF0000"><b>of
      </b></font><font color="#800000">#000    </font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>(* Extended keystroke is got *)
                  </i></font>_Ext<font color="#000080">:=</font>True<font color="#000080">; </font>_Ch<font color="#000080">:=</font>ReadKey<font color="#000080">;
                  </font><font color="#FF0000"><b>Case </b></font>_Ch <font color="#FF0000"><b>of
     </b></font><font color="#008000"><i>(* UpArr *)    </i></font><font color="#800000">#72</font><font color="#000080">, </font><font color="#800000">#75  </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>_Pos<font color="#000080">&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Dec<font color="#000080">(</font>_Pos<font color="#000080">) </font><font color="#FF0000"><b>Else </b></font>_Pos<font color="#000080">:=</font>_N<font color="#000080">;
     </font><font color="#008000"><i>(* DnArr *)    </i></font><font color="#800000">#80</font><font color="#000080">, </font><font color="#800000">#77  </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>_Pos<font color="#000080">&lt;</font>_N <font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>_Pos<font color="#000080">) </font><font color="#FF0000"><b>Else </b></font>_Pos<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#008000"><i>(*   End *)    </i></font><font color="#800000">#79       </font><font color="#000080">: </font>_Pos<font color="#000080">:=</font>_N<font color="#000080">;
     </font><font color="#008000"><i>(*  Home *)    </i></font><font color="#800000">#71       </font><font color="#000080">: </font>_Pos<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(*Esc*)</i></font><font color="#800000">#027   </font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>_TheEnd<font color="#000080">:=</font>True<font color="#000080">; </font>_Esc<font color="#000080">:=</font>True<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(*Ent*)</i></font><font color="#800000">#013   </font><font color="#000080">: </font>_TheEnd<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#008000"><i>(*Other*)  </i></font><font color="#FF0000"><b>Else Begin
                  </b></font>_J<font color="#000080">:=</font>_Pos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font>_J1<font color="#000080">:=</font>_J<font color="#000080">; </font>Inc<font color="#000080">(</font>_J<font color="#000080">);
                  </font><font color="#FF0000"><b>Repeat
                   If </b></font>_J<font color="#000080">&gt;=</font>_N <font color="#FF0000"><b>then </b></font>_J<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                   </font><font color="#FF0000"><b>If </b></font>_J<font color="#000080">=</font>_J1 <font color="#FF0000"><b>then </b></font>Break<font color="#000080">;
                   </font><font color="#FF0000"><b>If </b></font>UpCase<font color="#000080">(</font>_Arr<font color="#000080">[</font>_J<font color="#000080">].</font>HotKey<font color="#000080">)=</font>_Ch <font color="#FF0000"><b>then Begin </b></font>_Pos<font color="#000080">:=</font>_J<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">; </font>Break<font color="#000080">; </font><font color="#FF0000"><b>End
                                                  else </b></font>Inc<font color="#000080">(</font>_J<font color="#000080">);
                   </font><font color="#FF0000"><b>Until </b></font>_Found<font color="#000080">;

        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End
  Until </b></font>_TheEnd<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>_Esc <font color="#FF0000"><b>then </b></font>ExecuteMenu<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>Else </b></font>ExecuteMenu<font color="#000080">:=</font>_Pos<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font><font color="#008000"><i>(*   Menu to execute
   *   Thought it is hard to define in const, you could use your
   * brain and write your own procedure which adds given menu item
   * to a given array, for example, header of such a procedure maight
   * look like :
   *    Procedure AddItem ( var ArrayToAddIn: Array of TItem;
   *                        ItemToAdd: TItem;
   *                        ToWhichPosition: Byte );
   *)
  </i></font>Arr <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">]</font><font color="#FF0000"><b>of </b></font>tItem<font color="#000080">=((</font>X<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">; </font>Y<font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>HotKey<font color="#000080">:</font><font color="#800000">'F'</font><font color="#000080">; </font>Data<font color="#000080">:</font><font color="#800000">'First  '</font><font color="#000080">),
                              (</font>X<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">; </font>Y<font color="#000080">: </font><font color="#800000">6</font><font color="#000080">; </font>HotKey<font color="#000080">:</font><font color="#800000">'S'</font><font color="#000080">; </font>Data<font color="#000080">:</font><font color="#800000">'Second '</font><font color="#000080">),
                              (</font>X<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">; </font>Y<font color="#000080">: </font><font color="#800000">7</font><font color="#000080">; </font>HotKey<font color="#000080">:</font><font color="#800000">'T'</font><font color="#000080">; </font>Data<font color="#000080">:</font><font color="#800000">'Third  '</font><font color="#000080">),
                              (</font>X<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">; </font>Y<font color="#000080">: </font><font color="#800000">8</font><font color="#000080">; </font>HotKey<font color="#000080">:</font><font color="#800000">'F'</font><font color="#000080">; </font>Data<font color="#000080">:</font><font color="#800000">'Fourth '</font><font color="#000080">),
                              (</font>X<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">; </font>Y<font color="#000080">: </font><font color="#800000">9</font><font color="#000080">; </font>HotKey<font color="#000080">:</font><font color="#800000">'I'</font><font color="#000080">; </font>Data<font color="#000080">:</font><font color="#800000">'Fifth  '</font><font color="#000080">),
                              (</font>X<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">; </font>Y<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">; </font>HotKey<font color="#000080">:</font><font color="#800000">'S'</font><font color="#000080">; </font>Data<font color="#000080">:</font><font color="#800000">'Sixth  '</font><font color="#000080">),
                              (</font>X<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">; </font>Y<font color="#000080">:</font><font color="#800000">11</font><font color="#000080">; </font>HotKey<font color="#000080">:</font><font color="#800000">'H'</font><font color="#000080">; </font>Data<font color="#000080">:</font><font color="#800000">'Seventh'</font><font color="#000080">),
                              (</font>X<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">; </font>Y<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">; </font>HotKey<font color="#000080">:</font><font color="#800000">'E'</font><font color="#000080">; </font>Data<font color="#000080">:</font><font color="#800000">'Eighth '</font><font color="#000080">),
                              (</font>X<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">; </font>Y<font color="#000080">:</font><font color="#800000">13</font><font color="#000080">; </font>HotKey<font color="#000080">:</font><font color="#800000">'N'</font><font color="#000080">; </font>Data<font color="#000080">:</font><font color="#800000">'Ninth  '</font><font color="#000080">),
                              (</font>X<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">; </font>Y<font color="#000080">:</font><font color="#800000">14</font><font color="#000080">; </font>HotKey<font color="#000080">:</font><font color="#800000">'T'</font><font color="#000080">; </font>Data<font color="#000080">:</font><font color="#800000">'Tenth  '</font><font color="#000080">));
</font><font color="#FF0000"><b>Var
  </b></font>n                             <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Col<font color="#000080">(</font><font color="#800000">07</font><font color="#000080">, </font><font color="#800000">00</font><font color="#000080">); </font>ClrScr<font color="#000080">; </font>CursorOff<font color="#000080">;
  </font>GotoXY<font color="#000080">(</font><font color="#800000">01</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">); </font>WriteLn<font color="#000080">(</font><font color="#800000">#24','#25','#27','#26',Home,End,Esc'</font><font color="#000080">);

  </font>n<font color="#000080">:=</font>ExecuteMenu<font color="#000080">(</font>Arr <font color="#000080">,</font><font color="#800000">00</font><font color="#000080">, </font><font color="#800000">07</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">01</font><font color="#000080">, </font><font color="#800000">02</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">);

  </font>Col<font color="#000080">(</font><font color="#800000">07</font><font color="#000080">, </font><font color="#800000">00</font><font color="#000080">); </font>ClrScr<font color="#000080">; </font>CursorOn<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>n<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Your choice was: '</font><font color="#000080">, </font>Arr<font color="#000080">[</font>n<font color="#000080">].</font>Data<font color="#000080">)
          </font><font color="#FF0000"><b>else </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Where is your choice?'</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p></body>
</html>
