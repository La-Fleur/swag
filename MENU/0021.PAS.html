<html>
<head><title> "Automatic Menu Unit" by ANDAL PROGRAMMING</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ features include }
{ automatic string resizing }
{ hack proof, just leave the menucnst.pas available for general use}
{ easy to change colors }
{ automatic centring }
{ easy to use hot keys }
{ function to return value }
{ first declared is = 0, second is = 1, etc, etc }

{ if you use this program we take no responsiblity for anything that may
  happen to your computer }

{ THE ANDAL PROGRAMMING CORPORATION }

{ any bugs or ideas or help with dos or menus etc, please contact
  us at FERRET_@HOTMAIL.COM}


</i></font><font color="#FF0000"><b>uses
</b></font>crt<font color="#000080">,</font>menubox<font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>a<font color="#000080">:</font>byte<font color="#000080">;
   </font>x<font color="#000080">:</font>menu<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>x<font color="#000080">.</font>setup<font color="#000080">;
     </font>x<font color="#000080">.</font>additem<font color="#000080">(</font><font color="#800000">' m~e~nu item 1'</font><font color="#000080">); </font><font color="#008000"><i>{example of a hotkey }
     </i></font>x<font color="#000080">.</font>additem<font color="#000080">(</font><font color="#800000">' menu item 2'</font><font color="#000080">);   </font><font color="#008000"><i>{without a hotkey }
     </i></font>x<font color="#000080">.</font>additem<font color="#000080">(</font><font color="#800000">' ~m~enu item 3'</font><font color="#000080">); </font><font color="#008000"><i>{with one again}
     </i></font>x<font color="#000080">.</font>additem<font color="#000080">(</font><font color="#800000">' menu item 4'</font><font color="#000080">);
     </font>a <font color="#000080">:= </font>x<font color="#000080">.</font>run<font color="#000080">(</font><font color="#800000">' this is a little demo '</font><font color="#000080">,</font>true<font color="#000080">);
     </font>x<font color="#000080">.</font>shutdown<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ----------------   UNITS NEEDED HERE ------------ }

</i></font><font color="#FF0000"><b>UNIT </b></font>MenuBox<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>INTERFACE
USES </b></font>CRT<font color="#000080">,</font>Shorten<font color="#000080">,</font>MenuCnst<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                        { -- CONSTANT VALUES -- }

</i></font><font color="#FF0000"><b>CONST
     </b></font>Up     <font color="#000080">= </font>TRUE<font color="#000080">;                             </font><font color="#008000"><i>{Up arrow goes up -);        }
     </i></font>Down   <font color="#000080">= </font>FALSE<font color="#000080">;                            </font><font color="#008000"><i>{Down arrow does the opposite}

{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                         { -- THE MENU OBJECT -- }

</i></font><font color="#FF0000"><b>TYPE

  </b></font>Menu <font color="#000080">= </font><font color="#FF0000"><b>OBJECT                                 </b></font><font color="#008000"><i>{The Whole Kit + Kabodal     }
  </i></font>Items   <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">24</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font><font color="#000080">^</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;           </font><font color="#008000"><i>{Pointers to 25 strings      }
  </i></font>NoItems <font color="#000080">: </font>BYTE<font color="#000080">;                               </font><font color="#008000"><i>{How many items do I have??  }
  </i></font>CurItem <font color="#000080">: </font>BYTE<font color="#000080">;                               </font><font color="#008000"><i>{Which Item am I up to??     }
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>Setup<font color="#000080">;                              </font><font color="#008000"><i>{Call this every time you run}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>AddItem<font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);              </font><font color="#008000"><i>{Call to add an item new line}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>ShutDown<font color="#000080">;                           </font><font color="#008000"><i>{Dynamic shutdown            }
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>Run<font color="#000080">(</font>TitleStr  <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;              </font><font color="#008000"><i>{Run!!! - returns value = to }
               </i></font>DrawTitle <font color="#000080">: </font>BOOLEAN<font color="#000080">) : </font>BYTE<font color="#000080">;     </font><font color="#008000"><i>{the item number 0 = the 1st }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                       { -- PUBLIC PROCEDURES -- }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>MenuExit<font color="#000080">;

                        </font><font color="#008000"><i>{ -- PUBLIC VARIABLES -- }
</i></font><font color="#FF0000"><b>VAR
   </b></font>M <font color="#000080">: </font>Menu<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>IMPLEMENTATION

                         </b></font><font color="#008000"><i>{ -- PRIVATE CALLS -- }

{PROCEDURE MWriteXY(Index : BYTE);}
{PROCEDURE Main(Dir : BOOLEAN);}
{PROCEDURE ElseAnalyse;}

                       { -- PRIVATE VARIABLES -- }

</i></font><font color="#FF0000"><b>VAR
   </b></font>ExitPtr <font color="#000080">: </font>POINTER<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Menu<font color="#000080">.</font>Setup<font color="#000080">;                           </font><font color="#008000"><i>{Do the standard object VAR  }
</i></font><font color="#FF0000"><b>BEGIN                                           </b></font><font color="#008000"><i>{setup sequence, set to 0    }
     </i></font>NoItems <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>CurItem <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Menu<font color="#000080">.</font>AddItem<font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);           </font><font color="#008000"><i>{Get's a bit tricky here...  }
</i></font><font color="#FF0000"><b>BEGIN
     </b></font>GETMEM<font color="#000080">(</font>Items<font color="#000080">[</font>NoItems<font color="#000080">],</font>SIZEOF<font color="#000080">(</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">));     </font><font color="#008000"><i>{allocate memory for a string}
     </i></font>Items<font color="#000080">[</font>NoItems<font color="#000080">]^ := </font>Str<font color="#000080">;                    </font><font color="#008000"><i>{give it the value of param  }
     </i></font>INC<font color="#000080">(</font>NoItems<font color="#000080">);                              </font><font color="#008000"><i>{you now have another item!  }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Menu<font color="#000080">.</font>ShutDown<font color="#000080">;                        </font><font color="#008000"><i>{  &gt;&gt;&gt; MUST BE CALLED &lt;&lt;&lt;    }
</i></font><font color="#FF0000"><b>VAR
   </b></font>DelNo <font color="#000080">: </font>BYTE<font color="#000080">;                                </font><font color="#008000"><i>{Counter variable            }
</i></font><font color="#FF0000"><b>BEGIN
     IF </b></font>NoItems <font color="#000080">&gt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
       FOR </b></font>DelNo <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>NoItems<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO           </b></font><font color="#008000"><i>{Start at start + do all items}
         </i></font>FreeMem<font color="#000080">(</font>Items<font color="#000080">[</font>DelNo<font color="#000080">],</font>SIZEOF<font color="#000080">(</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">));  </font><font color="#008000"><i>{deallocate all mem          }
     </i></font>NoItems <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                              </font><font color="#008000"><i>{reset stand. vars for next  }
     </i></font>CurItem <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                              </font><font color="#008000"><i>{time                        }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ResizeString<font color="#000080">(</font><font color="#FF0000"><b>VAR   </b></font>Str  <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;     </font><font color="#008000"><i>{ &gt;&gt;&gt;&gt;     PRIVATE     &lt;&lt;&lt;&lt;  }
                       </i></font><font color="#FF0000"><b>CONST </b></font>Maxl <font color="#000080">: </font>BYTE<font color="#000080">);      </font><font color="#008000"><i>{Cannot be called out of unit}
</i></font><font color="#FF0000"><b>VAR                                             </b></font><font color="#008000"><i>{Procedure to do Auto resize }
   </i></font>StrL <font color="#000080">: </font>BYTE<font color="#000080">;                                 </font><font color="#008000"><i>{on any strings              }
   </i></font>D1   <font color="#000080">: </font>BYTE<font color="#000080">;                                 </font><font color="#008000"><i>{   It will append ' ' to end}
   </i></font>C    <font color="#000080">: </font>BYTE<font color="#000080">;                                 </font><font color="#008000"><i>{ + start of the string till }
</i></font><font color="#FF0000"><b>BEGIN                                           </b></font><font color="#008000"><i>{it reaches the right length }
     </i></font>StrL <font color="#000080">:= </font>LENGTH<font color="#000080">(</font>Str<font color="#000080">);                       </font><font color="#008000"><i>{ Save String length         }
     </i></font><font color="#FF0000"><b>IF </b></font>POS<font color="#000080">(</font><font color="#800000">'~'</font><font color="#000080">,</font>Str<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN                  </b></font><font color="#008000"><i>{ Adjust for '~' chars       }
       </i></font>DEC<font color="#000080">(</font>StrL<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
     </font>StrL <font color="#000080">:= </font>MaxL <font color="#000080">- </font>StrL<font color="#000080">;                       </font><font color="#008000"><i>{find how many chars out it  }
     </i></font>D1   <font color="#000080">:= </font>StrL <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;                        </font><font color="#008000"><i>{is. Half that number        }
     </i></font>StrL <font color="#000080">:= </font>StrL <font color="#000080">- </font>D1<font color="#000080">;                         </font><font color="#008000"><i>{put half in D1, other in    }
     </i></font><font color="#FF0000"><b>FOR </b></font>C <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>D1 <font color="#FF0000"><b>DO                        </b></font><font color="#008000"><i>{StrL. Then append ' '''s    }
       </i></font>Str <font color="#000080">:= </font><font color="#800000">' ' </font><font color="#000080">+ </font>Str<font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>C <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>StrL <font color="#FF0000"><b>DO
       </b></font>Str <font color="#000080">:= </font>Str <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Menu<font color="#000080">.</font>Run<font color="#000080">(</font>TitleStr  <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;           </font><font color="#008000"><i>{ THIS IS IT BOYS + GIRLS    }
                  </i></font>DrawTitle <font color="#000080">: </font>BOOLEAN<font color="#000080">) : </font>BYTE<font color="#000080">;  </font><font color="#008000"><i>{Title + whether to write it }
</i></font><font color="#FF0000"><b>VAR
   </b></font>X1    <font color="#000080">: </font>BYTE<font color="#000080">;                                </font><font color="#008000"><i>{frame co - ordinates        }
   </i></font>Y1    <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>X2    <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>Y2    <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>Ch    <font color="#000080">: </font>CHAR<font color="#000080">;                                </font><font color="#008000"><i>{letter to be read in        }
   </i></font>Stop  <font color="#000080">: </font>BOOLEAN<font color="#000080">;                             </font><font color="#008000"><i>{stop check variable         }
   </i></font>Count <font color="#000080">: </font>BYTE<font color="#000080">;                                </font><font color="#008000"><i>{multipurpose counting VAR   }

{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                         { -- PRIVATE CALL -- }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>MWriteXY<font color="#000080">(</font>Index <font color="#000080">: </font>BYTE<font color="#000080">);               </font><font color="#008000"><i>{Menu Write at (X,Y)         }
</i></font><font color="#FF0000"><b>VAR                                             </b></font><font color="#008000"><i>{index is the string number  }
   </i></font>I <font color="#000080">: </font>BYTE<font color="#000080">;                                    </font><font color="#008000"><i>{to write. I is a counter    }
   </i></font>H <font color="#000080">: </font>BOOLEAN<font color="#000080">;                                 </font><font color="#008000"><i>{H is do hotkey colors??     }
</i></font><font color="#FF0000"><b>BEGIN
     </b></font>GOTOXY<font color="#000080">(</font>X1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">+</font>Index<font color="#000080">);                   </font><font color="#008000"><i>{Move into position          }
     </i></font>H <font color="#000080">:= </font>FALSE<font color="#000080">;                                </font><font color="#008000"><i>{hotkey starts 'OFF'         }
     </i></font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH<font color="#000080">(</font>Items<font color="#000080">[</font>Index<font color="#000080">]^) </font><font color="#FF0000"><b>DO     </b></font><font color="#008000"><i>{Check each letter           }
       </i></font><font color="#FF0000"><b>BEGIN
         IF </b></font>Items<font color="#000080">[</font>Index<font color="#000080">]^[</font>I<font color="#000080">] &lt;&gt; </font><font color="#800000">'~' </font><font color="#FF0000"><b>THEN        </b></font><font color="#008000"><i>{if it's a after a '~' then  }
           </i></font><font color="#FF0000"><b>BEGIN                                </b></font><font color="#008000"><i>{write in Hot Key Colors     }
             </i></font><font color="#FF0000"><b>IF </b></font>H <font color="#FF0000"><b>THEN
               BEGIN
                 </b></font>TC<font color="#000080">(</font>HKCol<font color="#000080">);
                 </font>WRITE<font color="#000080">(</font>Items<font color="#000080">[</font>Index<font color="#000080">]^[</font>I<font color="#000080">]);
               </font><font color="#FF0000"><b>END
             ELSE                               </b></font><font color="#008000"><i>{... else do it standard cols}
               </i></font><font color="#FF0000"><b>BEGIN
                 </b></font>TC<font color="#000080">(</font>TCol<font color="#000080">);
                 </font>WRITE<font color="#000080">(</font>Items<font color="#000080">[</font>Index<font color="#000080">]^[</font>I<font color="#000080">]);
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>END
         ELSE                                   </b></font><font color="#008000"><i>{code to switch from hot to  }
           </i></font><font color="#FF0000"><b>BEGIN                                </b></font><font color="#008000"><i>{non hot                     }
             </i></font><font color="#FF0000"><b>IF </b></font>H <font color="#FF0000"><b>THEN
               </b></font>H <font color="#000080">:= </font>FALSE
             <font color="#FF0000"><b>ELSE
               </b></font>H <font color="#000080">:= </font>TRUE
           <font color="#FF0000"><b>END</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                          { -- PRIVATE CALL -- }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Main<font color="#000080">(</font>Dir <font color="#000080">: </font>BOOLEAN<font color="#000080">);                  </font><font color="#008000"><i>{Movement of status bar proc }
</i></font><font color="#FF0000"><b>BEGIN                                           </b></font><font color="#008000"><i>{unhighlight last item       }
     </i></font>TBG<font color="#000080">(</font>BKCol<font color="#000080">);
     </font>MWriteXY<font color="#000080">(</font>CurItem<font color="#000080">);
     </font><font color="#FF0000"><b>IF </b></font>Dir <font color="#000080">= </font>Up <font color="#FF0000"><b>THEN                           </b></font><font color="#008000"><i>{if it's going up then ...   }
       </i></font><font color="#FF0000"><b>BEGIN
         IF </b></font>CurItem <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN                   </b></font><font color="#008000"><i>{... go up ...               }
           </i></font>DEC<font color="#000080">(</font>CurItem<font color="#000080">)
         </font><font color="#FF0000"><b>ELSE
           </b></font>CurItem <font color="#000080">:= </font>NoItems <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;              </font><font color="#008000"><i>{... unless its at top then  }
       </i></font><font color="#FF0000"><b>END                                      </b></font><font color="#008000"><i>{go back to the bottom       }
     </i></font><font color="#FF0000"><b>ELSE
       BEGIN                                    </b></font><font color="#008000"><i>{as for up - but down -);    }
         </i></font><font color="#FF0000"><b>IF </b></font>CurItem <font color="#000080">&lt;&gt; </font>NoItems <font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
           </b></font>INC<font color="#000080">(</font>CurItem<font color="#000080">)
         </font><font color="#FF0000"><b>ELSE
           </b></font>CurItem <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>TBG<font color="#000080">(</font>HCol<font color="#000080">);                                 </font><font color="#008000"><i>{Textcolor = Highlight color }
     </i></font>MWriteXY<font color="#000080">(</font>CurItem<font color="#000080">);                         </font><font color="#008000"><i>{Write proper item highlit   }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                         { -- PRIVATE CALL -- }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ElseAnalyse<font color="#000080">;                          </font><font color="#008000"><i>{analyse non arrow key stroke}
</i></font><font color="#FF0000"><b>VAR
   </b></font>I  <font color="#000080">: </font>BYTE<font color="#000080">;                                   </font><font color="#008000"><i>{multipurpose counting vars  }
   </i></font>I2 <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>L  <font color="#000080">: </font>CHAR<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Ch <font color="#000080">:= </font>UPCASE<font color="#000080">(</font>Ch<font color="#000080">);                          </font><font color="#008000"><i>{set it to upper case        }
     </i></font><font color="#FF0000"><b>IF </b></font>Ch <font color="#000080">= </font>Enter <font color="#FF0000"><b>THEN BEGIN </b></font>Run <font color="#000080">:= </font>CurItem<font color="#000080">; </font>Stop <font color="#000080">:= </font>TRUE<font color="#000080">; </font><font color="#FF0000"><b>END
     ELSE                                       </b></font><font color="#008000"><i>{enter conditions ...        }
       </i></font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>NoItems<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO               </b></font><font color="#008000"><i>{ ... otherwise get Uppercase}
         </i></font><font color="#FF0000"><b>BEGIN                                  </b></font><font color="#008000"><i>{of each hotkey + compare it }
           </i></font><font color="#FF0000"><b>FOR </b></font>I2 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH<font color="#000080">(</font>Items<font color="#000080">[</font>I<font color="#000080">]^) </font><font color="#FF0000"><b>DO  </b></font><font color="#008000"><i>{to that                     }
             </i></font><font color="#FF0000"><b>IF </b></font>Items<font color="#000080">[</font>I<font color="#000080">]^[</font>I2<font color="#000080">] = </font><font color="#800000">'~' </font><font color="#FF0000"><b>THEN
               BEGIN
                 </b></font>L <font color="#000080">:= </font>UPCASE<font color="#000080">(</font>Items<font color="#000080">[</font>I<font color="#000080">]^[</font>I2<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]);
                 </font>BREAK<font color="#000080">;                         </font><font color="#008000"><i>{NB//: Break = Quit loop     }
               </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>IF </b></font>Ch <font color="#000080">= </font>L <font color="#FF0000"><b>THEN BEGIN </b></font>Run <font color="#000080">:= </font>I<font color="#000080">; </font>Stop <font color="#000080">:= </font>TRUE<font color="#000080">; </font>EXIT<font color="#000080">; </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;                                   </font><font color="#008000"><i>{if it is stop run + set it  }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;                                            </font><font color="#008000"><i>{to string number            }

{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{BODY OF RUN PROCEDURE}
                        { - INITIALIZATION PART - }
     </i></font>CursorOff<font color="#000080">;
     </font>Stop    <font color="#000080">:= </font>FALSE<font color="#000080">;
                     </font><font color="#008000"><i>{ - RANGE CHECKING ON STRINGS - }
     </i></font><font color="#FF0000"><b>IF </b></font>NoItems <font color="#000080">&lt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN                       </b></font><font color="#008000"><i>{If no items have been added }
       </i></font><font color="#FF0000"><b>BEGIN                                    </b></font><font color="#008000"><i>{then tell the user that and }
         </i></font>TBG<font color="#000080">(</font>BKCol<font color="#000080">);                            </font><font color="#008000"><i>{then quit                   }
         </i></font>TC<font color="#000080">(</font>BKCol <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">);
         </font>WriteC<font color="#000080">(</font><font color="#800000">'Not enough Strings Initialized - Cannot Run Menu'</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
         </font>WriteC<font color="#000080">(</font><font color="#800000">'Press Any Key To Quit ...'</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
         </font>READKEY<font color="#000080">;
         </font>HALT<font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                         </font><font color="#008000"><i>{ - FRAME X DIMENSION - }
     </i></font>X1 <font color="#000080">:= </font>LENGTH<font color="#000080">(</font>TitleStr<font color="#000080">);                    </font><font color="#008000"><i>{Init max len var to title   }
     </i></font><font color="#FF0000"><b>FOR </b></font>Count <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>NoItems<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO             </b></font><font color="#008000"><i>{Do this for all items       }
       </i></font><font color="#FF0000"><b>BEGIN
         </b></font>X2 <font color="#000080">:= </font>LENGTH<font color="#000080">(</font>Items<font color="#000080">[</font>Count<font color="#000080">]^);           </font><font color="#008000"><i>{Init tmp len var to str len }
         </i></font><font color="#FF0000"><b>IF </b></font>POS<font color="#000080">(</font><font color="#800000">'~'</font><font color="#000080">,</font>Items<font color="#000080">[</font>Count<font color="#000080">]^) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN    </b></font><font color="#008000"><i>{if it has 2 '~' chars then  }
           </i></font>DEC<font color="#000080">(</font>X2<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);                           </font><font color="#008000"><i>{minus them                  }
         </i></font><font color="#FF0000"><b>IF </b></font>X2 <font color="#000080">&gt; </font>X1 <font color="#FF0000"><b>THEN                        </b></font><font color="#008000"><i>{if tmp var is &gt; max then    }
           </i></font>X1 <font color="#000080">:= </font>X2<font color="#000080">;                            </font><font color="#008000"><i>{reset max to show this.     }
       </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#008000"><i>{ - FRAME X DIMENSIONS (SUBBLOCK):- STRING RESIZING - }
     </i></font><font color="#FF0000"><b>FOR </b></font>Count <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>NoItems<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO
       </b></font>ResizeString<font color="#000080">(</font>Items<font color="#000080">[</font>Count<font color="#000080">]^,</font>X1<font color="#000080">);          </font><font color="#008000"><i>{Do string autoresize        }
                         { - FRAME X DIMENSIONS - }
     </i></font>INC<font color="#000080">(</font>X1<font color="#000080">);
     </font>Count <font color="#000080">:= </font>X1<font color="#000080">;                               </font><font color="#008000"><i>{move x1 so we can use it    }
     </i></font>X1 <font color="#000080">:= (</font><font color="#800000">80 </font><font color="#000080">- </font>Count<font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;                  </font><font color="#008000"><i>{define the edges of the     }
     </i></font>X2 <font color="#000080">:= </font>X1 <font color="#000080">+ </font>Count<font color="#000080">;                          </font><font color="#008000"><i>{menu to a const for speed   }
                         { - FRAME Y DIMENSIONS - }
     </i></font>Count <font color="#000080">:= </font>NoItems<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;                        </font><font color="#008000"><i>{box size = number of items+1}
     </i></font><font color="#FF0000"><b>IF </b></font>DrawTitle <font color="#FF0000"><b>THEN                          </b></font><font color="#008000"><i>{unless you want a title     }
       </i></font>INC<font color="#000080">(</font>Count<font color="#000080">,</font>TBlockSize<font color="#000080">);
     </font>Y1 <font color="#000080">:= (</font><font color="#800000">25 </font><font color="#000080">- </font>Count<font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;                  </font><font color="#008000"><i>{calc y co - ords            }
     </i></font>Y2 <font color="#000080">:= </font>Y1 <font color="#000080">+ </font>count<font color="#000080">;
                         </font><font color="#008000"><i>{ - BASIC SCREEN SETUP - }
     </i></font>FBG<font color="#000080">(</font>FBGS<font color="#000080">);                                 </font><font color="#008000"><i>{Fill Background to constant }
     </i></font>TBG<font color="#000080">(</font>BKCol<font color="#000080">);                                </font><font color="#008000"><i>{Set Text background color   }
     </i></font>TC<font color="#000080">(</font>BCol<font color="#000080">);                                  </font><font color="#008000"><i>{Set Text Color              }
     </i></font>Frame<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">,</font>BTyp<font color="#000080">,</font>TRUE<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);          </font><font color="#008000"><i>{Draw the frame              }
     </i></font><font color="#FF0000"><b>IF </b></font>DrawTitle <font color="#FF0000"><b>THEN                          </b></font><font color="#008000"><i>{draw the title block        }
       </i></font><font color="#FF0000"><b>BEGIN
         </b></font>GOTOXY<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">+</font>TBlockSize<font color="#000080">);
         </font><font color="#FF0000"><b>IF </b></font>BTyp <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN                       </b></font><font color="#008000"><i>{adjust chars for style 1    }
           </i></font><font color="#FF0000"><b>BEGIN
             </b></font>WRITE<font color="#000080">(</font><font color="#800000">'&Atilde;'</font><font color="#000080">);
             </font><font color="#FF0000"><b>REPEAT
               </b></font>WRITE<font color="#000080">(</font><font color="#800000">'&Auml;'</font><font color="#000080">);
             </font><font color="#FF0000"><b>UNTIL </b></font>WHEREX <font color="#000080">= </font>X2<font color="#000080">;
             </font>WRITE<font color="#000080">(</font><font color="#800000">'&acute;'</font><font color="#000080">);
           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>IF </b></font>BTyp <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>THEN                       </b></font><font color="#008000"><i>{adjust chars for style 2    }
           </i></font><font color="#FF0000"><b>BEGIN
             </b></font>WRITE<font color="#000080">(</font><font color="#800000">'&Igrave;'</font><font color="#000080">);
             </font><font color="#FF0000"><b>REPEAT
               </b></font>WRITE<font color="#000080">(</font><font color="#800000">'&Iacute;'</font><font color="#000080">);
             </font><font color="#FF0000"><b>UNTIL </b></font>WHEREX <font color="#000080">= </font>X2<font color="#000080">;
             </font>WRITE<font color="#000080">(</font><font color="#800000">'&sup1;'</font><font color="#000080">);
           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font>WriteC<font color="#000080">(</font>TitleStr<font color="#000080">,</font>Y1 <font color="#000080">+ (</font>TBlockSize <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">));
         </font>INC<font color="#000080">(</font>Y1<font color="#000080">,</font>TBlockSize<font color="#000080">);                    </font><font color="#008000"><i>{write in the title block +  }
       </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;                                     </font><font color="#008000"><i>{adjust Y1 for it            }
                           { MENU ITEM LAYOUT }

     </i></font><font color="#FF0000"><b>FOR </b></font>Count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>NoItems<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO             </b></font><font color="#008000"><i>{do the original write up    }
       </i></font>MWriteXY<font color="#000080">(</font>Count<font color="#000080">);                         </font><font color="#008000"><i>{unhighlit                   }
     </i></font>TBG<font color="#000080">(</font>HCol<font color="#000080">);
     </font>MWriteXY<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);                               </font><font color="#008000"><i>{highlighted                 }
     </i></font><font color="#FF0000"><b>REPEAT                                     </b></font><font color="#008000"><i>{Repeat chance to read in    }
       </i></font>Ch <font color="#000080">:= </font>READKEY<font color="#000080">;                           </font><font color="#008000"><i>{key strokes                 }
       </i></font><font color="#FF0000"><b>IF </b></font>Ch <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>THEN                          </b></font><font color="#008000"><i>{trap function keys          }
         </i></font><font color="#FF0000"><b>BEGIN
         </b></font>Ch <font color="#000080">:= </font>READKEY<font color="#000080">;
           </font><font color="#FF0000"><b>CASE </b></font>Ch <font color="#FF0000"><b>OF
             </b></font><font color="#800000">#91       </font><font color="#000080">: </font>HALT<font color="#000080">;                  </font><font color="#008000"><i>{SHIFT F8 IS THE AUTO QUIT   }
             </i></font>UpArrow   <font color="#000080">: </font>Main<font color="#000080">(</font>Up<font color="#000080">);              </font><font color="#008000"><i>{left arrow                  }
             </i></font>DownArrow <font color="#000080">: </font>Main<font color="#000080">(</font>Down<font color="#000080">);            </font><font color="#008000"><i>{right arrow                 }
           </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>END
       ELSE
         </b></font>ElseAnalyse<font color="#000080">;                           </font><font color="#008000"><i>{if not left or right analyse}
     </i></font><font color="#FF0000"><b>UNTIL </b></font>Stop<font color="#000080">;                                </font><font color="#008000"><i>{stop when condition is true }
     </i></font>CursorOn                                   <font color="#008000"><i>{turn the cursor on          }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                   { --=THINGS TO DO AFTER THE PROGRAM=-- }

{$F+}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>MenuExit<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>EXITPROC <font color="#000080">:= </font>ExitPtr<font color="#000080">;
     </font>M<font color="#000080">.</font>ShutDown<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{$F+}

{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

               { --=THINGS TO DO BEFORE RUNNING THE PROGRAM=-- }

</i></font><font color="#FF0000"><b>BEGIN
     </b></font>ExitPtr <font color="#000080">:= </font>EXITPROC<font color="#000080">;
     </font>EXITPROC <font color="#000080">:= @</font>MenuExit<font color="#000080">;
     </font>M<font color="#000080">.</font>SetUp<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
---------------------------- = [</font>Cut Here<font color="#000080">] = ---------------------------------

</font><font color="#FF0000"><b>UNIT </b></font>MenuCnst<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>INTERFACE

</b></font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>CONST
     </b></font>HKCol  <font color="#000080">=  </font><font color="#800000">10</font><font color="#000080">;                              </font><font color="#008000"><i>{Text Hot Key Color          }
     </i></font>TCol   <font color="#000080">=  </font><font color="#800000">15</font><font color="#000080">;                              </font><font color="#008000"><i>{Standard Text Color         }
     </i></font>BKCol  <font color="#000080">=  </font><font color="#800000">1</font><font color="#000080">;                               </font><font color="#008000"><i>{Standard Background Color   }
     </i></font>HCol   <font color="#000080">=  </font><font color="#800000">3</font><font color="#000080">;                               </font><font color="#008000"><i>{Highlight Background Color  }
     </i></font>BTyp   <font color="#000080">=  </font><font color="#800000">2</font><font color="#000080">;                               </font><font color="#008000"><i>{Boarder Type                }
     </i></font>BCol   <font color="#000080">=  </font><font color="#800000">15</font><font color="#000080">;                              </font><font color="#008000"><i>{Boarder Color               }
     </i></font>FBGS   <font color="#000080">=  </font><font color="#800000">6576</font><font color="#000080">;                            </font><font color="#008000"><i>{Fill Back Ground Style      }
     </i></font>TBlockSize <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;                            </font><font color="#008000"><i>{Title Block Size            }

{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>IMPLEMENTATION

</b></font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
---------------------------- = [</font>Cut Here<font color="#000080">] = ---------------------------------


</font><font color="#FF0000"><b>UNIT </b></font>shorten<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>INTERFACE
USES
    </b></font>crt<font color="#000080">,</font>graph<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}
</i></font><font color="#FF0000"><b>TYPE
     </b></font>Pallette <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>CONST
     </b></font>UpArrow    <font color="#000080">= </font><font color="#800000">#72</font><font color="#000080">;          </font><font color="#008000"><i>{special keyboard calls}
     </i></font>DownArrow  <font color="#000080">= </font><font color="#800000">#80</font><font color="#000080">;
     </font>LeftArrow  <font color="#000080">= </font><font color="#800000">#75</font><font color="#000080">;
     </font>RightArrow <font color="#000080">= </font><font color="#800000">#77</font><font color="#000080">;
     </font>ESC        <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">;
     </font>ALTX       <font color="#000080">= </font><font color="#800000">#45</font><font color="#000080">;
     </font>Enter      <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">;

     </font>DUpLeft    <font color="#000080">= </font><font color="#800000">#201</font><font color="#000080">;         </font><font color="#008000"><i>{double line box operators}
     </i></font>DUpRight   <font color="#000080">= </font><font color="#800000">#187</font><font color="#000080">;
     </font>DLowLeft   <font color="#000080">= </font><font color="#800000">#200</font><font color="#000080">;
     </font>DLowRight  <font color="#000080">= </font><font color="#800000">#188</font><font color="#000080">;
     </font>DStraight  <font color="#000080">= </font><font color="#800000">#205</font><font color="#000080">;
     </font>DDown      <font color="#000080">= </font><font color="#800000">#186</font><font color="#000080">;

     </font>SUpLeft    <font color="#000080">= </font><font color="#800000">#218</font><font color="#000080">;         </font><font color="#008000"><i>{single line box operators}
     </i></font>SUpRight   <font color="#000080">= </font><font color="#800000">#191</font><font color="#000080">;
     </font>SLowLeft   <font color="#000080">= </font><font color="#800000">#192</font><font color="#000080">;
     </font>SLowRight  <font color="#000080">= </font><font color="#800000">#217</font><font color="#000080">;
     </font>SStraight  <font color="#000080">= </font><font color="#800000">#196</font><font color="#000080">;
     </font>SDown      <font color="#000080">= </font><font color="#800000">#179</font><font color="#000080">;

     </font>Theta      <font color="#000080">= </font><font color="#800000">#233</font><font color="#000080">;         </font><font color="#008000"><i>{math operator symbols}
     </i></font>PIsym      <font color="#000080">= </font><font color="#800000">#227</font><font color="#000080">;
     </font>SumOf      <font color="#000080">= </font><font color="#800000">#228</font><font color="#000080">;
     </font>ExactEqual <font color="#000080">= </font><font color="#800000">#240</font><font color="#000080">;
     </font>ApproxEqual<font color="#000080">= </font><font color="#800000">#247</font><font color="#000080">;
     </font>GTOET      <font color="#000080">= </font><font color="#800000">#242</font><font color="#000080">;
     </font>LTOET      <font color="#000080">= </font><font color="#800000">#243</font><font color="#000080">;
     </font>ElementOf  <font color="#000080">= </font><font color="#800000">#238</font><font color="#000080">;
     </font>Intersection <font color="#000080">= </font><font color="#800000">#239</font><font color="#000080">;

     </font>Heart      <font color="#000080">= </font><font color="#800000">#3</font><font color="#000080">;           </font><font color="#008000"><i>{card symbol operators}
     </i></font>Spade      <font color="#000080">= </font><font color="#800000">#5</font><font color="#000080">;
     </font>Diamond    <font color="#000080">= </font><font color="#800000">#4</font><font color="#000080">;
     </font>Club       <font color="#000080">= </font><font color="#800000">#6</font><font color="#000080">;

     </font>HighBG     <font color="#000080">= </font>FALSE<font color="#000080">;
     </font>LowBG      <font color="#000080">= </font>TRUE<font color="#000080">;

     </font>MyBG        <font color="#000080">= </font><font color="#800000">20144</font><font color="#000080">;       </font><font color="#008000"><i>{fill back ground styles}
     </i></font>BlueGrayBG  <font color="#000080">= </font><font color="#800000">5040</font><font color="#000080">;
     </font>BlueWhiteBG <font color="#000080">= </font><font color="#800000">8112</font><font color="#000080">;
     </font>LBlueBlueBG <font color="#000080">= </font><font color="#800000">6576</font><font color="#000080">;

     </font>ScreenX    <font color="#000080">= </font><font color="#800000">640</font><font color="#000080">;          </font><font color="#008000"><i>{BGI screen size constants}
     </i></font>ScreenY    <font color="#000080">= </font><font color="#800000">480</font><font color="#000080">;
     </font>HalfX      <font color="#000080">= </font><font color="#800000">320</font><font color="#000080">;
     </font>HalfY      <font color="#000080">= </font><font color="#800000">240</font><font color="#000080">;

     </font>VGA        <font color="#000080">= </font><font color="#800000">$A000</font><font color="#000080">;        </font><font color="#008000"><i>{Screen memory position}
     </i></font>MCGA       <font color="#000080">= </font><font color="#800000">$A000</font><font color="#000080">;
     </font>DosScreen  <font color="#000080">= </font><font color="#800000">$B800</font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                      { -- BGI BASIC INTERFACE -- }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>GrInit<font color="#000080">;                            </font><font color="#008000"><i>{Initiate the BGI               }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>GrShutDown<font color="#000080">;                        </font><font color="#008000"><i>{Close down the BGI             }

{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                     { -- PALLETTE MANIPULATION -- }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Pal<font color="#000080">(</font>Col <font color="#000080">: </font>BYTE<font color="#000080">;
              </font>R   <font color="#000080">: </font>BYTE<font color="#000080">;
              </font>G   <font color="#000080">: </font>BYTE<font color="#000080">;
              </font>B   <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>GetPal<font color="#000080">(</font>Col <font color="#000080">: </font>BYTE<font color="#000080">;
             </font><font color="#FF0000"><b>VAR </b></font>R   <font color="#000080">: </font>BYTE<font color="#000080">;
             </font><font color="#FF0000"><b>VAR </b></font>G   <font color="#000080">: </font>BYTE<font color="#000080">;
             </font><font color="#FF0000"><b>VAR </b></font>B   <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>WaitRetrace<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SavePallette<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Pall <font color="#000080">: </font>Pallette<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>RestorePallette<font color="#000080">(</font>Pall <font color="#000080">: </font>Pallette<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>FadeToBlack<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>FadeUp<font color="#000080">(</font>Pall <font color="#000080">: </font>Pallette<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>BlackOut<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                        { -- CURSOR MANAGEMENT -- }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>CursorOn<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>CursorOff<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                  { -- MISCELL. FORMATTING ROUTINES -- }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>WriteXY<font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                  </font>X   <font color="#000080">: </font>BYTE<font color="#000080">;
                  </font>Y   <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteC<font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                 </font>Y   <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Frame<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">, </font>x2<font color="#000080">, </font>y2 <font color="#000080">: </font>byte<font color="#000080">; </font><font color="#008000"><i>{corner coords}
                  </i></font>typ <font color="#000080">: </font>byte<font color="#000080">;         </font><font color="#008000"><i>{type of frame}
                  </i></font>clr <font color="#000080">: </font>boolean<font color="#000080">;      </font><font color="#008000"><i>{clear inside?}
                  </i></font>clrch <font color="#000080">: </font>char<font color="#000080">);      </font><font color="#008000"><i>{clear with what}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>UpString<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Str <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION </b></font>GetCh<font color="#000080">(</font>X <font color="#000080">: </font>BYTE<font color="#000080">;
               </font>Y <font color="#000080">: </font>BYTE<font color="#000080">) : </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>TBG<font color="#000080">(</font>X <font color="#000080">: </font>BYTE<font color="#000080">);                   </font><font color="#008000"><i>{Change textbackground --&gt; abbr. }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>TC<font color="#000080">(</font>X <font color="#000080">: </font>BYTE<font color="#000080">);                    </font><font color="#008000"><i>{change textcolor --&gt; abbr.      }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>FBG<font color="#000080">(</font>Col <font color="#000080">: </font>WORD<font color="#000080">);                 </font><font color="#008000"><i>{fill background to a word       }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>FBG2<font color="#000080">(</font>Where <font color="#000080">: </font>WORD<font color="#000080">;               </font><font color="#008000"><i>{fill bg --&gt; to a vaddr or       }
               </i></font>Ascii <font color="#000080">: </font>BYTE<font color="#000080">;               </font><font color="#008000"><i>{to a specific ascii / color     }
               </i></font>Col   <font color="#000080">: </font>BYTE<font color="#000080">);              </font><font color="#008000"><i>{scheme                          }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetBG<font color="#000080">(</font>Back <font color="#000080">: </font>BOOLEAN<font color="#000080">);           </font><font color="#008000"><i>{turn on / off hi background cols}
{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                   { -- FILE MANAGEMENT ROUTINES -- }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>CheckForExtension<font color="#000080">(</font>FileStr <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>Exist<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">): </font>BOOLEAN<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                       { -- EXIT PROCEDURE -- }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>MyExit<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                       { -- GLOBAL VARIABLES -- }
</i></font><font color="#FF0000"><b>VAR
   </b></font>BackUpPalletteStorage <font color="#000080">: </font>Pallette<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>IMPLEMENTATION
                      </b></font><font color="#008000"><i>{ -- PRIVATE VARIABLES -- }
</i></font><font color="#FF0000"><b>VAR
   </b></font>ExitPtr <font color="#000080">: </font>POINTER<font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Frame<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">, </font>x2<font color="#000080">, </font>y2 <font color="#000080">: </font>byte<font color="#000080">; </font><font color="#008000"><i>{corner coords}
                  </i></font>typ <font color="#000080">: </font>byte<font color="#000080">;         </font><font color="#008000"><i>{type of frame}
                  </i></font>clr <font color="#000080">: </font>boolean<font color="#000080">;      </font><font color="#008000"><i>{clear inside?}
                  </i></font>clrch <font color="#000080">: </font>char<font color="#000080">);      </font><font color="#008000"><i>{clear with what}
  </i></font><font color="#FF0000"><b>TYPE </b></font>fchars <font color="#000080">= (</font>ulc<font color="#000080">, </font>top<font color="#000080">, </font>urc<font color="#000080">, </font>side<font color="#000080">, </font>lrc<font color="#000080">, </font>llc<font color="#000080">);
  </font><font color="#FF0000"><b>CONST </b></font>fc <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF ARRAY</b></font><font color="#000080">[</font>fchars<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR <font color="#000080">=
    (</font><font color="#800000">'      '</font><font color="#000080">, </font><font color="#800000">#218#196#191#179#217#192</font><font color="#000080">,
     </font><font color="#800000">#201#205#187#186#188#200</font><font color="#000080">);
  </font><font color="#FF0000"><b>VAR
    </b></font>ro<font color="#000080">,</font>co <font color="#000080">: </font>Byte<font color="#000080">;
    </font>S     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
  </font><font color="#FF0000"><b>BEGIN
    </b></font>FillChar<font color="#000080">(</font>S<font color="#000080">, </font>SizeOf<font color="#000080">(</font>S<font color="#000080">), </font>fc<font color="#000080">[</font>typ<font color="#000080">][</font>top<font color="#000080">]);
    </font>S<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>char<font color="#000080">(</font>pred<font color="#000080">(</font>x2<font color="#000080">-</font>x1<font color="#000080">));
    </font>GotoXY<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">);
    </font>Write<font color="#000080">(</font>fc<font color="#000080">[</font>typ<font color="#000080">][</font>ulc<font color="#000080">], </font>S<font color="#000080">, </font>fc<font color="#000080">[</font>typ<font color="#000080">][</font>urc<font color="#000080">]);
    </font>GotoXY<font color="#000080">(</font>x1<font color="#000080">, </font>y2<font color="#000080">);
    </font>Write<font color="#000080">(</font>fc<font color="#000080">[</font>typ<font color="#000080">][</font>llc<font color="#000080">], </font>S<font color="#000080">, </font>fc<font color="#000080">[</font>typ<font color="#000080">][</font>lrc<font color="#000080">]);
    </font>FillChar<font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>pred<font color="#000080">(</font>SizeOf<font color="#000080">(</font>S<font color="#000080">)), </font>clrch<font color="#000080">);
    </font><font color="#FF0000"><b>FOR </b></font>ro <font color="#000080">:= </font>succ<font color="#000080">(</font>y1<font color="#000080">) </font><font color="#FF0000"><b>TO </b></font>pred<font color="#000080">(</font>y2<font color="#000080">) </font><font color="#FF0000"><b>DO
      IF </b></font>clr <font color="#FF0000"><b>THEN
        BEGIN
          </b></font>GotoXY<font color="#000080">(</font>x1<font color="#000080">, </font>ro<font color="#000080">);
          </font>Write<font color="#000080">(</font>fc<font color="#000080">[</font>typ<font color="#000080">][</font>side<font color="#000080">], </font>S<font color="#000080">, </font>fc<font color="#000080">[</font>typ<font color="#000080">][</font>side<font color="#000080">])
        </font><font color="#FF0000"><b>END
      ELSE
        BEGIN
          </b></font>GotoXY<font color="#000080">(</font>x1<font color="#000080">, </font>ro<font color="#000080">); </font>Write<font color="#000080">(</font>fc<font color="#000080">[</font>typ<font color="#000080">][</font>side<font color="#000080">]);
          </font>GotoXY<font color="#000080">(</font>x2<font color="#000080">, </font>ro<font color="#000080">); </font>Write<font color="#000080">(</font>fc<font color="#000080">[</font>typ<font color="#000080">][</font>side<font color="#000080">]);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>FBG<font color="#000080">(</font>Col   <font color="#000080">: </font>WORD<font color="#000080">); </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">push    es                           </font><font color="#008000"><i>{Save ES segment on the stack        }
   </i></font><font color="#FF00FF">mov     ax,0B800h                    </font><font color="#008000"><i>{Put $0B800 in ax, start screen mem  }
   </i></font><font color="#FF00FF">mov     es,ax                        </font><font color="#008000"><i>{ES now points locat. in ax          }
   </i></font><font color="#FF00FF">mov     cx,2000                      </font><font color="#008000"><i>{CX := 2000                          }
   </i></font><font color="#FF00FF">xor     di,di                        </font><font color="#008000"><i>{Fast way of making di = 0           }
   </i></font><font color="#FF00FF">mov     ax,[Col]                     </font><font color="#008000"><i>{Hold the color in the AX register   }
   </i></font><font color="#FF00FF">rep     stosw                        </font><font color="#008000"><i>{start at ES ($B800), write AX (Fill)}
                                        {to memory at ES + DI, add 1 to DI   }
                                        {Stop when DI = CX (2000)            }
   </i></font><font color="#FF00FF">pop     es                           </font><font color="#008000"><i>{Restore ES off the stack            }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>FBG2<font color="#000080">(</font>Where <font color="#000080">: </font>WORD<font color="#000080">;
               </font>Ascii <font color="#000080">: </font>BYTE<font color="#000080">;
               </font>Col   <font color="#000080">: </font>BYTE<font color="#000080">); </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">push    es                           </font><font color="#008000"><i>{Save ES segment on the stack        }
   </i></font><font color="#FF00FF">mov     cx,2000                      </font><font color="#008000"><i>{CX := 2000                          }
   </i></font><font color="#FF00FF">mov     ax,[where]
   mov     es,ax                        </font><font color="#008000"><i>{ES now points at start mem location }
   </i></font><font color="#FF00FF">xor     di,di                        </font><font color="#008000"><i>{Fast way of making di = 0           }
   </i></font><font color="#FF00FF">mov     al,[Ascii]                   </font><font color="#008000"><i>{Hold the character in the AX registr}
   </i></font><font color="#FF00FF">mov     ah,[Col]                     </font><font color="#008000"><i>{Hold the color in the AX register   }
   </i></font><font color="#FF00FF">rep     stosw                        </font><font color="#008000"><i>{start at ES ($B800), write AX (Fill)}
                                        {to memory at ES + DI, add 1 to DI   }
                                        {Stop when DI = CX (2000)            }
   </i></font><font color="#FF00FF">pop     es                           </font><font color="#008000"><i>{Restore ES off the stack            }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetBG<font color="#000080">(</font>Back <font color="#000080">: </font>BOOLEAN<font color="#000080">); </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
     </b></font><font color="#FF00FF">mov  AX,$1003
     mov  BL,Back
     int  $10
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Pal<font color="#000080">(</font>Col <font color="#000080">: </font>BYTE<font color="#000080">;
              </font>R   <font color="#000080">: </font>BYTE<font color="#000080">;
              </font>G   <font color="#000080">: </font>BYTE<font color="#000080">;
              </font>B   <font color="#000080">: </font>BYTE<font color="#000080">); </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ This sets the Red, Green and Blue values of a certain color }
</i></font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">mov    dx,3c8h
   mov    al,[col]
   out    dx,al
   inc    dx
   mov    al,[r]
   out    dx,al
   mov    al,[g]
   out    dx,al
   mov    al,[b]
   out    dx,al
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>GetPal<font color="#000080">(</font>Col <font color="#000080">: </font>BYTE<font color="#000080">;
             </font><font color="#FF0000"><b>VAR </b></font>R   <font color="#000080">: </font>BYTE<font color="#000080">;
             </font><font color="#FF0000"><b>VAR </b></font>G   <font color="#000080">: </font>BYTE<font color="#000080">;
             </font><font color="#FF0000"><b>VAR </b></font>B   <font color="#000080">: </font>BYTE<font color="#000080">);
  </font><font color="#008000"><i>{ This gets the Red, Green and Blue values of a certain color }
</i></font><font color="#FF0000"><b>VAR
   </b></font>rr <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>gg <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>bb <font color="#000080">: </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   ASM
      </b></font><font color="#FF00FF">mov    dx,3c7h
      mov    al,col
      out    dx,al

      add    dx,2

      in     al,dx
      mov    [rr],al
      in     al,dx
      mov    [gg],al
      in     al,dx
      mov    [bb],al
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>r <font color="#000080">:= </font>rr<font color="#000080">;
   </font>g <font color="#000080">:= </font>gg<font color="#000080">;
   </font>b <font color="#000080">:= </font>bb<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>WaitRetrace<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>LABEL
  </b></font>l1<font color="#000080">, </font>l2<font color="#000080">;
</font><font color="#FF0000"><b>ASM
    </b></font><font color="#FF00FF">mov dx,3DAh
l1:
    in al,dx
    and al,08h
    jnz l1
l2:
    in al,dx
    and al,08h
    jz  l2
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SavePallette<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Pall <font color="#000080">: </font>Pallette<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>loop1 <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     FOR </b></font>loop1 <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">255 </font><font color="#FF0000"><b>DO
       </b></font>GetPal <font color="#000080">(</font>loop1<font color="#000080">,</font>pall<font color="#000080">[</font>loop1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">],</font>pall<font color="#000080">[</font>loop1<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">],</font>pall<font color="#000080">[</font>loop1<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>RestorePallette<font color="#000080">(</font>Pall <font color="#000080">: </font>Pallette<font color="#000080">);
  </font><font color="#008000"><i>{ This procedure restores the origional pallette }
</i></font><font color="#FF0000"><b>VAR
   </b></font>loop1 <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>WaitRetrace<font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>loop1<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do
       </b></font>Pal <font color="#000080">(</font>loop1<font color="#000080">,</font>Pall<font color="#000080">[</font>loop1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">],</font>Pall<font color="#000080">[</font>loop1<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">],</font>Pall<font color="#000080">[</font>loop1<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>Procedure </b></font>FadeToBlack<font color="#000080">;
  </font><font color="#008000"><i>{ This procedure fades the screen out to black. }
</i></font><font color="#FF0000"><b>VAR </b></font>loop1<font color="#000080">,</font>loop2<font color="#000080">:</font>integer<font color="#000080">;
    </font>Tmp <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
      </font><font color="#008000"><i>{ This is temporary storage for the values of a color }
</i></font><font color="#FF0000"><b>BEGIN
  For </b></font>loop1<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">64 </font><font color="#FF0000"><b>do BEGIN
    </b></font>WaitRetrace<font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>loop2<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do BEGIN
      </b></font>Getpal <font color="#000080">(</font>loop2<font color="#000080">,</font>Tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Tmp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>Tmp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]);
      </font><font color="#FF0000"><b>If </b></font>Tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>dec <font color="#000080">(</font>Tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
      </font><font color="#FF0000"><b>If </b></font>Tmp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>dec <font color="#000080">(</font>Tmp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
      </font><font color="#FF0000"><b>If </b></font>Tmp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>dec <font color="#000080">(</font>Tmp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]);
        </font><font color="#008000"><i>{ If the Red, Green or Blue values of color loop2 are not yet zero,
          then, decrease them by one. }
      </i></font>Pal <font color="#000080">(</font>loop2<font color="#000080">,</font>Tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Tmp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>Tmp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]);
        </font><font color="#008000"><i>{ Set the new, altered pallette color. }
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>Procedure </b></font>Fadeup<font color="#000080">(</font>Pall <font color="#000080">: </font>Pallette<font color="#000080">);
  </font><font color="#008000"><i>{ This procedure slowly fades up the new screen }
</i></font><font color="#FF0000"><b>VAR </b></font>loop1<font color="#000080">,</font>loop2<font color="#000080">:</font>integer<font color="#000080">;
    </font>Tmp <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
      </font><font color="#008000"><i>{ This is temporary storage for the values of a color }
</i></font><font color="#FF0000"><b>BEGIN
  For </b></font>loop1<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">64 </font><font color="#FF0000"><b>do BEGIN
      </b></font><font color="#008000"><i>{ A color value for Red, green or blue is 0 to 63, so this loop only
        need be executed a maximum of 64 times }
    </i></font>WaitRetrace<font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>loop2<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do BEGIN
      </b></font>Getpal <font color="#000080">(</font>loop2<font color="#000080">,</font>Tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Tmp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>Tmp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]);
      </font><font color="#FF0000"><b>If </b></font>Tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&lt;</font>Pall<font color="#000080">[</font>loop2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font>inc <font color="#000080">(</font>Tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
      </font><font color="#FF0000"><b>If </b></font>Tmp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]&lt;</font>Pall<font color="#000080">[</font>loop2<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font>inc <font color="#000080">(</font>Tmp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
      </font><font color="#FF0000"><b>If </b></font>Tmp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]&lt;</font>Pall<font color="#000080">[</font>loop2<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font>inc <font color="#000080">(</font>Tmp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]);
        </font><font color="#008000"><i>{ If the Red, Green or Blue values of color loop2 are less then they
          should be, increase them by one. }
      </i></font>Pal <font color="#000080">(</font>loop2<font color="#000080">,</font>Tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Tmp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>Tmp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]);
        </font><font color="#008000"><i>{ Set the new, altered pallette color. }
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>Procedure </b></font>Blackout<font color="#000080">;
  </font><font color="#008000"><i>{ This procedure blackens the screen by setting the pallette values of
    all the colors to zero. }
</i></font><font color="#FF0000"><b>VAR </b></font>loop1<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>WaitRetrace<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>loop1<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do
    </b></font>Pal <font color="#000080">(</font>loop1<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>CursorOff<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">mov  ah,3
   mov  bh,0
   int  10h
   mov  ah,1
   mov  cx,$100
   int  10h
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>CursorOn<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">mov  ah,1
   mov  cx,3342
   int  10h
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetCh<font color="#000080">(</font>X <font color="#000080">: </font>BYTE<font color="#000080">;
               </font>Y <font color="#000080">: </font>BYTE<font color="#000080">) : </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>OffSet <font color="#000080">: </font>WORD<font color="#000080">;
   </font>ScrPtr <font color="#000080">:^</font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>OffSet <font color="#000080">:= (((</font>Y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) * </font><font color="#800000">80</font><font color="#000080">) + </font>X <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) * </font><font color="#800000">2</font><font color="#000080">;
     </font>ScrPtr <font color="#000080">:= </font>PTR<font color="#000080">(</font><font color="#800000">$B800</font><font color="#000080">,</font>offset<font color="#000080">);
     </font>GetCh  <font color="#000080">:= </font>ScrPtr<font color="#000080">^;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>WriteXY<font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                  </font>X   <font color="#000080">: </font>BYTE<font color="#000080">;
                  </font>Y   <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>GOTOXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);
     </font>WRITE<font color="#000080">(</font>Str<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>grinit<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>gd <font color="#000080">: </font>INTEGER<font color="#000080">;
   </font>gm <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>gd <font color="#000080">:= </font>DETECT<font color="#000080">;
     </font>INITGRAPH<font color="#000080">(</font>gd<font color="#000080">, </font>gm<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">);
     </font><font color="#FF0000"><b>IF </b></font>GRAPHRESULT <font color="#000080">&lt;&gt; </font>grOk <font color="#FF0000"><b>THEN
       BEGIN
        </b></font>gd <font color="#000080">:= </font>DETECT<font color="#000080">;
        </font>INITGRAPH<font color="#000080">(</font>gd<font color="#000080">, </font>gm<font color="#000080">, </font><font color="#800000">'C:\TP\BGI'</font><font color="#000080">);
        </font><font color="#FF0000"><b>IF </b></font>GRAPHRESULT <font color="#000080">&lt;&gt; </font>grOk <font color="#FF0000"><b>THEN
          BEGIN
            </b></font>WRITELN<font color="#000080">(</font><font color="#800000">'GRAPHICS DRIVERS MALFUNCTION'</font><font color="#000080">);
            </font>READKEY<font color="#000080">;
            </font>HALT<font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>GrShutDown<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>CLEARDEVICE<font color="#000080">;
     </font>CLOSEGRAPH<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>TBG<font color="#000080">(</font>X <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>TEXTBACKGROUND<font color="#000080">(</font>X<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>TC<font color="#000080">(</font>X <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>TEXTCOLOR<font color="#000080">(</font>X<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}


</i></font><font color="#FF0000"><b>PROCEDURE </b></font>UpString<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Str <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>StrLen <font color="#000080">: </font>BYTE<font color="#000080">;                    </font><font color="#008000"><i>{The total Length of the string         }
   </i></font>StrPos <font color="#000080">: </font>BYTE<font color="#000080">;                    </font><font color="#008000"><i>{Where in the string am I               }
</i></font><font color="#FF0000"><b>BEGIN
     </b></font>StrLen <font color="#000080">:= </font>LENGTH<font color="#000080">(</font>Str<font color="#000080">);          </font><font color="#008000"><i>{Get the length of the string           }
     </i></font>StrPos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                    </font><font color="#008000"><i>{The first char in the string is 1      }
     </i></font><font color="#FF0000"><b>REPEAT                          </b></font><font color="#008000"><i>{Start repeating                        }
       </i></font>Str<font color="#000080">[</font>StrPos<font color="#000080">] := </font>UPCASE<font color="#000080">(</font>Str<font color="#000080">[</font>StrPos<font color="#000080">]);
                                     </font><font color="#008000"><i>{Change each letter to uppercase        }
       </i></font>INC<font color="#000080">(</font>StrPos<font color="#000080">);                  </font><font color="#008000"><i>{Move to the next letter                }
     </i></font><font color="#FF0000"><b>UNTIL </b></font>StrPos <font color="#000080">= </font>StrLen<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;        </font><font color="#008000"><i>{Stop repeating when the word is finish }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;     </font><font color="#008000"><i>{UpString}

{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>CheckForExtension<font color="#000080">(</font>FileStr <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>StrLen <font color="#000080">: </font>BYTE<font color="#000080">;                    </font><font color="#008000"><i>{The total Length of the string        }
   </i></font>StrPos <font color="#000080">: </font>BYTE<font color="#000080">;                    </font><font color="#008000"><i>{Where in the string am I              }
   </i></font>Found  <font color="#000080">: </font>BOOLEAN<font color="#000080">;                 </font><font color="#008000"><i>{Was a period found                    }

</i></font><font color="#FF0000"><b>BEGIN
     </b></font>StrLen <font color="#000080">:= </font>LENGTH<font color="#000080">(</font>FileStr<font color="#000080">);      </font><font color="#008000"><i>{Get the length of the string           }
     </i></font>StrPos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                    </font><font color="#008000"><i>{Standard Pascal strings start at byte 1}
     </i></font>Found  <font color="#000080">:= </font>FALSE<font color="#000080">;                </font><font color="#008000"><i>{Default is no period                   }
     </i></font><font color="#FF0000"><b>REPEAT                          </b></font><font color="#008000"><i>{Start Repeating                        }
       </i></font><font color="#FF0000"><b>IF </b></font>FileStr<font color="#000080">[</font>StrPos<font color="#000080">] = </font><font color="#800000">'.' </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{Stop repeating if a full stop is found }
           </i></font>Found <font color="#000080">:= </font>True<font color="#000080">;            </font><font color="#008000"><i>{If you find a full stop get organised..}
       </i></font>INC<font color="#000080">(</font>StrPos<font color="#000080">);                  </font><font color="#008000"><i>{move to the next spot in the string    }
     </i></font><font color="#FF0000"><b>UNTIL </b></font>Found <font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>StrPos <font color="#000080">= </font>StrLen<font color="#000080">);
     </font><font color="#FF0000"><b>IF </b></font>Found <font color="#FF0000"><b>THEN                   </b></font><font color="#008000"><i>{if you did find an extension output it }
       </i></font>CheckForExtension <font color="#000080">:= </font>TRUE
     <font color="#FF0000"><b>ELSE                            </b></font><font color="#008000"><i>{else tell it you didn't                }
       </i></font>CheckForExtension <font color="#000080">:= </font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;   </font><font color="#008000"><i>{CheckForExtension}

{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>WriteC<font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                 </font>Y   <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>GOTOXY<font color="#000080">(</font><font color="#800000">40 </font><font color="#000080">- (</font>LENGTH<font color="#000080">(</font>Str<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">),</font>Y<font color="#000080">);
     </font>WRITE<font color="#000080">(</font>Str<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

</i></font><font color="#FF0000"><b>function </b></font>Exist<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Boolean function that returns True if the file exists;otherwise,
 it returns False. Closes the file if it exists. }
</i></font><font color="#FF0000"><b>var
 </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{$I-}
 </i></font>Assign<font color="#000080">(</font>F<font color="#000080">, </font>FileName<font color="#000080">);
 </font>FileMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;  </font><font color="#008000"><i>{ Set file access to read only }
 </i></font>Reset<font color="#000080">(</font>F<font color="#000080">);
 </font>Close<font color="#000080">(</font>F<font color="#000080">);
 </font><font color="#008000"><i>{$I+}
 </i></font>Exist <font color="#000080">:= (</font>IOResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FileName <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{Exist}

{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

                { --=THINGS TO DO AFTER THE PROGRAM=-- }

{F+}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>MyExit<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>EXITPROC <font color="#000080">:= </font>ExitPtr<font color="#000080">;
     </font>NOSOUND<font color="#000080">;
     </font>RestorePallette<font color="#000080">(</font>BackUpPalletteStorage<font color="#000080">);
     </font>CursorOn<font color="#000080">;
     </font>TEXTBACKGROUND<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
     </font>TEXTCOLOR<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
     </font>CLRSCR<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{$F-}

{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;}

             { --=THINGS TO DO BEFORE RUNNING THE PROGRAM=-- }

</i></font><font color="#FF0000"><b>BEGIN
     </b></font>ExitPtr  <font color="#000080">:= </font>EXITPROC<font color="#000080">;
     </font>EXITPROC <font color="#000080">:= @</font>MyExit<font color="#000080">;
     </font>RANDOMIZE<font color="#000080">;
     </font>SavePallette<font color="#000080">(</font>BackUpPalletteStorage<font color="#000080">);
     </font>TEXTBACKGROUND<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
     </font>TEXTCOLOR<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
     </font>CLRSCR<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
---------------------------- = [</font>Cut Here<font color="#000080">] = ---------------------------------

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p></body>
</html>
