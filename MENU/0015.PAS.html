<html>
<head><title> "Simple Menu System" by BRANDON SNEED</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ NMENU.PAS - 8/25/96 by Brandon Sneed (Nivenh) }
{ Use it and abuse it and don't give me credit if you don't want too. }
{ example of use at the end !! }
</i></font><font color="#FF0000"><b>unit </b></font>nmenu<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses </b></font>crt<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>menurec <font color="#000080">= </font><font color="#FF0000"><b>record
            </b></font>text <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">30</font><font color="#000080">]; </font><font color="#008000"><i>{ description }
            </i></font>xpos<font color="#000080">,              </font><font color="#008000"><i>{ X coord }
            </i></font>ypos <font color="#000080">: </font>byte<font color="#000080">;       </font><font color="#008000"><i>{ Y coord }
            </i></font>key  <font color="#000080">: </font>char<font color="#000080">;       </font><font color="#008000"><i>{ hot key }
            </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>domenu<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>menu<font color="#000080">; </font>numitems<font color="#000080">, </font>start<font color="#000080">, </font>highclr<font color="#000080">, </font>loclr <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
  </font><font color="#008000"><i>{ the MENU param must be untyped since we'll be passing an array to it }
  {  menu = menu array constant                   }
  {  numitems = number of items in the menu array }
  {  start = which item should be highlighted by default? usually 1 }
  {  highclr = color to highlight with            }
  {  loclr = color to deselect with               }

</i></font><font color="#FF0000"><b>implementation

function </b></font>domenu<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>menu<font color="#000080">; </font>numitems<font color="#000080">, </font>start<font color="#000080">, </font>highclr<font color="#000080">, </font>loclr <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>type
</b></font>	<font color="#008000"><i>{ Increase the size of this array for more than 25 menu items }
  </i></font>menucast <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>menurec<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>cnt <font color="#000080">: </font>byte<font color="#000080">;
</font>	choice <font color="#000080">: </font>byte<font color="#000080">;
  </font>getkey <font color="#000080">: </font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>start <font color="#000080">&gt; </font>numitems <font color="#FF0000"><b>then </b></font>start <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ draw the menu }
  </i></font><font color="#FF0000"><b>for </b></font>cnt <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numitems <font color="#FF0000"><b>do
    with </b></font>menucast<font color="#000080">(</font>menu<font color="#000080">)[</font>cnt<font color="#000080">] </font><font color="#FF0000"><b>do
    begin
    </b></font>textattr <font color="#000080">:= </font>loclr<font color="#000080">;
    </font>gotoxy<font color="#000080">(</font>xpos<font color="#000080">, </font>ypos<font color="#000080">);
    </font>write<font color="#000080">(</font>text<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>getkey <font color="#000080">:= </font><font color="#800000">#255</font><font color="#000080">;
  </font>choice <font color="#000080">:= </font>start<font color="#000080">;

  </font><font color="#FF0000"><b>repeat
    if </b></font><font color="#000080">(</font>choice <font color="#000080">&lt;= </font>numitems<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>choice <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    with </b></font>menucast<font color="#000080">(</font>menu<font color="#000080">)[</font>choice<font color="#000080">] </font><font color="#FF0000"><b>do
      begin
      </b></font>textattr <font color="#000080">:= </font>highclr<font color="#000080">;
      </font>gotoxy<font color="#000080">(</font>xpos<font color="#000080">, </font>ypos<font color="#000080">);
      </font>write<font color="#000080">(</font>text<font color="#000080">);
      </font>textattr <font color="#000080">:= </font>loclr<font color="#000080">;

      </font><font color="#FF0000"><b>if </b></font>keypressed <font color="#FF0000"><b>then
        </b></font>getkey <font color="#000080">:= </font>readkey<font color="#000080">;
      </font><font color="#008000"><i>{ if a arrowkey, or any function type key is sent, a #0 always is sent
        first, and THEN the actual key value is sent. so, the first call to
        readkey will get #0, and the second will get the key we're looking
        for. }
      </i></font><font color="#FF0000"><b>if </b></font>getkey <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>then
        begin
        </b></font>getkey <font color="#000080">:= </font>readkey<font color="#000080">;
        </font><font color="#FF0000"><b>case </b></font>getkey <font color="#FF0000"><b>of
          </b></font><font color="#008000"><i>{ up }
          </i></font><font color="#800000">#72 </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>choice <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
                begin
                </b></font>textattr <font color="#000080">:= </font>loclr<font color="#000080">;
                </font>gotoxy<font color="#000080">(</font>xpos<font color="#000080">, </font>ypos<font color="#000080">);
                </font>write<font color="#000080">(</font>text<font color="#000080">);
                </font>dec<font color="#000080">(</font>choice<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#008000"><i>{ down }
          </i></font><font color="#800000">#80 </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>choice <font color="#000080">&lt; </font>numitems <font color="#FF0000"><b>then
                begin
                </b></font>textattr <font color="#000080">:= </font>loclr<font color="#000080">;
                </font>gotoxy<font color="#000080">(</font>xpos<font color="#000080">, </font>ypos<font color="#000080">);
                </font>write<font color="#000080">(</font>text<font color="#000080">);
                </font>inc<font color="#000080">(</font>choice<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{ if they hit ESC, set choice to 0 and exit }
      </i></font><font color="#FF0000"><b>if </b></font>getkey <font color="#000080">= </font><font color="#800000">#27 </font><font color="#FF0000"><b>then </b></font>choice <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#008000"><i>{ if they press a key, see if the key the pressed is a hotkey }
      </i></font>getkey <font color="#000080">:= </font>upcase<font color="#000080">(</font>getkey<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>getkey <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">] </font><font color="#FF0000"><b>then
        begin
        for </b></font>cnt <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numitems <font color="#FF0000"><b>do
          if </b></font>getkey <font color="#000080">= </font>menucast<font color="#000080">(</font>menu<font color="#000080">)[</font>cnt<font color="#000080">].</font>key <font color="#FF0000"><b>then
            begin
            </b></font>choice <font color="#000080">:= </font>cnt<font color="#000080">;
            </font>getkey <font color="#000080">:= </font><font color="#800000">#13</font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>getkey <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>getkey <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">);
  </font>domenu <font color="#000080">:= </font>choice<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ----------   DEMO PROGRAM ------------ }
{ 8/25/96 NMENU Example by Brandon Sneed }
</i></font><font color="#FF0000"><b>program </b></font>nmenuexample<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">, </font>nmenu<font color="#000080">;

</font><font color="#FF0000"><b>const
</b></font>	DummyMenu <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>MenuRec <font color="#000080">=
</font>		<font color="#000080">((</font>Text <font color="#000080">: </font><font color="#800000">' Test 1 '</font><font color="#000080">; </font>XPos <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">; </font>YPos <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">; </font>Key <font color="#000080">: </font><font color="#800000">'1'</font><font color="#000080">),
</font>		 <font color="#000080">(</font>Text <font color="#000080">: </font><font color="#800000">' Test 2 '</font><font color="#000080">; </font>XPos <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">; </font>YPos <font color="#000080">: </font><font color="#800000">2</font><font color="#000080">; </font>Key <font color="#000080">: </font><font color="#800000">'2'</font><font color="#000080">),
</font>		 <font color="#000080">(</font>Text <font color="#000080">: </font><font color="#800000">' Test 3 '</font><font color="#000080">; </font>XPos <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">; </font>YPos <font color="#000080">: </font><font color="#800000">3</font><font color="#000080">; </font>Key <font color="#000080">: </font><font color="#800000">'3'</font><font color="#000080">),
</font>		 <font color="#000080">(</font>Text <font color="#000080">: </font><font color="#800000">' Test 4 '</font><font color="#000080">; </font>XPos <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">; </font>YPos <font color="#000080">: </font><font color="#800000">4</font><font color="#000080">; </font>Key <font color="#000080">: </font><font color="#800000">'4'</font><font color="#000080">),
</font>		 <font color="#000080">(</font>Text <font color="#000080">: </font><font color="#800000">' Test 5 '</font><font color="#000080">; </font>XPos <font color="#000080">: </font><font color="#800000">1</font><font color="#000080">; </font>YPos <font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>Key <font color="#000080">: </font><font color="#800000">'5'</font><font color="#000080">));
</font>	<font color="#008000"><i>{ the menu array can have as many options as you need.  just add them.
		be sure to change the 'numitems' value being passed to domenu }
</i></font><font color="#FF0000"><b>var
</b></font>	userpick <font color="#000080">: </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font>	userpick <font color="#000080">:= </font>domenu<font color="#000080">( </font>dummymenu<font color="#000080">,       </font><font color="#008000"><i>{ our menu const }
</i></font>											<font color="#800000">5</font><font color="#000080">,               </font><font color="#008000"><i>{ total number of items in array }
</i></font>											<font color="#800000">1</font><font color="#000080">,               </font><font color="#008000"><i>{ which item is first highlighted }
</i></font>											<font color="#800000">$1F</font><font color="#000080">,             </font><font color="#008000"><i>{ highlight color (white! on blue) }
</i></font>											<font color="#800000">$07</font><font color="#000080">);            </font><font color="#008000"><i>{ unhighlight color (white) }
</i></font>	gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">);
</font>	writeln<font color="#000080">(</font><font color="#800000">'User picked: '</font><font color="#000080">+</font>DummyMenu<font color="#000080">[</font>userpick<font color="#000080">].</font>Text<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p></body>
</html>
