<html>
<head><title> "Efficient Menu System" by BRAD ZAVITSKY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
  [ NOTES ]

  -- Desc --
    RmMenu has been created to allow easy, fast, and efficient menu's
    that are very versatile and configurable to be created without
    the usual amount of bulky, cryptic code and time consuming
    initialization, in fact, RmMenu uses and needs NO initalization
    of any variables.


  -- Legal --
    RmMenu was created by Brad Zavitsky and all rights are reserved.

    Use at your own risk, the author(s) will not take any responsibility.

    SWAG use and commercial use is fine, RmMenu is FreeWare.

    Use of RmMenu is allowed free of charge provided that the CopyRight
    procedure is not altered and is not removed at the initialization
    part of the unit and optionally credit is given to me, the author
    for the unit.


  -- Switches --
    DEBUG : Define this to use the compiler directives for use with
            debugging.  RmMenu has already been debugged so you should
            not have to use this at all.

    FASTW : This is on by default, remove it below to use CRT's slower
            writes instead of the special FASTWRITE procedure.


 -- Info --
   Code size      : 1121 bytes
   Data size      : 0 bytes
   Stack size     : 0 bytes
   Min heap       : 0 bytes
   Max heap       : 0 bytes

*)

{$DEFINE FASTW}

{$IFDEF DEBUG}
{$A+,B-,D+,F-,G-,I+,K-,L+,N-,O-,E-,P-,Q+,R+,S+,T-,V-,W-,X+,Y-}
{$ELSE}
{$A+,B-,D-,F-,G-,I-,K-,L-,N-,O-,E-,P-,Q-,R-,S-,T-,V-,W-,X+,Y-}
{$ENDIf}

</i></font><font color="#FF0000"><b>Unit </b></font>RmMenu<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const
 </b></font>Max_Choices <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;

</font><font color="#FF0000"><b>Type  </b></font>Menu_Typ <font color="#000080">= </font><font color="#FF0000"><b>Record
                  </b></font>Options  <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>max_choices<font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
                  </font>Key      <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>max_choices<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
                  </font>X        <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>max_choices<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
                  </font>Y        <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>max_choices<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
                  </font>Num_Opt  <font color="#000080">: </font>byte<font color="#000080">;
                  </font>Hi_Col   <font color="#000080">: </font>byte<font color="#000080">;
                  </font>Norm_Col <font color="#000080">: </font>byte<font color="#000080">;
                  </font>HotKey   <font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#008000"><i>{ This option allows a choice to be higlighted by pressing it's KEY }
                  </i></font>HotExit  <font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#008000"><i>{ This option allows exit on HotKey }
                 </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>Menu<font color="#000080">(</font>Menu_Dat <font color="#000080">: </font>Menu_Typ<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>CChoice <font color="#000080">: </font>Byte<font color="#000080">;</font>Change <font color="#000080">: </font>Boolean<font color="#000080">);
  </font><font color="#FF0000"><b>far</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Procedure </b></font>Copyright<font color="#000080">; </font><font color="#FF0000"><b>Near</b></font><font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ This MAY NOT be removed }
 </i></font><font color="#FF0000"><b>asm
   </b></font><font color="#FF00FF">JMP @@1
   DB 13,10,'RmMenu Unit (C)1995 by Brad Zavitsky.  All rights reserved.',13,10
 @@1:
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>FastWrite<font color="#000080">(</font>Col<font color="#000080">, </font>Row<font color="#000080">, </font>Attr <font color="#000080">: </font>Byte<font color="#000080">; </font>Str <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>NEAR</b></font><font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#008000"><i>{ This procedure is the only one which is not mine }
  </i></font><font color="#FF0000"><b>ASM
    </b></font><font color="#FF00FF">PUSH   DS           </font><font color="#008000"><i>{Save DS}
    </i></font><font color="#FF00FF">MOV    DL,CheckSnow </font><font color="#008000"><i>{Save CheckSnow Setting}
    </i></font><font color="#FF00FF">MOV    ES,SegB800   </font><font color="#008000"><i>{ES = Colour Screen Segment}
    </i></font><font color="#FF00FF">MOV    SI,SegB000   </font><font color="#008000"><i>{SI = Mono Screen Segment}
    </i></font><font color="#FF00FF">MOV    DS,Seg0040   </font><font color="#008000"><i>{DS = ROM Bios Segment}
    </i></font><font color="#FF00FF">MOV    BX,[49h]     </font><font color="#008000"><i>{BL = CRT Mode, BH = ScreenWidth}
    </i></font><font color="#FF00FF">MOV    AL,Row       </font><font color="#008000"><i>{AL = Row No}
    </i></font><font color="#FF00FF">MUL    BH           </font><font color="#008000"><i>{AX = Row * ScreenWidth}
    </i></font><font color="#FF00FF">XOR    CH,CH        </font><font color="#008000"><i>{CH = 0}
    </i></font><font color="#FF00FF">MOV    CL,Col       </font><font color="#008000"><i>{CX = Column No}
    </i></font><font color="#FF00FF">ADD    AX,CX        </font><font color="#008000"><i>{(Row*ScreenWidth)+Column}
    </i></font><font color="#FF00FF">ADD    AX,AX        </font><font color="#008000"><i>{Multiply by 2 (2 Byte per Position)}
    </i></font><font color="#FF00FF">MOV    DI,AX        </font><font color="#008000"><i>{DI = Screen Offset}
    </i></font><font color="#FF00FF">CMP    BL,7         </font><font color="#008000"><i>{CRT Mode = Mono?}
    </i></font><font color="#FF00FF">JNE    @@DestSet    </font><font color="#008000"><i>{No  - Use Colour Screen Segment}
    </i></font><font color="#FF00FF">MOV    ES,SI        </font><font color="#008000"><i>{Yes - ES = Mono Screen Segment}
    </i></font><font color="#FF00FF">XOR    DX,DX        </font><font color="#008000"><i>{Force jump to FWrite}
  </i></font><font color="#FF00FF">@@DestSet:            </font><font color="#008000"><i>{ES:DI = Screen Destination Address}
    </i></font><font color="#FF00FF">LDS    SI,Str       </font><font color="#008000"><i>{DS:SI = Source String}
    </i></font><font color="#FF00FF">CLD                 </font><font color="#008000"><i>{Move Forward through String}
    </i></font><font color="#FF00FF">LODSB               </font><font color="#008000"><i>{Get Length Byte of String}
    </i></font><font color="#FF00FF">MOV    CL,AL        </font><font color="#008000"><i>{CX = Input String Length}
    </i></font><font color="#FF00FF">JCXZ   @@Done       </font><font color="#008000"><i>{Exit if Null String}
    </i></font><font color="#FF00FF">MOV    AH,Attr      </font><font color="#008000"><i>{AH = Attribute}
    </i></font><font color="#FF00FF">OR     DL,DL        </font><font color="#008000"><i>{Test Mono/CheckSnow Flag}
    </i></font><font color="#FF00FF">JZ     @@FWrite     </font><font color="#008000"><i>{Snow Checking Disabled or Mono - Use FWrite}
{Output during Screen Retrace's}
    </i></font><font color="#FF00FF">MOV    DX,003DAh    </font><font color="#008000"><i>{6845 Status Port}
  </i></font><font color="#FF00FF">@@WaitLoop:           </font><font color="#008000"><i>{Output during Retrace's}
    </i></font><font color="#FF00FF">MOV    BL,[SI]      </font><font color="#008000"><i>{Load Next Character into BL}
    </i></font><font color="#FF00FF">INC    SI           </font><font color="#008000"><i>{Update Source Pointer}
    </i></font><font color="#FF00FF">CLI                 </font><font color="#008000"><i>{Interrupts off}
  </i></font><font color="#FF00FF">@@Wait1:              </font><font color="#008000"><i>{Wait for End of Retrace}
    </i></font><font color="#FF00FF">IN      AL,DX       </font><font color="#008000"><i>{Get 6845 status}
    </i></font><font color="#FF00FF">TEST    AL,8        </font><font color="#008000"><i>{Vertical Retrace in Progress?}
    </i></font><font color="#FF00FF">JNZ     @@Write     </font><font color="#008000"><i>{Yes - Output Next Char}
    </i></font><font color="#FF00FF">SHR     AL,1        </font><font color="#008000"><i>{Horizontal Retrace in Progress?}
    </i></font><font color="#FF00FF">JC      @@Wait1     </font><font color="#008000"><i>{Yes - Wait until End of Retrace}
  </i></font><font color="#FF00FF">@@Wait2:              </font><font color="#008000"><i>{Wait for Start of Next Retrace}
    </i></font><font color="#FF00FF">IN      AL,DX       </font><font color="#008000"><i>{Get 6845 status}
    </i></font><font color="#FF00FF">SHR     AL,1        </font><font color="#008000"><i>{Horizontal Retrace in Progress?}
    </i></font><font color="#FF00FF">JNC     @@Wait2     </font><font color="#008000"><i>{No - Wait until Retrace Starts}
  </i></font><font color="#FF00FF">@@Write:              </font><font color="#008000"><i>{Output Char and Attribute}
    </i></font><font color="#FF00FF">MOV     AL,BL       </font><font color="#008000"><i>{Put Char to Write into AL}
    </i></font><font color="#FF00FF">STOSW               </font><font color="#008000"><i>{Store Character and Attribute}
    </i></font><font color="#FF00FF">STI                 </font><font color="#008000"><i>{Interrupts On}
    </i></font><font color="#FF00FF">LOOP   @@WaitLoop   </font><font color="#008000"><i>{Repeat for Each Character}
    </i></font><font color="#FF00FF">JMP    @@Done       </font><font color="#008000"><i>{Exit}
{Ignore Screen Retrace's}
  </i></font><font color="#FF00FF">@@FWrite:             </font><font color="#008000"><i>{Output Ignoring Retrace's}
    </i></font><font color="#FF00FF">TEST   SI,1         </font><font color="#008000"><i>{DS:SI an Even Offset?}
    </i></font><font color="#FF00FF">JZ     @@Words      </font><font color="#008000"><i>{Yes - Skip (On Even Boundary)}
    </i></font><font color="#FF00FF">LODSB               </font><font color="#008000"><i>{Get 1st Char}
    </i></font><font color="#FF00FF">STOSW               </font><font color="#008000"><i>{Write 1st Char and Attrib}
    </i></font><font color="#FF00FF">DEC    CX           </font><font color="#008000"><i>{Decrement Count}
    </i></font><font color="#FF00FF">JCXZ   @@Done       </font><font color="#008000"><i>{Finished if only 1 Char in Str}
  </i></font><font color="#FF00FF">@@Words:              </font><font color="#008000"><i>{DS:SI Now on Word Boundary}
    </i></font><font color="#FF00FF">SHR    CX,1         </font><font color="#008000"><i>{CX = Char Pairs, Set CF if Odd Byte Left}
    </i></font><font color="#FF00FF">JZ     @@ChkOdd     </font><font color="#008000"><i>{Skip if No Pairs to Store}
  </i></font><font color="#FF00FF">@@Loop:               </font><font color="#008000"><i>{Loop Outputing 2 Chars per Loop}
    </i></font><font color="#FF00FF">MOV    BH,AH        </font><font color="#008000"><i>{BH = Attrib}
    </i></font><font color="#FF00FF">LODSW               </font><font color="#008000"><i>{Load 2 Chars}
    </i></font><font color="#FF00FF">XCHG   AH,BH        </font><font color="#008000"><i>{AL = 1st Char, AH = Attrib, BH = 2nd Char}
    </i></font><font color="#FF00FF">STOSW               </font><font color="#008000"><i>{Store 1st Char and Attrib}
    </i></font><font color="#FF00FF">MOV    AL,BH        </font><font color="#008000"><i>{AL = 2nd Char}
    </i></font><font color="#FF00FF">STOSW               </font><font color="#008000"><i>{Store 2nd Char and Attrib}
    </i></font><font color="#FF00FF">LOOP   @@Loop       </font><font color="#008000"><i>{Repeat for Each Pair of Chars}
  </i></font><font color="#FF00FF">@@ChkOdd:             </font><font color="#008000"><i>{Check for Final Char}
    </i></font><font color="#FF00FF">JNC    @@Done       </font><font color="#008000"><i>{Skip if No Odd Char to Display}
    </i></font><font color="#FF00FF">LODSB               </font><font color="#008000"><i>{Get Last Char}
    </i></font><font color="#FF00FF">STOSW               </font><font color="#008000"><i>{Store Last Char and Attribute}
  </i></font><font color="#FF00FF">@@Done:               </font><font color="#008000"><i>{Finished}
    </i></font><font color="#FF00FF">POP    DS           </font><font color="#008000"><i>{Restore DS}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Procedure </b></font>Hilight<font color="#000080">(</font>Menu_Dat <font color="#000080">: </font>Menu_Typ<font color="#000080">; </font>ChoiceNum <font color="#000080">: </font>byte<font color="#000080">); </font><font color="#FF0000"><b>Near</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Begin
    With </b></font>Menu_Dat <font color="#FF0000"><b>do
    </b></font><font color="#008000"><i>{$IFDEF FASTW}
      </i></font>FastWrite<font color="#000080">(</font>X<font color="#000080">[</font>ChoiceNum<font color="#000080">],</font>Y<font color="#000080">[</font>ChoiceNum<font color="#000080">],</font>Hi_Col<font color="#000080">,</font>Options<font color="#000080">[</font>choiceNum<font color="#000080">]);
    </font><font color="#008000"><i>{$ELSE}
     </i></font><font color="#FF0000"><b>Begin
      </b></font>Gotoxy<font color="#000080">(</font>X<font color="#000080">[</font>choiceNum<font color="#000080">],</font>Y<font color="#000080">[</font>ChoiceNum<font color="#000080">]);
      </font>TextAttr <font color="#000080">:= </font>Hi_Col<font color="#000080">;
      </font>Write<font color="#000080">(</font>Options<font color="#000080">[</font>ChoiceNum<font color="#000080">]);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font><font color="#008000"><i>{With Menu_Dat}
    {$ENDIF}
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>UnHilight<font color="#000080">(</font>Menu_Dat <font color="#000080">: </font>Menu_Typ<font color="#000080">; </font>ChoiceNum <font color="#000080">: </font>byte<font color="#000080">); </font><font color="#FF0000"><b>Near</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Begin
    With </b></font>Menu_Dat <font color="#FF0000"><b>do
    </b></font><font color="#008000"><i>{$IFDEF FASTW}
      </i></font>FastWrite<font color="#000080">(</font>X<font color="#000080">[</font>ChoiceNum<font color="#000080">],</font>Y<font color="#000080">[</font>ChoiceNum<font color="#000080">],</font>Norm_Col<font color="#000080">,</font>Options<font color="#000080">[</font>choiceNum<font color="#000080">]);
    </font><font color="#008000"><i>{$ELSE}
     </i></font><font color="#FF0000"><b>Begin
      </b></font>Gotoxy<font color="#000080">(</font>X<font color="#000080">[</font>choiceNum<font color="#000080">],</font>Y<font color="#000080">[</font>ChoiceNum<font color="#000080">]);
      </font>TextAttr <font color="#000080">:= </font>Norm_Col<font color="#000080">;
      </font>Write<font color="#000080">(</font>Options<font color="#000080">[</font>ChoiceNum<font color="#000080">]);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font><font color="#008000"><i>{With Menu_Dat}
    {$ENDIF}
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>ShowMenu<font color="#000080">(</font>Menu_Dat <font color="#000080">: </font>Menu_Typ<font color="#000080">); </font><font color="#FF0000"><b>Near</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>B <font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      For </b></font>B <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Menu_Dat<font color="#000080">.</font>Num_Opt <font color="#FF0000"><b>do </b></font>unhilight<font color="#000080">(</font>Menu_Dat<font color="#000080">,</font>B<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>HotKeyFound<font color="#000080">(</font>Menu_Dat <font color="#000080">: </font>Menu_Typ<font color="#000080">; </font>Ch <font color="#000080">: </font>Char<font color="#000080">) : </font>byte<font color="#000080">; </font><font color="#FF0000"><b>Near</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>B <font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>HotKeyFound <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{Not found}
      </i></font>CH <font color="#000080">:= </font>UpCase<font color="#000080">(</font>Ch<font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>B <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>menu_dat<font color="#000080">.</font>num_opt <font color="#FF0000"><b>do
       Begin
          if </b></font>upcase<font color="#000080">(</font>Menu_Dat<font color="#000080">.</font>key<font color="#000080">[</font>b<font color="#000080">]) = </font>CH <font color="#FF0000"><b>then
           Begin
              </b></font>HotKeyFound <font color="#000080">:= </font>B<font color="#000080">;
              </font>Exit<font color="#000080">;
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>Menu<font color="#000080">(</font>Menu_Dat <font color="#000080">: </font>Menu_Typ<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>CChoice <font color="#000080">: </font>Byte<font color="#000080">;</font>Change <font color="#000080">: </font>Boolean<font color="#000080">);
  </font><font color="#008000"><i>{ returns choice, 0 if &lt;Esc&gt; or Tab ; }
  { Change means allow change field, ie.. Allows TAB/ESC to end }
   </i></font><font color="#FF0000"><b>Var
     </b></font>Ch <font color="#000080">: </font>Char<font color="#000080">;
     </font>Done <font color="#000080">: </font>Boolean<font color="#000080">;
     </font>oldC<font color="#000080">, </font>B   <font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
       </b></font>Done <font color="#000080">:= </font>False<font color="#000080">;
       </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>CCHoice <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>CChoice <font color="#000080">&gt; </font>Menu_Dat<font color="#000080">.</font>num_Opt<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>CChoice <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
       </font>OldC <font color="#000080">:= </font>CChoice<font color="#000080">;
       </font>ShowMenu<font color="#000080">(</font>Menu_Dat<font color="#000080">);
       </font>Hilight<font color="#000080">(</font>menu_dat<font color="#000080">, </font>CChoice<font color="#000080">);
       </font><font color="#FF0000"><b>Repeat
         </b></font>Ch <font color="#000080">:= </font>Readkey<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>CH <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>then
          Begin</b></font><font color="#008000"><i>{function key}
            </i></font>CH <font color="#000080">:= </font>Readkey<font color="#000080">;
            </font><font color="#FF0000"><b>If </b></font>CH<font color="#000080">=</font><font color="#800000">#77 </font><font color="#FF0000"><b>then </b></font>CH<font color="#000080">:=</font><font color="#800000">#80</font><font color="#000080">;
            </font><font color="#FF0000"><b>IF </b></font>CH<font color="#000080">=</font><font color="#800000">#75 </font><font color="#FF0000"><b>then </b></font>CH<font color="#000080">:=</font><font color="#800000">#72</font><font color="#000080">;

            </font><font color="#FF0000"><b>Case </b></font>CH <font color="#FF0000"><b>of
              </b></font><font color="#800000">#72 </font><font color="#000080">: </font><font color="#008000"><i>{Up}
                   </i></font><font color="#FF0000"><b>If </b></font>CChoice <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
                    begin
                     </b></font>unhilight<font color="#000080">(</font>menu_dat<font color="#000080">, </font>CChoice<font color="#000080">);
                     </font>dec<font color="#000080">(</font>CChoice<font color="#000080">);
                    </font><font color="#FF0000"><b>End Else
                     Begin
                      </b></font>unhilight<font color="#000080">(</font>menu_dat<font color="#000080">, </font>CChoice<font color="#000080">);
                      </font>CChoice <font color="#000080">:= </font>menu_dat<font color="#000080">.</font>num_opt<font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font><font color="#800000">#80 </font><font color="#000080">: </font><font color="#008000"><i>{Down}
                   </i></font><font color="#FF0000"><b>If </b></font>CChoice <font color="#000080">&lt; </font>Menu_Dat<font color="#000080">.</font>num_opt <font color="#FF0000"><b>then
                    begin
                     </b></font>unhilight<font color="#000080">(</font>menu_dat<font color="#000080">, </font>CChoice<font color="#000080">);
                     </font>inc<font color="#000080">(</font>CChoice<font color="#000080">);
                    </font><font color="#FF0000"><b>End Else
                     Begin
                      </b></font>unhilight<font color="#000080">(</font>menu_dat<font color="#000080">, </font>CChoice<font color="#000080">);
                      </font>CChoice <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font><font color="#800000">#71 </font><font color="#000080">: </font><font color="#008000"><i>{Home}
                   </i></font><font color="#FF0000"><b>If </b></font>CChoice <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
                    begin
                     </b></font>unhilight<font color="#000080">(</font>menu_dat<font color="#000080">, </font>CChoice<font color="#000080">);
                     </font>CChoice <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font><font color="#800000">#79 </font><font color="#000080">: </font><font color="#008000"><i>{End}
                   </i></font><font color="#FF0000"><b>If </b></font>CChoice <font color="#000080">&lt; </font>Menu_Dat<font color="#000080">.</font>Num_Opt <font color="#FF0000"><b>then
                    begin
                     </b></font>unhilight<font color="#000080">(</font>menu_dat<font color="#000080">, </font>CChoice<font color="#000080">);
                     </font>CChoice <font color="#000080">:= </font>Menu_Dat<font color="#000080">.</font>Num_Opt<font color="#000080">;
                    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font><font color="#008000"><i>{Case}
          </i></font><font color="#FF0000"><b>End Else
          Case </b></font>CH <font color="#FF0000"><b>of
            </b></font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">#9 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>Change <font color="#FF0000"><b>then
                  Begin
                   </b></font>CChoice <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                   </font>Exit<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
            </font><font color="#800000">#13 </font><font color="#000080">:
                  </font><font color="#FF0000"><b>Begin
                   </b></font>Exit<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>Else if </b></font>menu_dat<font color="#000080">.</font>hotkey <font color="#FF0000"><b>then
            Begin
             </b></font>B <font color="#000080">:= </font>HotKeyFound<font color="#000080">(</font>Menu_Dat<font color="#000080">, </font>ch<font color="#000080">);
             </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>B <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
              Begin
               If </b></font><font color="#000080">(</font>B <font color="#000080">&lt;&gt; </font>CChoice<font color="#000080">) </font><font color="#FF0000"><b>then
                Begin
                 </b></font>Unhilight<font color="#000080">(</font>menu_dat<font color="#000080">, </font>CChoice<font color="#000080">);
                 </font>CChoice <font color="#000080">:= </font>B<font color="#000080">;
                 </font>HiLight<font color="#000080">(</font>Menu_dat<font color="#000080">,</font>CChoice<font color="#000080">);
                 </font>OldC <font color="#000080">:= </font>CChoice<font color="#000080">;
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font><font color="#008000"><i>{(B &lt;&gt; CChoice)}
               </i></font><font color="#FF0000"><b>If </b></font>menu_dat<font color="#000080">.</font>hotexit <font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font><font color="#008000"><i>{ (B &lt;&gt; 0) }
            </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ menu_dat.hotkey }
          </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font><font color="#008000"><i>{Case}
       </i></font><font color="#FF0000"><b>If </b></font>OldC <font color="#000080">&lt;&gt; </font>CChoice <font color="#FF0000"><b>then </b></font>HiLight<font color="#000080">(</font>Menu_Dat<font color="#000080">, </font>CChoice<font color="#000080">);
       </font>OldC <font color="#000080">:= </font>CChoice<font color="#000080">;
       </font><font color="#FF0000"><b>Until </b></font>Done<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Begin
 </b></font>Copyright<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.


--[ </font>Sample <font color="#FF0000"><b>Program </b></font><font color="#000080">]--

</font><font color="#FF0000"><b>Program </b></font>test<font color="#000080">;
</font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">, </font>RMMENU<font color="#000080">;

</font><font color="#FF0000"><b>Var
 </b></font>MenuC <font color="#000080">: </font>Menu_Typ<font color="#000080">;
 </font>B <font color="#000080">: </font>byte<font color="#000080">;
 </font>TempS <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin

 With </b></font>MenuC <font color="#FF0000"><b>do
  Begin

   </b></font>options<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'Continue'</font><font color="#000080">;
   </font>options<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">'Quit'</font><font color="#000080">;
   </font>options<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font><font color="#800000">'Abort'</font><font color="#000080">;
   </font>key<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'C'</font><font color="#000080">;
   </font>key<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">'Q'</font><font color="#000080">;
   </font>key<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font><font color="#800000">'A'</font><font color="#000080">;
   </font>y<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">2</font><font color="#000080">;
   </font>y<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>y<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
   </font>y<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>y<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
   </font>x<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">2</font><font color="#000080">;
   </font>x<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>X<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] + </font>length<font color="#000080">(</font>options<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">;
   </font>x<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>x<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] + </font>length<font color="#000080">(</font>options<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">;
   </font>Num_Opt <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
   </font>Hi_Col <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;
   </font>HotKey <font color="#000080">:= </font>True<font color="#000080">;  </font><font color="#008000"><i>{This allows one keypress picks}
   </i></font>HotExit <font color="#000080">:= </font>False<font color="#000080">;  </font><font color="#008000"><i>{This allows to exit on Hotkey}
   </i></font>Norm_Col <font color="#000080">:= </font><font color="#800000">31</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

 </font>TextAttr <font color="#000080">:= </font><font color="#800000">80</font><font color="#000080">;
 </font>ClrScr<font color="#000080">;
 </font>B <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>Repeat
  </b></font>Menu<font color="#000080">(</font>MenuC<font color="#000080">, </font>B<font color="#000080">, </font>True<font color="#000080">);
 </font><font color="#FF0000"><b>Until </b></font>B <font color="#000080">&lt;&gt; </font><font color="#800000">1</font><font color="#000080">;
 </font>writeln<font color="#000080">;
 </font>Writeln<font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>B <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Writeln<font color="#000080">(</font><font color="#800000">'You have picked choice number '</font><font color="#000080">, </font>B<font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else </b></font>writeln<font color="#000080">(</font><font color="#800000">'You have either pressed &lt;ESC&gt; or TAB to change fields'</font><font color="#000080">);
 </font>Readln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p></body>
</html>
