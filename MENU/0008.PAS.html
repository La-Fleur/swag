<html>
<head><title> "RA/FD alike Menu unit" by PETER BATENBURG</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I saw someone could use a menu unit like the one used with RA/FD/ALLFIX..
Well... I have one... :

&uacute;oO BEGIN Menus.Pas Oo&uacute;
(* This unit is (c) 1995 by Archangel/DMA
   You can use this unit, or parts of it in your own programs as
   long as you mention my name somewhere (I didn't code it all for
   fun you know =])

   It's a pretty straightforward unit, if you don't get it, try to
   look at the code some more and probably you'll understand. Or you
   can read the comments.

   About comments, there are not much comments since I'm not good at
   commenting my own sources...

*)
{$G+,F+,X+,V-,R-,O+}
{$M 8192,0,128000}                           { Set up some local stack space }
</i></font><font color="#FF0000"><b>Unit </b></font>RAMenu<font color="#000080">;
</font><font color="#FF0000"><b>Interface
Type
  </b></font>SaveRecord <font color="#000080">= </font><font color="#FF0000"><b>Record                         </b></font><font color="#008000"><i>{ Record used for 'pushscreen' }
                 </i></font><font color="#FF0000"><b>Case </b></font>UseDisk<font color="#000080">: </font>Boolean <font color="#FF0000"><b>of                        </b></font><font color="#008000"><i>{ Use disk? }
                   </i></font>TRUE <font color="#000080">: (</font>FName<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">]);              </font><font color="#008000"><i>{ Yes? What file }
                   </i></font>FALSE<font color="#000080">: (</font>MemPtr<font color="#000080">: </font>Pointer<font color="#000080">);                    </font><font color="#008000"><i>{ No? Where? }
               </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>SaveStackType <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">50</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>SaveRecord<font color="#000080">;                   </font><font color="#008000"><i>{ Save stack }
  </i></font>SubMenuRecord <font color="#000080">= </font><font color="#FF0000"><b>record                     </b></font><font color="#008000"><i>{ Record used to store submenus }
                    </i></font>ItemName <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">40</font><font color="#000080">];        </font><font color="#008000"><i>{ Name of item (displayed) }
                    </i></font>ItemProc <font color="#000080">: </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;     </font><font color="#008000"><i>{ Pointer to procedure to exec }
                    </i></font>ItemHelp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">79</font><font color="#000080">];                    </font><font color="#008000"><i>{ The helpline }
                  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>SubMenuType <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">20</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>SubMenuRecord<font color="#000080">;                 </font><font color="#008000"><i>{ One submenu }
  </i></font>MainMenuRecord <font color="#000080">= </font><font color="#FF0000"><b>record             </b></font><font color="#008000"><i>{ Record used to store main menu items }
                     </i></font>ItemName <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
                     </font>ItemHelp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">79</font><font color="#000080">];
                     </font>SubMenu  <font color="#000080">: </font>SubMenuType<font color="#000080">;      </font><font color="#008000"><i>{ Submenu of this mainmenu }
                   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>MainMenuType <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>MainMenuRecord<font color="#000080">;  </font><font color="#008000"><i>{ The total menu structure }
  </i></font>VRecord <font color="#000080">= </font><font color="#FF0000"><b>record                                       </b></font><font color="#008000"><i>{ Video memory type }
              </i></font>VChar <font color="#000080">: </font>char<font color="#000080">;
              </font>VAttr <font color="#000080">: </font>byte<font color="#000080">;
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>VMemType <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">80</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>VRecord<font color="#000080">;                   </font><font color="#008000"><i>{ Video memory }
  </i></font>TabType <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;                             </font><font color="#008000"><i>{ A table type }
  </i></font>TabType2 <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">20</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;                            </font><font color="#008000"><i>{ A table type }

</i></font><font color="#FF0000"><b>Var
  </b></font>Menu        <font color="#000080">: ^</font>MainMenuType<font color="#000080">;
  </font>XTab        <font color="#000080">: </font>TabType<font color="#000080">;
  </font>SubRemP     <font color="#000080">: </font>TabType2<font color="#000080">;
  </font>ColorMem    <font color="#000080">: </font>VMemType <font color="#FF0000"><b>absolute </b></font><font color="#800000">$B800</font><font color="#000080">:</font><font color="#800000">0000</font><font color="#000080">;
  </font>MonoMem     <font color="#000080">: </font>VMemType <font color="#FF0000"><b>absolute </b></font><font color="#800000">$B000</font><font color="#000080">:</font><font color="#800000">0000</font><font color="#000080">;
  </font>Mono        <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>VideoSegment<font color="#000080">: </font>Word<font color="#000080">;
  </font>OldExit     <font color="#000080">: </font>Pointer<font color="#000080">;
  </font>CommentColor<font color="#000080">: </font>byte<font color="#000080">;                                   </font><font color="#008000"><i>{ Color of helplines }
</i></font><font color="#FF0000"><b>Const
  </b></font>StackMaxMem <font color="#000080">: </font>Byte<font color="#000080">=</font><font color="#800000">10</font><font color="#000080">;

</font><font color="#008000"><i>(* STACKMAXMEM

   This is something to consider, this constant holds the amount of screens
   saved in memory before the unit starts saving on disks. Since I've only
   built in total screen saving, 10 screens will take up 40000 bytes. If
   you need that memory either set it to a lower value or set it to '1'.

*)

</i></font><font color="#FF0000"><b>Function </b></font>GetAttr<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">: </font>Byte<font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{ Get attribute from a position }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetAttr<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Attr<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#008000"><i>{ Set attribute on a position }

</i></font><font color="#FF0000"><b>Procedure </b></font>VWriteCh<font color="#000080">(</font>Ch<font color="#000080">: </font>char<font color="#000080">;</font>x<font color="#000080">,</font>y<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#008000"><i>{ Write a character to the video memory with the attribute stored in
  'textattr'}
</i></font><font color="#FF0000"><b>Procedure </b></font>VWriteStr<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>fg<font color="#000080">,</font>bg<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#008000"><i>{ Write a string to the video memory with the colors 'fg' and 'bg' and
  start writing on 'x', 'y' }
</i></font><font color="#FF0000"><b>Procedure </b></font>Color<font color="#000080">(</font>fg<font color="#000080">,</font>bg<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#008000"><i>{ Set the current colors to 'fg' and 'bg' }

</i></font><font color="#FF0000"><b>Procedure </b></font>DrawBox<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">,</font>bfg<font color="#000080">,</font>bbg<font color="#000080">,</font>wfg<font color="#000080">,</font>wbg<font color="#000080">: </font>byte<font color="#000080">;</font>Title<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>TFG<font color="#000080">,</font>TBG<font color="#000080">:
</font>byte<font color="#000080">);</font><font color="#008000"><i>{ Draw a box, variables are:

  x1,y1,x2,y2: Upper left and lower right corners
  bfg,bbg    : Color of the box
  wfg,wbg    : Color of the inside of the box
  Title      : A title to give to the box, special chars are:
               '!'  - Put title on upper left side
               '@'  - Centre title on upper side
               '#'  - Put title on upper right side
  Tfg,Tbg    : Color of the title

  Example:

  DrawBox(1,1,80,25,11,0,7,0,'!Upper left',15,0);
}

</i></font><font color="#FF0000"><b>Procedure </b></font>ErrorMessage<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#008000"><i>{ Displays an errormessage }
</i></font><font color="#FF0000"><b>Procedure Message</b></font><font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#008000"><i>{ Displays a normal message }
</i></font><font color="#FF0000"><b>Function </b></font>AskBox<font color="#000080">(</font>S<font color="#000080">,</font>T<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>bfg<font color="#000080">,</font>bbg<font color="#000080">,</font>tfg<font color="#000080">,</font>tbg<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Ask a Yes/No question, returns TRUE on yes }

</i></font><font color="#FF0000"><b>Procedure </b></font>CursorOff<font color="#000080">;
</font><font color="#008000"><i>{ Turns cursor off }
</i></font><font color="#FF0000"><b>Procedure </b></font>CursorOn<font color="#000080">;
</font><font color="#008000"><i>{ Turns cursor on }

</i></font><font color="#FF0000"><b>Function </b></font>TopMenu<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{ Start the mainmenu }
</i></font><font color="#FF0000"><b>Procedure </b></font>SubMenu<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Which<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#008000"><i>{ Execute a submenu }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetXTab<font color="#000080">;
</font><font color="#008000"><i>{ Used to get a table for the menu positions }

</i></font><font color="#FF0000"><b>Procedure </b></font>PopScreen<font color="#000080">;
</font><font color="#008000"><i>{ Save a screen to savestack}
</i></font><font color="#FF0000"><b>Procedure </b></font>PushScreen<font color="#000080">;
</font><font color="#008000"><i>{ Restore a screen from savestack }

</i></font><font color="#FF0000"><b>Procedure </b></font>HelpLine<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#008000"><i>{ Prints a helpline on line 25 }
</i></font><font color="#FF0000"><b>Procedure </b></font>ClearHelp<font color="#000080">;
</font><font color="#008000"><i>{ Clear line 25}

</i></font><font color="#FF0000"><b>Implementation
Uses </b></font>Crt<font color="#000080">,</font>Dos<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>SaveCurHi   <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>{ High scan line of cursor }
  </i></font>SaveCurLo   <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>{ Low scanline of cursor }

  </i></font>RemTop      <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>{ Temp save for top menu position }
  </i></font>SaveStack   <font color="#000080">: ^</font>SaveStackType<font color="#000080">; </font><font color="#008000"><i>{ Screen save stack }
  </i></font>SaveStackPtr<font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>{ Screen save stack pointer }

</i></font><font color="#FF0000"><b>Procedure </b></font>WaitKey<font color="#000080">;  </font><font color="#008000"><i>{ Waits for a key }
</i></font><font color="#FF0000"><b>Begin
  </b></font>ReadKey<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FStr<font color="#000080">(</font>A<font color="#000080">: </font>Longint<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#008000"><i>{ Turns a longint to a string }
</i></font><font color="#FF0000"><b>Var
  </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Str<font color="#000080">(</font>A<font color="#000080">,</font>Temp<font color="#000080">);
  </font>FStr <font color="#000080">:=</font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FVal<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>Longint<font color="#000080">; </font><font color="#008000"><i>{ Turns a string into a longint }
</i></font><font color="#FF0000"><b>Var
  </b></font>Temp<font color="#000080">: </font>Longint<font color="#000080">;
  </font>Code<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Val<font color="#000080">(</font>S<font color="#000080">,</font>Temp<font color="#000080">,</font>Code<font color="#000080">);
  </font>FVal <font color="#000080">:=</font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ForceBack<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#008000"><i>{ Adds a '\' to a string if it's not
there }</i></font><font color="#FF0000"><b>Begin
  If </b></font>S<font color="#000080">[</font>length<font color="#000080">(</font>s<font color="#000080">)]&lt;&gt;</font><font color="#800000">'\' </font><font color="#FF0000"><b>then </b></font>S <font color="#000080">:=</font>s<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">;
  </font>ForceBack <font color="#000080">:=</font>s<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LZ<font color="#000080">(</font>w <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Str<font color="#000080">(</font>w<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font>s<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Length<font color="#000080">(</font>s<font color="#000080">)=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>s <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>s<font color="#000080">;
  </font>LZ <font color="#000080">:= </font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ClrScr<font color="#000080">; </font><font color="#008000"><i>{ Clears the screen, keeping the current unit colors }
</i></font><font color="#FF0000"><b>Var
  </b></font>Bak <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Bak <font color="#000080">:=</font>TextAttr<font color="#000080">;
  </font>TextColor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
  </font>TextBackGround<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>Crt<font color="#000080">.</font>ClrScr<font color="#000080">;
  </font>TextAttr <font color="#000080">:=</font>Bak<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Expand<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>Len<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{ Expand a string }
</i></font><font color="#FF0000"><b>Begin
  </b></font>Expand <font color="#000080">:=</font>S<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>S<font color="#000080">)&gt;</font>Len <font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>s<font color="#000080">)&lt;</font>Len <font color="#FF0000"><b>do </b></font>S <font color="#000080">:=</font>S<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
  </font>Expand <font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>BasePath<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{ Get the program's own path }
</i></font><font color="#FF0000"><b>Var
  </b></font>P<font color="#000080">: </font>PathStr<font color="#000080">;
  </font>D<font color="#000080">: </font>DirStr<font color="#000080">;
  </font>N<font color="#000080">: </font>NameStr<font color="#000080">;
  </font>E<font color="#000080">: </font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>P <font color="#000080">:=</font>ParamStr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>FSplit<font color="#000080">(</font>P<font color="#000080">,</font>D<font color="#000080">,</font>N<font color="#000080">,</font>E<font color="#000080">);
  </font>BasePath <font color="#000080">:=</font>ForceBack<font color="#000080">(</font>FExpand<font color="#000080">(</font>D<font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetXTab<font color="#000080">; </font><font color="#008000"><i>{ Set the XTab for the menus }
</i></font><font color="#FF0000"><b>Var
  </b></font>Tel <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  For </b></font>Tel <font color="#000080">:=</font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do </b></font>XTab<font color="#000080">[</font>Tel<font color="#000080">]
:=</font>XTab<font color="#000080">[</font>Tel<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]+</font>Length<font color="#000080">(</font>Menu<font color="#000080">^[</font>Tel<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">].</font>ItemName<font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">;</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PushScreen<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>SaveStackFile <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>VMemType<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>SaveStackPtr<font color="#000080">=</font><font color="#800000">50 </font><font color="#FF0000"><b>then
  Begin
    </b></font>ErrorMessage<font color="#000080">(</font><font color="#800000">'Screen save stack overflow'</font><font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>MaxAvail<font color="#000080">&lt;</font><font color="#800000">10000</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>SaveStackPtr<font color="#000080">&gt;</font>StackMaxMem<font color="#000080">) </font><font color="#FF0000"><b>then
  With </b></font>SaveStack<font color="#000080">^[</font>SaveStackPtr<font color="#000080">] </font><font color="#FF0000"><b>do
  Begin
    </b></font>UseDisk <font color="#000080">:=</font>TRUE<font color="#000080">;
    </font>FName <font color="#000080">:=</font>BasePath<font color="#000080">+</font><font color="#800000">'SAV'</font><font color="#000080">+</font>FStr<font color="#000080">(</font>SaveStackPtr<font color="#000080">)+</font><font color="#800000">'.TMP'</font><font color="#000080">;
    </font>Assign<font color="#000080">(</font>SaveStackFile<font color="#000080">,</font>FName<font color="#000080">);
    </font><font color="#008000"><i>{$i-}
    </i></font>Rewrite<font color="#000080">(</font>SaveStackFile<font color="#000080">);
    </font><font color="#008000"><i>{$i+}
    </i></font><font color="#FF0000"><b>If </b></font>IOResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    Begin
      </b></font>ErrorMessage<font color="#000080">(</font><font color="#800000">'Cannot open temporary file for writing'</font><font color="#000080">);
      </font>Halt<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>Mono <font color="#FF0000"><b>of
      </b></font>TRUE <font color="#000080">: </font>Write<font color="#000080">(</font>SaveStackFile<font color="#000080">,</font>MonoMem<font color="#000080">);
      </font>FALSE<font color="#000080">: </font>Write<font color="#000080">(</font>SaveStackFile<font color="#000080">,</font>ColorMem<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Close<font color="#000080">(</font>SaveStackFile<font color="#000080">);
  </font><font color="#FF0000"><b>End
  Else With </b></font>SaveStack<font color="#000080">^[</font>SaveStackPtr<font color="#000080">] </font><font color="#FF0000"><b>do
  Begin
    </b></font>GetMem<font color="#000080">(</font>MemPtr<font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">);
    </font><font color="#FF0000"><b>Case </b></font>Mono <font color="#FF0000"><b>of
      </b></font>TRUE <font color="#000080">: </font>Move<font color="#000080">(</font>MonoMem<font color="#000080">,</font>MemPtr<font color="#000080">^,</font><font color="#800000">4000</font><font color="#000080">);
      </font>FALSE<font color="#000080">: </font>Move<font color="#000080">(</font>ColorMem<font color="#000080">,</font>MemPtr<font color="#000080">^,</font><font color="#800000">4000</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Inc<font color="#000080">(</font>SaveStackPtr<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PopScreen<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>SaveStackFile <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>VMemType<font color="#000080">;
  </font>Temp          <font color="#000080">: </font>VMemType<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>SaveStackPtr<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
  </font>Dec<font color="#000080">(</font>SaveStackPtr<font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>SaveStack<font color="#000080">^[</font>SaveStackPtr<font color="#000080">] </font><font color="#FF0000"><b>do
  Begin
    If </b></font>UseDisk <font color="#FF0000"><b>then
    Begin
      </b></font>Assign<font color="#000080">(</font>SaveStackFile<font color="#000080">,</font>FName<font color="#000080">);
      </font><font color="#008000"><i>{$i-}
      </i></font>Reset<font color="#000080">(</font>SaveStackFile<font color="#000080">);
      </font><font color="#008000"><i>{$i+}
      </i></font><font color="#FF0000"><b>If </b></font>IOResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
      Begin
        </b></font>ErrorMessage<font color="#000080">(</font><font color="#800000">'Cannot open temporary file for reading'</font><font color="#000080">);
        </font>Halt<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Read<font color="#000080">(</font>SaveStackFile<font color="#000080">,</font>Temp<font color="#000080">);
      </font>Close<font color="#000080">(</font>SaveStackFile<font color="#000080">);
      </font><font color="#FF0000"><b>Case </b></font>Mono <font color="#FF0000"><b>of
        </b></font>TRUE <font color="#000080">: </font>Move<font color="#000080">(</font>Temp<font color="#000080">,</font>MonoMem<font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">);
        </font>FALSE<font color="#000080">: </font>Move<font color="#000080">(</font>Temp<font color="#000080">,</font>ColorMem<font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End else
    Begin
      Case </b></font>Mono <font color="#FF0000"><b>of
        </b></font>TRUE <font color="#000080">: </font>Move<font color="#000080">(</font>MemPtr<font color="#000080">^,</font>MonoMem<font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">);
        </font>FALSE<font color="#000080">: </font>Move<font color="#000080">(</font>MemPtr<font color="#000080">^,</font>ColorMem<font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>FreeMem<font color="#000080">(</font>MemPtr<font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">);
      </font>MemPtr <font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CursorOff<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">MOV           AX,0300h
  MOV           BH,0
  INT           10h
  MOV           [SaveCurHi],CH
  MOV           [SaveCurLo],CL
  MOV           AX,0100h
  MOV           CX,2000h
  INT           10h
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CursorOn<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">MOV           AX,0100h
  MOV           CH,[SaveCurHi]
  MOV           CL,[SaveCurLo]
  INT           10h
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Color<font color="#000080">(</font>fg<font color="#000080">,</font>bg<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>TextColor<font color="#000080">(</font>Fg<font color="#000080">);
  </font>TextBackground<font color="#000080">(</font>bg<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetAttr<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">: </font>Byte<font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  Case </b></font>Mono <font color="#FF0000"><b>of
    </b></font>TRUE <font color="#000080">: </font>GetAttr <font color="#000080">:=</font>MonoMem<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">].</font>VAttr<font color="#000080">;
    </font>FALSE<font color="#000080">: </font>GetAttr <font color="#000080">:=</font>ColorMem<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">].</font>VAttr<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetAttr<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Attr<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  Case </b></font>Mono <font color="#FF0000"><b>of
    </b></font>TRUE <font color="#000080">: </font>MonoMem<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">].</font>VAttr <font color="#000080">:=</font>Attr<font color="#000080">;
    </font>FALSE<font color="#000080">: </font>ColorMem<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">].</font>VAttr <font color="#000080">:=</font>Attr<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>MakeAttr<font color="#000080">(</font>Fg<font color="#000080">,</font>Bg<font color="#000080">: </font>Byte<font color="#000080">): </font>Byte<font color="#000080">; </font><font color="#008000"><i>{ Creates an attribute out of a
foreground/background color }</i></font><font color="#FF0000"><b>Begin
  </b></font>MakeAttr <font color="#000080">:=</font>Fg<font color="#000080">+</font><font color="#800000">16</font><font color="#000080">*</font>Bg<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetAttrRange<font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y<font color="#000080">,</font>Attr<font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#008000"><i>{ Sets the attribute over a range
}</i></font><font color="#FF0000"><b>Var
  </b></font>Tel <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  For </b></font>Tel <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>x2<font color="#000080">-</font>x1 <font color="#FF0000"><b>do </b></font>SetAttr<font color="#000080">(</font>x1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">+</font>Tel<font color="#000080">,</font>Y<font color="#000080">,</font>Attr<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>VWrite<font color="#000080">(</font>Ch<font color="#000080">: </font>char<font color="#000080">;</font>x<font color="#000080">,</font>y<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  Case </b></font>Mono <font color="#FF0000"><b>of
    </b></font>TRUE <font color="#000080">: </font><font color="#FF0000"><b>With </b></font>MonoMem<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">] </font><font color="#FF0000"><b>do
           Begin
             </b></font>VChar <font color="#000080">:=</font>Ch<font color="#000080">;
             </font>VAttr <font color="#000080">:=</font>TextAttr<font color="#000080">;
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>FALSE<font color="#000080">: </font><font color="#FF0000"><b>With </b></font>ColorMem<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">] </font><font color="#FF0000"><b>do
           Begin
             </b></font>VChar <font color="#000080">:=</font>Ch<font color="#000080">;
             </font>VAttr <font color="#000080">:=</font>TextAttr<font color="#000080">;
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>VWriteCh<font color="#000080">(</font>Ch<font color="#000080">: </font>char<font color="#000080">;</font>x<font color="#000080">,</font>y<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>VWrite<font color="#000080">(</font>ch<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>VWriteStr<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>fg<font color="#000080">,</font>bg<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>Tel <font color="#000080">: </font>byte<font color="#000080">;
  </font>Bak <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Bak <font color="#000080">:=</font>TextAttr<font color="#000080">;
  </font>Color<font color="#000080">(</font>Fg<font color="#000080">,</font>Bg<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Tel <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>VWrite<font color="#000080">(</font>S<font color="#000080">[</font>Tel<font color="#000080">],</font>x<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">+</font>tel<font color="#000080">,</font>y<font color="#000080">);
  </font>TextAttr <font color="#000080">:=</font>Bak<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Returns the appropriate shade color for the 'drawbox' routine }
</i></font><font color="#FF0000"><b>Function </b></font>ReturnShade<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">: </font>byte<font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>TA <font color="#000080">: </font>Byte<font color="#000080">;
  </font>FG <font color="#000080">: </font>Byte<font color="#000080">;
  </font>BG <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TA <font color="#000080">:=</font>GetAttr<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
  </font>BG <font color="#000080">:=</font>TA <font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">;
  </font>FG <font color="#000080">:=</font>TA<font color="#000080">-</font>BG<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Fg<font color="#000080">&gt;</font><font color="#800000">8 </font><font color="#FF0000"><b>then
  Begin
    </b></font>Dec<font color="#000080">(</font>Fg<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
    </font>Bg <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>End
  else
  Begin
    </b></font>Fg <font color="#000080">:=</font><font color="#800000">8</font><font color="#000080">;
    </font>Bg <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>ReturnShade <font color="#000080">:=</font>Fg<font color="#000080">+(</font><font color="#800000">16</font><font color="#000080">*</font>Bg<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DrawBox<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">,</font>bfg<font color="#000080">,</font>bbg<font color="#000080">,</font>wfg<font color="#000080">,</font>wbg<font color="#000080">: </font>byte<font color="#000080">;</font>Title<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>TFG<font color="#000080">,</font>TBG<font color="#000080">:
</font>byte<font color="#000080">);</font><font color="#FF0000"><b>Var
  </b></font>Tel<font color="#000080">,</font>Tel2<font color="#000080">: </font>byte<font color="#000080">;
  </font>A<font color="#000080">,</font>B<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>A <font color="#000080">:=</font>WindMax<font color="#000080">;
  </font>B <font color="#000080">:=</font>WindMin<font color="#000080">;
  </font>Color<font color="#000080">(</font>wfg<font color="#000080">,</font>wbg<font color="#000080">);
  </font>Window<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">);
  </font>Crt<font color="#000080">.</font>ClrScr<font color="#000080">;
  </font>WindMax <font color="#000080">:=</font>A<font color="#000080">;
  </font>WindMin <font color="#000080">:=</font>B<font color="#000080">;
  </font>Color<font color="#000080">(</font>bfg<font color="#000080">,</font>bbg<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Tel <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>x2<font color="#000080">-</font>x1 <font color="#FF0000"><b>do
  Begin
    </b></font>VWriteCh<font color="#000080">(</font><font color="#800000">'&Iacute;'</font><font color="#000080">,</font>x1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">+</font>tel<font color="#000080">,</font>y1<font color="#000080">);
    </font>VWriteCh<font color="#000080">(</font><font color="#800000">'&Iacute;'</font><font color="#000080">,</font>x1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">+</font>tel<font color="#000080">,</font>y2<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Tel <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>y2<font color="#000080">-</font>y1 <font color="#FF0000"><b>do
  Begin
    </b></font>Color<font color="#000080">(</font>bfg<font color="#000080">,</font>bbg<font color="#000080">);
    </font>VWriteCh<font color="#000080">(</font><font color="#800000">'&sup3;'</font><font color="#000080">,</font>x1<font color="#000080">,</font>y1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">+</font>tel<font color="#000080">);
    </font>Color<font color="#000080">(</font>bfg<font color="#000080">,</font>bbg<font color="#000080">);
    </font>VWriteCh<font color="#000080">(</font><font color="#800000">'&sup3;'</font><font color="#000080">,</font>x2<font color="#000080">,</font>y1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">+</font>tel<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>VWriteCh<font color="#000080">(</font><font color="#800000">'&frac34;'</font><font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">);
  </font>VWriteCh<font color="#000080">(</font><font color="#800000">'&cedil;'</font><font color="#000080">,</font>x2<font color="#000080">,</font>y1<font color="#000080">);
  </font>VWriteCh<font color="#000080">(</font><font color="#800000">'&Ocirc;'</font><font color="#000080">,</font>x1<font color="#000080">,</font>y2<font color="#000080">);
  </font>VWriteCh<font color="#000080">(</font><font color="#800000">'&Otilde;'</font><font color="#000080">,</font>x1<font color="#000080">,</font>y1<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Tel <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>x2<font color="#000080">-</font>x1 <font color="#FF0000"><b>do </b></font>SetAttr<font color="#000080">(</font>x1<font color="#000080">+</font>Tel<font color="#000080">,</font>y2<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>ReturnShade<font color="#000080">(</font>x1<font color="#000080">+</font>Tel<font color="#000080">,</font>y2<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">));
  </font><font color="#FF0000"><b>For </b></font>Tel <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>y2<font color="#000080">-</font>y1<font color="#000080">)+</font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>SetAttr<font color="#000080">(</font>x2<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y1<font color="#000080">+</font>Tel<font color="#000080">,</font>ReturnShade<font color="#000080">(</font>x2<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y1<font color="#000080">+</font>Tel<font color="#000080">));
  </font><font color="#FF0000"><b>If </b></font>Title<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then
  Begin
    If </b></font>Title<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'!' </font><font color="#FF0000"><b>then </b></font>VWriteStr<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">+</font>Copy<font color="#000080">(</font>Title<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>Length<font color="#000080">(</font>Title<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">''</font><font color="#000080">,</font>Tfg<font color="#000080">,</font>Tbg<font color="#000080">,</font>x1<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>y1<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Title<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'@' </font><font color="#FF0000"><b>then </b></font>VWriteStr<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">+</font>Copy<font color="#000080">(</font>Title<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>Length<font color="#000080">(</font>Title<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">,</font>Tfg<font color="#000080">,</font>Tbg<font color="#000080">,</font>x2<font color="#000080">-</font>Length<font color="#000080">(</font>Title<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">,</font>y1<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Title<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'#' </font><font color="#FF0000"><b>then </b></font>VWriteStr<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">+</font>Copy<font color="#000080">(</font>Title<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>Length<font color="#000080">(</font>Title<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">''</font><font color="#000080">,</font>Tfg<font color="#000080">,</font>Tbg<font color="#000080">,</font>x1<font color="#000080">+((</font>x2<font color="#000080">-</font>x1<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">)-(</font>Length<font color="#000080">(</font>Title<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">),</font>y1<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>HelpLine<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>VWriteStr<font color="#000080">(</font>Expand<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">79</font><font color="#000080">),</font>CommentColor<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ClearHelp<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>VWriteStr<font color="#000080">(</font>Expand<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">79</font><font color="#000080">),</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure Message</b></font><font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Const
  </b></font>Prompt <font color="#000080">= </font><font color="#800000">'Press any key'</font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>A   <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>PushScreen<font color="#000080">;
  </font>ClearHelp<font color="#000080">;
  </font><font color="#FF0000"><b>Message </b></font><font color="#000080">:=</font><font color="#FF0000"><b>Message</b></font><font color="#000080">+</font><font color="#800000">' - '</font><font color="#000080">+</font>Prompt<font color="#000080">;
  </font>A <font color="#000080">:=</font><font color="#800000">40</font><font color="#000080">-(</font>Length<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
  </font>DrawBox<font color="#000080">(</font>a<font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font>a<font color="#000080">+</font>Length<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
  </font>VWriteStr<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font>a<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
  </font>WaitKey<font color="#000080">;
  </font>PopScreen<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ErrorMessage<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Const
  </b></font>Prompt <font color="#000080">= </font><font color="#800000">'Press any key'</font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>A   <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>PushScreen<font color="#000080">;
  </font>ClearHelp<font color="#000080">;
  </font><font color="#FF0000"><b>Message </b></font><font color="#000080">:=</font><font color="#FF0000"><b>Message</b></font><font color="#000080">+</font><font color="#800000">' - '</font><font color="#000080">+</font>Prompt<font color="#000080">;
  </font>A <font color="#000080">:=</font><font color="#800000">40</font><font color="#000080">-(</font>Length<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
  </font>DrawBox<font color="#000080">(</font>a<font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font>a<font color="#000080">+</font>Length<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">'!ERROR'</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
  </font>VWriteStr<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font>a<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
  </font>WaitKey<font color="#000080">;
  </font>PopScreen<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>AskBox<font color="#000080">(</font>S<font color="#000080">,</font>T<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>bfg<font color="#000080">,</font>bbg<font color="#000080">,</font>tfg<font color="#000080">,</font>tbg<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>A   <font color="#000080">: </font>Byte<font color="#000080">;
  </font>Ch  <font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>PushScreen<font color="#000080">;
  </font>A <font color="#000080">:=</font><font color="#800000">40</font><font color="#000080">-(</font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
  </font>DrawBox<font color="#000080">(</font>a<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>a<font color="#000080">+</font>Length<font color="#000080">(</font>S<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font>Bfg<font color="#000080">,</font>Bbg<font color="#000080">,</font>Tfg<font color="#000080">,</font>Tbg<font color="#000080">,</font>T<font color="#000080">,</font>Tfg<font color="#000080">,</font>TBg<font color="#000080">);
  </font>VWriteStr<font color="#000080">(</font>S<font color="#000080">,</font>Tfg<font color="#000080">,</font>Tbg<font color="#000080">,</font>a<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
  </font><font color="#FF0000"><b>Repeat
    </b></font>Ch <font color="#000080">:=</font>UpCase<font color="#000080">(</font>ReadKey<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>Ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'Y'</font><font color="#000080">,</font><font color="#800000">'N'</font><font color="#000080">];
  </font>AskBox <font color="#000080">:=(</font>Ch<font color="#000080">=</font><font color="#800000">'Y'</font><font color="#000080">);
  </font>PopScreen<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Used internally for the submenu's }
</i></font><font color="#FF0000"><b>Function </b></font>GetLastX<font color="#000080">(</font>SubRec<font color="#000080">: </font>SubMenuType<font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Temp <font color="#000080">: </font>Byte<font color="#000080">;
  </font>Tel  <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Temp <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Tel <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">20 </font><font color="#FF0000"><b>do with </b></font>SubRec<font color="#000080">[</font>Tel<font color="#000080">] </font><font color="#FF0000"><b>do If </b></font>ItemName<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then If
</b></font>Length<font color="#000080">(</font>ItemName<font color="#000080">)&gt;</font>Temp <font color="#FF0000"><b>then </b></font>Temp <font color="#000080">:=</font>Length<font color="#000080">(</font>ItemName<font color="#000080">);  </font>GetLastX <font color="#000080">:=</font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Used internally for the submenu's }
</i></font><font color="#FF0000"><b>Function </b></font>GetLastY<font color="#000080">(</font>SubRec<font color="#000080">: </font>SubMenuType<font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Temp <font color="#000080">: </font>Byte<font color="#000080">;
  </font>Tel  <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Temp <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Tel <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">20 </font><font color="#FF0000"><b>do With </b></font>SubRec<font color="#000080">[</font>Tel<font color="#000080">] </font><font color="#FF0000"><b>do If </b></font>ItemName<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>Temp<font color="#000080">);
  </font>GetLastY <font color="#000080">:=</font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Used internally for the main menu }
</i></font><font color="#FF0000"><b>Function </b></font>TopItems<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Tel <font color="#000080">: </font>Byte<font color="#000080">;
  </font>Temp<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Temp <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Tel <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do If </b></font>Menu<font color="#000080">^[</font>Tel<font color="#000080">].</font>ItemName<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>Temp<font color="#000080">);
  </font>TopItems <font color="#000080">:=</font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Draws the main menu }
</i></font><font color="#FF0000"><b>Procedure </b></font>DrawTop<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Tel <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  For </b></font>Tel <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>TopItems <font color="#FF0000"><b>do </b></font>VWriteStr<font color="#000080">(</font>Menu<font color="#000080">^[</font>Tel<font color="#000080">].</font>ItemName<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>XTab<font color="#000080">[</font>Tel<font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Draws a sub menu }
</i></font><font color="#FF0000"><b>Procedure </b></font>DrawMenu<font color="#000080">(</font>Which<font color="#000080">: </font>Byte<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>LastX<font color="#000080">,</font>LastY<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>Tel    <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>LastX <font color="#000080">:=</font>GetLastX<font color="#000080">(</font>Menu<font color="#000080">^[</font>Which<font color="#000080">].</font>SubMenu<font color="#000080">);
  </font>LastY <font color="#000080">:=</font>GetLastY<font color="#000080">(</font>Menu<font color="#000080">^[</font>Which<font color="#000080">].</font>SubMenu<font color="#000080">);
  </font>DrawBox<font color="#000080">(</font>XTab<font color="#000080">[</font>Which<font color="#000080">],</font><font color="#800000">2</font><font color="#000080">,</font>XTab<font color="#000080">[</font>Which<font color="#000080">]+</font>LastX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">+</font>LastY<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Tel <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>LastY <font color="#FF0000"><b>do
</b></font>VWriteStr<font color="#000080">(</font>Menu<font color="#000080">^[</font>Which<font color="#000080">].</font>SubMenu<font color="#000080">[</font>Tel<font color="#000080">].</font>ItemName<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>XTab<font color="#000080">[</font>Which<font color="#000080">]+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">+</font>Tel<font color="#000080">);
</font>DrawTop<font color="#000080">;  </font>VWriteStr<font color="#000080">(</font>Menu<font color="#000080">^[</font>Which<font color="#000080">].</font>ItemName<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>XTab<font color="#000080">[</font>Which<font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SubMenu<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Which<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>MPos  <font color="#000080">: </font>Byte<font color="#000080">;
  </font>OPos  <font color="#000080">: </font>Byte<font color="#000080">;
  </font>LastY <font color="#000080">: </font>Byte<font color="#000080">;
  </font>LastX <font color="#000080">: </font>Byte<font color="#000080">;
  </font>TI    <font color="#000080">: </font>Byte<font color="#000080">;
  </font>OW    <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>DrawTop<font color="#000080">;
  </font>PushScreen<font color="#000080">;
  </font>TI <font color="#000080">:=</font>TopItems<font color="#000080">;
  </font>MPos <font color="#000080">:=</font>SubRemP<font color="#000080">[</font>Which<font color="#000080">];
  </font>OPos <font color="#000080">:=</font>MPos<font color="#000080">;
  </font>OW <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>DrawMenu<font color="#000080">(</font>Which<font color="#000080">,</font>LastX<font color="#000080">,</font>LastY<font color="#000080">);
  </font><font color="#FF0000"><b>While </b></font>True <font color="#FF0000"><b>Do
  Begin

</b></font>VWriteStr<font color="#000080">(</font>Expand<font color="#000080">(</font>Menu<font color="#000080">^[</font>Which<font color="#000080">].</font>SubMenu<font color="#000080">[</font>MPos<font color="#000080">].</font>ItemName<font color="#000080">,</font>LastX<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font>XTab<font color="#000080">[</font>Which<font color="#000080">]+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">+</font>MPos<font color="#000080">);
</font>HelpLine<font color="#000080">(</font>Menu<font color="#000080">^[</font>Which<font color="#000080">].</font>SubMenu<font color="#000080">[</font>MPos<font color="#000080">].</font>ItemHelp<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>MPos<font color="#000080">&lt;&gt;</font>OPos <font color="#FF0000"><b>then
</b></font>VWriteStr<font color="#000080">(</font>Expand<font color="#000080">(</font>menu<font color="#000080">^[</font>Which<font color="#000080">].</font>SubMenu<font color="#000080">[</font>OPos<font color="#000080">].</font>ItemName<font color="#000080">,</font>LastX<font color="#000080">),</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>XTab<font color="#000080">[</font>Which<font color="#000080">]+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2 </font><font color="#000080">+</font>OPos<font color="#000080">);
</font>OPos <font color="#000080">:=</font>MPos<font color="#000080">;    </font>OW <font color="#000080">:=</font>Which<font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>ReadKey <font color="#FF0000"><b>of
      </b></font><font color="#800000">#0</font><font color="#000080">: </font><font color="#FF0000"><b>Case </b></font>ReadKey <font color="#FF0000"><b>of
            </b></font><font color="#800000">#80</font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>MPos<font color="#000080">&lt;</font>LastY <font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>MPos<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>MPos <font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
            </font><font color="#800000">#77</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                   </b></font>PopScreen<font color="#000080">;
                   </font>PushScreen<font color="#000080">;
                   </font>SubRemP<font color="#000080">[</font>Which<font color="#000080">] :=</font>MPos<font color="#000080">;
                   </font><font color="#FF0000"><b>If </b></font>Which<font color="#000080">&lt;</font>TI <font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>Which<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Which <font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
                   </font>DrawMenu<font color="#000080">(</font>Which<font color="#000080">,</font>LastX<font color="#000080">,</font>LastY<font color="#000080">);
                   </font>RemTop <font color="#000080">:=</font>Which<font color="#000080">;
                   </font>MPos <font color="#000080">:=</font>SubRemP<font color="#000080">[</font>Which<font color="#000080">];
                   </font>OPos <font color="#000080">:=</font>MPos<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
            </font><font color="#800000">#75</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                   </b></font>PopScreen<font color="#000080">;
                   </font>PushScreen<font color="#000080">;
                   </font>SubRemP<font color="#000080">[</font>Which<font color="#000080">] :=</font>MPos<font color="#000080">;
                   </font><font color="#FF0000"><b>If </b></font>Which<font color="#000080">&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Dec<font color="#000080">(</font>Which<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Which <font color="#000080">:=</font>TI<font color="#000080">;
                   </font>DrawMenu<font color="#000080">(</font>Which<font color="#000080">,</font>LastX<font color="#000080">,</font>LastY<font color="#000080">);
                   </font>RemTop <font color="#000080">:=</font>Which<font color="#000080">;
                   </font>MPos <font color="#000080">:=</font>SubRemP<font color="#000080">[</font>Which<font color="#000080">];
                   </font>OPos <font color="#000080">:=</font>MPos<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
            </font><font color="#800000">#72</font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>MPos<font color="#000080">&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Dec<font color="#000080">(</font>MPos<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>MPos <font color="#000080">:=</font>LastY<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#800000">#13</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
            </b></font>SubRemP<font color="#000080">[</font>Which<font color="#000080">] :=</font>MPos<font color="#000080">;
            </font>PushScreen<font color="#000080">;
            </font>Menu<font color="#000080">^[</font>Which<font color="#000080">].</font>SubMenu<font color="#000080">[</font>MPos<font color="#000080">].</font>ItemProc<font color="#000080">;
            </font>PopScreen<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#800000">#27</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
            </b></font>SubRemP<font color="#000080">[</font>Which<font color="#000080">] :=</font>MPos<font color="#000080">;
            </font>PopScreen<font color="#000080">;
            </font>Exit<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TopMenu<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>MPos<font color="#000080">,</font>OPos<font color="#000080">: </font>Byte<font color="#000080">;
  </font>TI       <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>DrawTop<font color="#000080">;
  </font>PushScreen<font color="#000080">;
  </font>MPos <font color="#000080">:=</font>RemTop<font color="#000080">;
  </font>OPos <font color="#000080">:=</font>MPos<font color="#000080">;
  </font>TI <font color="#000080">:=</font>TopItems<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>True <font color="#FF0000"><b>do
  Begin
    </b></font>VWriteStr<font color="#000080">(</font>Menu<font color="#000080">^[</font>MPos<font color="#000080">].</font>ItemName<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>XTab<font color="#000080">[</font>MPos<font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);
    </font>HelpLine<font color="#000080">(</font>Menu<font color="#000080">^[</font>MPos<font color="#000080">].</font>ItemHelp<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>OPos<font color="#000080">&lt;&gt;</font>MPos <font color="#FF0000"><b>then </b></font>VWriteStr<font color="#000080">(</font>Menu<font color="#000080">^[</font>OPos<font color="#000080">].</font>ItemName<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>XTab<font color="#000080">[</font>OPos<font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);
    </font>OPos <font color="#000080">:=</font>MPos<font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>ReadKey <font color="#FF0000"><b>of
      </b></font><font color="#800000">#0</font><font color="#000080">: </font><font color="#FF0000"><b>Case </b></font>ReadKey <font color="#FF0000"><b>of
            </b></font><font color="#800000">#77</font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>MPos<font color="#000080">&lt;</font>TI <font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>MPos<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>MPos <font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
            </font><font color="#800000">#75</font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>MPos<font color="#000080">&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Dec<font color="#000080">(</font>MPos<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>MPos <font color="#000080">:=</font>TI<font color="#000080">;
            </font><font color="#800000">#80</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                   </b></font>TopMenu <font color="#000080">:=</font>MPos<font color="#000080">;
                   </font>RemTop <font color="#000080">:=</font>MPos<font color="#000080">;
                   </font>Exit<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#800000">#13</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
            </b></font>TopMenu <font color="#000080">:=</font>MPos<font color="#000080">;
            </font>RemTop <font color="#000080">:=</font>MPos<font color="#000080">;
            </font>Exit<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ExitProcedure<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Tel <font color="#000080">: </font>byte<font color="#000080">;
  </font>T   <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Color<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font>Crt<font color="#000080">.</font>ClrScr<font color="#000080">;
  </font>CursorOn<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Tel <font color="#000080">: </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  Case </b></font>LastMode <font color="#FF0000"><b>of
    </b></font><font color="#800000">7</font><font color="#000080">: </font>VideoSegment <font color="#000080">:=</font><font color="#800000">$B000</font><font color="#000080">;
    </font><font color="#800000">3</font><font color="#000080">: </font>VideoSegment <font color="#000080">:=</font><font color="#800000">$B800</font><font color="#000080">;
    </font><font color="#FF0000"><b>else </b></font>VideoSegment <font color="#000080">:=</font><font color="#800000">$B800</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>OldExit <font color="#000080">:=</font>ExitProc<font color="#000080">;
  </font>ExitProc <font color="#000080">:=@</font>ExitProcedure<font color="#000080">;
  </font>CursorOff<font color="#000080">;
  </font>SaveStackPtr <font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>XTab<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] :=</font><font color="#800000">2</font><font color="#000080">;
  </font>FillChar<font color="#000080">(</font>SubRemP<font color="#000080">,</font>SizeOf<font color="#000080">(</font>SubRemP<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
  </font>RemTop <font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>New<font color="#000080">(</font>Menu<font color="#000080">);
  </font>New<font color="#000080">(</font>SaveStack<font color="#000080">);
  </font>FillChar<font color="#000080">(</font>SaveStack<font color="#000080">^,</font>SizeOf<font color="#000080">(</font>SaveStack<font color="#000080">^),</font><font color="#800000">0</font><font color="#000080">);
  </font>FillChar<font color="#000080">(</font>Menu<font color="#000080">^,</font>SizeOf<font color="#000080">(</font>Menu<font color="#000080">^),</font><font color="#800000">0</font><font color="#000080">);
  </font>CommentColor <font color="#000080">:=</font><font color="#800000">7</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MENU SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p></body>
</html>
