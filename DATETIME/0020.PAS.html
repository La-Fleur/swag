<html>
<head><title> "OOP Calendar Unit" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>CalUnit<font color="#000080">;
</font><font color="#008000"><i>{ Object oriented calander unit }

</i></font><font color="#FF0000"><b>INTERFACE

USES </b></font>CRT<font color="#000080">,</font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>Calendar <font color="#000080">= </font><font color="#FF0000"><b>OBJECT
    </b></font>ThisMonth<font color="#000080">, </font>ThisYear <font color="#000080">: </font>Word<font color="#000080">;
    </font><font color="#FF0000"><b>CONSTRUCTOR </b></font>Init<font color="#000080">(</font>Month<font color="#000080">, </font>Year<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>PROCEDURE        </b></font>DrawCalendar<font color="#000080">;
    </font><font color="#FF0000"><b>PROCEDURE        </b></font>SetMonth<font color="#000080">(</font>Month<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>PROCEDURE        </b></font>SetYear<font color="#000080">(</font>Year<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>FUNCTION        </b></font>GetMonth<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>FUNCTION        </b></font>GetYear<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>DESTRUCTOR        </b></font>Done<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

CONSTRUCTOR </b></font>Calendar<font color="#000080">.</font>Init<font color="#000080">(</font>Month<font color="#000080">, </font>Year<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
   </b></font>SetYear<font color="#000080">(</font>Year<font color="#000080">);
   </font>SetMonth<font color="#000080">(</font>Month<font color="#000080">);
   </font>DrawCalendar<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Calendar<font color="#000080">.</font>DrawCalendar<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>CurYear<font color="#000080">,</font>CurMonth<font color="#000080">,</font>CurDay<font color="#000080">,</font>CurDow<font color="#000080">,
  </font>ThisDay<font color="#000080">,</font>ThisDOW    <font color="#000080">: </font>Word<font color="#000080">;
  </font>I<font color="#000080">,</font>DayPos<font color="#000080">,</font>NbrDays   <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>DOM<font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte <font color="#000080">=
       (</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">);
  </font>MonthName<font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>OF String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] =
       (</font><font color="#800000">'Jan'</font><font color="#000080">,</font><font color="#800000">'Feb'</font><font color="#000080">,</font><font color="#800000">'Mar'</font><font color="#000080">,</font><font color="#800000">'Apr'</font><font color="#000080">,</font><font color="#800000">'May'</font><font color="#000080">,</font><font color="#800000">'Jun'</font><font color="#000080">,
        </font><font color="#800000">'Jul'</font><font color="#000080">,</font><font color="#800000">'Aug'</font><font color="#000080">,</font><font color="#800000">'Sep'</font><font color="#000080">,</font><font color="#800000">'Oct'</font><font color="#000080">,</font><font color="#800000">'Nov'</font><font color="#000080">,</font><font color="#800000">'Dec'</font><font color="#000080">);

</font><font color="#FF0000"><b>BEGIN

  </b></font>GetDate<font color="#000080">(</font>CurYear<font color="#000080">,</font>CurMonth<font color="#000080">,</font>CurDay<font color="#000080">,</font>CurDow<font color="#000080">);

  </font><font color="#008000"><i>{Set to day 1 so we can use GetDate function}
  </i></font>ThisDay <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

  </font>SetDate<font color="#000080">(</font>ThisYear<font color="#000080">,</font>ThisMonth<font color="#000080">,</font>ThisDay<font color="#000080">);

  </font><font color="#008000"><i>{ThisDOW stands for This day of the week}

  </i></font>GetDate<font color="#000080">(</font>ThisYear<font color="#000080">,</font>ThisMonth<font color="#000080">,</font>ThisDay<font color="#000080">,</font>ThisDOW<font color="#000080">);

  </font>SetDate<font color="#000080">(</font>CurYear<font color="#000080">,</font>CurMonth<font color="#000080">,</font>CurDay<font color="#000080">);

  </font>WriteLn<font color="#000080">(</font><font color="#800000">'           '</font><font color="#000080">,</font>MonthName<font color="#000080">[</font>ThisMonth<font color="#000080">],
          </font><font color="#800000">' '</font><font color="#000080">,</font>ThisYear<font color="#000080">);
  </font>WriteLn<font color="#000080">;
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'   S   M   T   W   R   F   S'</font><font color="#000080">);

  </font>NbrDays <font color="#000080">:= </font>DOM<font color="#000080">[</font>ThisMonth<font color="#000080">];

  </font><font color="#008000"><i>{Check for leap year, which occurs when the
   year is evenly divisible by 4 and not evenly
   divisable by 100 or if the year is evenly
   divisable by 400}

  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>ThisMonth <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>AND
     </b></font><font color="#000080">((</font>ThisYear <font color="#FF0000"><b>MOD </b></font><font color="#800000">4 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
      </b></font><font color="#000080">(</font>ThisYear <font color="#FF0000"><b>MOD </b></font><font color="#800000">100 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">))
     </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>ThisYear <font color="#FF0000"><b>MOD </b></font><font color="#800000">400 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">))
   </font><font color="#FF0000"><b>THEN </b></font>NbrDays <font color="#000080">:= </font><font color="#800000">29</font><font color="#000080">;

  </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>NbrDays <font color="#FF0000"><b>DO
    BEGIN
      </b></font>DayPos <font color="#000080">:= </font>ThisDOW <font color="#000080">* </font><font color="#800000">4 </font><font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;  </font><font color="#008000"><i>{Position day #}
      </i></font>GotoXY<font color="#000080">(</font>DayPos<font color="#000080">,</font>WhereY<font color="#000080">);
      </font>Inc<font color="#000080">(</font>ThisDOW<font color="#000080">);
      </font>Write<font color="#000080">(</font>I<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>ThisDOW <font color="#000080">&gt; </font><font color="#800000">6 </font><font color="#FF0000"><b>THEN
        BEGIN
          </b></font>ThisDOW <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>WriteLn
        <font color="#FF0000"><b>END
    END</b></font><font color="#000080">;
    </font>WriteLn
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Calendar<font color="#000080">.</font>SetMonth<font color="#000080">(</font>Month<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
   </b></font>ThisMonth <font color="#000080">:= </font>Month<font color="#000080">;
   </font><font color="#FF0000"><b>WHILE </b></font>ThisMonth <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
   BEGIN
      </b></font>Dec<font color="#000080">(</font>ThisYear<font color="#000080">);
      </font>Inc<font color="#000080">(</font>ThisMonth<font color="#000080">, </font><font color="#800000">12</font><font color="#000080">);
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>WHILE </b></font>ThisMonth <font color="#000080">&gt; </font><font color="#800000">12 </font><font color="#FF0000"><b>DO
   BEGIN
      </b></font>Inc<font color="#000080">(</font>ThisYear<font color="#000080">);
      </font>Dec<font color="#000080">(</font>ThisMonth<font color="#000080">, </font><font color="#800000">12</font><font color="#000080">);
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Calendar<font color="#000080">.</font>SetYear<font color="#000080">(</font>Year<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
   </b></font>ThisYear <font color="#000080">:= </font>Year<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Calendar<font color="#000080">.</font>GetMonth<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   </b></font>GetMonth <font color="#000080">:= </font>ThisMonth<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Calendar<font color="#000080">.</font>GetYear<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   </b></font>GetYear <font color="#000080">:= </font>ThisYear<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>DESTRUCTOR </b></font>Calendar<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   </b></font><font color="#008000"><i>{for dynamic object instances,
     the Done method still works even
     though it contains nothing except
     the destructor declaration              }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ---------------------------    TEST PROGRAM ---------------------}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>CalTest<font color="#000080">;

</font><font color="#FF0000"><b>USES </b></font>DOS<font color="#000080">,</font>CRT<font color="#000080">,</font>CalUnit<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>MyCalendar<font color="#000080">: </font>Calendar<font color="#000080">;
   </font>TYear<font color="#000080">,</font>TMonth<font color="#000080">,</font>Tday<font color="#000080">,</font>TDOW<font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
   </b></font>ClrScr<font color="#000080">;
   </font>GetDate<font color="#000080">(</font>TYear<font color="#000080">,</font>TMonth<font color="#000080">,</font>Tday<font color="#000080">,</font>TDOW<font color="#000080">);
   </font><font color="#FF0000"><b>WITH </b></font>MyCalendar <font color="#FF0000"><b>DO
   BEGIN
      </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'    Current Month''s Calendar'</font><font color="#000080">);
      </font>WriteLn<font color="#000080">;
      </font>Init<font color="#000080">(</font>TMonth<font color="#000080">, </font>TYear<font color="#000080">);
      </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>TMonth <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
        BEGIN
          </b></font>WriteLn<font color="#000080">;
          </font>WriteLn<font color="#000080">(</font><font color="#800000">'   Enter a Month and Year'</font><font color="#000080">);
          </font>WriteLn<font color="#000080">(</font><font color="#800000">'(Separate values by a space)'</font><font color="#000080">);
          </font>WriteLn<font color="#000080">;
          </font>WriteLn<font color="#000080">(</font><font color="#800000">'      exm.      3 1990'</font><font color="#000080">);
          </font>WriteLn<font color="#000080">;
          </font>Write         <font color="#000080">(</font><font color="#800000">'   or 0 0 to quit: '</font><font color="#000080">);
          </font>ReadLn<font color="#000080">(</font>TMonth<font color="#000080">, </font>TYear<font color="#000080">);
          </font><font color="#FF0000"><b>IF </b></font>TMonth <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
             BEGIN
               </b></font>ClrScr<font color="#000080">;
               </font>SetYear<font color="#000080">(</font>TYear<font color="#000080">);
               </font>SetMonth<font color="#000080">(</font>TMonth<font color="#000080">);
               </font>DrawCalendar
             <font color="#FF0000"><b>END
        END
   END</b></font><font color="#000080">;
   </font>ClrScr
<font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p></body>
</html>
