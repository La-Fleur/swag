<html>
<head><title> "DATE3.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>Gregorian<font color="#000080">;              </font><font color="#008000"><i>{ Julian day to Gregorian date      }
</i></font><font color="#FF0000"><b>Uses    </b></font>Crt<font color="#000080">;                    </font><font color="#008000"><i>{ Turbo/Quick Pascal                }
</i></font><font color="#FF0000"><b>Type    </b></font>String3         <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
        </font>String9         <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">];
</font><font color="#FF0000"><b>Const   </b></font>MonthName       <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>String3 <font color="#000080">=
                          (</font><font color="#800000">'Jan'</font><font color="#000080">,</font><font color="#800000">'Feb'</font><font color="#000080">,</font><font color="#800000">'Mar'</font><font color="#000080">,</font><font color="#800000">'Apr'</font><font color="#000080">,</font><font color="#800000">'May'</font><font color="#000080">,</font><font color="#800000">'Jun'</font><font color="#000080">,
                           </font><font color="#800000">'Jul'</font><font color="#000080">,</font><font color="#800000">'Aug'</font><font color="#000080">,</font><font color="#800000">'Sep'</font><font color="#000080">,</font><font color="#800000">'Oct'</font><font color="#000080">,</font><font color="#800000">'Nov'</font><font color="#000080">,</font><font color="#800000">'Dec'</font><font color="#000080">);
        </font>DayName         <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>String9 <font color="#000080">=
                          (</font><font color="#800000">'Sunday'</font><font color="#000080">,</font><font color="#800000">'Monday'</font><font color="#000080">,</font><font color="#800000">'Tuesday'</font><font color="#000080">,</font><font color="#800000">'Wednesday'</font><font color="#000080">,
                           </font><font color="#800000">'Thursday'</font><font color="#000080">,</font><font color="#800000">'Friday'</font><font color="#000080">,</font><font color="#800000">'Saturday'</font><font color="#000080">);
</font><font color="#FF0000"><b>Var     </b></font>Day<font color="#000080">, </font>JulianDay<font color="#000080">, </font>F       <font color="#000080">: </font>Real<font color="#000080">;
        </font>Month                   <font color="#000080">: </font>Byte<font color="#000080">;
        </font>Year                    <font color="#000080">: </font>Integer<font color="#000080">;
        </font>A<font color="#000080">, </font>B<font color="#000080">, </font>C<font color="#000080">, </font>D<font color="#000080">, </font>E<font color="#000080">, </font>G<font color="#000080">, </font>Z     <font color="#000080">: </font>LongInt<font color="#000080">;
        </font>LeapYear                <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>DayofWeek<font color="#000080">( </font>Month <font color="#000080">: </font>Byte<font color="#000080">; </font>Day <font color="#000080">: </font>Real<font color="#000080">; </font>Year <font color="#000080">: </font>Integer <font color="#000080">): </font>Byte<font color="#000080">;
        </font><font color="#FF0000"><b>Var     </b></font>iVar1<font color="#000080">, </font>iVar2    <font color="#000080">: </font>Integer<font color="#000080">;
        </font><font color="#FF0000"><b>begin
                </b></font>iVar1 <font color="#000080">:= </font>Year <font color="#FF0000"><b>MOD </b></font><font color="#800000">100</font><font color="#000080">;
                </font>iVar2 <font color="#000080">:= </font>TRUNC<font color="#000080">( </font>Day <font color="#000080">) + </font>iVar1 <font color="#000080">+ </font>iVar1 <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">;
                </font><font color="#FF0000"><b>Case </b></font>Month <font color="#FF0000"><b>of
                        </b></font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">7    </font><font color="#000080">: </font>iVar1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                        </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">10   </font><font color="#000080">: </font>iVar1 <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                        </font><font color="#800000">5       </font><font color="#000080">: </font>iVar1 <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                        </font><font color="#800000">8       </font><font color="#000080">: </font>iVar1 <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
                        </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">11  </font><font color="#000080">: </font>iVar1 <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
                        </font><font color="#800000">6       </font><font color="#000080">: </font>iVar1 <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
                        </font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">12    </font><font color="#000080">: </font>iVar1 <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
                        </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Case}
                </i></font>iVar2 <font color="#000080">:= ( </font>iVar1 <font color="#000080">+ </font>iVar2 <font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">7</font><font color="#000080">;
                </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>iVar2 <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>iVar2 <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
                </font>DayofWeek <font color="#000080">:= </font>Byte<font color="#000080">( </font>iVar2 <font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{DayofWeek}

</i></font><font color="#FF0000"><b>Function </b></font>DayofTheYear<font color="#000080">( </font>Month <font color="#000080">: </font>Byte<font color="#000080">; </font>DAY <font color="#000080">: </font>Real <font color="#000080">): </font>Integer<font color="#000080">;
        </font><font color="#FF0000"><b>Var     </b></font>N       <font color="#000080">: </font>Integer<font color="#000080">;
        </font><font color="#FF0000"><b>begin
                if </b></font>LeapYear  <font color="#FF0000"><b>then </b></font>N <font color="#000080">:= </font><font color="#800000">1  </font><font color="#FF0000"><b>else </b></font>N <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                </font>N <font color="#000080">:= </font><font color="#800000">275 </font><font color="#000080">* </font>Month <font color="#FF0000"><b>div </b></font><font color="#800000">9
                     </font><font color="#000080">- </font>N <font color="#000080">* (( </font>Month <font color="#000080">+ </font><font color="#800000">9 </font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">12</font><font color="#000080">)
                     + </font>TRUNC<font color="#000080">( </font>Day <font color="#000080">) - </font><font color="#800000">30</font><font color="#000080">;
                </font>DayofTheYear <font color="#000080">:= </font>N<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{DayofTheYear}

</i></font><font color="#FF0000"><b>begin   </b></font><font color="#008000"><i>{Gregorian}
        </i></font>ClrScr<font color="#000080">;
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'Gregorian dates v0.0 Dec.91 Greg Vigneault'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'[Enter Julian day values]'</font><font color="#000080">);

        </font><font color="#FF0000"><b>Repeat  </b></font>WriteLn<font color="#000080">;
                </font>Write<font color="#000080">(</font><font color="#800000">'Enter (positive) Julian day number: '</font><font color="#000080">);
                </font>ReadLn<font color="#000080">( </font>JulianDay <font color="#000080">);
        </font><font color="#FF0000"><b>Until   </b></font><font color="#000080">( </font>JulianDay <font color="#000080">&gt;= </font><font color="#800000">706.0 </font><font color="#000080">);

        </font>JulianDay <font color="#000080">:= </font>JulianDay <font color="#000080">+ </font><font color="#800000">0.5</font><font color="#000080">;
        </font>Z <font color="#000080">:= </font>TRUNC<font color="#000080">( </font>JulianDay <font color="#000080">);   </font>F <font color="#000080">:= </font>FRAC<font color="#000080">( </font>JulianDay <font color="#000080">);

        </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>Z <font color="#000080">&lt; </font><font color="#800000">2299161 </font><font color="#000080">)
        </font><font color="#FF0000"><b>then    </b></font>A <font color="#000080">:= </font>Z
        <font color="#FF0000"><b>else    begin   </b></font>G <font color="#000080">:= </font>TRUNC<font color="#000080">( ( </font>Z <font color="#000080">- </font><font color="#800000">1867216.25 </font><font color="#000080">) / </font><font color="#800000">36524.25</font><font color="#000080">);
                        </font>A <font color="#000080">:= </font>Z <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">+ </font>G <font color="#000080">- </font>G <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}

        </i></font>B <font color="#000080">:= </font>A <font color="#000080">+ </font><font color="#800000">1524</font><font color="#000080">;  </font>C <font color="#000080">:= </font>TRUNC<font color="#000080">( ( </font>B <font color="#000080">- </font><font color="#800000">122.1 </font><font color="#000080">) / </font><font color="#800000">365.25 </font><font color="#000080">);
        </font>D <font color="#000080">:= </font>TRUNC<font color="#000080">( </font><font color="#800000">365.25 </font><font color="#000080">* </font>C <font color="#000080">);  </font>E <font color="#000080">:= </font>TRUNC<font color="#000080">( ( </font>B <font color="#000080">- </font>D <font color="#000080">) / </font><font color="#800000">30.6001 </font><font color="#000080">);

        </font>Day <font color="#000080">:= </font>B <font color="#000080">- </font>D <font color="#000080">- </font>TRUNC<font color="#000080">( </font><font color="#800000">30.6001 </font><font color="#000080">* </font>E <font color="#000080">) + </font>F<font color="#000080">;

        </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>E <font color="#000080">&lt; </font><font color="#800000">13.5 </font><font color="#000080">)
        </font><font color="#FF0000"><b>then </b></font>Month <font color="#000080">:= </font>Byte<font color="#000080">( </font>E <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">)
        </font><font color="#FF0000"><b>else if </b></font><font color="#000080">( </font>E <font color="#000080">&gt; </font><font color="#800000">13.5 </font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Month <font color="#000080">:= </font>Byte<font color="#000080">( </font>E <font color="#000080">- </font><font color="#800000">13 </font><font color="#000080">);

        </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>Month <font color="#000080">&gt; </font><font color="#800000">2.5 </font><font color="#000080">)
        </font><font color="#FF0000"><b>then </b></font>Year <font color="#000080">:= </font>Integer<font color="#000080">( </font>C <font color="#000080">- </font><font color="#800000">4716 </font><font color="#000080">)
        </font><font color="#FF0000"><b>else if </b></font><font color="#000080">( </font>Month <font color="#000080">&lt; </font><font color="#800000">2.5 </font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Year <font color="#000080">:= </font>Integer<font color="#000080">( </font>C <font color="#000080">- </font><font color="#800000">4715 </font><font color="#000080">);

        </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>Year <font color="#FF0000"><b>MOD </b></font><font color="#800000">100</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>Year <font color="#FF0000"><b>MOD </b></font><font color="#800000">4</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)
                </font><font color="#FF0000"><b>then    </b></font>LeapYear <font color="#000080">:= </font>True
                <font color="#FF0000"><b>else    </b></font>LeapYear <font color="#000080">:= </font>False<font color="#000080">;

        </font>Write<font color="#000080">(</font><font color="#800000">#10</font><font color="#000080">,</font><font color="#800000">'Gregorian '</font><font color="#000080">); </font><font color="#FF0000"><b>if </b></font>LeapYear <font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">'LeapYear '</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'date is '</font><font color="#000080">,</font>DayName<font color="#000080">[</font>DayofWeek<font color="#000080">(</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>Year<font color="#000080">)],
                </font><font color="#800000">', '</font><font color="#000080">,</font>MonthName<font color="#000080">[ </font>Month <font color="#000080">],</font><font color="#800000">' '</font><font color="#000080">,</font>Day<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">','</font><font color="#000080">,</font>Year<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,
                 </font><font color="#800000">' (day of year= '</font><font color="#000080">,</font>DayofTheYear<font color="#000080">(</font>Month<font color="#000080">,</font>Day<font color="#000080">),</font><font color="#800000">')'</font><font color="#000080">,</font><font color="#800000">#10</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">. </font><font color="#008000"><i>{Gregorian}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p></body>
</html>
