<html>
<head><title> "Calculate Day Of Week" by EARL DUNOVANT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
EARL DUNOVANT

&gt; Which date is what day For a particular month.

Zeller's Congruence is an algorithm that calculates a day of the week given
a year, month and day. Created in 1887(!). Jeff Duntemann of PC Techniques
fame implemented it in TP in the 11/90 issue of Dr Dobbs Journal, With a
(115 min left), (H)elp, More? major kludge because TP's MOD operator returns a remainder instead of a
True mathematical modulus. I added the Kludge Alert banner that I use in my
own code.
}

</i></font><font color="#FF0000"><b>Function </b></font>CalcDayOfWeek<font color="#000080">(</font>Year<font color="#000080">, </font>Month<font color="#000080">, </font>Day <font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Century<font color="#000080">,
  </font>Holder  <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ First test For error conditions on input values: }
  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Year <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Month <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Month <font color="#000080">&gt; </font><font color="#800000">12</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Day <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Day <font color="#000080">&gt; </font><font color="#800000">31</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>CalcDayOfWeek <font color="#000080">:= -</font><font color="#800000">1  </font><font color="#008000"><i>{ Return -1 to indicate an error }
  </i></font><font color="#FF0000"><b>else
  </b></font><font color="#008000"><i>{ Do the Zeller's Congruence calculation as Zeller himself }
  { described it in &quot;Acta Mathematica&quot; #7, Stockhold, 1887.  }
  </i></font><font color="#FF0000"><b>begin
    </b></font><font color="#008000"><i>{ First we separate out the year and the century figures: }
    </i></font>Century <font color="#000080">:= </font>Year <font color="#FF0000"><b>div </b></font><font color="#800000">100</font><font color="#000080">;
    </font>Year    <font color="#000080">:= </font>Year <font color="#FF0000"><b>MOD </b></font><font color="#800000">100</font><font color="#000080">;
    </font><font color="#008000"><i>{ Next we adjust the month such that March remains month #3, }
    { but that January and February are months #13 and #14,     }
    { *but of the previous year*: }
    </i></font><font color="#FF0000"><b>if </b></font>Month <font color="#000080">&lt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then
    begin
      </b></font>Inc<font color="#000080">(</font>Month<font color="#000080">, </font><font color="#800000">12</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>Year <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>Dec<font color="#000080">(</font>Year<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">)      </font><font color="#008000"><i>{ The year before 2000 is }
      </i></font><font color="#FF0000"><b>else              </b></font><font color="#008000"><i>{ 1999, not 20-1...       }
      </i></font><font color="#FF0000"><b>begin
        </b></font>Year <font color="#000080">:= </font><font color="#800000">99</font><font color="#000080">;
        </font>Dec<font color="#000080">(</font>Century<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#008000"><i>{ Here's Zeller's seminal black magic: }
    </i></font>Holder <font color="#000080">:= </font>Day<font color="#000080">;                        </font><font color="#008000"><i>{ Start With the day of month }
    </i></font>Holder <font color="#000080">:= </font>Holder <font color="#000080">+ (((</font>Month <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) * </font><font color="#800000">26</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">10</font><font color="#000080">); </font><font color="#008000"><i>{ Calc the increment }
    </i></font>Holder <font color="#000080">:= </font>Holder <font color="#000080">+ </font>Year<font color="#000080">;              </font><font color="#008000"><i>{ Add in the year }
    </i></font>Holder <font color="#000080">:= </font>Holder <font color="#000080">+ (</font>Year <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">);      </font><font color="#008000"><i>{ Correct For leap years  }
    </i></font>Holder <font color="#000080">:= </font>Holder <font color="#000080">+ (</font>Century <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">);   </font><font color="#008000"><i>{ Correct For century years }
    </i></font>Holder <font color="#000080">:= </font>Holder <font color="#000080">- </font>Century <font color="#000080">- </font>Century<font color="#000080">; </font><font color="#008000"><i>{ DON'T KNOW WHY HE DID THIS! }
    {***********************KLUDGE ALERT!***************************}
    </i></font><font color="#FF0000"><b>While </b></font>Holder <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do                   </b></font><font color="#008000"><i>{ Get negative values up into }
      </i></font>Inc<font color="#000080">(</font>Holder<font color="#000080">, </font><font color="#800000">7</font><font color="#000080">);                     </font><font color="#008000"><i>{ positive territory before   }
                                          { taking the MOD...         }
    </i></font>Holder <font color="#000080">:= </font>Holder <font color="#FF0000"><b>MOD </b></font><font color="#800000">7</font><font color="#000080">;               </font><font color="#008000"><i>{ Divide by 7 but keep the  }
                                          { remainder rather than the }
                                          { quotient }
    {***********************KLUDGE ALERT!***************************}
    { Here we &quot;wrap&quot; Saturday around to be the last day: }
    </i></font><font color="#FF0000"><b>if </b></font>Holder <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Holder <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;

    </font><font color="#008000"><i>{ Zeller kept the Sunday = 1 origin; computer weenies prefer to }
    { start everything With 0, so here's a 20th century kludge:     }
    </i></font>Dec<font color="#000080">(</font>Holder<font color="#000080">);

    </font>CalcDayOfWeek <font color="#000080">:= </font>Holder<font color="#000080">;  </font><font color="#008000"><i>{ Return the end product! }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p></body>
</html>
