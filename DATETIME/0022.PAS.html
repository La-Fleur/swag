<html>
<head><title> "Another Day of the Week" by KELLY SMALL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">===========================================================================
 </font>BBS<font color="#000080">: </font>The Beta Connection
Date<font color="#000080">: </font><font color="#800000">06</font><font color="#000080">-</font><font color="#800000">07</font><font color="#000080">-</font><font color="#800000">93 </font><font color="#000080">(</font><font color="#800000">18</font><font color="#000080">:</font><font color="#800000">50</font><font color="#000080">)             </font>Number<font color="#000080">: </font><font color="#800000">823
</font>From<font color="#000080">: </font>KELLY SMALL                  Refer<font color="#800000">#</font><font color="#000080">: </font><font color="#800000">744
  </font><font color="#FF0000"><b>To</b></font><font color="#000080">: </font>STEPHEN WHITIS                Recvd<font color="#000080">: </font>NO  
Subj<font color="#000080">: </font>DATE CALCULATIONS              Conf<font color="#000080">: (</font><font color="#800000">232</font><font color="#000080">) </font>T_Pascal_R
<font color="#000080">---------------------------------------------------------------------------
 </font>SW<font color="#000080">&sup3; </font>Does anyone know where I can find an algorithm<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>better yet TP
 SW<font color="#000080">&sup3; </font><font color="#800000">5.5 </font>code<font color="#000080">, </font><font color="#FF0000"><b>to </b></font>calculate the day <font color="#FF0000"><b>of </b></font>the week <font color="#FF0000"><b>for </b></font>a give date<font color="#000080">?

</font>Give this a whirl<font color="#000080">:

</font><font color="#FF0000"><b>function </b></font>LeapYearOffset<font color="#000080">(</font>M<font color="#000080">,</font>Y<font color="#000080">:</font>Word<font color="#000080">):</font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
  if </b></font><font color="#000080">((</font>Y <font color="#FF0000"><b>mod </b></font><font color="#800000">400 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">((</font>Y <font color="#FF0000"><b>mod </b></font><font color="#800000">100 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Y <font color="#FF0000"><b>mod </b></font><font color="#800000">4 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)))
        </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>M <font color="#000080">&gt; </font><font color="#800000">2</font><font color="#000080">)
    </font><font color="#FF0000"><b>then </b></font>LeapYearOffset <font color="#000080">:= </font><font color="#800000">1
    </font><font color="#FF0000"><b>else </b></font>LeapYearOffset <font color="#000080">:= </font><font color="#800000">0
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>DaysinMonth<font color="#000080">(</font>dMonth<font color="#000080">,</font>dYear<font color="#000080">:</font>Word<font color="#000080">):</font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
  case </b></font>dMonth <font color="#FF0000"><b>of
    </b></font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">12 </font><font color="#000080">: </font>DaysInMonth <font color="#000080">:= </font><font color="#800000">31</font><font color="#000080">;
    </font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">11        </font><font color="#000080">: </font>DaysInMonth <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;
    </font><font color="#800000">2               </font><font color="#000080">: </font>DaysInMonth <font color="#000080">:= </font><font color="#800000">28 </font><font color="#000080">+ </font>LeapYearOffset<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">,</font>dYear<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FindDayOfWeek<font color="#000080">(</font>Day<font color="#000080">, </font>Month<font color="#000080">, </font>Year<font color="#000080">: </font>Integer<font color="#000080">) : </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>century<font color="#000080">, </font>yr<font color="#000080">, </font>dw<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Month <font color="#000080">&lt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then
  begin
    </b></font>Inc<font color="#000080">(</font>Month<font color="#000080">, </font><font color="#800000">10</font><font color="#000080">);
    </font>Dec<font color="#000080">(</font>Year<font color="#000080">);
  </font><font color="#FF0000"><b>end
  else
     </b></font>Dec<font color="#000080">(</font>Month<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
  </font>century <font color="#000080">:= </font>Year <font color="#FF0000"><b>div </b></font><font color="#800000">100</font><font color="#000080">;
  </font>yr <font color="#000080">:= </font>year <font color="#FF0000"><b>mod </b></font><font color="#800000">100</font><font color="#000080">;
  </font>dw <font color="#000080">:= (((</font><font color="#800000">26 </font><font color="#000080">* </font>month <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">10</font><font color="#000080">) + </font>day <font color="#000080">+ </font>yr <font color="#000080">+ (</font>yr <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">) +
    (</font>century <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">) - (</font><font color="#800000">2 </font><font color="#000080">* </font>century<font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">7</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>dw <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>FindDayOfWeek <font color="#000080">:= </font>dw <font color="#000080">+ </font><font color="#800000">7
  </font><font color="#FF0000"><b>else </b></font>FindDayOfWeek <font color="#000080">:= </font>dw<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      &ocirc;/</font>elly
      <font color="#000080">&otilde;</font>mall

<font color="#000080">---
 &thorn; </font>JABBER v1<font color="#000080">.</font><font color="#800000">2 #18 </font><font color="#000080">&thorn; </font>Bigamy<font color="#000080">: </font>too many wives<font color="#000080">. </font>Monogamy<font color="#000080">: </font>see Bigamy
                                            <font color="#000080">&thorn; </font>KMail <font color="#800000">2.94  </font>The Wish Book BBS <font color="#000080">(</font><font color="#800000">60
2</font><font color="#000080">)</font><font color="#800000">258</font><font color="#000080">-</font><font color="#800000">7113 </font><font color="#000080">(</font><font color="#800000">6</font><font color="#000080">+ </font>nodes<font color="#000080">, </font>ring down<font color="#000080">)
 * </font>The Wish Book <font color="#800000">602</font><font color="#000080">-</font><font color="#800000">258</font><font color="#000080">-</font><font color="#800000">7113</font><font color="#000080">(</font><font color="#800000">6 </font>lines<font color="#000080">)</font><font color="#800000">10</font><font color="#000080">+ </font>GIGs<font color="#000080">/</font>The BEST board <font color="#FF0000"><b>in </b></font>Arizona<font color="#000080">!
 * </font>PostLink<font color="#000080">(</font>tm<font color="#000080">) </font>v1<font color="#000080">.</font><font color="#800000">06  </font>TWB <font color="#000080">(</font><font color="#800000">#1032</font><font color="#000080">) : </font>RelayNet<font color="#000080">(</font>tm<font color="#000080">)
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p></body>
</html>
