<html>
<head><title> "DAYS UNTIL/SINCE CALC'ING" by DAVID DANIEL ANDERSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0050.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
If you are only concerned about dates since 1582, you can translate
both the Current date and the Other date into a LONGINT, and subtract
one from the other.

Below I have a calendar code fragment that writes out the Current
date as a LONGINT.  It should be a trivial task to integrate it into
an operational program, and have it do what you want.

{======================[ cut here ]======================}

</i></font><font color="#FF0000"><b>USES </b></font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>CONST </b></font>DaysPerYear <font color="#000080">= </font><font color="#800000">365</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE </b></font>Month <font color="#000080">= (</font>Jan<font color="#000080">, </font>Feb<font color="#000080">, </font>Mar<font color="#000080">, </font>Apr<font color="#000080">, </font>May<font color="#000080">, </font>Jun<font color="#000080">, </font>Jul<font color="#000080">, </font>Aug<font color="#000080">, </font>Sep<font color="#000080">, </font>Oct<font color="#000080">, </font>Nov<font color="#000080">, </font>Dec<font color="#000080">);
             </font><font color="#008000"><i>(* REMEMBER: ORD values for Month are 0..11 - NOT 1..12 ! *)
     </i></font>Date <font color="#000080">= </font><font color="#FF0000"><b>RECORD
              </b></font>da<font color="#000080">: </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">31</font><font color="#000080">;
              </font>mo<font color="#000080">: </font>Month<font color="#000080">;
              </font>yr<font color="#000080">: </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9999
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>VAR </b></font>maxDay<font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font>Month<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>INTEGER<font color="#000080">;
     </font>daysBefore<font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font>Month<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>INTEGER<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>GetSysDate<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>d<font color="#000080">: </font>Date<font color="#000080">);
  </font><font color="#008000"><i>(* Reads the system clock and assigns the date to d
     and the day of the week to dayOfWeek.            *)
  </i></font><font color="#FF0000"><b>VAR </b></font>SysYear<font color="#000080">,</font>SysMonth<font color="#000080">,</font>SysDay<font color="#000080">,</font>SysDOW <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>GetDate<font color="#000080">(</font>SysYear<font color="#000080">,</font>SysMonth<font color="#000080">,</font>SysDay<font color="#000080">,</font>SysDOW<font color="#000080">);
  </font>d<font color="#000080">.</font>yr <font color="#000080">:= </font>SysYear<font color="#000080">;
  </font>d<font color="#000080">.</font>mo <font color="#000080">:= </font>Month<font color="#000080">(</font>SysMonth<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
  </font>d<font color="#000080">.</font>da <font color="#000080">:= </font>SysDay
<font color="#008000"><i>{ dayOfWeek := DayType(SysDOW+1);   }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>MonthsInit<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>mo<font color="#000080">: </font>Month<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>maxDay<font color="#000080">[</font>Jan<font color="#000080">] := </font><font color="#800000">31</font><font color="#000080">;
  </font>maxDay<font color="#000080">[</font>Feb<font color="#000080">] := </font><font color="#800000">28</font><font color="#000080">;  </font><font color="#008000"><i>(* adjust for leap years later *)
  </i></font>maxDay<font color="#000080">[</font>Mar<font color="#000080">] := </font><font color="#800000">31</font><font color="#000080">;
  </font>maxDay<font color="#000080">[</font>Apr<font color="#000080">] := </font><font color="#800000">30</font><font color="#000080">;
  </font>maxDay<font color="#000080">[</font>May<font color="#000080">] := </font><font color="#800000">31</font><font color="#000080">;
  </font>maxDay<font color="#000080">[</font>Jun<font color="#000080">] := </font><font color="#800000">30</font><font color="#000080">;
  </font>maxDay<font color="#000080">[</font>Jul<font color="#000080">] := </font><font color="#800000">31</font><font color="#000080">;
  </font>maxDay<font color="#000080">[</font>Aug<font color="#000080">] := </font><font color="#800000">31</font><font color="#000080">;
  </font>maxDay<font color="#000080">[</font>Sep<font color="#000080">] := </font><font color="#800000">30</font><font color="#000080">;
  </font>maxDay<font color="#000080">[</font>Oct<font color="#000080">] := </font><font color="#800000">31</font><font color="#000080">;
  </font>maxDay<font color="#000080">[</font>Nov<font color="#000080">] := </font><font color="#800000">30</font><font color="#000080">;
  </font>maxDay<font color="#000080">[</font>Dec<font color="#000080">] := </font><font color="#800000">31</font><font color="#000080">;

  </font>daysBefore<font color="#000080">[</font>Jan<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>mo <font color="#000080">:= </font>Jan <font color="#FF0000"><b>TO </b></font>Nov <font color="#FF0000"><b>DO
    </b></font>daysBefore<font color="#000080">[</font>Month<font color="#000080">(</font>ORD<font color="#000080">(</font>mo<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">)] := </font>daysBefore<font color="#000080">[</font>mo<font color="#000080">] + </font>maxDay<font color="#000080">[</font>mo<font color="#000080">]
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>IsLeapYear<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>yr<font color="#000080">: </font>INTEGER<font color="#000080">): </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>IsLeapYear <font color="#000080">:= ((</font>yr <font color="#FF0000"><b>MOD </b></font><font color="#800000">4 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>yr <font color="#FF0000"><b>MOD </b></font><font color="#800000">100 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>yr <font color="#FF0000"><b>MOD </b></font><font color="#800000">400 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>NumDays<font color="#000080">(</font><font color="#FF0000"><b>CONST </b></font>d<font color="#000080">: </font>Date<font color="#000080">): </font>LONGINT<font color="#000080">;
  </font><font color="#008000"><i>(* NumDays returns an ordinal value for the date
     with January 1, 0001 assigned the value 1.    *)
  </i></font><font color="#FF0000"><b>VAR </b></font>result<font color="#000080">, </font>leapYears<font color="#000080">, </font>lYr<font color="#000080">: </font>LONGINT<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  WITH </b></font>d <font color="#FF0000"><b>DO BEGIN
    </b></font>lYr<font color="#000080">:=</font>yr<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
    </font>result <font color="#000080">:= (</font>da<font color="#000080">);
    </font>INC<font color="#000080">(</font>result<font color="#000080">, </font>daysBefore<font color="#000080">[</font>mo<font color="#000080">]);
    </font>INC<font color="#000080">(</font>result<font color="#000080">,</font>lYr <font color="#000080">* </font>DaysPerYear<font color="#000080">);
    </font>leapYears <font color="#000080">:= (</font>lYr <font color="#FF0000"><b>DIV </b></font><font color="#800000">4</font><font color="#000080">) - (</font>lYr <font color="#FF0000"><b>DIV </b></font><font color="#800000">100</font><font color="#000080">) + (</font>lYr <font color="#FF0000"><b>DIV </b></font><font color="#800000">400</font><font color="#000080">);
    </font>INC<font color="#000080">(</font>result<font color="#000080">, </font>leapYears<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>mo <font color="#000080">&gt; </font>Feb<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font>IsLeapYear<font color="#000080">(</font>yr<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>INC<font color="#000080">(</font>result<font color="#000080">)
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>NumDays <font color="#000080">:= </font>result
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR </b></font>currentDay <font color="#000080">: </font>date<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>GetSysDate<font color="#000080">(</font>currentDay<font color="#000080">);
  </font>MonthsInit<font color="#000080">;
  </font>Writeln<font color="#000080">(</font>NumDays<font color="#000080">(</font>currentDay<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0050.PAS">Original</a><b>]</b></p></body>
</html>
