<html>
<head><title> "Set Date/Time Routine" by CARLOS BEGUIGNE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0038.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{Created by Carlos Beguinge, Sept 12, 1993}
{Program to get the systems date using [GetDate] and allowing you to
  change the date using [SetDate]. Feel free to incorporated into any
  other code, and change it as you wish... Enjoy.}
{P.S. Any changes made to make this code better please post it back to me
  outlining the changes, Thank you.}
 
</i></font><font color="#FF0000"><b>uses </b></font>Dos<font color="#000080">, </font>Crt<font color="#000080">;
 
</font><font color="#FF0000"><b>const
  </b></font>days <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] =         </font><font color="#008000"><i>{Array of Weekdays set here}
    </i></font><font color="#000080">(</font><font color="#800000">'Sunday'</font><font color="#000080">,</font><font color="#800000">'Monday'</font><font color="#000080">,</font><font color="#800000">'Tuesday'</font><font color="#000080">,
     </font><font color="#800000">'Wednesday'</font><font color="#000080">,</font><font color="#800000">'Thursday'</font><font color="#000080">,</font><font color="#800000">'Friday'</font><font color="#000080">,
     </font><font color="#800000">'Saturday'</font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>y<font color="#000080">, </font>m<font color="#000080">, </font>d<font color="#000080">, </font>dow<font color="#000080">, </font>I<font color="#000080">, </font>Code <font color="#000080">: </font>Word<font color="#000080">;              </font><font color="#008000"><i>{Setting the variables here}
  </i></font>changedt<font color="#000080">, </font>cch <font color="#000080">: </font>Char<font color="#000080">;
  </font>flagd<font color="#000080">, </font>flagm<font color="#000080">, </font>flagy <font color="#000080">: </font>boolean<font color="#000080">;
  </font>ch <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>start<font color="#000080">(</font>Code<font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>Forward</b></font><font color="#000080">;        </font><font color="#008000"><i>{To allow to go forward in a }
                                             {procedure. Used for Error   } 
                                             {Checking.                   }
 
</i></font><font color="#FF0000"><b>procedure </b></font>compute<font color="#000080">;                           </font><font color="#008000"><i>{Called from procedure Start }
</i></font><font color="#FF0000"><b>begin                                        </b></font><font color="#008000"><i>{Moves the numeric string to }
  </i></font>Val<font color="#000080">(</font>ch<font color="#000080">, </font>I<font color="#000080">, </font>Code<font color="#000080">);                          </font><font color="#008000"><i>{numeric value. then checks  }
    </i></font><font color="#FF0000"><b>if </b></font>code <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then                        </b></font><font color="#008000"><i>{for errors. if error true   }
    </i></font><font color="#FF0000"><b>begin                                    </b></font><font color="#008000"><i>{then Call procedure Start   }
      </i></font>clrscr<font color="#000080">;
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Error in Date Statement'</font><font color="#000080">, </font><font color="#800000">'Press any key to Start Again '</font><font color="#000080">);
      </font>readln<font color="#000080">;
      </font>start<font color="#000080">(</font>Code<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;                                     </font><font color="#008000"><i>{Else Process Month, Day, and}
    </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>flagm <font color="#000080">= </font>false<font color="#000080">) </font><font color="#FF0000"><b>then                  </b></font><font color="#008000"><i>{Year.                       }
    </i></font><font color="#FF0000"><b>begin
      </b></font>m <font color="#000080">:= </font>I<font color="#000080">;
      </font>flagm <font color="#000080">:= </font>true<font color="#000080">;
      </font>write<font color="#000080">(</font>cch<font color="#000080">);
      </font>cch <font color="#000080">:=</font><font color="#800000">#0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>flagd <font color="#000080">= </font>false<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>cch <font color="#000080">&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>d <font color="#000080">:= </font>I<font color="#000080">;
      </font>flagd <font color="#000080">:= </font>true<font color="#000080">;
      </font>write<font color="#000080">(</font>cch<font color="#000080">);
      </font>cch <font color="#000080">:=</font><font color="#800000">#0</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>flagy <font color="#000080">= </font>false<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>cch <font color="#000080">&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>y <font color="#000080">:= </font>I<font color="#000080">;
      </font>flagy <font color="#000080">:= </font>true<font color="#000080">;
      </font>cch <font color="#000080">:=</font><font color="#800000">#13</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ch <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>ResetVars<font color="#000080">;                         </font><font color="#008000"><i>{Called from procedure Start }
</i></font><font color="#FF0000"><b>begin                                        </b></font><font color="#008000"><i>{Resets all variable.        }
  </i></font>clrscr<font color="#000080">;
  </font>Code <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>d <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>m <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>y <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>flagd <font color="#000080">:= </font>false<font color="#000080">;
  </font>flagm <font color="#000080">:= </font>false<font color="#000080">;
  </font>flagy <font color="#000080">:= </font>false<font color="#000080">;
  </font>ch <font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>cch <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>start<font color="#000080">;                             </font><font color="#008000"><i>{Called from Main Program    }
</i></font><font color="#FF0000"><b>begin                                        
  </b></font>ResetVars<font color="#000080">;                                 </font><font color="#008000"><i>{Calls procedure ResetFields }
  </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>cch <font color="#000080">&lt;&gt; </font><font color="#800000">#13</font><font color="#000080">) </font><font color="#FF0000"><b>do                      </b></font><font color="#008000"><i>{Gets input from the keyboard}
    </i></font><font color="#FF0000"><b>begin                                    </b></font><font color="#008000"><i>{until a &quot;/&quot; or &quot;Enter is    }
      </i></font>cch <font color="#000080">:= </font>readkey<font color="#000080">;                        </font><font color="#008000"><i>{pressed.                    }
      </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>cch <font color="#000080">&lt;&gt; </font><font color="#800000">#47</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>cch <font color="#000080">&lt;&gt; </font><font color="#800000">#13</font><font color="#000080">) </font><font color="#FF0000"><b>do
        begin
          </b></font>ch <font color="#000080">:= </font>ch <font color="#000080">+ </font>cch<font color="#000080">;                    </font><font color="#008000"><i>{Adds the each numeric charac}
          </i></font>write<font color="#000080">(</font>cch<font color="#000080">);                        </font><font color="#008000"><i>{ter to the string variable  }
          </i></font>cch <font color="#000080">:= </font>readkey<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>compute<font color="#000080">;                               </font><font color="#008000"><i>{Calls procedure Compute     }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin                                        </b></font><font color="#008000"><i>{Main Program which calls    }
  </i></font>clrscr<font color="#000080">;                                    </font><font color="#008000"><i>{procedure Start             }
  </i></font>GetDate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dow<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Today is '</font><font color="#000080">, </font>days<font color="#000080">[</font>dow<font color="#000080">],</font><font color="#800000">', '</font><font color="#000080">,
          </font>m<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">, </font>d<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">, </font>y<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>Write<font color="#000080">(</font><font color="#800000">'Would you like to change this Date? '</font><font color="#000080">);
  </font>readln<font color="#000080">(</font>changedt<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>upcase<font color="#000080">(</font>changedt<font color="#000080">) =</font><font color="#800000">'Y' </font><font color="#FF0000"><b>then
     begin
     </b></font>start<font color="#000080">(</font>Code<font color="#000080">);
     </font>clrscr<font color="#000080">;
     </font>SetDate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">);                         </font><font color="#008000"><i>{Sets the Date if Changed    }
     </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Today is '</font><font color="#000080">, </font>days<font color="#000080">[</font>dow<font color="#000080">],</font><font color="#800000">', '</font><font color="#000080">,
          </font>m<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">, </font>d<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">, </font>y<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
     </font>readln<font color="#000080">;
     </font><font color="#FF0000"><b>end
     else
     begin                                   </b></font><font color="#008000"><i>{Date remains unchanged      }
        </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Today'#39's date Was NOT changed '</font><font color="#000080">);
        </font>Writeln<font color="#000080">(</font><font color="#800000">'Today is '</font><font color="#000080">, </font>days<font color="#000080">[</font>dow<font color="#000080">],</font><font color="#800000">', '</font><font color="#000080">,
           </font>m<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">, </font>d<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">, </font>y<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
        </font>readln<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0038.PAS">Original</a><b>]</b></p></body>
</html>
