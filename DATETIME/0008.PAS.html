<html>
<head><title> "DATE7.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I have seen a number of Julian Date Functions showing up here lately.
None of them seem to agree With each other.  of course, if your Program
is the only thing using them, then it will remain consistent and work
fine. But if you need to find the JD For astronomical or scientific
purposes, then you will need to be able to agree With the accepted
method.  The following seems to work well For me.  Using Real For the
Var Types allows you to find the JD to great accuracy.
BTW, JD 0.0 is Greenwich Mean Noon, Jan. 1, 4713 BC (which is why if you
enter a &quot;whole&quot; day. ie. 1,2,3... your answer will have a '.5' at the
end.
}

</i></font><font color="#FF0000"><b>Function </b></font>JulianDate<font color="#000080">(</font>Day<font color="#000080">, </font>Month<font color="#000080">, </font>Year <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>A<font color="#000080">, </font>B<font color="#000080">, </font>C<font color="#000080">, </font>D <font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Month <font color="#000080">&lt;= </font><font color="#800000">2 </font><font color="#FF0000"><b>then
  begin
    </b></font>Year  <font color="#000080">:= </font>Year <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
    </font>Month <font color="#000080">:= </font>Month <font color="#000080">+ </font><font color="#800000">12</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>Year <font color="#000080">&gt;= </font><font color="#800000">1582 </font><font color="#FF0000"><b>then
  begin
    </b></font>A <font color="#000080">:= </font>inT<font color="#000080">(</font>Year <font color="#000080">/ </font><font color="#800000">100</font><font color="#000080">);
    </font>B <font color="#000080">:= </font>inT<font color="#000080">((</font><font color="#800000">2 </font><font color="#000080">- </font>A<font color="#000080">) + </font>inT<font color="#000080">(</font>A <font color="#000080">/ </font><font color="#800000">4</font><font color="#000080">));
  </font><font color="#FF0000"><b>end
  else
    </b></font>B <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>Year <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>C <font color="#000080">:= </font>inT<font color="#000080">((</font><font color="#800000">365.25 </font><font color="#000080">* </font>Year<font color="#000080">) - </font><font color="#800000">0.75</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>C <font color="#000080">:= </font>inT<font color="#000080">(</font><font color="#800000">365.25 </font><font color="#000080">* </font>Year<font color="#000080">);

  </font>D <font color="#000080">:= </font>inT <font color="#000080">(</font><font color="#800000">30.6001 </font><font color="#000080">* (</font>Month <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">));
  </font>JulianDate <font color="#000080">:=  </font>B <font color="#000080">+ </font>C <font color="#000080">+ </font>D <font color="#000080">+ </font>Day <font color="#000080">+ </font><font color="#800000">1720994.5</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p></body>
</html>
