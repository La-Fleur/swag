<html>
<head><title> "DATES Unit" by ZAK SMITH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0062.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>unit </b></font>dates<font color="#000080">;
</font><font color="#008000"><i>{$O+}

{      EXDATE.PAS  -- Turbo Pascal Extended Date Subroutines

 This is a collection of useful calendar date subroutines which are
 valid from October 15, 1582 until such time as the Gregorian calendar
 is replaced.  Note that Great Britain did not change to the Gregorian
 calendar until 1752, Russia until 1918, and Turkey until 1928.  (These
 routines will work until the year 32767; after that, you will need
 to replace ints with longints.)

 The day of the week algorithm derivation is described very well in
 Rosen's &quot;Elementary Number Theory and Its Applications&quot; (Addison-Wesley,
 1984, pp 134-137).  The ordinal day algorithms are derived using
 reasoning similar to that of Rosen's derivation.  The serial day
 algorithms are based upon Julian day algorithms in Algorithm 199
 by Robert G. Tantzen in Communications of the ACM  6, 8 (Aug 1963),
 page 444.}

{==================================================================}

                         </i></font><font color="#FF0000"><b>INTERFACE

const
   </b></font>days <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] =
      (</font><font color="#800000">'Sunday'</font><font color="#000080">,</font><font color="#800000">'Monday'</font><font color="#000080">,</font><font color="#800000">'Tuesday'</font><font color="#000080">,
       </font><font color="#800000">'Wednesday'</font><font color="#000080">,</font><font color="#800000">'Thursday'</font><font color="#000080">,</font><font color="#800000">'Friday'</font><font color="#000080">,
       </font><font color="#800000">'Saturday'</font><font color="#000080">);

   </font>months<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">15</font><font color="#000080">] =
       (</font><font color="#800000">'January'</font><font color="#000080">,</font><font color="#800000">'February'</font><font color="#000080">,</font><font color="#800000">'March'</font><font color="#000080">,</font><font color="#800000">'April'</font><font color="#000080">,</font><font color="#800000">'May'</font><font color="#000080">,</font><font color="#800000">'June'</font><font color="#000080">,</font><font color="#800000">'July'</font><font color="#000080">,
        </font><font color="#800000">'August'</font><font color="#000080">,</font><font color="#800000">'September'</font><font color="#000080">,</font><font color="#800000">'October'</font><font color="#000080">,</font><font color="#800000">'November'</font><font color="#000080">,</font><font color="#800000">'December'</font><font color="#000080">);

</font><font color="#FF0000"><b>function  </b></font>today_day_of_week<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>today_day<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>today_month<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>today_year<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>day_of_week <font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">: </font>integer<font color="#000080">) : </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>ordinal_day <font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">: </font>integer<font color="#000080">) : </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>today_serial_day<font color="#000080">: </font>longint<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>from_ordinal_day<font color="#000080">(</font>ordinal_day<font color="#000080">, </font>year<font color="#000080">: </font>integer<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>day<font color="#000080">, </font>month<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>valid_date<font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">: </font>integer<font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>day_diff<font color="#000080">(</font>day_1<font color="#000080">, </font>month_1<font color="#000080">, </font>year_1<font color="#000080">, </font>day_2<font color="#000080">, </font>month_2<font color="#000080">, </font>year_2<font color="#000080">: </font>integer<font color="#000080">) : </font>longint<font color="#000080">;
    </font><font color="#008000"><i>{Returns the number of days between two dates, the first date being denoted
     by day_1, month_1, year_1, and the second by day_2, month_2, year_2.
     A negative value means that the second date is earlier than the first date.}

</i></font><font color="#FF0000"><b>procedure </b></font>days_from<font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">, </font>days<font color="#000080">: </font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>new_day<font color="#000080">, </font>new_month<font color="#000080">, </font>new_year<font color="#000080">: </font>integer<font color="#000080">);
   </font><font color="#008000"><i>{Returns a date (new_day, new_month, new_year) which is a specified number
    of days (days) from a given date (day, month, year).   The number of days
    may be positive or negative.}

  {The following auxiliary procedures are in the interface just in case
   they may be useful for other purposes.}

</i></font><font color="#FF0000"><b>function </b></font>leap_year<font color="#000080">(</font>year<font color="#000080">: </font>integer<font color="#000080">) : </font>integer<font color="#000080">;
   </font><font color="#008000"><i>{ Returns 1 for a leap year and 0 for others }

</i></font><font color="#FF0000"><b>function </b></font>serial_day<font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">: </font>integer<font color="#000080">) : </font>longint<font color="#000080">;
   </font><font color="#008000"><i>{Converts a date to a &quot;serial day&quot; for performing calendar arithmetic.
    The serial day is the classic Julian date less 1721119.}

</i></font><font color="#FF0000"><b>procedure </b></font>from_serial_day <font color="#000080">(</font>serial_day<font color="#000080">: </font>longint<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">:</font>integer<font color="#000080">);
    </font><font color="#008000"><i>{Returns the day, month, year corresponding to a &quot;serial day&quot;.}

{==================================================================}

                        </i></font><font color="#FF0000"><b>IMPLEMENTATION

uses </b></font>dos<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>today_serial_day<font color="#000080">: </font>longint<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>today_serial_day<font color="#000080">:=</font>serial_day<font color="#000080">(</font>today_day<font color="#000080">,</font>today_month<font color="#000080">,</font>today_year<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>today_day_of_week<font color="#000080">: </font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>m<font color="#000080">,</font>d<font color="#000080">,</font>y<font color="#000080">,</font>dw<font color="#000080">: </font>word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>getdate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dw<font color="#000080">);
 </font>today_day_of_week <font color="#000080">:= </font>dw<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>today_month<font color="#000080">: </font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>m<font color="#000080">,</font>d<font color="#000080">,</font>y<font color="#000080">,</font>dw<font color="#000080">: </font>word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>getdate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dw<font color="#000080">);
 </font>today_month <font color="#000080">:= </font>m<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>today_day<font color="#000080">: </font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>m<font color="#000080">,</font>d<font color="#000080">,</font>y<font color="#000080">,</font>dw<font color="#000080">: </font>word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>getdate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dw<font color="#000080">);
 </font>today_day <font color="#000080">:= </font>d<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Today_year<font color="#000080">: </font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>m<font color="#000080">,</font>d<font color="#000080">,</font>y<font color="#000080">,</font>dw<font color="#000080">: </font>word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>getdate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dw<font color="#000080">);
 </font>today_year <font color="#000080">:= </font>y<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>day_of_week <font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">: </font>integer<font color="#000080">) : </font>integer<font color="#000080">;
</font><font color="#008000"><i>{Returns integer day of week for date.  0 = Sunday, 6 = Saturday
 Uses Zeller's congruence.}
   </i></font><font color="#FF0000"><b>var </b></font>century<font color="#000080">, </font>yr<font color="#000080">, </font>dw<font color="#000080">: </font>integer<font color="#000080">;
   </font><font color="#FF0000"><b>begin
      if </b></font>month <font color="#000080">&lt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then begin
         </b></font>month <font color="#000080">:= </font>month <font color="#000080">+ </font><font color="#800000">10</font><font color="#000080">;
         </font>year <font color="#000080">:= </font>year <font color="#000080">-</font><font color="#800000">1
         </font><font color="#FF0000"><b>end
      else
         </b></font>month <font color="#000080">:= </font>month <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">;
      </font>century <font color="#000080">:= </font>year <font color="#FF0000"><b>div </b></font><font color="#800000">100</font><font color="#000080">;
      </font>yr <font color="#000080">:= </font>year <font color="#FF0000"><b>mod </b></font><font color="#800000">100</font><font color="#000080">;
      </font>dw <font color="#000080">:= (((</font><font color="#800000">26</font><font color="#000080">*</font>month <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">10</font><font color="#000080">)+</font>day<font color="#000080">+</font>yr<font color="#000080">+(</font>yr <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">)+
         (</font>century <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">) - (</font><font color="#800000">2</font><font color="#000080">*</font>century<font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">7</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>dw <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>day_of_week <font color="#000080">:= </font>dw <font color="#000080">+ </font><font color="#800000">7 </font><font color="#FF0000"><b>else </b></font>day_of_week <font color="#000080">:= </font>dw<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>function </b></font>leap_year<font color="#000080">(</font>year<font color="#000080">: </font>integer<font color="#000080">) : </font>integer<font color="#000080">;
   </font><font color="#008000"><i>{ Returns 1 for a leap year and 0 for others }
   </i></font><font color="#FF0000"><b>begin
   if </b></font>year <font color="#FF0000"><b>and </b></font><font color="#800000">3 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>leap_year <font color="#000080">:= </font><font color="#800000">0
   </font><font color="#FF0000"><b>else if </b></font>year <font color="#FF0000"><b>mod </b></font><font color="#800000">100 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>leap_year <font color="#000080">:= </font><font color="#800000">1
   </font><font color="#FF0000"><b>else if </b></font>year <font color="#FF0000"><b>mod </b></font><font color="#800000">400 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>leap_year <font color="#000080">:= </font><font color="#800000">0
   </font><font color="#FF0000"><b>else </b></font>leap_year <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ordinal_day <font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">: </font>integer<font color="#000080">) : </font>integer<font color="#000080">;
</font><font color="#008000"><i>{Returns ordinal day of year (1-366) for date}
   </i></font><font color="#FF0000"><b>var </b></font>od<font color="#000080">: </font>integer<font color="#000080">;
   </font><font color="#FF0000"><b>begin
   if </b></font>month <font color="#000080">&lt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then
      </b></font>month <font color="#000080">:= </font>month <font color="#000080">+ </font><font color="#800000">10
   </font><font color="#FF0000"><b>else
      </b></font>month <font color="#000080">:= </font>month <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">;
   </font>od <font color="#000080">:= (</font><font color="#800000">306 </font><font color="#000080">* </font>month <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">10 </font><font color="#000080">- </font><font color="#800000">30</font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>od <font color="#000080">&lt; </font><font color="#800000">306 </font><font color="#FF0000"><b>then
      </b></font>ordinal_day <font color="#000080">:= </font>od <font color="#000080">+ </font><font color="#800000">59 </font><font color="#000080">+ </font>leap_year<font color="#000080">(</font>year<font color="#000080">) + </font>day
   <font color="#FF0000"><b>else
      </b></font>ordinal_day <font color="#000080">:= </font>od <font color="#000080">- </font><font color="#800000">306 </font><font color="#000080">+ </font>day<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>from_ordinal_day <font color="#000080">(</font>ordinal_day<font color="#000080">, </font>year<font color="#000080">: </font>integer<font color="#000080">;
    </font><font color="#FF0000"><b>var </b></font>day<font color="#000080">, </font>month<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#008000"><i>{Returns day and month for ordinal day of a year}
   </i></font><font color="#FF0000"><b>var </b></font>lyf<font color="#000080">, </font>adj_mo<font color="#000080">: </font>integer<font color="#000080">;
   </font><font color="#FF0000"><b>begin
   </b></font>lyf <font color="#000080">:= </font>leap_year<font color="#000080">(</font>year<font color="#000080">) + </font><font color="#800000">60</font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>ordinal_day <font color="#000080">&lt; </font>lyf <font color="#FF0000"><b>then
      </b></font>ordinal_day <font color="#000080">:= </font>ordinal_day <font color="#000080">+ </font><font color="#800000">305
   </font><font color="#FF0000"><b>else
      </b></font>ordinal_day <font color="#000080">:= </font>ordinal_day <font color="#000080">- </font>lyf<font color="#000080">;
   </font>adj_mo <font color="#000080">:= (</font>ordinal_day <font color="#000080">* </font><font color="#800000">10 </font><font color="#000080">+ </font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">306 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
   </font>day <font color="#000080">:= </font>ordinal_day <font color="#000080">- ((</font>adj_mo <font color="#000080">* </font><font color="#800000">306 </font><font color="#000080">- </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">10 </font><font color="#000080">- </font><font color="#800000">30</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>adj_mo <font color="#000080">&lt; </font><font color="#800000">11 </font><font color="#FF0000"><b>then
      </b></font>month <font color="#000080">:= </font>adj_mo <font color="#000080">+ </font><font color="#800000">2
   </font><font color="#FF0000"><b>else
      </b></font>month <font color="#000080">:= </font>adj_mo <font color="#000080">- </font><font color="#800000">10</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>valid_date<font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">: </font>integer<font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{Determines whether a date is valid by transforming to an ordinal and
 trying to transform it back again.}
   </i></font><font color="#FF0000"><b>var </b></font>od<font color="#000080">, </font>m<font color="#000080">, </font>d<font color="#000080">: </font>integer<font color="#000080">;
   </font><font color="#FF0000"><b>begin
   </b></font>od <font color="#000080">:= </font>ordinal_day<font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>od <font color="#000080">&gt; </font><font color="#800000">366</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>od <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>valid_date <font color="#000080">:= </font>false
   <font color="#FF0000"><b>else begin
      </b></font>from_ordinal_day<font color="#000080">(</font>od<font color="#000080">, </font>year<font color="#000080">, </font>d<font color="#000080">, </font>m<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>d <font color="#000080">= </font>day<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>m <font color="#000080">= </font>month<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>valid_date <font color="#000080">:= </font>true
      <font color="#FF0000"><b>else </b></font>valid_date <font color="#000080">:= </font>false
   <font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>serial_day<font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">: </font>integer<font color="#000080">) : </font>longint<font color="#000080">;
</font><font color="#008000"><i>{Converts a date to a &quot;serial day&quot; for performing calendar arithmetic.
 The serial day is the classic Julian date less 1721119.}
</i></font><font color="#FF0000"><b>var  </b></font>m<font color="#000080">, </font>y <font color="#000080">: </font>longint<font color="#000080">;
   </font><font color="#FF0000"><b>begin
      if </b></font>month <font color="#000080">&gt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then begin
         </b></font>m <font color="#000080">:= </font>month <font color="#000080">- </font><font color="#800000">3</font><font color="#000080">;
         </font>y <font color="#000080">:= </font>year<font color="#000080">;
      </font><font color="#FF0000"><b>end
      else begin
         </b></font>m <font color="#000080">:= </font>month <font color="#000080">+ </font><font color="#800000">9</font><font color="#000080">;
         </font>y <font color="#000080">:= </font>year <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>serial_day <font color="#000080">:=
         ((</font>y <font color="#FF0000"><b>div </b></font><font color="#800000">100</font><font color="#000080">) * </font><font color="#800000">146097</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">4 </font><font color="#000080">+
         ((</font>y <font color="#FF0000"><b>mod </b></font><font color="#800000">100</font><font color="#000080">) * </font><font color="#800000">1461</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">4 </font><font color="#000080">+
         (</font><font color="#800000">153 </font><font color="#000080">* </font>m <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">5 </font><font color="#000080">+ </font>day<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>day_diff<font color="#000080">(</font>day_1<font color="#000080">, </font>month_1<font color="#000080">, </font>year_1<font color="#000080">, </font>day_2<font color="#000080">, </font>month_2<font color="#000080">, </font>year_2<font color="#000080">: </font>integer<font color="#000080">)
   : </font>longint<font color="#000080">;
</font><font color="#008000"><i>{Returns the number of days between two dates. A negative value means that the
 second date is earlier than the first date.}
   </i></font><font color="#FF0000"><b>begin
   </b></font>day_diff <font color="#000080">:= </font>serial_day<font color="#000080">(</font>day_2<font color="#000080">, </font>month_2<font color="#000080">, </font>year_2<font color="#000080">) -
      </font>serial_day<font color="#000080">(</font>day_1<font color="#000080">, </font>month_1<font color="#000080">, </font>year_1<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>from_serial_day <font color="#000080">(</font>serial_day<font color="#000080">: </font>longint<font color="#000080">;
    </font><font color="#FF0000"><b>var </b></font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#008000"><i>{Returns the date corresponding to a &quot;serial day&quot;.}
   </i></font><font color="#FF0000"><b>var </b></font>j<font color="#000080">, </font>d <font color="#000080">: </font>longint<font color="#000080">;
   </font><font color="#FF0000"><b>begin
      </b></font>j <font color="#000080">:= </font>serial_day <font color="#000080">* </font><font color="#800000">4 </font><font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
      </font>d <font color="#000080">:= ((</font>j <font color="#FF0000"><b>mod </b></font><font color="#800000">146097</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">) * </font><font color="#800000">4 </font><font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">;
      </font>year <font color="#000080">:= (</font>j <font color="#FF0000"><b>div </b></font><font color="#800000">146097</font><font color="#000080">) * </font><font color="#800000">100 </font><font color="#000080">+ (</font>d <font color="#FF0000"><b>div </b></font><font color="#800000">1461</font><font color="#000080">);
      </font>d <font color="#000080">:= (((</font>d <font color="#FF0000"><b>mod </b></font><font color="#800000">1461</font><font color="#000080">) + </font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">) * </font><font color="#800000">5 </font><font color="#000080">- </font><font color="#800000">3</font><font color="#000080">;
      </font>month <font color="#000080">:= </font>d <font color="#FF0000"><b>div </b></font><font color="#800000">153</font><font color="#000080">;
      </font>day <font color="#000080">:= ((</font>d <font color="#FF0000"><b>mod </b></font><font color="#800000">153</font><font color="#000080">) + </font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">5</font><font color="#000080">;

      </font><font color="#FF0000"><b>if </b></font>month <font color="#000080">&lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>then
         </b></font>month <font color="#000080">:= </font>month <font color="#000080">+ </font><font color="#800000">3
      </font><font color="#FF0000"><b>else begin
         </b></font>month <font color="#000080">:= </font>month <font color="#000080">- </font><font color="#800000">9</font><font color="#000080">;
         </font>year <font color="#000080">:= </font>year <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>days_from<font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">, </font>days<font color="#000080">: </font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>new_day<font color="#000080">,
      </font>new_month<font color="#000080">, </font>new_year<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#008000"><i>{Returns a date which is a specified number of days from a given date.
 The number of days may be positive or negative.}
   </i></font><font color="#FF0000"><b>begin
   </b></font>from_serial_day<font color="#000080">(</font>serial_day<font color="#000080">(</font>day<font color="#000080">, </font>month<font color="#000080">, </font>year<font color="#000080">) + </font>days<font color="#000080">,
      </font>new_day<font color="#000080">, </font>new_month<font color="#000080">, </font>new_year<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0062.PAS">Original</a><b>]</b></p></body>
</html>
