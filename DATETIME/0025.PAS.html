<html>
<head><title> "IFDAY.PAS" by BRYAN VALENCIA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0025.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$R-,S+,I+,D+,T-,F-,V+,B-,N-,L+ }
{$M 16384,0,1024 }
</i></font><font color="#FF0000"><b>program </b></font>ifday<font color="#000080">;
</font><font color="#008000"><i>{
***********************************************************************

IFDAY.PAS
8/18/93
by Bryan Valencia.

Shows use of the EXEC Command to run Command.com with a command line
taken from user entered parameters.

Include IFDAY in Batch Files to Run lines only on certain days.


***********************************************************************
}
</i></font><font color="#FF0000"><b>uses </b></font>DOS<font color="#000080">, </font>CRT<font color="#000080">;
</font><font color="#FF0000"><b>var
        </b></font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dow<font color="#000080">:</font>word<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>help<font color="#000080">;
</font><font color="#FF0000"><b>begin
        </b></font>textattr<font color="#000080">:=</font>yellow<font color="#000080">;
        </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">); </font>ClrEOL<font color="#000080">;
        </font>Writeln<font color="#000080">(</font><font color="#800000">'IFDAY by Bryan Valencia [71553,3102]'</font><font color="#000080">);
        </font>Writeln<font color="#000080">(</font><font color="#800000">'SYNTAX'</font><font color="#000080">);
        </font>textattr<font color="#000080">:=</font>lightgreen<font color="#000080">;
        </font>Writeln<font color="#000080">(</font><font color="#800000">'IFDAY [DAYOFWEEK,DAYNO] COMMAND'</font><font color="#000080">);
        </font>WRiteln<font color="#000080">(</font><font color="#800000">'IFDAY 4 MIRROR c:  (if today is the 4th, mirror the C: drive).'</font><font color="#000080">);
        </font>WRiteln<font color="#000080">(</font><font color="#800000">'IFDAY MON SD C: /Unfrag  (if today is Monday, run speed disk).'</font><font color="#000080">);
        </font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PerformCommand<font color="#000080">;
</font><font color="#FF0000"><b>var
        </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
        </font>t<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
        </b></font>s<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>t<font color="#000080">:=</font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>paramcount <font color="#FF0000"><b>do </b></font>s<font color="#000080">:=</font>s<font color="#000080">+</font>paramstr<font color="#000080">(</font>t<font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">;
        </font>Writeln<font color="#000080">(</font>s<font color="#000080">);
        </font>Exec<font color="#000080">(</font><font color="#800000">'c:\Command.Com'</font><font color="#000080">,</font><font color="#800000">'/c '</font><font color="#000080">+</font>s<font color="#000080">);
        </font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Checknum<font color="#000080">(</font>i<font color="#000080">:</font>integer<font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
        </b></font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dow<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
        </b></font>Getdate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dow<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">=</font>d <font color="#FF0000"><b>then </b></font>Checknum<font color="#000080">:=</font>true <font color="#FF0000"><b>else </b></font>Checknum<font color="#000080">:=</font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>CheckDay<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
        </b></font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dow<font color="#000080">:</font>word<font color="#000080">;
        </font>ss<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
</font><font color="#FF0000"><b>begin
        </b></font>Getdate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dow<font color="#000080">);
        </font><font color="#FF0000"><b>Case </b></font>dow <font color="#FF0000"><b>of
                </b></font><font color="#800000">0</font><font color="#000080">:</font>SS<font color="#000080">:=</font><font color="#800000">'SU'</font><font color="#000080">;
                </font><font color="#800000">1</font><font color="#000080">:</font>SS<font color="#000080">:=</font><font color="#800000">'MO'</font><font color="#000080">;
                </font><font color="#800000">2</font><font color="#000080">:</font>SS<font color="#000080">:=</font><font color="#800000">'TU'</font><font color="#000080">;
                </font><font color="#800000">3</font><font color="#000080">:</font>SS<font color="#000080">:=</font><font color="#800000">'WE'</font><font color="#000080">;
                </font><font color="#800000">4</font><font color="#000080">:</font>SS<font color="#000080">:=</font><font color="#800000">'TH'</font><font color="#000080">;
                </font><font color="#800000">5</font><font color="#000080">:</font>SS<font color="#000080">:=</font><font color="#800000">'FR'</font><font color="#000080">;
                </font><font color="#800000">6</font><font color="#000080">:</font>SS<font color="#000080">:=</font><font color="#800000">'SA'</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>S<font color="#000080">=</font>SS <font color="#FF0000"><b>then </b></font>CheckDay<font color="#000080">:=</font>true <font color="#FF0000"><b>else </b></font>CheckDay<font color="#000080">:=</font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>GO<font color="#000080">;
</font><font color="#FF0000"><b>var
        </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
        </font>v<font color="#000080">,</font>t<font color="#000080">:</font>byte<font color="#000080">;
        </font>e<font color="#000080">:</font>integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
        </b></font>s<font color="#000080">:=</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>for </b></font>t<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">2 </font><font color="#FF0000"><b>do </b></font>s<font color="#000080">[</font>t<font color="#000080">]:=</font>upcase<font color="#000080">(</font>s<font color="#000080">[</font>t<font color="#000080">]);
        </font>Val<font color="#000080">(</font>s<font color="#000080">,</font>v<font color="#000080">,</font>e<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>e<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then if </b></font>Checknum<font color="#000080">(</font>v<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>PerformCommand<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>e<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then if </b></font>CheckDay<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>PerformCommand<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
        if </b></font>paramcount<font color="#000080">&lt;</font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>help <font color="#FF0000"><b>else </b></font>GO<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DATETIME SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0025.PAS">Original</a><b>]</b></p></body>
</html>
