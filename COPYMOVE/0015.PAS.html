<html>
<head><title> "Move File with Rename" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to COPYMOVE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&sup3; I am interested in the source in Asm or TP to move a File from one
&sup3; directory to another by means of the FAT table.

All you have to do is use the Rename Procedure.  It isn't done via the
FAT table, but via Dos Function 56h.  The only restrictions are (1)
you must be running on Dos 2.0 or greater, and (2) the original and
target directories must be on the same drive.  The code might look
something like this:
}

</i></font><font color="#FF0000"><b>Function </b></font>MoveFile<font color="#000080">( </font>FileName<font color="#000080">, </font>NewDir<font color="#000080">: </font>Dos<font color="#000080">.</font>PathStr <font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>f<font color="#000080">:      </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
  </font>OldDir<font color="#000080">: </font>Dos<font color="#000080">.</font>DirStr<font color="#000080">;
  </font>Nam<font color="#000080">:    </font>Dos<font color="#000080">.</font>NameStr<font color="#000080">;
  </font>Ext<font color="#000080">:    </font>Dos<font color="#000080">.</font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Dos<font color="#000080">.</font>FSplit<font color="#000080">( </font>FileName<font color="#000080">, </font>OldDir<font color="#000080">, </font>Nam<font color="#000080">, </font>Ext <font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>NewDir<font color="#000080">[ </font>Length<font color="#000080">(</font>NewDir<font color="#000080">) ] &lt;&gt; </font><font color="#800000">'\' </font><font color="#FF0000"><b>then
    </b></font>NewDir <font color="#000080">:= </font>NewDir <font color="#000080">+ </font><font color="#800000">'\'</font><font color="#000080">;
  </font><font color="#008000"><i>{$I-}
  </i></font>Assign<font color="#000080">( </font>f<font color="#000080">, </font>FileName <font color="#000080">);
  </font>FileName <font color="#000080">:= </font>NewDir <font color="#000080">+ </font>Nam <font color="#000080">+ </font>Ext<font color="#000080">;
  </font>Rename<font color="#000080">( </font>f<font color="#000080">, </font>FileName <font color="#000080">);
  </font>MoveFile <font color="#000080">:= (</font>Ioresult<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#008000"><i>{$I+}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ MoveFile }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to COPYMOVE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p></body>
</html>
