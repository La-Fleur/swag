<html>
<head><title> "Bredth First traversal algorithm" by WILLIAM HOBDAY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>BFT<font color="#000080">;

</font><font color="#008000"><i>(*****************************************************************************)
(*   Name:  BFT                                                              *)
(*   Written by: William Hobday                                              *)
(*   Last modified: March 5, 1989                                            *)
(*                                                                           *)
(*   Purpose: Implements the Bredth First traversal algorithm using the      *)
(*            Graph, Tree, and Q units.  The following program produces BFT  *)
(*            traversals of the following graphs starting from node C:       *)
(*                                                                           *)
(*                    Graph 1                   Graph 2                      *)
(*                                                                           *)
(*                  A - B - C - D              A - B   C                     *)
(*                   \ / \ / \ /                                             *)
(*                    E - F - G                                              *)
(*                     \ / \ /                                               *)
(*                      H - I                                                *)
(*                       \ /                                                 *)
(*                        J                                                  *)
(*                                                                           *)
(*            In case the adjacency graph as well as the corresponding       *)
(*            spanning tree is printed.                                      *)
(*                                                                           *)
(*****************************************************************************)

</i></font><font color="#FF0000"><b>uses </b></font>graph<font color="#000080">,</font>Q<font color="#000080">,</font>tree<font color="#000080">,</font>crt<font color="#000080">; </font><font color="#008000"><i>{ graph is in math.swg
                         q is in pointers.swg !! }

</i></font><font color="#FF0000"><b>var </b></font>A<font color="#000080">,</font>B<font color="#000080">,</font>C<font color="#000080">,</font>D<font color="#000080">,</font>E<font color="#000080">,</font>F<font color="#000080">,</font>G<font color="#000080">,</font>H<font color="#000080">,</font>I<font color="#000080">,</font>J<font color="#000080">,</font>K<font color="#000080">,</font>L<font color="#000080">,</font>M <font color="#000080">: </font>Vertex<font color="#000080">;
    </font>Grph1<font color="#000080">,</font>Grph2<font color="#000080">: </font>Vertex<font color="#000080">;



</font><font color="#008000"><i>(*****************************************************************************)
(*   Name: Visit                                                             *)
(*                                                                           *)
(*   Purpose: Visits node by adding vertex to tree and placing it in the Q   *)
(*            then marking the node as visited.                              *)
(*   Input: Grph - The graph                                                 *)
(*          VertexQ - the queue                                              *)
(*          Father - the tree node to be added to                            *)
(*          Name - name of the vertex to visit                               *)
(*   Output: the modifed graph and queue                                     *)
(*****************************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>Visit<font color="#000080">( </font>Grph <font color="#000080">: </font>Vertex<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>VertexQ <font color="#000080">: </font>Queue<font color="#000080">; </font>Father <font color="#000080">: </font>TreeNode<font color="#000080">; </font>Name<font color="#000080">: </font>char <font color="#000080">);

</font><font color="#FF0000"><b>begin
   </b></font>AddTreeNode<font color="#000080">( </font>Father<font color="#000080">,</font>Name <font color="#000080">);
   </font>GetVertex<font color="#000080">( </font>Grph<font color="#000080">,</font>Name <font color="#000080">)^.</font>visited <font color="#000080">:= </font>true<font color="#000080">;
   </font>EnQueue<font color="#000080">( </font>VertexQ<font color="#000080">,</font>Name <font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#008000"><i>(*****************************************************************************)
(*   Name: SelectFatherNode                                                  *)
(*                                                                           *)
(*   Purpose:  Given a father node it test to see if it the valid one for    *)
(*             when inserting into the tree.                                 *)
(*   Input: Father - node to check                                           *)
(*   Output: pointer to selected node                                        *)
(*****************************************************************************)

</i></font><font color="#FF0000"><b>Function </b></font>SelectFatherNode<font color="#000080">( </font>Father <font color="#000080">: </font>TreeNode <font color="#000080">) : </font>TreeNode<font color="#000080">;

</font><font color="#FF0000"><b>begin
   if </b></font>Father<font color="#000080">^.</font>Son <font color="#000080">= </font><font color="#FF0000"><b>nil
      then begin
              </b></font>Father <font color="#000080">:= </font>Father<font color="#000080">^.</font>Parent<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>Father<font color="#000080">^.</font>brother <font color="#000080">= </font><font color="#FF0000"><b>nil
                 then </b></font>SelectFatherNode <font color="#000080">:= </font>Firstchild<font color="#000080">( </font>father <font color="#000080">)
                 </font><font color="#FF0000"><b>else </b></font>SelectFatherNode <font color="#000080">:= </font>NextSibling<font color="#000080">( </font>father <font color="#000080">)
           </font><font color="#FF0000"><b>end
      else </b></font>SelectFatherNode <font color="#000080">:= </font>FirstChild<font color="#000080">( </font>father <font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#008000"><i>(*****************************************************************************)
(*   Name: SelectGraphNode                                                   *)
(*                                                                           *)
(*   Purpose: Given the graph it selects the next Node that has not been     *)
(*            visited.                                                       *)
(*   Input: Grph - pointer to start of graph                                 *)
(*   Output: pointer to selected node                                        *)
(*****************************************************************************)

</i></font><font color="#FF0000"><b>Function </b></font>SelectGraphNode<font color="#000080">( </font>Grph <font color="#000080">: </font>Vertex <font color="#000080">) : </font>Vertex<font color="#000080">;

</font><font color="#FF0000"><b>begin
   While </b></font><font color="#000080">(</font>Grph<font color="#000080">^.</font>visited <font color="#000080">= </font>True<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Grph <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>Grph <font color="#000080">:= </font>Grph<font color="#000080">^.</font>Next<font color="#000080">;
   </font>SelectGraphNode <font color="#000080">:= </font>Grph
<font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#008000"><i>(*****************************************************************************)
(*   Name: BFTraverse                                                        *)
(*                                                                           *)
(*   Purpose:  Given a graph and starting vertex this procedure produces a   *)
(*             spanning tree of the Breadth First Traversal of the graph.    *)
(*   Input: Grph - the start of the graph                                    *)
(*          V - the vertex to start traversal at                             *)
(*   Output: The spanning tree produce by the BFT                            *)
(*****************************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>BFTraverse<font color="#000080">( </font>Grph <font color="#000080">: </font>Vertex<font color="#000080">; </font>V <font color="#000080">: </font>Vertex<font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>Name<font color="#000080">,</font>Name2 <font color="#000080">: </font>char<font color="#000080">;
    </font>VertexQ<font color="#000080">: </font>Queue<font color="#000080">;
    </font>BFTree<font color="#000080">,</font>Father <font color="#000080">: </font>TreeNode<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>NewQueue<font color="#000080">( </font>VertexQ <font color="#000080">);
   </font><font color="#FF0000"><b>while </b></font>V <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
         begin
            </b></font>BFTree <font color="#000080">:= </font>NewTree<font color="#000080">( </font>V<font color="#000080">^.</font>Name <font color="#000080">);
            </font>Father <font color="#000080">:= </font>BFTree<font color="#000080">;
            </font>V<font color="#000080">^.</font>Visited <font color="#000080">:= </font>true<font color="#000080">;
            </font>EnQueue<font color="#000080">( </font>VertexQ<font color="#000080">,</font>V<font color="#000080">^.</font>Name <font color="#000080">);
            </font><font color="#FF0000"><b>while not </b></font>empty<font color="#000080">( </font>VertexQ <font color="#000080">) </font><font color="#FF0000"><b>do
               begin
                  </b></font>Name <font color="#000080">:= </font>DeQueue<font color="#000080">( </font>vertexQ <font color="#000080">);
                  </font>Name2 <font color="#000080">:= </font>FirstSuccessor<font color="#000080">( </font>Grph<font color="#000080">,</font>Name <font color="#000080">);
                  </font><font color="#FF0000"><b>while </b></font>Name2 <font color="#000080">&lt;&gt; </font><font color="#800000">#0 </font><font color="#FF0000"><b>do
                     begin
                        if not </b></font>GetVertex<font color="#000080">( </font>Grph<font color="#000080">,</font>Name2 <font color="#000080">)^.</font>visited
                           <font color="#FF0000"><b>then </b></font>Visit<font color="#000080">( </font>Grph<font color="#000080">,</font>VertexQ<font color="#000080">,</font>Father<font color="#000080">,</font>Name2 <font color="#000080">);
                        </font>Name2 <font color="#000080">:= </font>NextSuccessor<font color="#000080">( </font>Grph<font color="#000080">,</font>Name<font color="#000080">,</font>Name2 <font color="#000080">);
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font>Father <font color="#000080">:= </font>SelectFatherNode<font color="#000080">( </font>Father <font color="#000080">)
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font>writeln<font color="#000080">(</font><font color="#800000">'BFT Spanning Tree'</font><font color="#000080">);
            </font>writeln<font color="#000080">(</font><font color="#800000">'&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;'</font><font color="#000080">);
            </font>PrintTree<font color="#000080">( </font>BFTree <font color="#000080">);
            </font>writeln<font color="#000080">(</font><font color="#800000">'&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;'</font><font color="#000080">);
            </font>writeln<font color="#000080">;
            </font>V <font color="#000080">:= </font>SelectGraphNode<font color="#000080">( </font>Grph <font color="#000080">)
      </font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;




</font><font color="#FF0000"><b>begin
   </b></font>Grph1 <font color="#000080">:= </font>NewGraph<font color="#000080">;                                </font><font color="#008000"><i>(* Initialize graphs *)
   </i></font>Grph2 <font color="#000080">:= </font>NewGraph<font color="#000080">;
   </font>A <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph1<font color="#000080">,</font><font color="#800000">'A'</font><font color="#000080">);                          </font><font color="#008000"><i>(* Add Vertices *)
   </i></font>B <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph1<font color="#000080">,</font><font color="#800000">'B'</font><font color="#000080">);
   </font>C <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph1<font color="#000080">,</font><font color="#800000">'C'</font><font color="#000080">);
   </font>D <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph1<font color="#000080">,</font><font color="#800000">'D'</font><font color="#000080">);
   </font>E <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph1<font color="#000080">,</font><font color="#800000">'E'</font><font color="#000080">);
   </font>F <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph1<font color="#000080">,</font><font color="#800000">'F'</font><font color="#000080">);
   </font>G <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph1<font color="#000080">,</font><font color="#800000">'G'</font><font color="#000080">);
   </font>H <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph1<font color="#000080">,</font><font color="#800000">'H'</font><font color="#000080">);
   </font>I <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph1<font color="#000080">,</font><font color="#800000">'I'</font><font color="#000080">);
   </font>J <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph1<font color="#000080">,</font><font color="#800000">'J'</font><font color="#000080">);
   </font>K <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph2<font color="#000080">,</font><font color="#800000">'A'</font><font color="#000080">);
   </font>L <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph2<font color="#000080">,</font><font color="#800000">'B'</font><font color="#000080">);
   </font>M <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>Grph2<font color="#000080">,</font><font color="#800000">'C'</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>A<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);                                   </font><font color="#008000"><i>(* Join vertices *)
   </i></font>WtdJoin<font color="#000080">(</font>A<font color="#000080">,</font>E<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>B<font color="#000080">,</font>A<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>B<font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>B<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>B<font color="#000080">,</font>E<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>C<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>C<font color="#000080">,</font>D<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>C<font color="#000080">,</font>G<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>C<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>D<font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>D<font color="#000080">,</font>G<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>E<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>E<font color="#000080">,</font>A<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>E<font color="#000080">,</font>H<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>E<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>F<font color="#000080">,</font>E<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>F<font color="#000080">,</font>G<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>F<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>F<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>F<font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>F<font color="#000080">,</font>H<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>G<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>G<font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>G<font color="#000080">,</font>D<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>G<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>H<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>H<font color="#000080">,</font>E<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>H<font color="#000080">,</font>J<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>H<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>I<font color="#000080">,</font>H<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>I<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>I<font color="#000080">,</font>G<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>I<font color="#000080">,</font>J<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>J<font color="#000080">,</font>H<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>J<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>K<font color="#000080">,</font>L<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>L<font color="#000080">,</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>ClrScr<font color="#000080">;                                           </font><font color="#008000"><i>(* display graph 1 *)
   </i></font>writeln<font color="#000080">(</font><font color="#800000">'                         Graph 1'</font><font color="#000080">);
   </font>BFTraverse<font color="#000080">( </font>Grph1<font color="#000080">,</font>c <font color="#000080">);
   </font>Window<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font><font color="#800000">'Adjacency Matrix'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font><font color="#800000">'&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;'</font><font color="#000080">);
   </font>writeln<font color="#000080">;
   </font>PrintGraph<font color="#000080">( </font>Grph1 <font color="#000080">);
   </font>delay<font color="#000080">(</font><font color="#800000">5000</font><font color="#000080">);
   </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);                                </font><font color="#008000"><i>(* display graph 2 *)
   </i></font>ClrScr<font color="#000080">;
   </font>writeln<font color="#000080">(</font><font color="#800000">'                         Graph 2'</font><font color="#000080">);
   </font>BFTraverse<font color="#000080">( </font>Grph2<font color="#000080">,</font>k <font color="#000080">);
   </font>Window<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font><font color="#800000">'Adjacency Matrix'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font><font color="#800000">'&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;'</font><font color="#000080">);
   </font>writeln<font color="#000080">;
   </font>PrintGraph<font color="#000080">( </font>Grph2 <font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p></body>
</html>
