<html>
<head><title> "Generic Linked List" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>LinkList<font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------
          Generic linked list object            -
-------------------------------------------------}

{***************************************************************}
                          </i></font><font color="#FF0000"><b>INTERFACE
</b></font><font color="#008000"><i>{***************************************************************}

</i></font><font color="#FF0000"><b>TYPE

    </b></font><font color="#008000"><i>{ Generic Linked List Handler Definition }

  </i></font>NodeValuePtr <font color="#000080">= ^</font>NodeValue<font color="#000080">;

  </font>NodeValue <font color="#000080">= </font><font color="#FF0000"><b>OBJECT
    CONSTRUCTOR </b></font>Init<font color="#000080">;
    </font><font color="#FF0000"><b>DESTRUCTOR  </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>NodePtr <font color="#000080">= ^</font>Node<font color="#000080">;
  </font>Node <font color="#000080">= </font><font color="#FF0000"><b>RECORD
    </b></font>Retrieve <font color="#000080">: </font>NodeValuePtr<font color="#000080">;
    </font>Next     <font color="#000080">: </font>NodePtr<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


    </font><font color="#008000"><i>{ Specific Linked List Handler Definition }

  </i></font>NodeListPtr <font color="#000080">= ^</font>NodeList<font color="#000080">;

  </font>NodeList <font color="#000080">= </font><font color="#FF0000"><b>OBJECT
    </b></font>Items <font color="#000080">: </font>NodePtr<font color="#000080">;
    </font><font color="#FF0000"><b>CONSTRUCTOR </b></font>Init<font color="#000080">;
    </font><font color="#FF0000"><b>DESTRUCTOR </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>PROCEDURE </b></font>Add <font color="#000080">(</font>A_Value <font color="#000080">: </font>NodeValuePtr<font color="#000080">);

    </font><font color="#008000"><i>(* Iterator Functions *)

    </i></font><font color="#FF0000"><b>PROCEDURE </b></font>StartIterator <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Ptr <font color="#000080">: </font>NodePtr<font color="#000080">);
    </font><font color="#FF0000"><b>PROCEDURE </b></font>NextValue <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Ptr <font color="#000080">: </font>NodePtr<font color="#000080">);
    </font><font color="#FF0000"><b>FUNCTION </b></font>AtEndOfList <font color="#000080">(</font>Ptr <font color="#000080">: </font>NodePtr<font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{***************************************************************}
                         </i></font><font color="#FF0000"><b>IMPLEMENTATION
</b></font><font color="#008000"><i>{***************************************************************}


</i></font><font color="#FF0000"><b>CONSTRUCTOR </b></font>NodeValue<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>DESTRUCTOR </b></font>NodeValue<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>CONSTRUCTOR </b></font>NodeList<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Items <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>DESTRUCTOR </b></font>NodeList<font color="#000080">.</font>Done<font color="#000080">;
    </font><font color="#FF0000"><b>VAR
         </b></font>Temp <font color="#000080">: </font>NodePtr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
    WHILE </b></font>Items <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL DO
    BEGIN
         </b></font>Temp <font color="#000080">:= </font>Items<font color="#000080">;
         </font><font color="#FF0000"><b>IF </b></font>Temp<font color="#000080">^.</font>Retrieve <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL THEN
              </b></font>Dispose <font color="#000080">(</font>Temp<font color="#000080">^.</font>Retrieve<font color="#000080">, </font>Done<font color="#000080">);
         </font>Items <font color="#000080">:= </font>Items<font color="#000080">^.</font>Next<font color="#000080">;
         </font>Dispose <font color="#000080">(</font>Temp<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>NodeList<font color="#000080">.</font>Add <font color="#000080">(</font>A_Value <font color="#000080">: </font>NodeValuePtr<font color="#000080">);
    </font><font color="#FF0000"><b>VAR
         </b></font>Cell <font color="#000080">: </font>NodePtr<font color="#000080">;
         </font>Temp <font color="#000080">: </font>NodePtr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
    </b></font><font color="#008000"><i>(* Go TO the END OF the linked list. *)
    </i></font>Cell <font color="#000080">:= </font>Items<font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>Cell <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL THEN
         WHILE </b></font>Cell<font color="#000080">^.</font>Next <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL DO
              </b></font>Cell <font color="#000080">:= </font>Cell<font color="#000080">^.</font>Next<font color="#000080">;

    </font>New <font color="#000080">(</font>Temp<font color="#000080">);
    </font>Temp<font color="#000080">^.</font>Retrieve <font color="#000080">:= </font>A_Value<font color="#000080">;
    </font>Temp<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>Items <font color="#000080">= </font><font color="#FF0000"><b>NIL
    THEN
         </b></font>Items <font color="#000080">:= </font>Temp
    <font color="#FF0000"><b>ELSE
         </b></font>Cell<font color="#000080">^.</font>Next <font color="#000080">:= </font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>NodeList<font color="#000080">.</font>StartIterator <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Ptr <font color="#000080">: </font>NodePtr<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
    </b></font>Ptr <font color="#000080">:= </font>Items<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>NodeList<font color="#000080">.</font>NextValue <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Ptr <font color="#000080">: </font>NodePtr<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
    IF </b></font>Ptr <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL THEN
    </b></font>Ptr <font color="#000080">:= </font>Ptr<font color="#000080">^.</font>Next<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>NodeList<font color="#000080">.</font>AtEndOfList <font color="#000080">(</font>Ptr <font color="#000080">: </font>NodePtr<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>AtEndOfList <font color="#000080">:= (</font>Ptr <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{ DEMO PROGRAM }

</i></font><font color="#FF0000"><b>PROGRAM </b></font>LL_Demo<font color="#000080">;

</font><font color="#FF0000"><b>USES </b></font>LinkList<font color="#000080">;

</font><font color="#008000"><i>{ Turbo Pascal Linked List Object Example }

</i></font><font color="#FF0000"><b>TYPE

  </b></font>DataValuePtr <font color="#000080">= ^</font>DataValue<font color="#000080">;

  </font>DataValue <font color="#000080">= </font><font color="#FF0000"><b>OBJECT </b></font><font color="#000080">(</font>NodeValue<font color="#000080">)
    </font>Value <font color="#000080">: </font>Real<font color="#000080">;
    </font><font color="#FF0000"><b>CONSTRUCTOR </b></font>Init <font color="#000080">(</font>A_Value <font color="#000080">: </font>Real<font color="#000080">);
    </font><font color="#FF0000"><b>FUNCTION </b></font>TheValue <font color="#000080">: </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>DataList <font color="#000080">= </font><font color="#FF0000"><b>OBJECT </b></font><font color="#000080">(</font>NodeList<font color="#000080">)
    </font><font color="#FF0000"><b>FUNCTION </b></font>CurrentValue <font color="#000080">(</font>Ptr <font color="#000080">: </font>NodePtr<font color="#000080">) : </font>Real<font color="#000080">;
    </font><font color="#FF0000"><b>PROCEDURE </b></font>SetCurrentValue <font color="#000080">(</font>Ptr <font color="#000080">: </font>NodePtr<font color="#000080">; </font>Value <font color="#000080">: </font>Real<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
    </b></font>Itr <font color="#000080">: </font>NodePtr<font color="#000080">;
    </font>TestLink <font color="#000080">: </font>DataList<font color="#000080">;

</font><font color="#008000"><i>{------ Unique methods to create for your linked list type -----}

</i></font><font color="#FF0000"><b>CONSTRUCTOR </b></font>DataValue<font color="#000080">.</font>Init <font color="#000080">(</font>A_Value <font color="#000080">: </font>Real<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
    </b></font>Value <font color="#000080">:= </font>A_Value<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>DataValue<font color="#000080">.</font>TheValue <font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>TheValue <font color="#000080">:= </font>Value<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>DataList<font color="#000080">.</font>CurrentValue <font color="#000080">(</font>Ptr <font color="#000080">: </font>NodePtr<font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>CurrentValue <font color="#000080">:= </font>DataValuePtr <font color="#000080">(</font>Ptr<font color="#000080">^.</font>Retrieve<font color="#000080">)^.</font>TheValue<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DataList<font color="#000080">.</font>SetCurrentValue <font color="#000080">(</font>Ptr <font color="#000080">: </font>NodePtr<font color="#000080">; </font>Value <font color="#000080">: </font>Real<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>DataValuePtr <font color="#000080">(</font>Ptr<font color="#000080">^.</font>Retrieve<font color="#000080">)^.</font>Value <font color="#000080">:= </font>Value<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>BEGIN
  </b></font>TestLink<font color="#000080">.</font>Init<font color="#000080">;        </font><font color="#008000"><i>{Create the list then add 5 values to it}

  </i></font>TestLink<font color="#000080">.</font>Add <font color="#000080">(</font>New <font color="#000080">(</font>DataValuePtr<font color="#000080">, </font>Init <font color="#000080">(</font><font color="#800000">1.0</font><font color="#000080">)));
  </font>TestLink<font color="#000080">.</font>Add <font color="#000080">(</font>New <font color="#000080">(</font>DataValuePtr<font color="#000080">, </font>Init <font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">)));
  </font>TestLink<font color="#000080">.</font>Add <font color="#000080">(</font>New <font color="#000080">(</font>DataValuePtr<font color="#000080">, </font>Init <font color="#000080">(</font><font color="#800000">3.0</font><font color="#000080">)));
  </font>TestLink<font color="#000080">.</font>Add <font color="#000080">(</font>New <font color="#000080">(</font>DataValuePtr<font color="#000080">, </font>Init <font color="#000080">(</font><font color="#800000">4.0</font><font color="#000080">)));
  </font>TestLink<font color="#000080">.</font>Add <font color="#000080">(</font>New <font color="#000080">(</font>DataValuePtr<font color="#000080">, </font>Init <font color="#000080">(</font><font color="#800000">5.0</font><font color="#000080">)));

  </font>TestLink<font color="#000080">.</font>StartIterator <font color="#000080">(</font>Itr<font color="#000080">);      </font><font color="#008000"><i>{Display the list on screen}
  </i></font><font color="#FF0000"><b>WHILE NOT </b></font>TestLink<font color="#000080">.</font>AtEndOfList <font color="#000080">(</font>Itr<font color="#000080">) </font><font color="#FF0000"><b>DO BEGIN
    </b></font>Write <font color="#000080">(</font>TestLink<font color="#000080">.</font>CurrentValue <font color="#000080">(</font>Itr<font color="#000080">) : </font><font color="#800000">5 </font><font color="#000080">: </font><font color="#800000">1</font><font color="#000080">);
    </font>TestLink<font color="#000080">.</font>NextValue <font color="#000080">(</font>Itr<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WriteLn<font color="#000080">;

  </font>TestLink<font color="#000080">.</font>StartIterator <font color="#000080">(</font>Itr<font color="#000080">);  </font><font color="#008000"><i>{Change some values in the list}
  </i></font>TestLink<font color="#000080">.</font>SetCurrentValue <font color="#000080">(</font>Itr<font color="#000080">, </font><font color="#800000">0.0</font><font color="#000080">);
  </font>TestLink<font color="#000080">.</font>NextValue <font color="#000080">(</font>Itr<font color="#000080">);
  </font>TestLink<font color="#000080">.</font>SetCurrentValue <font color="#000080">(</font>Itr<font color="#000080">, -</font><font color="#800000">1.0</font><font color="#000080">);

  </font>TestLink<font color="#000080">.</font>StartIterator <font color="#000080">(</font>Itr<font color="#000080">);       </font><font color="#008000"><i>{Redisplay the list values}
  </i></font><font color="#FF0000"><b>WHILE NOT </b></font>TestLink<font color="#000080">.</font>AtEndOfList <font color="#000080">(</font>Itr<font color="#000080">) </font><font color="#FF0000"><b>DO BEGIN
    </b></font>Write <font color="#000080">(</font>TestLink<font color="#000080">.</font>CurrentValue <font color="#000080">(</font>Itr<font color="#000080">) : </font><font color="#800000">5 </font><font color="#000080">: </font><font color="#800000">1</font><font color="#000080">);
    </font>TestLink<font color="#000080">.</font>NextValue <font color="#000080">(</font>Itr<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WriteLn<font color="#000080">;
  </font>ReadLn<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
