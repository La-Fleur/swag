<html>
<head><title> "Linked List Queues" by WARREN PORTER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&sup3; I'm trying to understand the rudiments of linked lists

&sup3; 4) What are common uses for linked lists?  Is any one particular form
&sup3;    (oneway, circular etc ) preferred or used over any other form?

One use is to maintain queues.  New people, requests, or jobs come in at
the end of the line (or break in with priority), but once the head of
the line has been serviced, there is no need to maintain its location in
the queue.  I wrote the following last semester:
---------------------------------------------------------------
Purpose:
  Maintains a queue of jobs and priorities of those jobs in a linked list.
  The user will be prompted for job number and priority and can list the
  queue, remove a job from the front of the queue (as if it ran), and stop
  the program.  A count of jobs outstanding at the end will be displayed. }

</i></font><font color="#FF0000"><b>type
  </b></font>PriRange <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">.. </font><font color="#800000">9</font><font color="#000080">;
  </font>JobPnt   <font color="#000080">= ^</font>JobNode<font color="#000080">;
  </font>Jobnode  <font color="#000080">= </font><font color="#FF0000"><b>RECORD
    </b></font>Numb     <font color="#000080">: </font>integer<font color="#000080">;
    </font>Priority <font color="#000080">: </font>PriRange<font color="#000080">;
    </font>Link     <font color="#000080">: </font>JobPnt
  <font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>addrec<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Start <font color="#000080">: </font>JobPnt<font color="#000080">; </font>comprec <font color="#000080">: </font>Jobnode<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>curr<font color="#000080">,
  </font>next<font color="#000080">,
  </font>this  <font color="#000080">: </font>JobPnt<font color="#000080">;
  </font>found <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>new<font color="#000080">(</font>this<font color="#000080">);
  </font>this<font color="#000080">^.</font>Numb <font color="#000080">:= </font>comprec<font color="#000080">.</font>Numb<font color="#000080">;
  </font>this<font color="#000080">^.</font>Priority <font color="#000080">:= </font>comprec<font color="#000080">.</font>Priority<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Start <font color="#000080">= </font><font color="#FF0000"><b>NIL then
  begin
    </b></font>Start <font color="#000080">:= </font>this<font color="#000080">;   </font><font color="#008000"><i>{Points to node just built}
    </i></font>Start<font color="#000080">^.</font>Link <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">; </font><font color="#008000"><i>{Is end of list}
  </i></font><font color="#FF0000"><b>end
  else    </b></font><font color="#008000"><i>{Chain exists, find a place to insert it}
  </i></font><font color="#FF0000"><b>if </b></font>comprec<font color="#000080">.</font>Priority <font color="#000080">&gt; </font>Start<font color="#000080">^.</font>Priority <font color="#FF0000"><b>then
  begin
    </b></font>this<font color="#000080">^.</font>Link <font color="#000080">:= </font>Start<font color="#000080">;     </font><font color="#008000"><i>{Prep for a new beg of chain}
    </i></font>Start <font color="#000080">:= </font>this
  <font color="#FF0000"><b>end </b></font><font color="#008000"><i>{Condition for insert at beg of chain}
  </i></font><font color="#FF0000"><b>else
  begin </b></font><font color="#008000"><i>{Begin loop to insert after beg of chain}
    </i></font>found <font color="#000080">:= </font>false<font color="#000080">;  </font><font color="#008000"><i>{To initialize}
    </i></font>curr  <font color="#000080">:= </font>start<font color="#000080">;
    </font><font color="#FF0000"><b>while not </b></font>found <font color="#FF0000"><b>do
    begin
      </b></font>next <font color="#000080">:= </font>curr<font color="#000080">^.</font>link<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>next <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>comprec<font color="#000080">.</font>Priority <font color="#000080">&gt; </font>next<font color="#000080">^.</font>Priority<font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>found <font color="#000080">:= </font>true<font color="#000080">;
        </font><font color="#FF0000"><b>if not </b></font>found <font color="#FF0000"><b>then
          </b></font>curr<font color="#000080">:= </font>next  <font color="#008000"><i>{another iteration needed}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#008000"><i>{Have found this^ goes after curr^ and before next^}
    </i></font>this<font color="#000080">^.</font>Link <font color="#000080">:= </font>next<font color="#000080">; </font><font color="#008000"><i>{Chain to end (even if NIL)}
    </i></font>curr<font color="#000080">^.</font>Link <font color="#000080">:= </font>this<font color="#000080">;  </font><font color="#008000"><i>{Insertion complete}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>remove<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Start <font color="#000080">: </font>JobPnt<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>hold <font color="#000080">: </font>JobPnt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Start <font color="#000080">= </font><font color="#FF0000"><b>NIL then
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Cannot remove from empty queue'</font><font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">))
  </font><font color="#FF0000"><b>else
  begin
    </b></font>hold <font color="#000080">:= </font>Start<font color="#000080">^.</font>Link<font color="#000080">; </font><font color="#008000"><i>{Save 1st node of new chain}
    </i></font>dispose<font color="#000080">(</font>Start<font color="#000080">);     </font><font color="#008000"><i>{Delete org from chain}
    </i></font>Start <font color="#000080">:= </font>hold<font color="#000080">;       </font><font color="#008000"><i>{Reset to new next job}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>list<font color="#000080">(</font>Start <font color="#000080">: </font>JobPnt<font color="#000080">); </font><font color="#008000"><i>{List all jobs in queue. &quot;var&quot; omitted}
</i></font><font color="#FF0000"><b>begin
  if </b></font>Start <font color="#000080">= </font><font color="#FF0000"><b>NIL then
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'No jobs in queue'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
  begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Job No     Priority'</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font>Start <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL do
    begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'  '</font><font color="#000080">,</font>Start<font color="#000080">^.</font>Numb <font color="#000080">: </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">'          '</font><font color="#000080">, </font>Start<font color="#000080">^.</font>Priority<font color="#000080">);
      </font>Start<font color="#000080">:=</font>Start<font color="#000080">^.</font>Link
    <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">(</font><font color="#800000">'End of List'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Main Procedure starts here}
</i></font><font color="#FF0000"><b>var
  </b></font>cntr  <font color="#000080">: </font>integer<font color="#000080">;
  </font>build <font color="#000080">: </font>JobNode<font color="#000080">;
  </font>work<font color="#000080">,
  </font>Start <font color="#000080">: </font>JobPnt<font color="#000080">;
  </font>Achar <font color="#000080">: </font>char<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Start <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">; </font><font color="#008000"><i>{Empty at first}
  </i></font>cntr  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>REPEAT
    </b></font>Write<font color="#000080">(</font><font color="#800000">'Enter (S)top, (R)emove, (L)ist, or A jobnumb priority to'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">' add to queue'</font><font color="#000080">);
    </font>Read<font color="#000080">(</font>Achar<font color="#000080">);

    </font><font color="#FF0000"><b>CASE </b></font>Achar <font color="#FF0000"><b>of
      </b></font><font color="#800000">'A'</font><font color="#000080">, </font><font color="#800000">'a' </font><font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Read<font color="#000080">(</font>build<font color="#000080">.</font>Numb<font color="#000080">);
        </font><font color="#FF0000"><b>REPEAT
          </b></font>Readln<font color="#000080">(</font>build<font color="#000080">.</font>Priority<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>build<font color="#000080">.</font>Priority <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>build<font color="#000080">.</font>priority <font color="#000080">&gt; </font><font color="#800000">9</font><font color="#000080">) </font><font color="#FF0000"><b>then
            </b></font>Write<font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">), </font><font color="#800000">'Priority between 0 and 9, try again '</font><font color="#000080">);
        </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>build<font color="#000080">.</font>Priority <font color="#000080">&gt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>build<font color="#000080">.</font>Priority <font color="#000080">&lt;= </font><font color="#800000">9</font><font color="#000080">);
        </font>addrec<font color="#000080">(</font>Start<font color="#000080">, </font>build<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'R'</font><font color="#000080">, </font><font color="#800000">'r' </font><font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Readln<font color="#000080">;
        </font>remove<font color="#000080">(</font>Start<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'L'</font><font color="#000080">, </font><font color="#800000">'l' </font><font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Readln<font color="#000080">;
        </font>list<font color="#000080">(</font>Start<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'S'</font><font color="#000080">, </font><font color="#800000">'s' </font><font color="#000080">: </font>Readln<font color="#000080">; </font><font color="#008000"><i>{Will wait until out of CASE loop}

      </i></font><font color="#FF0000"><b>else
      begin
        </b></font>Readln<font color="#000080">;
        </font>Writeln<font color="#000080">(</font><font color="#800000">'Invalid option'</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">))
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>Achar <font color="#000080">= </font><font color="#800000">'s'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Achar <font color="#000080">= </font><font color="#800000">'S'</font><font color="#000080">);
  </font>work <font color="#000080">:= </font>start<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>work <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL do
  begin
    </b></font>cntr <font color="#000080">:= </font>cntr <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>work <font color="#000080">:= </font>work<font color="#000080">^.</font>link
  <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Number of jobs remaining in queue: '</font><font color="#000080">, </font>cntr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p></body>
</html>
