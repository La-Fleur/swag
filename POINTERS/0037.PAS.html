<html>
<head><title> "Dynamically Sized List Unit" by MICHAEL DALES</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0037.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>Lists<font color="#000080">;

</font><font color="#008000"><i>{--------------------------------------------------------------------------}
{ Abstract Data Type for dynamically sized list                            }
{ By Michael Dales 30th May 1996                                           }
{                                                                          }
{ Here is a simple list unit, that has the advantage of being dynamically  }
{ sized, unlike normal arrays. To use the list you only need to know the   }
{ data type names and the methods declared in the interface of this unit   }
{ are used to manipulate them without the need to know the underlying      }
{ representation.                                                          }
{                                                                          }
{ Deaclare your list variable to be of type TList, and remeber to use      }
{ CreateList on it before you carry out any operations using it. Data is   }
{ stored in nodes as pointers, just so you can have a list which isn't     }
{ tied to just one kind of data type. Remeber though that because of this  }
{ you'll need to typecast your pointers when you retrieve them from the    }
{ list. Each node is has a type called PListNode, and an invalid node has  }
{ the value null.                                                          }
{                                                                          }
{ Email comments to: 9402198d@udcf.gla.ac.uk                               }
{ URL: http://www.gla.ac.uk/Clubs/WebSoc/~9402198d/index.html              }
{--------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>interface

const </b></font>null <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;        </font><font color="#008000"><i>{Non specific terminator}

</i></font><font color="#FF0000"><b>type </b></font>PListNode <font color="#000080">= ^</font>TListNode<font color="#000080">;             </font><font color="#008000"><i>{Pointer to node}
     </i></font>TListNode <font color="#000080">= </font><font color="#FF0000"><b>record                  </b></font><font color="#008000"><i>{Node record}
               </i></font>Item      <font color="#000080">: </font>Pointer<font color="#000080">;      </font><font color="#008000"><i>{Pointer to node data}
               </i></font>Next      <font color="#000080">: </font>PListNode<font color="#000080">;    </font><font color="#008000"><i>{Next node}
               </i></font>Previous  <font color="#000080">: </font>PListNode<font color="#000080">;    </font><font color="#008000"><i>{Previous node}
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>TList <font color="#000080">= </font><font color="#FF0000"><b>record                   </b></font><font color="#008000"><i>{Holder for list}
           </i></font>First <font color="#000080">: </font>PListNode<font color="#000080">;         </font><font color="#008000"><i>{Pointer to start of list}
           </i></font>Rear  <font color="#000080">: </font>PListNode<font color="#000080">;         </font><font color="#008000"><i>{Pointer to end of list}
           </i></font>Size  <font color="#000080">: </font>integer<font color="#000080">;           </font><font color="#008000"><i>{Size of list}
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{CreateList - Initiates a new list}
</i></font><font color="#FF0000"><b>procedure </b></font>CreateList<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>L <font color="#000080">: </font>TList<font color="#000080">);

</font><font color="#008000"><i>{DestroyList - Frees up all memory used by list and sets list to nil}
</i></font><font color="#FF0000"><b>procedure </b></font>DestroyList<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>L <font color="#000080">: </font>TList<font color="#000080">);

</font><font color="#008000"><i>{AddNewNode - Adds new node to list L, filling it with the data
              supplied. Returns true is new node sucessfully
              added, otherwise returns false.}
</i></font><font color="#FF0000"><b>procedure </b></font>AddNewNode<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>L <font color="#000080">: </font>TList<font color="#000080">; </font>Data <font color="#000080">: </font>Pointer<font color="#000080">);

</font><font color="#008000"><i>{DeleteListElement - Deletes an element passed.}
</i></font><font color="#FF0000"><b>procedure </b></font>DeleteNode<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>L <font color="#000080">: </font>TList<font color="#000080">; </font>ANode <font color="#000080">: </font>PListNode<font color="#000080">);

</font><font color="#008000"><i>{GetFirstNode - Returns the first node in a given list}
</i></font><font color="#FF0000"><b>function </b></font>GetFirstNode<font color="#000080">(</font>L<font color="#000080">:</font>TList<font color="#000080">):</font>PListNode<font color="#000080">;

</font><font color="#008000"><i>{GetNextNode - Returns the successor of the given node}
</i></font><font color="#FF0000"><b>function </b></font>GetNextNode<font color="#000080">(</font>Node<font color="#000080">:</font>PListNode<font color="#000080">):</font>PListNode<font color="#000080">;

</font><font color="#008000"><i>{GetNodeData - Returns the data in a specific node}
</i></font><font color="#FF0000"><b>procedure </b></font>GetNodeData<font color="#000080">(</font>Node<font color="#000080">:</font>PListNode<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Data<font color="#000080">:</font>Pointer<font color="#000080">);

</font><font color="#008000"><i>{UpdateNode - Replaces a nodes details with new ones}
</i></font><font color="#FF0000"><b>procedure </b></font>UpdateNode<font color="#000080">(</font>Node<font color="#000080">:</font>PListNode<font color="#000080">; </font>Data<font color="#000080">:</font>Pointer<font color="#000080">);

</font><font color="#008000"><i>{--------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>implementation
</b></font><font color="#008000"><i>{--------------------------------------------------------------------------}

    {CreateList - Initiates a new list}

</i></font><font color="#FF0000"><b>procedure </b></font>CreateList<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>L <font color="#000080">: </font>TList<font color="#000080">);
</font><font color="#FF0000"><b>begin
     </b></font>L<font color="#000080">.</font>First <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;      </font><font color="#008000"><i>{No list yet}
     </i></font>L<font color="#000080">.</font>Rear <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
     </font>L<font color="#000080">.</font>Size <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;         </font><font color="#008000"><i>{No length yet}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


    </font><font color="#008000"><i>{RemoveLastNode - Deletes last node on the list}

</i></font><font color="#FF0000"><b>procedure </b></font>RemoveLastNode<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>L <font color="#000080">: </font>TList<font color="#000080">);
</font><font color="#FF0000"><b>begin
     with </b></font>L <font color="#FF0000"><b>do                                  </b></font><font color="#008000"><i>{With the list}
     </i></font><font color="#FF0000"><b>begin
          if </b></font>Size <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then                        </b></font><font color="#008000"><i>{If nodes in list}
          </i></font><font color="#FF0000"><b>begin
               if </b></font>Size <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then                   </b></font><font color="#008000"><i>{If just one node}
               </i></font><font color="#FF0000"><b>begin
                    if </b></font>First<font color="#000080">^.</font>Item <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then  </b></font><font color="#008000"><i>{If data in node then}
                       </i></font>Dispose<font color="#000080">(</font>First<font color="#000080">^.</font>Item<font color="#000080">);        </font><font color="#008000"><i>{Dispose of it}
                    </i></font>Dispose<font color="#000080">(</font>First<font color="#000080">);             </font><font color="#008000"><i>{Dispose of first node}
                    </i></font>First <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
                    </font>Rear <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;                  </font><font color="#008000"><i>{Set rear to nil}
               </i></font><font color="#FF0000"><b>end else
               begin                            </b></font><font color="#008000"><i>{If more than one node}
                    </i></font>Rear <font color="#000080">:= </font>Rear<font color="#000080">^.</font>Previous<font color="#000080">;       </font><font color="#008000"><i>{Set rear to second last}
                    </i></font>Dispose<font color="#000080">(</font>Rear<font color="#000080">^.</font>Next<font color="#000080">);        </font><font color="#008000"><i>{Remove last node}
               </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font>Size <font color="#000080">:= </font>Size<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;                    </font><font color="#008000"><i>{Decrement list size}
          </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


    </font><font color="#008000"><i>{DestroyList - Frees up all memory used by list and sets list to nil}

</i></font><font color="#FF0000"><b>procedure </b></font>DestroyList<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>L <font color="#000080">: </font>TList<font color="#000080">);
</font><font color="#FF0000"><b>begin
     while </b></font>L<font color="#000080">.</font>First <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do              </b></font><font color="#008000"><i>{While still nodes left}
           </i></font>RemoveLastNode<font color="#000080">(</font>L<font color="#000080">);             </font><font color="#008000"><i>{Remove last node}
     </i></font>CreateList<font color="#000080">(</font>L<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


    </font><font color="#008000"><i>{GetFirstNode - Returns the first node in a given list}

</i></font><font color="#FF0000"><b>function </b></font>GetFirstNode<font color="#000080">(</font>L <font color="#000080">: </font>TList<font color="#000080">) : </font>PListNode<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>GetFirstNode <font color="#000080">:= </font>L<font color="#000080">.</font>First<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


    </font><font color="#008000"><i>{GetNextNode - Returns the successor of the given node}

</i></font><font color="#FF0000"><b>function </b></font>GetNextNode<font color="#000080">(</font>Node <font color="#000080">: </font>PListNode<font color="#000080">) : </font>PListNode<font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font>Node <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then
        </b></font>GetNextNode <font color="#000080">:= </font>Node<font color="#000080">^.</font>Next
     <font color="#FF0000"><b>else
         </b></font>GetNextNode <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


    </font><font color="#008000"><i>{GetNodeData - Returns the data in a specific node}

</i></font><font color="#FF0000"><b>procedure </b></font>GetNodeData<font color="#000080">(</font>Node <font color="#000080">: </font>PListNode<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Data <font color="#000080">: </font>Pointer<font color="#000080">);
</font><font color="#FF0000"><b>begin
     if </b></font>Node <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then
        </b></font>Data <font color="#000080">:= </font>Node<font color="#000080">^.</font>Item
     <font color="#FF0000"><b>else
         </b></font>Data <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


    </font><font color="#008000"><i>{AddNewNode - Adds new node to list L, filling it with the data
                  supplied. Returns true is new node sucessfully
                  added, otherwise returns false.}

</i></font><font color="#FF0000"><b>procedure </b></font>AddNewNode<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>L<font color="#000080">:</font>TList<font color="#000080">; </font>Data<font color="#000080">:</font>Pointer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>temp    <font color="#000080">: </font>PListNode<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>new<font color="#000080">(</font>temp<font color="#000080">);                 </font><font color="#008000"><i>{Create new node}
     </i></font><font color="#FF0000"><b>with </b></font>temp<font color="#000080">^ </font><font color="#FF0000"><b>do              </b></font><font color="#008000"><i>{Fill node}
     </i></font><font color="#FF0000"><b>begin
          </b></font>Item <font color="#000080">:= </font>Data<font color="#000080">;
          </font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
          </font>Previous <font color="#000080">:= </font>L<font color="#000080">.</font>Rear<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>L<font color="#000080">.</font>Size <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then         </b></font><font color="#008000"><i>{If empty list...}
     </i></font><font color="#FF0000"><b>begin
          </b></font>L<font color="#000080">.</font>First <font color="#000080">:= </font>temp<font color="#000080">;        </font><font color="#008000"><i>{Add as first node}
          </i></font>L<font color="#000080">.</font>Rear <font color="#000080">:= </font>temp<font color="#000080">;
     </font><font color="#FF0000"><b>end else                       </b></font><font color="#008000"><i>{else add at end}
     </i></font><font color="#FF0000"><b>begin
          </b></font>L<font color="#000080">.</font>Rear<font color="#000080">^.</font>Next <font color="#000080">:= </font>temp<font color="#000080">;  </font><font color="#008000"><i>{Make old rear of list point to new}
          </i></font>L<font color="#000080">.</font>Rear <font color="#000080">:= </font>temp<font color="#000080">;        </font><font color="#008000"><i>{Make rear point to new node}
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>L<font color="#000080">.</font>Size <font color="#000080">:= </font>L<font color="#000080">.</font>Size <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;          </font><font color="#008000"><i>{Increment list length}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


    </font><font color="#008000"><i>{UpdateNode - Replaces a nodes details with new ones}

</i></font><font color="#FF0000"><b>procedure </b></font>UpdateNode<font color="#000080">(</font>Node <font color="#000080">: </font>PListNode<font color="#000080">; </font>Data <font color="#000080">: </font>Pointer<font color="#000080">);
</font><font color="#FF0000"><b>begin
     if </b></font>Node <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then
     begin
          </b></font>Node<font color="#000080">^.</font>Item <font color="#000080">:= </font>Data<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


    </font><font color="#008000"><i>{DeleteListElement - Deletes an element passed.}

</i></font><font color="#FF0000"><b>procedure </b></font>DeleteNode<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>L <font color="#000080">: </font>TList<font color="#000080">; </font>ANode <font color="#000080">: </font>PListNode<font color="#000080">);
</font><font color="#FF0000"><b>begin
     if </b></font><font color="#000080">(</font>L<font color="#000080">.</font>Size <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ANode<font color="#000080">^.</font>Next <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then    </b></font><font color="#008000"><i>{If we're deeling with}
        </i></font>RemoveLastNode<font color="#000080">(</font>L<font color="#000080">)            </font><font color="#008000"><i>{last node then that's easy}
     </i></font><font color="#FF0000"><b>else                            </b></font><font color="#008000"><i>{otherwise...}
     </i></font><font color="#FF0000"><b>begin
          if </b></font><font color="#000080">(</font>ANode <font color="#000080">= </font>L<font color="#000080">.</font>First<font color="#000080">) </font><font color="#FF0000"><b>then      </b></font><font color="#008000"><i>{if we're deleting the first node}
          </i></font><font color="#FF0000"><b>begin
               </b></font>L<font color="#000080">.</font>First <font color="#000080">:= </font>L<font color="#000080">.</font>First<font color="#000080">^.</font>Next<font color="#000080">;    </font><font color="#008000"><i>{Start list from second node}
               </i></font>L<font color="#000080">.</font>First<font color="#000080">^.</font>Previous <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;    </font><font color="#008000"><i>{Set new starts previous link}
               </i></font>Dispose<font color="#000080">(</font>ANode<font color="#000080">);              </font><font color="#008000"><i>{Dispose of old first}
          </i></font><font color="#FF0000"><b>end else
          begin
               </b></font>ANode<font color="#000080">^.</font>Previous<font color="#000080">^.</font>Next <font color="#000080">:= </font>ANode<font color="#000080">^.</font>next<font color="#000080">;     </font><font color="#008000"><i>{Move pointers...}
               </i></font>ANode<font color="#000080">^.</font>Next<font color="#000080">^.</font>Previous <font color="#000080">:= </font>ANode<font color="#000080">^.</font>Previous<font color="#000080">;
               </font>Dispose<font color="#000080">(</font>ANode<font color="#000080">);          </font><font color="#008000"><i>{Dispose of node}
          </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>L<font color="#000080">.</font>Size <font color="#000080">:= </font>L<font color="#000080">.</font>Size<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;           </font><font color="#008000"><i>{Note new list size}
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0037.PAS">Original</a><b>]</b></p></body>
</html>
