<html>
<head><title> "OOP Linked Lists" by MARK GAUTHIER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>MgLinked<font color="#000080">;

</font><font color="#FF0000"><b>interface

const

      </b></font><font color="#008000"><i>{ Error list. }
      </i></font>Succes       <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">;
      </font>Need_Mem     <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">;
      </font>Point_To_Nil <font color="#000080">= </font><font color="#800000">$02</font><font color="#000080">;

</font><font color="#FF0000"><b>type

  </b></font>DoubleLstPtr <font color="#000080">= ^</font>DoubleLst<font color="#000080">;
  </font>DoubleLst    <font color="#000080">= </font><font color="#FF0000"><b>record
                   </b></font>Serial       <font color="#000080">: </font>longint<font color="#000080">;
                   </font>Size         <font color="#000080">: </font>word<font color="#000080">;
                   </font>Addresse     <font color="#000080">: </font>pointer<font color="#000080">;
                   </font>Next         <font color="#000080">: </font>DoubleLstPtr<font color="#000080">;
                   </font>Previous     <font color="#000080">: </font>DoubleLstPtr<font color="#000080">;
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


  </font>PDoubleLst <font color="#000080">= ^</font>ODoubleLst<font color="#000080">;
  </font>ODoubleLst <font color="#000080">= </font><font color="#FF0000"><b>object

    private
    </b></font>LastCodeErr <font color="#000080">: </font>word<font color="#000080">;          </font><font color="#008000"><i>{-- Last error.         --}

    </i></font><font color="#FF0000"><b>public
    </b></font>TotalObj    <font color="#000080">: </font>longint<font color="#000080">;       </font><font color="#008000"><i>{-- Total obj allocate. --}
    </i></font>CurentObj   <font color="#000080">: </font>DoubleLstPtr<font color="#000080">;  </font><font color="#008000"><i>{-- Curent obj number.  --}

    </i></font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Install<font color="#000080">:</font>boolean<font color="#000080">; </font>Serial<font color="#000080">:</font>longint<font color="#000080">; </font>Size<font color="#000080">:</font>word<font color="#000080">;
</font>Data<font color="#000080">:</font>pointer<font color="#000080">);
    </font><font color="#008000"><i>{-- Initialise all variables, new curent.    ---}

    </i></font><font color="#FF0000"><b>destructor </b></font>Done<font color="#000080">;

    </font><font color="#008000"><i>{--- get and clear the last err. ---}
    </i></font><font color="#FF0000"><b>function  </b></font>LastError<font color="#000080">:</font>word<font color="#000080">;

    </font><font color="#008000"><i>{--- Seek to end and add an object.                            ---}
    </i></font><font color="#FF0000"><b>procedure </b></font>Add<font color="#000080">(</font>Size<font color="#000080">:</font>word<font color="#000080">; </font>Data<font color="#000080">:</font>pointer<font color="#000080">);

    </font><font color="#008000"><i>{--- Change the size of data of a object. 0 = change curent.   ---}
    </i></font><font color="#FF0000"><b>procedure </b></font>ChangeSize<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">; </font>NewSize <font color="#000080">: </font>word<font color="#000080">);

    </font><font color="#008000"><i>{--- Insert an object before the curent obj. 0 = insert curent pos ---}
    </i></font><font color="#FF0000"><b>procedure </b></font>Insert<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">; </font>Size<font color="#000080">:</font>word<font color="#000080">; </font>Data<font color="#000080">:</font>pointer<font color="#000080">);

    </font><font color="#008000"><i>{--- Delete an object from the list.  0 = delete curent.       ---}
    </i></font><font color="#FF0000"><b>procedure </b></font>Delete<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">);

    </font><font color="#008000"><i>{--- Pointe on next or end, etc.                               ---}
    </i></font><font color="#FF0000"><b>procedure </b></font>SeekFirst<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SeekLast<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SeekNext<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SeekPrevious<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SeekNum<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">);

    </font><font color="#008000"><i>{--- Move data from obj to user buffer                          ---}
    {--- 0 = use curent object.                                     ---}
    </i></font><font color="#FF0000"><b>function </b></font>MoveObjToPtr<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">; </font>p<font color="#000080">:</font>pointer<font color="#000080">):</font>word<font color="#000080">;

    </font><font color="#008000"><i>{--- Move user buffer to obj data.  obj data take ObjSize bytes ---}
    {--- 0 = use curent object.                                     ---}
    </i></font><font color="#FF0000"><b>function </b></font>MovePtrToObj<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">; </font>p<font color="#000080">:</font>pointer<font color="#000080">):</font>word<font color="#000080">;

  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>(****************************************************************************)

 </i></font><font color="#FF0000"><b>procedure </b></font>move<font color="#000080">(</font>Src<font color="#000080">,</font>Dst<font color="#000080">:</font>pointer<font color="#000080">; </font>Size<font color="#000080">:</font>word<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">lds si,Src
    les di,Dst
    mov cx,Size
    cld
    rep movsb
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>constructor </b></font>ODoubleLst<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Install<font color="#000080">:</font>boolean<font color="#000080">; </font>Serial<font color="#000080">:</font>longint<font color="#000080">; </font>Size<font color="#000080">:</font>word<font color="#000080">;
</font>Data<font color="#000080">:</font>pointer<font color="#000080">);
</font><font color="#008000"><i>{-- Initialise all variables, new curent.    ---}
</i></font><font color="#FF0000"><b>begin
     </b></font>Install <font color="#000080">:= </font>false<font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>Serial <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
     </font>New<font color="#000080">(</font>CurentObj<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>CurentObj <font color="#000080">= </font><font color="#FF0000"><b>nil then </b></font>exit<font color="#000080">;
     </font>GetMem<font color="#000080">(</font>CurentObj<font color="#000080">^.</font>Addresse<font color="#000080">, </font>Size<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>CurentObj<font color="#000080">^.</font>Addresse <font color="#000080">= </font><font color="#FF0000"><b>nil then
     begin
          </b></font>LastCodeErr <font color="#000080">:= </font>Need_Mem<font color="#000080">;
          </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>CurentObj<font color="#000080">^.</font>Next     <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
     </font>CurentObj<font color="#000080">^.</font>Previous <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
     </font>CurentObj<font color="#000080">^.</font>Size     <font color="#000080">:= </font>Size<font color="#000080">;
     </font>CurentObj<font color="#000080">^.</font>Serial   <font color="#000080">:= </font>Serial<font color="#000080">;
     </font>move<font color="#000080">(</font>Data<font color="#000080">, </font>CurentObj<font color="#000080">^.</font>Addresse<font color="#000080">, </font>Size<font color="#000080">);

     </font>TotalObj <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

     </font>Install             <font color="#000080">:= </font>true<font color="#000080">;
     </font>LastCodeErr         <font color="#000080">:= </font>Succes<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>destructor </b></font>ODoubleLst<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#008000"><i>{-- Initialise all variables, new curent.    ---}
</i></font><font color="#FF0000"><b>begin
     repeat </b></font>delete<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
     </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>LastError <font color="#000080">&lt;&gt; </font>Succes<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>TotalObj <font color="#000080">&lt;= </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>function  </b></font>ODoubleLst<font color="#000080">.</font>LastError<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#008000"><i>{--- get and clear the last err. ---}
</i></font><font color="#FF0000"><b>begin
     </b></font>LastError   <font color="#000080">:= </font>LastCodeErr<font color="#000080">;
     </font>LastCodeErr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>procedure </b></font>ODoubleLst<font color="#000080">.</font>Add<font color="#000080">(</font>Size<font color="#000080">:</font>word<font color="#000080">; </font>Data<font color="#000080">:</font>pointer<font color="#000080">);
</font><font color="#008000"><i>{--- Seek to end and add an object.                            ---}
</i></font><font color="#FF0000"><b>begin
     repeat </b></font>SeekNext <font color="#FF0000"><b>until </b></font>LastError <font color="#000080">&lt;&gt; </font>Succes<font color="#000080">; </font><font color="#008000"><i>{ SeekEnd }

     </i></font>New<font color="#000080">(</font>CurentObj<font color="#000080">^.</font>Next<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>CurentObj<font color="#000080">^.</font>Next <font color="#000080">= </font><font color="#FF0000"><b>nil then
     begin
          </b></font>LastCodeErr <font color="#000080">:= </font>Need_Mem<font color="#000080">;
          </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>GetMem<font color="#000080">(</font>CurentObj<font color="#000080">^.</font>Next<font color="#000080">^.</font>Addresse<font color="#000080">, </font>Size<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>CurentObj<font color="#000080">^.</font>Next<font color="#000080">^.</font>Addresse <font color="#000080">= </font><font color="#FF0000"><b>nil then
     begin
          </b></font>LastCodeErr <font color="#000080">:= </font>Need_Mem<font color="#000080">;
          </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>CurentObj<font color="#000080">^.</font>Next<font color="#000080">^.</font>Size <font color="#000080">:= </font>Size<font color="#000080">;

     </font><font color="#008000"><i>{ Store information data. }
     </i></font>move<font color="#000080">(</font>Data<font color="#000080">, </font>CurentObj<font color="#000080">^.</font>Next<font color="#000080">^.</font>Addresse<font color="#000080">, </font>Size<font color="#000080">);

     </font><font color="#008000"><i>{ Increment the total number of reccords. }
     </i></font>inc<font color="#000080">(</font>TotalObj<font color="#000080">);

     </font>CurentObj<font color="#000080">^.</font>Next<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
     </font>CurentObj<font color="#000080">^.</font>Next<font color="#000080">^.</font>Previous <font color="#000080">:= </font>CurentObj<font color="#000080">;

     </font>LastCodeErr <font color="#000080">:= </font>Succes<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>procedure </b></font>ODoubleLst<font color="#000080">.</font>ChangeSize<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">; </font>NewSize <font color="#000080">: </font>word<font color="#000080">);
</font><font color="#008000"><i>{--- Change the size of an object.                             ---}
</i></font><font color="#FF0000"><b>var </b></font>p<font color="#000080">:</font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>getmem<font color="#000080">(</font>p<font color="#000080">,</font>NewSize<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>p <font color="#000080">= </font><font color="#FF0000"><b>nil then
     begin
          </b></font>LastCodeErr <font color="#000080">:= </font>Need_mem<font color="#000080">;
          </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>SeekNum<font color="#000080">(</font>Serial<font color="#000080">);
     </font>move<font color="#000080">(</font>CurentObj<font color="#000080">^.</font>Addresse<font color="#000080">, </font>p<font color="#000080">, </font>NewSize<font color="#000080">);
     </font>freemem<font color="#000080">(</font>CurentObj<font color="#000080">^.</font>Addresse<font color="#000080">, </font>CurentObj<font color="#000080">^.</font>Size<font color="#000080">);
     </font>CurentObj<font color="#000080">^.</font>Size <font color="#000080">:= </font>NewSize<font color="#000080">;
     </font>CurentObj<font color="#000080">^.</font>Addresse <font color="#000080">:= </font>p<font color="#000080">;
     </font>LastCodeErr <font color="#000080">:= </font>Succes<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>procedure </b></font>ODoubleLst<font color="#000080">.</font>Insert<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">; </font>Size<font color="#000080">:</font>word<font color="#000080">; </font>Data<font color="#000080">:</font>pointer<font color="#000080">);
</font><font color="#008000"><i>{--- Insert an object before the curent obj.                   ---}
</i></font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">:</font>DoubleLstPtr<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>new<font color="#000080">(</font>n<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>n <font color="#000080">= </font><font color="#FF0000"><b>nil then
     begin
          </b></font>LastCodeErr <font color="#000080">:= </font>Need_mem<font color="#000080">;
          </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>SeekNum<font color="#000080">(</font>Serial<font color="#000080">);
     </font>getmem<font color="#000080">(</font>n<font color="#000080">^.</font>Addresse<font color="#000080">, </font>Size<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>n<font color="#000080">^.</font>Addresse <font color="#000080">= </font><font color="#FF0000"><b>nil then
     begin
          </b></font>LastCodeErr <font color="#000080">:= </font>Need_mem<font color="#000080">;
          </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>n<font color="#000080">^.</font>Size <font color="#000080">:= </font>Size<font color="#000080">;
     </font>move<font color="#000080">(</font>Data<font color="#000080">, </font>n<font color="#000080">^.</font>Addresse<font color="#000080">, </font>Size<font color="#000080">);

     </font>n<font color="#000080">^.</font>Previous <font color="#000080">:= </font>CurentObj<font color="#000080">^.</font>Previous<font color="#000080">;
     </font>n<font color="#000080">^.</font>Next     <font color="#000080">:= </font>CurentObj<font color="#000080">;

     </font>CurentObj<font color="#000080">^.</font>Previous<font color="#000080">^.</font>Next <font color="#000080">:= </font>n<font color="#000080">;
     </font>CurentObj<font color="#000080">^.</font>Previous       <font color="#000080">:= </font>n<font color="#000080">;

     </font>inc<font color="#000080">(</font>TotalObj<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>procedure </b></font>ODoubleLst<font color="#000080">.</font>Delete<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">);
</font><font color="#008000"><i>{--- Delete an object from the list.                           ---}
</i></font><font color="#FF0000"><b>begin
     </b></font>SeekNum<font color="#000080">(</font>Serial<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>CurentObj<font color="#000080">^.</font>Addresse <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then
     begin
           </b></font>FreeMem<font color="#000080">(</font>CurentObj<font color="#000080">^.</font>Addresse<font color="#000080">,</font>CurentObj<font color="#000080">^.</font>Size<font color="#000080">);
          </font>CurentObj<font color="#000080">^.</font>Addresse <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>CurentObj<font color="#000080">^.</font>Next<font color="#000080">^.</font>Previous <font color="#000080">:= </font>CurentObj<font color="#000080">^.</font>Previous<font color="#000080">;
     </font>CurentObj<font color="#000080">^.</font>Previous<font color="#000080">^.</font>Next <font color="#000080">:= </font>CurentObj<font color="#000080">^.</font>Next<font color="#000080">;

     </font><font color="#FF0000"><b>if </b></font>CurentObj <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then </b></font>Dispose<font color="#000080">(</font>CurentObj<font color="#000080">);
     </font>CurentObj <font color="#000080">:= </font>CurentObj<font color="#000080">^.</font>Previous<font color="#000080">;

     </font>dec<font color="#000080">(</font>TotalObj<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>procedure </b></font>ODoubleLst<font color="#000080">.</font>SeekLast<font color="#000080">;
</font><font color="#FF0000"><b>begin
     repeat </b></font>SeekNext <font color="#FF0000"><b>until </b></font>LastError <font color="#000080">&lt;&gt; </font>Succes<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>procedure </b></font>ODoubleLst<font color="#000080">.</font>SeekFirst<font color="#000080">;
</font><font color="#FF0000"><b>begin
     repeat </b></font>SeekPrevious <font color="#FF0000"><b>until </b></font>LastError <font color="#000080">&lt;&gt; </font>Succes<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>procedure </b></font>ODoubleLst<font color="#000080">.</font>SeekNext<font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font>CurentObj<font color="#000080">^.</font>Next <font color="#000080">= </font><font color="#FF0000"><b>nil then
     begin
          </b></font>LastCodeErr <font color="#000080">:= </font>Point_To_Nil<font color="#000080">;
          </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>CurentObj <font color="#000080">:= </font>CurentObj<font color="#000080">^.</font>Next<font color="#000080">;
     </font>LastCodeErr <font color="#000080">:= </font>Succes<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>procedure </b></font>ODoubleLst<font color="#000080">.</font>SeekPrevious<font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font>CurentObj<font color="#000080">^.</font>Previous <font color="#000080">= </font><font color="#FF0000"><b>nil then
     begin
          </b></font>LastCodeErr <font color="#000080">:= </font>Point_To_Nil<font color="#000080">;
          </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>CurentObj <font color="#000080">:= </font>CurentObj<font color="#000080">^.</font>Previous<font color="#000080">;
     </font>LastCodeErr <font color="#000080">:= </font>Succes<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>procedure </b></font>ODoubleLst<font color="#000080">.</font>SeekNum<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">);
</font><font color="#FF0000"><b>begin
     if </b></font>Serial <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
     </font>SeekFirst<font color="#000080">;
     </font><font color="#FF0000"><b>repeat

           </b></font>SeekNext<font color="#000080">;

           </font><font color="#FF0000"><b>if </b></font>CurentObj<font color="#000080">^.</font>Serial <font color="#000080">= </font>Serial <font color="#FF0000"><b>then
           begin
                </b></font>LastCodeErr <font color="#000080">:= </font>Succes<font color="#000080">;
                </font>break<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

           </font><font color="#FF0000"><b>if </b></font>LastError <font color="#000080">&lt;&gt; </font>Succes <font color="#FF0000"><b>then
           begin
                </b></font>LastCodeErr <font color="#000080">:= </font>Point_To_Nil<font color="#000080">;
                </font>break<font color="#000080">;
           </font><font color="#FF0000"><b>end
           else </b></font>continue<font color="#000080">;

     </font><font color="#FF0000"><b>until </b></font>false<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>function </b></font>ODoubleLst<font color="#000080">.</font>MoveObjToPtr<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">; </font>p<font color="#000080">:</font>pointer<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{--- Move data from obj to user buffer                         ---}
</i></font><font color="#FF0000"><b>begin
     </b></font>SeekNum<font color="#000080">(</font>Serial<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>CurentObj<font color="#000080">^.</font>Addresse <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>p <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          </b></font>LastCodeErr <font color="#000080">:= </font>Point_To_Nil<font color="#000080">;
          </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>move<font color="#000080">(</font>CurentObj<font color="#000080">^.</font>Addresse<font color="#000080">, </font>p<font color="#000080">, </font>CurentObj<font color="#000080">^.</font>Size<font color="#000080">);
     </font>LastCodeErr <font color="#000080">:= </font>Succes<font color="#000080">;
     </font>MoveObjToPtr <font color="#000080">:= </font>CurentObj<font color="#000080">^.</font>Size<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>(****************************************************************************)

</i></font><font color="#FF0000"><b>function </b></font>ODoubleLst<font color="#000080">.</font>MovePtrToObj<font color="#000080">(</font>Serial<font color="#000080">:</font>longint<font color="#000080">; </font>p<font color="#000080">:</font>pointer<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{--- Move user buffer to obj data.  obj data take ObjSize bytes ---}
</i></font><font color="#FF0000"><b>begin
     </b></font>SeekNum<font color="#000080">(</font>Serial<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>CurentObj<font color="#000080">^.</font>Addresse <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>p <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          </b></font>LastCodeErr <font color="#000080">:= </font>Point_To_Nil<font color="#000080">;
          </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>move<font color="#000080">(</font>p<font color="#000080">, </font>CurentObj<font color="#000080">^.</font>Addresse<font color="#000080">, </font>CurentObj<font color="#000080">^.</font>Size<font color="#000080">);
     </font>LastCodeErr <font color="#000080">:= </font>Succes<font color="#000080">;
     </font>MovePtrToObj <font color="#000080">:= </font>CurentObj<font color="#000080">^.</font>Size<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p></body>
</html>
