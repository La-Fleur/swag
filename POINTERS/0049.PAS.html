<html>
<head><title> "Good Linked List Object" by EMIL MIKULIC</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>llist<font color="#000080">;

</font><font color="#FF0000"><b>interface

</b></font><font color="#008000"><i>{ List item object }
{ by Emil Mikulic  }

</i></font><font color="#FF0000"><b>type </b></font>PItem<font color="#000080">=^</font>TItem<font color="#000080">;
     </font>TItem<font color="#000080">=</font><font color="#FF0000"><b>object
       </b></font>next<font color="#000080">:</font>PItem<font color="#000080">;
       </font><font color="#008000"><i>{ Initialise item and add next }
       </i></font><font color="#FF0000"><b>constructor </b></font>init<font color="#000080">(</font>nxt<font color="#000080">:</font>PItem<font color="#000080">);
       </font><font color="#008000"><i>{ Insert an item between the current and the next }
       </i></font><font color="#FF0000"><b>procedure </b></font>insert<font color="#000080">(</font>nxt<font color="#000080">:</font>PItem<font color="#000080">);
       </font><font color="#008000"><i>{ Add an item on to the end of the list }
       </i></font><font color="#FF0000"><b>procedure </b></font>add<font color="#000080">(</font>nxt<font color="#000080">:</font>PItem<font color="#000080">);
       </font><font color="#008000"><i>{ Do something for every item }
       </i></font><font color="#FF0000"><b>procedure </b></font>foreach<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
       </font><font color="#008000"><i>{ Do something for current item }
       </i></font><font color="#FF0000"><b>procedure </b></font>custom<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
       </font><font color="#008000"><i>{ Get some value }
       </i></font><font color="#FF0000"><b>function </b></font>get<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
       </font><font color="#008000"><i>{ Destroy current item and all items after it }
       </i></font><font color="#FF0000"><b>destructor </b></font>done<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

constructor </b></font>TItem<font color="#000080">.</font>init<font color="#000080">(</font>nxt<font color="#000080">:</font>PItem<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ Assign next item }
 </i></font>next<font color="#000080">:=</font>nxt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TItem<font color="#000080">.</font>insert<font color="#000080">(</font>nxt<font color="#000080">:</font>PItem<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>temp<font color="#000080">:</font>PItem<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ Special case: no insert because we're the end of the list }
 </i></font><font color="#FF0000"><b>if </b></font>next<font color="#000080">=</font><font color="#FF0000"><b>nil then
   </b></font><font color="#008000"><i>{ Set current next pointer to inserted item }
   </i></font>next<font color="#000080">:=</font>nxt

 <font color="#FF0000"><b>else begin

 </b></font><font color="#008000"><i>{ Keep a temporary reference }
 </i></font>temp<font color="#000080">:=</font>next<font color="#000080">;
 </font><font color="#008000"><i>{ Set current next pointer to inserted item }
 </i></font>next<font color="#000080">:=</font>nxt<font color="#000080">;
 </font><font color="#008000"><i>{ Pass the buck }
 </i></font>nxt<font color="#000080">^.</font>insert<font color="#000080">(</font>temp<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TItem<font color="#000080">.</font>add<font color="#000080">(</font>nxt<font color="#000080">:</font>PItem<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ If at end of list, add the item }
 </i></font><font color="#FF0000"><b>if </b></font>next<font color="#000080">=</font><font color="#FF0000"><b>nil then </b></font>next<font color="#000080">:=</font>nxt
 <font color="#008000"><i>{ If not, pass the buck }
 </i></font><font color="#FF0000"><b>else </b></font>next<font color="#000080">^.</font>add<font color="#000080">(</font>nxt<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TItem<font color="#000080">.</font>foreach<font color="#000080">;
</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TItem<font color="#000080">.</font>custom<font color="#000080">;
</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TItem<font color="#000080">.</font>get<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>TItem<font color="#000080">.</font>done<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ If there is a next item }
 </i></font><font color="#FF0000"><b>if </b></font>next<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil then
   </b></font><font color="#008000"><i>{ then dispose of it - it'll continue dismantling the list }
   </i></font>dispose<font color="#000080">(</font>next<font color="#000080">,</font>done<font color="#000080">);
 </font><font color="#008000"><i>{ If not then your work is done }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ---------------------------------CUT------------------------------- }

</i></font>LINKED LIST <font color="#000080">(</font>LLIST<font color="#000080">)
</font><font color="#FF0000"><b>Unit </b></font>Documentation

by Emil Mikulic

The comments <font color="#FF0000"><b>for </b></font>the TItem <font color="#FF0000"><b>object </b></font>should explain how this works<font color="#000080">:

</font><font color="#FF0000"><b>type </b></font>PItem<font color="#000080">=^</font>TItem<font color="#000080">;
     </font>TItem<font color="#000080">=</font><font color="#FF0000"><b>object
       </b></font>next<font color="#000080">:</font>PItem<font color="#000080">;
       </font><font color="#008000"><i>{ Initialise item and add next }
       </i></font><font color="#FF0000"><b>constructor </b></font>init<font color="#000080">(</font>nxt<font color="#000080">:</font>PItem<font color="#000080">);
       </font><font color="#008000"><i>{ Insert an item between the current and the next }
       </i></font><font color="#FF0000"><b>procedure </b></font>insert<font color="#000080">(</font>nxt<font color="#000080">:</font>PItem<font color="#000080">);
       </font><font color="#008000"><i>{ Add an item on to the end of the list }
       </i></font><font color="#FF0000"><b>procedure </b></font>add<font color="#000080">(</font>nxt<font color="#000080">:</font>PItem<font color="#000080">);
       </font><font color="#008000"><i>{ Do something for every item }
       </i></font><font color="#FF0000"><b>procedure </b></font>foreach<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
       </font><font color="#008000"><i>{ Do something for current item }
       </i></font><font color="#FF0000"><b>procedure </b></font>custom<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
       </font><font color="#008000"><i>{ Get some value }
       </i></font><font color="#FF0000"><b>function </b></font>get<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
       </font><font color="#008000"><i>{ Destroy current item and all items after it }
       </i></font><font color="#FF0000"><b>destructor </b></font>done<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>Now<font color="#000080">, </font>this linked list <font color="#FF0000"><b>object is </b></font>useless<font color="#000080">. </font>All it can <font color="#FF0000"><b>do is
</b></font>add more items <font color="#FF0000"><b>to </b></font>itself <font color="#FF0000"><b>and </b></font>properly clean up by
disposing <font color="#FF0000"><b>of </b></font>all the items <font color="#FF0000"><b>in </b></font>order<font color="#000080">.

</font>Here<font color="#800000">'s how a linked list may look in the memory:
</font>LEGEND
Letters <font color="#000080">= </font>items
Lines <font color="#000080">(- / \ |) = </font>links

A
 <font color="#000080">\                     - -</font>E
   <font color="#000080">\    - -</font>C <font color="#000080">- - - </font>D <font color="#000080">/     \
    </font>B <font color="#000080">/                      \-</font>F


Now<font color="#000080">, </font>here<font color="#800000">'s what it would look like if we ADDED an item: 

</font>A                                    X
 <font color="#000080">\                     - -</font>E        <font color="#000080">/
   \    - -</font>C <font color="#000080">- - - </font>D <font color="#000080">/     \     /
    </font>B <font color="#000080">/                      \-</font>F

Now<font color="#000080">, </font>let<font color="#800000">'s take a simpler list:

</font>A <font color="#000080">- - </font>B <font color="#000080">- - </font>C <font color="#000080">- - </font>D

Here<font color="#800000">'s what that list would look like if I was to INSERT an item
</font><font color="#FF0000"><b>on to </b></font>B<font color="#000080">:

</font>A <font color="#000080">- - </font>B           C <font color="#000080">- - </font>D
        <font color="#000080">\       /
          \   /
            </font>X

The items don<font color="#800000">'t move around - just the links.

</font>The linked list <font color="#FF0000"><b>is </b></font>useless unless you create an <font color="#FF0000"><b>object </b></font>BASED <font color="#FF0000"><b>on
</b></font>TItem<font color="#000080">. </font>An excellent example <font color="#FF0000"><b>of </b></font>this <font color="#FF0000"><b>is </b></font>MENU<font color="#000080">.</font>PAS which <font color="#FF0000"><b>uses 
</b></font>TItem <font color="#FF0000"><b>as </b></font>a base <font color="#FF0000"><b>for </b></font>its TMenuItem list<font color="#000080">.

</font>Also<font color="#000080">, </font>due <font color="#FF0000"><b>to </b></font>the limits <font color="#FF0000"><b>of </b></font>Turbo <font color="#FF0000"><b>Pascal </b></font>when it comes <font color="#FF0000"><b>to
</b></font>polymorphic objects<font color="#000080">, </font>it may be very hard <font color="#FF0000"><b>to </b></font>use TItem unless
you <font color="#FF0000"><b>do </b></font>some custom modifications <font color="#FF0000"><b>to </b></font>it<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>this <font color="#FF0000"><b>is </b></font>the <font color="#FF0000"><b>case
then </b></font>make sure you make a copy <font color="#FF0000"><b>of </b></font>LLIST<font color="#000080">.</font>PAS <font color="#FF0000"><b>and </b></font>work <font color="#FF0000"><b>on
</b></font>the copy because MENU <font color="#FF0000"><b>uses </b></font>LLIST<font color="#000080">.

</font><font color="#FF0000"><b>If </b></font>you understood most <font color="#FF0000"><b>of </b></font>this document <font color="#FF0000"><b>then </b></font>you have
either just learned <font color="#FF0000"><b>or </b></font>already know<font color="#000080">:
        * </font><font color="#FF0000"><b>Object</b></font><font color="#000080">-</font>oriented programming
        <font color="#000080">* </font>Database structuring
        <font color="#000080">* </font>Polymorphism
        <font color="#000080">* </font><font color="#FF0000"><b>Virtual </b></font>functions



</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p></body>
</html>
