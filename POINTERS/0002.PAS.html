<html>
<head><title> "LINKLIST.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
The following is the LinkList Unit written by Peter Davis in his wonderful
but, unFortunately, short-lived newsletter # PNL002.ZIP.  I have used this
Unit to Write tests of three or four of the Procedures but have stumped my toe
on his DELETE_HERE Procedure, the last one in the Unit.  I will post my tests
in the next message For any who may wish to see it:  Pete's Unit is unmodified.
 I almost think there is some kind of error in DELETE_HERE but he was too
thorough For that.  Can you, or someone seeing this show me how to use this
Procedure?  It will help me both With Pointers and With Units.

Here is the Unit:
}

</i></font><font color="#FF0000"><b>Unit </b></font>LinkList<font color="#000080">;

</font><font color="#008000"><i>{ This is the linked list Unit acCompanying The Pascal NewsLetter, Issue #2.
  This Unit is copyrighted by Peter Davis.
  It may be freely distributed in un-modified Form, or modified For use in
  your own Programs. Programs using any modified or unmodified Form of this
(107 min left), (H)elp, More?   Unit must include a run-time and source visible recognition of the author,
  Peter Davis.
}

{ The DataType used is Integer, but may be changed to whatever data Type
  that you want.
}

</i></font><font color="#FF0000"><b>Interface


Type
  </b></font>DataType <font color="#000080">= </font>Integer<font color="#000080">;    </font><font color="#008000"><i>{ Change this data-Type to whatever you want  }

  </i></font>Data_Ptr <font color="#000080">= ^</font>Data_Rec<font color="#000080">;  </font><font color="#008000"><i>{ Pointer to our data Records                 }

  </i></font>Data_Rec <font color="#000080">= </font><font color="#FF0000"><b>Record      </b></font><font color="#008000"><i>{ Our Data Record Format                      }
    </i></font>OurData  <font color="#000080">: </font>DataType<font color="#000080">;
    </font>Next_Rec <font color="#000080">: </font>Data_Ptr<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Init_List<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Insert_begin<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">; </font>Data_Value <font color="#000080">: </font>DataType<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Insert_end<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">; </font>Data_Value <font color="#000080">: </font>DataType<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Insert_In_order<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">; </font>Data_Value <font color="#000080">: </font>DataType<font color="#000080">);
</font><font color="#FF0000"><b>Function </b></font>Pop_First<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">) : </font>DataType<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Pop_Last<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">) : </font>DataType<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Delete_Here<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">; </font>Our_Rec <font color="#000080">: </font>Data_Ptr<font color="#000080">);



</font><font color="#FF0000"><b>Implementation

Procedure </b></font>Init_List<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">);

</font><font color="#FF0000"><b>begin
  </b></font>Head <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Insert_begin<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">; </font>Data_Value <font color="#000080">: </font>DataType<font color="#000080">);

</font><font color="#008000"><i>{ This Procedure will insert a link and value into the
  beginning of a linked list.                             }

</i></font><font color="#FF0000"><b>Var
  </b></font>Temp <font color="#000080">: </font>Data_Ptr<font color="#000080">;                </font><font color="#008000"><i>{ Temporary  Pointer.            }

</i></font><font color="#FF0000"><b>begin
  </b></font>new<font color="#000080">(</font>Temp<font color="#000080">);                      </font><font color="#008000"><i>{ Allocate our space in memory.  }
  </i></font>Temp<font color="#000080">^.</font>Next_Rec <font color="#000080">:= </font>Head<font color="#000080">;         </font><font color="#008000"><i>{ Point to existing list.        }
  </i></font>Head<font color="#000080">:= </font>Temp<font color="#000080">;                    </font><font color="#008000"><i>{ Move head to new data item.    }
  </i></font>Head<font color="#000080">^.</font>OurData <font color="#000080">:= </font>Data_Value<font color="#000080">;    </font><font color="#008000"><i>{ Insert Data_Value.             }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Insert_end<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">; </font>Data_Value <font color="#000080">: </font>DataType<font color="#000080">);

</font><font color="#008000"><i>{ This Procedure will insert a link and value into the
  end of the linked list.                                 }

</i></font><font color="#FF0000"><b>Var
  </b></font>Temp1<font color="#000080">,             </font><font color="#008000"><i>{ This is where we're going to put new data }
  </i></font>Temp2 <font color="#000080">: </font>Data_Ptr<font color="#000080">;  </font><font color="#008000"><i>{ This is to move through the list.         }

</i></font><font color="#FF0000"><b>begin
  </b></font>new<font color="#000080">(</font>Temp1<font color="#000080">);
  </font>Temp2 <font color="#000080">:= </font>Head<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Head<font color="#000080">=</font><font color="#FF0000"><b>nil then
    begin
      </b></font>Head <font color="#000080">:= </font>Temp1<font color="#000080">;                  </font><font color="#008000"><i>{ if list is empty, insert first   }
      </i></font>Head<font color="#000080">^.</font>OurData <font color="#000080">:= </font>Data_Value<font color="#000080">;    </font><font color="#008000"><i>{ and only Record. Add value and   }
      </i></font>Head<font color="#000080">^.</font>Next_Rec <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;          </font><font color="#008000"><i>{ then put nil in Next_Rec Pointer }
    </i></font><font color="#FF0000"><b>end
  else
    begin
      </b></font><font color="#008000"><i>{ Go to the end of the list. Since Head is a Variable parameter,
        we can't move it through the list without losing Pointer to the
        beginning of the list. to fix this, we use a third Variable:
        Temp2.
      }
      </i></font><font color="#FF0000"><b>While </b></font>Temp2<font color="#000080">^.</font>Next_Rec <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do    </b></font><font color="#008000"><i>{ Find the end of the list. }
        </i></font>Temp2 <font color="#000080">:= </font>Temp2<font color="#000080">^.</font>Next_Rec<font color="#000080">;

      </font>Temp2<font color="#000080">^.</font>Next_Rec <font color="#000080">:= </font>Temp1<font color="#000080">;          </font><font color="#008000"><i>{ Insert as last Record.    }
      </i></font>Temp1<font color="#000080">^.</font>Next_Rec <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;            </font><font color="#008000"><i>{ Put in nil to signify end }
      </i></font>Temp1<font color="#000080">^.</font>OurData <font color="#000080">:= </font>Data_Value<font color="#000080">;      </font><font color="#008000"><i>{ and, insert the data      }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Insert_In_order<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">; </font>Data_Value <font color="#000080">: </font>DataType<font color="#000080">);

</font><font color="#008000"><i>{ This Procedure will search through an ordered linked list, find
  out where the data belongs, and insert it into the list.        }

</i></font><font color="#FF0000"><b>Var
  </b></font>Current<font color="#000080">,              </font><font color="#008000"><i>{ Where we are in the list               }
  </i></font>Next     <font color="#000080">: </font>Data_Ptr<font color="#000080">;  </font><font color="#008000"><i>{ This is what we insert our data into.  }

</i></font><font color="#FF0000"><b>begin
  </b></font>New<font color="#000080">(</font>Next<font color="#000080">);
  </font>Current <font color="#000080">:= </font>Head<font color="#000080">;      </font><font color="#008000"><i>{ Start at the top of the list.          }

  </i></font><font color="#FF0000"><b>if </b></font>Head <font color="#000080">= </font><font color="#FF0000"><b>Nil then
    begin
      </b></font>Head<font color="#000080">:= </font>Next<font color="#000080">;
      </font>Head<font color="#000080">^.</font>OurData <font color="#000080">:= </font>Data_Value<font color="#000080">;
      </font>Head<font color="#000080">^.</font>Next_Rec <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end
  else
  </b></font><font color="#008000"><i>{ Check to see if it comes beFore the first item in the list   }
  </i></font><font color="#FF0000"><b>if </b></font>Data_Value <font color="#000080">&lt; </font>Current<font color="#000080">^.</font>OurData <font color="#FF0000"><b>then
    begin
      </b></font>Next<font color="#000080">^.</font>Next_Rec <font color="#000080">:= </font>Head<font color="#000080">;      </font><font color="#008000"><i>{ Make the current first come after Next }
      </i></font>Head <font color="#000080">:= </font>Next<font color="#000080">;                </font><font color="#008000"><i>{ This is our new head of the list       }
      </i></font>Head<font color="#000080">^.</font>OurData <font color="#000080">:= </font>Data_Value<font color="#000080">; </font><font color="#008000"><i>{ and insert our data value.             }
    </i></font><font color="#FF0000"><b>end
  else
    begin
      </b></font><font color="#008000"><i>{ Here we need to go through the list, but always looking one step
        ahead of where we are, so we can maintain the links. The method
        we'll use here is: looking at Current^.Next_Rec^.OurData
        A way to explain that in english is &quot;what is the data pointed to
        by Pointer Next_Rec, in the Record pointed to by Pointer
        current.&quot; You may need to run that through your head a few times
        beFore it clicks, but hearing it in English might make it a bit
        easier For some people to understand.                            }

      </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Data_Value <font color="#000080">&gt;= </font>Current<font color="#000080">^.</font>Next_Rec<font color="#000080">^.</font>OurData<font color="#000080">) </font><font color="#FF0000"><b>and
            </b></font><font color="#000080">(</font>Current<font color="#000080">^.</font>Next_Rec <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>do
        </b></font>Current <font color="#000080">:= </font>Current<font color="#000080">^.</font>Next_Rec<font color="#000080">;
      </font>Next<font color="#000080">^.</font>OurData <font color="#000080">:= </font>Data_Value<font color="#000080">;
      </font>Next<font color="#000080">^.</font>Next_Rec <font color="#000080">:= </font>Current<font color="#000080">^.</font>Next_Rec<font color="#000080">;
      </font>Current<font color="#000080">^.</font>Next_Rec <font color="#000080">:= </font>Next<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Pop_First<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">) : </font>DataType<font color="#000080">;

</font><font color="#008000"><i>{ Pops the first item off the list and returns the value to the caller. }

</i></font><font color="#FF0000"><b>Var
  </b></font>Old_Head <font color="#000080">: </font>Data_Ptr<font color="#000080">;

</font><font color="#FF0000"><b>begin
  if </b></font>Head <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then   </b></font><font color="#008000"><i>{ Is list empty? }
    </i></font><font color="#FF0000"><b>begin
      </b></font>Old_Head <font color="#000080">:= </font>Head<font color="#000080">;
      </font>Pop_First <font color="#000080">:= </font>Head<font color="#000080">^.</font>OurData<font color="#000080">;  </font><font color="#008000"><i>{ Nope, so Return the value }
      </i></font>Head <font color="#000080">:= </font>Head<font color="#000080">^.</font>Next_Rec<font color="#000080">;      </font><font color="#008000"><i>{ and increment head.       }
      </i></font>Dispose<font color="#000080">(</font>Old_Head<font color="#000080">);           </font><font color="#008000"><i>{ Get rid of the old head.  }
    </i></font><font color="#FF0000"><b>end
  else
    begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error: Tried to pop an empty stack!'</font><font color="#000080">);
      </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>Pop_Last<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">) : </font>DataType<font color="#000080">;

</font><font color="#008000"><i>{ This Function pops the last item off the list and returns the
  value of DataType to the caller.                              }

</i></font><font color="#FF0000"><b>Var
  </b></font>Temp <font color="#000080">: </font>Data_Ptr<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Temp <font color="#000080">:= </font>Head<font color="#000080">;       </font><font color="#008000"><i>{ Start at the beginning of the list. }
  </i></font><font color="#FF0000"><b>if </b></font>head <font color="#000080">= </font><font color="#FF0000"><b>nil then  </b></font><font color="#008000"><i>{ Is the list empty? }
    </i></font><font color="#FF0000"><b>begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error: Tried to pop an empty stack!'</font><font color="#000080">);
      </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end
  else
  if </b></font>head<font color="#000080">^.</font>Next_Rec <font color="#000080">= </font><font color="#FF0000"><b>Nil then </b></font><font color="#008000"><i>{ if there is only one item in list, }
    </i></font><font color="#FF0000"><b>begin
      </b></font>Pop_Last <font color="#000080">:= </font>Head<font color="#000080">^.</font>OurData<font color="#000080">;  </font><font color="#008000"><i>{ Return the value               }
      </i></font>Dispose<font color="#000080">(</font>Head<font color="#000080">);              </font><font color="#008000"><i>{ Return the memory to the heap. }
      </i></font>Head <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;                </font><font color="#008000"><i>{ and make list empty.           }
    </i></font><font color="#FF0000"><b>end
  else
    begin
      While </b></font>Temp<font color="#000080">^.</font>Next_Rec<font color="#000080">^.</font>Next_Rec <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do  </b></font><font color="#008000"><i>{ otherwise, find the end }
        </i></font>Temp <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Next_rec<font color="#000080">;
      </font>Pop_Last <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Next_Rec<font color="#000080">^.</font>OurData<font color="#000080">;  </font><font color="#008000"><i>{ Return the value          }
      </i></font>Dispose<font color="#000080">(</font>Temp<font color="#000080">^.</font>Next_Rec<font color="#000080">);              </font><font color="#008000"><i>{ Return the memory to heap }
      </i></font>Temp<font color="#000080">^.</font>Next_Rec <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;                </font><font color="#008000"><i>{ and make new end of list. }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Delete_Here<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Head <font color="#000080">: </font>Data_Ptr<font color="#000080">; </font>Our_Rec <font color="#000080">: </font>Data_Ptr<font color="#000080">);


</font><font color="#008000"><i>{ Deletes the node Our_Rec from the list starting at Head. The Procedure
  does check For an empty list, but it assumes that Our_Rec IS in the list.
}

</i></font><font color="#FF0000"><b>Var
  </b></font>Current <font color="#000080">: </font>Data_Ptr<font color="#000080">;  </font><font color="#008000"><i>{ Used to move through the list. }

</i></font><font color="#FF0000"><b>begin
  </b></font>Current <font color="#000080">:= </font>Head<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Current <font color="#000080">= </font><font color="#FF0000"><b>nil then   </b></font><font color="#008000"><i>{ Is the list empty? }
    </i></font><font color="#FF0000"><b>begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error: Cant delete from an empty stack.'</font><font color="#000080">);
      </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end
  else
    begin   </b></font><font color="#008000"><i>{ Go through list Until we find the one to delete. }
      </i></font><font color="#FF0000"><b>While </b></font>Current<font color="#000080">^.</font>Next_Rec <font color="#000080">&lt;&gt; </font>Our_Rec <font color="#FF0000"><b>do
        </b></font>Current <font color="#000080">:= </font>Current<font color="#000080">^.</font>Next_Rec<font color="#000080">;
      </font>Current <font color="#000080">^.</font>Next_Rec <font color="#000080">:= </font>Our_Rec<font color="#000080">^.</font>Next_Rec<font color="#000080">; </font><font color="#008000"><i>{ Point around old link. }
      </i></font>Dispose<font color="#000080">(</font>Our_Rec<font color="#000080">);                        </font><font color="#008000"><i>{ Get rid of the link..  }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p></body>
</html>
