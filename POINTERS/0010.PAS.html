<html>
<head><title> "Binary Tree - Linked List" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>BinTree<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Const </b></font>TOTAL_NODES <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>BTreeStr <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">40</font><font color="#000080">];
  </font>ShiftSet <font color="#000080">= (</font>TiltL_Tilt<font color="#000080">, </font>neutral<font color="#000080">, </font>TiltR_Tilt<font color="#000080">);
  </font>BinData  <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Key <font color="#000080">: </font>BTreeStr<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>BinPtr <font color="#000080">= ^</font>Bin_Tree_Rec<font color="#000080">;
  </font>Bin_Tree_Rec <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>BTreeData    <font color="#000080">: </font>BinData<font color="#000080">;
    </font>Shift        <font color="#000080">: </font>ShiftSet<font color="#000080">;
    </font>TiltL<font color="#000080">, </font>TiltR <font color="#000080">: </font>BinPtr<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>BTreeRec <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>TOTAL_NODES<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>BinData<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Ins_BinTree
  <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt   <font color="#000080">: </font>BinPtr<font color="#000080">;
       </font>Node <font color="#000080">: </font>BinData<font color="#000080">);

</font><font color="#FF0000"><b>Function </b></font>Srch_BinTree
  <font color="#000080">(</font>Rt     <font color="#000080">: </font>BinPtr<font color="#000080">;
   </font>Node   <font color="#000080">: </font>BinData<font color="#000080">;
   </font>Index1 <font color="#000080">: </font>Word<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>BSortArray
  <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt       <font color="#000080">: </font>BinPtr<font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>SortNode <font color="#000080">: </font>BTreeRec<font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>Index    <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#FF0000"><b>Procedure </b></font>Del_BinTree
  <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt      <font color="#000080">: </font>BinPtr<font color="#000080">;
       </font>Node    <font color="#000080">: </font>BinData<font color="#000080">;
       </font><font color="#FF0000"><b>Var </b></font>DelFlag <font color="#000080">: </font>Boolean<font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Procedure </b></font>Move_TiltR<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt <font color="#000080">: </font>BinPtr<font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>Ptr1<font color="#000080">, </font>Ptr2 <font color="#000080">: </font>BinPtr<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>Ptr1 <font color="#000080">:= </font>Rt<font color="#000080">^.</font>TiltR<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">= </font>TiltR_Tilt <font color="#FF0000"><b>Then Begin
      </b></font>Rt<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Ptr1<font color="#000080">^.</font>TiltL<font color="#000080">;
      </font>Ptr1<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Rt<font color="#000080">;
      </font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
      </font>Rt <font color="#000080">:= </font>Ptr1
    <font color="#FF0000"><b>End
    Else Begin
      </b></font>Ptr2 <font color="#000080">:= </font>Ptr1<font color="#000080">^.</font>TiltL<font color="#000080">;
      </font>Ptr1<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Ptr2<font color="#000080">^.</font>TiltR<font color="#000080">;
      </font>Ptr2<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Ptr1<font color="#000080">;
      </font>Rt<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Ptr2<font color="#000080">^.</font>TiltL<font color="#000080">;
      </font>Ptr2<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Rt<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Ptr2<font color="#000080">^.</font>Shift <font color="#000080">= </font>TiltL_Tilt
        <font color="#FF0000"><b>Then </b></font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltR_Tilt
        <font color="#FF0000"><b>Else </b></font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Ptr2<font color="#000080">^.</font>Shift <font color="#000080">= </font>TiltR_Tilt
        <font color="#FF0000"><b>Then </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltL_Tilt
        <font color="#FF0000"><b>Else </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
      </font>Rt <font color="#000080">:= </font>Ptr2
    <font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral
  <font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Move_TiltL<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt <font color="#000080">: </font>BinPtr<font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>Ptr1<font color="#000080">, </font>Ptr2 <font color="#000080">: </font>BinPtr<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>Ptr1 <font color="#000080">:= </font>Rt<font color="#000080">^.</font>TiltL<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">= </font>TiltL_Tilt <font color="#FF0000"><b>Then Begin
      </b></font>Rt<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Ptr1<font color="#000080">^.</font>TiltR<font color="#000080">;
      </font>Ptr1<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Rt<font color="#000080">;
      </font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
      </font>Rt <font color="#000080">:= </font>Ptr1
    <font color="#FF0000"><b>End
    Else Begin
      </b></font>Ptr2 <font color="#000080">:= </font>Ptr1<font color="#000080">^.</font>TiltR<font color="#000080">;
      </font>Ptr1<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Ptr2<font color="#000080">^.</font>TiltL<font color="#000080">;
      </font>Ptr2<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Ptr1<font color="#000080">;
      </font>Rt<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Ptr2<font color="#000080">^.</font>TiltR<font color="#000080">;
      </font>Ptr2<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Rt<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Ptr2<font color="#000080">^.</font>Shift <font color="#000080">= </font>TiltR_Tilt
        <font color="#FF0000"><b>Then </b></font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltL_Tilt
        <font color="#FF0000"><b>Else </b></font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Ptr2<font color="#000080">^.</font>Shift <font color="#000080">= </font>TiltL_Tilt
        <font color="#FF0000"><b>Then </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltR_Tilt
        <font color="#FF0000"><b>Else </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
      </font>Rt <font color="#000080">:= </font>Ptr2<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral
  <font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Ins_Bin<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt    <font color="#000080">: </font>BinPtr<font color="#000080">;
                      </font>Node  <font color="#000080">: </font>BinData<font color="#000080">;
                  </font><font color="#FF0000"><b>Var </b></font>InsOK <font color="#000080">: </font>Boolean<font color="#000080">);

  </font><font color="#FF0000"><b>Begin
    If </b></font>Rt <font color="#000080">= </font><font color="#FF0000"><b>NIL Then Begin
      </b></font>New<font color="#000080">(</font>Rt<font color="#000080">);
      </font><font color="#FF0000"><b>With </b></font>Rt<font color="#000080">^ </font><font color="#FF0000"><b>Do Begin
        </b></font>BTreeData <font color="#000080">:= </font>Node<font color="#000080">;
        </font>TiltL <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
        </font>TiltR <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
        </font>Shift <font color="#000080">:= </font>neutral
      <font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>InsOK <font color="#000080">:= </font>TRUE
    <font color="#FF0000"><b>End
    Else If </b></font>Node<font color="#000080">.</font>Key <font color="#000080">&lt;= </font>Rt<font color="#000080">^.</font>BTreeData<font color="#000080">.</font>Key <font color="#FF0000"><b>Then Begin
      </b></font>Ins_Bin<font color="#000080">(</font>Rt<font color="#000080">^.</font>TiltL<font color="#000080">, </font>Node<font color="#000080">, </font>InsOK<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>InsOK <font color="#FF0000"><b>Then
        Case </b></font>Rt<font color="#000080">^.</font>Shift <font color="#FF0000"><b>Of
          </b></font>TiltL_Tilt <font color="#000080">: </font><font color="#FF0000"><b>Begin
                        </b></font>Move_TiltL<font color="#000080">(</font>Rt<font color="#000080">);
                        </font>InsOK <font color="#000080">:= </font>FALSE
                       <font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font>neutral    <font color="#000080">: </font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltL_Tilt<font color="#000080">;
          </font>TiltR_Tilt <font color="#000080">: </font><font color="#FF0000"><b>Begin
                        </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
                        </font>InsOK <font color="#000080">:= </font>FALSE
                       <font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End
      Else Begin
        </b></font>Ins_Bin<font color="#000080">(</font>Rt<font color="#000080">^.</font>TiltR<font color="#000080">, </font>Node<font color="#000080">, </font>InsOK<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>InsOK <font color="#FF0000"><b>Then
          Case </b></font>Rt<font color="#000080">^.</font>Shift <font color="#FF0000"><b>Of
            </b></font>TiltL_Tilt <font color="#000080">: </font><font color="#FF0000"><b>Begin
                          </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
                          </font>InsOK <font color="#000080">:= </font>FALSE
                         <font color="#FF0000"><b>End</b></font><font color="#000080">;
            </font>neutral    <font color="#000080">: </font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltR_Tilt<font color="#000080">;
            </font>TiltR_Tilt <font color="#000080">: </font><font color="#FF0000"><b>Begin
                          </b></font>Move_TiltR<font color="#000080">(</font>Rt<font color="#000080">);
                          </font>InsOK <font color="#000080">:= </font>FALSE
                         <font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Ins_BinTree<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt   <font color="#000080">: </font>BinPtr<font color="#000080">;
                        </font>Node <font color="#000080">: </font>BinData<font color="#000080">);

  </font><font color="#FF0000"><b>Var </b></font>Ins_ok <font color="#000080">: </font>Boolean<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>Ins_ok <font color="#000080">:= </font>FALSE<font color="#000080">;
    </font>Ins_Bin<font color="#000080">(</font>Rt<font color="#000080">, </font>Node<font color="#000080">, </font>Ins_ok<font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Srch_BinTree<font color="#000080">(</font>Rt     <font color="#000080">: </font>BinPtr<font color="#000080">;
                      </font>Node   <font color="#000080">: </font>BinData<font color="#000080">;
                      </font>Index1 <font color="#000080">: </font>Word<font color="#000080">)
                      : </font>Word<font color="#000080">;

  </font><font color="#FF0000"><b>Var
    </b></font>Index <font color="#000080">: </font>Word<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>Index <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Rt <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Index <font color="#000080">&lt; </font>Index1<font color="#000080">) </font><font color="#FF0000"><b>Do
      If </b></font>Node<font color="#000080">.</font>Key <font color="#000080">&gt; </font>Rt<font color="#000080">^.</font>BTreeData<font color="#000080">.</font>Key <font color="#FF0000"><b>Then </b></font>Rt <font color="#000080">:= </font>Rt<font color="#000080">^.</font>TiltR
      <font color="#FF0000"><b>Else if </b></font>Node<font color="#000080">.</font>Key <font color="#000080">&lt; </font>Rt<font color="#000080">^.</font>BTreeData<font color="#000080">.</font>Key <font color="#FF0000"><b>Then </b></font>Rt <font color="#000080">:= </font>Rt<font color="#000080">^.</font>TiltL
      <font color="#FF0000"><b>Else Begin
        </b></font>Inc<font color="#000080">(</font>Index<font color="#000080">);
        </font>Rt <font color="#000080">:= </font>Rt<font color="#000080">^.</font>TiltL
      <font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Srch_BinTree <font color="#000080">:= </font>Index
  <font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Tvrs_Tree
  <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt       <font color="#000080">: </font>BinPtr<font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>SortNode <font color="#000080">: </font>BTreeRec<font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>Index    <font color="#000080">: </font>Word<font color="#000080">);

  </font><font color="#FF0000"><b>Begin
    If </b></font>Rt <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL Then Begin
      </b></font>Tvrs_Tree<font color="#000080">(</font>Rt<font color="#000080">^.</font>TiltL<font color="#000080">, </font>SortNode<font color="#000080">, </font>Index<font color="#000080">);
      </font>Inc<font color="#000080">(</font>Index<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Index <font color="#000080">&lt;= </font>TOTAL_NODES <font color="#FF0000"><b>Then
        </b></font>SortNode<font color="#000080">[</font>Index<font color="#000080">].</font>Key <font color="#000080">:= </font>Rt<font color="#000080">^.</font>BTreeData<font color="#000080">.</font>Key<font color="#000080">;
      </font>Tvrs_Tree<font color="#000080">(</font>Rt<font color="#000080">^.</font>TiltR<font color="#000080">, </font>SortNode<font color="#000080">, </font>Index<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>BSortArray
  <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt       <font color="#000080">: </font>BinPtr<font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>SortNode <font color="#000080">: </font>BTreeRec<font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>Index    <font color="#000080">: </font>Word<font color="#000080">);

  </font><font color="#FF0000"><b>Begin
    </b></font>Index <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Tvrs_Tree<font color="#000080">(</font>Rt<font color="#000080">, </font>SortNode<font color="#000080">, </font>Index<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Shift_TiltR
  <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt      <font color="#000080">: </font>BinPtr<font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>DelFlag <font color="#000080">: </font>Boolean<font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>Ptr1<font color="#000080">, </font>Ptr2 <font color="#000080">: </font>BinPtr<font color="#000080">;
    </font>balnc2<font color="#000080">, </font>balnc3 <font color="#000080">: </font>ShiftSet<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    Case </b></font>Rt<font color="#000080">^.</font>Shift <font color="#FF0000"><b>Of
      </b></font>TiltL_Tilt <font color="#000080">: </font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
      </font>neutral    <font color="#000080">: </font><font color="#FF0000"><b>Begin
                     </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltR_Tilt<font color="#000080">;
                     </font>DelFlag <font color="#000080">:= </font>FALSE
                   <font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>TiltR_Tilt <font color="#000080">: </font><font color="#FF0000"><b>Begin
           </b></font>Ptr1 <font color="#000080">:= </font>Rt<font color="#000080">^.</font>TiltR<font color="#000080">;
           </font>balnc2 <font color="#000080">:= </font>Ptr1<font color="#000080">^.</font>Shift<font color="#000080">;
           </font><font color="#FF0000"><b>If NOT </b></font><font color="#000080">(</font>balnc2 <font color="#000080">= </font>TiltL_Tilt<font color="#000080">) </font><font color="#FF0000"><b>Then Begin
             </b></font>Rt<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Ptr1<font color="#000080">^.</font>TiltL<font color="#000080">;
             </font>Ptr1<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Rt<font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>balnc2 <font color="#000080">= </font>neutral <font color="#FF0000"><b>Then Begin
               </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltR_Tilt<font color="#000080">;
               </font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltL_Tilt<font color="#000080">;
               </font>DelFlag <font color="#000080">:= </font>FALSE
             <font color="#FF0000"><b>End
             Else Begin
               </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
               </font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
             </font>Rt <font color="#000080">:= </font>Ptr1
           <font color="#FF0000"><b>End
           Else Begin
             </b></font>Ptr2 <font color="#000080">:= </font>Ptr1<font color="#000080">^.</font>TiltL<font color="#000080">;
             </font>balnc3 <font color="#000080">:= </font>Ptr2<font color="#000080">^.</font>Shift<font color="#000080">;
             </font>Ptr1<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Ptr2<font color="#000080">^.</font>TiltR<font color="#000080">;
             </font>Ptr2<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Ptr1<font color="#000080">;
             </font>Rt<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Ptr2<font color="#000080">^.</font>TiltL<font color="#000080">;
             </font>Ptr2<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Rt<font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>balnc3 <font color="#000080">= </font>TiltL_Tilt <font color="#FF0000"><b>Then
               </b></font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltR_Tilt
             <font color="#FF0000"><b>Else
               </b></font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>balnc3 <font color="#000080">= </font>TiltR_Tilt <font color="#FF0000"><b>Then
               </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltL_Tilt
             <font color="#FF0000"><b>Else
               </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
             </font>Rt <font color="#000080">:= </font>Ptr2<font color="#000080">;
             </font>Ptr2<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Shift_TiltL
  <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt      <font color="#000080">: </font>BinPtr<font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>DelFlag <font color="#000080">: </font>Boolean<font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>Ptr1<font color="#000080">, </font>Ptr2 <font color="#000080">: </font>BinPtr<font color="#000080">;
    </font>balnc2<font color="#000080">, </font>balnc3 <font color="#000080">: </font>ShiftSet<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    Case </b></font>Rt<font color="#000080">^.</font>Shift <font color="#FF0000"><b>Of
      </b></font>TiltR_Tilt <font color="#000080">: </font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
      </font>neutral    <font color="#000080">: </font><font color="#FF0000"><b>Begin
                     </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltL_Tilt<font color="#000080">;
                     </font>DelFlag <font color="#000080">:= </font>False
                   <font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>TiltL_Tilt <font color="#000080">: </font><font color="#FF0000"><b>Begin
           </b></font>Ptr1 <font color="#000080">:= </font>Rt<font color="#000080">^.</font>TiltL<font color="#000080">;
           </font>balnc2 <font color="#000080">:= </font>Ptr1<font color="#000080">^.</font>Shift<font color="#000080">;
           </font><font color="#FF0000"><b>If NOT </b></font><font color="#000080">(</font>balnc2 <font color="#000080">= </font>TiltR_Tilt<font color="#000080">) </font><font color="#FF0000"><b>Then Begin
             </b></font>Rt<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Ptr1<font color="#000080">^.</font>TiltR<font color="#000080">;
             </font>Ptr1<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Rt<font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>balnc2 <font color="#000080">= </font>neutral <font color="#FF0000"><b>Then Begin
               </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltL_Tilt<font color="#000080">;
               </font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltR_Tilt<font color="#000080">;
               </font>DelFlag <font color="#000080">:= </font>FALSE
             <font color="#FF0000"><b>End
             Else Begin
               </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
               </font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
             </font>Rt <font color="#000080">:= </font>Ptr1
           <font color="#FF0000"><b>End
           Else Begin
             </b></font>Ptr2 <font color="#000080">:= </font>Ptr1<font color="#000080">^.</font>TiltR<font color="#000080">;
             </font>balnc3 <font color="#000080">:= </font>Ptr2<font color="#000080">^.</font>Shift<font color="#000080">;
             </font>Ptr1<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Ptr2<font color="#000080">^.</font>TiltL<font color="#000080">;
             </font>Ptr2<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Ptr1<font color="#000080">;
             </font>Rt<font color="#000080">^.</font>TiltL <font color="#000080">:= </font>Ptr2<font color="#000080">^.</font>TiltR<font color="#000080">;
             </font>Ptr2<font color="#000080">^.</font>TiltR <font color="#000080">:= </font>Rt<font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>balnc3 <font color="#000080">= </font>TiltR_Tilt <font color="#FF0000"><b>Then
               </b></font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltL_Tilt
             <font color="#FF0000"><b>Else
               </b></font>Ptr1<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>balnc3 <font color="#000080">= </font>TiltL_Tilt <font color="#FF0000"><b>Then
               </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>TiltR_Tilt
             <font color="#FF0000"><b>Else
               </b></font>Rt<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
             </font>Rt <font color="#000080">:= </font>Ptr2<font color="#000080">;
             </font>Ptr2<font color="#000080">^.</font>Shift <font color="#000080">:= </font>neutral<font color="#000080">;
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Kill_Lo_Nodes
  <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt<font color="#000080">,
       </font>Ptr     <font color="#000080">: </font>BinPtr<font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>DelFlag <font color="#000080">: </font>Boolean<font color="#000080">);

  </font><font color="#FF0000"><b>Begin
    If </b></font>Ptr<font color="#000080">^.</font>TiltR <font color="#000080">= </font><font color="#FF0000"><b>NIL Then Begin
      </b></font>Rt<font color="#000080">^.</font>BTreeData <font color="#000080">:= </font>Ptr<font color="#000080">^.</font>BTreeData<font color="#000080">;
      </font>Ptr <font color="#000080">:= </font>Ptr<font color="#000080">^.</font>TiltL<font color="#000080">;
      </font>DelFlag <font color="#000080">:= </font>TRUE
    <font color="#FF0000"><b>End
    Else Begin
      </b></font>Kill_Lo_Nodes<font color="#000080">(</font>Rt<font color="#000080">, </font>Ptr<font color="#000080">^.</font>TiltR<font color="#000080">, </font>DelFlag<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>DelFlag <font color="#FF0000"><b>Then </b></font>Shift_TiltL<font color="#000080">(</font>Ptr<font color="#000080">,</font>DelFlag<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Del_Bin<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt      <font color="#000080">: </font>BinPtr<font color="#000080">;
                      </font>Node    <font color="#000080">: </font>BinData<font color="#000080">;
                  </font><font color="#FF0000"><b>Var </b></font>DelFlag <font color="#000080">: </font>Boolean<font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>Ptr <font color="#000080">: </font>BinPtr<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    If </b></font>Rt <font color="#000080">= </font><font color="#FF0000"><b>NIL Then
       </b></font>DelFlag <font color="#000080">:= </font>False
    <font color="#FF0000"><b>Else
      If </b></font>Node<font color="#000080">.</font>Key <font color="#000080">&lt; </font>Rt<font color="#000080">^.</font>BTreeData<font color="#000080">.</font>Key <font color="#FF0000"><b>Then Begin
        </b></font>Del_Bin<font color="#000080">(</font>Rt<font color="#000080">^.</font>TiltL<font color="#000080">, </font>Node<font color="#000080">, </font>DelFlag<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>DelFlag <font color="#FF0000"><b>Then </b></font>Shift_TiltR<font color="#000080">(</font>Rt<font color="#000080">, </font>DelFlag<font color="#000080">);
      </font><font color="#FF0000"><b>End
      Else Begin
        If </b></font>Node<font color="#000080">.</font>Key <font color="#000080">&gt; </font>Rt<font color="#000080">^.</font>BTreeData<font color="#000080">.</font>Key <font color="#FF0000"><b>Then Begin
          </b></font>Del_Bin<font color="#000080">(</font>Rt<font color="#000080">^.</font>TiltR<font color="#000080">, </font>Node<font color="#000080">, </font>DelFlag<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>DelFlag <font color="#FF0000"><b>Then </b></font>Shift_TiltL<font color="#000080">(</font>Rt<font color="#000080">, </font>DelFlag<font color="#000080">);
        </font><font color="#FF0000"><b>End
        Else Begin
          </b></font>Ptr <font color="#000080">:= </font>Rt<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Rt<font color="#000080">^.</font>TiltR <font color="#000080">= </font><font color="#FF0000"><b>NIL Then Begin
            </b></font>Rt <font color="#000080">:= </font>Rt<font color="#000080">^.</font>TiltL<font color="#000080">;
            </font>DelFlag <font color="#000080">:= </font>TRUE<font color="#000080">;
            </font>Dispose<font color="#000080">(</font>Ptr<font color="#000080">);
          </font><font color="#FF0000"><b>End
          Else If </b></font>Rt<font color="#000080">^.</font>TiltL <font color="#000080">= </font><font color="#FF0000"><b>NIL Then Begin
            </b></font>Rt <font color="#000080">:= </font>Rt<font color="#000080">^.</font>TiltR<font color="#000080">;
            </font>DelFlag <font color="#000080">:= </font>TRUE<font color="#000080">;
            </font>Dispose<font color="#000080">(</font>Ptr<font color="#000080">);
          </font><font color="#FF0000"><b>End
          Else Begin
            </b></font>Kill_Lo_Nodes<font color="#000080">(</font>Rt<font color="#000080">, </font>Rt<font color="#000080">^.</font>TiltL<font color="#000080">, </font>DelFlag<font color="#000080">);
            </font><font color="#FF0000"><b>If </b></font>DelFlag <font color="#FF0000"><b>Then </b></font>Shift_TiltR<font color="#000080">(</font>Rt<font color="#000080">, </font>DelFlag<font color="#000080">);
            </font>Dispose<font color="#000080">(</font>Rt<font color="#000080">^.</font>TiltL<font color="#000080">);
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Del_BinTree
  <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rt      <font color="#000080">: </font>BinPtr<font color="#000080">;
       </font>Node    <font color="#000080">: </font>BinData<font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>DelFlag <font color="#000080">: </font>Boolean<font color="#000080">);

  </font><font color="#FF0000"><b>Begin
    </b></font>DelFlag <font color="#000080">:= </font>FALSE<font color="#000080">;
    </font>Del_Bin<font color="#000080">(</font>Rt<font color="#000080">, </font>Node<font color="#000080">, </font>DelFlag<font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p></body>
</html>
