<html>
<head><title> "Linked List Management unit" by SUNE MARCHER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0036.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>link<font color="#000080">;
</font><font color="#008000"><i>{$o-,g-,d-,l-,y-,q-,r-,s-,t-,v-,x-,n-,e-,b-}

</i></font><font color="#FF0000"><b>INTERFACE

type
  </b></font>pstring<font color="#000080">=^</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>pdata<font color="#000080">=^</font>tdatarec<font color="#000080">;
  </font>tdatarec<font color="#000080">=</font><font color="#FF0000"><b>record
             </b></font>name<font color="#000080">:</font>pstring<font color="#000080">;
             </font>size<font color="#000080">:</font>byte<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>plink<font color="#000080">=^</font>tlink<font color="#000080">;
  </font>tlink<font color="#000080">=</font><font color="#FF0000"><b>record
          </b></font>prev<font color="#000080">,</font>next<font color="#000080">:</font>plink<font color="#000080">;
          </font>data<font color="#000080">:</font>pdata<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>inilink<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>addlink<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>d<font color="#000080">:</font>pdata<font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>addlink2<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>d<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>dellink<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>linkdata<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>p<font color="#000080">:</font>pdata<font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>linkdata2<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>numlinks<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">):</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>killink<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION

procedure </b></font>inilink<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>l<font color="#000080">^.</font>prev<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">; </font>l<font color="#000080">^.</font>next<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">; </font>l<font color="#000080">^.</font>data<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">; </font>l<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>addlink<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>d<font color="#000080">:</font>pdata<font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>addlink<font color="#000080">:=</font>false<font color="#000080">;
  </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>memavail<font color="#000080">&lt;(</font>d<font color="#000080">^.</font>size<font color="#000080">+</font><font color="#800000">16</font><font color="#000080">))</font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>then
  begin
    </b></font>new<font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">);
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>next<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>prev<font color="#000080">:=</font>l<font color="#000080">;
    </font>new<font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">);
    </font>getmem<font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">,</font>d<font color="#000080">^.</font>size<font color="#000080">);
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">^:=</font><font color="#800000">''</font><font color="#000080">;
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">^:=</font>d<font color="#000080">^.</font>name<font color="#000080">^;
</font><font color="#008000"><i>{    l^.next^.data^.name^[0]:=d[0];}
    </i></font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>size<font color="#000080">:=</font>d<font color="#000080">^.</font>size<font color="#000080">;
  </font><font color="#FF0000"><b>end else
  begin
    </b></font>freemem<font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">,</font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>size<font color="#000080">);
    </font>getmem<font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">,</font>d<font color="#000080">^.</font>size<font color="#000080">);
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">^:=</font>d<font color="#000080">^.</font>name<font color="#000080">^;
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>size<font color="#000080">:=</font>d<font color="#000080">^.</font>size<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>addlink<font color="#000080">:=</font>true<font color="#000080">;
  </font>l<font color="#000080">:=</font>l<font color="#000080">^.</font>next<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>addlink2<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>d<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>addlink2<font color="#000080">:=</font>false<font color="#000080">;
  </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>memavail<font color="#000080">&lt;(</font>succ<font color="#000080">(</font>ord<font color="#000080">(</font>d<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])))+</font><font color="#800000">16</font><font color="#000080">)</font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>then
  begin
    </b></font>new<font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">);
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>next<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>prev<font color="#000080">:=</font>l<font color="#000080">;
    </font>new<font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">);
    </font>getmem<font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">,</font>succ<font color="#000080">(</font>ord<font color="#000080">(</font>d<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])));
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">^:=</font><font color="#800000">''</font><font color="#000080">;
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">^:=</font>d<font color="#000080">;
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">^[</font><font color="#800000">0</font><font color="#000080">]:=</font>d<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>size<font color="#000080">:=</font>succ<font color="#000080">(</font>ord<font color="#000080">(</font>d<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]));
  </font><font color="#FF0000"><b>end else
  begin
    </b></font>freemem<font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">,</font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>size<font color="#000080">);
    </font>getmem<font color="#000080">(</font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">,</font>succ<font color="#000080">(</font>ord<font color="#000080">(</font>d<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])));
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">^:=</font>d<font color="#000080">;
    </font>l<font color="#000080">^.</font>next<font color="#000080">^.</font>data<font color="#000080">^.</font>size<font color="#000080">:=</font>succ<font color="#000080">(</font>ord<font color="#000080">(</font>d<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>addlink2<font color="#000080">:=</font>true<font color="#000080">;
  </font>l<font color="#000080">:=</font>l<font color="#000080">^.</font>next<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>dellink<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>tmp<font color="#000080">:</font>plink<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>tmp<font color="#000080">:=</font>l<font color="#000080">;
  </font><font color="#FF0000"><b>if</b></font><font color="#000080">((</font>tmp<font color="#000080">^.</font>prev<font color="#000080">=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>tmp<font color="#000080">^.</font>next<font color="#000080">=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">))</font><font color="#FF0000"><b>or</b></font><font color="#000080">(</font>tmp<font color="#000080">^.</font>data<font color="#000080">=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>tmp<font color="#000080">^.</font>prev<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>tmp<font color="#000080">^.</font>next<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>then </b></font>tmp<font color="#000080">^.</font>prev<font color="#000080">:=</font>tmp<font color="#000080">^.</font>next<font color="#000080">;
  </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>tmp<font color="#000080">^.</font>prev<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>tmp<font color="#000080">^.</font>next<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>then </b></font>tmp<font color="#000080">^.</font>next<font color="#000080">^.</font>prev<font color="#000080">:=</font>tmp<font color="#000080">^.</font>prev<font color="#000080">;
  </font>l<font color="#000080">:=</font>tmp<font color="#000080">^.</font>next<font color="#000080">;
  </font>freemem<font color="#000080">(</font>tmp<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">,</font>tmp<font color="#000080">^.</font>data<font color="#000080">^.</font>size<font color="#000080">);
  </font>dispose<font color="#000080">(</font>tmp<font color="#000080">^.</font>data<font color="#000080">);
  </font>dispose<font color="#000080">(</font>tmp<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>linkdata<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>p<font color="#000080">:</font>pdata<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if</b></font><font color="#000080">(</font>p<font color="#000080">=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>then
  begin
    </b></font>new<font color="#000080">(</font>p<font color="#000080">);
    </font>new<font color="#000080">(</font>p<font color="#000080">^.</font>name<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>p<font color="#000080">^.</font>name<font color="#000080">^:=</font>l<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">^;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>linkdata2<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>tmp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{  tmp:=l^.data^.name^;
  linkdata2:=tmp;      }
  </i></font>move<font color="#000080">(</font>l<font color="#000080">^.</font>data<font color="#000080">^.</font>name<font color="#000080">^[</font><font color="#800000">1</font><font color="#000080">],</font>tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>succ<font color="#000080">(</font>l<font color="#000080">^.</font>data<font color="#000080">^.</font>size<font color="#000080">));
  </font>tmp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>char<font color="#000080">(</font>pred<font color="#000080">(</font>l<font color="#000080">^.</font>data<font color="#000080">^.</font>size<font color="#000080">));
  </font>linkdata2<font color="#000080">:=</font>tmp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>numlinks<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">):</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>tmp<font color="#000080">:</font>plink<font color="#000080">;
  </font>cnt<font color="#000080">:</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>numlinks<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>l<font color="#000080">=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font>tmp<font color="#000080">:=</font>l<font color="#000080">;
  </font><font color="#FF0000"><b>while</b></font><font color="#000080">(</font>tmp<font color="#000080">^.</font>prev<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>do </b></font>tmp<font color="#000080">:=</font>tmp<font color="#000080">^.</font>prev<font color="#000080">;
  </font>cnt<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>while</b></font><font color="#000080">(</font>tmp<font color="#000080">^.</font>next<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>do
  begin
    </b></font>inc<font color="#000080">(</font>cnt<font color="#000080">);
    </font>tmp<font color="#000080">:=</font>tmp<font color="#000080">^.</font>next<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>numlinks<font color="#000080">:=</font>cnt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>killink<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>l<font color="#000080">:</font>plink<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  while</b></font><font color="#000080">(</font>l<font color="#000080">^.</font>prev<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)</font><font color="#FF0000"><b>do </b></font>l<font color="#000080">:=</font>l<font color="#000080">^.</font>prev<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>c<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numlinks<font color="#000080">(</font>l<font color="#000080">)</font><font color="#FF0000"><b>do </b></font>dellink<font color="#000080">(</font>l<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to POINTERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0036.PAS">Original</a><b>]</b></p></body>
</html>
