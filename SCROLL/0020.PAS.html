<html>
<head><title> "Fantastic Smooth Text Scroll" by GRANT SMITH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SCROLL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: denthor@goth.vironix.co.za (Grant Smith)

: I was watching an old demo by iguana called heartquake the other day. In
: the very beginning, wher the user could make sound card settings, etc.,
: the was a very smooth vertical text scroll, not char by char, but
: semmingly scanline by scanline. Anyone got any idea on how this was
: done?

Here you go :-) Full source to smooth scroll. For more gfx stuff, check out
my trainer series : http://goth.vironix.co.za/~denthor
                    ftp.eng.ufl.edu /pub/msdos/demos/code/graph/tutor
                    denthor@beastie.cs.und.ac.za Subject : request-list

Byeeee...
  - Denthor / Asphyxia
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Soft<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">,</font>old <font color="#000080">: </font>integer<font color="#000080">; 
</font>ch <font color="#000080">: </font>char<font color="#000080">; 
    </font>f<font color="#000080">:</font>text<font color="#000080">; 
    </font>temp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>procedure </b></font>VFine<font color="#000080">(</font>y<font color="#000080">:</font>byte<font color="#000080">); 
</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>asm 
  </b></font><font color="#FF00FF">mov     dx,03dah 
@W2: 
  in      al,dx 
  test    al,8 
  jz      @W2 
</font><font color="#008000"><i>{  sti;} 
  </i></font><font color="#FF00FF">mov     dx,03d4h 
  mov     ah,Y 
  mov     al,8 
  out     dx,ax 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; 

</font><font color="#FF0000"><b>procedure </b></font>scroff<font color="#000080">(</font>soffset<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm 
 </b></font><font color="#008000"><i>{ cli} 
  </i></font><font color="#FF00FF">mov     dx,03dah 
@W1:
  in      al,dx 
  test    al,8 
  jnz     @W1 
  mov dx,03d4h 
  mov bx,soffset 
  mov ah,bh 
  mov al,00ch 
  out dx,ax 
  mov ah,bl 
  inc al 
  out dx,ax 
 </font><font color="#008000"><i>{ sti} 
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>procedure </b></font>split<font color="#000080">(</font>Line<font color="#000080">:</font>word<font color="#000080">); 
</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>asm 
 </b></font><font color="#FF00FF">mov ax,Line
 shl ax,1 
 mov bl,ah 
 mov ah,al 
 mov bh,bl 
 shr bh,1 
        mov     cl, 6 
 shl bh,cl 
 and bl,1 
        mov     cl,4 
 shl bl,cl 
 mov dx,03d4h 
 mov al,018h 
 out dx,ax 
 mov al,7 
 out dx,al 
 inc dx 
 in  al,dx 
 and al,0ffh-16 
 or  al,bl 
 mov ah,al 
 mov al,7
 dec dx 
 out dx,ax
 
 mov al,9 
 out dx,al 

 inc dx 
 in  al,dx 
 and al,0ffh-64 
 or  al,bh 
 mov ah,al 
 dec dx 
 mov al,9 
 out dx,ax 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
 
 
 
</font><font color="#FF0000"><b>procedure </b></font>fasttext<font color="#000080">(</font>x<font color="#000080">, </font>y <font color="#000080">: </font>word<font color="#000080">; </font>col <font color="#000080">: </font>byte<font color="#000080">; </font>what <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">); 
</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>asm 
      </b></font><font color="#FF00FF">push   ds 
 
      dec    [x]
      dec    [y] 
      mov    ax, 0b800h 
      mov    es, ax 
      mov    ax, [y] 
      mov    bl, 160 
      mul    bl 
      add    ax, [x] 
      add    ax, [x] 
      mov    di, ax 
 
      lds    si, what 
      cld 
      lodsb 
      xor    ch, ch 
      mov    ah, [col] 
      mov    cl, al 
      cmp    cx, 0 
      jz     @@2 
 
 @@1: lodsb 
      stosw
      loop   @@1 

 @@2: 
      pop    ds 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; 

 
</font><font color="#FF0000"><b>begin 
  </b></font>textattr <font color="#000080">:= </font><font color="#800000">15</font><font color="#000080">; 
  </font>clrscr<font color="#000080">; 
  </font>split<font color="#000080">(</font><font color="#800000">192</font><font color="#000080">); 
  </font><font color="#FF0000"><b>asm 
    </b></font><font color="#FF00FF">mov   ah,01 
    mov   ch,20h 
    int   10h 
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
  </font>j <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; 
  </font>old <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; 
  </font>j <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">; 
  </font>scroff <font color="#000080">(</font>j<font color="#000080">*</font><font color="#800000">80</font><font color="#000080">); 
  </font>fasttext <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$1E</font><font color="#000080">,</font><font color="#800000">'        --==[ Copyright Asphyxia Software, 1994 All Rights Reserved ]==--       '</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">24 </font><font color="#FF0000"><b>do BEGIN
    </b></font>fasttext <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>i<font color="#000080">+</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">$0F</font><font color="#000080">,</font><font color="#800000">'Denthor / Asphyxia / Coder / +27 31 732129 / denthor@beastie.cs.und.ac.za'</font><font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
 
  </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font><font color="#800000">27 </font><font color="#FF0000"><b>do BEGIN 
    </b></font>scroff<font color="#000080">((</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">80</font><font color="#000080">); 
    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do 
    begin 
      </b></font>vfine <font color="#000080">(</font>i<font color="#000080">); 
      </font>delay<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">); 
    </font><font color="#FF0000"><b>end 
  END</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>while </b></font>keypressed <font color="#FF0000"><b>do </b></font>readkey<font color="#000080">; 
  </font>readkey<font color="#000080">; 
  </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font><font color="#800000">28 </font><font color="#FF0000"><b>to </b></font><font color="#800000">52 </font><font color="#FF0000"><b>do BEGIN 
    </b></font>scroff<font color="#000080">((</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">80</font><font color="#000080">); 
    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do 
    begin 
      </b></font>vfine <font color="#000080">(</font>i<font color="#000080">); 
      </font>delay<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end
  END</b></font><font color="#000080">;
  </font>textmode<font color="#000080">(</font>co80<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Soft<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SCROLL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p></body>
</html>
