<html>
<head><title> "Another Screen Scroller" by ROBERT LONG</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SCROLL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I am new to this echo, so here is my offering placed upon
the alter of exceptence. I have seen a couple of requests
for help with both scrolling the screen, as well as
reading/writting directly to/from the screen.

Here is a unit to do both. One note here, this unit is
assuming a color monitor. It can be used for a (Barrrrrfffffff)
monocrome monitor by changing the value of
&quot;cscreen to $B000 : $0000&quot;

If anyone has any questions, I will be monitoring this echo
from now on and will be happy to answer any questions.


                                        Robert Long....

   -------------------------[ Cut Here ]--------------------------
}

</i></font><font color="#FF0000"><b>Unit </b></font>screen<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

    Uses  </b></font>dos<font color="#000080">, </font>crt<font color="#000080">;

    </font><font color="#FF0000"><b>Type
       </b></font>scrp <font color="#000080">= ^</font>scr<font color="#000080">;
        </font>scr <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">80</font><font color="#000080">] </font><font color="#FF0000"><b>of record
                                      </b></font>ch <font color="#000080">: </font>char<font color="#000080">;
                                      </font>at <font color="#000080">: </font>byte<font color="#000080">;
                                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ SCRP : Pointer to a screen record. Used to overlay video
         memory, and so you can create dynamic screens on
         the heap.
  SCR :  An array of records that duplicates the video memory.
         You can read any position on the screen like this:
             Character_on_screen:= cscreen[y,x].ch;
         And write to a screen position like this:
          cscreen[y,x].ch:= Character_to_put_on_screen;
         And of course the color attributes would be:
            Attribute_on_screen:= cscreen[y,x].at;
}

    </i></font><font color="#FF0000"><b>Var
      </b></font>cscreen <font color="#000080">: </font>scr <font color="#FF0000"><b>absolute </b></font><font color="#800000">$b800 </font><font color="#000080">: </font><font color="#800000">$0000</font><font color="#000080">;

</font><font color="#008000"><i>{ Cscreen is overlaied on video memory, so it requires ZERO bytes
  of memory. This means what is on the screen is whats in the record
  and vica/versa. What you write to the record is on the screen as
  fast as the refresh rate of your monitor.
}

</i></font><font color="#FF0000"><b>procedure </b></font>setscrl<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2 <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>getscrl<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2 <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>scrlup<font color="#000080">(</font>b<font color="#000080">,</font>f <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>scrldn<font color="#000080">(</font>b<font color="#000080">,</font>f <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>scrll<font color="#000080">(</font>b<font color="#000080">,</font>f <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>scrlr<font color="#000080">(</font>b<font color="#000080">,</font>f <font color="#000080">: </font>byte<font color="#000080">);


</font><font color="#FF0000"><b>IMPLEMENTATION

    const
       </b></font>setscrlx1 <font color="#000080">: </font>byte <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
       </font>setscrly1 <font color="#000080">: </font>byte <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
       </font>setscrlx2 <font color="#000080">: </font>byte <font color="#000080">= </font><font color="#800000">80</font><font color="#000080">;
       </font>setscrly2 <font color="#000080">: </font>byte <font color="#000080">= </font><font color="#800000">25</font><font color="#000080">;

    </font><font color="#FF0000"><b>var
      </b></font>reg <font color="#000080">: </font>registers<font color="#000080">;

</font><font color="#008000"><i>{ The setscrl routine is just for convience. As the routines
  below will expect the upper-left and lower-right corners
  of your scroll window, why not set them once insted of
  every time you call the routine. As they are typed constants
  (see above) the defult window size (in 25X80 mode) is full
  screen, but can be set to any size.
}

</i></font><font color="#FF0000"><b>procedure </b></font>setscrl<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2 <font color="#000080">: </font>byte<font color="#000080">);

    </font><font color="#FF0000"><b>begin
      </b></font>setscrlx1<font color="#000080">:= </font>x1<font color="#000080">;
      </font>setscrly1<font color="#000080">:= </font>y1<font color="#000080">;
      </font>setscrlx2<font color="#000080">:= </font>x2<font color="#000080">;
      </font>setscrly2<font color="#000080">:= </font>y2<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Getscrl is used to get the current scroll window size }


</i></font><font color="#FF0000"><b>procedure </b></font>getscrl<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2 <font color="#000080">: </font>byte<font color="#000080">);

    </font><font color="#FF0000"><b>begin
      </b></font>x1<font color="#000080">:= </font>setscrlx1<font color="#000080">;
      </font>y1<font color="#000080">:= </font>setscrly1<font color="#000080">;
      </font>x2<font color="#000080">:= </font>setscrlx2<font color="#000080">;
      </font>y2<font color="#000080">:= </font>setscrly2<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Scrlup will scroll the scroll window (defigned by setscrl) up
  one line. The passed parameters &quot;b&quot; and &quot;f&quot; are the background
  and foreground colors to set the now blank line at the bottom
  of the scroll window.
 }


</i></font><font color="#FF0000"><b>procedure </b></font>scrlup<font color="#000080">(</font>b<font color="#000080">,</font>f <font color="#000080">: </font>byte<font color="#000080">);

    </font><font color="#FF0000"><b>begin
      with </b></font>reg <font color="#FF0000"><b>do
     begin
      </b></font>ah<font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
      </font>al<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>bh<font color="#000080">:= ((</font>b <font color="#FF0000"><b>and </b></font><font color="#800000">7</font><font color="#000080">) * </font><font color="#800000">16</font><font color="#000080">) + (</font>f <font color="#FF0000"><b>and </b></font><font color="#800000">15</font><font color="#000080">);
      </font>ch<font color="#000080">:= </font>setscrly1 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font>cl<font color="#000080">:= </font>setscrlx1 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
      </font>dh<font color="#000080">:= </font>setscrly2 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font>dl<font color="#000080">:= </font>setscrlx2 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>intr<font color="#000080">(</font><font color="#800000">16</font><font color="#000080">,</font>reg<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Scrldn will scroll the scroll window (defigned by setscrl) down
  one line. The passed parameters &quot;b&quot; and &quot;f&quot; are the background
  and foreground colors to set the now blank line at the top of
  the scroll window.
 }

</i></font><font color="#FF0000"><b>procedure </b></font>scrldn<font color="#000080">(</font>b<font color="#000080">,</font>f <font color="#000080">: </font>byte<font color="#000080">);

    </font><font color="#FF0000"><b>begin
      with </b></font>reg <font color="#FF0000"><b>do
     begin
      </b></font>ah<font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
      </font>al<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>bh<font color="#000080">:= ((</font>b <font color="#FF0000"><b>and </b></font><font color="#800000">7</font><font color="#000080">) * </font><font color="#800000">16</font><font color="#000080">) + (</font>f <font color="#FF0000"><b>and </b></font><font color="#800000">15</font><font color="#000080">);
      </font>ch<font color="#000080">:= </font>setscrly1 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font>cl<font color="#000080">:= </font>setscrlx1 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
      </font>dh<font color="#000080">:= </font>setscrly2 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font>dl<font color="#000080">:= </font>setscrlx2 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>intr<font color="#000080">(</font><font color="#800000">16</font><font color="#000080">,</font>reg<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Scrll will scroll the scroll window (defigned by setscrl) left
  one line. The passed parameters &quot;b&quot; and &quot;f&quot; are the background
  and foreground colors to set the now blank line at the left of
  the scroll window.
 }

</i></font><font color="#FF0000"><b>procedure </b></font>scrll<font color="#000080">(</font>b<font color="#000080">,</font>f <font color="#000080">: </font>byte<font color="#000080">);

    </font><font color="#FF0000"><b>var
      </b></font>x<font color="#000080">,</font>y <font color="#000080">: </font>byte<font color="#000080">;

    </font><font color="#FF0000"><b>begin
      for </b></font>y<font color="#000080">:= </font>setscrly1 <font color="#FF0000"><b>to </b></font>setscrly2 <font color="#FF0000"><b>do
      for </b></font>x<font color="#000080">:= </font>setscrlx1 <font color="#FF0000"><b>to </b></font>setscrlx2 <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
     begin
      </b></font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>x<font color="#000080">].</font>at<font color="#000080">:= </font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>x <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">].</font>at<font color="#000080">;
      </font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>x<font color="#000080">].</font>ch<font color="#000080">:= </font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>x <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">].</font>ch<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>for </b></font>y<font color="#000080">:= </font>setscrly1 <font color="#FF0000"><b>to </b></font>setscrly2 <font color="#FF0000"><b>do
     begin
      </b></font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>setscrlx2<font color="#000080">].</font>at<font color="#000080">:= </font>b <font color="#000080">* </font><font color="#800000">16 </font><font color="#000080">+ </font>f<font color="#000080">;
      </font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>setscrlx2<font color="#000080">].</font>ch<font color="#000080">:= </font><font color="#800000">#32</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Scrlr will scroll the scroll window (defigned by setscrl) rigth
  one line. The passed parameters &quot;b&quot; and &quot;f&quot; are the background
  and foreground colors to set the now blank line at the right of
  the scroll window.
 }

</i></font><font color="#FF0000"><b>procedure </b></font>scrlr<font color="#000080">(</font>b<font color="#000080">,</font>f <font color="#000080">: </font>byte<font color="#000080">);

    </font><font color="#FF0000"><b>var
      </b></font>x<font color="#000080">,</font>y <font color="#000080">: </font>byte<font color="#000080">;

    </font><font color="#FF0000"><b>begin
      for </b></font>y<font color="#000080">:= </font>setscrly1 <font color="#FF0000"><b>to </b></font>setscrly2 <font color="#FF0000"><b>do
      for </b></font>x<font color="#000080">:= </font>setscrlx2 <font color="#FF0000"><b>downto </b></font>setscrlx1 <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>do
     begin
      </b></font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>x<font color="#000080">].</font>at<font color="#000080">:= </font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>x <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">].</font>at<font color="#000080">;
      </font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>x<font color="#000080">].</font>ch<font color="#000080">:= </font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>x <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">].</font>ch<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>for </b></font>y<font color="#000080">:= </font>setscrly1 <font color="#FF0000"><b>to </b></font>setscrly2 <font color="#FF0000"><b>do
     begin
      </b></font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>setscrlx1<font color="#000080">].</font>at<font color="#000080">:= </font>b <font color="#000080">* </font><font color="#800000">16 </font><font color="#000080">+ </font>f<font color="#000080">;
      </font>cscreen<font color="#000080">[</font>y<font color="#000080">,</font>setscrlx1<font color="#000080">].</font>ch<font color="#000080">:= </font><font color="#800000">#32</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SCROLL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p></body>
</html>
