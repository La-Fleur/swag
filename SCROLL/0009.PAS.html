<html>
<head><title> "Sinus Scroll" by BAS VAN GAALEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SCROLL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; but you can use Pascal to do things like this:
}
</i></font><font color="#FF0000"><b>program </b></font>SinusScroll<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>GSeg <font color="#000080">= </font><font color="#800000">$a000</font><font color="#000080">;
  </font>Sofs <font color="#000080">= </font><font color="#800000">140</font><font color="#000080">; </font>Samp <font color="#000080">= </font><font color="#800000">40</font><font color="#000080">; </font>Slen <font color="#000080">= </font><font color="#800000">255</font><font color="#000080">;
  </font>Size <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">; </font>Curve <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
  </font>Xmax <font color="#000080">= </font><font color="#800000">279 </font><font color="#FF0000"><b>div </b></font>Size<font color="#000080">; </font>Ymax <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
  </font>ScrSpd <font color="#000080">= -</font><font color="#800000">1</font><font color="#000080">;
  </font>ScrText <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">=
    </font><font color="#800000">' Hai world... This looks a bit like the scroll of the second part'</font><font color="#000080">+
    </font><font color="#800000">' of Future Crew''s Unreal demo (part one)...     It''s not filled'</font><font color="#000080">+
    </font><font color="#800000">' but it sure looks nicer (imho)...                               '</font><font color="#000080">;
</font><font color="#FF0000"><b>type </b></font>SinArray <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>Slen<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Stab <font color="#000080">: </font>SinArray<font color="#000080">; </font>Fseg<font color="#000080">,</font>Fofs <font color="#000080">: </font>word<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>CalcSinus<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>I <font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>begin
  for </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Slen <font color="#FF0000"><b>do </b></font>Stab<font color="#000080">[</font>I<font color="#000080">] := </font>round<font color="#000080">(</font>sin<font color="#000080">(</font>I<font color="#000080">*</font><font color="#800000">4</font><font color="#000080">*</font>pi<font color="#000080">/</font>Slen<font color="#000080">)*</font>Samp<font color="#000080">)+</font>Sofs<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GetFont<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax,1130h; mov bh,1; int 10h; mov Fseg,es; mov Fofs,bp; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SetGraphics<font color="#000080">(</font>Mode <font color="#000080">: </font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax,Mode; int 10h </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>keypressed <font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ah,0bh; int 21h; and al,0feh; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Scroll<font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>ScrArray <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>Xmax<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font>Ymax<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>PosArray <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>Xmax<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font>Ymax<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>PosTab <font color="#000080">: </font>PosArray<font color="#000080">;
  </font>BitMap <font color="#000080">: </font>ScrArray<font color="#000080">;
  </font>X<font color="#000080">,</font>I<font color="#000080">,</font>SinIdx <font color="#000080">: </font>word<font color="#000080">;
  </font>Y<font color="#000080">,</font>ScrIdx<font color="#000080">,</font>CurChar <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>fillchar<font color="#000080">(</font>BitMap<font color="#000080">,</font>sizeof<font color="#000080">(</font>BitMap<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font>fillchar<font color="#000080">(</font>PosTab<font color="#000080">,</font>sizeof<font color="#000080">(</font>PosTab<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font>ScrIdx <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font>SinIdx <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>Curchar <font color="#000080">:= </font>ord<font color="#000080">(</font>ScrText<font color="#000080">[</font>ScrIdx<font color="#000080">]);
    </font>inc<font color="#000080">(</font>ScrIdx<font color="#000080">); </font><font color="#FF0000"><b>if </b></font>ScrIdx <font color="#000080">= </font>length<font color="#000080">(</font>ScrText<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>ScrIdx <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do begin
      </b></font>move<font color="#000080">(</font>BitMap<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">],</font>BitMap<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">],(</font>Ymax<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*</font>Xmax<font color="#000080">);
      </font><font color="#FF0000"><b>for </b></font>Y <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Ymax <font color="#FF0000"><b>do
        if </b></font><font color="#000080">((</font>mem<font color="#000080">[</font>Fseg<font color="#000080">:</font>Fofs<font color="#000080">+</font><font color="#800000">8</font><font color="#000080">*</font>CurChar<font color="#000080">+</font>Y<font color="#000080">] </font><font color="#FF0000"><b>shl </b></font>I<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">128</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
          </b></font>BitMap<font color="#000080">[</font>Xmax<font color="#000080">,</font>Y<font color="#000080">] := ((</font>ScrIdx<font color="#000080">+</font>Y<font color="#000080">-</font>I<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">70</font><font color="#000080">)+</font><font color="#800000">32 </font><font color="#FF0000"><b>else </b></font>BitMap<font color="#000080">[</font>Xmax<font color="#000080">,</font>Y<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>port<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">8</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>port<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">8</font><font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>do</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>X <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Xmax <font color="#FF0000"><b>do
        for </b></font>Y <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Ymax <font color="#FF0000"><b>do begin
          </b></font>mem<font color="#000080">[</font>GSeg<font color="#000080">:</font>PosTab<font color="#000080">[</font>X<font color="#000080">,</font>Y<font color="#000080">]] := </font><font color="#800000">0</font><font color="#000080">;
          </font>PosTab<font color="#000080">[</font>X<font color="#000080">,</font>Y<font color="#000080">] := (</font>Size<font color="#000080">*</font>Y<font color="#000080">+</font>STab<font color="#000080">[(</font>SinIdx<font color="#000080">+</font>X<font color="#000080">+</font>Curve<font color="#000080">*</font>Y<font color="#000080">) </font><font color="#FF0000"><b>mod
                      </b></font>SLen<font color="#000080">])*</font><font color="#800000">320</font><font color="#000080">+</font>Size<font color="#000080">*</font>X<font color="#000080">+</font>STab<font color="#000080">[(</font>X<font color="#000080">+</font>Y<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>SLen<font color="#000080">]-</font>SOfs<font color="#000080">;
          </font>mem<font color="#000080">[</font>GSeg<font color="#000080">:</font>PosTab<font color="#000080">[</font>X<font color="#000080">,</font>Y<font color="#000080">]] := </font>BitMap<font color="#000080">[</font>X<font color="#000080">,</font>Y<font color="#000080">];
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>SinIdx <font color="#000080">:= (</font>SinIdx<font color="#000080">+</font>ScrSpd<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>SLen<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>CalcSinus<font color="#000080">;
  </font>GetFont<font color="#000080">;
  </font>SetGraphics<font color="#000080">(</font><font color="#800000">$13</font><font color="#000080">);
  </font>Scroll<font color="#000080">;
  </font>SetGraphics<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ --- and again --- }

</i></font>The prior <font color="#800000">'release' </font>was a bit buggy indeed <font color="#000080">(</font><font color="#FF0000"><b>as </b></font>I expected<font color="#000080">). </font>So here<font color="#800000">'s a
</font>better working version<font color="#000080">. </font>It<font color="#800000">'s smaller too. Not only thanx to the
</font>variable<font color="#000080">-</font>size<font color="#000080">. </font>Have fun<font color="#000080">!

</font>Btw<font color="#000080">: </font><font color="#800000">'keypressed' </font>was taken from Sean Palmers<font color="#800000">' GhostEd. The rest, of course,
</font>by me<font color="#000080">! ;-)
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SCROLL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
