<html>
<head><title> "DELAYHK.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ISR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
REYNIR STEFANSSON

&gt; I need a Procedure in the form of:
&gt; Type DelayHook = Function : Boolean;
&gt; Procedure DelayIt(S : Word; Hook : DelayHook);

&gt; What it needs to do is keep calling the hook Function Until it returns
&gt; True or the number of 1/100th's of seconds, S, is up.

&gt; Any ideas?  I know how to call the Hook Function, but I am concerned With
&gt; how to go about keeping up With the time Without using the Crt.Delay
&gt; Procedure. I am using this to play a tune (with Sound and NoSound) through
&gt; the speaker and quit when the user presses a key.  The tune is read from
&gt; a Text File of unknown length.  HELP!

{ More or less outta my head... }

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>Reg       <font color="#000080">: </font>Registers<font color="#000080">;
  </font>DelayHook <font color="#000080">: </font><font color="#FF0000"><b>Function </b></font><font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#008000"><i>{
   This proc Uses the AT BIOS' Wait Function: INT 15h, FUNC 86h. It's
   called With a LongInt in CX:DX. Its resolution is ca. 1 microsecond.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>DelayIt<font color="#000080">(</font>S <font color="#000080">: </font>Word<font color="#000080">; </font>Hook <font color="#000080">: </font>DelayHook<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>dly <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>bdy <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Repeat
    </b></font>Reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$86</font><font color="#000080">;
    </font>Reg<font color="#000080">.</font>CX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Reg<font color="#000080">.</font>DX <font color="#000080">:= </font><font color="#800000">10000</font><font color="#000080">; </font><font color="#008000"><i>{ Wait 0.01 sec. }
    </i></font>Intr<font color="#000080">(</font><font color="#800000">$15</font><font color="#000080">, </font>Reg<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>Hook<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ISR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p></body>
</html>
