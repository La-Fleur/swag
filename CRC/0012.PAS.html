<html>
<head><title> "XORSUM CRC Method" by SEAN PALMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CRC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
SEAN PALMER

&gt;&gt; (more than I thought I would have).  There were 190 collisions
&gt;&gt; out of 572 names.

&gt;The solution would be to use a better hashing algorythm, simply
&gt;adding up the ascii characters is not unique enough.  You best
&gt;approach would be to generate a CRC value for your hashing table
&gt;rather then the checksum approach.

Or try this xorsum method (my own invention, have to plug for it... 8)

Lots faster than a crc with no table, with similar results.

NOT compatible with a crc.

This xorsum algorithm is hereby standardized and if anyone wants to use
it you should make sure your xorsum routines give the same results.
}

</i></font><font color="#FF0000"><b>function </b></font>XorSum16<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>data<font color="#000080">; </font>size <font color="#000080">: </font>word<font color="#000080">; </font>prevSum <font color="#000080">: </font>word<font color="#000080">) : </font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push ds
  lds  si, data
  mov  cx, size
  mov  bx, prevSum
  mov  dx, $ABCD
  cld
  jcxz @X
 @L:
  lodsb
  rol  bx, 1
  xor  bx, dx
  xor  bl, al
  loop @L
 @X:
  mov  ax, bx
  pop  ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ to use on a string, for instance: }

</i></font><font color="#FF0000"><b>const
  </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">= </font><font color="#800000">'this is a test'</font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font>xorsum16<font color="#000080">(</font>s<font color="#000080">, </font>length<font color="#000080">(</font>s<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#008000"><i>{
send 0 as prevSum if you're not accumulating a result...otherwise send
the result from the previous buffer.
}

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CRC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p></body>
</html>
