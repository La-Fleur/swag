<html>
<head><title> "Stop Watch Function" by MARTIN ROMMEL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TIMING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{

I am sure it is not the most elegant implementation. Except for the night
of February 29th to March 1st, it should work fine. You might want to
through out the escape and beep procedures. }



</i></font><font color="#FF0000"><b>unit </b></font>Time<font color="#000080">;  </font><font color="#008000"><i>{JMR'91}    { Unit zur Bestimmung von Programmlaufzeiten }

</i></font><font color="#FF0000"><b>interface

  uses </b></font>DOS<font color="#000080">,</font>Crt<font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>Start<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>Elapsed<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Second<font color="#000080">,</font>HundSec<font color="#000080">:</font>Word<font color="#000080">); 
  </font><font color="#FF0000"><b>function </b></font>ElapsedStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;    </font><font color="#008000"><i>{ 'HH:MM:SS,HH' }
  { Elapsed und ElapsedStr ermitteln die Zeit, die seit dem Aufruf von  }
  { Start vergangen ist. Schaltjahre werden nicht berÅcksichtigt.  }
  </i></font><font color="#FF0000"><b>procedure </b></font>beep<font color="#000080">;           </font><font color="#008000"><i>{ gibt kurzen Ton }
  </i></font><font color="#FF0000"><b>function </b></font>escape<font color="#000080">:</font>Boolean<font color="#000080">;  </font><font color="#008000"><i>{ true, wenn &lt;Esc&gt; gedrÅckt wurde (ReadKey) }
{***************************************************************************}

</i></font><font color="#FF0000"><b>implementation

var </b></font>Y<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>DoW<font color="#000080">,</font>Month0<font color="#000080">,</font>Day0<font color="#000080">,</font>Hour0<font color="#000080">,</font>Minute0<font color="#000080">,</font>Second0<font color="#000080">,</font>HundSec0<font color="#000080">:</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Start<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>GetTime<font color="#000080">(</font>Hour0<font color="#000080">,</font>Minute0<font color="#000080">,</font>Second0<font color="#000080">,</font>HundSec0<font color="#000080">);
    </font>GetDate<font color="#000080">(</font>Y<font color="#000080">,</font>Month0<font color="#000080">,</font>Day0<font color="#000080">,</font>DoW<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Elapsed<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Second<font color="#000080">,</font>HundSec<font color="#000080">);
    </font>GetDate<font color="#000080">(</font>Y<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>DoW<font color="#000080">);
    </font>HundSec<font color="#000080">:=</font>HundSec<font color="#000080">-</font>HundSec0<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>HundSec<font color="#000080">&gt;</font><font color="#800000">99 </font><font color="#FF0000"><b>then begin </b></font>HundSec<font color="#000080">:=</font>HundSec<font color="#000080">+</font><font color="#800000">100</font><font color="#000080">; </font>dec<font color="#000080">(</font>Second<font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Second<font color="#000080">:=</font>Second<font color="#000080">-</font>Second0<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>Second<font color="#000080">&gt;</font><font color="#800000">59 </font><font color="#FF0000"><b>then begin </b></font>Second<font color="#000080">:=</font>Second<font color="#000080">+</font><font color="#800000">60</font><font color="#000080">; </font>dec<font color="#000080">(</font>Minute<font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Minute<font color="#000080">:=</font>Minute<font color="#000080">-</font>Minute0<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>Minute<font color="#000080">&gt;</font><font color="#800000">59 </font><font color="#FF0000"><b>then begin </b></font>Minute<font color="#000080">:=</font>Minute<font color="#000080">+</font><font color="#800000">60</font><font color="#000080">; </font>dec<font color="#000080">(</font>Hour<font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Hour<font color="#000080">:=</font>Hour<font color="#000080">-</font>Hour0<font color="#000080">;
    </font>Day<font color="#000080">:=</font>Day<font color="#000080">-</font>Day0<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>Day<font color="#000080">&gt;</font><font color="#800000">30 </font><font color="#FF0000"><b>then if </b></font>Month <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font>Day<font color="#000080">:=</font>Day<font color="#000080">+</font><font color="#800000">31
    </font><font color="#FF0000"><b>else if </b></font>Month<font color="#000080">&lt;&gt;</font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>Day<font color="#000080">:=</font>Day<font color="#000080">+</font><font color="#800000">30
         </font><font color="#FF0000"><b>else </b></font>Day<font color="#000080">:=</font>Day<font color="#000080">+</font><font color="#800000">28</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>Hour<font color="#000080">&gt;</font><font color="#800000">23 </font><font color="#FF0000"><b>then </b></font>Hour<font color="#000080">:=</font>Hour<font color="#000080">+</font><font color="#800000">24</font><font color="#000080">*</font>Day<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ElapsedStr<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Second<font color="#000080">,</font>HundSec<font color="#000080">:</font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>LeadingZero<font color="#000080">(</font>w<font color="#000080">:</font>Word<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>Str<font color="#000080">(</font>w<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font>s<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>Length<font color="#000080">(</font>s<font color="#000080">)=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>s<font color="#000080">:=</font><font color="#800000">'0'</font><font color="#000080">+</font>s<font color="#000080">;
      </font>LeadingZero<font color="#000080">:=</font>s<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Elapsed<font color="#000080">(</font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Second<font color="#000080">,</font>HundSec<font color="#000080">);
    </font>ElapsedStr<font color="#000080">:=</font>LeadingZero<font color="#000080">(</font>Hour<font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">+</font>LeadingZero<font color="#000080">(</font>Minute<font color="#000080">)+</font><font color="#800000">':'
        </font><font color="#000080">+</font>LeadingZero<font color="#000080">(</font>Second<font color="#000080">)</font><font color="#008000"><i>{+','+LeadingZero(HundSec)}</i></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>beep<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>sound<font color="#000080">(</font><font color="#800000">440</font><font color="#000080">);
    </font>delay<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
    </font>nosound<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Escape<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>Taste<font color="#000080">:</font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>Keypressed <font color="#FF0000"><b>then
 if </b></font>Ord<font color="#000080">(</font>ReadKey<font color="#000080">)=</font><font color="#800000">27 </font><font color="#FF0000"><b>then </b></font>Escape<font color="#000080">:=</font>true
     <font color="#FF0000"><b>else </b></font>Escape<font color="#000080">:=</font>false
    <font color="#FF0000"><b>else </b></font>Escape<font color="#000080">:=</font>false<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">. </font><font color="#008000"><i>{ Unit Time }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TIMING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p></body>
</html>
