<html>
<head><title> "LongInt to Hex in BASM" by RYAN THOMPSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">  From<font color="#000080">: </font>Ryan Thompson                                Read<font color="#000080">: </font>Yes    Replied<font color="#000080">: </font>No

<font color="#008000"><i>{ I have an Integer to hex in pascal with ASM: }

</i></font><font color="#FF0000"><b>Function </b></font>HexOf<font color="#000080">(</font>I <font color="#000080">: </font>Longint<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">jmp   @1                         </font><font color="#008000"><i>{ Skip table }
  </i></font><font color="#FF00FF">@0:
    db    '0123456789ABCDEF'
  @1:
    cld                              </font><font color="#008000"><i>{ Clear direction flag }
    </i></font><font color="#FF00FF">les   di,@Result                 </font><font color="#008000"><i>{ ES:DI = Function return data }
    </i></font><font color="#FF00FF">mov   ax,$0008                   </font><font color="#008000"><i>{ Set String size }
    </i></font><font color="#FF00FF">stosb                            </font><font color="#008000"><i>{ in the output, }
    </i></font><font color="#FF00FF">mov   cx,4                       </font><font color="#008000"><i>{ Loop 4x for four bytes }
    </i></font><font color="#FF00FF">mov   si,3
  @2:
    mov   al,byte [I+si]             </font><font color="#008000"><i>{ Load AL with next byte }
    </i></font><font color="#FF00FF">dec   si
    push  si                         </font><font color="#008000"><i>{ SAVE index register! }
    </i></font><font color="#FF00FF">mov   bl,al                      </font><font color="#008000"><i>{ Load DL... }
    </i></font><font color="#FF00FF">mov   dl,bl                      </font><font color="#008000"><i>{ and BL, }
    </i></font><font color="#FF00FF">and   bx,$00F0                   </font><font color="#008000"><i>{ prepare and ... }
    {$IFOPT G+}
    </i></font><font color="#FF00FF">shr   bx,4
    </font><font color="#008000"><i>{$ELSE}
    </i></font><font color="#FF00FF">shr   bx,1                       </font><font color="#008000"><i>{ convert BL to high nybble only, }
    </i></font><font color="#FF00FF">shr   bx,1
    shr   bx,1                       </font><font color="#008000"><i>{ 8088-compatible }
    </i></font><font color="#FF00FF">shr   bx,1
    </font><font color="#008000"><i>{$ENDIF}
    </i></font><font color="#FF00FF">and   dx,$000F                   </font><font color="#008000"><i>{ and DL to low nybble only. }
    </i></font><font color="#FF00FF">mov   si,bx                      </font><font color="#008000"><i>{ move high nybble into index, }
    </i></font><font color="#FF00FF">mov   al,byte [cs:@0+si]         </font><font color="#008000"><i>{ read Character for that nybble, }
    </i></font><font color="#FF00FF">stosb                            </font><font color="#008000"><i>{ Write high nybble }
    </i></font><font color="#FF00FF">mov   si,dx                      </font><font color="#008000"><i>{ move low nybble into index, }
    </i></font><font color="#FF00FF">mov   al,byte [cs:@0+si]         </font><font color="#008000"><i>{ read Character for that nybble, }
    </i></font><font color="#FF00FF">stosb                            </font><font color="#008000"><i>{ Write low nybble }
    </i></font><font color="#FF00FF">pop   si                         </font><font color="#008000"><i>{ RESTORE index register! }
    </i></font><font color="#FF00FF">loop  @2                         </font><font color="#008000"><i>{ Dec CX; Loop if CX &lt;&gt; 0 }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{
  It's not wonderfully written code, but it does work.  Spits out an 8-digit
hex string from a longint.  You could either delete the unneeded parts of the
string or make a version that doesn't do all four bytes.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p></body>
</html>
