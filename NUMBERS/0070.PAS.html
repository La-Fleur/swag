<html>
<head><title> "Advanced Random Number Theory" by PIERRE TOURIGNY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0070.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
&gt;&gt;This is not so. The period of Borland's generator is 2^32, i.e.,
&gt;&gt;4.3 billion. The linear recurrence is randseed :=
&gt;&gt;randseed*134775813+1 {mod 2^32}; (the mod is implemented by
&gt;&gt;letting the calculation overflow). A  recurrence of the form ax+c
&gt;&gt;mod 2^e has maximum period when c is odd and (a mod 4) is 1.
&gt;&gt;Borland's formula satisfies those conditions, so it will output a
&gt;&gt;permutation of the range 0 to 2^32-1 before the sequence repeats.

&gt;you have the conditions wrong. the factor 2^e has to be prime and a
&gt;has to be a primitive element modulo the factor before you get
&gt;maximum period. 2^e is most definitely not prime. the generator
&gt;happens to have much less than maximum period. the other
&gt;relationship that a and m must have is that a^2 &lt; m. this is also
&gt;violated in the Borland formula.

Here's an easy counter-example: x := (x*5+1) mod 2^3 yields the maximum 
period repeating sequence 0,1,6,7,4,5,2,3. The modulus m = 2^3 = 8 is 
not prime and 5^2 = 25 is larger than 8.

I quote Knuth's 'The Art of Computer Programming', vol.2:
 (exercise 2 of section 3.2.1.2, p.20)
   Are the following two conditions sufficient to guarantee the
   maximum length period, when m = 2^e is a power of 2?
   &quot;(i) c is odd; (ii) a mod 4 = 1.&quot;
 (answer, p.458)
   Yes, these conditions imply the conditions in Theorem A, since
   the only prime divisor of 2^e is 2, and any odd number is rela-
   tively prime to 2^e. (In fact, the conditions of the exercise
   are necessary and sufficient, if e &lt;&gt; 2.)
 (Theorem A referred to above, p.15)
   The linear congruential sequence has a period of length m if and
   only if
      i) c is relatively prime to m;
     ii) b = a-1 is a multiple of p, for every prime p dividing m;
    iii) b is a multiple of 4, if m is a multiple of 4.

If you don't believe Knuth, try this program. If you're right that the
period of Borland's generator is no more than 10^5, it won't run long
and it won't write a single asterisk (expect lots):
*)

</i></font><font color="#FF0000"><b>program </b></font>borpriod<font color="#000080">; </font><font color="#008000"><i>{calculates the period of Borland's random}
{The period should be 2^32, so this will take hours}
</i></font><font color="#FF0000"><b>var </b></font>x<font color="#000080">,</font>y<font color="#000080">,</font>count1<font color="#000080">,</font>count2<font color="#000080">: </font>longint<font color="#000080">; </font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>randomize<font color="#000080">;
</font>x <font color="#000080">:= </font>randseed<font color="#000080">; </font>y <font color="#000080">:= </font>randseed<font color="#000080">;
</font><font color="#FF0000"><b>for </b></font>count2 <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>maxlongint <font color="#FF0000"><b>do begin
  for </b></font>count1 <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">999999 </font><font color="#FF0000"><b>do begin
    </b></font>x <font color="#000080">:= </font>x<font color="#000080">*</font><font color="#800000">134775813</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{TP7's and TP6's generator for random}
    </i></font>y <font color="#000080">:= </font>y<font color="#000080">*</font><font color="#800000">134775813</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{implicit modulus is 2^32}
    </i></font>y <font color="#000080">:= </font>y<font color="#000080">*</font><font color="#800000">134775813</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{see Knuth vol 2, p.453 for explanation}
    </i></font><font color="#FF0000"><b>if </b></font>x <font color="#000080">= </font>y <font color="#FF0000"><b>then begin
      </b></font>inc<font color="#000080">(</font>count1<font color="#000080">); </font><font color="#008000"><i>{adjust because first count was 0}
      </i></font><font color="#FF0000"><b>if </b></font>count1 <font color="#000080">= </font><font color="#800000">1000000 </font><font color="#FF0000"><b>then begin </b></font>count1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>inc<font color="#000080">(</font>count2<font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>count2 <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        </b></font>str<font color="#000080">(</font>count1<font color="#000080">,</font>s<font color="#000080">);
        </font>writeln<font color="#000080">(</font><font color="#800000">#13#10'Period: '</font><font color="#000080">,</font>count2<font color="#000080">,
          </font>copy<font color="#000080">(</font><font color="#800000">'000000'</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">-</font>length<font color="#000080">(</font>s<font color="#000080">)),</font>count1<font color="#000080">);
        </font><font color="#FF0000"><b>end
      else </b></font>writeln<font color="#000080">(</font><font color="#800000">#13#10'Period: '</font><font color="#000080">,</font>count1<font color="#000080">);
      </font>halt<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>write<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">); </font><font color="#008000"><i>{one per million}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0070.PAS">Original</a><b>]</b></p></body>
</html>
