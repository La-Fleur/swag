<html>
<head><title> "MS to IEEE Numbers" by TREVOR CARLSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Trevor Carlson

&gt; Does anyone have source examples of how to convert an MSBIN to a
&gt; LongInt Type Variable?
}

</i></font><font color="#FF0000"><b>Type
  </b></font>MKS <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>MStoIEEE<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>MS<font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#008000"><i>{ Converts a 4 Byte Microsoft format single precision Real Variable as
  used in earlier versions of QuickBASIC and GW-BASIC to IEEE 6 Byte Real }
</i></font><font color="#FF0000"><b>Var
  </b></font>m    <font color="#000080">: </font>MKS <font color="#FF0000"><b>Absolute </b></font>MS<font color="#000080">;
  </font>r    <font color="#000080">: </font>Real<font color="#000080">;
  </font>ieee <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#FF0000"><b>Absolute </b></font>r<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>r<font color="#000080">, </font>sizeof<font color="#000080">(</font>r<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
  </font>ieee<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>m<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>ieee<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>m<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];
  </font>ieee<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] := </font>m<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
  </font>ieee<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">] := </font>m<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font>MStoieee <font color="#000080">:= </font>r<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ MStoIEEE }


</i></font><font color="#FF0000"><b>Function </b></font>IEEEtoMS<font color="#000080">(</font>ie <font color="#000080">: </font>Real<font color="#000080">) : </font>LongInt<font color="#000080">;
</font><font color="#008000"><i>{ LongInt Type used only For convenience of Typecasting. Note that this will
  only be effective where the accuracy required can be obtained in the 23
  bits that are available With the MKS Type. }
</i></font><font color="#FF0000"><b>Var
  </b></font>ms    <font color="#000080">: </font>MKS<font color="#000080">;
  </font>ieee  <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#FF0000"><b>Absolute </b></font>ie<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ms<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>ieee<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];
  </font>ms<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>ieee<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>ms<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>ieee<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
  </font>ms<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>ieee<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];
  </font>IEEEtoMS <font color="#000080">:= </font>LongInt<font color="#000080">(</font>ms<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ IEEEtoMS }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p></body>
</html>
