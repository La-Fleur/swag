<html>
<head><title> "Improved Decimal To Binar" by VARIOUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{Convert a Decimal to a String - Maximum number of bits = 16}

</i></font><font color="#FF0000"><b>Function </b></font>Dec2Bin <font color="#000080">(</font>D<font color="#000080">: </font>Word<font color="#000080">; </font>No_Bits<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>A   <font color="#000080">: </font>Word<font color="#000080">;
    </font>L   <font color="#000080">: </font>Byte<font color="#000080">;
    </font>S   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>S <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
   </font>A <font color="#000080">:= </font>Trunc <font color="#000080">(</font>Exp <font color="#000080">((</font>No_Bits<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font>Ln <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)));
   </font><font color="#FF0000"><b>For </b></font>L <font color="#000080">:= </font>No_Bits <font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
   Begin
      </b></font>A <font color="#000080">:= </font>A <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>D <font color="#FF0000"><b>AND </b></font>A<font color="#000080">)=</font>A <font color="#FF0000"><b>then </b></font>S <font color="#000080">:= </font>S<font color="#000080">+</font><font color="#800000">'1' </font><font color="#FF0000"><b>else </b></font>S <font color="#000080">:= </font>S<font color="#000080">+</font><font color="#800000">'0'</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>Dec2Bin <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>(*------------------------------------------------------*)
</i></font><font color="#FF0000"><b>Function </b></font>BinStr<font color="#000080">(</font>num<font color="#000080">:</font>word<font color="#000080">;</font>bits<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
      </b></font><font color="#FF00FF">PUSHF
      LES  DI, @Result
      XOR  CH, CH
      MOV  CL, bits
      MOV  ES:[DI], CL
      JCXZ @@3
      ADD  DI, CX
      MOV  BX, num
      STD
@@1:  MOV  AL, BL
      AND  AL, $01
      OR   AL, $30
      STOSB
      SHR  BX, 1
      LOOP @@1
@@3:  POPF
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p></body>
</html>
