<html>
<head><title> "BP 6.0 Replacement Random Number" by PIERRE TOURIGNY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0068.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;  Having said that, I do think Pascal's random is random enough for
&gt;most earthly purposes.  :)

You're excluding Nasa, I see ;-). Seriously, this is true only for
Borland's version 7. The version 6 generator is bad.

For the cases where the internal random is not good enough, here's my
choice for a 'serious' generator:

From: pierre.tourigny@bbs.synapse.net (Pierre Tourigny)
}

</i></font><font color="#FF0000"><b>function </b></font>ran1pt<font color="#000080">: </font>real<font color="#000080">;
</font><font color="#008000"><i>{adapted from ran1 in NRPAS13.ZIP (code for the book 
Numerical Recipes in Pascal); modified 94-03-25 by Pierre 
Tourigny, pierre.tourigny@bbs.synapse.net; Ran1pt calls 
Randomize if RANDSEED has not already been set}
</i></font><font color="#FF0000"><b>const
  </b></font>m1<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">259200</font><font color="#000080">; </font>i1<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">7141</font><font color="#000080">; </font>c1<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">54773</font><font color="#000080">;
  </font>m2<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">134456</font><font color="#000080">; </font>i2<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">8121</font><font color="#000080">; </font>c2<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">28411</font><font color="#000080">;
  </font>m3<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">243000</font><font color="#000080">; </font>i3<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">4561</font><font color="#000080">; </font>c3<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">51349</font><font color="#000080">;
  </font><font color="#008000"><i>{static variables}
  </i></font>x1<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">; </font>x2<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">; </font>x3<font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>r<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">97</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>real <font color="#000080">= (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font>initialized<font color="#000080">: </font>boolean <font color="#000080">= </font>false<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>j<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
if not </b></font>initialized <font color="#FF0000"><b>then begin
  if </b></font>randseed <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>randomize
  <font color="#FF0000"><b>else </b></font>randseed <font color="#000080">:= </font>abs<font color="#000080">(</font>randseed<font color="#000080">);
  </font>x1 <font color="#000080">:= (</font>randseed<font color="#000080">+</font>c1<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>m1<font color="#000080">;
  </font>x1 <font color="#000080">:= (</font>x1<font color="#000080">*</font>i1<font color="#000080">+</font>c1<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>m1<font color="#000080">;
  </font>x2 <font color="#000080">:= </font>x1 <font color="#FF0000"><b>mod </b></font>m2<font color="#000080">;
  </font>x1 <font color="#000080">:= (</font>x1<font color="#000080">*</font>i1<font color="#000080">+</font>c1<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>m1<font color="#000080">;
  </font>x3 <font color="#000080">:= </font>x1 <font color="#FF0000"><b>mod </b></font>m3<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">97 </font><font color="#FF0000"><b>do begin
    </b></font>x1 <font color="#000080">:= (</font>x1<font color="#000080">*</font>i1<font color="#000080">+</font>c1<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>m1<font color="#000080">;
    </font>x2 <font color="#000080">:= (</font>x2<font color="#000080">*</font>i2<font color="#000080">+</font>c2<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>m2<font color="#000080">;
    </font>r<font color="#000080">[</font>j<font color="#000080">] := (</font>x1<font color="#000080">+</font>x2<font color="#000080">/</font>m2<font color="#000080">)/</font>m1<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>initialized <font color="#000080">:= </font>true<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>x1 <font color="#000080">:= (</font>x1<font color="#000080">*</font>i1<font color="#000080">+</font>c1<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>m1<font color="#000080">;
</font>x2 <font color="#000080">:= (</font>x2<font color="#000080">*</font>i2<font color="#000080">+</font>c2<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>m2<font color="#000080">;
</font>x3 <font color="#000080">:= (</font>x3<font color="#000080">*</font>i3<font color="#000080">+</font>c3<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>m3<font color="#000080">;
</font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">+ (</font><font color="#800000">97</font><font color="#000080">*</font>x3<font color="#000080">) </font><font color="#FF0000"><b>div </b></font>m3<font color="#000080">;
</font>ran1pt <font color="#000080">:= </font>r<font color="#000080">[</font>j<font color="#000080">];
</font>r<font color="#000080">[</font>j<font color="#000080">] := (</font>x1<font color="#000080">+</font>x2<font color="#000080">/</font>m2<font color="#000080">)/</font>m1<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ranlong<font color="#000080">(</font>max<font color="#000080">: </font>longint<font color="#000080">): </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>ranlong <font color="#000080">:= </font>trunc<font color="#000080">(</font>max <font color="#000080">* </font>ran1pt<font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0068.PAS">Original</a><b>]</b></p></body>
</html>
