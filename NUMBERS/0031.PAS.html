<html>
<head><title> "Verify ISBN Numbers" by GREG VIGNEAULT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{===========================================================================
Date: 09-22-93 (20:14)
From: GREG VIGNEAULT
Subj: Pascal ISBN verification

 Here's a snippet of TP code for the free SWAG archives. It verifies
 ISBN numbers, via the embedded checksum ... }

(********************************************************************)
(* Turbo/Quick/StonyBrook Pascal source file: ISBN.PAS  v1.0 GSV    *)
(* Verify any International Standard Book Number (ISBN) ...         *)

</i></font><font color="#FF0000"><b>PROGRAM </b></font>checkISBN<font color="#000080">;

</font><font color="#FF0000"><b>CONST </b></font>TAB <font color="#000080">= </font><font color="#800000">#9</font><font color="#000080">;                       </font><font color="#008000"><i>{ ASCII horizontal tab         }
      </i></font>LF  <font color="#000080">= </font><font color="#800000">#10</font><font color="#000080">;                      </font><font color="#008000"><i>{ ASCII line feed              }

</i></font><font color="#FF0000"><b>VAR </b></font>ISBNstr <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">];
    </font>loopc<font color="#000080">, </font>ISBNlen<font color="#000080">, </font>M<font color="#000080">, </font>chksm <font color="#000080">: </font>BYTE<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{checkISBN}

  </i></font>WriteLn <font color="#000080">(</font>LF<font color="#000080">,</font>TAB<font color="#000080">,</font><font color="#800000">'ISBN Check v1.0 Copyright 1993 Greg Vigneault'</font><font color="#000080">,</font>LF<font color="#000080">);

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">( </font>ParamCount <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN   </b></font><font color="#008000"><i>{ we want just one input parm  }
    </i></font>WriteLn <font color="#000080">( </font>TAB<font color="#000080">, </font><font color="#800000">'Usage: ISBN &lt;ISBN#&gt;'</font><font color="#000080">, </font>LF <font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{IF}

  </i></font>ISBNstr <font color="#000080">:= </font>ParamStr <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);            </font><font color="#008000"><i>{ get the ISBN number          }
  </i></font>Write <font color="#000080">( </font>TAB<font color="#000080">, </font><font color="#800000">'Checking ISBN# '</font><font color="#000080">, </font>ISBNstr<font color="#000080">, </font><font color="#800000">' ...' </font><font color="#000080">);
  </font><font color="#008000"><i>{ eliminate any non-digit characters from the ISBN string...       }
  </i></font>ISBNlen <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>loopc <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>ORD <font color="#000080">( </font>ISBNstr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] ) </font><font color="#FF0000"><b>DO
    IF </b></font><font color="#000080">( </font>ISBNstr<font color="#000080">[ </font>loopc <font color="#000080">] </font><font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">] ) </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>INC <font color="#000080">( </font>ISBNlen <font color="#000080">);
      </font>ISBNstr<font color="#000080">[ </font>ISBNlen <font color="#000080">] := </font>ISBNstr<font color="#000080">[ </font>loopc <font color="#000080">];
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{IF &amp; FOR}
  { an 'X' at the end of the ISBN affects the result...              }
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">( </font>ISBNstr<font color="#000080">[ </font>ORD <font color="#000080">( </font>ISBNstr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] ) ] </font><font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'X'</font><font color="#000080">,</font><font color="#800000">'x'</font><font color="#000080">] ) </font><font color="#FF0000"><b>THEN
    </b></font>M <font color="#000080">:= </font><font color="#800000">10
  </font><font color="#FF0000"><b>ELSE
    </b></font>M <font color="#000080">:= </font>ORD <font color="#000080">( </font>ISBNstr<font color="#000080">[ </font>ISBNlen <font color="#000080">] ) - </font><font color="#800000">48</font><font color="#000080">;
  </font>ISBNstr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>CHR <font color="#000080">( </font>ISBNlen <font color="#000080">);          </font><font color="#008000"><i>{ new ISBN string length   }
  </i></font>WriteLn <font color="#000080">( </font><font color="#800000">'reduced ISBN = '</font><font color="#000080">, </font>ISBNstr <font color="#000080">);  </font>WriteLn<font color="#000080">;
  </font>chksm <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                             </font><font color="#008000"><i>{ initialize checksum      }
  </i></font><font color="#FF0000"><b>FOR </b></font>loopc <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>ISBNlen<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO
    </b></font>INC <font color="#000080">(</font>chksm<font color="#000080">, ( </font>ORD <font color="#000080">( </font>ISBNstr<font color="#000080">[ </font>loopc <font color="#000080">] ) - </font><font color="#800000">48 </font><font color="#000080">) * </font>loopc <font color="#000080">);
  </font>Write <font color="#000080">( </font>TAB<font color="#000080">, </font><font color="#800000">'ISBN ' </font><font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">( ( </font>chksm <font color="#FF0000"><b>MOD </b></font><font color="#800000">11 </font><font color="#000080">) = </font>M <font color="#000080">) </font><font color="#FF0000"><b>THEN
    </b></font>WriteLn <font color="#000080">( </font><font color="#800000">'is okay.' </font><font color="#000080">)
  </font><font color="#FF0000"><b>ELSE
    </b></font>WriteLn <font color="#000080">( </font><font color="#800000">'error!'</font><font color="#000080">,</font><font color="#800000">#7 </font><font color="#000080">);

</font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{checkISBN}</i></font><font color="#000080">.                      </font><font color="#008000"><i>(* Not for commercial retail. *)
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p></body>
</html>
