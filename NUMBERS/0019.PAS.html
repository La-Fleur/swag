<html>
<head><title> "ROMAN1.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&uacute;    Subject: Word to Roman Numeral

  OK, here is my second attempt, With error checking and all. Thanks to
Terry Moore &lt;T.Moore@massey.ac.nz&gt; For encouraging me. The last Function
also contained a couple of errors. This one is errorchecked.
}

</i></font><font color="#FF0000"><b>Function </b></font>RomantoArabic<font color="#000080">(</font>Roman <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#008000"><i>{ Converts a Roman number to its Integer representation }
{ Returns -1 if anything is wrong }

  </i></font><font color="#FF0000"><b>Function </b></font>Valueof<font color="#000080">(</font>ch <font color="#000080">: </font>Char<font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    Case </b></font>ch <font color="#FF0000"><b>of
      </b></font><font color="#800000">'I' </font><font color="#000080">: </font>Valueof<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#800000">'V' </font><font color="#000080">: </font>Valueof<font color="#000080">:=</font><font color="#800000">5</font><font color="#000080">;
      </font><font color="#800000">'X' </font><font color="#000080">: </font>Valueof<font color="#000080">:=</font><font color="#800000">10</font><font color="#000080">;
      </font><font color="#800000">'L' </font><font color="#000080">: </font>Valueof<font color="#000080">:=</font><font color="#800000">50</font><font color="#000080">;
      </font><font color="#800000">'C' </font><font color="#000080">: </font>Valueof<font color="#000080">:=</font><font color="#800000">100</font><font color="#000080">;
      </font><font color="#800000">'D' </font><font color="#000080">: </font>Valueof<font color="#000080">:=</font><font color="#800000">500</font><font color="#000080">;
      </font><font color="#800000">'M' </font><font color="#000080">: </font>Valueof<font color="#000080">:=</font><font color="#800000">1000</font><font color="#000080">;
      </font><font color="#FF0000"><b>else </b></font>Valueof<font color="#000080">:=-</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;   </font><font color="#008000"><i>{ Valueof }

  </i></font><font color="#FF0000"><b>Function </b></font>AFive<font color="#000080">(</font>ch <font color="#000080">: </font>Char<font color="#000080">) : </font>Boolean<font color="#000080">; </font><font color="#008000"><i>{ Returns True if ch = 5,50,500 }
  </i></font><font color="#FF0000"><b>begin
    </b></font>AFive<font color="#000080">:=</font>ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'V'</font><font color="#000080">,</font><font color="#800000">'L'</font><font color="#000080">,</font><font color="#800000">'D'</font><font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;   </font><font color="#008000"><i>{ AFive }

</i></font><font color="#FF0000"><b>Var
  </b></font>Position <font color="#000080">: </font>Byte<font color="#000080">;
  </font>TheValue<font color="#000080">, </font>CurrentValue <font color="#000080">: </font>Integer<font color="#000080">;
  </font>HighestPreviousValue <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Position<font color="#000080">:=</font>Length<font color="#000080">(</font>Roman<font color="#000080">); </font><font color="#008000"><i>{ Initialize all Variables }
  </i></font>TheValue<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>HighestPreviousValue<font color="#000080">:=</font>Valueof<font color="#000080">(</font>Roman <font color="#000080">[</font>Position<font color="#000080">]);
  </font><font color="#FF0000"><b>While </b></font>Position <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>CurrentValue<font color="#000080">:=</font>Valueof<font color="#000080">(</font>Roman <font color="#000080">[</font>Position<font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font>CurrentValue<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>RomantoArabic<font color="#000080">:=-</font><font color="#800000">1</font><font color="#000080">;
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>CurrentValue <font color="#000080">&gt;= </font>HighestPreviousValue <font color="#FF0000"><b>then
    begin
      </b></font>TheValue<font color="#000080">:=</font>TheValue<font color="#000080">+</font>CurrentValue<font color="#000080">;
      </font>HighestPreviousValue<font color="#000080">:=</font>CurrentValue<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
    begin </b></font><font color="#008000"><i>{ if the digit precedes something larger }
      </i></font><font color="#FF0000"><b>if </b></font>AFive<font color="#000080">(</font>Roman <font color="#000080">[</font>Position<font color="#000080">]) </font><font color="#FF0000"><b>then
      begin
              </b></font>RomantoArabic<font color="#000080">:=-</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{ A five digit can't precede anything }
              </i></font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>HighestPreviousValue <font color="#FF0000"><b>div </b></font>CurrentValue <font color="#000080">&gt; </font><font color="#800000">10 </font><font color="#FF0000"><b>then
      begin
              </b></font>RomantoArabic<font color="#000080">:=-</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{ e.g. 'XM', 'IC', 'XD'... }
              </i></font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>TheValue<font color="#000080">:=</font>TheValue<font color="#000080">-</font>CurrentValue<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Dec<font color="#000080">(</font>Position<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>RomantoArabic<font color="#000080">:=</font>TheValue<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;   </font><font color="#008000"><i>{ RomantoArabic }

</i></font><font color="#FF0000"><b>begin
  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'XXIV = '</font><font color="#000080">, </font>RomantoArabic<font color="#000080">(</font><font color="#800000">'XXIV'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'DXIV = '</font><font color="#000080">, </font>RomantoArabic<font color="#000080">(</font><font color="#800000">'DXIV'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'CXIV = '</font><font color="#000080">, </font>RomantoArabic<font color="#000080">(</font><font color="#800000">'CXIV'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'MIXC = '</font><font color="#000080">, </font>RomantoArabic<font color="#000080">(</font><font color="#800000">'MIXC'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'MXCIX = '</font><font color="#000080">, </font>RomantoArabic<font color="#000080">(</font><font color="#800000">'MXCIX'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'LXVIII = '</font><font color="#000080">, </font>RomantoArabic<font color="#000080">(</font><font color="#800000">'LXVIII'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'MCCXXIV = '</font><font color="#000080">, </font>RomantoArabic<font color="#000080">(</font><font color="#800000">'MCCXXIV'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'MMCXLVI = '</font><font color="#000080">, </font>RomantoArabic<font color="#000080">(</font><font color="#800000">'MMCXLVI'</font><font color="#000080">));
  </font>Readln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p></body>
</html>
