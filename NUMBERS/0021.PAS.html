<html>
<head><title> "SHLSHR.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ INFO ON SHR and SHL }

</i></font><font color="#000080">&gt; (</font><font color="#800000">5 </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">5 </font>which <font color="#FF0000"><b>is</b></font><font color="#000080">: (</font><font color="#800000">5 </font>x <font color="#800000">4</font><font color="#000080">) + </font><font color="#800000">5
</font><font color="#000080">&gt; </font>So<font color="#000080">, </font><font color="#800000">10 </font><font color="#000080">* </font><font color="#800000">10 </font>would be <font color="#000080">(</font><font color="#800000">10 </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">3</font><font color="#000080">) + (</font><font color="#800000">10 </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">1</font><font color="#000080">)

</font>This looks good but<font color="#000080">, </font>can it be done <font color="#FF0000"><b>With </b></font>Variables <font color="#000080">(</font>So I can use
numbers other than <font color="#800000">5 </font><font color="#000080">&amp; </font><font color="#800000">5</font><font color="#000080">)?

 </font>Yes<font color="#000080">, </font>just keep <font color="#FF0000"><b>in </b></font>mind that each shift leftward Doubles the value<font color="#000080">...

        </font>p <font color="#FF0000"><b>SHL </b></font><font color="#800000">1  </font><font color="#000080">=  </font>p <font color="#000080">* </font><font color="#800000">2
        </font>p <font color="#FF0000"><b>SHL </b></font><font color="#800000">2  </font><font color="#000080">=  </font>p <font color="#000080">* </font><font color="#800000">4
        </font>p <font color="#FF0000"><b>SHL </b></font><font color="#800000">3  </font><font color="#000080">=  </font>p <font color="#000080">* </font><font color="#800000">8
        </font>p <font color="#FF0000"><b>SHL </b></font><font color="#800000">4  </font><font color="#000080">=  </font>p <font color="#000080">* </font><font color="#800000">16
        </font><font color="#000080">...

 (</font>likewise<font color="#000080">, </font>each shift rightward halves the value<font color="#000080">).

 </font>Also keep <font color="#FF0000"><b>in </b></font>mind that the maximum amount you can shift <font color="#FF0000"><b>is </b></font>the
 number <font color="#FF0000"><b>of </b></font>bits <font color="#FF0000"><b>in </b></font>the Variable<font color="#000080">.  </font>Bytes are <font color="#800000">8 </font>bits<font color="#000080">, </font>Words <font color="#FF0000"><b>and
 </b></font>Integers are <font color="#800000">16 </font>bits<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>LongInts are <font color="#800000">32 </font>bits<font color="#000080">.  </font><font color="#FF0000"><b>if </b></font>you shift
 a Variable its full bit size<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>more<font color="#000080">, </font>it will be <font color="#800000">0 </font><font color="#000080">(</font>zero<font color="#000080">).

 </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">: </font><font color="#FF0000"><b>if </b></font>p <font color="#FF0000"><b>is </b></font>a Byte<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>p <font color="#FF0000"><b>SHR </b></font><font color="#800000">8 </font><font color="#000080">= </font><font color="#800000">0.

</font><font color="#008000"><i>{  Use Shr/Shl to multiply/divide, rather than the operators
  How do you (or anybody) do this?   For example, how would I do 5 * 5?
}
{*******************************************************************}
 </i></font><font color="#FF0000"><b>Program </b></font>DemoShifts<font color="#000080">;
 </font><font color="#FF0000"><b>Var     </b></font>Number<font color="#000080">, </font>Result  <font color="#000080">: </font>Word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
    </b></font><font color="#008000"><i>{   Calculate 5 * 5, without using multiplication ...           }

    </i></font>Number <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;                    </font><font color="#008000"><i>{ original value                }
    </i></font>Result <font color="#000080">:= </font>Number <font color="#FF0000"><b>SHL </b></font><font color="#800000">2</font><font color="#000080">;         </font><font color="#008000"><i>{ now Result = 4 * Number       }
    </i></font>Result <font color="#000080">:= </font>Result <font color="#000080">+ </font>Number<font color="#000080">;      </font><font color="#008000"><i>{ 4*Number + Number = 5*Number  }

    </i></font>WriteLn<font color="#000080">( </font><font color="#800000">'5 * 5 = '</font><font color="#000080">, </font>Result <font color="#000080">);  </font><font color="#008000"><i>{ because seeing is believing   }

 </i></font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{DemoShifts}</i></font><font color="#000080">.
</font><font color="#008000"><i>{*******************************************************************}

 </i></font>But TP seems sometimes <font color="#FF0000"><b>to do </b></font>the <font color="#800000">'shift vs. MUL optimization' </font>itself<font color="#000080">,
 </font>this being bad <font color="#FF0000"><b>if </b></font>Compiling <font color="#FF0000"><b>For </b></font>a <font color="#800000">386</font><font color="#000080">/</font><font color="#800000">486 </font>CPU<font color="#000080">.
 </font>A <font color="#000080">&quot;* </font><font color="#800000">2</font><font color="#000080">&quot; </font>would always result <font color="#FF0000"><b>in </b></font>a <font color="#FF0000"><b>SHL </b></font>instruction <font color="#000080">( </font>unless Real
 arithmetic was used <font color="#000080">;-&gt; ).

 </font>Ok<font color="#000080">, </font>I understand that part<font color="#000080">.  </font><font color="#FF0000"><b>if </b></font>x <font color="#FF0000"><b>shr </b></font><font color="#800000">4 </font><font color="#000080">= </font>x<font color="#000080">/</font><font color="#800000">4  </font><font color="#000080">(</font><font color="#FF0000"><b>and </b></font>the remainder <font color="#FF0000"><b>is
 </b></font>dropped<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>I Really understand it<font color="#000080">.  </font>Does it<font color="#000080">? </font><font color="#FF0000"><b>Do </b></font>I<font color="#000080">?

</font>No<font color="#000080">.  </font>x <font color="#FF0000"><b>shl </b></font><font color="#800000">0 </font><font color="#000080">= </font>x
     x <font color="#FF0000"><b>shl </b></font><font color="#800000">1 </font><font color="#000080">= </font>x<font color="#000080">/(</font><font color="#800000">2</font><font color="#000080">^</font><font color="#800000">1</font><font color="#000080">) = </font>x<font color="#000080">/</font><font color="#800000">2
     </font>x <font color="#FF0000"><b>shl </b></font><font color="#800000">2 </font><font color="#000080">= </font>x<font color="#000080">/(</font><font color="#800000">2</font><font color="#000080">^</font><font color="#800000">2</font><font color="#000080">) = </font>x<font color="#000080">/</font><font color="#800000">4
     </font>x <font color="#FF0000"><b>shl </b></font><font color="#800000">3 </font><font color="#000080">= </font>x<font color="#000080">/(</font><font color="#800000">2</font><font color="#000080">^</font><font color="#800000">3</font><font color="#000080">) = </font>x<font color="#000080">/</font><font color="#800000">8
     </font>x <font color="#FF0000"><b>shl </b></font><font color="#800000">4 </font><font color="#000080">= </font>x<font color="#000080">/(</font><font color="#800000">2</font><font color="#000080">^</font><font color="#800000">4</font><font color="#000080">) = </font>x<font color="#000080">/</font><font color="#800000">16

</font>Just <font color="#FF0000"><b>as</b></font><font color="#000080">:
     </font>x <font color="#FF0000"><b>shr </b></font><font color="#800000">0 </font><font color="#000080">= </font>x
     x <font color="#FF0000"><b>shr </b></font><font color="#800000">1 </font><font color="#000080">= </font>x<font color="#000080">*(</font><font color="#800000">2</font><font color="#000080">^</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">2</font>x
     x <font color="#FF0000"><b>shr </b></font><font color="#800000">2 </font><font color="#000080">= </font>x<font color="#000080">*(</font><font color="#800000">2</font><font color="#000080">^</font><font color="#800000">2</font><font color="#000080">) = </font><font color="#800000">4</font>x
     x <font color="#FF0000"><b>shr </b></font><font color="#800000">3 </font><font color="#000080">= </font>x<font color="#000080">*(</font><font color="#800000">2</font><font color="#000080">^</font><font color="#800000">3</font><font color="#000080">) = </font><font color="#800000">8</font>x
     x <font color="#FF0000"><b>shr </b></font><font color="#800000">4 </font><font color="#000080">= </font>x<font color="#000080">*(</font><font color="#800000">2</font><font color="#000080">^</font><font color="#800000">4</font><font color="#000080">) = </font><font color="#800000">16</font>x

So now you can see how <font color="#FF0000"><b>and </b></font>why the Compiler substitutes a <font color="#000080">&quot;</font><font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">&quot; </font><font color="#FF0000"><b>For </b></font><font color="#000080">&quot;* </font><font color="#800000">2</font><font color="#000080">&quot;.

 &gt; </font>PD<font color="#000080">&gt; </font>So<font color="#000080">, </font><font color="#800000">10 </font><font color="#000080">* </font><font color="#800000">10 </font>would be<font color="#000080">: (</font><font color="#800000">10 </font><font color="#FF0000"><b>shl </b></font><font color="#800000">3</font><font color="#000080">) + </font><font color="#800000">20
 </font><font color="#000080">&gt;
 &gt; </font>MC<font color="#000080">&gt; </font><font color="#FF0000"><b>not </b></font>quite<font color="#000080">:
 &gt; </font>MC<font color="#000080">&gt; (</font><font color="#800000">10 </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">3</font><font color="#000080">)+(</font><font color="#800000">10 </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">1</font><font color="#000080">)</font>s<font color="#000080">, </font>I<font color="#800000">'m back! (3:634/384.6)
 </font><font color="#000080">&gt;
 &gt; </font>Why<font color="#000080">?  </font>wouldn<font color="#800000">'t the second one take an additional instruction (shl)?

</font>Well yes<font color="#000080">, </font>but <font color="#800000">8086 </font>instructions weren<font color="#800000">'t created equal.  PerForming two
</font>shifts <font color="#FF0000"><b>and </b></font>the add <font color="#FF0000"><b>to </b></font>combine them will <font color="#000080">(</font><font color="#FF0000"><b>on </b></font>a <font color="#800000">286 </font><font color="#FF0000"><b>or </b></font>lesser<font color="#000080">) </font>less time
overall than doing even one MUL<font color="#000080">.

</font>The <font color="#800000">386</font><font color="#000080">/</font><font color="#800000">486 </font>has streamlined the MUL instruction so that it takes much less
time<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>can often Compete <font color="#FF0000"><b>With </b></font>the shift<font color="#000080">/</font>add approach<font color="#000080">.  </font>Which <font color="#FF0000"><b>to </b></font>use<font color="#000080">?
</font>Well<font color="#000080">, </font>I<font color="#800000">'d stick With the shift/add approach, since if you'</font>re writing one
<font color="#FF0000"><b>Program For </b></font>both XTs <font color="#FF0000"><b>and </b></font><font color="#800000">386</font>s<font color="#000080">, </font>the XT will be acceptable<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>so will the
<font color="#800000">386.  </font>Using the MUL<font color="#000080">; </font>True<font color="#000080">, </font><font color="#800000">386 </font>perFormance will be better<font color="#000080">, </font>but your XT
perFormance will suffer quite a bit<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p></body>
</html>
