<html>
<head><title> "RANDOM2.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ MR&gt; I have started playing With Borland Turbo Pascal 7.0 and I have a
 MR&gt; problem. The Random routine is not the same as the one in TP 6.0.
 MR&gt; Using the same RandSeed, they generate different series of numbers.
 MR&gt; I have a couple of applications that depend upon the number series
 MR&gt; generated by the TP 6.0 version. Can anyone supply me With the
 MR&gt; algorithm used in the TP 6.0 Random routine? or maybe point me in
 MR&gt; the right direction? I want to Construct my own TP 7 Random routine
 MR&gt; that will behave as the one in TP 6.

The way both generators work is to update System.Randseed, then calculate the
new random value from that one.  There have been several different ways to
calculate the value; I think TP 6 is different from TP 5.5, and TP 7 is
different again.  The update algorithm has been pretty Constant.

As I recall, you can simulate the TP 6 Random(N) Function in TP 7 as follows:
}
</i></font><font color="#FF0000"><b>Function </b></font>TP6Random<font color="#000080">(</font>N<font color="#000080">:</font>Word<font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>junk <font color="#000080">: </font>Word<font color="#000080">;
  </font>myrandseed <font color="#000080">: </font><font color="#FF0000"><b>Record
  </b></font>lo<font color="#000080">, </font>hi <font color="#000080">: </font>Word
  <font color="#FF0000"><b>end Absolute </b></font>system<font color="#000080">.</font>randseed<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>junk <font color="#000080">:= </font>Random<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);   </font><font color="#008000"><i>{ Update Randseed }
  </i></font>TP6Random <font color="#000080">:= </font>myrandseed<font color="#000080">.</font>hi <font color="#FF0000"><b>mod </b></font>N<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
You might want to keep the following around in Case the update algorithm gets
changed sometime in the future:

Demonstration Program to show how the TP 6.0 random number generator
updates System.Randseed.  Allows the seed to be cycled backwards. }

</i></font><font color="#FF0000"><b>Procedure </b></font>CycleRandseed<font color="#000080">(</font>cycles<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#008000"><i>{ For cycles &gt; 0, mimics cycles calls to the TP random number generator.
  For cycles &lt; 0, backs it up the given number of calls. }
</i></font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>cycles <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>cycles <font color="#FF0000"><b>do
      </b></font>system<font color="#000080">.</font>randseed <font color="#000080">:= </font>system<font color="#000080">.</font>randseed<font color="#000080">*</font><font color="#800000">134775813 </font><font color="#000080">+ </font><font color="#800000">1
  </font><font color="#FF0000"><b>else
    For </b></font>i <font color="#000080">:= -</font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font>cycles <font color="#FF0000"><b>do
      </b></font>system<font color="#000080">.</font>randseed <font color="#000080">:= (</font>system<font color="#000080">.</font>randseed<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*(-</font><font color="#800000">649090867</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>randomize<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Forwards:'</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do
    </b></font>Writeln<font color="#000080">(</font>random<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Backwards:'</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do
  begin
    </b></font>CycleRandseed<font color="#000080">(-</font><font color="#800000">1</font><font color="#000080">);    </font><font color="#008000"><i>{ Back to previous value }
    </i></font>Writeln<font color="#000080">(</font>random<font color="#000080">);      </font><font color="#008000"><i>{ Show it }
    </i></font>CycleRandseed<font color="#000080">(-</font><font color="#800000">1</font><font color="#000080">);    </font><font color="#008000"><i>{ Back up over it again }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p></body>
</html>
