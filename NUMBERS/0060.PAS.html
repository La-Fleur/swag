<html>
<head><title> "Binary To Hex File Conversion" by JOHN HOWARD</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0060.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>PROGRAM </b></font>Hex4Bin<font color="#000080">;
</font><font color="#008000"><i>{ Converts hex data file into binary (~64k maximum size) equivalent }
{ 20OCT94 Freeware v2.2  Hex-to-Binary file convertor by John Howard }
{$i DATA4.HEX}
(* layout of DATA4.HEX include file saves 40% compared to Hex_Byte array:
  CONST
       Name = { 'binary' } ;
       { SizeL is equal to FILESIZE(BINARY) DIV 4 }
       HEX_DATA : ARRAY[1..SizeL] OF LONGINT = (
             { i.e. hex data such as $4500A2FF,.. } );
       Size = { FILESIZE(BINARY) MOD 4 } ;
       HEX_PAD : ARRAY[1..Size] OF BYTE = ( { $85,$8E,$05 } );
*)
</i></font><font color="#FF0000"><b>VAR
   </b></font>BINARY <font color="#000080">: </font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
    </b></font>WRITELN<font color="#000080">(</font><font color="#800000">'Howard International, P.O. Box 34633, NKC, MO 64116 USA'</font><font color="#000080">);
    </font>WRITELN<font color="#000080">(</font><font color="#800000">'20OCT94 Freeware v2.2  Hex-to-Binary (~64k maximum)'</font><font color="#000080">);
    </font>ASSIGN<font color="#000080">(</font>BINARY<font color="#000080">,</font><font color="#800000">'binary'</font><font color="#000080">);
    </font>REWRITE<font color="#000080">(</font>BINARY<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font>BLOCKWRITE<font color="#000080">(</font>BINARY<font color="#000080">,</font>HEX_DATA<font color="#000080">,</font>SIZEOF<font color="#000080">(</font>HEX_DATA<font color="#000080">));
    </font><font color="#FF0000"><b>IF </b></font>Size <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      </b></font>BLOCKWRITE<font color="#000080">(</font>BINARY<font color="#000080">,</font>HEX_PAD<font color="#000080">,</font>SIZEOF<font color="#000080">(</font>HEX_PAD<font color="#000080">));
    </font>CLOSE<font color="#000080">(</font>BINARY<font color="#000080">);
    </font>WRITELN<font color="#000080">(</font><font color="#800000">'You may rename BINARY to: '</font><font color="#000080">, </font>Name<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.



</font><font color="#FF0000"><b>PROGRAM </b></font>Bin4Hex<font color="#000080">;
</font><font color="#008000"><i>{ Converts binary file less than ~64k in size into hex data file equivalent }
{ 20OCT94 Freeware v2.2  Binary-to-Hex data convertor by John Howard }
{ Note: This longint approach saves 40% compared to bytes only. }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>HexByte<font color="#000080">(</font>B <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>CONST
  </b></font>HexDigits <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char <font color="#000080">= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Temp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#2</font><font color="#000080">;
  </font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>HexDigits<font color="#000080">[</font>B <font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">];
  </font>Temp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>HexDigits<font color="#000080">[</font>B <font color="#FF0000"><b>AND </b></font><font color="#800000">$F</font><font color="#000080">];
  </font>HexByte <font color="#000080">:= </font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>HexLong<font color="#000080">(</font>L <font color="#000080">: </font>Longint<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>CONST
  </b></font>HexDigits <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char <font color="#000080">= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Temp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#8</font><font color="#000080">;
  </font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>HexDigits<font color="#000080">[(</font>L <font color="#FF0000"><b>SHR </b></font><font color="#800000">28</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F</font><font color="#000080">];
  </font>Temp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>HexDigits<font color="#000080">[(</font>L <font color="#FF0000"><b>SHR </b></font><font color="#800000">24</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F</font><font color="#000080">];
  </font>Temp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>HexDigits<font color="#000080">[(</font>L <font color="#FF0000"><b>SHR </b></font><font color="#800000">20</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F</font><font color="#000080">];
  </font>Temp<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] := </font>HexDigits<font color="#000080">[(</font>L <font color="#FF0000"><b>SHR </b></font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F</font><font color="#000080">];
  </font>Temp<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">] := </font>HexDigits<font color="#000080">[(</font>L <font color="#FF0000"><b>SHR </b></font><font color="#800000">12</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F</font><font color="#000080">];
  </font>Temp<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">] := </font>HexDigits<font color="#000080">[(</font>L <font color="#FF0000"><b>SHR </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F</font><font color="#000080">];
  </font>Temp<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">] := </font>HexDigits<font color="#000080">[(</font>L <font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F</font><font color="#000080">];
  </font>Temp<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">] := </font>HexDigits<font color="#000080">[</font>L <font color="#FF0000"><b>AND </b></font><font color="#800000">$F</font><font color="#000080">];
  </font>HexLong <font color="#000080">:= </font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>Name <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
   </font>BINARY <font color="#000080">: </font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;
   </font>HEXFILE <font color="#000080">: </font>TEXT<font color="#000080">;
   </font>Hex_Byte <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>Hex_Long <font color="#000080">: </font>LONGINT<font color="#000080">;
   </font>Size <font color="#000080">: </font>LONGINT<font color="#000080">;
   </font>i <font color="#000080">: </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'/?' </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>WRITELN<font color="#000080">(</font><font color="#800000">'Howard International, P.O. Box 34633, NKC, MO 64116 USA'</font><font color="#000080">);
      </font>WRITELN<font color="#000080">(</font><font color="#800000">'20OCT94 Freeware v2.2  Binary-to-Hex data convertor'</font><font color="#000080">);
      </font>WRITELN<font color="#000080">(</font><font color="#800000">'Syntax:  bin4hex.exe  [filename]'</font><font color="#000080">);
      </font>WRITELN<font color="#000080">(</font><font color="#800000">'Filename is optional, the default is called BINARY'</font><font color="#000080">);
      </font>Halt<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>ParamCount <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
       </b></font>Name <font color="#000080">:= </font><font color="#800000">'binary'
    </font><font color="#FF0000"><b>ELSE
       </b></font>Name <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font>WRITELN<font color="#000080">(</font><font color="#800000">'Looking for file called: '</font><font color="#000080">, </font>Name<font color="#000080">);
    </font>ASSIGN<font color="#000080">(</font>BINARY<font color="#000080">,</font>Name<font color="#000080">);
    </font>FileMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;    </font><font color="#008000"><i>{ Read Only }
    {$I-}   </i></font>RESET<font color="#000080">(</font>BINARY<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);  </font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>IF </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>WRITELN<font color="#000080">(</font><font color="#800000">'File not found.  Try the /? parameter.'</font><font color="#000080">); </font>Halt<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>ASSIGN<font color="#000080">(</font>HEXFILE<font color="#000080">,</font><font color="#800000">'DATA4.HEX'</font><font color="#000080">);
    </font>REWRITE<font color="#000080">(</font>HEXFILE<font color="#000080">);
    </font>Size <font color="#000080">:= </font>FILESIZE<font color="#000080">(</font>BINARY<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">4</font><font color="#000080">;
    </font>WRITELN<font color="#000080">(</font>HEXFILE<font color="#000080">, </font><font color="#800000">'CONST Name = '''</font><font color="#000080">, </font>Name<font color="#000080">,</font><font color="#800000">''';'</font><font color="#000080">);
    </font>WRITELN<font color="#000080">(</font>HEXFILE<font color="#000080">, </font><font color="#800000">'      HEX_DATA : ARRAY[1..'</font><font color="#000080">, </font>Size<font color="#000080">,</font><font color="#800000">'] OF LONGINT = ('</font><font color="#000080">);
    </font>BLOCKREAD<font color="#000080">(</font>BINARY<font color="#000080">,</font>Hex_Long<font color="#000080">,</font>SIZEOF<font color="#000080">(</font>Hex_Long<font color="#000080">));
    </font>WRITE<font color="#000080">(</font>HEXFILE<font color="#000080">, </font><font color="#800000">' $'</font><font color="#000080">);
    </font>WRITE<font color="#000080">(</font>HEXFILE<font color="#000080">,</font>HEXLONG<font color="#000080">(</font>Hex_Long<font color="#000080">));
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>TO </b></font>Size <font color="#FF0000"><b>DO
      BEGIN
        </b></font>BLOCKREAD<font color="#000080">(</font>BINARY<font color="#000080">,</font>Hex_Long<font color="#000080">,</font>SIZEOF<font color="#000080">(</font>Hex_Long<font color="#000080">));
        </font>WRITE<font color="#000080">(</font>HEXFILE<font color="#000080">, </font><font color="#800000">',$'</font><font color="#000080">);
        </font>WRITE<font color="#000080">(</font>HEXFILE<font color="#000080">,</font>HEXLONG<font color="#000080">(</font>Hex_Long<font color="#000080">));
        </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>i <font color="#FF0000"><b>MOD </b></font><font color="#800000">7 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>WRITELN<font color="#000080">(</font>HEXFILE<font color="#000080">);   </font><font color="#008000"><i>{ columns }
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>WRITELN<font color="#000080">(</font>HEXFILE<font color="#000080">, </font><font color="#800000">');'</font><font color="#000080">);
    </font>Size <font color="#000080">:= </font>FILESIZE<font color="#000080">(</font>BINARY<font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">4</font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>Size <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      BEGIN
         </b></font>WRITELN<font color="#000080">(</font>HEXFILE<font color="#000080">, </font><font color="#800000">'     Size = '</font><font color="#000080">, </font>Size<font color="#000080">,</font><font color="#800000">';'</font><font color="#000080">);
         </font>WRITE  <font color="#000080">(</font>HEXFILE<font color="#000080">, </font><font color="#800000">'     HEX_PAD : ARRAY[1..'</font><font color="#000080">, </font>Size<font color="#000080">,</font><font color="#800000">'] OF BYTE = ($'</font><font color="#000080">);
         </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Size <font color="#FF0000"><b>DO
           BEGIN
             </b></font>BLOCKREAD<font color="#000080">(</font>BINARY<font color="#000080">,</font>Hex_Byte<font color="#000080">,</font>SIZEOF<font color="#000080">(</font>Hex_Byte<font color="#000080">));
             </font><font color="#FF0000"><b>IF </b></font>i <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN </b></font>WRITE<font color="#000080">(</font>HEXFILE<font color="#000080">, </font><font color="#800000">',$'</font><font color="#000080">);
             </font>WRITE<font color="#000080">(</font>HEXFILE<font color="#000080">,</font>HEXBYTE<font color="#000080">(</font>Hex_Byte<font color="#000080">));
           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font>WRITELN<font color="#000080">(</font>HEXFILE<font color="#000080">, </font><font color="#800000">');'</font><font color="#000080">);
      </font><font color="#FF0000"><b>END
    ELSE
      BEGIN
         </b></font>WRITELN<font color="#000080">(</font>HEXFILE<font color="#000080">, </font><font color="#800000">'     Size = 0;'</font><font color="#000080">);
         </font>WRITELN<font color="#000080">(</font>HEXFILE<font color="#000080">, </font><font color="#800000">'     HEX_PAD : ARRAY[1..1] OF BYTE = (0);'</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>CLOSE<font color="#000080">(</font>HEXFILE<font color="#000080">);
    </font>CLOSE<font color="#000080">(</font>BINARY<font color="#000080">);
    </font>WRITELN<font color="#000080">(</font><font color="#800000">'Your BINARY was converted to DATA4.HEX include file.'</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0060.PAS">Original</a><b>]</b></p></body>
</html>
