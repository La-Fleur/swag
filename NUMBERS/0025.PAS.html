<html>
<head><title> "Handling Numbers in ASM" by SEAN PALMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0025.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ SEAN PALMER

I've been playing around with the AAM instruction and came up with some
things you guys might find useful...

Strings as function results are WIERD with the inline Assembler. 8)
}

</i></font><font color="#FF0000"><b>function </b></font>div10<font color="#000080">(</font>b <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov al, b
  aam
  mov al, ah
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>mod10<font color="#000080">(</font>b <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov al, b
  aam
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>str2 <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font>str8 <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];

</font><font color="#FF0000"><b>function </b></font>toStr2<font color="#000080">(</font>b <font color="#000080">: </font>byte<font color="#000080">) : </font>str2<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm </b></font><font color="#008000"><i>{only call with b=0~99}
  </i></font><font color="#FF00FF">les  di, @RESULT
  cld
  mov  al, 2
  stosb
  mov  al, b
  aam
  xchg ah, al
  add  ax, $3030
  stosw
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{makes date string in MM/DD/YY format from m,d,y}
</i></font><font color="#FF0000"><b>function </b></font>toDateStr<font color="#000080">(</font>m<font color="#000080">,</font>d<font color="#000080">,</font>y<font color="#000080">:</font>byte<font color="#000080">):</font>str8<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;</font><font color="#FF0000"><b>asm </b></font><font color="#008000"><i>{only call with m,d,y=0~99}
  </i></font><font color="#FF00FF">les  di, @RESULT
  cld
  mov  al, 8
  stosb
  mov  al, m
  aam
  xchg ah, al
  add  ax, $3030
  stosw
  mov  al, '/'
  stosb
  mov  al, d
  aam
  xchg ah, al
  add  ax, $3030
  stosw
  mov  al, '/'
  stosb
  mov  al, y
  aam
  xchg ah, al
  add  ax, $3030
  stosw
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NUMBERS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0025.PAS">Original</a><b>]</b></p></body>
</html>
