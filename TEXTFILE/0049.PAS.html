<html>
<head><title> "Generalized Text handling" by RICK HAINES</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{

The fastest way to read screen characters is to get them from video
memory directly.  It's located at either Segment B800h (Color) or
Segment B000h (Monochrome).  Each character is stored as two bytes, the
Ascii code and an Attribute byte.  Here is some source if you are
confused.

{ ********************************************************** }
{ *********************** Text Unit ************************ }
{ ********************************************************** }
{ **************** Written by: Rick Haines ***************** }
{ **************************** 507 LakeShore Dr. *********** }
{ **************************** Eustis FL, 32726 ************ }
{ ********************************************************** }
{ ***************** Last Revised 11/12/94 ****************** }
{ ********************************************************** }

</i></font><font color="#FF0000"><b>Unit </b></font>Text<font color="#000080">;

</font><font color="#008000"><i>{ ************************* Attribute Byte ************************* }
{ ****************************************************************** }
{ ************** Bits 0-3 contain the foreground color ************* }
{ ************** Bits 4-6 contain the background color ************* }
{ ******************** Bit 7 is the blink bit ********************** }
{ ****************************************************************** }

</i></font><font color="#FF0000"><b>Interface

 Const
  </b></font>Black  <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>Blue   <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>Green  <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>Cyan   <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
  </font>Red    <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
  </font>Violet <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;
  </font>Orange <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;
  </font>Gray   <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;

  </font>LightGray   <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
  </font>LightBlue   <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">;
  </font>LightGreen  <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;
  </font>LightCyan   <font color="#000080">= </font><font color="#800000">11</font><font color="#000080">;
  </font>LightRed    <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">;
  </font>LightViolet <font color="#000080">= </font><font color="#800000">13</font><font color="#000080">;

  </font>Yellow <font color="#000080">= </font><font color="#800000">14</font><font color="#000080">;
  </font>White  <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;

  </font>Blink   <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">;

 </font><font color="#FF0000"><b>Procedure </b></font>WriteXY<font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>Byte<font color="#000080">; </font>TextStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>Procedure </b></font>SetColor<font color="#000080">(</font>Color <font color="#000080">: </font>Byte<font color="#000080">);
 </font><font color="#FF0000"><b>Procedure </b></font>SetBGColor<font color="#000080">(</font>Color <font color="#000080">: </font>Byte<font color="#000080">);
 </font><font color="#FF0000"><b>Procedure </b></font>SaveScreen<font color="#000080">(</font>Name <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>Procedure </b></font>LoadScreen<font color="#000080">(</font>Name <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Implementation
 Uses </b></font>Crt<font color="#000080">;

 </font><font color="#FF0000"><b>Type
  </b></font>RefreshBuffer <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">79</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Word<font color="#000080">;

 </font><font color="#FF0000"><b>Var
  </b></font>TextMem   <font color="#000080">: ^</font>RefreshBuffer<font color="#000080">;
  </font>TextColor <font color="#000080">: </font>Byte<font color="#000080">;

 </font><font color="#FF0000"><b>Procedure </b></font>SetColor<font color="#000080">(</font>Color <font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>Begin
   </b></font>TextColor <font color="#000080">:= </font>TextColor <font color="#FF0000"><b>Or </b></font>Color<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Procedure </b></font>SetBGColor<font color="#000080">(</font>Color <font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>Begin
   If </b></font>Color <font color="#000080">&gt; </font><font color="#800000">8 </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>Asm
     </b></font><font color="#FF00FF">Mov AL, [Color]
     Mov BL, [TextColor]
     RoR BL, 4
     Or  BL, AL
     RoL BL, 4
     Mov [TextColor], BL
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Function </b></font>TextChar<font color="#000080">(</font>Ch <font color="#000080">: </font>Char<font color="#000080">) : </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">Mov AH, TextColor
   Mov AL, Ch
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Procedure </b></font>WriteXY<font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>Byte<font color="#000080">; </font>TextStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>Var
   </b></font>I <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
   For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Length<font color="#000080">(</font>TextStr<font color="#000080">) </font><font color="#FF0000"><b>Do </b></font>TextMem<font color="#000080">^[</font>Y<font color="#000080">,</font>X<font color="#000080">+</font>I<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] := </font>TextChar<font color="#000080">(</font>TextStr<font color="#000080">[</font>I<font color="#000080">]);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Procedure </b></font>SaveScreen<font color="#000080">(</font>Name <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>Var
   </b></font>FileN <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Begin
   </b></font>Assign<font color="#000080">(</font>FileN<font color="#000080">, </font>Name <font color="#000080">+ </font><font color="#800000">'.Scr'</font><font color="#000080">);
   </font>Rewrite<font color="#000080">(</font>FileN<font color="#000080">, </font><font color="#800000">2000</font><font color="#000080">);
   </font>BlockWrite<font color="#000080">(</font>FileN<font color="#000080">, </font>TextMem<font color="#000080">^, </font><font color="#800000">2</font><font color="#000080">);
   </font>Close<font color="#000080">(</font>FileN<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Procedure </b></font>LoadScreen<font color="#000080">(</font>Name <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>Var
   </b></font>FileN <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Begin
   </b></font>Assign<font color="#000080">(</font>FileN<font color="#000080">, </font>Name <font color="#000080">+ </font><font color="#800000">'.Scr'</font><font color="#000080">);
   </font>Reset<font color="#000080">(</font>FileN<font color="#000080">, </font><font color="#800000">2000</font><font color="#000080">);
   </font>BlockRead<font color="#000080">(</font>FileN<font color="#000080">, </font>TextMem<font color="#000080">^, </font><font color="#800000">2</font><font color="#000080">);
   </font>Close<font color="#000080">(</font>FileN<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
 If </b></font>LastMode <font color="#000080">= </font>Mono <font color="#FF0000"><b>Then </b></font>TextMem <font color="#000080">:= </font>Ptr<font color="#000080">(</font><font color="#800000">$B000</font><font color="#000080">,</font><font color="#800000">$0000</font><font color="#000080">) </font><font color="#FF0000"><b>Else </b></font>TextMem <font color="#000080">:= </font>Ptr<font color="#000080">(</font><font color="#800000">$B800</font><font color="#000080">,
 </font>SetBGColor<font color="#000080">(</font>Black<font color="#000080">);
 </font>SetColor<font color="#000080">(</font>LightGray<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.


                                                </font>Good Luck<font color="#000080">,

                                                -</font>Rick


 <font color="#000080">* </font>OLX <font color="#800000">2.1 </font>TD <font color="#000080">* </font><font color="#FF0000"><b>With Pascal Do </b></font>Write<font color="#000080">(</font><font color="#FF0000"><b>Program</b></font><font color="#000080">);


--- </font>QScan v1<font color="#000080">.</font><font color="#800000">12</font>b <font color="#000080">/ </font><font color="#800000">01</font><font color="#000080">-</font><font color="#800000">0240
 </font><font color="#000080">* </font>Origin<font color="#000080">: </font>Craig<font color="#800000">'s DATA Exchange! BBS 1:3669/50 904-483-2463 (1:3669/50)
</font>SEEN<font color="#000080">-</font>BY<font color="#000080">: </font><font color="#800000">363</font><font color="#000080">/</font><font color="#800000">3 34 118 157 603 1571 396</font><font color="#000080">/</font><font color="#800000">1 3615</font><font color="#000080">/</font><font color="#800000">50 51 3633</font><font color="#000080">/</font><font color="#800000">132
</font>SEEN<font color="#000080">-</font>BY<font color="#000080">: </font><font color="#800000">3669</font><font color="#000080">/</font><font color="#800000">18 50 54
</font>PATH<font color="#000080">: </font><font color="#800000">3669</font><font color="#000080">/</font><font color="#800000">50 54 363</font><font color="#000080">/</font><font color="#800000">157 3615</font><font color="#000080">/</font><font color="#800000">50
</font>              
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p></body>
</html>
