<html>
<head><title> "SCROLLER.PAS" by ERIC MILLER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
ERIC MILLER
read a Text File and scroll
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>MaxLine   <font color="#000080">= </font><font color="#800000">200</font><font color="#000080">;
  </font>MaxLength <font color="#000080">= </font><font color="#800000">80</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Lines       <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxLine<font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font>MaxLength<font color="#000080">];
  </font>OldLine<font color="#000080">,
  </font>L<font color="#000080">,
  </font>CurrentLine<font color="#000080">,
  </font>NumLines    <font color="#000080">: </font>Word<font color="#000080">;
  </font>TextFile    <font color="#000080">: </font>Text<font color="#000080">;
  </font>Key         <font color="#000080">: </font>Char<font color="#000080">;
  </font>Redraw<font color="#000080">,
  </font>Done        <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font>Assign<font color="#000080">(</font>TextFile<font color="#000080">, </font><font color="#800000">'MCGALIB.PAS'</font><font color="#000080">);
  </font>Reset<font color="#000080">(</font>TextFile<font color="#000080">);
  </font>NumLines <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>While not </b></font>EOF<font color="#000080">(</font>TextFile<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>NumLines <font color="#000080">&lt; </font>MaxLine<font color="#000080">) </font><font color="#FF0000"><b>DO
  begin
    </b></font>Inc<font color="#000080">(</font>NumLines<font color="#000080">);
    </font>Readln<font color="#000080">(</font>TextFile<font color="#000080">, </font>Lines<font color="#000080">[</font>NumLines<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Close<font color="#000080">(</font>TextFile<font color="#000080">);

</font><font color="#008000"><i>{
 Well...that handles getting the File into memory...but
 to scroll through using Up/Down &amp; PgUp PgDn is a lot harder,
 but not incredibly difficult.
}
  </i></font>Done <font color="#000080">:= </font>False<font color="#000080">;
  </font>Redraw <font color="#000080">:= </font>True<font color="#000080">;
  </font>CurrentLine <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>While not </b></font>Done <font color="#FF0000"><b>DO
  begin
    if </b></font>Redraw <font color="#FF0000"><b>then
    begin
      </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>L <font color="#000080">:= </font>CurrentLine <font color="#FF0000"><b>to </b></font>CurrentLine <font color="#000080">+ </font><font color="#800000">22 </font><font color="#FF0000"><b>DO
          </b></font>Write<font color="#000080">(</font>Lines<font color="#000080">[</font>L<font color="#000080">], </font><font color="#800000">' '</font><font color="#000080">:(</font><font color="#800000">80</font><font color="#000080">-</font>Length<font color="#000080">(</font>Lines<font color="#000080">[</font>L<font color="#000080">])));
      </font>Redraw <font color="#000080">:= </font>False<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Key <font color="#000080">:= </font>ReadKey<font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>Key <font color="#FF0000"><b>of
      </b></font><font color="#800000">#0</font><font color="#000080">:
        </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ cursor/page keys }
          </i></font>OldLine <font color="#000080">:= </font>CurrentLine<font color="#000080">;
          </font>Key <font color="#000080">:= </font>ReadKey<font color="#000080">;

          </font><font color="#FF0000"><b>Case </b></font>Key <font color="#FF0000"><b>of
            </b></font><font color="#800000">#72</font><font color="#000080">: </font><font color="#008000"><i>{ up  }
              </i></font><font color="#FF0000"><b>if </b></font>CurrentLine <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
                </b></font>Dec<font color="#000080">(</font>CurrentLine<font color="#000080">);
            </font><font color="#800000">#80</font><font color="#000080">: </font><font color="#008000"><i>{ down  }
              </i></font><font color="#FF0000"><b>if </b></font>CurrentLine <font color="#000080">&lt; (</font>NumLines<font color="#000080">-</font><font color="#800000">22</font><font color="#000080">) </font><font color="#FF0000"><b>then
                </b></font>Inc<font color="#000080">(</font>CurrentLine<font color="#000080">);
            </font><font color="#800000">#73</font><font color="#000080">: </font><font color="#008000"><i>{ page up  }
              </i></font><font color="#FF0000"><b>if </b></font>CurrentLine <font color="#000080">&gt; </font><font color="#800000">23 </font><font color="#FF0000"><b>then
                </b></font>Dec<font color="#000080">(</font>CurrentLine<font color="#000080">, </font><font color="#800000">23</font><font color="#000080">)
              </font><font color="#FF0000"><b>else
                </b></font>CurrentLine <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
            </font><font color="#800000">#81</font><font color="#000080">: </font><font color="#008000"><i>{ page down }
               </i></font><font color="#FF0000"><b>if </b></font>CurrentLine <font color="#000080">&lt; (</font>NumLines<font color="#000080">-</font><font color="#800000">44</font><font color="#000080">) </font><font color="#FF0000"><b>then
                 </b></font>Inc<font color="#000080">(</font>CurrentLine<font color="#000080">, </font><font color="#800000">23</font><font color="#000080">)
               </font><font color="#FF0000"><b>else
                 </b></font>CurrentLine <font color="#000080">:= </font>NumLines<font color="#000080">-</font><font color="#800000">22</font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

          </font><font color="#FF0000"><b>if </b></font>CurrentLine <font color="#000080">&lt;&gt; </font>OldLine <font color="#FF0000"><b>then
            </b></font>Redraw <font color="#000080">:= </font>True<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">#27</font><font color="#000080">: </font>Done <font color="#000080">:= </font>True<font color="#000080">;

    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Case}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{begin}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">. </font><font color="#008000"><i>{Program}

{
That should work For scrolling through the lines. Sorry
'bout not commenting the code alot; it is almost self-explanatory
though.  But it works!  You could optimize it For larger Files
by using an Array of Pointers to Strings.  But enough For now.
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
