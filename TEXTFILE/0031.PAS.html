<html>
<head><title> "Parse file by words" by MIKE CHAMBERS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>program </b></font>ReadWord<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">,</font>crt<font color="#000080">;
</font><font color="#FF0000"><b>Const
  </b></font>delimiters <font color="#000080">= </font><font color="#800000">' ,./?;:&quot;[]{}!'</font><font color="#000080">;
  </font>CrLf       <font color="#000080">= </font><font color="#800000">#13#10</font><font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>tfilename <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>word_type <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>wp_type   <font color="#000080">= ^</font>word_type<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>i          <font color="#000080">: </font>word<font color="#000080">;
  </font>filter     <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>sr         <font color="#000080">: </font>searchrec<font color="#000080">;
  </font>path       <font color="#000080">: </font>pathstr<font color="#000080">;
  </font>dir        <font color="#000080">: </font>dirstr<font color="#000080">;
  </font>fname      <font color="#000080">: </font>namestr<font color="#000080">;
  </font>ext        <font color="#000080">: </font>extstr<font color="#000080">;
  </font>Lines       <font color="#000080">: </font>word<font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>ShowSyntax<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'USAGE       OBJDIC     &lt;input fileset&gt;                         '</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'                                                               '</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'       &lt;input fileset&gt; is a DOS filename (wildcards allowed)   '</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'                                                               '</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'                                                               '</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Example    OBJDIC *.TXT                                        '</font><font color="#000080">);
  </font>halt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>GetNextWord <font color="#000080">(</font>buf<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>apos<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>aword<font color="#000080">:</font>word_type<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>delim<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>ch<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>i <font color="#000080">:= </font>apos<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>length<font color="#000080">(</font>buf<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>pos<font color="#000080">(</font>buf<font color="#000080">[</font>i<font color="#000080">],</font>delimiters<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do </b></font>inc <font color="#000080">(</font>i<font color="#000080">);
  </font>aword <font color="#000080">:= </font>copy<font color="#000080">(</font>buf<font color="#000080">,</font>apos<font color="#000080">, </font>i <font color="#000080">- </font>apos<font color="#000080">);
  </font>j<font color="#000080">:= </font>i<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>length<font color="#000080">(</font>buf<font color="#000080">)) </font><font color="#FF0000"><b>and
       </b></font><font color="#000080">( ( (</font>upcase<font color="#000080">(</font>buf<font color="#000080">[</font>i<font color="#000080">]) &lt; </font><font color="#800000">'A'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>upcase<font color="#000080">(</font>buf<font color="#000080">[</font>i<font color="#000080">]) &gt; </font><font color="#800000">'Z'</font><font color="#000080">) ) </font><font color="#FF0000"><b>and
         </b></font><font color="#000080">( (</font>buf<font color="#000080">[</font>i<font color="#000080">] &lt;  </font><font color="#800000">'0'       </font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>buf<font color="#000080">[</font>i<font color="#000080">] &gt; </font><font color="#800000">'9'        </font><font color="#000080">) ) )
        </font><font color="#FF0000"><b>do </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
  </font>delim <font color="#000080">:= </font>copy<font color="#000080">(</font>buf<font color="#000080">,</font>j<font color="#000080">,</font>i<font color="#000080">-</font>j<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>i <font color="#000080">= </font>length<font color="#000080">(</font>buf<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>i <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>GetNextWord <font color="#000080">:=</font>i<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>procedure </b></font>scanfile<font color="#000080">(</font>filename <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>infile <font color="#000080">: </font>text<font color="#000080">;
  </font>inbuf  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>aword  <font color="#000080">: </font>word_type<font color="#000080">;
  </font>adelim <font color="#000080">: </font>word_type<font color="#000080">;
  </font>len    <font color="#000080">: </font>byte<font color="#000080">;
  </font>inpos  <font color="#000080">: </font>byte<font color="#000080">;
  </font>index  <font color="#000080">: </font>word<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>path <font color="#000080">:= </font>fexpand<font color="#000080">(</font>filename<font color="#000080">);
  </font>fsplit<font color="#000080">(</font>path<font color="#000080">,</font>dir<font color="#000080">,</font>fname<font color="#000080">,</font>ext<font color="#000080">);
  </font>assign<font color="#000080">(</font>infile<font color="#000080">,</font>path<font color="#000080">);
  </font>reset<font color="#000080">(</font>infile<font color="#000080">);
  </font>clrscr<font color="#000080">;
  </font>lines<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'Scanning '</font><font color="#000080">,</font>filename<font color="#000080">);
  </font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>infile<font color="#000080">) </font><font color="#FF0000"><b>do begin
     </b></font>readln<font color="#000080">(</font>infile<font color="#000080">,</font>inbuf<font color="#000080">); </font>inc<font color="#000080">(</font>lines<font color="#000080">);
     </font>inpos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>inpos <font color="#000080">&lt; </font>length<font color="#000080">(</font>inbuf<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>inpos <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
       </b></font>inpos <font color="#000080">:= </font>GetNextWord<font color="#000080">(</font>inbuf<font color="#000080">,</font>inpos<font color="#000080">,</font>aword<font color="#000080">,</font>adelim<font color="#000080">);
       </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>aword<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font>aword<font color="#000080">);
       </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>adelim<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font>adelim<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>writeln<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>close<font color="#000080">(</font>infile<font color="#000080">);
   </font>writeln<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>begin
   </b></font>filter <font color="#000080">:= </font>Paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
   </font>FindFirst<font color="#000080">(</font>Filter<font color="#000080">,</font>AnyFile<font color="#000080">,</font>sr<font color="#000080">);
   </font><font color="#FF0000"><b>while </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do with </b></font>sr <font color="#FF0000"><b>do begin
      </b></font>scanfile<font color="#000080">(</font>fexpand<font color="#000080">(</font>name<font color="#000080">));
      </font>FindNext<font color="#000080">(</font>sr<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p></body>
</html>
