<html>
<head><title> "Text File Parser" by STEVEN KERR</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{&Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;}
{&ordm; TEMPLATE - Text File Parser                                       &ordm;}
{&ordm;   Steven Kerr, 1994                                               &ordm;}
{&ordm;                                                                   &ordm;}
{&ordm; Syntax : TEMPLATE Input Output                                    &ordm;}
{&ordm;                                                                   &ordm;}
{&ordm;   Where Input  = Input File                                       &ordm;}
{&ordm;         Output = Output File                                      &ordm;}
{&Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;}
{$M 8192, 0, 0}
</i></font><font color="#FF0000"><b>Program </b></font>Template<font color="#000080">;
</font><font color="#FF0000"><b>Uses </b></font>DOS<font color="#000080">;
</font><font color="#FF0000"><b>Const
  </b></font>Null         <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;
  </font>LeftControl  <font color="#000080">: </font>Char   <font color="#000080">= </font><font color="#800000">'&lt;'</font><font color="#000080">; </font><font color="#008000"><i>{ Left hand control character  }
  </i></font>RightControl <font color="#000080">: </font>Char   <font color="#000080">= </font><font color="#800000">'&gt;'</font><font color="#000080">; </font><font color="#008000"><i>{ Right hand control character }
</i></font><font color="#FF0000"><b>Var
  </b></font>InputFile<font color="#000080">, </font>OutputFile <font color="#000080">: </font>Text<font color="#000080">;
  </font>Checked<font color="#000080">, </font>Error        <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Upper <font color="#000080">(</font>Parameter <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Parameter<font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>Parameter<font color="#000080">[</font>I<font color="#000080">] := </font>UpCase<font color="#000080">(</font>Parameter<font color="#000080">[</font>I<font color="#000080">]);
  </font>Upper <font color="#000080">:= </font>Parameter
<font color="#FF0000"><b>end </b></font><font color="#008000"><i>{Function Upper}</i></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>File_Exists <font color="#000080">(</font>Filename <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Attr <font color="#000080">: </font>Word<font color="#000080">;
  </font>F    <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>F<font color="#000080">, </font>Filename<font color="#000080">);
  </font>GetFAttr<font color="#000080">(</font>F<font color="#000080">, </font>Attr<font color="#000080">);
  </font>File_Exists <font color="#000080">:= (</font>DOSError <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)
</font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ Function FileExists }</i></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Display_Error <font color="#000080">(</font><font color="#FF0000"><b>Message </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Filename <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'TEMPLATE - Text File Parser'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'  Steven Kerr, 1994'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Syntax : TEMPLATE Input Output'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'  Where Input  = Input File'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'        Output = Output File'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Error : '</font><font color="#000080">, </font><font color="#FF0000"><b>Message</b></font><font color="#000080">, </font>Filename<font color="#000080">)
</font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ Procedure Display_Help }</i></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Check_Variable <font color="#000080">(</font>Variable <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Position <font color="#000080">: </font>Byte<font color="#000080">) : </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Valid <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Valid <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#008000"><i>{ Add in addition variables as below. If Valid = False, the variable }
  { is ignored and written &quot;as is&quot;.                                    }
  </i></font><font color="#FF0000"><b>if </b></font>Upper<font color="#000080">(</font>Variable<font color="#000080">) = </font>LeftControl <font color="#000080">+ </font><font color="#800000">'DISKFREEC' </font><font color="#000080">+ </font>RightControl <font color="#FF0000"><b>then begin
    </b></font>Valid <font color="#000080">:= </font>True<font color="#000080">;
    </font>Write<font color="#000080">(</font>OutputFile<font color="#000080">, </font>DiskFree<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">))
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ DiskFreeC }</i></font><font color="#000080">;
  </font><font color="#008000"><i>{}
  </i></font>Checked <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Valid <font color="#FF0000"><b>then
    </b></font>Check_Variable <font color="#000080">:= </font>Position <font color="#000080">+ </font>Length<font color="#000080">(</font>Variable<font color="#000080">) - </font><font color="#800000">1
  </font><font color="#FF0000"><b>else
    </b></font>Check_Variable <font color="#000080">:= </font>Position <font color="#000080">- </font><font color="#800000">1
</font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ Function Check_Variable }</i></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Look_Ahead <font color="#000080">(</font>Line <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Position <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Variable <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Variable <font color="#000080">:= </font>Line<font color="#000080">[</font>Position<font color="#000080">];
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>Line<font color="#000080">) &lt;&gt; </font>Position<font color="#000080">) </font><font color="#FF0000"><b>and
        </b></font><font color="#000080">(</font>Line<font color="#000080">[</font>Position<font color="#000080">] &lt;&gt; </font>RightControl<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>Inc<font color="#000080">(</font>Position<font color="#000080">);
    </font>Variable <font color="#000080">:= </font>Variable <font color="#000080">+ </font>Line<font color="#000080">[</font>Position<font color="#000080">]
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ While }</i></font><font color="#000080">;
  </font>Look_Ahead <font color="#000080">:= </font>Variable
<font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ Function Look_Ahead }</i></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Parse_File<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Line     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>Position <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Position <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Checked <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>EOF<font color="#000080">(</font>InputFile<font color="#000080">)) </font><font color="#FF0000"><b>do begin
    </b></font>Readln<font color="#000080">(</font>InputFile<font color="#000080">, </font>Line<font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font>Position <font color="#000080">&lt; </font>Length<font color="#000080">(</font>Line<font color="#000080">) </font><font color="#FF0000"><b>do begin
        </b></font>Inc<font color="#000080">(</font>Position<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Line<font color="#000080">[</font>Position<font color="#000080">] = </font>LeftControl<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>Checked<font color="#000080">) </font><font color="#FF0000"><b>then begin
          </b></font>Position <font color="#000080">:= </font>Check_Variable<font color="#000080">(</font>Look_Ahead<font color="#000080">(</font>Line<font color="#000080">, </font>Position<font color="#000080">), </font>Position<font color="#000080">)
        </font><font color="#FF0000"><b>end else begin
          </b></font>Write<font color="#000080">(</font>OutputFile<font color="#000080">, </font>Line<font color="#000080">[</font>Position<font color="#000080">]);
          </font>Checked <font color="#000080">:= </font>False
        <font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if }
      </i></font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ While }</i></font><font color="#000080">;
      </font>Position <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>Checked <font color="#000080">:= </font>False<font color="#000080">;
      </font>Writeln<font color="#000080">(</font>OutputFile<font color="#000080">)
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ While }
</i></font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ Procedure Parse_File }</i></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Files_Opened <font color="#000080">(</font>InputF <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>OutputF <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Error <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Error <font color="#000080">:= </font>False<font color="#000080">;
  </font>Assign<font color="#000080">(</font>InputFile<font color="#000080">, </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
  </font>Assign<font color="#000080">(</font>OutputFile<font color="#000080">, </font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">));
  </font><font color="#008000"><i>{$I-} </i></font>ReWrite<font color="#000080">(</font>OutputFile<font color="#000080">); </font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
    </b></font>Display_Error<font color="#000080">(</font><font color="#800000">'Unable to write to '</font><font color="#000080">, </font>Upper<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)));
    </font>Error <font color="#000080">:= </font>True
  <font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if IOResult }</i></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>Error<font color="#000080">) </font><font color="#FF0000"><b>then begin
    </b></font><font color="#008000"><i>{$I-} </i></font>Reset<font color="#000080">(</font>InputFile<font color="#000080">); </font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>Display_Error<font color="#000080">(</font><font color="#800000">'Unable to read from '</font><font color="#000080">, </font>Upper<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)));
      </font>Error <font color="#000080">:= </font>True
    <font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if IOResult }
  </i></font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if }</i></font><font color="#000080">;
  </font>Files_Opened <font color="#000080">:= (</font><font color="#FF0000"><b>not </b></font>Error<font color="#000080">)
</font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ Function Files_Opened }</i></font><font color="#000080">;

</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ Program Template }
  </i></font><font color="#FF0000"><b>if </b></font>ParamCount <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>then begin
    if </b></font>File_Exists<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then begin
      if </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>File_Exists<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">))) </font><font color="#FF0000"><b>then begin
        if </b></font>Files_Opened<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">), </font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)) </font><font color="#FF0000"><b>then begin
          </b></font>Parse_File<font color="#000080">;
          </font>Close<font color="#000080">(</font>InputFile<font color="#000080">);
          </font>Close<font color="#000080">(</font>OutputFile<font color="#000080">)
        </font><font color="#FF0000"><b>end
      end else
        </b></font>Display_Error<font color="#000080">(</font><font color="#800000">'Output file already exists'</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">)
    </font><font color="#FF0000"><b>end else
      </b></font>Display_Error<font color="#000080">(</font><font color="#800000">'Input file not found'</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">)
  </font><font color="#FF0000"><b>end else
      </b></font>Display_Error<font color="#000080">(</font><font color="#800000">'Invalid number of parameters'</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">)
</font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ Program Template }</i></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p></body>
</html>
