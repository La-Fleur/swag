<html>
<head><title> "Delete Dups from text file" by EDDY THILLEMAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0063.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$A+,B-,D-,E-,F-,G-,I-,L-,N-,O-,P-,Q-,R-,S-,T-,V-,X-,Y-}
</i></font><font color="#FF0000"><b>Program </b></font>Dup<font color="#000080">;
   </font><font color="#008000"><i>{ delete duplicate lines from a sorted text file }
   { Dup file1 file2 }

(* Author: Eddy Thilleman
   Donated to the public domain *)

(* {$DEFINE NoPlus} *)
(* uncomment the above line if you want to remove lines terminated
   by '+' characters *)

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>string3 <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
</font><font color="#FF0000"><b>Const
  </b></font>WhiteSpace <font color="#000080">: </font>string3 <font color="#000080">= </font><font color="#800000">#00#09#255</font><font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>NoFAttr <font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">$1C</font><font color="#000080">; </font><font color="#008000"><i>{ attributen dir, volume, system }
  </i></font>FAttr   <font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">$23</font><font color="#000080">; </font><font color="#008000"><i>{ readonly-, hidden-, archive attributen }
  </i></font>BufSize <font color="#000080">= </font><font color="#800000">16384</font><font color="#000080">;      </font><font color="#008000"><i>{ buffersize 16 KB }
  </i></font>divisor <font color="#000080">=  </font><font color="#800000">1000</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>BufType <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>BufSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Fname1<font color="#000080">, </font>Fname2   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>Line1<font color="#000080">, </font>Line2     <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>OldFile<font color="#000080">, </font>NewFile <font color="#000080">: </font>text<font color="#000080">;
  </font>OldBuf <font color="#000080">, </font>NewBuf  <font color="#000080">: </font>BufType<font color="#000080">;
  </font>tel              <font color="#000080">: </font>longint<font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>OpenTextFile<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>InF<font color="#000080">: </font>text<font color="#000080">; </font>name<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>buffer<font color="#000080">: </font>BufType <font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">( </font>InF<font color="#000080">, </font>Name <font color="#000080">);
  </font>SetTextBuf<font color="#000080">( </font>InF<font color="#000080">, </font>buffer <font color="#000080">);
  </font>Reset<font color="#000080">( </font>InF <font color="#000080">);
  </font>OpenTextFile <font color="#000080">:= ( </font>IOResult <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">);
</font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ OpenTextFile }</i></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>CreateTextFile<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>OutF<font color="#000080">: </font>text<font color="#000080">; </font>name<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>buffer<font color="#000080">: </font>BufType <font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">( </font>OutF<font color="#000080">, </font>Name <font color="#000080">);
  </font>SetTextBuf<font color="#000080">( </font>OutF<font color="#000080">, </font>buffer <font color="#000080">);
  </font>Rewrite<font color="#000080">( </font>OutF <font color="#000080">);
  </font>CreateTextFile <font color="#000080">:= ( </font>IOResult <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">);
</font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ CreateTextFile }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>FileExist<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>FName <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>F    <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
  </font>Attr <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">( </font>F<font color="#000080">, </font>FName <font color="#000080">);
  </font>GetFAttr<font color="#000080">( </font>F<font color="#000080">, </font>Attr <font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>FileExist <font color="#000080">:= ( ( </font>Attr <font color="#FF0000"><b>and </b></font>NoFAttr <font color="#000080">) = </font><font color="#800000">0 </font><font color="#000080">)
    </font><font color="#008000"><i>{ not dir-, volume- or system bit? }
  </i></font><font color="#FF0000"><b>else
    </b></font>FileExist <font color="#000080">:= </font>False<font color="#000080">;            </font><font color="#008000"><i>{ DosError }
  {}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>StrCopy<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Str1<font color="#000080">, </font>Str2<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ copy str1 to str2 }
</i></font><font color="#FF0000"><b>asm
        </b></font><font color="#FF00FF">LDS   SI,Str1    </font><font color="#008000"><i>{ load in DS:SI pointer to str1 }
        </i></font><font color="#FF00FF">CLD              </font><font color="#008000"><i>{ string operations forward     }
        </i></font><font color="#FF00FF">LES   DI,Str2    </font><font color="#008000"><i>{ load in ES:DI pointer to str2 }
        </i></font><font color="#FF00FF">XOR   CH,CH      </font><font color="#008000"><i>{ clear CH                      }
        </i></font><font color="#FF00FF">MOV   CL,[SI]    </font><font color="#008000"><i>{ length str1 --&gt; CX            }
        </i></font><font color="#FF00FF">INC   CX         </font><font color="#008000"><i>{ include length byte           }
    </i></font><font color="#FF00FF">REP MOVSB            </font><font color="#008000"><i>{ copy str1 to str2             }
</i></font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ StrCopy }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>CompUCStr<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Str1<font color="#000080">, </font>Str2<font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">): </font>ShortInt<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Compare Str1 and Str2 case insensitive }
</i></font><font color="#FF0000"><b>asm     </b></font><font color="#FF00FF">mov   dx, ds                 </font><font color="#008000"><i>{ save ds                        }
        </i></font><font color="#FF00FF">lds   si, str1               </font><font color="#008000"><i>{ ds:si = @str1                  }
        </i></font><font color="#FF00FF">les   di, str2               </font><font color="#008000"><i>{ es:di = @str2                  }
        </i></font><font color="#FF00FF">cld                          </font><font color="#008000"><i>{ string operations forwards     }
        </i></font><font color="#FF00FF">lodsb                        </font><font color="#008000"><i>{ get length string1 in AL       }
        </i></font><font color="#FF00FF">mov   ah, es:[di]            </font><font color="#008000"><i>{ get length string2 in AH       }
        </i></font><font color="#FF00FF">inc   di
        mov   bx, ax                 </font><font color="#008000"><i>{ save both lengths in BX        }
        </i></font><font color="#FF00FF">xor   cx, cx                 </font><font color="#008000"><i>{ clear cx                       }
        </i></font><font color="#FF00FF">mov   cl, al                 </font><font color="#008000"><i>{ get length String1 in CX       }
        </i></font><font color="#FF00FF">cmp   cl, ah                 </font><font color="#008000"><i>{ equal to length String2?       }
        </i></font><font color="#FF00FF">jb    @len                   </font><font color="#008000"><i>{ CX stores minimum length       }
        </i></font><font color="#FF00FF">mov   cl, ah                 </font><font color="#008000"><i>{ of string1 and string2         }
  </i></font><font color="#FF00FF">@len: jcxz  @exit                  </font><font color="#008000"><i>{ quit if null                   }

 </i></font><font color="#FF00FF">@loop: lodsb                        </font><font color="#008000"><i>{ str1[i] in AL                  }
        </i></font><font color="#FF00FF">mov   ah, es:[di]            </font><font color="#008000"><i>{ str2[i] in AH                  }

        </i></font><font color="#FF00FF">cmp   al, 'a'                </font><font color="#008000"><i>{ uppercase if 'a'..'z'          }
        </i></font><font color="#FF00FF">jb    @1
        cmp   al, 'z'
        ja    @1
        sub   al, 20h

    @1: cmp   ah, 'a'                </font><font color="#008000"><i>{ uppercase if 'a'..'z'          }
        </i></font><font color="#FF00FF">jb    @2
        cmp   ah, 'z'
        ja    @2
        sub   ah, 20h

    @2: cmp   al, ah                 </font><font color="#008000"><i>{ compare str1 to str2           }
        </i></font><font color="#FF00FF">jne   @not                   </font><font color="#008000"><i>{ loop if equal                  }
        </i></font><font color="#FF00FF">inc   di                     </font><font color="#008000"><i>{ next char str2                 }
        </i></font><font color="#FF00FF">dec   cx                     </font><font color="#008000"><i>{ countdown                      }
        </i></font><font color="#FF00FF">jcxz  @exit                  </font><font color="#008000"><i>{ strings same, Length also?     }
        </i></font><font color="#FF00FF">jmp   @loop                  </font><font color="#008000"><i>{ go do next char                }

  </i></font><font color="#FF00FF">@not: mov   bx, ax                 </font><font color="#008000"><i>{ BL = AL = String1[i],
                                       BH = AH = String2[i]           }
 </i></font><font color="#FF00FF">@exit: xor   ax, ax
        cmp   bl, bh                 </font><font color="#008000"><i>{ length or contents comp        }
        </i></font><font color="#FF00FF">je    @equal                 </font><font color="#008000"><i>{ str1 = str2: return  0         }
        </i></font><font color="#FF00FF">jb    @lower                 </font><font color="#008000"><i>{ str1 &lt; str2: return -1         }
        </i></font><font color="#FF00FF">inc   ax                     </font><font color="#008000"><i>{ str1 &gt; str2: return  1         }
        </i></font><font color="#FF00FF">inc   ax
@lower: dec   ax
@equal: mov   ds, dx                 </font><font color="#008000"><i>{ restore ds                     }
</i></font><font color="#FF0000"><b>end   </b></font><font color="#008000"><i>{ CompUCStr }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>White2Space<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>const </b></font>WhiteSpace<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ replace white space chars in Str by spaces
    the string WhiteSpace contains the chars to replace }
</i></font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ setup }
        </i></font><font color="#FF00FF">cld                      </font><font color="#008000"><i>{ string operations forwards    }
        </i></font><font color="#FF00FF">les   di, str            </font><font color="#008000"><i>{ ES:DI points to Str           }
        </i></font><font color="#FF00FF">xor   cx, cx             </font><font color="#008000"><i>{ clear cx                      }
        </i></font><font color="#FF00FF">mov   cl, [di]           </font><font color="#008000"><i>{ length Str in cl              }
        </i></font><font color="#FF00FF">jcxz  @exit              </font><font color="#008000"><i>{ if length of Str = 0, exit    }
        </i></font><font color="#FF00FF">inc   di                 </font><font color="#008000"><i>{ point to 1st char of Str      }
        </i></font><font color="#FF00FF">mov   dx, cx             </font><font color="#008000"><i>{ store length of Str           }
        </i></font><font color="#FF00FF">mov   bx, di             </font><font color="#008000"><i>{ pointer to Str                }
        </i></font><font color="#FF00FF">lds   si, WhiteSpace     </font><font color="#008000"><i>{ DS:SI points to WhiteSpace    }
        </i></font><font color="#FF00FF">mov   ah, [si]           </font><font color="#008000"><i>{ load length of WhiteSpace     }

</i></font><font color="#FF00FF">@start: cmp   ah, 0              </font><font color="#008000"><i>{ more chars WhiteSpace left?   }
        </i></font><font color="#FF00FF">jz    @exit              </font><font color="#008000"><i>{ no, exit                      }
        </i></font><font color="#FF00FF">inc   si                 </font><font color="#008000"><i>{ point to next char WhiteSpace }
        </i></font><font color="#FF00FF">mov   al, [si]           </font><font color="#008000"><i>{ next char to hunt             }
        </i></font><font color="#FF00FF">dec   ah                 </font><font color="#008000"><i>{ ah counting down              }
        </i></font><font color="#FF00FF">xor   dh, dh             </font><font color="#008000"><i>{ clear dh                      }
        </i></font><font color="#FF00FF">mov   cx, dx             </font><font color="#008000"><i>{ restore length of Str         }
        </i></font><font color="#FF00FF">mov   di, bx             </font><font color="#008000"><i>{ restore pointer to Str        }
        </i></font><font color="#FF00FF">mov   dh, ' '            </font><font color="#008000"><i>{ space char                    }
</i></font><font color="#FF00FF">@scan:
  repne scasb                    </font><font color="#008000"><i>{ the hunt is on                }
        </i></font><font color="#FF00FF">jnz   @next              </font><font color="#008000"><i>{ white space found?            }
        </i></font><font color="#FF00FF">mov   [di-1], dh         </font><font color="#008000"><i>{ yes, replace that one         }
</i></font><font color="#FF00FF">@next:  jcxz  @start             </font><font color="#008000"><i>{ if no more chars in Str       }
        </i></font><font color="#FF00FF">jmp   @scan              </font><font color="#008000"><i>{ if more chars in Str          }
</i></font><font color="#FF00FF">@exit:
</font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ White2Space }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>RTrim<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ remove trailing spaces from str }
</i></font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ setup }
        </i></font><font color="#FF00FF">std                      </font><font color="#008000"><i>{ string operations backwards   }
        </i></font><font color="#FF00FF">les   di, str            </font><font color="#008000"><i>{ ES:DI points to Str           }
        </i></font><font color="#FF00FF">xor   cx, cx             </font><font color="#008000"><i>{ clear cx                      }
        </i></font><font color="#FF00FF">mov   cl, [di]           </font><font color="#008000"><i>{ length Str in cl              }
        </i></font><font color="#FF00FF">jcxz  @exit              </font><font color="#008000"><i>{ if length of Str = 0, exit    }
        </i></font><font color="#FF00FF">mov   bx, di             </font><font color="#008000"><i>{ bx points to Str              }
        </i></font><font color="#FF00FF">add   di, cx             </font><font color="#008000"><i>{ start with last char in Str   }
        </i></font><font color="#FF00FF">mov   al, ' '            </font><font color="#008000"><i>{ hunt for spaces               }

        { remove trailing spaces }
   </i></font><font color="#FF00FF">repe scasb                    </font><font color="#008000"><i>{ the hunt is on                }
        </i></font><font color="#FF00FF">jz    @null              </font><font color="#008000"><i>{ only spaces?                  }
        </i></font><font color="#FF00FF">inc   cx                 </font><font color="#008000"><i>{ no, don't lose last char      }
</i></font><font color="#FF00FF">@null:  mov   [bx], cl           </font><font color="#008000"><i>{ overwrite length byte of Str  }
</i></font><font color="#FF00FF">@exit:
</font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ RTrim }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>LTrim<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ remove leading spaces from str }
</i></font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ setup }
        </i></font><font color="#FF00FF">cld                      </font><font color="#008000"><i>{ string operations forward          }
        </i></font><font color="#FF00FF">lds   si, str            </font><font color="#008000"><i>{ DS:SI points to Str                }
        </i></font><font color="#FF00FF">xor   cx, cx             </font><font color="#008000"><i>{ clear cx                           }
        </i></font><font color="#FF00FF">mov   cl, [si]           </font><font color="#008000"><i>{ length Str --&gt; cl                  }
        </i></font><font color="#FF00FF">jcxz  @exit              </font><font color="#008000"><i>{ if length Str = 0, exit            }
        </i></font><font color="#FF00FF">mov   bx, si             </font><font color="#008000"><i>{ save pointer to length byte of Str }
        </i></font><font color="#FF00FF">inc   si                 </font><font color="#008000"><i>{ 1st char of Str                    }
        </i></font><font color="#FF00FF">mov   di, si             </font><font color="#008000"><i>{ pointer to 1st char of Str --&gt; di  }
        </i></font><font color="#FF00FF">mov   al, ' '            </font><font color="#008000"><i>{ hunt for spaces                    }
        </i></font><font color="#FF00FF">xor   dx, dx             </font><font color="#008000"><i>{ clear dx                           }

</i></font><font color="#FF00FF">@start: </font><font color="#008000"><i>{ look for leading spaces }
   </i></font><font color="#FF00FF">repe scasb                    </font><font color="#008000"><i>{ the hunt is on                     }
        </i></font><font color="#FF00FF">jz    @done              </font><font color="#008000"><i>{ if only spaces, we are done        }
        </i></font><font color="#FF00FF">inc   cx                 </font><font color="#008000"><i>{ no, don't lose 1st non-blank char  }
        </i></font><font color="#FF00FF">dec   di                 </font><font color="#008000"><i>{ no, don't lose 1st non-blank char  }
        </i></font><font color="#FF00FF">mov   dx, cx             </font><font color="#008000"><i>{ new lenght of Str                  }
        </i></font><font color="#FF00FF">xchg  di, si             </font><font color="#008000"><i>{ swap si and di                     }
    </i></font><font color="#FF00FF">rep movsb                    </font><font color="#008000"><i>{ move remaining part of Str         }
</i></font><font color="#FF00FF">@done:  mov   [bx], dl           </font><font color="#008000"><i>{ new length of Str                  }
</i></font><font color="#FF00FF">@exit:
</font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ LTrim }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>LineOK<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>str<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">) : </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Line contains chars &gt; ASCII 20h ? }
</i></font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ setup }
        </i></font><font color="#FF00FF">xor   ax, ax         </font><font color="#008000"><i>{ assume false return value        }
        </i></font><font color="#FF00FF">xor   cx, cx         </font><font color="#008000"><i>{ clear cx                         }
        </i></font><font color="#FF00FF">lds   si, str        </font><font color="#008000"><i>{ load in DS:SI pointer to Str     }
        </i></font><font color="#FF00FF">mov   cl, [si]       </font><font color="#008000"><i>{ length Str --&gt; cx                }
        </i></font><font color="#FF00FF">jcxz  @exit          </font><font color="#008000"><i>{ if no characters, exit           }
        </i></font><font color="#FF00FF">inc   si             </font><font color="#008000"><i>{ point to 1st character           }

        { look for chars &gt; ASCII 20h }
</i></font><font color="#FF00FF">@start: mov   bl, [si]       </font><font color="#008000"><i>{ load character                   }
        </i></font><font color="#FF00FF">cmp   bl, ' '        </font><font color="#008000"><i>{ char &gt; ASCII 20h?                }
        </i></font><font color="#FF00FF">ja    @yes           </font><font color="#008000"><i>{ yes, return true                 }
        </i></font><font color="#FF00FF">inc   si             </font><font color="#008000"><i>{ next character                   }
        </i></font><font color="#FF00FF">dec   cx             </font><font color="#008000"><i>{ count down                       }
        </i></font><font color="#FF00FF">jcxz  @exit          </font><font color="#008000"><i>{ if no more characters left, exit }
        </i></font><font color="#FF00FF">jmp   @start         </font><font color="#008000"><i>{ try again                        }
</i></font><font color="#FF00FF">@yes:   mov   ax, 1          </font><font color="#008000"><i>{ return value true                }
</i></font><font color="#FF00FF">@exit:
</font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ LineOK }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TestLine<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Line<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>len<font color="#000080">: </font>byte <font color="#FF0000"><b>absolute </b></font>Line<font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>TrimLine<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>White2Space<font color="#000080">( </font>Line<font color="#000080">, </font>WhiteSpace <font color="#000080">);  </font><font color="#008000"><i>{ white space to spaces   }
    </i></font>RTrim<font color="#000080">( </font>Line <font color="#000080">);                    </font><font color="#008000"><i>{ remove trailing spaces  }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>TrimLine<font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font>EOF<font color="#000080">( </font>OldFile <font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>IOResult <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">)
  </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>len <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or not </b></font>LineOK<font color="#000080">( </font>Line <font color="#000080">)
</font><font color="#008000"><i>{$IFDEF NoPlus}
  </i></font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Line<font color="#000080">[</font>len<font color="#000080">] = </font><font color="#800000">'+'</font><font color="#000080">)
</font><font color="#008000"><i>{$ENDIF}
  </i></font><font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>ReadLn<font color="#000080">( </font>OldFile<font color="#000080">, </font>Line <font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ TestLine }


</i></font><font color="#FF0000"><b>begin
  if </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then             </b></font><font color="#008000"><i>{ parameters file1 file2 }
  </i></font><font color="#FF0000"><b>begin
    </b></font>Fname1 <font color="#000080">:= </font>FExpand<font color="#000080">( </font>ParamStr<font color="#000080">( </font><font color="#800000">1 </font><font color="#000080">) );
    </font>Fname2 <font color="#000080">:= </font>FExpand<font color="#000080">( </font>ParamStr<font color="#000080">( </font><font color="#800000">2 </font><font color="#000080">) );
    </font>tel <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>FileExist<font color="#000080">( </font>Fname1 <font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      if </b></font>OpenTextFile<font color="#000080">( </font>OldFile<font color="#000080">, </font>Fname1<font color="#000080">, </font>OldBuf <font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        if </b></font>CreateTextFile<font color="#000080">( </font>NewFile<font color="#000080">, </font>Fname2<font color="#000080">, </font>NewBuf <font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          </b></font>Line1 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
          </font>ReadLn<font color="#000080">( </font>OldFile<font color="#000080">, </font>Line2 <font color="#000080">);

          </font><font color="#FF0000"><b>while not </b></font>EOF<font color="#000080">( </font>OldFile <font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>IOResult <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>do
          begin
            </b></font>TestLine<font color="#000080">( </font>Line2 <font color="#000080">);
            </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>CompUCStr<font color="#000080">( </font>Line1<font color="#000080">, </font>Line2 <font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
            begin
              </b></font>StrCopy<font color="#000080">( </font>Line2<font color="#000080">, </font>Line1 <font color="#000080">);         </font><font color="#008000"><i>{ copy Line2 to Line1 }
              </i></font>WriteLn<font color="#000080">( </font>NewFile<font color="#000080">, </font>Line1 <font color="#000080">);
              </font>inc<font color="#000080">( </font>tel <font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>tel <font color="#FF0000"><b>mod </b></font>divisor<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">( </font><font color="#800000">#13</font><font color="#000080">, </font>tel<font color="#000080">, </font><font color="#800000">' unique lines' </font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font>ReadLn<font color="#000080">( </font>OldFile<font color="#000080">, </font>Line2 <font color="#000080">);
          </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{while not EOF}</i></font><font color="#000080">;

          </font>TestLine<font color="#000080">( </font>Line2 <font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>length<font color="#000080">( </font>Line2 <font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>CompUCStr<font color="#000080">( </font>Line1<font color="#000080">, </font>Line2 <font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
          begin
            </b></font>WriteLn<font color="#000080">( </font>NewFile<font color="#000080">, </font>Line2 <font color="#000080">);
            </font>inc<font color="#000080">( </font>tel <font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

          </font>writeln<font color="#000080">( </font><font color="#800000">#13</font><font color="#000080">, </font>tel<font color="#000080">, </font><font color="#800000">' unique lines' </font><font color="#000080">);
          </font>Close<font color="#000080">( </font>NewFile <font color="#000080">);
          </font>Close<font color="#000080">( </font>OldFile <font color="#000080">);
        </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if create file2 }
        </i></font><font color="#FF0000"><b>else
          </b></font>writeln<font color="#000080">(</font><font color="#800000">' error creating file '</font><font color="#000080">, </font>Fname1 <font color="#000080">);
        </font><font color="#008000"><i>{ error creating file }
      </i></font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if open file1 }
      </i></font><font color="#FF0000"><b>else
        </b></font>writeln<font color="#000080">(</font><font color="#800000">' error opening file '</font><font color="#000080">, </font>Fname1 <font color="#000080">);
      </font><font color="#008000"><i>{ error opening file }
    </i></font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if FileExist( Fname1 ) }
    </i></font><font color="#FF0000"><b>else
      </b></font>writeln<font color="#000080">( </font>Fname1<font color="#000080">, </font><font color="#800000">' not found' </font><font color="#000080">);
    </font><font color="#008000"><i>{ file not found }
  </i></font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if ParamCount &gt; 1 }
  </i></font><font color="#FF0000"><b>else
    </b></font>Writeln<font color="#000080">( </font><font color="#800000">'Dup file1 file2' </font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0063.PAS">Original</a><b>]</b></p></body>
</html>
