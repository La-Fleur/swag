<html>
<head><title> "Text File Paginator" by DAVID DANIEL ANDERSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0046.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>PROGRAM </b></font>PaginateTextFiles<font color="#000080">;
</font><font color="#FF0000"><b>CONST
     </b></font>ProgData <font color="#000080">= </font><font color="#800000">'PAGINATE- Free DOS utility: text file paginator.'</font><font color="#000080">;
     </font>ProgDat2 <font color="#000080">= </font><font color="#800000">'V1.00: July 14, 1993. (c) 1993 by David Daniel Anderson - Reign Ware.'</font><font color="#000080">;
     </font>Usage   <font color="#000080">= </font><font color="#800000">'Usage:   PAGINATE /i&lt;infile&gt; /o&lt;outfile&gt; /l##[:##] (lines per odd/even page)'</font><font color="#000080">;
     </font>Example <font color="#000080">= </font><font color="#800000">'Example: PAGINATE /iNOTPAGED.TXT /oPAGED.TXT /l55'</font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
     </b></font>IFL<font color="#000080">, </font>OFL<font color="#000080">, </font>LPP    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
     </font>InFile<font color="#000080">, </font>OutFile  <font color="#000080">: </font>Text<font color="#000080">;
     </font>OddL<font color="#000080">,</font>EvenL       <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>InValidParms<font color="#000080">( </font>ErrCode <font color="#000080">: </font>Word <font color="#000080">);
</font><font color="#FF0000"><b>VAR
   Message </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
</font><font color="#FF0000"><b>BEGIN
     </b></font>WriteLn<font color="#000080">(</font>Usage<font color="#000080">);
     </font>WriteLn<font color="#000080">(</font>Example<font color="#000080">);
     </font><font color="#FF0000"><b>CASE </b></font>ErrCode <font color="#FF0000"><b>OF
          </b></font><font color="#800000">1 </font><font color="#000080">: </font><font color="#FF0000"><b>Message </b></font><font color="#000080">:= </font><font color="#800000">'Incorrect number of parameters on command line.'</font><font color="#000080">;
          </font><font color="#800000">2 </font><font color="#000080">: </font><font color="#FF0000"><b>Message </b></font><font color="#000080">:= </font><font color="#800000">'Invalid switch on command line.'</font><font color="#000080">;
          </font><font color="#800000">3 </font><font color="#000080">: </font><font color="#FF0000"><b>Message </b></font><font color="#000080">:= </font><font color="#800000">'Cannot open input file '</font><font color="#000080">+ </font>IFL <font color="#000080">+ </font><font color="#800000">'.'</font><font color="#000080">;
          </font><font color="#800000">4 </font><font color="#000080">: </font><font color="#FF0000"><b>Message </b></font><font color="#000080">:= </font><font color="#800000">'Cannot open NEW output file '</font><font color="#000080">+ </font>OFL <font color="#000080">+ </font><font color="#800000">'.'</font><font color="#000080">;
          </font><font color="#800000">5 </font><font color="#000080">: </font><font color="#FF0000"><b>Message </b></font><font color="#000080">:= </font><font color="#800000">'Non-numeric '</font><font color="#000080">+ </font>LPP <font color="#000080">+ </font><font color="#800000">' specified for lines per page.'</font><font color="#000080">;
     </font><font color="#FF0000"><b>ELSE
          Message </b></font><font color="#000080">:= </font><font color="#800000">'Unknown error.'</font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">);
     </font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ParseComLine<font color="#000080">;
</font><font color="#FF0000"><b>CONST
     </b></font>Bad <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;   </font><font color="#008000"><i>{An invalid filename character &amp; invalid integer.}
</i></font><font color="#FF0000"><b>VAR
     </b></font>SwStr            <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
     </font>SwChar           <font color="#000080">: </font>Char<font color="#000080">;
     </font>ic               <font color="#000080">: </font>Byte<font color="#000080">;
     </font>ArgText          <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
</font><font color="#FF0000"><b>BEGIN
     IF </b></font>ParamCount <font color="#000080">&lt;&gt; </font><font color="#800000">3 </font><font color="#FF0000"><b>THEN
        </b></font>InValidParms<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);

     </font>IFL <font color="#000080">:= </font>Bad<font color="#000080">; </font>OFL <font color="#000080">:= </font>Bad<font color="#000080">; </font>LPP <font color="#000080">:= </font>Bad<font color="#000080">;

     </font><font color="#FF0000"><b>FOR </b></font>ic <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>DO
     BEGIN
         </b></font>SwStr  <font color="#000080">:= </font>Copy<font color="#000080">(</font>ParamStr<font color="#000080">(</font>ic<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
         </font>SwChar <font color="#000080">:= </font>UpCase<font color="#000080">(</font>SwStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
         </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>SwChar <font color="#000080">&lt;&gt; </font><font color="#800000">'/'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
            </b></font>InValidParms<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
         </font>SwStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>ParamStr<font color="#000080">(</font>ic<font color="#000080">),</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
         </font>SwChar <font color="#000080">:= </font>UpCase<font color="#000080">(</font>SwStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
         </font>ArgText <font color="#000080">:= </font>Copy<font color="#000080">(</font>ParamStr<font color="#000080">(</font>ic<font color="#000080">),</font><font color="#800000">3</font><font color="#000080">,(</font>Length<font color="#000080">(</font>ParamStr<font color="#000080">(</font>ic<font color="#000080">))-</font><font color="#800000">2</font><font color="#000080">));
         </font><font color="#FF0000"><b>CASE </b></font>SwChar <font color="#FF0000"><b>OF
              </b></font><font color="#800000">'I' </font><font color="#000080">: </font>IFL <font color="#000080">:= </font>ArgText<font color="#000080">;
              </font><font color="#800000">'O' </font><font color="#000080">: </font>OFL <font color="#000080">:= </font>ArgText<font color="#000080">;
              </font><font color="#800000">'L' </font><font color="#000080">: </font>LPP <font color="#000080">:= </font>ArgText<font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Open_I_O_Files<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Assign<font color="#000080">(</font>InFile<font color="#000080">,</font>IFL<font color="#000080">);
</font><font color="#008000"><i>{$I-} </i></font>Reset<font color="#000080">(</font>InFile<font color="#000080">); </font><font color="#008000"><i>{$I+}
     </i></font><font color="#FF0000"><b>IF </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
        </b></font>InValidParms<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);

     </font>Assign<font color="#000080">(</font>OutFile<font color="#000080">,</font>OFL<font color="#000080">);
</font><font color="#008000"><i>{$I-} </i></font>Rewrite<font color="#000080">(</font>OutFile<font color="#000080">);  </font><font color="#008000"><i>{$I+}
     </i></font><font color="#FF0000"><b>IF </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
        </b></font>InValidParms<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>GetEvenOdd <font color="#000080">( </font>lpp_param <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>oddnum<font color="#000080">, </font>evennum <font color="#000080">: </font>Word<font color="#000080">);
                       </font><font color="#008000"><i>{ determine page length for odd/ even pages }
</i></font><font color="#FF0000"><b>VAR
   </b></font>odds<font color="#000080">, </font>evens<font color="#000080">,        </font><font color="#008000"><i>{ string of odd/ even lines per page }
   </i></font>lstr  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];  </font><font color="#008000"><i>{ entire string containing numbers needed }

   </i></font>vlppo<font color="#000080">,</font>vlppe<font color="#000080">,        </font><font color="#008000"><i>{ numeric of lines per page odd/even }
   </i></font>lval  <font color="#000080">: </font>byte<font color="#000080">;       </font><font color="#008000"><i>{ numeric of string containing numbers needed }

   </i></font>pcode <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{ error code, will be non-zero if strings are not numbers }

</i></font><font color="#FF0000"><b>BEGIN
     </b></font>lstr <font color="#000080">:= </font>lpp_param<font color="#000080">;

     </font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>pos<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">,</font>lstr<font color="#000080">)) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
     BEGIN                                            </b></font><font color="#008000"><i>{ determine position of }
        </i></font>odds  <font color="#000080">:= </font>copy<font color="#000080">(</font>lstr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,((</font>pos<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">,</font>lstr<font color="#000080">))-</font><font color="#800000">1</font><font color="#000080">));    </font><font color="#008000"><i>{ any colon, and divide }
        </i></font>evens <font color="#000080">:= </font>copy<font color="#000080">(</font>lstr<font color="#000080">,((</font>pos<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">,</font>lstr<font color="#000080">))+</font><font color="#800000">1</font><font color="#000080">),</font>length<font color="#000080">(</font>lstr<font color="#000080">)); </font><font color="#008000"><i>{ at that point }

        </i></font>val<font color="#000080">(</font>odds<font color="#000080">,</font>vlppo<font color="#000080">,</font>pcode<font color="#000080">);       </font><font color="#008000"><i>{ convert first part of string         }
        </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>pcode <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>{ into numeric                         }
           </i></font>InValidParms<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">);          </font><font color="#008000"><i>{ show help if any errors              }

        </i></font>val<font color="#000080">(</font>evens<font color="#000080">,</font>vlppe<font color="#000080">,</font>pcode<font color="#000080">);      </font><font color="#008000"><i>{ convert first part of string         }
        </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>pcode <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>{ into numeric                         }
           </i></font>InValidParms<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">);          </font><font color="#008000"><i>{ show help if any errors              }
     </i></font><font color="#FF0000"><b>END

     ELSE BEGIN  </b></font><font color="#008000"><i>{ if colon not present, lines/pg should be entire parameter }
        </i></font>val<font color="#000080">(</font>lstr<font color="#000080">,</font>lval<font color="#000080">,</font>pcode<font color="#000080">);        </font><font color="#008000"><i>{ convert entire of string             }
        </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>pcode <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>{ into numeric                         }
           </i></font>InValidParms<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">);          </font><font color="#008000"><i>{ show help if any errors              }
        </i></font>vlppo <font color="#000080">:= </font>lval<font color="#000080">;
        </font>vlppe <font color="#000080">:= </font>lval<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>oddnum  <font color="#000080">:= </font>vlppo<font color="#000080">;
     </font>evennum <font color="#000080">:= </font>vlppe<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>InsertFF<font color="#000080">( </font>OddLines<font color="#000080">, </font>EvenLines <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>CONST
     </b></font>FF <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
     </b></font>LinesCopied<font color="#000080">,
     </font>LinesPerPage<font color="#000080">,
     </font>PageCopying   <font color="#000080">: </font>Word<font color="#000080">;
     </font>ALine         <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>LinesCopied <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>LinesPerPage <font color="#000080">:= </font>OddLines<font color="#000080">;
     </font>PageCopying <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>Eof<font color="#000080">(</font>InFile<font color="#000080">)) </font><font color="#FF0000"><b>DO
     BEGIN
          </b></font>ReadLn<font color="#000080">(</font>InFile<font color="#000080">,</font>ALine<font color="#000080">);
          </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>LinesCopied <font color="#000080">= </font>LinesPerPage<font color="#000080">) </font><font color="#FF0000"><b>THEN
          BEGIN
             </b></font>ALine <font color="#000080">:= </font>FF <font color="#000080">+ </font>ALine<font color="#000080">;
             </font>LinesCopied <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
             </font>PageCopying <font color="#000080">:= </font>Succ<font color="#000080">(</font>PageCopying<font color="#000080">);
             </font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>PageCopying <font color="#FF0000"><b>MOD </b></font><font color="#800000">2</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                </b></font>LinesPerPage <font color="#000080">:= </font>EvenLines
             <font color="#FF0000"><b>ELSE
                </b></font>LinesPerPage <font color="#000080">:= </font>OddLines<font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>WriteLn<font color="#000080">(</font>OutFile<font color="#000080">,</font>ALine<font color="#000080">);
          </font>LinesCopied <font color="#000080">:= </font>Succ<font color="#000080">(</font>LinesCopied<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN                                </b></font><font color="#008000"><i>{ main }
     </i></font>Writeln<font color="#000080">(</font>ProgData<font color="#000080">);
     </font>Writeln<font color="#000080">(</font>ProgDat2<font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>ParseComLine<font color="#000080">;
     </font>Open_I_O_Files<font color="#000080">;
     </font>GetEvenOdd<font color="#000080">(</font>LPP<font color="#000080">,</font>OddL<font color="#000080">,</font>EvenL<font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Input file: '</font><font color="#000080">,</font>IFL<font color="#000080">,</font><font color="#800000">' - Output file: '</font><font color="#000080">,</font>OFL<font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Lines per odd / even page: '</font><font color="#000080">,</font>Oddl<font color="#000080">,</font><font color="#800000">' / '</font><font color="#000080">,</font>EvenL<font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">);
     </font>InsertFF<font color="#000080">(</font>OddL<font color="#000080">,</font>EvenL<font color="#000080">);
     </font>Close<font color="#000080">(</font>InFile<font color="#000080">);
     </font>Close<font color="#000080">(</font>OutFile<font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Done!'</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0046.PAS">Original</a><b>]</b></p></body>
</html>
