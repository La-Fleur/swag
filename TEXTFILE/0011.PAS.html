<html>
<head><title> "VIEWER.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&sup3;I would like to be able to read a standard ASCII Text File from disk into
&sup3;a section of memory so I would be able to call up the screen later.  How
&sup3;would I accomplish this?  I'm assuming that once I have it in memory I could
&sup3;copy the information into $B800 and so have it display on the screen.  This
&sup3;would actually be useful For an instruction screen so I could scroll one
&sup3;screenful at a time With PgDn.

Sample code For viewing Text File. Feel free to experiment With it. If you
have any questions, just ask.
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>ViewTextFile<font color="#000080">(</font>fname<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#008000"><i>{ fname - name of Text File to display }

</i></font><font color="#FF0000"><b>Const
  </b></font>Bad   <font color="#000080">= </font><font color="#800000">#255</font><font color="#000080">;
  </font>Null  <font color="#000080">= </font><font color="#800000">#0</font><font color="#000080">;
  </font>ESC   <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">;
  </font>Home  <font color="#000080">= </font><font color="#800000">#71</font><font color="#000080">;
  </font>PgUp  <font color="#000080">= </font><font color="#800000">#73</font><font color="#000080">;
  </font>PgDn  <font color="#000080">= </font><font color="#800000">#81</font><font color="#000080">;
  </font>Done     <font color="#000080">: </font>Boolean <font color="#000080">= </font>False<font color="#000080">;
  </font>PageIndex<font color="#000080">: </font>Word    <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;         </font><font color="#008000"><i>{ index to our screen/page        }

</i></font><font color="#FF0000"><b>Var
  </b></font>InFile <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;                  </font><font color="#008000"><i>{ unTyped File                    }
  </i></font>PFile  <font color="#000080">: </font>Pointer<font color="#000080">;               </font><font color="#008000"><i>{ Pointer to our heap area        }
  </i></font>Size<font color="#000080">,                           </font><font color="#008000"><i>{ size of File                    }
  </i></font>Result<font color="#000080">,                         </font><font color="#008000"><i>{ return code For BlockRead       }
  </i></font>FileSeg<font color="#000080">,                        </font><font color="#008000"><i>{ Segment address of File in heap }
  </i></font>off<font color="#000080">: </font>Word<font color="#000080">;                      </font><font color="#008000"><i>{ use as offset to our heap       }
  </i></font>Pages<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2000</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word<font color="#000080">;  </font><font color="#008000"><i>{ define screen as Array of Words }
  </i></font>ch<font color="#000080">: </font>Char<font color="#000080">;                       </font><font color="#008000"><i>{ For reading commands            }

</i></font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>InFile<font color="#000080">, </font>fname<font color="#000080">);
  </font><font color="#008000"><i>{$I-} </i></font>Reset<font color="#000080">(</font>InFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'File not found: '</font><font color="#000080">,</font>fname<font color="#000080">);
      </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)         </font><font color="#008000"><i>{ stop Program &amp; return to Dos }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Size <font color="#000080">:= </font>FileSize<font color="#000080">(</font>InFile<font color="#000080">);        </font><font color="#008000"><i>{ get size of File               }
  </i></font>GetMem<font color="#000080">(</font>PFile<font color="#000080">, </font>Size<font color="#000080">);             </font><font color="#008000"><i>{ allocate space in heap         }
  </i></font>FileSeg <font color="#000080">:= </font>Seg<font color="#000080">(</font>PFile<font color="#000080">^);          </font><font color="#008000"><i>{ get Segment address of File in heap }

  </i></font>BlockRead<font color="#000080">(</font>InFile<font color="#000080">, </font>PFile<font color="#000080">^, </font>Size<font color="#000080">, </font>Result<font color="#000080">); </font><font color="#008000"><i>{ use BlockRead For fast File I/O }
  </i></font>FillChar<font color="#000080">(</font>Pages<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Pages<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);       </font><font color="#008000"><i>{ fill page With zeroes--ie:blank }
  </i></font><font color="#FF0000"><b>Repeat
    </b></font>ClrScr<font color="#000080">;
    </font>off <font color="#000080">:= </font>Pages<font color="#000080">[</font>PageIndex<font color="#000080">];
    </font><font color="#FF0000"><b>Repeat                                 </b></font><font color="#008000"><i>{ display screenfull at a time }
      </i></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font>Mem<font color="#000080">[</font>FileSeg<font color="#000080">:</font>off<font color="#000080">]));
      </font>inc<font color="#000080">(</font>off<font color="#000080">);
    </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>off <font color="#000080">= </font>Size<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>WhereY <font color="#000080">= </font><font color="#800000">25</font><font color="#000080">);
    </font><font color="#FF0000"><b>Repeat                                 </b></font><font color="#008000"><i>{ inner event loop }
      </i></font>ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>ch <font color="#000080">= </font>ESC <font color="#FF0000"><b>then
        </b></font>Done <font color="#000080">:= </font>True         <font color="#008000"><i>{ user escaped }
      </i></font><font color="#FF0000"><b>else
        if </b></font>ch <font color="#000080">= </font>Null <font color="#FF0000"><b>then
          Case </b></font>ReadKey <font color="#FF0000"><b>of
            </b></font>Home<font color="#000080">:  </font>PageIndex <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;       </font><font color="#008000"><i>{ go to first page }
            </i></font>PgUp<font color="#000080">:  </font><font color="#FF0000"><b>if </b></font>PageIndex <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
                     </b></font>Dec<font color="#000080">(</font>PageIndex<font color="#000080">);
            </font>PgDn<font color="#000080">:  </font><font color="#FF0000"><b>if </b></font>off <font color="#000080">&lt; </font>Size <font color="#FF0000"><b>then
                     begin
                       </b></font>Inc<font color="#000080">(</font>PageIndex<font color="#000080">);
                       </font>Pages<font color="#000080">[</font>PageIndex<font color="#000080">] := </font>off<font color="#000080">;
                     </font><font color="#FF0000"><b>end
            else
              </b></font>ch <font color="#000080">:= </font>Bad
          <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>ch <font color="#000080">= </font>Null<font color="#000080">) </font><font color="#FF0000"><b>or </b></font>Done<font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>Done<font color="#000080">;
  </font>Close<font color="#000080">(</font>InFile<font color="#000080">)        </font><font color="#008000"><i>{ don't forget to close the File }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ DisplayTextFile }


</i></font><font color="#FF0000"><b>begin
  if </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>ViewTextFile<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">))
  </font><font color="#FF0000"><b>else
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error: Missing File parameter.'</font><font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">. </font><font color="#008000"><i>{ program }

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p></body>
</html>
