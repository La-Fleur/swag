<html>
<head><title> "UNIX/DOS/MAC-DOS/UNIX/MAC File converter" by CASEY BILLETT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0082.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
  National ASCII Resource Converter v1.1

  Author: Casey Billett
          RR#4,
          Prescott, Ontario,
          Canada
          K0E 1T0
          ** bassman@recorder.ca **

  Date: Monday, August 9, 1997
  License: Freeware
  Agreement: Header stays intact of source code
  Help: This currently has a maximum text file length of 60000 chars.
        If anyone develops an adequate method of delineating this
        problem, please e-mail me. Possible methods include:
                 const FAtype = array [1..60000] of char;
                 var FA: ^FAType;
                 new(FA);
        and referencing it from there. Regardless...
}

</i></font><font color="#FF0000"><b>program </b></font>NARC<font color="#000080">; </font><font color="#008000"><i>{ National ASCII Resource Converter }

</i></font><font color="#FF0000"><b>uses
  </b></font>CRT<font color="#000080">,</font>DOS<font color="#000080">;

</font><font color="#008000"><i>{
-- Line endings of different format text files --
#13,#10 = DOS
#13 = MAC
#10 = UNIX
}

{
-- Assign writemodes to different formats --
writemode == 1; DOS
writemode == 2; MAC
writemode == 3; UNIX
}
</i></font><font color="#FF0000"><b>type
  </b></font>FAtype <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">60000</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;  </font><font color="#008000"><i>{ Maximum text length = 60000 }

</i></font><font color="#FF0000"><b>var
  </b></font>f<font color="#000080">:</font>text<font color="#000080">;                       </font><font color="#008000"><i>{ Assigned paramstr(1) - file to convert }
  </i></font>writemode<font color="#000080">: </font>integer<font color="#000080">;           </font><font color="#008000"><i>{ Assigned the format of txt file to read }
  </i></font>readmode<font color="#000080">: </font>integer<font color="#000080">;            </font><font color="#008000"><i>{ Assigned the format of txt file to write }
  </i></font>FA<font color="#000080">: </font>FAtype<font color="#000080">;
  </font>j<font color="#000080">: </font>integer<font color="#000080">;                   </font><font color="#008000"><i>{ Contains length of file }


</i></font><font color="#FF0000"><b>const
  </b></font>DOSf<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;                       </font><font color="#008000"><i>{ DOS file format }
  </i></font>MACf<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">;                       </font><font color="#008000"><i>{ Macintosh file format }
  </i></font>UNIXf<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;                      </font><font color="#008000"><i>{ Unix file format }
  </i></font>CR<font color="#000080">=</font><font color="#800000">#13</font><font color="#000080">;                       </font><font color="#008000"><i>{ Carriage return character }
  </i></font>LF<font color="#000080">=</font><font color="#800000">#10</font><font color="#000080">;                       </font><font color="#008000"><i>{ Line feed character }

{- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
</i></font><font color="#FF0000"><b>procedure </b></font>init<font color="#000080">;                 </font><font color="#008000"><i>{ General initialization &amp; logo }
</i></font><font color="#FF0000"><b>begin
  </b></font>textcolor<font color="#000080">(</font>White<font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">'  NARC: '</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>LightGray<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'National ASCII Resource Converter'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
</i></font><font color="#FF0000"><b>procedure </b></font>displayinstructions<font color="#000080">; </font><font color="#008000"><i>{ Display if the syntax is not right }
</i></font><font color="#FF0000"><b>begin
  </b></font>textcolor<font color="#000080">(</font>White<font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">'  **'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>Red<font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">' NARC'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>DarkGray<font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">' - usage:'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>White<font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">' narc'</font><font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">' filename1 filename2'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>Green<font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">' [udm]'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>White<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'  **'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>Green<font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">'            u'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>LightGray<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">': Convert filename1 to unix format and save in filename2'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>Green<font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">'            d'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>LightGray<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">': Convert filename1 to dos format and save in filename2'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>Green<font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">'            m'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>LightGray<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">': Convert filename1 to mac format and save in filename2'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'            See READ.ME for examples'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
</i></font><font color="#FF0000"><b>function </b></font>filesOK<font color="#000080">: </font>boolean<font color="#000080">;      </font><font color="#008000"><i>{ Make sure file in params exists }
</i></font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font>text<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{$I-}
  </i></font>filesOK <font color="#000080">:= </font>TRUE<font color="#000080">;
  </font>assign<font color="#000080">(</font>f<font color="#000080">, </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
  </font>reset<font color="#000080">(</font>f<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
    </b></font>textcolor<font color="#000080">(</font>White<font color="#000080">);
    </font>write<font color="#000080">(</font><font color="#800000">'  ** Error: '</font><font color="#000080">);
    </font>textcolor<font color="#000080">(</font>LightGray<font color="#000080">);
    </font>writeln<font color="#000080">(</font><font color="#800000">'File '</font><font color="#000080">, </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">), </font><font color="#800000">' does not exist'</font><font color="#000080">);
    </font>filesOK <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>close<font color="#000080">(</font>f<font color="#000080">);
</font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>paramcount<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
    </b></font>textcolor<font color="#000080">(</font>White<font color="#000080">);
    </font>write<font color="#000080">(</font><font color="#800000">'  ** Error: '</font><font color="#000080">);
    </font>textcolor<font color="#000080">(</font>LightGray<font color="#000080">);
    </font>writeln<font color="#000080">(</font><font color="#800000">'Must specify output file'</font><font color="#000080">);
    </font>filesOK <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
</i></font><font color="#FF0000"><b>function </b></font>paramsOK<font color="#000080">: </font>boolean<font color="#000080">;     </font><font color="#008000"><i>{ Checks to make sure sytax ok }
</i></font><font color="#FF0000"><b>var </b></font>k<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>paramsOK <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ParamCount <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>displayinstructions
  <font color="#FF0000"><b>else begin
    if </b></font>filesOK <font color="#FF0000"><b>then </b></font>paramsOK <font color="#000080">:= </font>TRUE <font color="#FF0000"><b>else </b></font>displayinstructions<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
</i></font><font color="#FF0000"><b>procedure </b></font>writefile<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">: </font>text<font color="#000080">);    </font><font color="#008000"><i>{ Write the file in the new format }
</i></font><font color="#FF0000"><b>var </b></font>k<font color="#000080">:</font>integer<font color="#000080">; </font>temp<font color="#000080">:</font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>assign <font color="#000080">(</font>f<font color="#000080">, </font>paramstr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">));
  </font>rewrite<font color="#000080">(</font>f<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>k<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>j <font color="#FF0000"><b>do begin
    </b></font>temp<font color="#000080">:=</font>FA<font color="#000080">[</font>k<font color="#000080">];
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>temp <font color="#000080">&lt;&gt; </font>CR<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>temp <font color="#000080">&lt;&gt; </font>LF<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>j<font color="#000080">&lt;&gt;</font>k<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font>f<font color="#000080">, </font>temp<font color="#000080">)
    </font><font color="#FF0000"><b>else begin
      if </b></font>temp <font color="#000080">= </font>CR <font color="#FF0000"><b>then begin
        case </b></font>writemode <font color="#FF0000"><b>of
          </b></font>DOSf<font color="#000080">: </font>write<font color="#000080">(</font>f<font color="#000080">, </font>CR<font color="#000080">,</font>LF<font color="#000080">);
          </font>MACf<font color="#000080">: </font>write<font color="#000080">(</font>f<font color="#000080">, </font>CR<font color="#000080">);
          </font>UNIXf<font color="#000080">: </font>write<font color="#000080">(</font>f<font color="#000080">, </font>LF<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{case}
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>temp <font color="#000080">= </font>LF<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>readmode <font color="#000080">= </font>UNIXf<font color="#000080">) </font><font color="#FF0000"><b>then begin
        case </b></font>writemode <font color="#FF0000"><b>of
          </b></font>DOSf<font color="#000080">: </font>write<font color="#000080">(</font>f<font color="#000080">, </font>CR<font color="#000080">,</font>LF<font color="#000080">);
          </font>MACf<font color="#000080">: </font>write<font color="#000080">(</font>f<font color="#000080">, </font>CR<font color="#000080">);
          </font>UNIXf<font color="#000080">: </font>write<font color="#000080">(</font>f<font color="#000080">, </font>LF<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{case}
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>close<font color="#000080">(</font>f<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
</i></font><font color="#FF0000"><b>procedure </b></font>readfile<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font>text<font color="#000080">);  </font><font color="#008000"><i>{ Read the input file charxchar }
</i></font><font color="#FF0000"><b>begin
  </b></font>j<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while not</b></font><font color="#000080">(</font>EOF<font color="#000080">(</font>f<font color="#000080">)) </font><font color="#FF0000"><b>do begin
    </b></font>read<font color="#000080">(</font>f<font color="#000080">,</font>FA<font color="#000080">[</font>j<font color="#000080">]);
    </font>inc<font color="#000080">(</font>j<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
</i></font><font color="#FF0000"><b>function </b></font>determinetype<font color="#000080">:</font>integer<font color="#000080">;  </font><font color="#008000"><i>{ Determines format of input file }
</i></font><font color="#FF0000"><b>var </b></font>k<font color="#000080">,</font>l<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>k<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>j <font color="#FF0000"><b>do begin
    if </b></font><font color="#000080">(</font>FA<font color="#000080">[</font>k<font color="#000080">] = </font>CR<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FA<font color="#000080">[</font>k<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] = </font>LF<font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>determinetype <font color="#000080">:= </font>DOSf<font color="#000080">;
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
    if </b></font><font color="#000080">(</font>FA<font color="#000080">[</font>k<font color="#000080">] = </font>CR<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FA<font color="#000080">[</font>k<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font>LF<font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>determinetype <font color="#000080">:= </font>MACf<font color="#000080">;
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
    if </b></font><font color="#000080">(</font>FA<font color="#000080">[</font>k<font color="#000080">] = </font>LF<font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>determinetype <font color="#000080">:= </font>UNIXf<font color="#000080">;
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
</i></font><font color="#FF0000"><b>function </b></font>determinewrite<font color="#000080">: </font>integer<font color="#000080">;  </font><font color="#008000"><i>{ Checks param to determine write format }
</i></font><font color="#FF0000"><b>var </b></font>temp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>temp<font color="#000080">:=</font>paramstr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
  </font><font color="#FF0000"><b>case </b></font>temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of
    </b></font><font color="#800000">'d'</font><font color="#000080">: </font>determinewrite <font color="#000080">:= </font>DOSf<font color="#000080">;
    </font><font color="#800000">'u'</font><font color="#000080">: </font>determinewrite <font color="#000080">:= </font>UNIXf<font color="#000080">;
    </font><font color="#800000">'m'</font><font color="#000080">: </font>determinewrite <font color="#000080">:= </font>MACf<font color="#000080">;
    </font><font color="#FF0000"><b>else </b></font>determinewrite <font color="#000080">:= </font>DOSf<font color="#000080">;
  </font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;
</font><font color="#008000"><i>{- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
</i></font><font color="#FF0000"><b>procedure </b></font>operation<font color="#000080">(</font>readf<font color="#000080">,</font>writef<font color="#000080">:</font>integer<font color="#000080">);            </font><font color="#008000"><i>{ Determines conversion operation }
</i></font><font color="#FF0000"><b>begin
  </b></font>readmode <font color="#000080">:= </font>readf<font color="#000080">;
  </font>writemode <font color="#000080">:= </font>writef<font color="#000080">;
  </font><font color="#FF0000"><b>case </b></font>readmode <font color="#FF0000"><b>of
    </b></font>DOSf<font color="#000080">: </font>write<font color="#000080">(</font><font color="#800000">'  DOS text file - '</font><font color="#000080">);
    </font>MACf<font color="#000080">: </font>write<font color="#000080">(</font><font color="#800000">'  Mac text file - '</font><font color="#000080">);
    </font>UNIXf<font color="#000080">: </font>write<font color="#000080">(</font><font color="#800000">'  Unix text file - '</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{case}</i></font><font color="#000080">;
  </font><font color="#FF0000"><b>case </b></font>writemode <font color="#FF0000"><b>of
    </b></font>DOSf<font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'DOS text file'</font><font color="#000080">);
    </font>MACf<font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'Mac text file'</font><font color="#000080">);
    </font>UNIXf<font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'Unix text file'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{case}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
</i></font><font color="#FF0000"><b>begin
  </b></font>init<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>paramsOK<font color="#000080">) </font><font color="#FF0000"><b>then begin
    </b></font>assign<font color="#000080">(</font>f<font color="#000080">, </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
    </font>reset<font color="#000080">(</font>f<font color="#000080">);
      </font>readfile<font color="#000080">(</font>f<font color="#000080">);
    </font>close<font color="#000080">(</font>f<font color="#000080">);
    </font>writeln<font color="#000080">(</font><font color="#800000">'  Determining file type...'</font><font color="#000080">);
    </font>operation<font color="#000080">(</font>determinetype<font color="#000080">,</font>determinewrite<font color="#000080">);
    </font>writefile<font color="#000080">(</font>f<font color="#000080">);
    </font>writeln<font color="#000080">(</font><font color="#800000">'  Complete.'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0082.PAS">Original</a><b>]</b></p></body>
</html>
