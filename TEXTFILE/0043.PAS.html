<html>
<head><title> "Delete dupe lines" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>Dup<font color="#000080">;
   </font><font color="#008000"><i>{ delete duplicate lines from a sorted text file }
   { Dup file1 file2 }

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>string3 <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
</font><font color="#FF0000"><b>Const
  </b></font>WhiteSpace <font color="#000080">: </font>string3 <font color="#000080">= </font><font color="#800000">#00#09#255</font><font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>NoFAttr <font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">$1C</font><font color="#000080">; </font><font color="#008000"><i>{ attributen dir, volume, system }
  </i></font>FAttr   <font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">$23</font><font color="#000080">; </font><font color="#008000"><i>{ readonly-, hidden-, archive attributen }
  </i></font>BufSize <font color="#000080">= </font><font color="#800000">16384</font><font color="#000080">;      </font><font color="#008000"><i>{ buffersize 16 KB }

</i></font><font color="#FF0000"><b>Type
  </b></font>BufType <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>BufSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Fname1<font color="#000080">, </font>Fname2   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>Line1<font color="#000080">, </font>Line2     <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>tmp1 <font color="#000080">, </font>tmp2      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;   </font><font color="#008000"><i>{ temporary vars for lower case comparing }
  </i></font>OldFile<font color="#000080">, </font>NewFile <font color="#000080">: </font>text<font color="#000080">;
  </font>OldBuf <font color="#000080">, </font>NewBuf  <font color="#000080">: </font>BufType<font color="#000080">;
  </font>tel              <font color="#000080">: </font>longint<font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>OpenTextFile<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>InF<font color="#000080">: </font>text<font color="#000080">; </font>name<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>buffer<font color="#000080">: </font>BufType <font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">( </font>InF<font color="#000080">, </font>Name <font color="#000080">);
  </font>SetTextBuf<font color="#000080">( </font>InF<font color="#000080">, </font>buffer <font color="#000080">);
  </font>Reset<font color="#000080">( </font>InF <font color="#000080">);
  </font>OpenTextFile <font color="#000080">:= ( </font>IOResult <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">);
</font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ OpenTextFile }</i></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>CreateTextFile<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>OutF<font color="#000080">: </font>text<font color="#000080">; </font>name<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>buffer<font color="#000080">: </font>BufType <font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">( </font>OutF<font color="#000080">, </font>Name <font color="#000080">);
  </font>SetTextBuf<font color="#000080">( </font>OutF<font color="#000080">, </font>buffer <font color="#000080">);
  </font>Rewrite<font color="#000080">( </font>OutF <font color="#000080">);
  </font>CreateTextFile <font color="#000080">:= ( </font>IOResult <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">);
</font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ CreateTextFile }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>FileExist<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>FName <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#008000"><i>{-Return true if entry is found and if it's a file}
</i></font><font color="#FF0000"><b>var
  </b></font>F    <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
  </font>Attr <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">( </font>F<font color="#000080">, </font>FName <font color="#000080">);
  </font>GetFAttr<font color="#000080">( </font>F<font color="#000080">, </font>Attr <font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>FileExist <font color="#000080">:= ( ( </font>Attr <font color="#FF0000"><b>and </b></font>NoFAttr <font color="#000080">) = </font><font color="#800000">0 </font><font color="#000080">)
    </font><font color="#008000"><i>{ not dir-, volume- or system bit? }
  </i></font><font color="#FF0000"><b>else
    </b></font>FileExist <font color="#000080">:= </font>False<font color="#000080">;            </font><font color="#008000"><i>{ DosError }
  {}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>StrCopy<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Str1<font color="#000080">, </font>Str2<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ copy str1 to str2 }
</i></font><font color="#FF0000"><b>asm
        </b></font><font color="#FF00FF">LDS   SI,Str1    </font><font color="#008000"><i>{ load in DS:SI pointer to str1 }
        </i></font><font color="#FF00FF">CLD              </font><font color="#008000"><i>{ string operations forward     }
        </i></font><font color="#FF00FF">LES   DI,Str2    </font><font color="#008000"><i>{ load in ES:DI pointer to str2 }
        </i></font><font color="#FF00FF">XOR   CH,CH      </font><font color="#008000"><i>{ clear CH                      }
        </i></font><font color="#FF00FF">MOV   CL,[SI]    </font><font color="#008000"><i>{ length str1 --&gt; CX            }
        </i></font><font color="#FF00FF">INC   CX         </font><font color="#008000"><i>{ include length byte           }
    </i></font><font color="#FF00FF">REP MOVSB            </font><font color="#008000"><i>{ copy str1 to str2             }
</i></font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ StrCopy }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>Lower<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">);
</font><font color="#008000"><i>{ 52 Bytes by Bob Swart, 11-6-1993, FidoNet '80XXX' FASTEST! }
</i></font><font color="#FF0000"><b>InLine</b></font><font color="#000080">(
  </font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$DA</font><font color="#000080">/               </font><font color="#008000"><i>{       mov   DX,DS                 }
  </i></font><font color="#800000">$BB</font><font color="#000080">/</font>Ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)/
      </font>Ord<font color="#000080">(</font><font color="#800000">'Z'</font><font color="#000080">)-</font>Ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)/ </font><font color="#008000"><i>{       mov   BX,'Z'-'A'/'A'        }
  </i></font><font color="#800000">$5E</font><font color="#000080">/                   </font><font color="#008000"><i>{       pop   SI                    }
  </i></font><font color="#800000">$1F</font><font color="#000080">/                   </font><font color="#008000"><i>{       pop   DS                    }
  </i></font><font color="#800000">$FC</font><font color="#000080">/                   </font><font color="#008000"><i>{       cld                         }
  </i></font><font color="#800000">$AC</font><font color="#000080">/                   </font><font color="#008000"><i>{       lodsb                       }
  </i></font><font color="#800000">$88</font><font color="#000080">/</font><font color="#800000">$C1</font><font color="#000080">/               </font><font color="#008000"><i>{       mov   CL,AL                 }
  </i></font><font color="#800000">$30</font><font color="#000080">/</font><font color="#800000">$ED</font><font color="#000080">/               </font><font color="#008000"><i>{       xor   CH,CH                 }
  </i></font><font color="#800000">$D1</font><font color="#000080">/</font><font color="#800000">$E9</font><font color="#000080">/               </font><font color="#008000"><i>{       shr   CX,1                  }
  </i></font><font color="#800000">$73</font><font color="#000080">/</font><font color="#800000">$0B</font><font color="#000080">/               </font><font color="#008000"><i>{       jnc   @Part1                }
  </i></font><font color="#800000">$AC</font><font color="#000080">/                   </font><font color="#008000"><i>{       lodsb                       }
  </i></font><font color="#800000">$28</font><font color="#000080">/</font><font color="#800000">$D8</font><font color="#000080">/               </font><font color="#008000"><i>{       sub   AL,BL                 }
  </i></font><font color="#800000">$38</font><font color="#000080">/</font><font color="#800000">$F8</font><font color="#000080">/               </font><font color="#008000"><i>{       cmp   AL,BH                 }
  </i></font><font color="#800000">$77</font><font color="#000080">/</font><font color="#800000">$04</font><font color="#000080">/               </font><font color="#008000"><i>{       ja    @Part1                }
  </i></font><font color="#800000">$80</font><font color="#000080">/</font><font color="#800000">$44</font><font color="#000080">/</font><font color="#800000">$FF</font><font color="#000080">/
      </font>Ord<font color="#000080">(</font><font color="#800000">'a'</font><font color="#000080">)-</font>Ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)/ </font><font color="#008000"><i>{@Loop: ADD   Byte Ptr[SI-1],'a'-'A'}
  </i></font><font color="#800000">$E3</font><font color="#000080">/</font><font color="#800000">$14</font><font color="#000080">/               </font><font color="#008000"><i>{@Part1:jcxz  @Exit                 }
  </i></font><font color="#800000">$AD</font><font color="#000080">/                   </font><font color="#008000"><i>{       lodsw                       }
  </i></font><font color="#800000">$28</font><font color="#000080">/</font><font color="#800000">$D8</font><font color="#000080">/               </font><font color="#008000"><i>{       sub   AL,BL                 }
  </i></font><font color="#800000">$38</font><font color="#000080">/</font><font color="#800000">$F8</font><font color="#000080">/               </font><font color="#008000"><i>{       cmp   AL,BH                 }
  </i></font><font color="#800000">$77</font><font color="#000080">/</font><font color="#800000">$04</font><font color="#000080">/               </font><font color="#008000"><i>{       ja    @Part2                }
  </i></font><font color="#800000">$80</font><font color="#000080">/</font><font color="#800000">$44</font><font color="#000080">/</font><font color="#800000">$FE</font><font color="#000080">/
      </font>Ord<font color="#000080">(</font><font color="#800000">'a'</font><font color="#000080">)-</font>Ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)/ </font><font color="#008000"><i>{       ADD   Byte Ptr[SI-2],'a'-'A'}
  </i></font><font color="#800000">$49</font><font color="#000080">/                   </font><font color="#008000"><i>{@Part2:dec   CX                    }
  </i></font><font color="#800000">$28</font><font color="#000080">/</font><font color="#800000">$DC</font><font color="#000080">/               </font><font color="#008000"><i>{       sub   AH,BL                 }
  </i></font><font color="#800000">$38</font><font color="#000080">/</font><font color="#800000">$FC</font><font color="#000080">/               </font><font color="#008000"><i>{       cmp   AH,BH                 }
  </i></font><font color="#800000">$77</font><font color="#000080">/</font><font color="#800000">$EC</font><font color="#000080">/               </font><font color="#008000"><i>{       ja    @Part1                }
  </i></font><font color="#800000">$EB</font><font color="#000080">/</font><font color="#800000">$E6</font><font color="#000080">/               </font><font color="#008000"><i>{       jmp   @Loop                 }
  </i></font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$DA                </font><font color="#008000"><i>{@Exit: mov   DS,DX                 }
</i></font><font color="#000080">) </font><font color="#008000"><i>{ LowerFast }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>White2Space<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>const </b></font>WhiteSpace<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ replace white space chars in Str by spaces
    the string WhiteSpace contains the chars to replace }
</i></font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ setup }
        </i></font><font color="#FF00FF">cld                      </font><font color="#008000"><i>{ string operations forwards    }
        </i></font><font color="#FF00FF">les   di, str            </font><font color="#008000"><i>{ ES:DI points to Str           }
        </i></font><font color="#FF00FF">xor   cx, cx             </font><font color="#008000"><i>{ clear cx                      }
        </i></font><font color="#FF00FF">mov   cl, [di]           </font><font color="#008000"><i>{ length Str in cl              }
        </i></font><font color="#FF00FF">jcxz  @exit              </font><font color="#008000"><i>{ if length of Str = 0, exit    }
        </i></font><font color="#FF00FF">inc   di                 </font><font color="#008000"><i>{ point to 1st char of Str      }
        </i></font><font color="#FF00FF">mov   dx, cx             </font><font color="#008000"><i>{ store length of Str           }
        </i></font><font color="#FF00FF">mov   bx, di             </font><font color="#008000"><i>{ pointer to Str                }
        </i></font><font color="#FF00FF">lds   si, WhiteSpace     </font><font color="#008000"><i>{ DS:SI points to WhiteSpace    }
        </i></font><font color="#FF00FF">mov   ah, [si]           </font><font color="#008000"><i>{ load length of WhiteSpace     }

</i></font><font color="#FF00FF">@start: cmp   ah, 0              </font><font color="#008000"><i>{ more chars WhiteSpace left?   }
        </i></font><font color="#FF00FF">jz    @exit              </font><font color="#008000"><i>{ no, exit                      }
        </i></font><font color="#FF00FF">inc   si                 </font><font color="#008000"><i>{ point to next char WhiteSpace }
        </i></font><font color="#FF00FF">mov   al, [si]           </font><font color="#008000"><i>{ next char to hunt             }
        </i></font><font color="#FF00FF">dec   ah                 </font><font color="#008000"><i>{ ah counting down              }
        </i></font><font color="#FF00FF">xor   dh, dh             </font><font color="#008000"><i>{ clear dh                      }
        </i></font><font color="#FF00FF">mov   cx, dx             </font><font color="#008000"><i>{ restore length of Str         }
        </i></font><font color="#FF00FF">mov   di, bx             </font><font color="#008000"><i>{ restore pointer to Str        }
        </i></font><font color="#FF00FF">mov   dh, ' '            </font><font color="#008000"><i>{ space char                    }
</i></font><font color="#FF00FF">@scan:
  repne scasb                    </font><font color="#008000"><i>{ the hunt is on                }
        </i></font><font color="#FF00FF">jnz   @next              </font><font color="#008000"><i>{ white space found?            }
        </i></font><font color="#FF00FF">mov   [di-1], dh         </font><font color="#008000"><i>{ yes, replace that one         }
</i></font><font color="#FF00FF">@next:  jcxz  @start             </font><font color="#008000"><i>{ if no more chars in Str       }
        </i></font><font color="#FF00FF">jmp   @scan              </font><font color="#008000"><i>{ if more chars in Str          }
</i></font><font color="#FF00FF">@exit:
</font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ White2Space }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>RTrim<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ remove trailing spaces from str }
</i></font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ setup }
        </i></font><font color="#FF00FF">std                      </font><font color="#008000"><i>{ string operations backwards   }
        </i></font><font color="#FF00FF">les   di, str            </font><font color="#008000"><i>{ ES:DI points to Str           }
        </i></font><font color="#FF00FF">xor   cx, cx             </font><font color="#008000"><i>{ clear cx                      }
        </i></font><font color="#FF00FF">mov   cl, [di]           </font><font color="#008000"><i>{ length Str in cl              }
        </i></font><font color="#FF00FF">jcxz  @exit              </font><font color="#008000"><i>{ if length of Str = 0, exit    }
        </i></font><font color="#FF00FF">mov   bx, di             </font><font color="#008000"><i>{ bx points to Str              }
        </i></font><font color="#FF00FF">add   di, cx             </font><font color="#008000"><i>{ start with last char in Str   }
        </i></font><font color="#FF00FF">mov   al, ' '            </font><font color="#008000"><i>{ hunt for spaces               }

        { remove trailing spaces }
   </i></font><font color="#FF00FF">repe scasb                    </font><font color="#008000"><i>{ the hunt is on                }
        </i></font><font color="#FF00FF">jz    @null              </font><font color="#008000"><i>{ only spaces?                  }
        </i></font><font color="#FF00FF">inc   cx                 </font><font color="#008000"><i>{ no, don't lose last char      }
</i></font><font color="#FF00FF">@null:  mov   [bx], cl           </font><font color="#008000"><i>{ overwrite length byte of Str  }
</i></font><font color="#FF00FF">@exit:
</font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ RTrim }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>LTrim<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ remove leading spaces from str }
</i></font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ setup }
        </i></font><font color="#FF00FF">cld                      </font><font color="#008000"><i>{ string operations forward          }
        </i></font><font color="#FF00FF">lds   si, str            </font><font color="#008000"><i>{ DS:SI points to Str                }
        </i></font><font color="#FF00FF">xor   cx, cx             </font><font color="#008000"><i>{ clear cx                           }
        </i></font><font color="#FF00FF">mov   cl, [si]           </font><font color="#008000"><i>{ length Str --&gt; cl                  }
        </i></font><font color="#FF00FF">jcxz  @exit              </font><font color="#008000"><i>{ if length Str = 0, exit            }
        </i></font><font color="#FF00FF">mov   bx, si             </font><font color="#008000"><i>{ save pointer to length byte of Str }
        </i></font><font color="#FF00FF">inc   si                 </font><font color="#008000"><i>{ 1st char of Str                    }
        </i></font><font color="#FF00FF">mov   di, si             </font><font color="#008000"><i>{ pointer to 1st char of Str --&gt; di  }
        </i></font><font color="#FF00FF">mov   al, ' '            </font><font color="#008000"><i>{ hunt for spaces                    }
        </i></font><font color="#FF00FF">xor   dx, dx             </font><font color="#008000"><i>{ clear dx                           }

</i></font><font color="#FF00FF">@start: </font><font color="#008000"><i>{ look for leading spaces }
   </i></font><font color="#FF00FF">repe scasb                    </font><font color="#008000"><i>{ the hunt is on                     }
        </i></font><font color="#FF00FF">jz    @done              </font><font color="#008000"><i>{ if only spaces, we are done        }
        </i></font><font color="#FF00FF">inc   cx                 </font><font color="#008000"><i>{ no, don't lose 1st non-blank char  }
        </i></font><font color="#FF00FF">dec   di                 </font><font color="#008000"><i>{ no, don't lose 1st non-blank char  }
        </i></font><font color="#FF00FF">mov   dx, cx             </font><font color="#008000"><i>{ new lenght of Str                  }
        </i></font><font color="#FF00FF">xchg  di, si             </font><font color="#008000"><i>{ swap si and di                     }
    </i></font><font color="#FF00FF">rep movsb                    </font><font color="#008000"><i>{ move remaining part of Str         }
</i></font><font color="#FF00FF">@done:  mov   [bx], dl           </font><font color="#008000"><i>{ new length of Str                  }
</i></font><font color="#FF00FF">@exit:
</font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ LTrim }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>LineOK<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>str<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">) : </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Line contains chars &gt; ASCII 20h ? }
</i></font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ setup }
        </i></font><font color="#FF00FF">xor   ax, ax         </font><font color="#008000"><i>{ assume false return value        }
        </i></font><font color="#FF00FF">xor   cx, cx         </font><font color="#008000"><i>{ clear cx                         }
        </i></font><font color="#FF00FF">lds   si, str        </font><font color="#008000"><i>{ load in DS:SI pointer to Str     }
        </i></font><font color="#FF00FF">mov   cl, [si]       </font><font color="#008000"><i>{ length Str --&gt; cx                }
        </i></font><font color="#FF00FF">jcxz  @exit          </font><font color="#008000"><i>{ if no characters, exit           }
        </i></font><font color="#FF00FF">inc   si             </font><font color="#008000"><i>{ point to 1st character           }

        { look for chars &gt; ASCII 20h }
</i></font><font color="#FF00FF">@start: mov   bl, [si]       </font><font color="#008000"><i>{ load character                   }
        </i></font><font color="#FF00FF">cmp   bl, ' '        </font><font color="#008000"><i>{ char &gt; ASCII 20h?                }
        </i></font><font color="#FF00FF">ja    @yes           </font><font color="#008000"><i>{ yes, return true                 }
        </i></font><font color="#FF00FF">inc   si             </font><font color="#008000"><i>{ next character                   }
        </i></font><font color="#FF00FF">dec   cx             </font><font color="#008000"><i>{ count down                       }
        </i></font><font color="#FF00FF">jcxz  @exit          </font><font color="#008000"><i>{ if no more characters left, exit }
        </i></font><font color="#FF00FF">jmp   @start         </font><font color="#008000"><i>{ try again                        }
</i></font><font color="#FF00FF">@yes:   mov   ax, 1          </font><font color="#008000"><i>{ return value true                }
</i></font><font color="#FF00FF">@exit:
</font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ LineOK }</i></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TestLine<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Line<font color="#000080">, </font>tmp <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>len<font color="#000080">: </font>byte <font color="#FF0000"><b>absolute </b></font>Line<font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>TrimLine<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>White2Space<font color="#000080">( </font>Line<font color="#000080">, </font>WhiteSpace <font color="#000080">);  </font><font color="#008000"><i>{ white space to spaces   }
    </i></font>RTrim<font color="#000080">( </font>Line <font color="#000080">);                    </font><font color="#008000"><i>{ remove trailing spaces  }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>TrimPlus<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>TrimLine<font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font>Line<font color="#000080">[</font>len<font color="#000080">] = </font><font color="#800000">'+' </font><font color="#FF0000"><b>do
    begin
      </b></font>dec<font color="#000080">( </font>len <font color="#000080">);
      </font>TrimLine<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>TrimPlus<font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font>Eof<font color="#000080">( </font>OldFile <font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>IOResult <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>length<font color="#000080">( </font>Line <font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or not </b></font>LineOK<font color="#000080">( </font>Line <font color="#000080">)) </font><font color="#FF0000"><b>do
  begin
    </b></font>ReadLn<font color="#000080">( </font>OldFile<font color="#000080">, </font>Line <font color="#000080">);
    </font>TrimPlus<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>StrCopy<font color="#000080">( </font>Line<font color="#000080">, </font>tmp <font color="#000080">);             </font><font color="#008000"><i>{ copy to temp string     }
  </i></font>LTrim<font color="#000080">( </font>tmp <font color="#000080">);                     </font><font color="#008000"><i>{ remove leading spaces   }
  </i></font>Lower<font color="#000080">( </font>tmp <font color="#000080">);                     </font><font color="#008000"><i>{ translate to lower case }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ TestLine }


</i></font><font color="#FF0000"><b>begin
  if </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then             </b></font><font color="#008000"><i>{ parameters file1 file2 }
  </i></font><font color="#FF0000"><b>begin
    </b></font>Fname1 <font color="#000080">:= </font>FExpand<font color="#000080">( </font>ParamStr<font color="#000080">( </font><font color="#800000">1 </font><font color="#000080">) );
    </font>Fname2 <font color="#000080">:= </font>FExpand<font color="#000080">( </font>ParamStr<font color="#000080">( </font><font color="#800000">2 </font><font color="#000080">) );
    </font>tel <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>FileExist<font color="#000080">( </font>Fname1 <font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      if </b></font>OpenTextFile<font color="#000080">( </font>OldFile<font color="#000080">, </font>Fname1<font color="#000080">, </font>OldBuf <font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        if </b></font>CreateTextFile<font color="#000080">( </font>NewFile<font color="#000080">, </font>Fname2<font color="#000080">, </font>NewBuf <font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          </b></font>ReadLn<font color="#000080">( </font>OldFile<font color="#000080">, </font>Line1 <font color="#000080">);

          </font><font color="#FF0000"><b>if not </b></font>Eof<font color="#000080">( </font>OldFile <font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>IOResult <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>then
          begin
            </b></font>TestLine<font color="#000080">( </font>Line1<font color="#000080">, </font>tmp1 <font color="#000080">);
            </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">( </font>Line1 <font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
            begin
              </b></font>WriteLn<font color="#000080">( </font>NewFile<font color="#000080">, </font>Line1 <font color="#000080">);
              </font>tel <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font>ReadLn<font color="#000080">( </font>OldFile<font color="#000080">, </font>Line2 <font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

          </font><font color="#FF0000"><b>while not </b></font>Eof<font color="#000080">( </font>OldFile <font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>IOResult <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>do
          begin
            </b></font>TestLine<font color="#000080">( </font>Line2<font color="#000080">, </font>tmp2 <font color="#000080">);
            </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>length<font color="#000080">( </font>Line2 <font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>tmp1 <font color="#000080">&lt;&gt; </font>tmp2<font color="#000080">) </font><font color="#FF0000"><b>then
            begin
              </b></font>StrCopy<font color="#000080">( </font>Line2<font color="#000080">, </font>Line1 <font color="#000080">);         </font><font color="#008000"><i>{ copy Line2 to Line1 }
              </i></font>StrCopy<font color="#000080">( </font>tmp2<font color="#000080">, </font>tmp1 <font color="#000080">);           </font><font color="#008000"><i>{ copy tmp2  to tmp1  }
              </i></font>WriteLn<font color="#000080">( </font>NewFile<font color="#000080">, </font>Line1 <font color="#000080">);
              </font>inc<font color="#000080">( </font>tel <font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font>ReadLn<font color="#000080">( </font>OldFile<font color="#000080">, </font>Line2 <font color="#000080">);
          </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{while not eof}</i></font><font color="#000080">;

          </font>TestLine<font color="#000080">( </font>Line2<font color="#000080">, </font>tmp2 <font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>length<font color="#000080">( </font>Line2 <font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>tmp1 <font color="#000080">&lt;&gt; </font>tmp2<font color="#000080">) </font><font color="#FF0000"><b>then
          begin
            </b></font>WriteLn<font color="#000080">( </font>NewFile<font color="#000080">, </font>Line2 <font color="#000080">);
            </font>inc<font color="#000080">( </font>tel <font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

          </font>writeln <font color="#000080">(</font>tel<font color="#000080">, </font><font color="#800000">' unique lines'</font><font color="#000080">);
          </font>Close<font color="#000080">( </font>NewFile <font color="#000080">);
          </font>Close<font color="#000080">( </font>OldFile <font color="#000080">);
        </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if create file2 }
        </i></font><font color="#FF0000"><b>else
          </b></font>writeln<font color="#000080">(</font><font color="#800000">' error creating file '</font><font color="#000080">, </font>Fname1 <font color="#000080">);
        </font><font color="#008000"><i>{ error creating file }
      </i></font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if open file1 }
      </i></font><font color="#FF0000"><b>else
        </b></font>writeln<font color="#000080">(</font><font color="#800000">' error opening file '</font><font color="#000080">, </font>Fname1 <font color="#000080">);
      </font><font color="#008000"><i>{ error opening file }
    </i></font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if FileExist( Fname1 ) }
    </i></font><font color="#FF0000"><b>else
      </b></font>writeln<font color="#000080">( </font>Fname1<font color="#000080">, </font><font color="#800000">' not found' </font><font color="#000080">);
    </font><font color="#008000"><i>{ file not found }
  </i></font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ if ParamCount &gt; 1 }
  </i></font><font color="#FF0000"><b>else
    </b></font>Writeln<font color="#000080">( </font><font color="#800000">'Dup file1 file2' </font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p></body>
</html>
