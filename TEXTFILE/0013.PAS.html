<html>
<head><title> "An OOP FILELIST Unit" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>PROGRAM </b></font>FileListDemo<font color="#000080">;          </font><font color="#008000"><i>{FILELIST.PAS}

</i></font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">, </font>Printer<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>Action <font color="#000080">= (</font>Input<font color="#000080">, </font>Output<font color="#000080">);
  </font>TextObj <font color="#000080">= </font><font color="#FF0000"><b>OBJECT
    </b></font>fp <font color="#000080">: </font>text<font color="#000080">;
    </font>LineCount <font color="#000080">: </font>integer<font color="#000080">;
    </font>EndOfFile <font color="#000080">: </font>boolean<font color="#000080">;
    </font><font color="#FF0000"><b>CONSTRUCTOR </b></font>OpenFile<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                        </font>FileAction<font color="#000080">: </font>Action<font color="#000080">);
    </font><font color="#FF0000"><b>PROCEDURE </b></font>ReadLine<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>TextLine<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>PROCEDURE </b></font>WriteLine<font color="#000080">(</font>TextLine<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>PROCEDURE </b></font>PrintLine<font color="#000080">(</font>TextLine<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>PROCEDURE </b></font>FillBlanks<font color="#000080">;
    </font><font color="#FF0000"><b>FUNCTION </b></font>Done<font color="#000080">: </font>boolean<font color="#000080">;
    </font><font color="#FF0000"><b>DESTRUCTOR </b></font>CloseFile<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>CONSTRUCTOR </b></font>TextObj<font color="#000080">.</font>OpenFile<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Assign<font color="#000080">(</font>fp<font color="#000080">, </font>FileName<font color="#000080">);
  </font><font color="#FF0000"><b>CASE </b></font>FileAction <font color="#FF0000"><b>of
    </b></font>Input<font color="#000080">:
      </font><font color="#FF0000"><b>BEGIN
        </b></font>LineCount <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>Reset<font color="#000080">(</font>fp<font color="#000080">);
        </font><font color="#FF0000"><b>IF </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
          BEGIN
            </b></font>writeln<font color="#000080">(</font>FileName<font color="#000080">, </font><font color="#800000">' not found!'</font><font color="#000080">);
            </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>writeln<font color="#000080">(</font>FileName<font color="#000080">, </font><font color="#800000">' opened for read...'</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>Output<font color="#000080">:
      </font><font color="#FF0000"><b>BEGIN
        </b></font>Rewrite<font color="#000080">(</font>fp<font color="#000080">);
        </font>WriteLn<font color="#000080">(</font>FileName<font color="#000080">, </font><font color="#800000">' opened for write...'</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{CASE}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>DESTRUCTOR </b></font>TextObj<font color="#000080">.</font>CloseFile<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Close<font color="#000080">(</font>fp<font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'File closed...'</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TextObj<font color="#000080">.</font>ReadLine<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>ReadLn<font color="#000080">(</font>fp<font color="#000080">, </font>TextLine<font color="#000080">);
  </font>EndOfFile <font color="#000080">:= </font>Eof<font color="#000080">(</font>fp<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TextObj<font color="#000080">.</font>WriteLine<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>WriteLn<font color="#000080">(</font>fp<font color="#000080">, </font>TextLine<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TextObj<font color="#000080">.</font>PrintLine<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF not </b></font>EndOfFile <font color="#FF0000"><b>THEN
  BEGIN
    IF </b></font>TextLine<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'}' </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>WriteLn<font color="#000080">(</font>lst<font color="#000080">, </font>TextLine<font color="#000080">);
        </font>Inc<font color="#000080">(</font>LineCount<font color="#000080">);
      </font><font color="#FF0000"><b>END ELSE </b></font>FillBlanks<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TextObj<font color="#000080">.</font>FillBlanks<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  FOR </b></font>i <font color="#000080">:= </font>LineCount <font color="#FF0000"><b>TO </b></font><font color="#800000">6 </font><font color="#FF0000"><b>DO </b></font>WriteLn<font color="#000080">(</font>lst<font color="#000080">);
  </font>LineCount <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>TextObj<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Done <font color="#000080">:= </font>EndOfFile<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>InFile<font color="#000080">: </font>TextObj<font color="#000080">;
  </font>TextLine<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>ClrScr<font color="#000080">;
  </font><font color="#FF0000"><b>WITH </b></font>InFile <font color="#FF0000"><b>DO
    BEGIN
      </b></font>OpenFile<font color="#000080">(</font><font color="#800000">'DUMMY.DAT'</font><font color="#000080">, </font>Input<font color="#000080">);
      </font><font color="#FF0000"><b>REPEAT
        </b></font>ReadLine<font color="#000080">(</font>TextLine<font color="#000080">);
        </font>PrintLine<font color="#000080">(</font>TextLine<font color="#000080">);
      </font><font color="#FF0000"><b>UNTIL </b></font>Done<font color="#000080">;
      </font>CloseFile<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Write<font color="#000080">(</font><font color="#800000">'Press Enter to quit...'</font><font color="#000080">); </font>ReadLn<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p></body>
</html>
