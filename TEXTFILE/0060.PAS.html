<html>
<head><title> "Text File Browser" by DANIEL PERRENOUD</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0060.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: Daniel Perrenoud &lt;dperren@msswiss.kla.com&gt;

As promised, here is the PASCAL program able to walk through a text file of
any size. It is ready to compile and contains a short example explaining how
to use the routines. The instructions are included in the source itself. If
you like it, feel free to add this file to the next release of the SWAG
libraries. I will keep working on new features and bug fixes for this
program. Let me know if you are interested on receiving the future releases.


[[ FILEBRWS.PAS : 2886 in FILEBRWS.PAS ]]

Best regards,            Daniel

{
**************************************************************************
*                                                                        *
*     File Browser Package V1.0       by Daniel Perrenoud                *
*     ~~~~~~~~~~~~~~~~~~~~~~~~~                                          *
*     o Released to the Public domain, feel free to use and copy         *
*       this program without any restriction.                            *
*     o Please credit me if your program uses these routines.            *
*     o Your comments are welcome. You can contact me on                 *
*                                  e-mail: d_perren@kla.com              *
*                                                                        *
*                                  or by post:                           *
*                                                                        *
*                                  Daniel Perrenoud                      *
*                                  Mont-Pugin 8                          *
*                                  CH-2400 Le Locle                      *
*                                  SWITZERLAND                           *
*                                                                        *
*     !!! Please compile me with range checking turned OFF  !!!          *
*                                                                        *
 *                                                                        *
**************************************************************************

This set of routine makes possible to display and walk through a text file
of any length. The content of the currently selected line as well as the
selected line number are available in global variables. The text file is
diplayed in a window fully parametrable by the user (position, size,
color). For better performance, use File Browser together with a disk
caching program like MS-DOS SmartDrive.

Six functions and procedures are available for File Browser control:


---&gt; Procedure InitFB(FN:str255;WUX,WUY,WLX,WLY,BC,FC,SBC,SFC:Word)
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     InitFB initialises the File Browser and displays the first screen
     of the file. The first line is selected.

     Parameters:  FN:       Path and file name to display (MS-DOS format)
                  WUX,WUY:  Upper left corner of the window
                  WLX,WLY:  Lower right corner of the window
                  BC:       Background color of normal text
                  FC:       Foreground color of normal text
                   SBC:      Background color of selected line
                  SFC:      Foreground color of selected line



---&gt; Function UpArrow:Boolean
     ~~~~~~~~~~~~~~~~~~~~~~~~

     UpArrow tries to select the previous line. It returns FALSE if the
     previous line is not selectable because the top line is already
     selected.



---&gt; Function DnArrow:Boolean
     ~~~~~~~~~~~~~~~~~~~~~~~~

     DnArrow tries to select the next line. It returns FALSE if the
     next line is not selectable because the bottom line is already
     selected.



 ---&gt; Function PgUp:Boolean
     ~~~~~~~~~~~~~~~~~~~~~

     PgUp tries to display the previous screen of text. If the top line
     is reached before one complete screen has scrolled, PgUp returns
     FALSE and only the possible number of lines is scrolled.



---&gt; Function PgDn:Boolean
     ~~~~~~~~~~~~~~~~~~~~~

     PgDn tries to display the next screen of text. If the bottom line
     is reached before one complete screen has scrolled, PgDn returns
     FALSE and only the possible number of lines is scrolled.



---&gt; Procedure CloseFB
     ~~~~~~~~~~~~~~~~~

     CloseFB stops File Browser activity. It must be used when FB is
     no longer used in order to close the open files.


The status of File Browser can be read through two variables:


---&gt; SelAbsInd:Longint
     ~~~~~~~~~~~~~~~~~
     Selected line number. SelAbsInd=0 if the first line is selected.


---&gt; Image[SelCirInd]:Str255

     ~~~~~~~~~~~~~~~~~~~~~~~

     Text of selected line. The CR or LF charaters have been removed.



This file is ready to be compiled by TP4.0 or better. A short example is
included, showing how FB works.

CAUTION: FB routines change the window attributs by using the PASCAL
         WINDOW procedure.


Future extensions:
~~~~~~~~~~~~~~~~~~
o Left and right scrolling to display long lines
o Direct access to a specific line number
o Find text module
o Tag-untag line handling
o Mouse support
o Speed improvement by writing some ASM modules.
o A decent error handling!

Let me know if you have other ideas ( e-mail: d_perren@kla.com )
}





</i></font><font color="#FF0000"><b>program </b></font>FileBrws<font color="#000080">;

</font><font color="#FF0000"><b>uses           </b></font>DOS<font color="#000080">,</font>CRT<font color="#000080">;

 </font><font color="#FF0000"><b>type  </b></font>Str255<font color="#000080">=</font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">255</font><font color="#000080">];

</font><font color="#FF0000"><b>const </b></font>NbRec<font color="#000080">=        </font><font color="#800000">255</font><font color="#000080">;
      </font>FrontCst<font color="#000080">=     </font><font color="#800000">0</font><font color="#000080">;
      </font>BackCst<font color="#000080">=      </font><font color="#800000">1</font><font color="#000080">;
      </font>CRcst<font color="#000080">=        </font><font color="#800000">$0D</font><font color="#000080">;
      </font>LFcst<font color="#000080">=        </font><font color="#800000">$0A</font><font color="#000080">;


</font><font color="#FF0000"><b>var   </b></font>FileBrowse<font color="#000080">:                               </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of File</b></font><font color="#000080">;
      </font>CurLine<font color="#000080">,</font>Packet<font color="#000080">:                           </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Str255<font color="#000080">;
      </font>Image<font color="#000080">:                                    </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Str255<font color="#000080">;
      </font>PacketInd<font color="#000080">,</font>Numread<font color="#000080">:                        </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word<font color="#000080">;
      </font>FirstCirInd<font color="#000080">,</font>ScrInd<font color="#000080">,</font>SelCirInd<font color="#000080">:             </font>Word<font color="#000080">;
      </font>MaxLine<font color="#000080">,</font>VWUX<font color="#000080">,</font>VWUY<font color="#000080">,</font>VWLX<font color="#000080">,</font>VWLY<font color="#000080">:              </font>Word<font color="#000080">;
      </font>ColListBG<font color="#000080">,</font>ColListFG<font color="#000080">,</font>ColSListBG<font color="#000080">,</font>ColSListFG<font color="#000080">:</font>Word<font color="#000080">;
      </font>Ch<font color="#000080">,</font>TmpChar<font color="#000080">:                               </font>Char<font color="#000080">;
      </font>EndFile<font color="#000080">,</font>EOP<font color="#000080">,</font>Again<font color="#000080">,</font>Dummy<font color="#000080">,</font>ExtKey<font color="#000080">:           </font>Boolean<font color="#000080">;
      </font>FileName<font color="#000080">:                                 </font>Str255<font color="#000080">;
      </font>FilLinNum<font color="#000080">:                                </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Longint<font color="#000080">;
      </font>SelAbsInd<font color="#000080">:                                </font>Longint<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>WaitKey<font color="#000080">:</font>Char<font color="#000080">;
 </font><font color="#FF0000"><b>var   </b></font>WK<font color="#000080">:         </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ExtKey<font color="#000080">:=</font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
  until </b></font>keypressed<font color="#000080">;
  </font>WK<font color="#000080">:=</font>ReadKey<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>WK<font color="#000080">=</font><font color="#800000">#0 </font><font color="#FF0000"><b>then
  begin
    </b></font>ExtKey<font color="#000080">:=</font>TRUE<font color="#000080">;
    </font>WK<font color="#000080">:=</font>ReadKey<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>WaitKey<font color="#000080">:=</font>WK
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Initialize<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>assign<font color="#000080">(</font>FileBrowse<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>FileName<font color="#000080">);
  </font>assign<font color="#000080">(</font>FileBrowse<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>FileName<font color="#000080">);
  </font>assign<font color="#000080">(</font>FileBrowse<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>FileName<font color="#000080">);
  </font>reset<font color="#000080">(</font>FileBrowse<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);
  </font>reset<font color="#000080">(</font>FileBrowse<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);
  </font>reset<font color="#000080">(</font>FileBrowse<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);
  </font>window<font color="#000080">(</font>VWUX<font color="#000080">,</font>VWUY<font color="#000080">,</font>VWLX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>VWLY<font color="#000080">);
   </font>ClrScr<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CloseFB<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>close<font color="#000080">(</font>FileBrowse<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
  </font>close<font color="#000080">(</font>FileBrowse<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
  </font>close<font color="#000080">(</font>FileBrowse<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadPrevPacket<font color="#000080">(</font>FN<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>seek<font color="#000080">(</font>FileBrowse<font color="#000080">[</font>FN<font color="#000080">],(</font>FilePos<font color="#000080">(</font>FileBrowse<font color="#000080">[</font>FN<font color="#000080">])-</font>Numread<font color="#000080">[</font>FN<font color="#000080">]-</font>NbRec<font color="#000080">));
  </font>blockread<font color="#000080">(</font>FileBrowse<font color="#000080">[</font>FN<font color="#000080">],</font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">1</font><font color="#000080">],</font>NbRec<font color="#000080">,</font>Numread<font color="#000080">[</font>FN<font color="#000080">]);
  </font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>Numread<font color="#000080">[</font>FN<font color="#000080">]);
  </font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]:=</font>NbRec<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ReadNextLine<font color="#000080">(</font>FN<font color="#000080">:</font>integer<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var   </b></font>EOP<font color="#000080">:        </font>Boolean<font color="#000080">;
      </font>CurLinInd<font color="#000080">:  </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>ReadNextLine<font color="#000080">:=</font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>EndFile<font color="#000080">=</font>FALSE<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>FN<font color="#000080">=</font>BackCst<font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>CurLinInd<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>repeat
      repeat
        </b></font>TmpChar<font color="#000080">:=</font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]];
        </font>CurLine<font color="#000080">[</font>FN<font color="#000080">][</font>CurLinInd<font color="#000080">]:=</font>TmpChar<font color="#000080">;
        </font>inc<font color="#000080">(</font>CurLinInd<font color="#000080">);
        </font>inc<font color="#000080">(</font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]);
        </font>EOP<font color="#000080">:=(</font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]&gt;</font>Length<font color="#000080">(</font>Packet<font color="#000080">[</font>FN<font color="#000080">]))
      </font><font color="#FF0000"><b>until </b></font><font color="#000080">((</font>ord<font color="#000080">(</font>TmpChar<font color="#000080">)=</font>CRcst<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>EOP<font color="#000080">));
      </font><font color="#FF0000"><b>if </b></font>EOP <font color="#FF0000"><b>then
        if </b></font>Numread<font color="#000080">[</font>FN<font color="#000080">]&lt;&gt;</font>NbRec <font color="#FF0000"><b>then
          </b></font>EndFile<font color="#000080">:=</font>TRUE
        <font color="#FF0000"><b>else
          begin
            </b></font>blockread<font color="#000080">(</font>FileBrowse<font color="#000080">[</font>FN<font color="#000080">],</font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">1</font><font color="#000080">],</font>NbRec<font color="#000080">,</font>Numread<font color="#000080">[</font>FN<font color="#000080">]);
            </font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>Numread<font color="#000080">[</font>FN<font color="#000080">]);
            </font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font><font color="#000080">((</font>ord<font color="#000080">(</font>TmpChar<font color="#000080">)=</font>CRcst<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>EndFile<font color="#000080">));
    </font>ReadNextLine<font color="#000080">:=</font>TRUE<font color="#000080">;
     </font>inc<font color="#000080">(</font>FilLinNum<font color="#000080">[</font>FN<font color="#000080">]);
    </font>CurLine<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>CurLinInd<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Read1stLine<font color="#000080">(</font>FN<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var   </b></font>CurLinInd<font color="#000080">:  </font>Word<font color="#000080">;
      </font>EOP<font color="#000080">:        </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>EndFile<font color="#000080">:=</font>FALSE<font color="#000080">;
  </font>reset<font color="#000080">(</font>FileBrowse<font color="#000080">[</font>FN<font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);
  </font>blockread<font color="#000080">(</font>FileBrowse<font color="#000080">[</font>FN<font color="#000080">],</font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">1</font><font color="#000080">],</font>NbRec<font color="#000080">,</font>Numread<font color="#000080">[</font>FN<font color="#000080">]);
  </font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>Numread<font color="#000080">[</font>FN<font color="#000080">]);
  </font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
  </font>CurLinInd<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    repeat
      </b></font>TmpChar<font color="#000080">:=</font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]];
      </font>CurLine<font color="#000080">[</font>FN<font color="#000080">][</font>CurLinInd<font color="#000080">]:=</font>TmpChar<font color="#000080">;
      </font>inc<font color="#000080">(</font>CurLinInd<font color="#000080">);
      </font>inc<font color="#000080">(</font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]);
       </font>EOP<font color="#000080">:=(</font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]&gt;</font>Length<font color="#000080">(</font>Packet<font color="#000080">[</font>FN<font color="#000080">]))
    </font><font color="#FF0000"><b>until </b></font><font color="#000080">((</font>ord<font color="#000080">(</font>TmpChar<font color="#000080">)=</font>CRcst<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>EOP<font color="#000080">));
    </font><font color="#FF0000"><b>if </b></font>EOP <font color="#FF0000"><b>then
      if </b></font>Numread<font color="#000080">[</font>FN<font color="#000080">]&lt;&gt;</font>NbRec <font color="#FF0000"><b>then
        </b></font>EndFile<font color="#000080">:=</font>TRUE
      <font color="#FF0000"><b>else
        begin
          </b></font>blockread<font color="#000080">(</font>FileBrowse<font color="#000080">[</font>FN<font color="#000080">],</font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">1</font><font color="#000080">],</font>NbRec<font color="#000080">,</font>Numread<font color="#000080">[</font>FN<font color="#000080">]);
          </font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>Numread<font color="#000080">[</font>FN<font color="#000080">]);
          </font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font><font color="#000080">((</font>ord<font color="#000080">(</font>TmpChar<font color="#000080">)=</font>CRcst<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>EndFile<font color="#000080">));
  </font>CurLine<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>CurLinInd<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
  </font>FilLinNum<font color="#000080">[</font>FN<font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>ReadPrevLine<font color="#000080">(</font>FN<font color="#000080">:</font>integer<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var   </b></font>Dummy<font color="#000080">:      </font>Boolean<font color="#000080">;
      </font>CurLinInd<font color="#000080">:  </font>Word<font color="#000080">;
      </font>i<font color="#000080">:          </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>CurLinInd<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>ReadPrevLine<font color="#000080">:=</font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>FilLinNum<font color="#000080">[</font>FN<font color="#000080">]&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    if </b></font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then
      </b></font>dec<font color="#000080">(</font>PacketInd<font color="#000080">[</font>FN<font color="#000080">])
    </font><font color="#FF0000"><b>else
      </b></font>ReadPrevPacket<font color="#000080">(</font>FN<font color="#000080">);
    </font>TmpChar<font color="#000080">:=</font><font color="#800000">' '</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">2 </font><font color="#FF0000"><b>do
    begin
      while </b></font><font color="#000080">(</font>ord<font color="#000080">(</font>TmpChar<font color="#000080">)&lt;&gt;</font>CRcst<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>FilLinNum<font color="#000080">[</font>FN<font color="#000080">]&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or
</b></font><font color="#000080">(</font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]&lt;&gt;</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>do
      begin
        if </b></font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then
          </b></font>dec<font color="#000080">(</font>PacketInd<font color="#000080">[</font>FN<font color="#000080">])
        </font><font color="#FF0000"><b>else
          </b></font>ReadPrevPacket<font color="#000080">(</font>FN<font color="#000080">);
        </font>TmpChar<font color="#000080">:=</font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]];
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>TmpChar<font color="#000080">:=</font><font color="#800000">' '</font><font color="#000080">;
      </font>dec<font color="#000080">(</font>FilLinNum<font color="#000080">[</font>FN<font color="#000080">]);
      </font>EndFile<font color="#000080">:=</font>FALSE<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>FilLinNum<font color="#000080">[</font>FN<font color="#000080">]&lt;&gt;-</font><font color="#800000">1 </font><font color="#FF0000"><b>then
      </b></font>inc<font color="#000080">(</font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]&gt;</font>Length<font color="#000080">(</font>Packet<font color="#000080">[</font>FN<font color="#000080">]) </font><font color="#FF0000"><b>then
    begin
      </b></font>blockread<font color="#000080">(</font>FileBrowse<font color="#000080">[</font>FN<font color="#000080">],</font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">1</font><font color="#000080">],</font>NbRec<font color="#000080">,</font>Numread<font color="#000080">[</font>FN<font color="#000080">]);
      </font>Packet<font color="#000080">[</font>FN<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>Numread<font color="#000080">[</font>FN<font color="#000080">]);
      </font>PacketInd<font color="#000080">[</font>FN<font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Dummy<font color="#000080">:=</font>ReadNextLine<font color="#000080">(</font>FN<font color="#000080">);
    </font>ReadPrevLine<font color="#000080">:=</font>TRUE<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>CleanString<font color="#000080">(</font>ALine<font color="#000080">:</font>str255<font color="#000080">):</font>str255<font color="#000080">;
</font><font color="#FF0000"><b>var   </b></font>i<font color="#000080">,</font>j<font color="#000080">:        </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>j<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>i<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    if </b></font><font color="#000080">(</font>ord<font color="#000080">(</font>ALine<font color="#000080">[</font>i<font color="#000080">])&lt;&gt;</font>CRcst<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>ord<font color="#000080">(</font>ALine<font color="#000080">[</font>i<font color="#000080">])&lt;&gt;</font>LFcst<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>CleanString<font color="#000080">[</font>j<font color="#000080">]:=</font>ALine<font color="#000080">[</font>i<font color="#000080">];
      </font>inc<font color="#000080">(</font>j<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>inc<font color="#000080">(</font>i<font color="#000080">);
   </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>i<font color="#000080">&gt;</font>ord<font color="#000080">(</font>ALine<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>j<font color="#000080">&gt;</font>VWLX<font color="#000080">-</font>VWUX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>CleanString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>DispSelLine<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>TextBackground<font color="#000080">(</font>ColSListBG<font color="#000080">);
  </font>TextColor<font color="#000080">(</font>ColSListFG<font color="#000080">);
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>ScrInd<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>write<font color="#000080">(</font>Image<font color="#000080">[</font>SelCirInd<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>UndispSelLine<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>TextBackground<font color="#000080">(</font>ColListBG<font color="#000080">);
  </font>TextColor<font color="#000080">(</font>ColListFG<font color="#000080">);
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>ScrInd<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>write<font color="#000080">(</font>Image<font color="#000080">[</font>SelCirInd<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>IncMod<font color="#000080">(</font>i<font color="#000080">:</font>Word<font color="#000080">):</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>begin
    </b></font>IncMod<font color="#000080">:=(</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>MaxLine<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>DecMod<font color="#000080">(</font>i<font color="#000080">:</font>Word<font color="#000080">):</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>begin
    </b></font>DecMod<font color="#000080">:=(</font>i<font color="#000080">+</font>MaxLine<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>MaxLine<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>RefreshScreen<font color="#000080">;
</font><font color="#FF0000"><b>var   </b></font>CleanLine<font color="#000080">:  </font>Str255<font color="#000080">;
      </font>i<font color="#000080">,</font>j<font color="#000080">:        </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>i<font color="#000080">:=</font>FirstCirInd<font color="#000080">;
  </font>j<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>TextBackground<font color="#000080">(</font>ColListBG<font color="#000080">);
  </font>TextColor<font color="#000080">(</font>ColListFG<font color="#000080">);
  </font>ClrScr<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>j<font color="#000080">);
    </font>write<font color="#000080">(</font>Image<font color="#000080">[</font>i<font color="#000080">]);
    </font>i<font color="#000080">:=</font>IncMod<font color="#000080">(</font>i<font color="#000080">);
    </font>inc<font color="#000080">(</font>j<font color="#000080">);
  </font><font color="#FF0000"><b>until </b></font>i<font color="#000080">=</font>FirstCirInd<font color="#000080">;
  </font>DispSelLine<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>FirstScreen<font color="#000080">;
</font><font color="#FF0000"><b>var   </b></font>CleanLine<font color="#000080">:  </font>Str255<font color="#000080">;
      </font>i<font color="#000080">:          </font>Integer<font color="#000080">;
      </font>LineOK<font color="#000080">:     </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>FirstCirInd<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>Read1stLine<font color="#000080">(</font>FrontCst<font color="#000080">);
  </font>CleanLine<font color="#000080">:=</font>CleanString<font color="#000080">(</font>CurLine<font color="#000080">[</font>FrontCst<font color="#000080">]);
  </font>Image<font color="#000080">[</font>FirstCirInd<font color="#000080">]:=</font>CleanLine<font color="#000080">;
   </font>TextBackground<font color="#000080">(</font>ColListBG<font color="#000080">);
  </font>TextColor<font color="#000080">(</font>ColListFG<font color="#000080">);
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>FirstCirInd<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>write<font color="#000080">(</font>CleanLine<font color="#000080">);
  </font>FirstCirInd<font color="#000080">:=</font>IncMod<font color="#000080">(</font>FirstCirInd<font color="#000080">);
  </font><font color="#FF0000"><b>repeat
    </b></font>LineOK<font color="#000080">:=</font>ReadNextLine<font color="#000080">(</font>FrontCst<font color="#000080">);
    </font>CleanLine<font color="#000080">:=</font>CleanString<font color="#000080">(</font>CurLine<font color="#000080">[</font>FrontCst<font color="#000080">]);
    </font>Image<font color="#000080">[</font>FirstCirInd<font color="#000080">]:=</font>CleanLine<font color="#000080">;
    </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>FirstCirInd<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
    </font>write<font color="#000080">(</font>CleanLine<font color="#000080">);
    </font>FirstCirInd<font color="#000080">:=</font>IncMod<font color="#000080">(</font>FirstCirInd<font color="#000080">);
  </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>FirstCirInd<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>LineOK<font color="#000080">=</font>FALSE<font color="#000080">);
  </font>Read1stLine<font color="#000080">(</font>BackCst<font color="#000080">);
  </font>SelCirInd<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>SelAbsInd<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>ScrInd<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>DispSelLine<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>ScrollUp<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var   </b></font>IsScrolled<font color="#000080">: </font>Boolean<font color="#000080">;
       </font>Dummy<font color="#000080">:      </font>Boolean<font color="#000080">;
      </font>CleanLine<font color="#000080">:  </font>Str255<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>IsScrolled<font color="#000080">:=</font>ReadNextLine<font color="#000080">(</font>FrontCst<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>IsScrolled <font color="#FF0000"><b>then
  begin
    </b></font>CleanLine<font color="#000080">:=</font>CleanString<font color="#000080">(</font>CurLine<font color="#000080">[</font>FrontCst<font color="#000080">]);
    </font>Image<font color="#000080">[</font>FirstCirInd<font color="#000080">]:=</font>CleanLine<font color="#000080">;
    </font>FirstCirInd<font color="#000080">:=</font>IncMod<font color="#000080">(</font>FirstCirInd<font color="#000080">);
    </font>TextBackground<font color="#000080">(</font>ColListBG<font color="#000080">);
    </font>TextColor<font color="#000080">(</font>ColListFG<font color="#000080">);
    </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font>DelLine<font color="#000080">;
    </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>MaxLine<font color="#000080">);
    </font>write<font color="#000080">(</font>CleanLine<font color="#000080">);
    </font>Dummy<font color="#000080">:=</font>ReadNextLine<font color="#000080">(</font>BackCst<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ScrollUp<font color="#000080">:=</font>IsScrolled<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>ScrollDn<font color="#000080">:</font>Boolean<font color="#000080">;
 </font><font color="#FF0000"><b>var   </b></font>IsScrolled<font color="#000080">: </font>Boolean<font color="#000080">;
      </font>Dummy<font color="#000080">:      </font>Boolean<font color="#000080">;
      </font>CleanLine<font color="#000080">:  </font>Str255<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>IsScrolled<font color="#000080">:=</font>ReadPrevLine<font color="#000080">(</font>BackCst<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>IsScrolled <font color="#FF0000"><b>then
  begin
    </b></font>CleanLine<font color="#000080">:=</font>CleanString<font color="#000080">(</font>CurLine<font color="#000080">[</font>BackCst<font color="#000080">]);
    </font>FirstCirInd<font color="#000080">:=</font>DecMod<font color="#000080">(</font>FirstCirInd<font color="#000080">);
    </font>Image<font color="#000080">[</font>FirstCirInd<font color="#000080">]:=</font>CleanLine<font color="#000080">;
    </font>TextBackground<font color="#000080">(</font>ColListBG<font color="#000080">);
    </font>TextColor<font color="#000080">(</font>ColListFG<font color="#000080">);
    </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font>InsLine<font color="#000080">;
    </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font>write<font color="#000080">(</font>CleanLine<font color="#000080">);
    </font>Dummy<font color="#000080">:=</font>ReadPrevLine<font color="#000080">(</font>FrontCst<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ScrollDn<font color="#000080">:=</font>IsScrolled<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


 </font><font color="#FF0000"><b>Function </b></font>DnArrow<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var   </b></font>Success<font color="#000080">:    </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>window<font color="#000080">(</font>VWUX<font color="#000080">,</font>VWUY<font color="#000080">,</font>VWLX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>VWLY<font color="#000080">);
  </font>UndispSelLine<font color="#000080">;
  </font>Success<font color="#000080">:=</font>TRUE<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>IncMod<font color="#000080">(</font>SelCirInd<font color="#000080">)=</font>FirstCirInd <font color="#FF0000"><b>then
  begin
    </b></font>Success<font color="#000080">:=</font>ScrollUp<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Success <font color="#FF0000"><b>then
    begin
      </b></font>SelCirInd<font color="#000080">:=</font>IncMod<font color="#000080">(</font>SelCirInd<font color="#000080">);
      </font>inc<font color="#000080">(</font>SelAbsInd<font color="#000080">);
    </font><font color="#FF0000"><b>end
    else</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>SelCirInd<font color="#000080">:=</font>IncMod<font color="#000080">(</font>SelCirInd<font color="#000080">);
    </font>inc<font color="#000080">(</font>SelAbsInd<font color="#000080">);
    </font>inc<font color="#000080">(</font>ScrInd<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>DnArrow<font color="#000080">:=</font>Success<font color="#000080">;
  </font>DispSelLine<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>UpArrow<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var   </b></font>Success<font color="#000080">:    </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>window<font color="#000080">(</font>VWUX<font color="#000080">,</font>VWUY<font color="#000080">,</font>VWLX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>VWLY<font color="#000080">);
  </font>UndispSelLine<font color="#000080">;
  </font>Success<font color="#000080">:=</font>TRUE<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>SelCirInd<font color="#000080">=</font>FirstCirInd <font color="#FF0000"><b>then
  begin
    </b></font>Success<font color="#000080">:=</font>ScrollDn<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Success <font color="#FF0000"><b>then
    begin
      </b></font>SelCirInd<font color="#000080">:=</font>DecMod<font color="#000080">(</font>SelCirInd<font color="#000080">);
      </font>Dec<font color="#000080">(</font>SelAbsInd<font color="#000080">);
    </font><font color="#FF0000"><b>end
    else</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
   begin
    </b></font>SelCirInd<font color="#000080">:=</font>DecMod<font color="#000080">(</font>SelCirInd<font color="#000080">);
    </font>dec<font color="#000080">(</font>SelAbsInd<font color="#000080">);
    </font>dec<font color="#000080">(</font>ScrInd<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>UpArrow<font color="#000080">:=</font>Success<font color="#000080">;
  </font>DispSelLine<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>PgUp<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var   </b></font>Complete<font color="#000080">,</font>Dummy<font color="#000080">:   </font>Boolean<font color="#000080">;
      </font>i<font color="#000080">:                </font>Word<font color="#000080">;
      </font>CleanLine<font color="#000080">:        </font>Str255<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>window<font color="#000080">(</font>VWUX<font color="#000080">,</font>VWUY<font color="#000080">,</font>VWLX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>VWLY<font color="#000080">);
  </font>i<font color="#000080">:=</font>MaxLine<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>Complete<font color="#000080">:=</font>ReadPrevLine<font color="#000080">(</font>BackCst<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Complete <font color="#FF0000"><b>then
    begin
      </b></font>CleanLine<font color="#000080">:=</font>CleanString<font color="#000080">(</font>CurLine<font color="#000080">[</font>BackCst<font color="#000080">]);
       </font>FirstCirInd<font color="#000080">:=</font>DecMod<font color="#000080">(</font>FirstCirInd<font color="#000080">);
      </font>Image<font color="#000080">[</font>FirstCirInd<font color="#000080">]:=</font>CleanLine<font color="#000080">;
      </font>SelCirInd<font color="#000080">:=</font>DecMod<font color="#000080">(</font>SelCirInd<font color="#000080">);
      </font>Dec<font color="#000080">(</font>SelAbsInd<font color="#000080">);
      </font>Dec<font color="#000080">(</font>i<font color="#000080">);
      </font>Dummy<font color="#000080">:=</font>ReadPrevLine<font color="#000080">(</font>FrontCst<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>i<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Complete<font color="#000080">=</font>FALSE<font color="#000080">);
  </font>RefreshScreen<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>PgDn<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var   </b></font>Complete<font color="#000080">,</font>Dummy<font color="#000080">:   </font>Boolean<font color="#000080">;
      </font>i<font color="#000080">:                </font>Word<font color="#000080">;
      </font>CleanLine<font color="#000080">:        </font>Str255<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>window<font color="#000080">(</font>VWUX<font color="#000080">,</font>VWUY<font color="#000080">,</font>VWLX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>VWLY<font color="#000080">);
  </font>i<font color="#000080">:=</font>MaxLine<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>Complete<font color="#000080">:=</font>ReadNextLine<font color="#000080">(</font>FrontCst<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Complete <font color="#FF0000"><b>then
     begin
      </b></font>CleanLine<font color="#000080">:=</font>CleanString<font color="#000080">(</font>CurLine<font color="#000080">[</font>FrontCst<font color="#000080">]);
      </font>Image<font color="#000080">[</font>FirstCirInd<font color="#000080">]:=</font>CleanLine<font color="#000080">;
      </font>FirstCirInd<font color="#000080">:=</font>IncMod<font color="#000080">(</font>FirstCirInd<font color="#000080">);
      </font>SelCirInd<font color="#000080">:=</font>IncMod<font color="#000080">(</font>SelCirInd<font color="#000080">);
      </font>inc<font color="#000080">(</font>SelAbsInd<font color="#000080">);
      </font>Dec<font color="#000080">(</font>i<font color="#000080">);
      </font>Dummy<font color="#000080">:=</font>ReadNextLine<font color="#000080">(</font>BackCst<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>i<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Complete<font color="#000080">=</font>FALSE<font color="#000080">);
  </font>RefreshScreen<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>InitFB<font color="#000080">(</font>FN<font color="#000080">:</font>str255<font color="#000080">;</font>WUX<font color="#000080">,</font>WUY<font color="#000080">,</font>WLX<font color="#000080">,</font>WLY<font color="#000080">,</font>BC<font color="#000080">,</font>FC<font color="#000080">,</font>SBC<font color="#000080">,</font>SFC<font color="#000080">:</font>Word<font color="#000080">);

</font><font color="#FF0000"><b>begin
  </b></font>FileName<font color="#000080">:=</font>FN<font color="#000080">;
  </font>ColListBG<font color="#000080">:=</font>BC<font color="#000080">;
  </font>ColListFG<font color="#000080">:=</font>FC<font color="#000080">;
  </font>ColSListBG<font color="#000080">:=</font>SBC<font color="#000080">;
  </font>ColSListFG<font color="#000080">:=</font>SFC<font color="#000080">;
  </font>VWUX<font color="#000080">:=</font>WUX<font color="#000080">;
   </font>VWUY<font color="#000080">:=</font>WUY<font color="#000080">;
  </font>VWLX<font color="#000080">:=</font>WLX<font color="#000080">;
  </font>VWLY<font color="#000080">:=</font>WLY<font color="#000080">;
  </font>MaxLine<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">+</font>WLY<font color="#000080">-</font>WUY<font color="#000080">;
  </font>Initialize<font color="#000080">;
  </font>FirstScreen<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{------------------- END OF FILE BROWSER MODULE ---------------------------}

{
The following program shows a way to use the File Browser. It displays
its own source code (!!) and handles the arrows and PgUp PgDn keys.
The current line number and current line content are displayed on the
bottom line.
Be sure to place THIS source code (filebrws.pas) in the directory from
which you run this program!
Press q to quit.
}

</i></font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font>InitFB<font color="#000080">(</font><font color="#800000">'filebrws.pas'</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">70</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>Black<font color="#000080">,</font>LightGray<font color="#000080">,</font>LightGray<font color="#000080">,</font>Black<font color="#000080">);
   </font><font color="#FF0000"><b>repeat
    </b></font>Ch<font color="#000080">:=</font>WaitKey<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>ExtKey <font color="#FF0000"><b>then
    begin
      if </b></font>Ch<font color="#000080">=</font><font color="#800000">#80 </font><font color="#FF0000"><b>then </b></font>Dummy<font color="#000080">:=</font>DnArrow<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>Ch<font color="#000080">=</font><font color="#800000">#72 </font><font color="#FF0000"><b>then </b></font>Dummy<font color="#000080">:=</font>UpArrow<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>Ch<font color="#000080">=</font><font color="#800000">#73 </font><font color="#FF0000"><b>then </b></font>Dummy<font color="#000080">:=</font>PgUp<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>Ch<font color="#000080">=</font><font color="#800000">#81 </font><font color="#FF0000"><b>then </b></font>Dummy<font color="#000080">:=</font>PgDn<font color="#000080">;
      </font>window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
      </font>TextBackground<font color="#000080">(</font>ColListBG<font color="#000080">);
      </font>TextColor<font color="#000080">(</font>ColListFG<font color="#000080">);
      </font>write<font color="#000080">(</font>SelAbsInd<font color="#000080">);
      </font>write<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">);
      </font>write<font color="#000080">(</font>Image<font color="#000080">[</font>SelCirInd<font color="#000080">]);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>ExtKey<font color="#000080">=</font>FALSE<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Ch<font color="#000080">=</font><font color="#800000">'q'</font><font color="#000080">);
  </font>CloseFB<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0060.PAS">Original</a><b>]</b></p></body>
</html>
