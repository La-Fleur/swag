<html>
<head><title> "Line counter" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;I'm wondering if anyone can post me a source For another way to
&gt;find out the max lines in a Text File.
}

 {.$DEFinE DebugMode}

 {$ifDEF DebugMode}

   {$A+,B-,D+,E-,F-,G+,I+,L+,N-,O-,P-,Q+,R+,S+,T+,V+,X-}

 {$else}

   {$A+,B-,D-,E-,F-,G+,I-,L-,N-,O-,P-,Q-,R-,S-,T-,V-,X-}

 {$endif}

 {$M 1024,0,0}

</i></font><font color="#FF0000"><b>Program </b></font>LineCounter<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>co_LineFeed <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>byar_60K <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">61440</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>wo_Index<font color="#000080">,
  </font>wo_BytesRead <font color="#000080">: </font>Word<font color="#000080">;

  </font>lo_FileSize<font color="#000080">,
  </font>lo_BytesProc<font color="#000080">,
  </font>lo_LineCount <font color="#000080">: </font>LongInt<font color="#000080">;

  </font>fi_Temp      <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;

  </font>byar_Buffer  <font color="#000080">: </font>byar_60K<font color="#000080">;

</font><font color="#FF0000"><b>begin
              </b></font><font color="#008000"><i>(* Attempt to open TEST.doC File.                       *)
  </i></font>assign<font color="#000080">(</font>fi_Temp<font color="#000080">, </font><font color="#800000">'linecnt.pas'</font><font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>reset<font color="#000080">(</font>fi_Temp<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#008000"><i>{$I+}

              (* Check if attempt was sucessful.                      *)
  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ioresult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'ERRor opening TEST.doC File'</font><font color="#000080">);
      </font>halt
    <font color="#FF0000"><b>end</b></font><font color="#000080">;

              </font><font color="#008000"><i>(* Record the size in Bytes of TEST.doC .               *)
  </i></font>lo_FileSize <font color="#000080">:= </font>Filesize<font color="#000080">(</font>fi_Temp<font color="#000080">);

              </font><font color="#008000"><i>(* Initialize Variables.                                *)
  </i></font>lo_LineCount <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>lo_BytesProc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

              </font><font color="#008000"><i>(* Repeat Until entire File has been processed.         *)
  </i></font><font color="#FF0000"><b>Repeat
              </b></font><font color="#008000"><i>(* Read in all or a 60K chunk of TEST.doC into the      *)
              (* &quot;buffer&quot; For processing.                             *)
    </i></font>blockread<font color="#000080">(</font>fi_Temp<font color="#000080">, </font>byar_Buffer<font color="#000080">, </font>sizeof<font color="#000080">(</font>byar_60K<font color="#000080">), </font>wo_BytesRead<font color="#000080">);

              </font><font color="#008000"><i>(* Count the number of line-feed Characters in the      *)
              (* &quot;buffer&quot;.                                            *)
    </i></font><font color="#FF0000"><b>For </b></font>wo_Index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>wo_BytesRead <font color="#FF0000"><b>do
      if </b></font><font color="#000080">(</font>byar_Buffer<font color="#000080">[</font>wo_Index<font color="#000080">] = </font>co_LineFeed<font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>inc<font color="#000080">(</font>lo_LineCount<font color="#000080">);

              </font><font color="#008000"><i>(* Record the number of line-feeds found in the buffer. *)
    </i></font>inc<font color="#000080">(</font>lo_BytesProc<font color="#000080">, </font>wo_BytesRead<font color="#000080">)

  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>lo_BytesProc <font color="#000080">= </font>lo_FileSize<font color="#000080">);

              </font><font color="#008000"><i>(* Close the TEST.doC File.                             *)
  </i></font>close<font color="#000080">(</font>fi_Temp<font color="#000080">);

              </font><font color="#008000"><i>(* Display the results.                                 *)
  </i></font>Writeln<font color="#000080">(</font><font color="#800000">' total number of lines in LinECNT.PAS = '</font><font color="#000080">, </font>lo_LineCount<font color="#000080">)

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#008000"><i>{
  ...to find a specific line, you'll have to process the Text File up
  to the line you are after, then use a &quot;seek&quot; so that you can read
  in just this line into a String Variable. (You'll have to determine
  the length of the String, and then set the String's length-Byte.)
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p></body>
</html>
