<html>
<head><title> "Create a Dictionary of Unique Words" by STEVE ROGERS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0052.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
  Program MAKEDCT, written by Steve Rogers, 1991. Takes an ASCII text
  file as ParamStr(1) and creates a &quot;dictionary file&quot; of all the unique
  words in the input file. Feel free to use it all you want and mention
  my name if you feel like it... :)
}

</i></font><font color="#FF0000"><b>uses
  </b></font>dos<font color="#000080">,
  </font>strg<font color="#000080">;  </font><font color="#008000"><i>{ Eagle Performance Software's STRG unit. Shareware version is
           available on most TP oriented BBSs. If you use the shareware
           version your program will need to be compiled with $E+. }

</i></font><font color="#FF0000"><b>const
  </b></font>MAXPTR<font color="#000080">=</font><font color="#800000">5000</font><font color="#000080">; </font><font color="#008000"><i>{ Max string pointers before paging out to disk }

</i></font><font color="#FF0000"><b>type
  </b></font>pS20<font color="#000080">=^</font>tS20<font color="#000080">;
  </font>tS20<font color="#000080">=</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];

</font><font color="#FF0000"><b>var
  </b></font>f    <font color="#000080">: </font>text<font color="#000080">;
  </font>s<font color="#000080">,
  </font>s2   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>s_   <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MAXPTR<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>pS20<font color="#000080">;
  </font>i<font color="#000080">,
  </font>n    <font color="#000080">: </font>word<font color="#000080">;

  </font>ndx<font color="#000080">,
  </font>NTempFile
       <font color="#000080">: </font>byte<font color="#000080">;
  </font>max  <font color="#000080">: </font>tS20<font color="#000080">;

</font><font color="#008000"><i>{-----------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>QSort<font color="#000080">(</font>Lo<font color="#000080">,</font>Hi <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#008000"><i>(*
  Just a generic QuickSort using Eagle's string comparison routines
*)

</i></font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">,</font>j <font color="#000080">: </font>integer<font color="#000080">;
  </font>x<font color="#000080">,</font>y<font color="#000080">: </font>pS20<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>i<font color="#000080">:= </font>lo<font color="#000080">;
  </font>j<font color="#000080">:= </font>hi<font color="#000080">;
  </font>x<font color="#000080">:= </font>s_<font color="#000080">[(</font>lo<font color="#000080">+</font>hi<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">];
  </font><font color="#FF0000"><b>repeat
    while </b></font><font color="#000080">(</font>strcmp<font color="#000080">(</font>s_<font color="#000080">[</font>i<font color="#000080">]^,</font>x<font color="#000080">^,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">)&lt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>strcmp<font color="#000080">(</font>s_<font color="#000080">[</font>j<font color="#000080">]^,</font>x<font color="#000080">^,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>dec<font color="#000080">(</font>j<font color="#000080">);

    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>i<font color="#000080">&lt;=</font>j<font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>y<font color="#000080">:= </font>s_<font color="#000080">[</font>i<font color="#000080">];
      </font>s_<font color="#000080">[</font>i<font color="#000080">]:= </font>s_<font color="#000080">[</font>j<font color="#000080">];
      </font>s_<font color="#000080">[</font>j<font color="#000080">]:= </font>y<font color="#000080">;
      </font>inc<font color="#000080">(</font>i<font color="#000080">);
      </font>dec<font color="#000080">(</font>j<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>i<font color="#000080">&gt;</font>j<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>lo<font color="#000080">&lt;</font>j<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>qsort<font color="#000080">(</font>lo<font color="#000080">,</font>j<font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>i<font color="#000080">&lt;</font>hi<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>qsort<font color="#000080">(</font>i<font color="#000080">,</font>hi<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>WriteTempFile<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i <font color="#000080">: </font>word<font color="#000080">;
  </font>tempf <font color="#000080">: </font>text<font color="#000080">;
  </font>stmp   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>inc<font color="#000080">(</font>NTempFile<font color="#000080">);
  </font>qsort<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>n<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Filing to outfile #'</font><font color="#000080">,</font>NTempFile<font color="#000080">);
  </font>assign<font color="#000080">(</font>tempf<font color="#000080">,</font><font color="#800000">'wordtemp.'</font><font color="#000080">+</font>strl<font color="#000080">(</font>NTempFile<font color="#000080">));
  </font>rewrite<font color="#000080">(</font>tempf<font color="#000080">);
  </font>stmp<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do if </b></font><font color="#000080">(</font>strcmp<font color="#000080">(</font>s_<font color="#000080">[</font>i<font color="#000080">]^,</font>stmp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
    </b></font>strmov<font color="#000080">(</font>stmp<font color="#000080">,</font>s_<font color="#000080">[</font>i<font color="#000080">]^);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>max<font color="#000080">&lt;</font>stmp<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>strmov<font color="#000080">(</font>max<font color="#000080">,</font>stmp<font color="#000080">);
    </font>writeln<font color="#000080">(</font>tempf<font color="#000080">,</font>s_<font color="#000080">[</font>i<font color="#000080">]^);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>n<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>close<font color="#000080">(</font>tempf<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>MergeTempFiles<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>f_ <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">50</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>text<font color="#000080">;
  </font>outf <font color="#000080">: </font>text<font color="#000080">;
  </font>i <font color="#000080">: </font>byte<font color="#000080">;
  </font>s_ <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">50</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>tS20<font color="#000080">;
  </font>min <font color="#000080">: </font>tS20<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'Merging '</font><font color="#000080">,</font>strl<font color="#000080">(</font>NTempFile<font color="#000080">),</font><font color="#800000">' temp files'</font><font color="#000080">);

  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NTempFile <font color="#FF0000"><b>do begin
    </b></font>assign<font color="#000080">(</font>f_<font color="#000080">[</font>i<font color="#000080">],</font><font color="#800000">'wordtemp.'</font><font color="#000080">+</font>strl<font color="#000080">(</font>i<font color="#000080">));
    </font>reset<font color="#000080">(</font>f_<font color="#000080">[</font>i<font color="#000080">]);
    </font>readln<font color="#000080">(</font>f_<font color="#000080">[</font>i<font color="#000080">],</font>s_<font color="#000080">[</font>i<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>strmov<font color="#000080">(</font>min<font color="#000080">,</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
  </font>strovrl<font color="#000080">(</font>min<font color="#000080">,</font><font color="#800000">'.DCT'</font><font color="#000080">,</font>strposr<font color="#000080">(</font>min<font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">));
  </font>assign<font color="#000080">(</font>outf<font color="#000080">,</font>min<font color="#000080">);
  </font>rewrite<font color="#000080">(</font>outf<font color="#000080">);

  </font><font color="#FF0000"><b>repeat
    </b></font>min<font color="#000080">:= </font>max<font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NTempFile <font color="#FF0000"><b>do if </b></font><font color="#000080">(</font>s_<font color="#000080">[</font>i<font color="#000080">]&lt;</font>min<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>min<font color="#000080">:= </font>s_<font color="#000080">[</font>i<font color="#000080">];
    </font>writeln<font color="#000080">(</font>outf<font color="#000080">,</font>min<font color="#000080">);

    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NTempFile <font color="#FF0000"><b>do if </b></font><font color="#000080">(</font>s_<font color="#000080">[</font>i<font color="#000080">]&lt;=</font>min<font color="#000080">) </font><font color="#FF0000"><b>then
      if not </b></font>eof<font color="#000080">(</font>f_<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>then
        </b></font>readln<font color="#000080">(</font>f_<font color="#000080">[</font>i<font color="#000080">],</font>s_<font color="#000080">[</font>i<font color="#000080">])
      </font><font color="#FF0000"><b>else
        </b></font>s_<font color="#000080">[</font>i<font color="#000080">]:= </font><font color="#800000">#254</font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>min<font color="#000080">=</font>max<font color="#000080">);

  </font>close<font color="#000080">(</font>outf<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NTempFile <font color="#FF0000"><b>do begin
    </b></font>close<font color="#000080">(</font>f_<font color="#000080">[</font>i<font color="#000080">]);
    </font>erase<font color="#000080">(</font>f_<font color="#000080">[</font>i<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>StripPunctuation<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>const
  </b></font>LCCHARS<font color="#000080">=[</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">]; </font><font color="#008000"><i>{ lower case chars }

</i></font><font color="#FF0000"><b>var
  </b></font>i <font color="#000080">: </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ Replace all non-alpha chars with spaces. It's lower case already. }
  </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    if not </b></font><font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>LCCHARS<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>s<font color="#000080">[</font>i<font color="#000080">]:= </font><font color="#800000">' '</font><font color="#000080">;

  </font><font color="#008000"><i>{ Remove all double spaces }
  </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>strqty<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">'  '</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>strrepl<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">'  '</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------}
</i></font><font color="#FF0000"><b>begin
  </b></font>NTempFile<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>n<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>max<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MAXPTR <font color="#FF0000"><b>do
    </b></font>new<font color="#000080">(</font>s_<font color="#000080">[</font>i<font color="#000080">]);

  </font>assign<font color="#000080">(</font>f<font color="#000080">,</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
  </font>reset<font color="#000080">(</font>f<font color="#000080">);

  </font>writeln<font color="#000080">(</font><font color="#800000">'Reading'</font><font color="#000080">);
  </font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>readln<font color="#000080">(</font>f<font color="#000080">,</font>s<font color="#000080">);
    </font>strlwr<font color="#000080">(</font>s<font color="#000080">);
    </font>StripPunctuation<font color="#000080">(</font>s<font color="#000080">);
    </font>ndx<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>ndx<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
      </b></font>wrdparse<font color="#000080">(</font>s2<font color="#000080">,</font>s<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>ndx<font color="#000080">);
      </font>inc<font color="#000080">(</font>n<font color="#000080">);
      </font>strmov<font color="#000080">(</font>s_<font color="#000080">[</font>n<font color="#000080">]^,</font>s2<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>n<font color="#000080">=</font>MAXPTR<font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>WriteTempFile<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>close<font color="#000080">(</font>f<font color="#000080">);

  </font>WriteTempFile<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>NTempFile<font color="#000080">&gt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>MergeTempFiles
  <font color="#FF0000"><b>else begin
    </b></font>s<font color="#000080">:= </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font>strovrl<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">'.DCT'</font><font color="#000080">,</font>strposr<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">));

    </font><font color="#008000"><i>{ Remove output file if it already exists }
    </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>FSearch<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">)&lt;&gt;</font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>s<font color="#000080">);
      </font>erase<font color="#000080">(</font>f<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>assign<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'wordtemp.1'</font><font color="#000080">);
    </font>rename<font color="#000080">(</font>f<font color="#000080">,</font>s<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0052.PAS">Original</a><b>]</b></p></body>
</html>
