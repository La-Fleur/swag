<html>
<head><title> "Re: Random Number Generator" by DANIEL MAILLY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0075.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(************************************* function  Generate   *************)
</i></font><font color="#FF0000"><b>function </b></font>Generate <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Seed<font color="#000080">: </font>longint<font color="#000080">): </font>real<font color="#000080">;

</font><font color="#008000"><i>{  Algorithm 2 from CACM, pg. 1195, vol. 31, no. 10, (October, 1988).    }
{  modified for longint values as recommended in Cooper, D. 1993         }
{  Oh! Pascal!, 3rd edition, pp. A16-A17                                 }

</i></font><font color="#FF0000"><b>const
   </b></font>MODULUS    <font color="#000080">= </font><font color="#800000">2147483647</font><font color="#000080">;
   </font>MULTIPLIER <font color="#000080">= </font><font color="#800000">16807</font><font color="#000080">;
   </font>QUOTIENT   <font color="#000080">= </font><font color="#800000">127773</font><font color="#000080">;    </font><font color="#008000"><i>{MODULUS div MULTIPLIER}
   </i></font>REMAINDER  <font color="#000080">= </font><font color="#800000">2836</font><font color="#000080">;      </font><font color="#008000"><i>{MODULUS mod MULTIPLIER}

</i></font><font color="#FF0000"><b>var
   </b></font>Low<font color="#000080">, </font>Hi<font color="#000080">, </font>Test<font color="#000080">: </font>longint<font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{First, perform the calculation while avoiding overflow.}
   </i></font>Hi   <font color="#000080">:= </font>Seed <font color="#FF0000"><b>div </b></font>QUOTIENT<font color="#000080">;
   </font>Low  <font color="#000080">:= </font>Seed <font color="#FF0000"><b>mod </b></font>QUOTIENT<font color="#000080">;
   </font>Test <font color="#000080">:= (</font>MULTIPLIER <font color="#000080">* </font>Low<font color="#000080">) - (</font>REMAINDER <font color="#000080">* </font>Hi<font color="#000080">);

</font><font color="#008000"><i>{Second, update the seed for next time.}
   </i></font><font color="#FF0000"><b>if </b></font>Test <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Seed <font color="#000080">:= </font>Test
   <font color="#FF0000"><b>else
      </b></font>Seed <font color="#000080">:= </font>Test <font color="#000080">+ </font>MODULUS<font color="#000080">;

</font><font color="#008000"><i>{Third, return a value in the range 0.0 &lt; Generate  &lt; 1.0}
   </i></font>Generate <font color="#000080">:= </font>Seed <font color="#000080">/ </font>MODULUS<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(************************************* function  Generate end ***********)

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0075.PAS">Original</a><b>]</b></p></body>
</html>
