<html>
<head><title> "Display a Text File with Scrollback" by ROB VAN GEEL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0054.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I am writing a small replacement for the DOS command TYPE and one
&gt; of the things I would like to add is a scroll back buffer...
&gt; Q: How do I intercept the lines that are scrolling off page?
&gt; Is there a interupt that I may hook in to or ...

Doesn't have a filesize check. Parts of it could be improved.

From: R.A.M.vGeel@kub.nl  (GEEL R.A.M.VAN)
}

</i></font><font color="#FF0000"><b>program </b></font>show<font color="#000080">;
 
</font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">, </font>crt<font color="#000080">;
 
</font><font color="#FF0000"><b>const
  </b></font>NoMSG <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>msgNoPar <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>msgNoFile <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>msgNoDrive <font color="#000080">= </font><font color="#800000">152</font><font color="#000080">;
  </font>msgNoClose <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;
  </font>msgWrongKey <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;
 
</font><font color="#FF0000"><b>type
  </b></font>FileNameString <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
 
  </font>PNewLine <font color="#000080">= ^</font>NewLine<font color="#000080">;
  </font>NewLine <font color="#000080">= </font><font color="#FF0000"><b>Record
              </b></font>Line <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">79</font><font color="#000080">];
              </font>Next<font color="#000080">, </font>Prev <font color="#000080">: </font>PNewLine<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
  </font>TFiler <font color="#000080">= </font><font color="#FF0000"><b>object
             </b></font>FileName <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
             </font>InFile <font color="#000080">: </font>text<font color="#000080">;
             </font>MSGStatus <font color="#000080">: </font>byte<font color="#000080">;
 
             </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;
             </font><font color="#FF0000"><b>procedure </b></font>DoMsg<font color="#000080">(</font>MsgNr <font color="#000080">: </font>byte<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>function </b></font>GetFileName <font color="#000080">: </font>FileNameString<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>function </b></font>OpenIt <font color="#000080">: </font>byte<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>function </b></font>CloseIt <font color="#000080">: </font>byte<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>destructor </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
  </font>TShower <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TFiler<font color="#000080">)
              </font>Screen <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2000</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;
              </font>Xcor<font color="#000080">, </font>Ycor <font color="#000080">: </font>byte<font color="#000080">;
              </font>CurSize <font color="#000080">: </font>word<font color="#000080">;
              </font>Text <font color="#000080">: </font>PNewLine<font color="#000080">;
              </font>ScrolFac <font color="#000080">: </font>integer<font color="#000080">;
              </font>Tmp <font color="#000080">: </font>PNewLine<font color="#000080">;
 
              </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;
              </font><font color="#FF0000"><b>procedure </b></font>DoMsg<font color="#000080">(</font>MsgNr <font color="#000080">: </font>byte<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>procedure </b></font>Cursor<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>procedure </b></font>NoCursor<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>procedure </b></font>SaveScreen<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>procedure </b></font>RestoreScreen<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>procedure </b></font>ReadIn<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>procedure </b></font>ShowText<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>function </b></font>UpdatePointer<font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>procedure </b></font>Go<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>destructor </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>var
  </b></font>AShower <font color="#000080">: </font>TShower<font color="#000080">;
 
</font><font color="#FF0000"><b>constructor </b></font>TFiler<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FileName <font color="#000080">:= </font>GetFileName<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>MSGStatus <font color="#000080">&lt;&gt; </font>NoMsg <font color="#FF0000"><b>then </b></font>DoMsg<font color="#000080">(</font>MSGStatus<font color="#000080">);
  </font>MSGSTatus <font color="#000080">:= </font>OpenIt<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>MSGStatus <font color="#000080">&lt;&gt; </font>NoMSG <font color="#FF0000"><b>then </b></font>DoMSG<font color="#000080">(</font>MSGStatus<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>TFiler<font color="#000080">.</font>DoMsg<font color="#000080">(</font>MSGNr <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  case </b></font>MSGNr <font color="#FF0000"><b>of
    </b></font>msgNoPar <font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>writeln<font color="#000080">(</font><font color="#800000">'* * SHOW (c) 1994 Robert van Geel * *'</font><font color="#000080">);
        </font>writeln<font color="#000080">;
        </font>writeln<font color="#000080">(</font><font color="#800000">'Usage: SHOW &lt;filename&gt;'</font><font color="#000080">);
        </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>msgNoFile <font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>writeln<font color="#000080">(</font><font color="#800000">'File not found'</font><font color="#000080">);
        </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>msgNoClose <font color="#000080">:
       </font><font color="#FF0000"><b>begin
         </b></font>writeln<font color="#000080">(</font><font color="#800000">'Could not close file'</font><font color="#000080">);
         </font>MSGStatus <font color="#000080">:= </font>NoMsg<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>msgNoDrive <font color="#000080">:
       </font><font color="#FF0000"><b>begin
         </b></font>writeln<font color="#000080">(</font><font color="#800000">'Drive not ready'</font><font color="#000080">);
         </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>function </b></font>TFiler<font color="#000080">.</font>GetFileName <font color="#000080">: </font>FileNameString<font color="#000080">;
</font><font color="#FF0000"><b>begin
  If </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>GetFileName <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
  </font><font color="#FF0000"><b>else </b></font>MsgStatus <font color="#000080">:= </font>MSGNoPar<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>function </b></font>TFiler<font color="#000080">.</font>OpenIt <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>nr <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{$I-}
    </i></font>assign<font color="#000080">(</font>InFile<font color="#000080">, </font>FileName<font color="#000080">);
    </font>reset<font color="#000080">(</font>InFile<font color="#000080">);
    </font>nr <font color="#000080">:= </font>IOResult<font color="#000080">;
    </font>OpenIt <font color="#000080">:= </font>nr<font color="#000080">;
  </font><font color="#008000"><i>{$I+}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>function </b></font>TFiler<font color="#000080">.</font>CloseIt <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{$I-}
  </i></font>close<font color="#000080">(</font>InFile<font color="#000080">);
  </font>CloseIt <font color="#000080">:= </font>IOResult<font color="#000080">;
</font><font color="#008000"><i>{$I+}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>destructor </b></font>TFiler<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MsgStatus <font color="#000080">:= </font>CloseIt<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>MSGStatus <font color="#000080">&lt;&gt; </font>NoMSG
    <font color="#FF0000"><b>then </b></font>DoMsg<font color="#000080">(</font>MSGStatus<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#008000"><i>{ ********************************************************************** }
 
</i></font><font color="#FF0000"><b>constructor </b></font>TShower<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>init<font color="#000080">;
  </font>SaveScreen<font color="#000080">;
  </font>ReadIn<font color="#000080">;
  </font>NoCursor<font color="#000080">;
  </font>SaveScreen<font color="#000080">;
</font><font color="#008000"><i>{  textcolor(yellow);
  textbackground(blue);
}  </i></font>clrscr<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>TShower<font color="#000080">.</font>DoMsg<font color="#000080">(</font>MSGNr <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>DoMsg<font color="#000080">(</font>MsgNr<font color="#000080">);
  </font><font color="#FF0000"><b>case </b></font>MSGNr <font color="#FF0000"><b>of
      </b></font>msgWrongKey <font color="#000080">:
        </font><font color="#FF0000"><b>begin
          </b></font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">);
          </font>writeln<font color="#000080">(</font><font color="#800000">'KEY HAS NO FUNCTION HERE'</font><font color="#000080">);
          </font>MsgNr <font color="#000080">:= </font>NoMsg<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>TShower<font color="#000080">.</font>NoCursor<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>s <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
 asm
    </b></font><font color="#FF00FF">mov ah,03h
    mov bh,0
    int 10h
    mov s,cx
 
    mov ah,01h
    mov bh,0
    mov cx,2000h
    int 10h 
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>cursize <font color="#000080">:= </font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>TShower<font color="#000080">.</font>Cursor<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>s<font color="#000080">:=</font>CurSize<font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov ah,01h
    mov bh,0
    mov cx,s
    int 10h
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>TShower<font color="#000080">.</font>SaveScreen<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>move<font color="#000080">(</font>memw<font color="#000080">[</font><font color="#800000">$B800</font><font color="#000080">:</font><font color="#800000">$0</font><font color="#000080">], </font>Screen<font color="#000080">, </font><font color="#800000">4000</font><font color="#000080">);
  </font>XCor <font color="#000080">:= </font>wherex<font color="#000080">;
  </font>YCor <font color="#000080">:= </font>wherey<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>TShower<font color="#000080">.</font>RestoreScreen<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>move<font color="#000080">(</font>Screen<font color="#000080">, </font>memw<font color="#000080">[</font><font color="#800000">$B800</font><font color="#000080">:</font><font color="#800000">$0</font><font color="#000080">], </font><font color="#800000">4000</font><font color="#000080">);
  </font>gotoxy<font color="#000080">(</font>XCor<font color="#000080">, </font>YCor<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>function </b></font>TShower<font color="#000080">.</font>UpdatePointer<font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>k <font color="#000080">: </font>integer<font color="#000080">;
  </font>changed <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>changed <font color="#000080">:= </font>false<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>ScrolFac <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Text<font color="#000080">^.</font>Next <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>changed <font color="#000080">:= </font>true<font color="#000080">;
      </font>Text <font color="#000080">:= </font>Text<font color="#000080">^.</font>Next<font color="#000080">;
      </font>dec<font color="#000080">(</font>ScrolFac<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>ScrolFac <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Text<font color="#000080">^.</font>Prev <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>changed <font color="#000080">:= </font>true<font color="#000080">;
      </font>Text <font color="#000080">:= </font>Text<font color="#000080">^.</font>Prev<font color="#000080">;
      </font>inc<font color="#000080">(</font>ScrolFac<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Tmp <font color="#000080">:= </font>Text<font color="#000080">;
  </font>UpdatePointer <font color="#000080">:= </font>changed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>TShower<font color="#000080">.</font>ShowText<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>LinesWritten <font color="#000080">: </font>integer<font color="#000080">;
  </font>OneMore <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>LinesWritten <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>OneMore <font color="#000080">:= </font>true<font color="#000080">;
  </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font>OneMore <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>LinesWritten <font color="#000080">&lt; </font><font color="#800000">25</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>write<font color="#000080">(</font>tmp<font color="#000080">^.</font>Line<font color="#000080">);
      </font>clreol<font color="#000080">;
      </font>inc<font color="#000080">(</font>LinesWritten<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>LinesWritten <font color="#000080">&lt; </font><font color="#800000">25 </font><font color="#FF0000"><b>then
        begin
          </b></font>writeln<font color="#000080">;
          </font>clreol<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>tmp<font color="#000080">^.</font>next <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then </b></font>tmp <font color="#000080">:= </font>tmp<font color="#000080">^.</font>Next
        <font color="#FF0000"><b>else </b></font>OneMore <font color="#000080">:= </font>false<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>LinesWritten <font color="#000080">&lt; </font><font color="#800000">24 </font><font color="#FF0000"><b>do
    begin
      </b></font>writeln<font color="#000080">;
      </font>clreol<font color="#000080">;
      </font>inc<font color="#000080">(</font>LinesWritten<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>TShower<font color="#000080">.</font>Go<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Ch <font color="#000080">: </font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>tmp <font color="#000080">:= </font>Text<font color="#000080">;
  </font>ShowText<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>Ch <font color="#000080">&lt;&gt; </font><font color="#800000">#01 </font><font color="#FF0000"><b>do
  begin
    </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
    </font><font color="#FF0000"><b>case </b></font>ch <font color="#FF0000"><b>of
      </b></font><font color="#800000">#0  </font><font color="#000080">: ;
      </font><font color="#800000">#72 </font><font color="#000080">: </font>ScrolFac <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;   </font><font color="#008000"><i>{omhoog}
      </i></font><font color="#800000">#80 </font><font color="#000080">: </font>ScrolFac <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;    </font><font color="#008000"><i>{omlaag}
      </i></font><font color="#800000">#73 </font><font color="#000080">: </font>ScrolFac <font color="#000080">:= -</font><font color="#800000">25</font><font color="#000080">;  </font><font color="#008000"><i>{page up}
      </i></font><font color="#800000">#81 </font><font color="#000080">: </font>ScrolFac <font color="#000080">:= </font><font color="#800000">25</font><font color="#000080">;   </font><font color="#008000"><i>{page down}
      </i></font><font color="#FF0000"><b>else </b></font>Ch <font color="#000080">:= </font><font color="#800000">#01</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>ScrolFac <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
        if </b></font>UpdatePointer <font color="#FF0000"><b>then </b></font>ShowText<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>procedure </b></font>TShower<font color="#000080">.</font>ReadIn<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>cur <font color="#000080">: </font>PNewLine<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>new<font color="#000080">(</font>Text<font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>Text<font color="#000080">^ </font><font color="#FF0000"><b>do
    begin
      </b></font>readln<font color="#000080">(</font>InFile<font color="#000080">, </font>Line<font color="#000080">);
      </font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font>Prev <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>cur <font color="#000080">:= </font>Text<font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font>EOF<font color="#000080">(</font>InFile<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>new<font color="#000080">(</font>tmp<font color="#000080">);
      </font><font color="#FF0000"><b>with </b></font>tmp<font color="#000080">^ </font><font color="#FF0000"><b>do
        begin
          </b></font>readln<font color="#000080">(</font>InFile<font color="#000080">, </font>tmp<font color="#000080">^.</font>line<font color="#000080">);
          </font>tmp<font color="#000080">^.</font>prev <font color="#000080">:= </font>cur<font color="#000080">;
          </font>cur<font color="#000080">^.</font>next <font color="#000080">:= </font>tmp<font color="#000080">;
          </font>tmp<font color="#000080">^.</font>next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>cur <font color="#000080">:= </font>tmp<font color="#000080">;
      </font>tmp <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>cur <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>tmp <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>destructor </b></font>TShower<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Done<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>text<font color="#000080">^.</font>next <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
    begin
      </b></font>text <font color="#000080">:= </font>text<font color="#000080">^.</font>next<font color="#000080">;
      </font>dispose<font color="#000080">(</font>text<font color="#000080">^.</font>prev<font color="#000080">);
      </font>text<font color="#000080">^.</font>prev <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>dispose<font color="#000080">(</font>text<font color="#000080">);
  </font>text <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>Cursor<font color="#000080">;
  </font>RestoreScreen<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>begin
  </b></font>AShower<font color="#000080">.</font>Init<font color="#000080">;
  </font>AShower<font color="#000080">.</font>Go<font color="#000080">;
  </font>AShower<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTFILE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0054.PAS">Original</a><b>]</b></p></body>
</html>
