<html>
<head><title> "OS/2 COMM Dumb Terminal" by B.J. GUILLOT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I've been wondering this for quite awhile now - Is there a way to access
&gt; the communication ports in OS/2 using Borland Pascal. I'd like to create
&gt; a BBS app?

Here's some code that I've put toegether that should get you in the right
direction (it's a dumb terminal program for OS/2):
}
</i></font><font color="#FF0000"><b>program </b></font>dt2<font color="#000080">;

</font><font color="#FF0000"><b>uses
  </b></font>dosprocs<font color="#000080">, </font>os2subs<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>ExtKeyChar <font color="#000080">: </font>Char <font color="#000080">= </font><font color="#800000">#0</font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>KeyPressed <font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>KeyInfo <font color="#000080">: </font>TKbdKeyInfo<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>KbdPeek<font color="#000080">(</font>KeyInfo<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font>KeyPressed<font color="#000080">:= (</font>ExtKeyChar <font color="#000080">&lt;&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">((</font>KeyInfo<font color="#000080">.</font>fbStatus <font color="#FF0000"><b>And </b></font><font color="#800000">$40</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>ReadKey <font color="#000080">: </font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>KeyInfo <font color="#000080">: </font>TKbdKeyInfo<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    If </b></font>ExtKeyChar <font color="#000080">&lt;&gt; </font><font color="#800000">#0 </font><font color="#FF0000"><b>then
      Begin
        </b></font>ReadKey<font color="#000080">:= </font>ExtKeyChar<font color="#000080">;
        </font>ExtKeyChar<font color="#000080">:= </font><font color="#800000">#0
      </font><font color="#FF0000"><b>End
    else
      Begin
        </b></font>KbdCharIn<font color="#000080">(</font>KeyInfo<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>KeyInfo<font color="#000080">.</font>chChar <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>then
          </b></font>ExtKeyChar<font color="#000080">:= </font>KeyInfo<font color="#000080">.</font>chScan<font color="#000080">;
        </font>ReadKey<font color="#000080">:= </font>KeyInfo<font color="#000080">.</font>chChar<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>mdmlinerec <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>databits <font color="#000080">: </font>byte<font color="#000080">;
    </font>parity   <font color="#000080">: </font>byte<font color="#000080">;
    </font>stopbits <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>mdmctlrec <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>onmask   <font color="#000080">: </font>byte<font color="#000080">;
    </font>offmask  <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>mdmdcbrec <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>wtime    <font color="#000080">: </font>word<font color="#000080">;
    </font>rtime    <font color="#000080">: </font>word<font color="#000080">;
    </font>flags1   <font color="#000080">: </font>byte<font color="#000080">;
    </font>flags2   <font color="#000080">: </font>byte<font color="#000080">;
    </font>flags3   <font color="#000080">: </font>byte<font color="#000080">;
    </font>errchar  <font color="#000080">: </font>byte<font color="#000080">;
    </font>brkchar  <font color="#000080">: </font>byte<font color="#000080">;
    </font>xonchar  <font color="#000080">: </font>byte<font color="#000080">;
    </font>xoffchar <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>siodterec <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>dte      <font color="#000080">: </font>longint<font color="#000080">;
    </font>fraction <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>bufstatrec <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>bufused  <font color="#000080">: </font>word<font color="#000080">;
    </font>bufsize  <font color="#000080">: </font>word<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>dtestatrec <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>dterate  <font color="#000080">: </font>longint<font color="#000080">;
    </font>dtefract <font color="#000080">: </font>byte<font color="#000080">;
    </font>mindte   <font color="#000080">: </font>longint<font color="#000080">;
    </font>minfract <font color="#000080">: </font>byte<font color="#000080">;
    </font>maxdte   <font color="#000080">: </font>longint<font color="#000080">;
    </font>maxfract <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>comh <font color="#000080">: </font>word<font color="#000080">;
  </font>mdmline <font color="#000080">: </font>mdmlinerec<font color="#000080">; </font>mdmctl <font color="#000080">: </font>mdmctlrec<font color="#000080">; </font>mdmdcb <font color="#000080">: </font>mdmdcbrec<font color="#000080">;
  </font>siodte <font color="#000080">: </font>siodterec<font color="#000080">; </font>bufstat <font color="#000080">: </font>bufstatrec<font color="#000080">; </font>dtestat <font color="#000080">: </font>dtestatrec<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>si<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i <font color="#000080">: </font>longint<font color="#000080">; </font>c <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>si <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>val<font color="#000080">(</font>s<font color="#000080">, </font>i<font color="#000080">, </font>c<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>c <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>si <font color="#000080">:= </font>i<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>sendport<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>written <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>doswrite<font color="#000080">(</font>comh<font color="#000080">, </font>s<font color="#000080">[</font>i<font color="#000080">], </font><font color="#800000">1</font><font color="#000080">, </font>written<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>funcall<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>w <font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{ shows what DLL call generates error if any }
  </i></font><font color="#FF0000"><b>if </b></font>w <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
    </b></font>writeln<font color="#000080">(</font><font color="#800000">'Error ['</font><font color="#000080">+</font>s<font color="#000080">+</font><font color="#800000">']; result code: '</font><font color="#000080">, </font>w<font color="#000080">);
    </font>halt<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>carrier <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>mdminsig <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>funcall<font color="#000080">(</font><font color="#800000">'Check DCD'</font><font color="#000080">, </font>dosdevioctl<font color="#000080">(@</font>mdminsig<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#800000">103</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>comh<font color="#000080">));
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>mdminsig <font color="#FF0000"><b>and </b></font><font color="#800000">128</font><font color="#000080">) = </font><font color="#800000">128 </font><font color="#FF0000"><b>then
    </b></font>carrier <font color="#000080">:= </font>true
  <font color="#FF0000"><b>else
    </b></font>carrier <font color="#000080">:= </font>false<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>getdte <font color="#000080">: </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>baud <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>funcall<font color="#000080">(</font><font color="#800000">'SIO.SYS Grab DTE'</font><font color="#000080">, </font>dosdevioctl<font color="#000080">(@</font>dtestat<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#800000">99</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>comh<font color="#000080">));
  </font><font color="#008000"><i>{ funcall('COM.SYS Get DTE', dosdevioctl(@baud, nil, $61, 1, comh)); }
  </i></font>getdte <font color="#000080">:= </font>dtestat<font color="#000080">.</font>dterate<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>rcvbufused <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>funcall<font color="#000080">(</font><font color="#800000">'Check Rcv Buff'</font><font color="#000080">, </font>dosdevioctl<font color="#000080">(@</font>bufstat<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#800000">104</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>comh<font color="#000080">));
  </font>rcvbufused <font color="#000080">:= </font>bufstat<font color="#000080">.</font>bufused<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>initcomm<font color="#000080">(</font>cport <font color="#000080">: </font>byte<font color="#000080">; </font>dte <font color="#000080">: </font>longint<font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>action<font color="#000080">, </font>comerr <font color="#000080">: </font>word<font color="#000080">;
  </font>comstr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">6</font><font color="#000080">];
  </font>portz <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ This routine is based off of OS2COMM.C's INITCOMM function done in
  1988 by Jim Gilliland }
  </i></font>comerr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>comstr <font color="#000080">:= </font><font color="#800000">'COM'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">48</font><font color="#000080">+</font>cport<font color="#000080">)+</font><font color="#800000">#0</font><font color="#000080">;
  </font>move<font color="#000080">(</font>comstr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>portz<font color="#000080">, </font><font color="#800000">5</font><font color="#000080">);
  </font>funcall<font color="#000080">(</font><font color="#800000">'Open Port'</font><font color="#000080">, </font>dosopen<font color="#000080">(@</font>portz<font color="#000080">, </font>comh<font color="#000080">, </font>action<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">66</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">));
  </font><font color="#008000"><i>{ note: 66 means &quot;deny none&quot; access to com port }
  </i></font>writeln<font color="#000080">(</font><font color="#800000">'Initial DTE ['</font><font color="#000080">, </font>getdte<font color="#000080">, </font><font color="#800000">']'</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>dte <font color="#000080">&gt; </font><font color="#800000">57600 </font><font color="#FF0000"><b>then begin </b></font><font color="#008000"><i>{ for speeds &gt; 57600, use SIO function 43h }
    </i></font>siodte<font color="#000080">.</font>dte <font color="#000080">:= </font>dte<font color="#000080">;  </font><font color="#008000"><i>{ I hope you are using SIO }
    </i></font>siodte<font color="#000080">.</font>fraction <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>funcall<font color="#000080">(</font><font color="#800000">'Set SIO DTE'</font><font color="#000080">, </font>dosdevioctl<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">, @</font>siodte<font color="#000080">, </font><font color="#800000">67</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>comh<font color="#000080">));
  </font><font color="#FF0000"><b>end else
    </b></font>funcall<font color="#000080">(</font><font color="#800000">'Set DTE Rate'</font><font color="#000080">, </font>dosdevioctl<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">, @</font>dte<font color="#000080">, </font><font color="#800000">65</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>comh<font color="#000080">));
  </font>mdmline<font color="#000080">.</font>databits <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;
  </font>mdmline<font color="#000080">.</font>parity <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{ N-parity }
  </i></font>mdmline<font color="#000080">.</font>stopbits <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{ 1-stop bit }
  </i></font>funcall<font color="#000080">(</font><font color="#800000">'Set N81'</font><font color="#000080">, </font>dosdevioctl<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">, @</font>mdmline<font color="#000080">, </font><font color="#800000">66</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>comh<font color="#000080">));
  </font>mdmctl<font color="#000080">.</font>onmask <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">; </font><font color="#008000"><i>{ DTR/RTS on }
  </i></font>mdmctl<font color="#000080">.</font>offmask <font color="#000080">:= </font><font color="#800000">255</font><font color="#000080">; </font><font color="#008000"><i>{ nothing off }
  </i></font>funcall<font color="#000080">(</font><font color="#800000">'Set DTR/RTS'</font><font color="#000080">, </font>dosdevioctl<font color="#000080">(@</font>comerr<font color="#000080">, @</font>mdmctl<font color="#000080">, </font><font color="#800000">70</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>comh<font color="#000080">));
  </font>mdmdcb<font color="#000080">.</font>wtime <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
  </font>mdmdcb<font color="#000080">.</font>rtime <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
  </font>mdmdcb<font color="#000080">.</font>flags1 <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>mdmdcb<font color="#000080">.</font>flags2 <font color="#000080">:= </font><font color="#800000">64</font><font color="#000080">;
  </font>mdmdcb<font color="#000080">.</font>flags3 <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
  </font>mdmdcb<font color="#000080">.</font>errchar <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>mdmdcb<font color="#000080">.</font>brkchar <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>mdmdcb<font color="#000080">.</font>xonchar <font color="#000080">:= </font><font color="#800000">17</font><font color="#000080">;
  </font>mdmdcb<font color="#000080">.</font>xoffchar <font color="#000080">:= </font><font color="#800000">19</font><font color="#000080">;
  </font>funcall<font color="#000080">(</font><font color="#800000">'Set DCB'</font><font color="#000080">, </font>dosdevioctl<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">, @</font>mdmdcb<font color="#000080">, </font><font color="#800000">83</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>comh<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>dumbterm<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>w <font color="#000080">: </font>word<font color="#000080">;
  </font>ch <font color="#000080">: </font>char<font color="#000080">;
  </font>incom <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">512</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'[VERY DUMB TERMINAL/2 0.1] **** USE CTRL-Z TO EXIT THE PROGRAM ****'</font><font color="#000080">);
  </font>sendport<font color="#000080">(</font><font color="#800000">'ATZ'</font><font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">); </font><font color="#008000"><i>{ example initialization string }
  </i></font><font color="#FF0000"><b>repeat
    if </b></font>keypressed <font color="#FF0000"><b>then begin
      </b></font>ch <font color="#000080">:= </font>readkey<font color="#000080">;
      </font>doswrite<font color="#000080">(</font>comh<font color="#000080">, </font>ch<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>w<font color="#000080">);
    </font><font color="#FF0000"><b>end else begin
      if </b></font>dosread<font color="#000080">(</font>comh<font color="#000080">, </font>incom<font color="#000080">, </font><font color="#800000">512</font><font color="#000080">, </font>w<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>w <font color="#FF0000"><b>do
          </b></font>write<font color="#000080">(</font>incom<font color="#000080">[</font>i<font color="#000080">]);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until</b></font><font color="#000080">(</font>ch <font color="#000080">= </font><font color="#800000">#26</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>dte <font color="#000080">: </font>longint<font color="#000080">;
  </font>cport <font color="#000080">: </font>byte<font color="#000080">;
  </font>version <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>paramcount <font color="#000080">&lt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then begin
    </b></font>writeln<font color="#000080">(</font><font color="#800000">' Syntax: DT port dte'</font><font color="#000080">);
    </font>writeln<font color="#000080">(</font><font color="#800000">'Example: DT 3 115200'</font><font color="#000080">);
    </font>halt<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>cport <font color="#000080">:= </font>si<font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
  </font>dte <font color="#000080">:= </font>si<font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">));
  </font>dosgetversion<font color="#000080">(</font>version<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Program written by B.J. Guillot [BGFAX author] Nov 1994'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Fido 1:106/400   Internet email: bjg90783@jetson.uh.edu'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Program written for German 16-bit OS/2 patch for BP 7.0'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'Port ['</font><font color="#000080">, </font>cport<font color="#000080">, </font><font color="#800000">']  DTE ['</font><font color="#000080">, </font>dte<font color="#000080">, </font><font color="#800000">']'</font><font color="#000080">);
  </font>initcomm<font color="#000080">(</font>cport<font color="#000080">, </font>dte<font color="#000080">); </font><font color="#008000"><i>{ initialies the port and grabs com handle }
  </i></font>dumbterm<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'Closing port...'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>dosclose<font color="#000080">(</font>comh<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p></body>
</html>
