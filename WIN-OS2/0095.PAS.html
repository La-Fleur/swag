<html>
<head><title> "Printing a TEditWindow" by BRAD PRENDERGAST</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0095.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

 Program Name : EdPrint.Pas
 Written By   : Brad Prendergast
 E-Mail       : mrealm@ici.net
 Web Page     : http://www.ici.net/cust_pages/mrealm/BANDP.HTM
 Program
 Compilation  : Borland Turbo Pascal 7.0

 Program Description :
  This demonstration shows how to print the contents a TEditWindow. A
  TEditWindow  utilizes a TEditor, the main variables within the TEditor
  are buffer ( array[0..65516] of char; this is where the buffer stores the
  text contents of the window), curptr (word; this is the current position of
  the cursor in the buffer, gaplen (word; gap between the beginning and
  ending of the buffer) and buflen ( word; the number of characters within
  the buffer).  Once executed this demo will open an editor window.  Type
  data into this window and then select print from the menubar.  The output
  will be placed into a text file.  I developed this to print the contents
  of an active editor window to a printer, but for demo purposes it goes to
  a text file. Any comments/questions please e-mail me.

 =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}

  {This is the standard set of compiler directives I opt to use}
{$define debug}
{$define error_checking}
  {$ifdef error_checking}
    {$i+}  {l i/o checking            }
    {$q+}  {l overflow checking       }
    {$r+}  {l range checking          }
    {$s+}  {l stack overflow checking }
  {$else}
    {$i-}  {l i/o checking            }
    {$q-}  {l overflow checking       }
    {$r-}  {l range checking          }
    {$s-}  {l stack overflow checking }
  {$endif}
{$undef error_checking}
  {$ifdef debug}
    {$d+}  {g debug information              }
    {$l+}  {g local symbol information       }
    {$y+}  {g symbolic reference information }
  {$else}
    {$d-}  {g debug information              }
    {$l-}  {g local symbol information       }
    {$y-}  {g symbolic reference information }
  {$endif}

{$a+}  {g align data}
{$b-}  {l short circuit boolean evaluation   }
{$e-}  {g disable emulation                  }
{$f+}  {l allow far calls                    }
{$g+}  {g generate 80286 code                }
{$n-}  {g disable numeric processing         }
{$p+}  {g enable open parameters             }
{$o+}  {g overlay                            }
{$t-}  {g type @ operator                    }
{$v+}  {l var string checking                }
{$x+}  {g extended syntax enabled            }

  </i></font><font color="#FF0000"><b>uses
    </b></font>App<font color="#000080">, </font>Editors<font color="#000080">, </font>Memory<font color="#000080">, </font>Objects<font color="#000080">, </font>Menus<font color="#000080">, </font>Views<font color="#000080">, </font>Drivers<font color="#000080">;

</font><font color="#008000"><i>{ -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- }

  </i></font><font color="#FF0000"><b>const
    </b></font>outfile <font color="#000080">= </font><font color="#800000">'output.txt'</font><font color="#000080">;
    </font>cmprint <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;

</font><font color="#008000"><i>{ -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- }

  </i></font><font color="#FF0000"><b>type
    </b></font>TDemoApp <font color="#000080">= </font><font color="#FF0000"><b>object </b></font><font color="#000080">(</font>TApplication<font color="#000080">)
             </font>p       <font color="#000080">:  </font>PEditWindow<font color="#000080">;
             </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">;
             </font><font color="#FF0000"><b>Procedure   </b></font>InitMenuBar<font color="#000080">;</font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>Procedure   </b></font>HandleEvent <font color="#000080">( </font><font color="#FF0000"><b>var </b></font>event <font color="#000080">: </font>Tevent<font color="#000080">);</font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>Procedure   </b></font>PrintWindow<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- }

  </i></font><font color="#FF0000"><b>var
    </b></font>Demoapp <font color="#000080">:  </font>TDemoapp<font color="#000080">;

</font><font color="#008000"><i>{ -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- }

  </i></font><font color="#FF0000"><b>Constructor </b></font>TDemoApp<font color="#000080">.</font>Init<font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>r <font color="#000080">: </font>Trect<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>MaxHeapSize <font color="#000080">:=  </font><font color="#800000">2048</font><font color="#000080">;  </font><font color="#008000"><i>(* for a  32k buffer for editors *)
      </i></font>EditorDialog <font color="#000080">:= </font>StdEditorDialog<font color="#000080">;
      </font><font color="#FF0000"><b>inherited </b></font>init<font color="#000080">;
      </font>GetExtent<font color="#000080">(</font>r<font color="#000080">);
      </font>p <font color="#000080">:= </font>New<font color="#000080">(</font>PEditWindow<font color="#000080">, </font>Init <font color="#000080">(</font>r<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">));
      </font>Insertwindow <font color="#000080">( </font>p <font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- }

  </i></font><font color="#FF0000"><b>Procedure </b></font>TDemoApp<font color="#000080">.</font>InitMenuBar<font color="#000080">;
    </font><font color="#FF0000"><b>var
     </b></font>r <font color="#000080">: </font>TRect<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>GetExtent <font color="#000080">( </font>r <font color="#000080">);
      </font>r<font color="#000080">.</font>b<font color="#000080">.</font>y <font color="#000080">:= </font>r<font color="#000080">.</font>a<font color="#000080">.</font>y <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
          </font>menubar <font color="#000080">:= </font>new <font color="#000080">( </font>PMenuBar<font color="#000080">, </font>init <font color="#000080">( </font>r<font color="#000080">, </font>newmenu <font color="#000080">(
      </font>newsubmenu <font color="#000080">( </font><font color="#800000">'~D~emo'</font><font color="#000080">, </font>hcnocontext<font color="#000080">, </font>newmenu <font color="#000080">(
         </font>newitem <font color="#000080">( </font><font color="#800000">'~P~rint'</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">, </font>kbnokey<font color="#000080">, </font>cmprint<font color="#000080">, </font>hcnocontext<font color="#000080">,
                </font><font color="#FF0000"><b>nil</b></font><font color="#000080">)) , </font><font color="#FF0000"><b>nil </b></font><font color="#000080">) )));
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- }

  </i></font><font color="#FF0000"><b>Procedure </b></font>TDemoapp<font color="#000080">.</font>HandleEvent <font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Event <font color="#000080">: </font>TEvent<font color="#000080">);
    </font><font color="#FF0000"><b>Begin
      Inherited </b></font>HandleEvent <font color="#000080">( </font>event <font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>event<font color="#000080">.</font>what <font color="#000080">= </font>evcommand <font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          case </b></font><font color="#000080">( </font>event<font color="#000080">.</font>command <font color="#000080">) </font><font color="#FF0000"><b>of
            </b></font>cmprint <font color="#000080">: </font>PrintWindow<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>ClearEvent <font color="#000080">(</font>event<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- }
  </i></font><font color="#FF0000"><b>Procedure </b></font>TDemoApp<font color="#000080">.</font>PrintWindow<font color="#000080">;
    </font><font color="#FF0000"><b>const
      </b></font>fn <font color="#000080">= </font><font color="#800000">'outfile.txt'</font><font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>t     <font color="#000080">: </font>text<font color="#000080">;
      </font>count <font color="#000080">: </font>longint<font color="#000080">;
      </font>c <font color="#000080">: </font>word<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>Assign <font color="#000080">( </font>t<font color="#000080">, </font>fn<font color="#000080">);
      </font>Rewrite <font color="#000080">(</font>t<font color="#000080">);
      </font>count <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
      </font>c <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>Repeat
        </b></font>inc <font color="#000080">(</font>count<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
        </font>inc <font color="#000080">( </font>c<font color="#000080">, </font><font color="#800000">1 </font><font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>count <font color="#000080">= </font>p<font color="#000080">^.</font>editor<font color="#000080">^.</font>curptr <font color="#000080">) </font><font color="#FF0000"><b>then </b></font>count <font color="#000080">:= </font>count <font color="#000080">+ </font>p<font color="#000080">^.</font>editor<font color="#000080">^.</font>gaplen<font color="#000080">;
        </font>write <font color="#000080">( </font>t<font color="#000080">, </font>p<font color="#000080">^.</font>editor<font color="#000080">^.</font>buffer<font color="#000080">^[ </font>count <font color="#000080">]);
      </font><font color="#FF0000"><b>Until </b></font><font color="#000080">( </font>c <font color="#000080">= </font>p<font color="#000080">^.</font>editor<font color="#000080">^.</font>buflen <font color="#000080">);
      </font>close <font color="#000080">(</font>t<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{ -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- }

</i></font><font color="#FF0000"><b>Begin
  </b></font>DemoApp<font color="#000080">.</font>Init<font color="#000080">;
  </font>DemoApp<font color="#000080">.</font>Run<font color="#000080">;
  </font>DemoApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0095.PAS">Original</a><b>]</b></p></body>
</html>
