<html>
<head><title> "Windows 3-D frames" by STEVE WILLER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ Frames unit - a set of comprehensive (for my purposes) functions for
        drawing pretty 3-D frames of all types. Pretty simple stuff - I'm sure
        you will be able to figure it out - but that's why I included it.
        As always, you are welcome to do whatever with this unit. I only ask that
        if you upload it somewhere modified, keep my name off it, so I don't have
        to answer for your bad code &lt;grin&gt;. If you have any suggestions or
        questions, by all means send them to me - I'd love to hear from a fellow
        programmer.
                Steve Willer
                Mark Data Management
                CIS: 70400,3667
                AOL: SteveWill
}

</i></font><font color="#FF0000"><b>unit </b></font>frames<font color="#000080">;

</font><font color="#FF0000"><b>interface
uses </b></font>WinTypes<font color="#000080">,</font>WinProcs<font color="#000080">,</font>WinDOS<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DrawBorderFrame<font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">;</font>PaintR<font color="#000080">:</font>TRect<font color="#000080">;</font>Back<font color="#000080">:</font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DrawOutFrame<font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">;</font>PaintR<font color="#000080">:</font>TRect<font color="#000080">;</font>Back<font color="#000080">:</font>boolean<font color="#000080">;</font>Width<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DrawInFrame<font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">;</font>PaintR<font color="#000080">:</font>TRect<font color="#000080">;</font>Back<font color="#000080">:</font>boolean<font color="#000080">;</font>Width<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DrawDivLine<font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">;</font>Y<font color="#000080">:</font>integer<font color="#000080">;</font>Width<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DrawDotLine<font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">;</font>PaintR<font color="#000080">:</font>TRect<font color="#000080">;</font>Incr<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>function </b></font>MakeBorBrush<font color="#000080">(</font>HWindow<font color="#000080">:</font>HWnd<font color="#000080">;</font>BackColor1<font color="#000080">,</font>BackColor2<font color="#000080">:</font>TColorRef<font color="#000080">):</font>HBrush<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DrawExplodeFrame<font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">;</font>ExplR<font color="#000080">:</font>TRect<font color="#000080">;</font>PenColor<font color="#000080">,</font>BrushColor<font color="#000080">:</font>TColorRef<font color="#000080">;</font>DrawBrush<font color="#000080">:</font>boolean<font color="#000080">;</font>Width<font color="#000080">:</font>integer<font color="#000080">;
                                </font>Steps<font color="#000080">:</font>integer<font color="#000080">;</font>Pause<font color="#000080">:</font>longint<font color="#000080">);

</font><font color="#FF0000"><b>implementation
procedure </b></font>DrawBorderFrame<font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">;</font>PaintR<font color="#000080">:</font>TRect<font color="#000080">;</font>Back<font color="#000080">:</font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>ThePen<font color="#000080">,</font>OldPen<font color="#000080">:</font>HPen<font color="#000080">;
                </font>FillBrush<font color="#000080">,</font>OldBrush<font color="#000080">:</font>HBrush<font color="#000080">;
</font><font color="#FF0000"><b>begin
        if </b></font>Back <font color="#FF0000"><b>then
        begin
                </b></font>FillBrush <font color="#000080">:= </font>CreateSolidBrush<font color="#000080">(</font><font color="#800000">$00C0C0C0</font><font color="#000080">);
                </font>OldBrush <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>FillBrush<font color="#000080">);
                </font>InflateRect<font color="#000080">(</font>PaintR<font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">);
                </font>FillRect<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">,</font>FillBrush<font color="#000080">);
                </font>InflateRect<font color="#000080">(</font>PaintR<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldBrush<font color="#000080">);
                </font>DeleteObject<font color="#000080">(</font>FillBrush<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font>OldBrush <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>GetStockObject<font color="#000080">(</font>Null_Brush<font color="#000080">));
        </font>ThePen <font color="#000080">:= </font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$00C0C0C0</font><font color="#000080">);
        </font>OldPen <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>ThePen<font color="#000080">);
        </font>PaintR<font color="#000080">.</font>top<font color="#000080">:=</font>PaintR<font color="#000080">.</font>top<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font>PaintR<font color="#000080">.</font>left<font color="#000080">:=</font>PaintR<font color="#000080">.</font>left<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
        </font>Rectangle<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">);
        </font>PaintR<font color="#000080">.</font>top<font color="#000080">:=</font>PaintR<font color="#000080">.</font>top<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
        </font>PaintR<font color="#000080">.</font>left<font color="#000080">:=</font>PaintR<font color="#000080">.</font>left<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldPen<font color="#000080">);
        </font>DeleteObject<font color="#000080">(</font>ThePen<font color="#000080">);
        </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldBrush<font color="#000080">);

        </font>ThePen <font color="#000080">:= </font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>RGB<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">));
        </font>OldPen <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>ThePen<font color="#000080">);
        </font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">);
        </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">);
        </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">);
        </font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">);
        </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">);
        </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
        </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldPen<font color="#000080">);
        </font>DeleteObject<font color="#000080">(</font>ThePen<font color="#000080">);

        </font>ThePen <font color="#000080">:= </font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>RGB<font color="#000080">(</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">));
        </font>OldPen <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>ThePen<font color="#000080">);
        </font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
        </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
        </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">);
        </font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">);
        </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">);
        </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">);
        </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldPen<font color="#000080">);
        </font>DeleteObject<font color="#000080">(</font>ThePen<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DrawOutFrame <font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">; </font>PaintR<font color="#000080">:</font>TRect<font color="#000080">; </font>Back<font color="#000080">:</font>boolean<font color="#000080">; </font>Width<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var
        </b></font>ThePen<font color="#000080">, </font>OldPen<font color="#000080">:</font>HPen<font color="#000080">;
        </font>FillBrush<font color="#000080">, </font>OldBrush<font color="#000080">:</font>HBrush<font color="#000080">;
        </font>count<font color="#000080">:</font>integer<font color="#000080">;
        </font>CalcR<font color="#000080">:</font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
if </b></font>Back <font color="#FF0000"><b>then
        begin
        </b></font>FillBrush <font color="#000080">:= </font>CreateSolidBrush <font color="#000080">(</font><font color="#800000">$00C0C0C0</font><font color="#000080">);
        </font>OldBrush <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>FillBrush<font color="#000080">);
        </font>InflateRect <font color="#000080">(</font>PaintR<font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">*(</font>Width<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">*(</font>Width<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
        </font>FillRect <font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">,</font>FillBrush<font color="#000080">);
        </font>InflateRect <font color="#000080">(</font>PaintR<font color="#000080">,</font>Width<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Width<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
        </font>SelectObject <font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldBrush<font color="#000080">);
        </font>DeleteObject <font color="#000080">(</font>FillBrush<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>CalcR <font color="#000080">:= </font>PaintR<font color="#000080">;

</font><font color="#FF0000"><b>for </b></font>count<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>Width<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
        begin
        </b></font>PaintR <font color="#000080">:= </font>CalcR<font color="#000080">;
        </font>InflateRect <font color="#000080">(</font>PaintR<font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">*(</font>count<font color="#000080">), -</font><font color="#800000">1</font><font color="#000080">*(</font>count<font color="#000080">));

        </font>ThePen <font color="#000080">:= </font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>RGB<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">));
        </font>OldPen <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>ThePen<font color="#000080">);
        </font>MoveTo <font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">);
        </font>LineTo <font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">);
        </font>LineTo <font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
        </font>SelectObject <font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldPen<font color="#000080">);
        </font>DeleteObject <font color="#000080">(</font>ThePen<font color="#000080">);

        </font>ThePen <font color="#000080">:= </font>CreatePen <font color="#000080">(</font>ps_Solid<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>RGB<font color="#000080">(</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">));
        </font>OldPen <font color="#000080">:= </font>SelectObject <font color="#000080">(</font>PaintDC<font color="#000080">,</font>ThePen<font color="#000080">);
        </font>MoveTo <font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
        </font>LineTo <font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">);
        </font>LineTo <font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">);
        </font>SelectObject <font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldPen<font color="#000080">);
        </font>DeleteObject <font color="#000080">(</font>ThePen<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DrawInFrame<font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">;</font>PaintR<font color="#000080">:</font>TRect<font color="#000080">;</font>Back<font color="#000080">:</font>boolean<font color="#000080">;</font>Width<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>ThePen<font color="#000080">,</font>OldPen<font color="#000080">:</font>HPen<font color="#000080">;
                </font>FillBrush<font color="#000080">,</font>OldBrush<font color="#000080">:</font>HBrush<font color="#000080">;
                </font>count<font color="#000080">:</font>integer<font color="#000080">;
                </font>CalcR<font color="#000080">:</font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
        if </b></font>Back <font color="#FF0000"><b>then
        begin
                </b></font>FillBrush <font color="#000080">:= </font>CreateSolidBrush<font color="#000080">(</font><font color="#800000">$00C0C0C0</font><font color="#000080">);
                </font>OldBrush <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>FillBrush<font color="#000080">);
                </font>InflateRect<font color="#000080">(</font>PaintR<font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">*(</font>Width<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">*(</font>Width<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
                </font>FillRect<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">,</font>FillBrush<font color="#000080">);
                </font>InflateRect<font color="#000080">(</font>PaintR<font color="#000080">,</font>Width<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Width<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
                </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldBrush<font color="#000080">);
                </font>DeleteObject<font color="#000080">(</font>FillBrush<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font>CalcR<font color="#000080">:=</font>PaintR<font color="#000080">;

        </font><font color="#FF0000"><b>for </b></font>count<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>Width<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
        begin
                </b></font>PaintR<font color="#000080">:=</font>CalcR<font color="#000080">;
                </font>InflateRect<font color="#000080">(</font>PaintR<font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">*(</font>count<font color="#000080">),-</font><font color="#800000">1</font><font color="#000080">*(</font>count<font color="#000080">));

                </font>ThePen <font color="#000080">:= </font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>RGB<font color="#000080">(</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">));
                </font>OldPen <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>ThePen<font color="#000080">);
                </font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">);
                </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">);
                </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">);
                </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldPen<font color="#000080">);
                </font>DeleteObject<font color="#000080">(</font>ThePen<font color="#000080">);

                </font>ThePen <font color="#000080">:= </font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>RGB<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">));
                </font>OldPen <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>ThePen<font color="#000080">);
                </font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
                </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">);
                </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">);
                </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldPen<font color="#000080">);
                </font>DeleteObject<font color="#000080">(</font>ThePen<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DrawDivLine<font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">;</font>Y<font color="#000080">:</font>integer<font color="#000080">;</font>Width<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>ThePen<font color="#000080">,</font>OldPen<font color="#000080">:</font>HPen<font color="#000080">;
                </font>FillBrush<font color="#000080">,</font>OldBrush<font color="#000080">:</font>HBrush<font color="#000080">;
                </font>count<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
                </b></font>ThePen <font color="#000080">:= </font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font>Width<font color="#000080">,</font>RGB<font color="#000080">(</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">));
                </font>OldPen <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>ThePen<font color="#000080">);
                </font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>GetSystemMetrics<font color="#000080">(</font>sm_CXScreen<font color="#000080">),</font>Y<font color="#000080">);
                </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>Y<font color="#000080">);
                </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldPen<font color="#000080">);
                </font>DeleteObject<font color="#000080">(</font>ThePen<font color="#000080">);
                </font>Y<font color="#000080">:=</font>Y<font color="#000080">+</font>Width<font color="#000080">;
                </font>ThePen <font color="#000080">:= </font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font>Width<font color="#000080">,</font>RGB<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">));
                </font>OldPen <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>ThePen<font color="#000080">);
                </font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font>GetSystemMetrics<font color="#000080">(</font>sm_CXScreen<font color="#000080">),</font>Y<font color="#000080">);
                </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>Y<font color="#000080">);
                </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldPen<font color="#000080">);
                </font>DeleteObject<font color="#000080">(</font>ThePen<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DrawDotLine<font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">;</font>PaintR<font color="#000080">:</font>TRect<font color="#000080">;</font>Incr<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>ROP2<font color="#000080">:</font>integer<font color="#000080">;
                </font>count<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
        </b></font>ROP2 <font color="#000080">:= </font>GetROP2<font color="#000080">(</font>PaintDC<font color="#000080">);
        </font>SetROP2<font color="#000080">(</font>PaintDC<font color="#000080">,</font>r2_Not<font color="#000080">);
        </font>count <font color="#000080">:= </font>PaintR<font color="#000080">.</font>left<font color="#000080">;
        </font><font color="#FF0000"><b>while </b></font>count <font color="#000080">&lt; </font>PaintR<font color="#000080">.</font>right<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
                begin
                        </b></font>SetPixel<font color="#000080">(</font>PaintDC<font color="#000080">,</font>count<font color="#000080">,</font>PaintR<font color="#000080">.</font>top<font color="#000080">,</font><font color="#800000">$00000000</font><font color="#000080">);
                        </font>SetPixel<font color="#000080">(</font>PaintDC<font color="#000080">,</font>count<font color="#000080">,</font>PaintR<font color="#000080">.</font>bottom<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$00000000</font><font color="#000080">);
                        </font>count <font color="#000080">:= </font>count <font color="#000080">+ </font>Incr<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>count <font color="#000080">:= </font>PaintR<font color="#000080">.</font>top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">;
        </font><font color="#FF0000"><b>while </b></font>count <font color="#000080">&lt; </font>PaintR<font color="#000080">.</font>bottom<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
                begin
                        </b></font>SetPixel<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>left<font color="#000080">,</font>count<font color="#000080">,</font><font color="#800000">$00000000</font><font color="#000080">);
                        </font>SetPixel<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintR<font color="#000080">.</font>right<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>count<font color="#000080">,</font><font color="#800000">$00000000</font><font color="#000080">);
                        </font>count <font color="#000080">:= </font>count <font color="#000080">+ </font>Incr<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>SetROP2<font color="#000080">(</font>PaintDC<font color="#000080">,</font>ROP2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>MakeBorBrush<font color="#000080">(</font>HWindow<font color="#000080">:</font>HWnd<font color="#000080">;</font>BackColor1<font color="#000080">,</font>BackColor2<font color="#000080">:</font>TColorRef<font color="#000080">):</font>HBrush<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>DC<font color="#000080">,</font>MemDC<font color="#000080">:</font>HDC<font color="#000080">;
                </font>Bits<font color="#000080">:</font>HBitmap<font color="#000080">;
                </font>FillR<font color="#000080">:</font>TRect<font color="#000080">;
                </font>TheBrush<font color="#000080">,</font>OldBrush<font color="#000080">:</font>HBrush<font color="#000080">;
</font><font color="#FF0000"><b>begin
        </b></font>DC<font color="#000080">:=</font>CreateDC<font color="#000080">(</font><font color="#800000">'display'</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
        </font>MemDC<font color="#000080">:=</font>CreateCompatibleDC<font color="#000080">(</font>DC<font color="#000080">);
        </font>Bits<font color="#000080">:=</font>CreateCompatibleBitmap<font color="#000080">(</font>DC<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
        </font>SelectObject<font color="#000080">(</font>MemDC<font color="#000080">,</font>Bits<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>Bits<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
        begin
                </b></font>TheBrush<font color="#000080">:=</font>CreateSolidBrush<font color="#000080">(</font>GetNearestColor<font color="#000080">(</font>DC<font color="#000080">,</font>BackColor2<font color="#000080">));
                </font>OldBrush<font color="#000080">:=</font>SelectObject<font color="#000080">(</font>MemDC<font color="#000080">,</font>TheBrush<font color="#000080">);
                </font>PatBlt<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font>Blackness<font color="#000080">);
                </font><font color="#FF0000"><b>with </b></font>FillR <font color="#FF0000"><b>do begin
                        </b></font>left<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;</font>right<font color="#000080">:=</font><font color="#800000">8</font><font color="#000080">;</font>top<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;</font>bottom<font color="#000080">:=</font><font color="#800000">8</font><font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font>FillRect<font color="#000080">(</font>MemDC<font color="#000080">,</font>FillR<font color="#000080">,</font>TheBrush<font color="#000080">);
                </font>SelectObject<font color="#000080">(</font>MemDC<font color="#000080">,</font>OldBrush<font color="#000080">);
                </font>DeleteObject<font color="#000080">(</font>TheBrush<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>SetPixel<font color="#000080">(</font>MemDC<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font>BackColor1<font color="#000080">);
                </font>MakeBorBrush<font color="#000080">:=</font>CreatePatternBrush<font color="#000080">(</font>Bits<font color="#000080">);
        </font><font color="#FF0000"><b>end else </b></font>MakeBorBrush<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font>DeleteDC<font color="#000080">(</font>MemDC<font color="#000080">);
        </font>DeleteDC<font color="#000080">(</font>DC<font color="#000080">);
        </font>DeleteObject<font color="#000080">(</font>Bits<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DrawExplodeFrame<font color="#000080">(</font>PaintDC<font color="#000080">:</font>HDC<font color="#000080">;</font>ExplR<font color="#000080">:</font>TRect<font color="#000080">;</font>PenColor<font color="#000080">,</font>BrushColor<font color="#000080">:</font>TColorRef<font color="#000080">;</font>DrawBrush<font color="#000080">:</font>boolean<font color="#000080">;</font>Width<font color="#000080">:</font>integer<font color="#000080">;
                        </font>Steps<font color="#000080">:</font>integer<font color="#000080">;</font>Pause<font color="#000080">:</font>longint<font color="#000080">);
</font><font color="#FF0000"><b>var        </b></font>count<font color="#000080">:</font>integer<font color="#000080">;
                </font>dX<font color="#000080">,</font>dY<font color="#000080">:</font>double<font color="#000080">;
                </font>ThePen<font color="#000080">,</font>OldPen<font color="#000080">:</font>HPen<font color="#000080">;
                </font>TheBrush<font color="#000080">,</font>OldBrush<font color="#000080">:</font>HBrush<font color="#000080">;
                </font>OrigR<font color="#000080">:</font>TRect<font color="#000080">;
                </font>TimeCount<font color="#000080">:</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
        </b></font>ThePen <font color="#000080">:= </font>CreatePen<font color="#000080">(</font>ps_Dot<font color="#000080">,</font>Width<font color="#000080">,</font>PenColor<font color="#000080">);
        </font>OldPen <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>ThePen<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>DrawBrush <font color="#FF0000"><b>then
                </b></font>TheBrush<font color="#000080">:=</font>CreateSolidBrush<font color="#000080">(</font>BrushColor<font color="#000080">) </font><font color="#FF0000"><b>else
                </b></font>TheBrush <font color="#000080">:= </font>GetStockObject<font color="#000080">(</font>Null_Brush<font color="#000080">);
        </font>OldBrush<font color="#000080">:= </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>TheBrush<font color="#000080">);
        </font>dY<font color="#000080">:=(</font>ExplR<font color="#000080">.</font>bottom<font color="#000080">-</font>ExplR<font color="#000080">.</font>top<font color="#000080">)/</font>Steps<font color="#000080">;
        </font>dX<font color="#000080">:=(</font>ExplR<font color="#000080">.</font>right<font color="#000080">-</font>ExplR<font color="#000080">.</font>left<font color="#000080">)/</font>Steps<font color="#000080">;
        </font><font color="#FF0000"><b>with </b></font>ExplR <font color="#FF0000"><b>do
        begin
                </b></font>left<font color="#000080">:=</font>left<font color="#000080">+((</font>right<font color="#000080">-</font>left<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
                </font>top<font color="#000080">:=</font>top<font color="#000080">+((</font>bottom<font color="#000080">-</font>top<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
                </font>right<font color="#000080">:=</font>left<font color="#000080">;</font>bottom<font color="#000080">:=</font>top<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>OrigR<font color="#000080">:=</font>ExplR<font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>count<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>steps <font color="#FF0000"><b>do
        begin
                with </b></font>ExplR <font color="#FF0000"><b>do
                begin
                        </b></font>TimeCount <font color="#000080">:= </font>GetTickCount<font color="#000080">;
                        </font>left<font color="#000080">:=</font>OrigR<font color="#000080">.</font>left<font color="#000080">-</font>integer<font color="#000080">(</font>Round<font color="#000080">(</font>dX<font color="#000080">*</font>count<font color="#000080">));
                        </font>right<font color="#000080">:=</font>OrigR<font color="#000080">.</font>right<font color="#000080">+</font>integer<font color="#000080">(</font>Round<font color="#000080">(</font>dX<font color="#000080">*</font>count<font color="#000080">));
                        </font>bottom<font color="#000080">:=</font>OrigR<font color="#000080">.</font>bottom<font color="#000080">-</font>integer<font color="#000080">(</font>Round<font color="#000080">(</font>dY<font color="#000080">*</font>count<font color="#000080">));
                        </font>top<font color="#000080">:=</font>OrigR<font color="#000080">.</font>top<font color="#000080">+</font>integer<font color="#000080">(</font>Round<font color="#000080">(</font>dY<font color="#000080">*</font>count<font color="#000080">));
                        </font>Rectangle<font color="#000080">(</font>PaintDC<font color="#000080">,</font>left<font color="#000080">,</font>top<font color="#000080">,</font>right<font color="#000080">,</font>bottom<font color="#000080">);
                        </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>GetTickCount <font color="#000080">- </font>TimeCount<font color="#000080">) &lt; </font>Pause <font color="#FF0000"><b>do begin end</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldBrush<font color="#000080">);
        </font>DeleteObject<font color="#000080">(</font>TheBrush<font color="#000080">);
        </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">,</font>OldPen<font color="#000080">);
        </font>DeleteObject<font color="#000080">(</font>ThePen<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p></body>
</html>
