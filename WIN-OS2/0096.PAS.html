<html>
<head><title> "A color windows unit for TP WIN" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0096.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">            <font color="#008000"><i>(***************************************************)
            (*                 The Color Window                *)
            (*-------------------------------------------------*)
            (*  Copyright (c) 1995-`97 UNIVERSAL SOFTWARE Inc  *)
            (*               All Rights Reserved               *)
            (***************************************************)

{ example program at the end !! }

</i></font><font color="#FF0000"><b>unit </b></font>ColorWin<font color="#000080">;

</font><font color="#008000"><i>{$S-}

</i></font><font color="#FF0000"><b>INTERFACE

uses
 </b></font>WinTypes<font color="#000080">,
 </font>WinProcs<font color="#000080">,
 </font>oWindows<font color="#000080">;

</font><font color="#008000"><i>(************************************************************)
(****************** TpCrt types, consts, vars ***************)
(************************************************************)

</i></font><font color="#FF0000"><b>type
 </b></font><font color="#008000"><i>{ the color window object }
 </i></font>pColorWin<font color="#000080">=^</font>tColorWin<font color="#000080">;
 </font>tColorWin<font color="#000080">=</font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>tWindow<font color="#000080">)
  </font>ScreenSize<font color="#000080">:</font>tPoint<font color="#000080">;
  </font>CharBuffer<font color="#000080">:</font>pChar<font color="#000080">;
  </font>AttrBuffer<font color="#000080">:</font>pChar<font color="#000080">;
  </font>TextAttr<font color="#000080">:</font>byte<font color="#000080">;
  </font>TextChar<font color="#000080">:</font>char<font color="#000080">;
  </font>CharSize<font color="#000080">:</font>tPoint<font color="#000080">;
  </font>CharAscent<font color="#000080">:</font>integer<font color="#000080">;
  </font>Range<font color="#000080">:</font>tPoint<font color="#000080">;        </font><font color="#008000"><i>{ scrollbar ranges }
  </i></font>Origin<font color="#000080">:</font>tPoint<font color="#000080">;       </font><font color="#008000"><i>{ client area origin }
  </i></font>ClientSize<font color="#000080">:</font>tPoint<font color="#000080">;   </font><font color="#008000"><i>{ client area dimensions }
  { colorwin methods }
  </i></font><font color="#FF0000"><b>procedure </b></font>Byte2bkRgb<font color="#000080">(</font>c<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>bkRGB<font color="#000080">:</font>tColorRef<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>Byte2fgRgb<font color="#000080">(</font>c<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>fgRGB<font color="#000080">:</font>tColorRef<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>Byte2rgb<font color="#000080">(</font>c<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>bkRGB<font color="#000080">:</font>tColorRef<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>fgRGB<font color="#000080">:</font>tColorRef<font color="#000080">);
  </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font>AParent<font color="#000080">:</font>pWindowsObject<font color="#000080">; </font>aTitle<font color="#000080">:</font>pChar<font color="#000080">);
  </font><font color="#FF0000"><b>destructor </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>GetClassName<font color="#000080">: </font>pChar<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>GetWindowClass<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>aWndClass<font color="#000080">: </font>tWndClass<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>wmSize<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">:</font>tMessage<font color="#000080">); </font><font color="#FF0000"><b>virtual </b></font>wm_First<font color="#000080">+</font>wm_Size<font color="#000080">;
  </font><font color="#008000"><i>{---}
  </i></font><font color="#FF0000"><b>function </b></font>GetNewPos<font color="#000080">(</font>Action<font color="#000080">:</font>word<font color="#000080">; </font>Pos<font color="#000080">,</font>Page<font color="#000080">,</font>_Range<font color="#000080">, </font>Thumb<font color="#000080">:</font>integer<font color="#000080">):</font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>wmVScroll<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">:</font>tMessage<font color="#000080">); </font><font color="#FF0000"><b>virtual </b></font>wm_First<font color="#000080">+</font>wm_VScroll<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>wmHScroll<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">:</font>tMessage<font color="#000080">); </font><font color="#FF0000"><b>virtual </b></font>wm_First<font color="#000080">+</font>wm_HScroll<font color="#000080">;
  </font><font color="#008000"><i>{---}
  </i></font><font color="#FF0000"><b>procedure </b></font>SetScrollBars<font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>CharPtr<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">):</font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>AttrPtr<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">):</font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>Paint<font color="#000080">(</font>PaintDC<font color="#000080">:</font>hDC<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>PS<font color="#000080">:</font>tPaintStruct<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>ClrScr<font color="#000080">;
  </font><font color="#008000"><i>{\-clear current window}
  </i></font><font color="#FF0000"><b>procedure </b></font>ScrollTo<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>FastWrite<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Row<font color="#000080">,</font>Col<font color="#000080">,</font>_Attr<font color="#000080">:</font>byte<font color="#000080">);
  </font><font color="#008000"><i>{\-write St at Row,Col in Attr (video attribute)}
  </i></font><font color="#FF0000"><b>procedure </b></font>FastFill<font color="#000080">(</font>Number<font color="#000080">:</font>word<font color="#000080">; </font>Ch<font color="#000080">:</font>char<font color="#000080">; </font>Row<font color="#000080">,</font>Col<font color="#000080">,</font>_Attr<font color="#000080">:</font>byte<font color="#000080">);
  </font><font color="#008000"><i>{\-fill Number chs at Row,Col in Attr (video attribute)}
  </i></font><font color="#FF0000"><b>procedure </b></font>FastCenter<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Row<font color="#000080">,</font>_Attr<font color="#000080">:</font>byte<font color="#000080">);
  </font><font color="#008000"><i>{\-write St centered on window Row in Attr (video attribute)}
 </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

</b></font><font color="#008000"><i>{ Double word record }
</i></font><font color="#FF0000"><b>type
 </b></font>LongRec<font color="#000080">=</font><font color="#FF0000"><b>record
  </b></font>Lo<font color="#000080">,</font>Hi<font color="#000080">:</font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const
 </b></font>vgaColor<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>tColorRef<font color="#000080">=(
  </font><font color="#800000">$00000000</font><font color="#000080">,   </font><font color="#008000"><i>{ Black }
  </i></font><font color="#800000">$00800000</font><font color="#000080">,   </font><font color="#008000"><i>{ Dark Cyan }
  </i></font><font color="#800000">$00008000</font><font color="#000080">,   </font><font color="#008000"><i>{ Dark Green}
  </i></font><font color="#800000">$00808000</font><font color="#000080">,   </font><font color="#008000"><i>{ Dark Blue }
  </i></font><font color="#800000">$00000080</font><font color="#000080">,   </font><font color="#008000"><i>{ Dark red }
  </i></font><font color="#800000">$00800080</font><font color="#000080">,   </font><font color="#008000"><i>{ Dark violet }
  </i></font><font color="#800000">$00008080</font><font color="#000080">,   </font><font color="#008000"><i>{ Brown }
  </i></font><font color="#800000">$00C0C0C0</font><font color="#000080">,   </font><font color="#008000"><i>{ light Gray }
  </i></font><font color="#800000">$00808080</font><font color="#000080">,   </font><font color="#008000"><i>{ Dark Gray }
  </i></font><font color="#800000">$00FF0000</font><font color="#000080">,   </font><font color="#008000"><i>{ light blue }
  </i></font><font color="#800000">$0000FF00</font><font color="#000080">,   </font><font color="#008000"><i>{ light green }
  </i></font><font color="#800000">$00FFFF00</font><font color="#000080">,   </font><font color="#008000"><i>{ Blue }
  </i></font><font color="#800000">$000000FF</font><font color="#000080">,   </font><font color="#008000"><i>{ light red }
  </i></font><font color="#800000">$00FF00FF</font><font color="#000080">,   </font><font color="#008000"><i>{ violet }
  </i></font><font color="#800000">$0000FFFF</font><font color="#000080">,   </font><font color="#008000"><i>{ yellow }
  </i></font><font color="#800000">$00FFFFFF    </font><font color="#008000"><i>{ White }
 </i></font><font color="#000080">);

</font><font color="#FF0000"><b>type
 </b></font>BufPtr<font color="#000080">=^</font>BufferArray<font color="#000080">;
 </font>BufferArray<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MaxInt<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Min<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">):</font>integer<font color="#000080">;
</font><font color="#008000"><i>{Return the smaller of two integer values}
</i></font><font color="#FF0000"><b>begin
 if </b></font>X <font color="#000080">&lt;</font>Y <font color="#FF0000"><b>then </b></font>Min<font color="#000080">:=</font>X <font color="#FF0000"><b>else </b></font>Min<font color="#000080">:=</font>Y<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Max<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">):</font>integer<font color="#000080">;
</font><font color="#008000"><i>{Return the larger of two integer values}
</i></font><font color="#FF0000"><b>begin
  if </b></font>X <font color="#000080">&gt;</font>Y <font color="#FF0000"><b>then </b></font>Max<font color="#000080">:=</font>X <font color="#FF0000"><b>else </b></font>Max<font color="#000080">:=</font>Y<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(*** colorwin ***)
</i></font><font color="#FF0000"><b>constructor </b></font>tColorWin<font color="#000080">.</font>Init<font color="#000080">(</font>aParent<font color="#000080">:</font>pWindowsObject<font color="#000080">; </font>aTitle<font color="#000080">:</font>pChar<font color="#000080">);
</font><font color="#FF0000"><b>begin
 inherited </b></font>Init<font color="#000080">(</font>aParent<font color="#000080">,</font>aTitle<font color="#000080">);
 </font>Attr<font color="#000080">.</font>Style<font color="#000080">:=</font>Attr<font color="#000080">.</font>Style <font color="#FF0000"><b>or </b></font>ws_HScroll <font color="#FF0000"><b>or </b></font>ws_VScroll <font color="#FF0000"><b>or </b></font>cs_ByteAlignClient<font color="#000080">;
             </font><font color="#008000"><i>{ws_Border or ws_Child or ws_Visible or
             ws_HScroll or ws_VScroll or
             cs_ByteAlignClient;}
 </i></font><font color="#FF0000"><b>with </b></font>ScreenSize <font color="#FF0000"><b>do begin
  </b></font>X<font color="#000080">:=</font><font color="#800000">80</font><font color="#000080">;  </font><font color="#008000"><i>{ screen width \ in chars }
  </i></font>Y<font color="#000080">:=</font><font color="#800000">25</font><font color="#000080">;  </font><font color="#008000"><i>{ screen height/          }
  </i></font>TextAttr<font color="#000080">:=</font><font color="#800000">$03</font><font color="#000080">;
  </font>TextChar<font color="#000080">:=</font><font color="#800000">'*'</font><font color="#000080">;
  </font>CharSize<font color="#000080">.</font>X<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>CharSize<font color="#000080">.</font>Y<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>CharAscent<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>Origin<font color="#000080">.</font>X<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>Origin<font color="#000080">.</font>Y<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>Range<font color="#000080">.</font>X<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>Range<font color="#000080">.</font>Y<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>GetMem<font color="#000080">(</font>CharBuffer<font color="#000080">,(</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
  </font>GetMem<font color="#000080">(</font>AttrBuffer<font color="#000080">,(</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
  </font>FillChar<font color="#000080">(</font>CharBuffer<font color="#000080">^,</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">,</font>TextChar<font color="#000080">);
  </font>FillChar<font color="#000080">(</font>AttrBuffer<font color="#000080">^,</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">,</font>char<font color="#000080">(</font>TextAttr<font color="#000080">));
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>tColorWin<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>begin
 with </b></font>ScreenSize <font color="#FF0000"><b>do begin
  </b></font>FreeMem<font color="#000080">(</font>CharBuffer<font color="#000080">, </font>X<font color="#000080">*</font>Y<font color="#000080">);
  </font>FreeMem<font color="#000080">(</font>AttrBuffer<font color="#000080">, </font>X<font color="#000080">*</font>Y<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>inherited </b></font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>SetupWindow<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>DC<font color="#000080">:</font>hDC<font color="#000080">;
 </font>Metrics<font color="#000080">:</font>tTextMetric<font color="#000080">;

</font><font color="#FF0000"><b>begin
 inherited </b></font>SetupWindow<font color="#000080">;
 </font>DC<font color="#000080">:=</font>GetDC<font color="#000080">(</font>hWindow<font color="#000080">);
 </font>SelectObject<font color="#000080">(</font>DC<font color="#000080">,</font>GetStockObject<font color="#000080">(</font>System_Fixed_Font<font color="#000080">));
 </font>GetTextMetrics<font color="#000080">(</font>DC<font color="#000080">,</font>Metrics<font color="#000080">);
 </font><font color="#FF0000"><b>with </b></font>Metrics<font color="#000080">, </font>CharSize  <font color="#FF0000"><b>do begin
  </b></font>X<font color="#000080">:=</font>tmMaxCharWidth<font color="#000080">;
  </font>Y<font color="#000080">:=</font>tmHeight<font color="#000080">+</font>tmExternalLeading<font color="#000080">;
  </font>CharAscent<font color="#000080">:=</font>tmAscent<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>DeleteDC<font color="#000080">(</font>DC<font color="#000080">);
 </font>SetScrollRange<font color="#000080">(</font>hWindow<font color="#000080">,</font>sb_Horz<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>false<font color="#000080">);
 </font>SetScrollRange<font color="#000080">(</font>hWindow<font color="#000080">,</font>sb_Vert<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>false<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>tColorWin<font color="#000080">.</font>GetClassName<font color="#000080">:</font>pChar<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>GetClassName<font color="#000080">:=</font><font color="#800000">'ColorWin'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>GetWindowClass<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>aWndClass<font color="#000080">:</font>tWndClass<font color="#000080">);
</font><font color="#FF0000"><b>begin
 inherited </b></font>GetWindowClass<font color="#000080">(</font>aWndClass<font color="#000080">);
 </font>aWndClass<font color="#000080">.</font>hIcon<font color="#000080">:=</font>LoadIcon<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>idi_Application<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>wmSize<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">:</font>tMessage<font color="#000080">);
</font><font color="#FF0000"><b>var
 </b></font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
 with </b></font>Msg <font color="#FF0000"><b>do begin
  </b></font>x<font color="#000080">:=</font>LoWord<font color="#000080">(</font>Msg<font color="#000080">.</font>lParam<font color="#000080">);
  </font>y<font color="#000080">:=</font>HiWord<font color="#000080">(</font>Msg<font color="#000080">.</font>lParam<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>ClientSize<font color="#000080">.</font>X<font color="#000080">:=</font>X <font color="#FF0000"><b>div </b></font>CharSize<font color="#000080">.</font>X<font color="#000080">;
 </font>ClientSize<font color="#000080">.</font>Y<font color="#000080">:=</font>Y <font color="#FF0000"><b>div </b></font>CharSize<font color="#000080">.</font>Y<font color="#000080">;
 </font>Range<font color="#000080">.</font>X<font color="#000080">:=</font>Max<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">-</font>ClientSize<font color="#000080">.</font>X<font color="#000080">);
 </font>Range<font color="#000080">.</font>Y<font color="#000080">:=</font>Max<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">-</font>ClientSize<font color="#000080">.</font>Y<font color="#000080">);
 </font>Origin<font color="#000080">.</font>X<font color="#000080">:=</font>Min<font color="#000080">(</font>Origin<font color="#000080">.</font>X<font color="#000080">, </font>Range<font color="#000080">.</font>X<font color="#000080">);
 </font>Origin<font color="#000080">.</font>Y<font color="#000080">:=</font>Min<font color="#000080">(</font>Origin<font color="#000080">.</font>Y<font color="#000080">, </font>Range<font color="#000080">.</font>Y<font color="#000080">);
 </font>SetScrollBars<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>tColorWin<font color="#000080">.</font>CharPtr<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">):</font>pChar<font color="#000080">;
</font><font color="#008000"><i>{Return pointer to the Char at (X,Y) in the screen buffer}
</i></font><font color="#FF0000"><b>begin
 </b></font>CharPtr<font color="#000080">:=@</font>CharBuffer<font color="#000080">[</font>Y<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">+</font>X<font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>tColorWin<font color="#000080">.</font>AttrPtr<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">):</font>pChar<font color="#000080">;
</font><font color="#008000"><i>{Return pointer to the Attr at (X,Y) in the screen buffer}
</i></font><font color="#FF0000"><b>begin
 </b></font>AttrPtr<font color="#000080">:=@</font>AttrBuffer<font color="#000080">[</font>Y<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">+</font>X<font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>SetScrollBars<font color="#000080">;
</font><font color="#008000"><i>{Update scroll bars}
</i></font><font color="#FF0000"><b>begin
 </b></font>SetScrollRange<font color="#000080">(</font>hWindow<font color="#000080">, </font>sb_Horz<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Max<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>Range<font color="#000080">.</font>X<font color="#000080">), </font>false<font color="#000080">);
 </font>SetScrollPos<font color="#000080">(</font>hWindow<font color="#000080">, </font>sb_Horz<font color="#000080">, </font>Origin<font color="#000080">.</font>X<font color="#000080">, </font>true<font color="#000080">);
 </font>SetScrollRange<font color="#000080">(</font>hWindow<font color="#000080">, </font>sb_Vert<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Max<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>Range<font color="#000080">.</font>Y<font color="#000080">), </font>false<font color="#000080">);
 </font>SetScrollPos<font color="#000080">(</font>hWindow<font color="#000080">, </font>sb_Vert<font color="#000080">, </font>Origin<font color="#000080">.</font>Y<font color="#000080">, </font>true<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>ScrollTo<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#008000"><i>{Scroll window to given origin}
</i></font><font color="#FF0000"><b>begin
 </b></font>X<font color="#000080">:=</font>Max<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>Min<font color="#000080">(</font>X<font color="#000080">,</font>Range<font color="#000080">.</font>X<font color="#000080">));
 </font>Y<font color="#000080">:=</font>Max<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>Min<font color="#000080">(</font>Y<font color="#000080">,</font>Range<font color="#000080">.</font>Y<font color="#000080">));
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>X <font color="#000080">&lt;&gt;</font>Origin<font color="#000080">.</font>X<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Y <font color="#000080">&lt;&gt;</font>Origin<font color="#000080">.</font>Y<font color="#000080">) </font><font color="#FF0000"><b>then begin
  if </b></font>X <font color="#000080">&lt;&gt;</font>Origin<font color="#000080">.</font>X <font color="#FF0000"><b>then </b></font>SetScrollPos<font color="#000080">(</font>hWindow<font color="#000080">,</font>sb_Horz<font color="#000080">,</font>X<font color="#000080">,</font>true<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Y <font color="#000080">&lt;&gt;</font>Origin<font color="#000080">.</font>Y <font color="#FF0000"><b>then </b></font>SetScrollPos<font color="#000080">(</font>hWindow<font color="#000080">,</font>sb_Vert<font color="#000080">,</font>Y<font color="#000080">,</font>true<font color="#000080">);
  </font>ScrollWindow<font color="#000080">(</font>hWindow<font color="#000080">,(</font>Origin<font color="#000080">.</font>X<font color="#000080">-</font>X<font color="#000080">)*</font>CharSize<font color="#000080">.</font>X<font color="#000080">,(</font>Origin<font color="#000080">.</font>Y<font color="#000080">-</font>Y<font color="#000080">)*</font>CharSize<font color="#000080">.</font>Y<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
  </font>Origin<font color="#000080">.</font>X<font color="#000080">:=</font>X<font color="#000080">;
  </font>Origin<font color="#000080">.</font>Y<font color="#000080">:=</font>Y<font color="#000080">;
  </font>UpdateWindow<font color="#000080">(</font>hWindow<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>Byte2bkRgb<font color="#000080">(</font>c<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>bkRGB<font color="#000080">:</font>tColorRef<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>bkRGB<font color="#000080">:=</font>vgaColor<font color="#000080">[</font>c <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>Byte2fgRgb<font color="#000080">(</font>c<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>fgRGB<font color="#000080">:</font>tColorRef<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>fgRGB<font color="#000080">:=</font>vgaColor<font color="#000080">[</font>c <font color="#FF0000"><b>and </b></font><font color="#800000">$F</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>Byte2rgb<font color="#000080">(</font>c<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>bkRGB<font color="#000080">:</font>tColorRef<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>fgRGB<font color="#000080">:</font>tColorRef<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>bkRGB<font color="#000080">:=</font>vgaColor<font color="#000080">[</font>c <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">];
 </font>fgRGB<font color="#000080">:=</font>vgaColor<font color="#000080">[</font>c <font color="#FF0000"><b>and </b></font><font color="#800000">$F</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>ClrScr<font color="#000080">;
</font><font color="#008000"><i>{Clear the screen}
</i></font><font color="#FF0000"><b>var
 </b></font>_y<font color="#000080">:</font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>FillChar<font color="#000080">(</font>CharBuffer<font color="#000080">^,</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">,</font>TextChar<font color="#000080">);
 </font>FillChar<font color="#000080">(</font>AttrBuffer<font color="#000080">^,</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">,</font>char<font color="#000080">(</font>TextAttr<font color="#000080">));
 </font>Longint<font color="#000080">(</font>Origin<font color="#000080">):=</font><font color="#800000">0</font><font color="#000080">;
 </font>SetScrollBars<font color="#000080">;
 </font>InvalidateRect<font color="#000080">(</font>hWindow<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>false <font color="#008000"><i>{true}</i></font><font color="#000080">);
 </font>UpdateWindow<font color="#000080">(</font>hWindow<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>Paint<font color="#000080">(</font>PaintDC<font color="#000080">:</font>hDC<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>PS<font color="#000080">:</font>tPaintStruct<font color="#000080">);
</font><font color="#008000"><i>{wm_Paint message handler}
</i></font><font color="#FF0000"><b>var
 </b></font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">:</font>integer<font color="#000080">;
 </font>bkRGB<font color="#000080">,</font>fgRGB<font color="#000080">:</font>tColorRef<font color="#000080">;
 </font>i<font color="#000080">:</font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">, </font>GetStockObject<font color="#000080">(</font>System_Fixed_Font<font color="#000080">));
 </font><font color="#008000"><i>{---}
 </i></font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">, </font>ScreenSize<font color="#000080">.</font>X<font color="#000080">*</font>CharSize<font color="#000080">.</font>X<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
 </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">, </font>ScreenSize<font color="#000080">.</font>X<font color="#000080">*</font>CharSize<font color="#000080">.</font>X<font color="#000080">,</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">*</font>CharSize<font color="#000080">.</font>Y<font color="#000080">);
 </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">,</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">*</font>CharSize<font color="#000080">.</font>Y<font color="#000080">);
 </font>X1<font color="#000080">:=</font>Max<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>PS<font color="#000080">.</font>rcPaint<font color="#000080">.</font>left <font color="#FF0000"><b>div </b></font>CharSize<font color="#000080">.</font>X<font color="#000080">+</font>Origin<font color="#000080">.</font>X<font color="#000080">);
 </font>X2<font color="#000080">:=</font>Min<font color="#000080">((</font>PS<font color="#000080">.</font>rcPaint<font color="#000080">.</font>right<font color="#000080">+</font>CharSize<font color="#000080">.</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font>CharSize<font color="#000080">.</font>X<font color="#000080">+</font>Origin<font color="#000080">.</font>X<font color="#000080">,</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">);
 </font>Y1<font color="#000080">:=</font>Max<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>PS<font color="#000080">.</font>rcPaint<font color="#000080">.</font>top <font color="#FF0000"><b>div </b></font>CharSize<font color="#000080">.</font>Y<font color="#000080">+</font>Origin<font color="#000080">.</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
 </font>Y2<font color="#000080">:=</font>Min<font color="#000080">((</font>PS<font color="#000080">.</font>rcPaint<font color="#000080">.</font>bottom<font color="#000080">+</font>CharSize<font color="#000080">.</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font>CharSize<font color="#000080">.</font>Y<font color="#000080">+</font>Origin<font color="#000080">.</font>Y<font color="#000080">,</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">);
 </font><font color="#FF0000"><b>while </b></font>Y1 <font color="#000080">&lt;</font>Y2 <font color="#FF0000"><b>do begin
  for </b></font>i<font color="#000080">:=</font>X1 <font color="#FF0000"><b>to </b></font>X2 <font color="#FF0000"><b>do begin
   </b></font>Byte2rgb<font color="#000080">(</font>byte<font color="#000080">(</font>AttrPtr<font color="#000080">(</font>i<font color="#000080">,</font>Y1<font color="#000080">)^),</font>bkRGB<font color="#000080">,</font>fgRGB<font color="#000080">);
   </font>SetTextColor<font color="#000080">(</font>PaintDC<font color="#000080">,</font>fgRGB<font color="#000080">);
   </font>SetBkColor<font color="#000080">(</font>PaintDC<font color="#000080">,</font>bkRGB<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>i <font color="#000080">&lt;</font>ScreenSize<font color="#000080">.</font>X <font color="#FF0000"><b>then
    </b></font>TextOut<font color="#000080">(</font>PaintDC<font color="#000080">,(</font>i<font color="#000080">-</font>Origin<font color="#000080">.</font>X<font color="#000080">)*</font>CharSize<font color="#000080">.</font>X<font color="#000080">,(</font>Y1<font color="#000080">-</font>Origin<font color="#000080">.</font>Y<font color="#000080">)*</font>CharSize<font color="#000080">.</font>Y<font color="#000080">,</font>CharPtr<font color="#000080">(</font>i<font color="#000080">,</font>Y1<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Inc<font color="#000080">(</font>Y1<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>FastWrite<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Row<font color="#000080">,</font>Col<font color="#000080">,</font>_Attr<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>Move<font color="#000080">(</font>St<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>CharPtr<font color="#000080">(</font>pred<font color="#000080">(</font>Col<font color="#000080">),</font>pred<font color="#000080">(</font>Row<font color="#000080">))^,</font>Length<font color="#000080">(</font>St<font color="#000080">));
 </font>FillChar<font color="#000080">(</font>AttrPtr<font color="#000080">(</font>pred<font color="#000080">(</font>Col<font color="#000080">),</font>pred<font color="#000080">(</font>Row<font color="#000080">))^,</font>Length<font color="#000080">(</font>St<font color="#000080">),</font>char<font color="#000080">(</font>_Attr<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>FastFill<font color="#000080">(</font>Number<font color="#000080">:</font>word<font color="#000080">; </font>Ch<font color="#000080">:</font>char<font color="#000080">; </font>Row<font color="#000080">,</font>Col<font color="#000080">,</font>_Attr<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
 if </b></font>Number <font color="#000080">&gt;(</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">-(</font>Row<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">+</font>Col<font color="#000080">)) </font><font color="#FF0000"><b>then
  </b></font>Number<font color="#000080">:=</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">-(</font>Row<font color="#000080">*</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">+</font>Col<font color="#000080">);
 </font>FillChar<font color="#000080">(</font>CharPtr<font color="#000080">(</font>pred<font color="#000080">(</font>Col<font color="#000080">),</font>pred<font color="#000080">(</font>Row<font color="#000080">))^,</font>Number<font color="#000080">,</font>Ch<font color="#000080">);
 </font>FillChar<font color="#000080">(</font>AttrPtr<font color="#000080">(</font>pred<font color="#000080">(</font>Col<font color="#000080">),</font>pred<font color="#000080">(</font>Row<font color="#000080">))^,</font>Number<font color="#000080">,</font>_Attr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>FastCenter<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Row<font color="#000080">,</font>_Attr<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var
 </b></font>sL<font color="#000080">:</font>byte <font color="#FF0000"><b>absolute </b></font>St<font color="#000080">;

</font><font color="#FF0000"><b>begin
 if </b></font>sL <font color="#000080">&gt;</font>succ<font color="#000080">(</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">-</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">) </font><font color="#FF0000"><b>then
  </b></font>sL<font color="#000080">:=</font>succ<font color="#000080">(</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">-</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">);
 </font>FastWrite<font color="#000080">(</font>St<font color="#000080">,</font>ScreenSize<font color="#000080">.</font>Y<font color="#000080">+</font>Row<font color="#000080">,</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">+
  </font>succ<font color="#000080">((</font>succ<font color="#000080">(</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">-</font>ScreenSize<font color="#000080">.</font>X<font color="#000080">)-</font>sL<font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">),</font>_Attr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>tColorWin<font color="#000080">.</font>GetNewPos<font color="#000080">(</font>Action<font color="#000080">:</font>word<font color="#000080">; </font>Pos<font color="#000080">,</font>Page<font color="#000080">,</font>_Range<font color="#000080">, </font>Thumb<font color="#000080">:</font>integer<font color="#000080">):</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 case </b></font>Action <font color="#FF0000"><b>of
  </b></font>sb_LineUp<font color="#000080">: </font>GetNewPos<font color="#000080">:=</font>Pos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>sb_LineDown<font color="#000080">: </font>GetNewPos<font color="#000080">:=</font>Pos<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
  </font>sb_PageUp<font color="#000080">: </font>GetNewPos<font color="#000080">:=</font>Pos<font color="#000080">-</font>Page<font color="#000080">;
  </font>sb_PageDown<font color="#000080">: </font>GetNewPos<font color="#000080">:=</font>Pos<font color="#000080">+</font>Page<font color="#000080">;
  </font>sb_Top<font color="#000080">: </font>GetNewPos<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>sb_Bottom<font color="#000080">: </font>GetNewPos<font color="#000080">:=</font>_Range<font color="#000080">;
  </font>sb_ThumbPosition<font color="#000080">: </font>GetNewPos<font color="#000080">:=</font>Thumb<font color="#000080">;
 </font><font color="#FF0000"><b>else
  </b></font>GetNewPos<font color="#000080">:=</font>Pos<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>wmHScroll<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">:</font>tMessage<font color="#000080">);
</font><font color="#008000"><i>{wm_HScroll handler}
</i></font><font color="#FF0000"><b>var
 </b></font>X<font color="#000080">:</font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>X<font color="#000080">:=</font>Origin<font color="#000080">.</font>X<font color="#000080">;
 </font>X<font color="#000080">:=</font>GetNewPos<font color="#000080">(</font>Msg<font color="#000080">.</font>wParam<font color="#000080">, </font>X<font color="#000080">, </font>ClientSize<font color="#000080">.</font>X <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">, </font>Range<font color="#000080">.</font>X<font color="#000080">, </font>Msg<font color="#000080">.</font>lParamLo<font color="#000080">);
 </font>ScrollTo<font color="#000080">(</font>X<font color="#000080">, </font>Origin<font color="#000080">.</font>Y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tColorWin<font color="#000080">.</font>wmVScroll<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">:</font>tMessage<font color="#000080">);
</font><font color="#008000"><i>{wm_VScroll handler}
</i></font><font color="#FF0000"><b>var
 </b></font>Y<font color="#000080">:</font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>Y<font color="#000080">:=</font>Origin<font color="#000080">.</font>Y<font color="#000080">;
 </font>Y<font color="#000080">:=</font>GetNewPos<font color="#000080">(</font>Msg<font color="#000080">.</font>wParam<font color="#000080">, </font>Y<font color="#000080">, </font>ClientSize<font color="#000080">.</font>Y<font color="#000080">, </font>Range<font color="#000080">.</font>Y<font color="#000080">, </font>Msg<font color="#000080">.</font>lParamLo<font color="#000080">);
 </font>ScrollTo<font color="#000080">(</font>Origin<font color="#000080">.</font>X<font color="#000080">, </font>Y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ----------------------   CUT  ----------------------- }

              (************************************************)
              (* The Demostration Module for tColorWin object *)
              (************************************************)

</i></font><font color="#FF0000"><b>uses
 </b></font>WinTypes<font color="#000080">,
 </font>WinProcs<font color="#000080">,
 </font>oWindows<font color="#000080">,
 </font>ColorWin<font color="#000080">;     </font><font color="#008000"><i>{-tColorWin object}

</i></font><font color="#FF0000"><b>const
 </b></font>AppName<font color="#000080">:</font>pChar<font color="#000080">=</font><font color="#800000">'tColorWin demo'</font><font color="#000080">;
 </font>CaptionText<font color="#000080">:</font>pChar<font color="#000080">=</font><font color="#800000">'Color Window test..'</font><font color="#000080">;

 </font><font color="#008000"><i>{===[ This application does nothing but shows you ]===}
 {===[ how to use tColorWin object                 ]===}

</i></font><font color="#FF0000"><b>type
 </b></font>tMyApp<font color="#000080">=</font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>tApplication<font color="#000080">)
  </font><font color="#FF0000"><b>procedure </b></font>InitMainWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font>pMyWin<font color="#000080">=^</font>tMyWin<font color="#000080">;
 </font>tMyWin<font color="#000080">=</font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>tColorWin<font color="#000080">)
  </font><font color="#FF0000"><b>procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tMyWin<font color="#000080">.</font>SetupWindow<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>i<font color="#000080">:</font>byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
 inherited </b></font>SetupWindow<font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do
  </b></font>FastWrite<font color="#000080">(</font><font color="#800000">'Test string for check ColorWin. Don`t panic! ;-)'</font><font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>i<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tMyApp<font color="#000080">.</font>InitMainWindow<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>MainWindow<font color="#000080">:=</font>New<font color="#000080">(</font>pMyWin<font color="#000080">,</font>Init<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>CaptionText<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
 </b></font>MyApp<font color="#000080">:</font>tMyApp<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>MyApp<font color="#000080">.</font>Init<font color="#000080">(</font>AppName<font color="#000080">);
 </font>MyApp<font color="#000080">.</font>Run<font color="#000080">;
 </font>MyApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0096.PAS">Original</a><b>]</b></p></body>
</html>
