<html>
<head><title> "Windows File Manager Exte" by MICHAEL A VINCZE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: vincze@dseg.ti.com (MICHAEL A VINCZE 0171847)

Well after posting the question about how to create a Windows
File Manager extension and not getting any responses, I figured
that not a lot of people know how to do.  So after several hours,
as typical with translating something from C to Pascal, I finally
got the following example to work.  Note that the example consists
of four files:

  constant.pas
  xtension.pas
  xtension.rc
  icon.zip     &lt;- this is uuencoded here.

Just FYI one of the hardest items to figure out was the parameter info
for the FMExtensionProc function.  The Borland supplied WFEXT.PAS file
is totally bogus.  The key was to pass lParam by reference, and not
by value.  Hence the following:

  function FMExtensionProc (Handle: HWnd; Msg: WORD; var lParam: Longint):
  HMENU; export;                                     ^^^

Evidently, the File Manager allocates space for a TFMS_LOAD structure (record)
and passes the address to this structure via the lParam parameter.  This should
lead you to a rule of thumb for translating Windows C programs to Pascal.
I leave the wording for the rule of thumb up to yourself to figure out.

Best regards,
Michael Vincze
mav@asd470.dseg.ti.com

---------- snip ---------- snip ---------- snip ----------

unit constant;

interface

const

  { menu items (must within the range of 1 to 99
  }
  </i></font>IDM_STATUSWIN         <font color="#000080">=  </font><font color="#800000">10</font><font color="#000080">;
  </font>IDM_GETFILESELLFN     <font color="#000080">=  </font><font color="#800000">15</font><font color="#000080">;
  </font>IDM_GETDRIVEINFO      <font color="#000080">=  </font><font color="#800000">20</font><font color="#000080">;
  </font>IDM_GETFOCUS          <font color="#000080">=  </font><font color="#800000">25</font><font color="#000080">;
  </font>IDM_RELOADEXTENSIONS  <font color="#000080">=  </font><font color="#800000">30</font><font color="#000080">;
  </font>IDM_REFRESHWINDOW     <font color="#000080">=  </font><font color="#800000">35</font><font color="#000080">;
  </font>IDM_REFRESHALLWINDOWS <font color="#000080">=  </font><font color="#800000">40</font><font color="#000080">;
  </font>IDM_ABOUTEXT          <font color="#000080">=  </font><font color="#800000">45</font><font color="#000080">;


  </font><font color="#008000"><i>{ dialog items
  }
  </i></font>IDD_PATH              <font color="#000080">=  </font><font color="#800000">206</font><font color="#000080">;
  </font>IDD_VOLUME            <font color="#000080">=  </font><font color="#800000">207</font><font color="#000080">;
  </font>IDD_SHARE             <font color="#000080">=  </font><font color="#800000">208</font><font color="#000080">;
  </font>IDD_TOTALSPACE        <font color="#000080">=  </font><font color="#800000">209</font><font color="#000080">;
  </font>IDD_FREESPACE         <font color="#000080">=  </font><font color="#800000">210</font><font color="#000080">;

  </font>IDD_SELFILECOUNT      <font color="#000080">=  </font><font color="#800000">201</font><font color="#000080">;
  </font>IDD_SELFILESIZE       <font color="#000080">=  </font><font color="#800000">202</font><font color="#000080">;


  </font><font color="#008000"><i>{ miscellaneous items
  }
  </i></font>STATUS_WIDTH          <font color="#000080">=  </font><font color="#800000">400</font><font color="#000080">;
  </font>STATUS_HEIGHT         <font color="#000080">=  </font><font color="#800000">100</font><font color="#000080">;
  </font>INFO_LINE_WIDTH       <font color="#000080">=  </font><font color="#800000">300</font><font color="#000080">;
  </font>INFO_LINE_HEIGHT      <font color="#000080">=  </font><font color="#800000">18</font><font color="#000080">;
  </font>INFO_LINE_X           <font color="#000080">=  </font><font color="#800000">10</font><font color="#000080">;
  </font>INFO_LINE_Y           <font color="#000080">=  </font><font color="#800000">20</font><font color="#000080">;
  </font>ID_STATUSTIMER        <font color="#000080">=  </font><font color="#800000">99</font><font color="#000080">;
  </font>INFO_STR_LEN          <font color="#000080">=  </font><font color="#800000">50</font><font color="#000080">;
  </font>TIMER_DURATION        <font color="#000080">=  </font><font color="#800000">1500</font><font color="#000080">;  </font><font color="#008000"><i>{ 1.5 seconds }
  </i></font>PATH_NAME_LEN         <font color="#000080">=  </font><font color="#800000">260</font><font color="#000080">;
  </font>VOLUME_NAME_LEN       <font color="#000080">=  </font><font color="#800000">14</font><font color="#000080">;
  </font>SHARE_NAME_LEN        <font color="#000080">=  </font><font color="#800000">128</font><font color="#000080">;
  </font>SMALL_STR_LEN         <font color="#000080">=  </font><font color="#800000">12</font><font color="#000080">;
  </font>LONG_STR_LEN          <font color="#000080">=  </font><font color="#800000">60</font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

end</b></font><font color="#000080">.

---------- </font>snip <font color="#000080">---------- </font>snip <font color="#000080">---------- </font>snip <font color="#000080">----------

</font><font color="#FF0000"><b>library </b></font>XTension<font color="#000080">;

</font><font color="#008000"><i>{ Author:   Michael Vincze  07/30/94                              }
{           vincze@lobby.ti.com                                   }
{           mav@asd470.dseg.ti.com                                }
{                                                                 }
{ The following File Manager extension is a translation from C.   }
{ The C code was taken from the Microsoft Product Support         }
{ Services, and obtained from the anonymous FTP site              }
{ ftp.microsoft.com with a file name of 4-23.zip.  The main       }
{ preamble of the original source has been preserved below.       }

(*
//***************************************************************************
//
//  Library:
//      XTENSION.DLL
//
//
//  Author:
//      Microsoft Product Support Services.
//
//
//  Purpose:
//      XTENSION is a File Manager extension DLL.  An extension DLL adds
//      a menu to File Manager, contains entry point that processes menu
//      commands and notification messages sent by File Manager, and
//      queries data and information about the File Manager windows.  The
//      purpose of an extension DLL is to add administration support
//      features to File Manager, for example, file and disk utilities.
//      Up to five extension DLLs may be instaled at any one time.
//
//      XTENSION adds a menu called &quot;Extension&quot; to File manager and
//      processes all the messages that are sent by File Manager to an
//      extension DLL.  In order to retrieve any information, it sends
//      messages to File Manager.  It also creates a topmost status window
//      using the DLL's instance handle.
//
//
//  Usage:
//      File Manager installs the extensions that have entries in the
//      [AddOns] section of the WINFILE.INI initialization file.  An entry
//      consists of a tag and a value.  To load XTENSION.DLL as a File
//      Manager extension, add the following to WINFILE.INI (assuming the
//      DLL resides in c:\win\system):
//
//      [AddOns]
//      SDK Demo Extension=c:\win\system\xtension.dll
//
//
//  Menu Options:
//      Following menu items belong to the &quot;Extension&quot; menu that is added
//      to File Manager:
//
//      Status Window               - Shows/Hides status window
//      Selected File(s) Size...    - Displays disk space taken by the files
//      Selected Drive Info...      - Displays selected drive information
//      Focused Item Info           - Displays the name of the focused item
//      Reload Extension            - Reloads this extension
//      Refresh Window              - Refreshes File Manager's active window
//      Refresh All Windows         - Refreshes all the File Manager's windows
//      About Extension...          - Displays About dialog
//
//
//  More Info:
//      Query on-line help on: FMExtensionProc, File Manager Extensions
//
//
// COPYRIGHT:
//
//   (C) Copyright Microsoft Corp. 1993.  All rights reserved.
//
//   You have a royalty-free right to use, modify, reproduce and
//   distribute the Sample Files (and/or any modified version) in
//   any way you find useful, provided that you agree that
//   Microsoft has no warranty obligations or liability for any
//   Sample Application Files which are modified.
//
//***************************************************************************
*)



{$D File Manager Extension DLL}

{$R XTENSION}

</i></font><font color="#FF0000"><b>uses
  </b></font>WinTypes<font color="#000080">,
  </font>WinProcs<font color="#000080">,
  </font>Win31<font color="#000080">,
  </font>WFExt<font color="#000080">,
  </font>Constant<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>gszDllWndClass    <font color="#000080">: </font>PChar   <font color="#000080">= </font><font color="#800000">'ExtenStatusWClass'</font><font color="#000080">;  </font><font color="#008000"><i>{ Class name for status
window      }
  </i></font>ghwndStatus       <font color="#000080">: </font>HWND    <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;                    </font><font color="#008000"><i>{ Status window          
          }
  </i></font>ghwndInfo         <font color="#000080">: </font>HWND    <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;                    </font><font color="#008000"><i>{ Child window of status
window     }
  </i></font>ghDllInst         <font color="#000080">: </font>THANDLE <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;                    </font><font color="#008000"><i>{ DLL's instance handle  
          }
  </i></font>ghMenu            <font color="#000080">: </font>HMENU   <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;                    </font><font color="#008000"><i>{ Extension's menu handle
          }
  </i></font>gwMenuDelta       <font color="#000080">: </font>WORD    <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;                    </font><font color="#008000"><i>{ Delta for extension's
menu items  }
  </i></font>gbStatusWinVisible<font color="#000080">: </font>BOOLEAN <font color="#000080">= </font>FALSE<font color="#000080">;                </font><font color="#008000"><i>{ Flag for status window 
          }
                                                      {   FALSE=Hidden, 
TRUE=Visible     }

{ type to handle passing Longint types to wvsprintf
}
</i></font><font color="#FF0000"><b>type
  </b></font>TLongRec <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>LO<font color="#000080">: </font>WORD<font color="#000080">;
    </font>HI<font color="#000080">: </font>WORD<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DisplayStatus <font color="#000080">(</font>Handle<font color="#000080">: </font>HWND<font color="#000080">; </font>wEvent<font color="#000080">: </font>Longint<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>wFileCount<font color="#000080">: </font>Longint<font color="#000080">;
  </font>szInfo    <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>INFO_STR_LEN<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>CHAR<font color="#000080">;
  </font>lFileCount<font color="#000080">: </font>TLongRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
if </b></font>gbStatusWinVisible <font color="#000080">= </font>TRUE <font color="#FF0000"><b>then
  begin
  case </b></font>wEvent <font color="#FF0000"><b>of

    </b></font>FMEVENT_INITMENU<font color="#000080">:
      </font>SetWindowText <font color="#000080">(</font>ghwndInfo<font color="#000080">, </font><font color="#800000">'Extension menu selected...'</font><font color="#000080">);

    </font>FMEVENT_SELCHANGE<font color="#000080">:
      </font><font color="#FF0000"><b>begin
      </b></font>wFileCount <font color="#000080">:= </font>SendMessage <font color="#000080">(</font>Handle<font color="#000080">, </font>FM_GETSELCOUNTLFN<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
      </font>lFileCount<font color="#000080">.</font>LO <font color="#000080">:= </font>LOWORD <font color="#000080">(</font>wFileCount<font color="#000080">);
      </font>lFileCount<font color="#000080">.</font>HI <font color="#000080">:= </font>HIWORD <font color="#000080">(</font>wFileCount<font color="#000080">);
      </font>wvsprintf <font color="#000080">(</font>szInfo<font color="#000080">, </font><font color="#800000">'File selection changed: %ld item(s) selected...'</font><font color="#000080">,
</font>lFileCount<font color="#000080">);
      </font>SetWindowText <font color="#000080">(</font>ghwndInfo<font color="#000080">, </font>szInfo<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>FMEVENT_UNLOAD<font color="#000080">:
      </font>SetWindowText <font color="#000080">(</font>ghwndInfo<font color="#000080">, </font><font color="#800000">'Unloading extension...'</font><font color="#000080">);

    </font>FMEVENT_USER_REFRESH<font color="#000080">:
      </font>SetWindowText <font color="#000080">(</font>ghwndInfo<font color="#000080">, </font><font color="#800000">'Refreshing window(s)...'</font><font color="#000080">);

    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ Timer to erase the info after the elapsed time
  }
  </i></font>SetTimer <font color="#000080">(</font>ghwndStatus<font color="#000080">, </font>ID_STATUSTIMER<font color="#000080">, </font>TIMER_DURATION<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>function </b></font>StatusWndProc <font color="#000080">(</font>hWin<font color="#000080">: </font>HWND<font color="#000080">; </font>uMessage<font color="#000080">: </font>WORD<font color="#000080">; </font>wParam<font color="#000080">: </font>WORD<font color="#000080">; </font>lParam<font color="#000080">:
</font>Longint<font color="#000080">): </font>Longint<font color="#000080">; </font><font color="#FF0000"><b>export</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
case </b></font>uMessage <font color="#FF0000"><b>of

  </b></font>WM_TIMER<font color="#000080">:
    </font><font color="#008000"><i>{ This timer is used to erase info from the
      status window at the elapsed time
    }
    </i></font><font color="#FF0000"><b>if </b></font>wParam <font color="#000080">= </font>ID_STATUSTIMER <font color="#FF0000"><b>then
      begin
      </b></font>KillTimer <font color="#000080">(</font>hWin<font color="#000080">, </font>wParam<font color="#000080">);
      </font>SetWindowText <font color="#000080">(</font>ghwndInfo<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>else
    begin
    </b></font>StatusWndProc <font color="#000080">:= </font>DefWindowProc <font color="#000080">(</font>hWin<font color="#000080">, </font>uMessage<font color="#000080">, </font>wParam<font color="#000080">, </font>lParam<font color="#000080">);
    </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>StatusWndProc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;







</font><font color="#FF0000"><b>function </b></font>CreateStatusWindow <font color="#000080">(</font>hwndExtension<font color="#000080">: </font>HWND<font color="#000080">): </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>wc<font color="#000080">: </font>TWNDCLASS<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>wc<font color="#000080">.</font>style            <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>wc<font color="#000080">.</font>lpfnWndProc      <font color="#000080">:= @</font>StatusWndProc<font color="#000080">;
</font>wc<font color="#000080">.</font>cbClsExtra       <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>wc<font color="#000080">.</font>cbWndExtra       <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>wc<font color="#000080">.</font>hInstance        <font color="#000080">:= </font>ghDllInst<font color="#000080">;
</font>wc<font color="#000080">.</font>hIcon            <font color="#000080">:= </font>LoadIcon <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>IDI_APPLICATION<font color="#000080">);
</font>wc<font color="#000080">.</font>hCursor          <font color="#000080">:= </font>LoadCursor <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>IDC_ARROW<font color="#000080">);
</font>wc<font color="#000080">.</font>hbrBackground    <font color="#000080">:= </font>COLOR_WINDOW <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
</font>wc<font color="#000080">.</font>lpszMenuName     <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font>wc<font color="#000080">.</font>lpszClassName    <font color="#000080">:= </font>gszDllWndClass<font color="#000080">;

</font><font color="#FF0000"><b>if not </b></font>RegisterClass <font color="#000080">(</font>wc<font color="#000080">) </font><font color="#FF0000"><b>then
  begin
  </b></font>CreateStatusWindow <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>ghwndStatus <font color="#000080">:= </font>CreateWindowEx <font color="#000080">(</font>WS_EX_TOPMOST <font color="#FF0000"><b>or </b></font>WS_EX_DLGMODALFRAME<font color="#000080">,
                               </font>gszDllWndClass<font color="#000080">,
                               </font><font color="#800000">'File Manager Extension'</font><font color="#000080">,
                               </font>WS_POPUP <font color="#FF0000"><b>or </b></font>WS_CAPTION<font color="#000080">,
                               </font>CW_USEDEFAULT<font color="#000080">,
                               </font>CW_USEDEFAULT<font color="#000080">,
                               </font>STATUS_WIDTH<font color="#000080">,
                               </font>STATUS_HEIGHT<font color="#000080">,
                               </font>hwndExtension<font color="#000080">,
                               </font><font color="#800000">0</font><font color="#000080">,
                               </font>ghDllInst<font color="#000080">,
                               </font><font color="#FF0000"><b>nil</b></font><font color="#000080">);

</font>ghwndInfo <font color="#000080">:= </font>CreateWindow <font color="#000080">(</font><font color="#800000">'STATIC'</font><font color="#000080">,
                           </font><font color="#FF0000"><b>nil</b></font><font color="#000080">,
                           </font>WS_CHILD <font color="#FF0000"><b>or </b></font>WS_VISIBLE<font color="#000080">,
                           </font>INFO_LINE_X<font color="#000080">,
                           </font>INFO_LINE_Y<font color="#000080">,
                           </font>INFO_LINE_WIDTH<font color="#000080">,
                           </font>INFO_LINE_HEIGHT<font color="#000080">,
                           </font>ghwndStatus<font color="#000080">,
                           </font><font color="#800000">1</font><font color="#000080">,
                           </font>ghDllInst<font color="#000080">,
                           </font><font color="#FF0000"><b>nil</b></font><font color="#000080">);

</font><font color="#008000"><i>{ note I changed the logic from the original code below to return TRUE iff both
  windows got created.
}
</i></font>CreateStatusWindow <font color="#000080">:= (</font>ghwndStatus <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>ghwndInfo <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;




</font><font color="#FF0000"><b>function </b></font>DriveInfoDlgProc <font color="#000080">(</font>hDlg<font color="#000080">: </font>HWND<font color="#000080">; </font>uMessage<font color="#000080">: </font>WORD<font color="#000080">; </font>wParam<font color="#000080">: </font>WORD<font color="#000080">; </font>lParam<font color="#000080">:
</font>Longint<font color="#000080">): </font>BOOLEAN<font color="#000080">; </font><font color="#FF0000"><b>export</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>fmsDriveInfo<font color="#000080">: </font>TFMS_GETDRIVEINFO<font color="#000080">;
  </font>szTempString<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>SMALL_STR_LEN<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>lTotalSpace <font color="#000080">: </font>TLongRec<font color="#000080">;
  </font>lFreeSpace  <font color="#000080">: </font>TLongRec<font color="#000080">;
</font><font color="#FF0000"><b>begin

</b></font><font color="#000080">&uacute;
(</font>continued next <font color="#FF0000"><b>message</b></font><font color="#000080">)

&Auml; </font>Area<font color="#000080">: </font>U<font color="#000080">-</font><font color="#FF0000"><b>PASCAL      </b></font><font color="#000080">|</font><font color="#800000">61 </font><font color="#000080">&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
  </font>Msg<font color="#800000">#</font><font color="#000080">: </font><font color="#800000">6684                                         </font>Date<font color="#000080">: </font><font color="#800000">08</font><font color="#000080">-</font><font color="#800000">04</font><font color="#000080">-</font><font color="#800000">94  07</font><font color="#000080">:</font><font color="#800000">28
  </font>From<font color="#000080">: </font>Vincze<font color="#000080">@</font>dseg<font color="#000080">.</font>ti<font color="#000080">.</font>com                           Read<font color="#000080">: </font>Yes    Replied<font color="#000080">: </font>No 
    <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>All                                          Mark<font color="#000080">:                     
  </font>Subj<font color="#000080">: [</font>A<font color="#000080">] </font>Windows <font color="#FF0000"><b>File </b></font>Manager
<font color="#000080">&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
@</font>SUBJECT<font color="#000080">:[</font>A<font color="#000080">] </font>Windows <font color="#FF0000"><b>File </b></font>Manager Extension                           
<font color="#000080">&uacute;(</font>Continued from last <font color="#FF0000"><b>message</b></font><font color="#000080">)
</font><font color="#FF0000"><b>case  </b></font>uMessage <font color="#FF0000"><b>of

  </b></font>WM_INITDIALOG<font color="#000080">:

    </font><font color="#FF0000"><b>begin
    </b></font>SendMessage <font color="#000080">(</font>lParam<font color="#000080">, </font>FM_GETDRIVEINFO<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Longint <font color="#000080">(</font>PFMS_GETDRIVEINFO
<font color="#000080">(@</font>fmsDriveInfo<font color="#000080">)));

    </font><font color="#008000"><i>{ Convert OEM characters to Windows characters
    }
    </i></font>OemToAnsi <font color="#000080">(</font>fmsDriveInfo<font color="#000080">.</font>szPath<font color="#000080">, </font>fmsDriveInfo<font color="#000080">.</font>szPath<font color="#000080">);
    </font>OemToAnsi <font color="#000080">(</font>fmsDriveInfo<font color="#000080">.</font>szVolume<font color="#000080">, </font>fmsDriveInfo<font color="#000080">.</font>szVolume<font color="#000080">);

    </font><font color="#FF0000"><b>if </b></font>fmsDriveInfo<font color="#000080">.</font>szShare<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &lt;&gt; </font><font color="#800000">#0 </font><font color="#FF0000"><b>then
      </b></font>OemToAnsi <font color="#000080">(</font>fmsDriveInfo<font color="#000080">.</font>szShare<font color="#000080">, </font>fmsDriveInfo<font color="#000080">.</font>szShare<font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>lstrcpy <font color="#000080">(</font>fmsDriveInfo<font color="#000080">.</font>szShare<font color="#000080">, </font><font color="#800000">'&lt; Not a Share &gt;'</font><font color="#000080">);

    </font><font color="#FF0000"><b>if </b></font>fmsDriveInfo<font color="#000080">.</font>szVolume<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &lt;&gt; </font><font color="#800000">#0 </font><font color="#FF0000"><b>then
      </b></font>SetDlgItemText <font color="#000080">(</font>hDlg<font color="#000080">, </font>IDD_VOLUME<font color="#000080">, </font>fmsDriveInfo<font color="#000080">.</font>szVolume<font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>SetDlgItemText <font color="#000080">(</font>hDlg<font color="#000080">, </font>IDD_VOLUME<font color="#000080">, </font><font color="#800000">'&lt; No volume label &gt;'</font><font color="#000080">);

    </font>SetDlgItemText <font color="#000080">(</font>hDlg<font color="#000080">, </font>IDD_PATH<font color="#000080">, </font>fmsDriveInfo<font color="#000080">.</font>szPath<font color="#000080">);
    </font>SetDlgItemText <font color="#000080">(</font>hDlg<font color="#000080">, </font>IDD_SHARE<font color="#000080">, </font>fmsDriveInfo<font color="#000080">.</font>szShare<font color="#000080">);


    </font><font color="#008000"><i>{ When a -1 is returned for either dwTotalSpace or dwFreeSpace,
      the extension will have compute that number on its own.
    }
    </i></font><font color="#FF0000"><b>if </b></font>fmsDriveInfo<font color="#000080">.</font>dwTotalSpace <font color="#000080">= -</font><font color="#800000">1 </font><font color="#FF0000"><b>then
      </b></font>SetDlgItemText <font color="#000080">(</font>hDlg<font color="#000080">, </font>IDD_TOTALSPACE<font color="#000080">, </font><font color="#800000">'&lt; Info. not available &gt;'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      begin
      </b></font>lTotalSpace<font color="#000080">.</font>LO <font color="#000080">:= </font>LOWORD <font color="#000080">(</font>fmsDriveInfo<font color="#000080">.</font>dwTotalSpace<font color="#000080">);
      </font>lTotalSpace<font color="#000080">.</font>HI <font color="#000080">:= </font>HIWORD <font color="#000080">(</font>fmsDriveInfo<font color="#000080">.</font>dwTotalSpace<font color="#000080">);
      </font>wvsprintf <font color="#000080">(</font>szTempString<font color="#000080">, </font><font color="#800000">'%ld'</font><font color="#000080">, </font>lTotalSpace<font color="#000080">);
      </font>SetDlgItemText <font color="#000080">(</font>hDlg<font color="#000080">, </font>IDD_TOTALSPACE<font color="#000080">, </font>szTempString<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>if </b></font>fmsDriveInfo<font color="#000080">.</font>dwFreeSpace <font color="#000080">= -</font><font color="#800000">1 </font><font color="#FF0000"><b>then
      </b></font>SetDlgItemText <font color="#000080">(</font>hDlg<font color="#000080">, </font>IDD_FREESPACE<font color="#000080">, </font><font color="#800000">'&lt; Info. not available &gt;'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      begin
      </b></font>lFreeSpace<font color="#000080">.</font>LO <font color="#000080">:= </font>LOWORD <font color="#000080">(</font>fmsDriveInfo<font color="#000080">.</font>dwFreeSpace<font color="#000080">);
      </font>lFreeSpace<font color="#000080">.</font>HI <font color="#000080">:= </font>HIWORD <font color="#000080">(</font>fmsDriveInfo<font color="#000080">.</font>dwFreeSpace<font color="#000080">);
      </font>wvsprintf <font color="#000080">(</font>szTempString<font color="#000080">, </font><font color="#800000">'%ld'</font><font color="#000080">, </font>lFreeSpace<font color="#000080">);
      </font>SetDlgItemText <font color="#000080">(</font>hDlg<font color="#000080">, </font>IDD_FREESPACE<font color="#000080">, </font>szTempString<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>DriveInfoDlgProc <font color="#000080">:= </font>TRUE<font color="#000080">;
    </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>WM_COMMAND<font color="#000080">:

    </font><font color="#FF0000"><b>case </b></font>wParam <font color="#FF0000"><b>of

      </b></font>IDOK<font color="#000080">,
      </font>IDCANCEL<font color="#000080">:
        </font><font color="#FF0000"><b>begin
        </b></font>EndDialog <font color="#000080">(</font>hDlg<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
        </font>DriveInfoDlgProc <font color="#000080">:= </font>TRUE<font color="#000080">;
        </font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>DriveInfoDlgProc <font color="#000080">:= </font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;





</font><font color="#FF0000"><b>function </b></font>SelFileInfoDlgProc <font color="#000080">(</font>hDlg<font color="#000080">: </font>HWND<font color="#000080">; </font>uMessage<font color="#000080">: </font>WORD<font color="#000080">; </font>wParam<font color="#000080">: </font>WORD<font color="#000080">; </font>lParam<font color="#000080">:
</font>Longint<font color="#000080">): </font>BOOLEAN<font color="#000080">; </font><font color="#FF0000"><b>export</b></font><font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>fmsFileInfo  <font color="#000080">: </font>TFMS_GETFILESEL <font color="#000080">= (</font>wTime<font color="#000080">: </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>wSelFileCount<font color="#000080">: </font>WORD<font color="#000080">;
  </font>lSelFileCount<font color="#000080">: </font>TLongRec<font color="#000080">;
  </font>wIndex       <font color="#000080">: </font>WORD<font color="#000080">;
  </font>szTempString <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>SMALL_STR_LEN<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>dwTotalSize  <font color="#000080">: </font>Longint<font color="#000080">;
  </font>lTotalSize   <font color="#000080">: </font>TLongRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
case </b></font>uMessage <font color="#FF0000"><b>of

  </b></font>WM_INITDIALOG<font color="#000080">:
    </font><font color="#FF0000"><b>begin
    </b></font>wSelFileCount <font color="#000080">:= </font>SendMessage <font color="#000080">(</font>lParam<font color="#000080">, </font>FM_GETSELCOUNTLFN<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
    </font>lSelFileCount<font color="#000080">.</font>LO <font color="#000080">:= </font>LOWORD <font color="#000080">(</font>wSelFileCount<font color="#000080">);
    </font>lSelFileCount<font color="#000080">.</font>HI <font color="#000080">:= </font>HIWORD <font color="#000080">(</font>wSelFileCount<font color="#000080">);
    </font>wvsprintf <font color="#000080">(</font>szTempString<font color="#000080">, </font><font color="#800000">'%ld'</font><font color="#000080">, </font>lSelFileCount<font color="#000080">);
    </font>SetDlgItemText <font color="#000080">(</font>hDlg<font color="#000080">, </font>IDD_SELFILECOUNT<font color="#000080">, </font>szTempString<font color="#000080">);
    </font>dwTotalSize <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>wSelFileCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      for </b></font>wIndex <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>wSelFileCount <font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
        begin
        </b></font>SendMessage <font color="#000080">(</font>HWND <font color="#000080">(</font>lParam<font color="#000080">), </font>FM_GETFILESELLFN<font color="#000080">, </font>wIndex<font color="#000080">, </font>Longint
<font color="#000080">(</font>PFMS_GETFILESEL <font color="#000080">(@</font>fmsFileInfo<font color="#000080">)));
        </font>Inc <font color="#000080">(</font>dwTotalSize<font color="#000080">, </font>fmsFileInfo<font color="#000080">.</font>dwSize<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>lTotalSize<font color="#000080">.</font>LO <font color="#000080">:= </font>LOWORD <font color="#000080">(</font>dwTotalSize<font color="#000080">);
    </font>lTotalSize<font color="#000080">.</font>HI <font color="#000080">:= </font>HIWORD <font color="#000080">(</font>dwTotalSize<font color="#000080">);
    </font>wvsprintf <font color="#000080">(</font>szTempString<font color="#000080">, </font><font color="#800000">'%ld bytes'</font><font color="#000080">, </font>lTotalSize<font color="#000080">);
    </font>SetDlgItemText <font color="#000080">(</font>hDlg<font color="#000080">, </font>IDD_SELFILESIZE<font color="#000080">, </font>szTempString<font color="#000080">);
    </font>SelFileInfoDlgProc <font color="#000080">:= </font>TRUE<font color="#000080">;
    </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>WM_COMMAND<font color="#000080">:
    </font><font color="#FF0000"><b>case </b></font>wParam <font color="#FF0000"><b>of

      </b></font>IDOK<font color="#000080">,
      </font>IDCANCEL<font color="#000080">:
        </font><font color="#FF0000"><b>begin
        </b></font>EndDialog <font color="#000080">(</font>hDlg<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
        </font>SelFileInfoDlgProc <font color="#000080">:= </font>TRUE<font color="#000080">;
        </font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>SelFileInfoDlgProc <font color="#000080">:= </font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;




</font><font color="#FF0000"><b>function </b></font>AboutDlgProc <font color="#000080">(</font>hDlg<font color="#000080">: </font>HWND<font color="#000080">; </font>uMessage<font color="#000080">: </font>WORD<font color="#000080">; </font>wParam<font color="#000080">: </font>WORD<font color="#000080">; </font>lParam<font color="#000080">:
</font>Longint<font color="#000080">): </font>BOOLEAN<font color="#000080">; </font><font color="#FF0000"><b>export</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
case </b></font>uMessage <font color="#FF0000"><b>of

  </b></font>WM_INITDIALOG<font color="#000080">:
    </font><font color="#FF0000"><b>begin
    </b></font>AboutDlgProc <font color="#000080">:= </font>TRUE<font color="#000080">;
    </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>WM_COMMAND<font color="#000080">:
    </font><font color="#FF0000"><b>case </b></font>wParam <font color="#FF0000"><b>of

      </b></font>IDOK<font color="#000080">,
      </font>IDCANCEL<font color="#000080">:
        </font><font color="#FF0000"><b>begin
        </b></font>EndDialog <font color="#000080">(</font>hDlg<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
        </font>AboutDlgProc <font color="#000080">:= </font>TRUE<font color="#000080">;
        </font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>AboutDlgProc <font color="#000080">:= </font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>function </b></font>FMExtensionProc <font color="#000080">(</font>Handle<font color="#000080">: </font>HWnd<font color="#000080">; </font>Msg<font color="#000080">: </font>WORD<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>lParam<font color="#000080">: </font>Longint<font color="#000080">): </font>HMENU<font color="#000080">;
</font><font color="#FF0000"><b>export</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>lpload      <font color="#000080">: </font>PFMS_LOAD<font color="#000080">;
  </font>lpDialogProc<font color="#000080">: </font>TFARPROC<font color="#000080">;
  </font>wFocusedItem<font color="#000080">: </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>begin

case </b></font>Msg <font color="#FF0000"><b>of

  </b></font><font color="#008000"><i>{ ****************** File Manager Events
  }

  </i></font>FMEVENT_INITMENU<font color="#000080">:
    </font>DisplayStatus <font color="#000080">(</font>Handle<font color="#000080">, </font>Msg<font color="#000080">);

  </font>FMEVENT_LOAD<font color="#000080">:
    </font><font color="#008000"><i>{ Create status window
    }
    </i></font><font color="#FF0000"><b>begin
    if </b></font>ghwndStatus <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
      if not </b></font>CreateStatusWindow <font color="#000080">(</font>Handle<font color="#000080">) </font><font color="#FF0000"><b>then
        begin
        </b></font>MessageBox <font color="#000080">(</font>Handle<font color="#000080">,
          </font><font color="#800000">'Extension not loaded.  Status window creation error.'</font><font color="#000080">,
          </font><font color="#800000">'File Manager Extension'</font><font color="#000080">, </font>MB_OK <font color="#FF0000"><b>or </b></font>MB_ICONASTERISK<font color="#000080">);

        </font><font color="#008000"><i>{ Unload
        }
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>lpload <font color="#000080">:= @</font>lParam<font color="#000080">;

    </font><font color="#008000"><i>{ Assign the menu handle from the DLL's resource
    }
    </i></font>ghMenu <font color="#000080">:= </font>LoadMenu <font color="#000080">(</font>ghDllInst<font color="#000080">, </font><font color="#800000">'ExtensionMenu'</font><font color="#000080">);

    </font>lpload<font color="#000080">^.</font>Menu <font color="#000080">:= </font>ghMenu<font color="#000080">;

    </font><font color="#008000"><i>{ This is the delta we are being assigned.
    }
    </i></font>gwMenuDelta <font color="#000080">:= </font>lpload<font color="#000080">^.</font>wMenuDelta<font color="#000080">;

    </font><font color="#008000"><i>{ Size of the load structure
    }
    </i></font>lpload<font color="#000080">^.</font>dwSize <font color="#000080">:= </font>sizeof <font color="#000080">(</font>TFMS_LOAD<font color="#000080">);

    </font><font color="#008000"><i>{ Assign the popup menu name for this extension
    }
    </i></font>lstrcpy <font color="#000080">(</font>lpload<font color="#000080">^.</font>szMenuName<font color="#000080">, </font><font color="#800000">'&amp;Extension'</font><font color="#000080">);

    </font>MessageBox <font color="#000080">(</font>Handle<font color="#000080">, </font><font color="#800000">'File Manager Extension will be loaded.'</font><font color="#000080">,
      </font><font color="#800000">'File Manager Extension'</font><font color="#000080">, </font>MB_OK<font color="#000080">);

    </font><font color="#008000"><i>{ Return that handle
    }

    </i></font>FMExtensionProc <font color="#000080">:= </font>ghMenu<font color="#000080">;
    </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>FMEVENT_SELCHANGE<font color="#000080">:
    </font>DisplayStatus <font color="#000080">(</font>Handle<font color="#000080">, </font>Msg<font color="#000080">);

  </font>FMEVENT_UNLOAD<font color="#000080">:
    </font><font color="#FF0000"><b>begin
    </b></font>DisplayStatus <font color="#000080">(</font>Handle<font color="#000080">, </font>Msg<font color="#000080">);
    </font>MessageBox <font color="#000080">(</font>Handle<font color="#000080">, </font><font color="#800000">'File Manager Extension will be unloaded.'</font><font color="#000080">,
      </font><font color="#800000">'File Manager Extension'</font><font color="#000080">, </font>MB_OK<font color="#000080">);

    </font><font color="#008000"><i>{ Since the status window was created using DLL's
      instance handle, we will have to destroy it on our own.
    }
    </i></font>DestroyWindow <font color="#000080">(</font>ghwndStatus<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>FMEVENT_USER_REFRESH<font color="#000080">:
    </font>DisplayStatus <font color="#000080">(</font>Handle<font color="#000080">, </font>Msg<font color="#000080">);


  </font><font color="#008000"><i>{ ****************** Extension menu commands
  }

  </i></font>IDM_STATUSWIN<font color="#000080">:
    </font><font color="#FF0000"><b>begin
    if </b></font>GetMenuState <font color="#000080">(</font>ghMenu<font color="#000080">, </font>gwMenuDelta <font color="#000080">+ </font>Msg<font color="#000080">, </font>MF_BYCOMMAND<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>MF_CHECKED <font color="#000080">&gt;
</font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
      </b></font>gbStatusWinVisible <font color="#000080">:= </font>FALSE<font color="#000080">;

      </font><font color="#008000"><i>{ Hide the status window
      }
      </i></font>ShowWindow <font color="#000080">(</font>ghwndStatus<font color="#000080">, </font>SW_HIDE<font color="#000080">);

      </font><font color="#008000"><i>{ Remove the checkmark
      }
      </i></font>CheckMenuItem <font color="#000080">(</font>ghMenu<font color="#000080">, </font>gwMenuDelta <font color="#000080">+ </font>IDM_STATUSWIN<font color="#000080">, </font>MF_UNCHECKED <font color="#FF0000"><b>or
</b></font>MF_BYCOMMAND<font color="#000080">);

      </font><font color="#FF0000"><b>end
    else
      begin
      </b></font>gbStatusWinVisible <font color="#000080">:= </font>TRUE<font color="#000080">;

      </font><font color="#008000"><i>{ Show the status window
      }
      </i></font>ShowWindow <font color="#000080">(</font>ghwndStatus<font color="#000080">, </font>SW_SHOW<font color="#000080">);

      </font><font color="#008000"><i>{ Add the checkmark
      }
      </i></font>CheckMenuItem <font color="#000080">(</font>ghMenu<font color="#000080">, </font>gwMenuDelta <font color="#000080">+ </font>IDM_STATUSWIN<font color="#000080">, </font>MF_CHECKED <font color="#FF0000"><b>or
</b></font>MF_BYCOMMAND<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>IDM_GETDRIVEINFO<font color="#000080">:
    </font><font color="#FF0000"><b>begin
    </b></font>lpDialogProc <font color="#000080">:= @</font>DriveInfoDlgProc<font color="#000080">;
    </font>DialogBoxParam <font color="#000080">(</font>ghDllInst<font color="#000080">, </font><font color="#800000">'DriveInfo'</font><font color="#000080">, </font>Handle<font color="#000080">, </font>lpDialogProc<font color="#000080">, </font>Handle<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>IDM_GETFILESELLFN<font color="#000080">:
    </font><font color="#FF0000"><b>begin
    </b></font>lpDialogProc <font color="#000080">:= @</font>SelFileInfoDlgProc<font color="#000080">;
    </font>DialogBoxParam <font color="#000080">(</font>ghDllInst<font color="#000080">, </font><font color="#800000">'FileInfo'</font><font color="#000080">, </font>Handle<font color="#000080">, </font>lpDialogProc<font color="#000080">, </font>Handle<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>IDM_GETFOCUS<font color="#000080">:
    </font><font color="#FF0000"><b>begin
    </b></font>wFocusedItem <font color="#000080">:= </font>SendMessage <font color="#000080">(</font>Handle<font color="#000080">, </font>FM_GETFOCUS<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);

    </font><font color="#FF0000"><b>case </b></font>wFocusedItem <font color="#FF0000"><b>of
      </b></font>FMFOCUS_DIR<font color="#000080">:
        </font>MessageBox <font color="#000080">(</font>Handle<font color="#000080">, </font><font color="#800000">'Focus is on the DIRECTORY window.'</font><font color="#000080">,
          </font><font color="#800000">'Focus Information'</font><font color="#000080">, </font>MB_OK<font color="#000080">);

      </font>FMFOCUS_TREE<font color="#000080">:
        </font>MessageBox <font color="#000080">(</font>Handle<font color="#000080">, </font><font color="#800000">'Focus is on the TREE window.'</font><font color="#000080">,
          </font><font color="#800000">'Focus Information'</font><font color="#000080">, </font>MB_OK<font color="#000080">);

      </font>FMFOCUS_DRIVES<font color="#000080">:
        </font>MessageBox <font color="#000080">(</font>Handle<font color="#000080">, </font><font color="#800000">'Focus is on the DRIVE bar.'</font><font color="#000080">,
          </font><font color="#800000">'Focus Information'</font><font color="#000080">, </font>MB_OK<font color="#000080">);

      </font>FMFOCUS_SEARCH<font color="#000080">:

        </font>MessageBox <font color="#000080">(</font>Handle<font color="#000080">, </font><font color="#800000">'Focus is on the SEARCH RESULTS window.'</font><font color="#000080">,
          </font><font color="#800000">'Focus Information'</font><font color="#000080">, </font>MB_OK<font color="#000080">);

      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>IDM_REFRESHWINDOW<font color="#000080">,
  </font>IDM_REFRESHALLWINDOWS<font color="#000080">:
    </font><font color="#008000"><i>{ Refresh one or all the windows
    }
    </i></font><font color="#FF0000"><b>begin
    if </b></font>Msg <font color="#000080">= </font>IDM_REFRESHALLWINDOWS <font color="#FF0000"><b>then
      </b></font>SendMessage <font color="#000080">(</font>Handle<font color="#000080">, </font>FM_REFRESH_WINDOWS<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>SendMessage <font color="#000080">(</font>Handle<font color="#000080">, </font>FM_REFRESH_WINDOWS<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>IDM_RELOADEXTENSIONS<font color="#000080">:
    </font>PostMessage <font color="#000080">(</font>Handle<font color="#000080">, </font>FM_RELOAD_EXTENSIONS<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);

  </font>IDM_ABOUTEXT<font color="#000080">:
    </font><font color="#FF0000"><b>begin
    </b></font>lpDialogProc <font color="#000080">:= @</font>AboutDlgProc<font color="#000080">;
    </font>DialogBox <font color="#000080">(</font>ghDllInst<font color="#000080">, </font><font color="#800000">'AboutExtension'</font><font color="#000080">, </font>Handle<font color="#000080">, </font>lpDialogProc<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>FMExtensionProc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>exports
  </b></font>FMEXTENSIONPROC<font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font>ghDllInst <font color="#000080">:= </font>hInstance<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


&uacute;
(</font>continued next <font color="#FF0000"><b>message</b></font><font color="#000080">)

&Auml; </font>Area<font color="#000080">: </font>U<font color="#000080">-</font><font color="#FF0000"><b>PASCAL      </b></font><font color="#000080">|</font><font color="#800000">61 </font><font color="#000080">&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
  </font>Msg<font color="#800000">#</font><font color="#000080">: </font><font color="#800000">6685                                         </font>Date<font color="#000080">: </font><font color="#800000">08</font><font color="#000080">-</font><font color="#800000">04</font><font color="#000080">-</font><font color="#800000">94  07</font><font color="#000080">:</font><font color="#800000">28
  </font>From<font color="#000080">: </font>Vincze<font color="#000080">@</font>dseg<font color="#000080">.</font>ti<font color="#000080">.</font>com                           Read<font color="#000080">: </font>Yes    Replied<font color="#000080">: </font>No 
    <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>All                                          Mark<font color="#000080">:                     
  </font>Subj<font color="#000080">: [</font>A<font color="#000080">] </font>Windows <font color="#FF0000"><b>File </b></font>Manager
<font color="#000080">&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
@</font>SUBJECT<font color="#000080">:[</font>A<font color="#000080">] </font>Windows <font color="#FF0000"><b>File </b></font>Manager Extension                           
<font color="#000080">&uacute;(</font>Continued from last <font color="#FF0000"><b>message</b></font><font color="#000080">)
---------- </font>snip <font color="#000080">---------- </font>snip <font color="#000080">---------- </font>snip <font color="#000080">----------



</font><font color="#800000">#</font>include <font color="#000080">&quot;</font>constant<font color="#000080">.</font>pas<font color="#000080">&quot;

</font>ExtensionIcon   ICON    xtension<font color="#000080">.</font>ico


ExtensionMenu MENU
<font color="#FF0000"><b>BEGIN
  </b></font>MENUITEM    <font color="#000080">&quot;&amp;</font>Status Window<font color="#000080">&quot;,           </font>IDM_STATUSWIN
  MENUITEM    SEPARATOR
  MENUITEM    <font color="#000080">&quot;</font>Selected <font color="#000080">&amp;</font><font color="#FF0000"><b>File</b></font><font color="#000080">(</font>s<font color="#000080">) </font>Size<font color="#000080">...&quot;,</font>IDM_GETFILESELLFN
  MENUITEM    <font color="#000080">&quot;</font>Selected <font color="#000080">&amp;</font>Drive Info<font color="#000080">...&quot;,  </font>IDM_GETDRIVEINFO
  MENUITEM    <font color="#000080">&quot;</font>Focused <font color="#000080">&amp;</font>Item Info<font color="#000080">...&quot;,    </font>IDM_GETFOCUS
  MENUITEM    SEPARATOR
  MENUITEM    <font color="#000080">&quot;</font>Reload <font color="#000080">&amp;</font>Extension<font color="#000080">&quot;,        </font>IDM_RELOADEXTENSIONS
  MENUITEM    <font color="#000080">&quot;&amp;</font>Refresh <font color="#000080">&amp;</font>Window<font color="#000080">&quot;,          </font>IDM_REFRESHWINDOW
  MENUITEM    <font color="#000080">&quot;</font>Refresh All <font color="#000080">&amp;</font>Windows<font color="#000080">&quot;,      </font>IDM_REFRESHALLWINDOWS
  MENUITEM    SEPARATOR
  MENUITEM    <font color="#000080">&quot;&amp;</font>About Extension<font color="#000080">...&quot;,      </font>IDM_ABOUTEXT
<font color="#FF0000"><b>END

</b></font>FileInfo DIALOG <font color="#800000">22</font><font color="#000080">, </font><font color="#800000">17</font><font color="#000080">, </font><font color="#800000">144</font><font color="#000080">, </font><font color="#800000">71
</font>STYLE DS_MODALFRAME <font color="#000080">| </font>WS_OVERLAPPED <font color="#000080">| </font>WS_CAPTION <font color="#000080">| </font>WS_SYSMENU
CAPTION <font color="#000080">&quot;</font>Selected <font color="#FF0000"><b>File </b></font>Information<font color="#000080">&quot;
</font>FONT <font color="#800000">8</font><font color="#000080">, &quot;</font>Helv<font color="#000080">&quot;
</font><font color="#FF0000"><b>BEGIN
  </b></font>CONTROL <font color="#000080">&quot;</font>OK<font color="#000080">&quot;, </font>IDOK<font color="#000080">, &quot;</font>BUTTON<font color="#000080">&quot;, </font>WS_GROUP<font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">49</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">14
  </font>LTEXT <font color="#000080">&quot;</font><font color="#FF0000"><b>File</b></font><font color="#000080">(</font>s<font color="#000080">) </font>selected<font color="#000080">:&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Disk space taken<font color="#000080">:&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot; &quot;, </font>IDD_SELFILECOUNT<font color="#000080">, </font><font color="#800000">77</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot; &quot;, </font>IDD_SELFILESIZE<font color="#000080">, </font><font color="#800000">77</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">8
</font><font color="#FF0000"><b>END

</b></font>AboutExtension DIALOG <font color="#800000">8</font><font color="#000080">, </font><font color="#800000">21</font><font color="#000080">, </font><font color="#800000">237</font><font color="#000080">, </font><font color="#800000">215
</font>STYLE DS_MODALFRAME <font color="#000080">| </font>WS_OVERLAPPED <font color="#000080">| </font>WS_CAPTION <font color="#000080">| </font>WS_SYSMENU
CAPTION <font color="#000080">&quot;</font>About Extension<font color="#000080">&quot;
</font>FONT <font color="#800000">8</font><font color="#000080">, &quot;</font>Helv<font color="#000080">&quot;
</font><font color="#FF0000"><b>BEGIN
  </b></font>ICON <font color="#000080">&quot;</font>ExtensionIcon<font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">21
  </font>LTEXT <font color="#000080">&quot;</font><font color="#FF0000"><b>File </b></font>Manager Extension DLL<font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">34</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">150</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Version <font color="#800000">1.0</font><font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">34</font><font color="#000080">, </font><font color="#800000">15 150</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Copyright <font color="#000080">\</font><font color="#800000">251 </font>Microsoft Corp<font color="#000080">., </font><font color="#800000">1992</font><font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">34</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">150</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>A <font color="#FF0000"><b>File </b></font>Manager extension <font color="#FF0000"><b>is </b></font>a Windows DLL that adds a menu <font color="#FF0000"><b>to</b></font><font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">,
</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">232</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font><font color="#FF0000"><b>File </b></font>Manager<font color="#000080">, </font><font color="#FF0000"><b>contains </b></font>entry point that processes menu commands<font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">,
</font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">50</font><font color="#000080">, </font><font color="#800000">232</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font><font color="#FF0000"><b>and </b></font>notification messages sent by <font color="#FF0000"><b>File </b></font>Manager<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>queries data<font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">,
</font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">60</font><font color="#000080">, </font><font color="#800000">232</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font><font color="#FF0000"><b>and </b></font>information about the <font color="#FF0000"><b>File </b></font>Manager windows<font color="#000080">.&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">70</font><font color="#000080">, </font><font color="#800000">232</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Menu Options<font color="#000080">:&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">85</font><font color="#000080">, </font><font color="#800000">237</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Status Window<font color="#000080">\</font>t<font color="#000080">\</font>t<font color="#000080">- </font>Shows<font color="#000080">/</font>Hides status window<font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">98</font><font color="#000080">, </font><font color="#800000">230</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Selected <font color="#FF0000"><b>File</b></font><font color="#000080">(</font>s<font color="#000080">) </font>Size<font color="#000080">...\</font>t<font color="#000080">- </font>Displays disk space taken by the files<font color="#000080">&quot;,
-</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">108</font><font color="#000080">, </font><font color="#800000">230</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Selected Drive Info<font color="#000080">...\</font>t<font color="#000080">- </font>Displays selected drive information<font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">,
</font><font color="#800000">118</font><font color="#000080">, </font><font color="#800000">230</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Focused Item Info<font color="#000080">...\</font>t<font color="#000080">- </font>Displays the name <font color="#FF0000"><b>of </b></font>the focused item<font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">,
</font><font color="#800000">128</font><font color="#000080">, </font><font color="#800000">230</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Reload Extension<font color="#000080">\</font>t<font color="#000080">- </font>Reloads this extension<font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">138</font><font color="#000080">, </font><font color="#800000">230</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Refresh Window<font color="#000080">\</font>t<font color="#000080">- </font>Refreshes <font color="#FF0000"><b>File </b></font>Manager<font color="#800000">'s active window&quot;, -1, 5, 148,
230</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Refresh All Windows<font color="#000080">\</font>t<font color="#000080">- </font>Refreshes all the <font color="#FF0000"><b>File </b></font>Manager<font color="#800000">'s windows&quot;, -1,
5</font><font color="#000080">, </font><font color="#800000">158</font><font color="#000080">, </font><font color="#800000">230</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>About Extension<font color="#000080">...\</font>t<font color="#000080">- </font>Displays this dialog<font color="#000080">&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">168</font><font color="#000080">, </font><font color="#800000">230</font><font color="#000080">, </font><font color="#800000">8
  </font>CONTROL <font color="#000080">&quot;</font>OK<font color="#000080">&quot;, </font>IDOK<font color="#000080">, &quot;</font>BUTTON<font color="#000080">&quot;, </font>WS_GROUP<font color="#000080">, </font><font color="#800000">101</font><font color="#000080">, </font><font color="#800000">190</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">14
</font><font color="#FF0000"><b>END



</b></font>DriveInfo DIALOG <font color="#800000">22</font><font color="#000080">, </font><font color="#800000">17</font><font color="#000080">, </font><font color="#800000">188</font><font color="#000080">, </font><font color="#800000">85
</font>STYLE DS_MODALFRAME <font color="#000080">| </font>WS_OVERLAPPED <font color="#000080">| </font>WS_CAPTION <font color="#000080">| </font>WS_SYSMENU
CAPTION <font color="#000080">&quot;</font>Selected Drive Information<font color="#000080">&quot;
</font>FONT <font color="#800000">8</font><font color="#000080">, &quot;</font>Helv<font color="#000080">&quot;
</font><font color="#FF0000"><b>BEGIN
  </b></font>CONTROL <font color="#000080">&quot;</font>OK<font color="#000080">&quot;, </font>IDOK<font color="#000080">, &quot;</font>BUTTON<font color="#000080">&quot;, </font>WS_GROUP<font color="#000080">, </font><font color="#800000">77</font><font color="#000080">, </font><font color="#800000">65</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">14
  </font>LTEXT <font color="#000080">&quot;</font>Path<font color="#000080">:&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">46</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Volume<font color="#000080">:&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">46</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Share<font color="#000080">:&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">26</font><font color="#000080">, </font><font color="#800000">46</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Total KBs<font color="#000080">:&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">36</font><font color="#000080">, </font><font color="#800000">46</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot;</font>Free KBs<font color="#000080">:&quot;, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">46</font><font color="#000080">, </font><font color="#800000">46</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot; &quot;, </font>IDD_PATH<font color="#000080">, </font><font color="#800000">61</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot; &quot;, </font>IDD_VOLUME<font color="#000080">, </font><font color="#800000">61</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot; &quot;, </font>IDD_SHARE<font color="#000080">, </font><font color="#800000">61</font><font color="#000080">, </font><font color="#800000">26</font><font color="#000080">, </font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot; &quot;, </font>IDD_TOTALSPACE<font color="#000080">, </font><font color="#800000">61</font><font color="#000080">, </font><font color="#800000">36</font><font color="#000080">, </font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">8
  </font>LTEXT <font color="#000080">&quot; &quot;, </font>IDD_FREESPACE<font color="#000080">, </font><font color="#800000">61</font><font color="#000080">, </font><font color="#800000">46</font><font color="#000080">, </font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">8
</font><font color="#FF0000"><b>END

</b></font><font color="#000080">---------- </font>snip <font color="#000080">---------- </font>snip <font color="#000080">---------- </font>snip <font color="#000080">----------



</font><font color="#FF0000"><b>begin </b></font><font color="#800000">755 </font>icon<font color="#000080">.</font>zip
M4<font color="#800000">$</font>L<font color="#800000">#</font><font color="#000080">!!</font><font color="#800000">0    </font><font color="#000080">( &quot;</font>IC<font color="#000080">;!</font>E<font color="#000080">&gt;</font>O<font color="#000080">+@&amp;</font><font color="#800000">9</font><font color="#000080">@</font><font color="#800000">$  #</font>X<font color="#800000">$   </font><font color="#000080">,    </font><font color="#800000">6</font><font color="#000080">%</font><font color="#800000">1</font><font color="#000080">%</font><font color="#800000">3E</font><font color="#000080">-)</font><font color="#800000">3</font>TXN24<font color="#000080">-/</font>K9<font color="#000080">,]
</font>M<font color="#000080">;</font>H<font color="#000080">- </font><font color="#800000">$</font><font color="#000080">(</font><font color="#800000">4'B!4D%\X-0A6E1.( ^!2IJ;B!:V]E(5ERKD))EST*E447I&quot;B1&quot;\&gt;;
</font>M<font color="#000080">-[,</font>_<font color="#000080">%</font>I<font color="#000080">:</font>C1<font color="#000080">%</font><font color="#800000">$</font><font color="#000080">&gt;/-</font><font color="#800000">8</font>SWWH81D <font color="#800000">444</font>Q9<font color="#000080">%</font>A<font color="#000080">,</font>KCX<font color="#000080">@&gt;</font>L<font color="#000080">&amp;;</font><font color="#800000">9</font>G<font color="#000080">&lt;</font><font color="#800000">0#</font>TD_<font color="#000080">(/</font><font color="#800000">7</font><font color="#000080">(.</font><font color="#800000">7</font>A<font color="#000080">+</font>OCX3Y
MY5<font color="#000080">+&amp;</font>F<font color="#000080">/ [,</font><font color="#800000">4</font><font color="#000080">=</font><font color="#800000">4</font>GU<font color="#000080">%</font>LWA6LQ<font color="#000080">?</font>U<font color="#000080">*</font>QZ<font color="#000080">\</font>KN_H<font color="#000080">&lt;</font>S71B<font color="#000080">/</font>F4<font color="#000080">-</font>N1_VH<font color="#000080">@</font><font color="#800000">$</font><font color="#000080">=</font>F9<font color="#000080">/&amp;</font><font color="#800000">#9</font><font color="#000080">&gt;</font>T<font color="#000080">-</font>NJB
M<font color="#000080">!</font>W<font color="#000080">.@&quot;&quot;;</font>V<font color="#000080">&amp;</font>B<font color="#000080">[</font>A<font color="#000080">^</font>__V<font color="#800000">$3</font><font color="#000080">[!</font>AJU<font color="#000080">@</font>I<font color="#000080">^</font>F<font color="#000080">\;</font>J0G<font color="#000080">%</font><font color="#800000">5</font><font color="#000080">^?%</font>XB<font color="#000080">&lt;</font>I<font color="#000080">)</font><font color="#800000">1</font><font color="#000080">=^. </font><font color="#800000">4</font><font color="#000080">+</font>EIK<font color="#000080">?</font>AHY<font color="#000080">\</font><font color="#800000">5</font><font color="#000080">!</font>V
MX<font color="#000080">&lt;-,</font>Y_R<font color="#000080">=</font>YELK<font color="#000080">-;&quot;(</font><font color="#800000">4</font>I<font color="#000080">=</font>O<font color="#000080">^</font><font color="#800000">49</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">?/</font><font color="#800000">28</font>K4_<font color="#800000">#</font><font color="#000080">/</font>U04UIVK<font color="#000080">+;=</font>G<font color="#800000">':JJ2MPW(;YF()7
</font>MX<font color="#800000">$F1</font><font color="#000080">,</font>Q<font color="#000080">\]</font><font color="#800000">1</font>RQ<font color="#000080">\&lt;!</font>R<font color="#000080">%)]</font>S5<font color="#000080">]</font>_<font color="#000080">^</font><font color="#800000">7</font><font color="#000080">\</font><font color="#800000">8</font>RA<font color="#000080">?</font>B<font color="#800000">'*U1Y)YIU5NZGKBKF?D/0O]6U_4N9&lt;
</font>MOTF9<font color="#000080">?</font>S<font color="#000080">!</font><font color="#800000">'OFN[? &lt;]A_Z:0C:,OO^NR.U\RBVNS&amp;WLZY^Y[3=PUV_@;KZ&gt;+_P+
</font>MX<font color="#000080">&amp;)</font>R<font color="#000080">?/</font>OF8O<font color="#000080">^ +</font>RX<font color="#000080">.&amp;</font>T<font color="#000080">;</font>ZBXQ<font color="#000080">]&quot;</font><font color="#800000">1</font><font color="#000080">;</font>P<font color="#000080">+</font><font color="#800000">7</font><font color="#000080">]</font>NWW<font color="#000080">^</font><font color="#800000">5</font>OU5BKEG<font color="#000080">!&amp;</font>N<font color="#000080">[</font>A<font color="#800000">$</font><font color="#000080">?;</font>Z E<font color="#000080">!+ </font><font color="#800000">0</font><font color="#000080">(</font><font color="#800000">4
</font>M <font color="#000080">!</font><font color="#800000">0    </font><font color="#000080">( &quot;</font>IC<font color="#000080">;!</font>E<font color="#000080">&gt;</font>O<font color="#000080">+@&amp;</font><font color="#800000">9</font><font color="#000080">@</font><font color="#800000">$  #</font>X<font color="#800000">$   </font><font color="#000080">,            (         !</font><font color="#800000">85$5</font><font color="#000080">.
&gt;</font><font color="#800000">4</font>TE<font color="#000080">/</font><font color="#800000">3</font>BY<font color="#000080">)</font><font color="#800000">0</font>T<font color="#000080">]</font><font color="#800000">02</font>P4<font color="#000080">&amp;      </font><font color="#800000">$  0 </font>Z    D <font color="#800000">$     
 
</font><font color="#FF0000"><b>end

</b></font><font color="#000080">---------- </font><font color="#FF0000"><b>END </b></font><font color="#000080">---------- </font><font color="#FF0000"><b>END </b></font><font color="#000080">---------- </font><font color="#FF0000"><b>END </b></font><font color="#000080">---------- </font><font color="#FF0000"><b>END </b></font><font color="#000080">----------
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p></body>
</html>
