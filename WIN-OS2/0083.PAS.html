<html>
<head><title> "Help code for WINSOCK for PASCAL" by DARRYL LUFF</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{These are just a couple of handy routines. Not part of the winsock api, but
useful with it. }

</i></font><font color="#FF0000"><b>UNIT </b></font>wsockhlp<font color="#000080">;
</font><font color="#008000"><i>{ helper routines that aren't part of the spec, but are handy }
{ darryl luff 14Nov95 }

</i></font><font color="#FF0000"><b>interface
USES
  </b></font>Winsock<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SockErrorStr<font color="#000080">(</font>e <font color="#000080">: </font>Longint<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>SetBlocking<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>sw <font color="#000080">: </font>Boolean<font color="#000080">): </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>implementation


FUNCTION </b></font>SetBlocking<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>sw <font color="#000080">: </font>Boolean<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#008000"><i>{ sets the blocking state on a socket }
</i></font><font color="#FF0000"><b>VAR
  </b></font>cmd<font color="#000080">, </font>argp <font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>cmd <font color="#000080">:= </font>FIONBIO<font color="#000080">; </font>argp <font color="#000080">:= </font>Word<font color="#000080">(</font>sw<font color="#000080">);
  </font>SetBlocking <font color="#000080">:= </font>ioctlsocket<font color="#000080">(</font>s<font color="#000080">, </font>cmd<font color="#000080">, </font>argp<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SockErrorStr<font color="#000080">(</font>e <font color="#000080">: </font>Longint<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ returns an error string for }
{ the winsock error number    }
</i></font><font color="#FF0000"><b>VAR
  </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  CASE </b></font>e <font color="#FF0000"><b>OF
    </b></font>WSAEINTR   <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>WSAEBADF   <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>WSAEACCES  <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>WSAEFAULT  <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>WSAEINVAL  <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>WSAEMFILE  <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

  </font><font color="#008000"><i>{ windows sockets definitions of regular berkeley error constants }
    </i></font>WSAEWOULDBLOCK      <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'WouldBlock'</font><font color="#000080">;
    </font>WSAEINPROGRESS      <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'InProgress'</font><font color="#000080">;
    </font>WSAEALREADY         <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'Already'</font><font color="#000080">;
    </font>WSAENOTSOCK         <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'NotSock'</font><font color="#000080">;
    </font>WSAEDESTADDRREQ     <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'DestAddrReq'</font><font color="#000080">;
    </font>WSAEMSGSIZE         <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'MsgSize'</font><font color="#000080">;
    </font>WSAEPROTOTYPE       <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'ProtoType'</font><font color="#000080">;
    </font>WSAENOPROTOOPT      <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'NoProtoOpt'</font><font color="#000080">;
    </font>WSAEPROTONOSUPPORT  <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'ProtoNoSupport'</font><font color="#000080">;
    </font>WSAESOCKTNOSUPPORT  <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'SocktNoSupport'</font><font color="#000080">;
    </font>WSAEOPNOTSUPP       <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'OpNotSupp'</font><font color="#000080">;
    </font>WSAEPFNOSUPPORT     <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'PFNoSupport'</font><font color="#000080">;
    </font>WSAEAFNOSUPPORT     <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'AFNoSupport'</font><font color="#000080">;
    </font>WSAEADDRINUSE       <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'AddrInUse'</font><font color="#000080">;
    </font>WSAEADDRNOTAVAIL    <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'AddrNotAvail'</font><font color="#000080">;
    </font>WSAENETDOWN         <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'NetDown'</font><font color="#000080">;
    </font>WSAENETUNREACH      <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'NetUnreach'</font><font color="#000080">;
    </font>WSAENETRESET        <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'NetReset'</font><font color="#000080">;
    </font>WSAECONNABORTED     <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'ConnAborted'</font><font color="#000080">;
    </font>WSAECONNRESET       <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'ConnReset'</font><font color="#000080">;
    </font>WSAENOBUFS          <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'NoBuffs'</font><font color="#000080">;
    </font>WSAEISCONN          <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'IsConn'</font><font color="#000080">;
    </font>WSAENOTCONN         <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'NotConn'</font><font color="#000080">;
    </font>WSAESHUTDOWN        <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'ShutDown'</font><font color="#000080">;
    </font>WSAETOOMANYREFS     <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'TooManyRefs'</font><font color="#000080">;
    </font>WSAETIMEDOUT        <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'TimedOut'</font><font color="#000080">;
    </font>WSAECONNREFUSED     <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'ConnRefused'</font><font color="#000080">;
    </font>WSAELOOP            <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'Loop'</font><font color="#000080">;
    </font>WSAENAMETOOLONG     <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'NameNotLong'</font><font color="#000080">;
    </font>WSAEHOSTDOWN        <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'HostDown'</font><font color="#000080">;
    </font>WSAEHOSTUNREACH     <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'HostUnreach'</font><font color="#000080">;
    </font>WSAENOTEMPTY        <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'NotEmpty'</font><font color="#000080">;
    </font>WSAEPROCLIM         <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'Proclim'</font><font color="#000080">;
    </font>WSAEUSERS           <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'Users'</font><font color="#000080">;
    </font>WSAEDQUOT           <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'DQuot'</font><font color="#000080">;
    </font>WSAESTALE           <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'Stale'</font><font color="#000080">;
    </font>WSAEREMOTE          <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'Remote'</font><font color="#000080">;

    </font><font color="#008000"><i>{ extended windows sockets error constant definitions }
    </i></font>WSASYSNOTREADY      <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'SysNotReady'</font><font color="#000080">;
    </font>WSAVERNOTSUPPORTED  <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'VerNotSupported'</font><font color="#000080">;
    </font>WSANOTINITIALISED   <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'NotInitialised'</font><font color="#000080">;

  </font><font color="#008000"><i>{ error return codes from gethostbyname() and gethostbyaddr() }
  { (when using the resolver). note that these errors are       }
  { retrieved via WSAGetLastError() and must therefore follow   }
  { the rules for avoiding clashes with error numbers from      }
  { specific implementations or language run-time systems. for  }
  { this reason the codes are based at WSABASEERR+1001. note    }
  { also that [WSA]NO_ADDRESS is defined only for compatibility }
  { purposes.                                                   }

  { authoritative answer: Host not found }
  </i></font>WSAHOST_NOT_FOUND     <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'Host Not Found'</font><font color="#000080">;

  </font><font color="#008000"><i>{ non-authoritative: Host not found, or SERVERFAIL }
  </i></font>WSATRY_AGAIN          <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'Host not found - try again'</font><font color="#000080">;

  </font><font color="#008000"><i>{ non-recoverable errors, FORMERR, REFUSED, NOTIMP }
  </i></font>WSANO_RECOVERY        <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'Unrecoverable error'</font><font color="#000080">;

  </font><font color="#008000"><i>{ valid name, no data record of requested type }
  </i></font>WSANO_DATA            <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'Valid name but no data'</font><font color="#000080">;

  </font>WSANO_ADDRESS         <font color="#000080">: </font>s <font color="#000080">:= </font><font color="#800000">'No address, look for MX record'</font><font color="#000080">;
  </font><font color="#FF0000"><b>ELSE
    </b></font>s <font color="#000080">:= </font><font color="#800000">''
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>SockErrorStr <font color="#000080">:= </font>s
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p></body>
</html>
