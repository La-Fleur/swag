<html>
<head><title> "Bulk Windows Processing" by AHMED BHAMJEE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0062.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: omipd@aztec.co.za (Ahmed Bhamjee)

This is the best way to do bulk processing in Windows. When the window is
created, you set a timer for PROCESSDELAY milliseconds.
}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>caProcessFile<font color="#000080">.</font>SetupWindow<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    INHERITED </b></font>SetupWindow<font color="#000080">;
    </font>fCurrent <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>SetTimer<font color="#000080">(</font>HWindow<font color="#000080">,</font>tm_ProcessRecord<font color="#000080">,</font>PROCESSDELAY<font color="#000080">,</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{
When the timer message arrives, post a user message to the same window do
perform the required task (eg stepping through a database)
}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>caProcessFile<font color="#000080">.</font>WMTimer<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Msg<font color="#000080">:</font>TMessage<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>KillTimer<font color="#000080">(</font>HWindow<font color="#000080">,</font>tm_ProcessRecord<font color="#000080">);
    </font>PostMessage<font color="#000080">(</font>HWindow<font color="#000080">,</font>um_ProcessRecord<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{
When the message arrives, decide firstly how many records (iterations) you
wish to perform before releasing &quot;time&quot; to Windows.
}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>caProcessFile<font color="#000080">.</font>ProcessRecord<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Msg<font color="#000080">:</font>TMessage<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>SetExit<font color="#000080">(</font>FALSE<font color="#000080">);
    </font><font color="#FF0000"><b>WHILE NOT </b></font>fpoDatabase<font color="#000080">^.</font>EOF <font color="#FF0000"><b>DO
      BEGIN
        </b></font>fErrorCode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font>DoSomething<font color="#000080">;
        </font><font color="#FF0000"><b>IF </b></font>fErrorCode <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
          BEGIN
            </b></font>CloseYourSelf<font color="#000080">(</font>fErrorCode<font color="#000080">);
            </font>EXIT<font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>fpoDatabase<font color="#000080">^.</font>Skip<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
        </font>INC<font color="#000080">(</font>fCurrent<font color="#000080">);
</font><font color="#008000"><i>{
BLOCKSIZE is the number of iterations.
}
        </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>fCurrent <font color="#FF0000"><b>MOD </b></font>BLOCKSIZE<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
         BEGIN
           </b></font>SetExit<font color="#000080">(</font>TRUE<font color="#000080">);
</font><font color="#008000"><i>{
Set a timer back to this method.
}
           </i></font>SetTimer<font color="#000080">(</font>HWindow<font color="#000080">,</font>tm_ProcessRecord<font color="#000080">,</font>PROCESSDELAY<font color="#000080">,</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">);
           </font>EXIT<font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>EndProcessing<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>caProcessFile<font color="#000080">.</font>EndProcessing<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>KillTimer<font color="#000080">(</font>HWindow<font color="#000080">,</font>tm_ProcessRecord<font color="#000080">);
    </font>CloseYourSelf<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0062.PAS">Original</a><b>]</b></p></body>
</html>
