<html>
<head><title> "Using VER.DLL" by ZWEITZE DE VRIES</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0037.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: ZWEITZE@et.tudelft.nl (Zweitze de Vries)

&gt;Does anyone have examples of installation programs that use
&gt;the file installation library (VER.DLL) in BP7?

Since all installation programs do the same thing, why reinvent
the wheel? Just buy one, it should be cheaper than developing
your own. There are also some share/freeware apps around (try CICA).

In respect to your question, I have some code that fills a dialog
box ('About...') according to the version information resource:
}

</i></font><font color="#FF0000"><b>procedure </b></font>THelpAbout<font color="#000080">.</font>SetUpWindow<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>lVerInfoSize<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>lVerHandle<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>szModuleName<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>fsPathName<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>pVerData<font color="#000080">: </font>PChar<font color="#000080">;
  </font>Buffer<font color="#000080">: </font>Pointer<font color="#000080">;
  </font>lenBuffer<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>TDialog<font color="#000080">.</font>SetupWindow<font color="#000080">;
  </font>GetModuleFileName<font color="#000080">(</font>hInstance<font color="#000080">, </font>szModuleName<font color="#000080">, </font>SizeOf<font color="#000080">(</font>szModuleName<font color="#000080">));
  </font>lVerInfoSize <font color="#000080">:= </font>GetFileVersionInfoSize<font color="#000080">(</font>szModuleName<font color="#000080">, </font>lVerHandle<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>lVerInfoSize <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
  </font>GetMem<font color="#000080">(</font>pVerData<font color="#000080">, </font>lVerInfoSize<font color="#000080">);
  </font><font color="#FF0000"><b>if not </b></font>GetFileVersionInfo<font color="#000080">(</font>szModuleName<font color="#000080">, </font>lVerHandle<font color="#000080">, </font>lVerInfoSize<font color="#000080">, </font>pVerData<font color="#000080">)
    </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>VerQueryValue<font color="#000080">(</font>pVerData<font color="#000080">, </font><font color="#800000">'\StringFileInfo\CATE\ProductName'</font><font color="#000080">,
                   </font>Buffer<font color="#000080">, </font>LenBuffer<font color="#000080">)
     </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>LenBuffer <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>then </b></font>SetDlgItemText<font color="#000080">(</font>hWindow<font color="#000080">, </font>stat_AppName<font color="#000080">, </font>Buffer<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>VerQueryValue<font color="#000080">(</font>pVerData<font color="#000080">, </font><font color="#800000">'\StringFileInfo\CATE\ProductVersion'</font><font color="#000080">,
                   </font>Buffer<font color="#000080">, </font>LenBuffer<font color="#000080">)
     </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>LenBuffer <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>then </b></font>SetDlgItemText<font color="#000080">(</font>hWindow<font color="#000080">, </font>stat_AppVersion<font color="#000080">, </font>Buffer<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>VerQueryValue<font color="#000080">(</font>pVerData<font color="#000080">, </font><font color="#800000">'\StringFileInfo\CATE\CompanyName'</font><font color="#000080">,
                   </font>Buffer<font color="#000080">, </font>LenBuffer<font color="#000080">)
     </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>LenBuffer <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>then </b></font>SetDlgItemText<font color="#000080">(</font>hWindow<font color="#000080">, </font>stat_AppCompany<font color="#000080">, </font>Buffer<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>VerQueryValue<font color="#000080">(</font>pVerData<font color="#000080">, </font><font color="#800000">'\StringFileInfo\CATE\LegalCopyright'</font><font color="#000080">,
                   </font>Buffer<font color="#000080">, </font>LenBuffer<font color="#000080">)
     </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>LenBuffer <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>then </b></font>SetDlgItemText<font color="#000080">(</font>hWindow<font color="#000080">, </font>stat_AppCopyright<font color="#000080">, </font>Buffer<font color="#000080">);
  </font>FreeMem<font color="#000080">(</font>pVerData<font color="#000080">, </font>lVerInfoSize<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0037.PAS">Original</a><b>]</b></p></body>
</html>
