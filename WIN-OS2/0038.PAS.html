<html>
<head><title> "Bitmap Loading In Windows" by BRIAN GRAINGER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0038.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
MM&gt; Thanks alot but I was woundering if you had the complete code USES
MM&gt; and every thing no blanks. Becuase I am not to good at graphics. ---

}
</i></font><font color="#FF0000"><b>UNIT </b></font>BMPWin<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

USES
  </b></font>WinProcs<font color="#000080">, </font>WinTypes<font color="#000080">, </font>Objects<font color="#000080">, </font>OWindows<font color="#000080">;

</font><font color="#008000"><i>{$R MYBMP.RES} (* Change as appropriate *)

</i></font><font color="#FF0000"><b>TYPE
  </b></font>pBMPWindow <font color="#000080">= ^</font>tBMPWindow<font color="#000080">;
  </font>tBMPWindow <font color="#000080">= </font><font color="#FF0000"><b>OBJECT</b></font><font color="#000080">(</font>tWindow<font color="#000080">)
    </font><font color="#FF0000"><b>PRIVATE
      </b></font>vBitmap <font color="#000080">: </font>hBitmap<font color="#000080">;
      </font>vBitSize <font color="#000080">: </font>tBitmap<font color="#000080">;
    </font><font color="#FF0000"><b>PUBLIC
      CONSTRUCTOR </b></font>Init<font color="#000080">(</font>aParent <font color="#000080">: </font>pWindowsObject<font color="#000080">; </font>aBitmapName <font color="#000080">: </font>pChar<font color="#000080">);
      </font><font color="#FF0000"><b>DESTRUCTOR </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>PROCEDURE </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>PROCEDURE </b></font>Paint<font color="#000080">(</font>vDC <font color="#000080">: </font>hDC<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>vPS <font color="#000080">: </font>tPaintStruct<font color="#000080">); </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

CONSTRUCTOR </b></font>tBMPWindow<font color="#000080">.</font>Init<font color="#000080">(</font>aParent <font color="#000080">: </font>pWindowsObject<font color="#000080">; </font>aBitmapName <font color="#000080">:
</font>pChar<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    INHERITED </b></font>Init<font color="#000080">(</font>aParent<font color="#000080">, </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">);
    </font>Attr<font color="#000080">.</font>Style <font color="#000080">:= </font>ws_Child <font color="#FF0000"><b>OR </b></font>ws_Visible<font color="#000080">;
    </font>vBitmap <font color="#000080">:= </font>LoadBitmap<font color="#000080">(</font>hInstance<font color="#000080">, </font>aBitmapName<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>vBitmap <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>Status <font color="#000080">:= </font>em_InvalidWindow<font color="#000080">;
        </font>Fail<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>GetObject<font color="#000080">(</font>vBitmap<font color="#000080">, </font>SizeOf<font color="#000080">(</font>vBitSize<font color="#000080">), @</font>vBitSize<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>DESTRUCTOR </b></font>tBMPWindow<font color="#000080">.</font>Done<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>DeleteObject<font color="#000080">(</font>vBitmap<font color="#000080">);
    </font><font color="#FF0000"><b>INHERITED </b></font>Done<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>tBMPWindow<font color="#000080">.</font>SetupWindow<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    INHERITED </b></font>SetupWindow<font color="#000080">;
    </font>SetWindowPos<font color="#000080">(</font>hWindow<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>vBitSize<font color="#000080">.</font>bmWidth<font color="#000080">, </font>vBitSize<font color="#000080">.</font>bmHeight<font color="#000080">,
                 </font>swp_NoMove <font color="#FF0000"><b>OR </b></font>swp_NoZOrder <font color="#FF0000"><b>OR </b></font>swp_NoActivate <font color="#FF0000"><b>OR
                 </b></font>swp_NoRedraw<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>tBMPWindow<font color="#000080">.</font>Paint<font color="#000080">(</font>vDC <font color="#000080">: </font>hDC<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>vPS <font color="#000080">: </font>tPaintStruct<font color="#000080">);
  </font><font color="#FF0000"><b>VAR
    </b></font>vRect <font color="#000080">: </font>tRect<font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>DrawBitmap<font color="#000080">;
    </font><font color="#FF0000"><b>VAR
      </b></font>vMemDC <font color="#000080">: </font>hDC<font color="#000080">;
      </font>vOldBMP <font color="#000080">: </font>hBitmap<font color="#000080">;

    </font><font color="#FF0000"><b>BEGIN
      </b></font>vMemDC <font color="#000080">:= </font>CreateCompatibleDC<font color="#000080">(</font>vDC<font color="#000080">);
      </font>vOldBMP <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>vMemDC<font color="#000080">, </font>vBitmap<font color="#000080">);
      </font>BitBlt<font color="#000080">(</font>vDC<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Attr<font color="#000080">.</font>W<font color="#000080">, </font>Attr<font color="#000080">.</font>H<font color="#000080">, </font>vMemDC<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>srcCopy<font color="#000080">);
      </font>SelectObject<font color="#000080">(</font>vMemDC<font color="#000080">, </font>vOldBMP<font color="#000080">);
      </font>DeleteDC<font color="#000080">(</font>vMemDC<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    </b></font>SaveDC<font color="#000080">(</font>vDC<font color="#000080">);
    </font>DrawBitmap<font color="#000080">;
    </font>RestoreDC<font color="#000080">(</font>vDC<font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0038.PAS">Original</a><b>]</b></p></body>
</html>
