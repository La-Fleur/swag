<html>
<head><title> "WINSOCK for Pascal" by DARRYL LUFF</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0082.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>UNIT </b></font>Winsock<font color="#000080">;
</font><font color="#008000"><i>{ WINSOCK.H converted to Pascal - Darryl Luff 15Nov95 }
{ Not fully tested, please send corrections to either:}
{ dluff@ibm.net,  luffd@ocean.com.au, or              }
{ Darryl Luff at Fido 3:632/506.4                     }

</i></font><font color="#FF0000"><b>interface
USES
  </b></font>WinTypes<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font><font color="#008000"><i>{ basic type definitions, from BSD sys/types.h }
  </i></font>u_char  <font color="#000080">= </font>Byte<font color="#000080">;
  </font>u_short <font color="#000080">= </font>Word<font color="#000080">;
  </font>u_int   <font color="#000080">= </font>Word<font color="#000080">;
  </font>u_long  <font color="#000080">= </font>Longint<font color="#000080">;  </font><font color="#008000"><i>{ not really, as longint is signed }

  { new type to be used in all instances which refer to sockets }
  </i></font>TSocket   <font color="#000080">= </font>u_int<font color="#000080">;

  </font><font color="#008000"><i>{ macros to manipulate the socket arrays }
</i></font><font color="#FF0000"><b>CONST
  </b></font>FD_SETSIZE <font color="#000080">= </font><font color="#800000">64</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>Tfd_set <font color="#000080">= </font><font color="#FF0000"><b>Record  </b></font><font color="#008000"><i>{ originally fd_set but name clashed }
    </i></font>fd_count <font color="#000080">: </font>u_short<font color="#000080">;
    </font>fd_array <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>FD_SETSIZE<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>TSocket<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>__WSAFDIsSet<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>fds <font color="#000080">: </font>Tfd_set<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#008000"><i>{external }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>FD_CLR<font color="#000080">(</font>fd <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>fdset <font color="#000080">: </font>Tfd_set<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION  </b></font>FD_ISSET<font color="#000080">(</font>fd <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>fdset <font color="#000080">: </font>Tfd_set<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>FD_SET<font color="#000080">(</font>fd <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>fdset <font color="#000080">: </font>Tfd_set<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>FD_ZERO<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>fdset <font color="#000080">: </font>Tfd_set<font color="#000080">);

</font><font color="#008000"><i>{ structure used in select() call, from BSD sys/time.h }
</i></font><font color="#FF0000"><b>TYPE
  </b></font>timeval <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>tv_sec<font color="#000080">,             </font><font color="#008000"><i>{ seconds }
    </i></font>tv_usec <font color="#000080">: </font>Longint<font color="#000080">;  </font><font color="#008000"><i>{ microseconds }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ operations on timevals }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>timerisset<font color="#000080">(</font>tvp <font color="#000080">: </font>timeval<font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>timercmp<font color="#000080">(</font>tvp<font color="#000080">, </font>uvp <font color="#000080">: </font>timeval<font color="#000080">; </font>cmp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ the original timercmp took a third parameter of the operator }
{ (was a 'c' macro. But, the original couldn't handle 2        }
{ character operators ('&gt;=' etc) so we're a bit better off.    }


{ commands for ioctlsocket(), taken from BSD fcntl.h }
</i></font><font color="#FF0000"><b>CONST
  </b></font>IOCPARM_MASK  <font color="#000080">= </font><font color="#800000">$7F</font><font color="#000080">;                </font><font color="#008000"><i>{ parms must be &lt;= 128 bytes }
  </i></font>IOC_VOID      <font color="#000080">= </font><font color="#800000">$20000000</font><font color="#000080">;          </font><font color="#008000"><i>{ no parameters }
  </i></font>IOC_OUT       <font color="#000080">= </font><font color="#800000">$40000000</font><font color="#000080">;          </font><font color="#008000"><i>{ copy out parameters }
  </i></font>IOC_IN        <font color="#000080">= </font><font color="#800000">$80000000</font><font color="#000080">;          </font><font color="#008000"><i>{ copy in parameters }
  </i></font>IOC_INOUT     <font color="#000080">= </font>IOC_IN <font color="#FF0000"><b>OR </b></font>IOC_OUT<font color="#000080">;
                  </font><font color="#008000"><i>{ $20000000 distinguishes new and old ioctl's }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>_IO<font color="#000080">(</font>x<font color="#000080">, </font>y <font color="#000080">: </font>Byte<font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>_IOR<font color="#000080">(</font>x <font color="#000080">: </font>Char<font color="#000080">; </font>y <font color="#000080">: </font>Byte<font color="#000080">; </font>tSize <font color="#000080">: </font>Integer<font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#008000"><i>{ original took a type as the third parameter, and }
{ used 'sizeof' to get size. (c macro)             }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>_IOW<font color="#000080">(</font>x <font color="#000080">: </font>Char<font color="#000080">; </font>y<font color="#000080">, </font>tSize <font color="#000080">: </font>Longint<font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#008000"><i>{FUNCTION _IOW(x : Char; y : Byte; tSize : Word): Longint;}
{ as above }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>FIONREAD<font color="#000080">: </font>Longint<font color="#000080">;     </font><font color="#008000"><i>{ get number of bytes to read }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>FIONBIO<font color="#000080">: </font>Longint<font color="#000080">;      </font><font color="#008000"><i>{ set/clear non-blocking I/O }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>FIOASYNC<font color="#000080">: </font>Longint<font color="#000080">;     </font><font color="#008000"><i>{ set/clear async I/O }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>SIOCSHIWAT<font color="#000080">: </font>Longint<font color="#000080">;   </font><font color="#008000"><i>{set high watermark }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>SIOCGHIWAT<font color="#000080">: </font>Longint<font color="#000080">;   </font><font color="#008000"><i>{ get high watermark }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>SIOCSLOWAT<font color="#000080">: </font>Longint<font color="#000080">;   </font><font color="#008000"><i>{ set lo watermark }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>SIOCGLOWAT<font color="#000080">: </font>Longint<font color="#000080">;   </font><font color="#008000"><i>{ get lo watermark }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>SIOCATMARK<font color="#000080">: </font>Longint<font color="#000080">;   </font><font color="#008000"><i>{ at oob mark ? }


{ structures returned by network database library, taken }
{ from BSD file netdb.h. All addresses are supplied in   }
{ host order, and returned in network order.             }

</i></font><font color="#FF0000"><b>CONST
  </b></font>MAXALIASES   <font color="#000080">= </font><font color="#800000">99</font><font color="#000080">; </font><font color="#008000"><i>{ ? }
  </i></font>MAXADDRESSES <font color="#000080">= </font><font color="#800000">99</font><font color="#000080">; </font><font color="#008000"><i>{?}
</i></font><font color="#FF0000"><b>TYPE
  </b></font>PAliasList <font color="#000080">= ^</font>TAliasList<font color="#000080">;
  </font>TAliasList <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MAXALIASES<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>PChar<font color="#000080">;
  </font>PAddressList <font color="#000080">= ^</font>TAddressList<font color="#000080">;
  </font>TAddressList <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MAXADDRESSES<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font><font color="#000080">^</font>u_long<font color="#000080">;
  </font><font color="#008000"><i>{ I made these up for the below }

  </i></font>Phostent <font color="#000080">= ^</font>hostent<font color="#000080">;
  </font>hostent <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>h_name      <font color="#000080">: </font>PChar<font color="#000080">;        </font><font color="#008000"><i>{ official name of host }
    </i></font>h_aliases   <font color="#000080">: </font>PAliasList<font color="#000080">;   </font><font color="#008000"><i>{ see above }
    </i></font>h_addrtype  <font color="#000080">: </font>Integer<font color="#000080">;      </font><font color="#008000"><i>{ host address type }
    </i></font>h_length    <font color="#000080">: </font>Integer<font color="#000080">;      </font><font color="#008000"><i>{ length of address }
    </i></font><font color="#FF0000"><b>CASE </b></font>Boolean <font color="#FF0000"><b>OF
      </b></font>False <font color="#000080">: (</font>h_addr_list <font color="#000080">: </font>PAddressList<font color="#000080">);
      </font>True  <font color="#000080">: (</font>h_addr      <font color="#000080">: ^</font>u_long<font color="#000080">);
    </font><font color="#008000"><i>{ #define h_addr h_addr_list[0]   for compatibility }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ assumed here that a network number fits into 32 bits }
  </i></font>netent <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>n_name      <font color="#000080">: </font>PChar<font color="#000080">;        </font><font color="#008000"><i>{ official name of net }
    </i></font>n_aliases   <font color="#000080">: </font>PAliasList<font color="#000080">;   </font><font color="#008000"><i>{ alias list }
    </i></font>n_addrtype  <font color="#000080">: </font>Integer<font color="#000080">;      </font><font color="#008000"><i>{ net address type }
    </i></font>n_net       <font color="#000080">: </font>Longint<font color="#000080">;      </font><font color="#008000"><i>{ network # }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>Pservent <font color="#000080">= ^</font>servent<font color="#000080">;
  </font>servent <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>s_name      <font color="#000080">: </font>PChar<font color="#000080">;        </font><font color="#008000"><i>{ official service name }
    </i></font>s_aliases   <font color="#000080">: </font>PAliasList<font color="#000080">;   </font><font color="#008000"><i>{ alias list }
    </i></font>s_port      <font color="#000080">: </font>Integer<font color="#000080">;      </font><font color="#008000"><i>{ port # }
    </i></font>s_proto     <font color="#000080">: </font>PChar<font color="#000080">;        </font><font color="#008000"><i>{ protocol to use }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>Pprotoent <font color="#000080">= ^</font>protoent<font color="#000080">;
  </font>protoent <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>p_name      <font color="#000080">: </font>PChar<font color="#000080">;        </font><font color="#008000"><i>{ official protocol name }
    </i></font>p_aliases   <font color="#000080">: </font>PAliasList<font color="#000080">;   </font><font color="#008000"><i>{ alias list }
    </i></font>p_proto     <font color="#000080">: </font>Integer<font color="#000080">;      </font><font color="#008000"><i>{ protocol # }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>{ constants and structures defined by the internet system, }
{ Per RFC790, Sept. 1981. taken from BSD netinet/in.h      }
</i></font><font color="#FF0000"><b>CONST
  </b></font><font color="#008000"><i>{ protocols }
  </i></font>IPPROTO_IP    <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;            </font><font color="#008000"><i>{ dummy for IP }
  </i></font>IPPROTO_ICMP  <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;            </font><font color="#008000"><i>{ control message protocol }
  </i></font>IPPROTO_GGP   <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;            </font><font color="#008000"><i>{ gateway^2 (deprecated) }
  </i></font>IPPROTO_TCP   <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;            </font><font color="#008000"><i>{ tcp }
  </i></font>IPPROTO_PUP   <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">;           </font><font color="#008000"><i>{ pup }
  </i></font>IPPROTO_UDP   <font color="#000080">= </font><font color="#800000">17</font><font color="#000080">;           </font><font color="#008000"><i>{ udp }
  </i></font>IPPROTO_IDP   <font color="#000080">= </font><font color="#800000">22</font><font color="#000080">;           </font><font color="#008000"><i>{ xns idp }
  </i></font>IPPROTO_ND    <font color="#000080">= </font><font color="#800000">77</font><font color="#000080">;           </font><font color="#008000"><i>{ UNOFFICIAL net disk proto }

  </i></font>IPPROTO_RAW   <font color="#000080">= </font><font color="#800000">255</font><font color="#000080">;          </font><font color="#008000"><i>{ raw IP packet }
  </i></font>IPPROTO_MAX   <font color="#000080">= </font><font color="#800000">256</font><font color="#000080">;

  </font><font color="#008000"><i>{ port/socket numbers: network standard functions }
  </i></font>IPPORT_ECHO       <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
  </font>IPPORT_DISCARD    <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">;
  </font>IPPORT_SYSTAT     <font color="#000080">= </font><font color="#800000">11</font><font color="#000080">;
  </font>IPPORT_DAYTIME    <font color="#000080">= </font><font color="#800000">13</font><font color="#000080">;
  </font>IPPORT_NETSTAT    <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;
  </font>IPPORT_FTP        <font color="#000080">= </font><font color="#800000">21</font><font color="#000080">;
  </font>IPPORT_TELNET     <font color="#000080">= </font><font color="#800000">23</font><font color="#000080">;
  </font>IPPORT_SMTP       <font color="#000080">= </font><font color="#800000">25</font><font color="#000080">;
  </font>IPPORT_TIMESERVER <font color="#000080">= </font><font color="#800000">37</font><font color="#000080">;
  </font>IPPORT_NAMESERVER <font color="#000080">= </font><font color="#800000">42</font><font color="#000080">;
  </font>IPPORT_WHOIS      <font color="#000080">= </font><font color="#800000">43</font><font color="#000080">;
  </font>IPPORT_MTP        <font color="#000080">= </font><font color="#800000">57</font><font color="#000080">;

  </font><font color="#008000"><i>{ port/socket numbers: host specific functions }
  </i></font>IPPORT_TFTP       <font color="#000080">= </font><font color="#800000">69</font><font color="#000080">;
  </font>IPPORT_RJE        <font color="#000080">= </font><font color="#800000">77</font><font color="#000080">;
  </font>IPPORT_FINGER     <font color="#000080">= </font><font color="#800000">79</font><font color="#000080">;
  </font>IPPORT_TTYLINK    <font color="#000080">= </font><font color="#800000">87</font><font color="#000080">;
  </font>IPPORT_SUPDUP     <font color="#000080">= </font><font color="#800000">95</font><font color="#000080">;

  </font><font color="#008000"><i>{ UNIX TCP sockets }
  </i></font>IPPORT_EXECSERVER   <font color="#000080">= </font><font color="#800000">512</font><font color="#000080">;
  </font>IPPORT_LOGINSERVER  <font color="#000080">= </font><font color="#800000">513</font><font color="#000080">;
  </font>IPPORT_CMDSERVER    <font color="#000080">= </font><font color="#800000">514</font><font color="#000080">;
  </font>IPPORT_EFSSERVER    <font color="#000080">= </font><font color="#800000">520</font><font color="#000080">;

  </font><font color="#008000"><i>{ UNIX UDP sockets }
  </i></font>IPPORT_BIFFUDP      <font color="#000080">= </font><font color="#800000">512</font><font color="#000080">;
  </font>IPPORT_WHOSERVER    <font color="#000080">= </font><font color="#800000">513</font><font color="#000080">;
  </font>IPPORT_ROUTESERVER  <font color="#000080">= </font><font color="#800000">520</font><font color="#000080">;

  </font><font color="#008000"><i>{ ports &lt; IPPORT_RESERVED are reserved for }
  { priveledged processes (eg. root)         }
  </i></font>IPPORT_RESERVED     <font color="#000080">= </font><font color="#800000">1024</font><font color="#000080">;

  </font><font color="#008000"><i>{ link numbers }
  </i></font>IMPLINK_IP          <font color="#000080">= </font><font color="#800000">155</font><font color="#000080">;
  </font>IMPLINK_LOWEXPER    <font color="#000080">= </font><font color="#800000">156</font><font color="#000080">;
  </font>IMPLINK_HIGHEXPER   <font color="#000080">= </font><font color="#800000">158</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font><font color="#008000"><i>{ internet address (old style... should be updated }
  </i></font>in_addr <font color="#000080">= </font><font color="#FF0000"><b>Record
    CASE </b></font>Integer <font color="#FF0000"><b>OF

      </b></font><font color="#800000">0 </font><font color="#000080">: (</font>s_b1<font color="#000080">, </font>s_b2<font color="#000080">, </font>s_b3<font color="#000080">, </font>s_b4 <font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#008000"><i>{S_un_b}
      </i></font><font color="#800000">1 </font><font color="#000080">: (</font>s_w1<font color="#000080">, </font>s_w2 <font color="#000080">: </font>Word<font color="#000080">);             </font><font color="#008000"><i>{S_un_w}
      </i></font><font color="#800000">2 </font><font color="#000080">: (</font>s_addr <font color="#000080">: </font>Longint<font color="#000080">)               </font><font color="#008000"><i>{S_addr}
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ S_un; }

  {#define s_addr S_un.s_addr}
  {#define s_host S_un.s_un_b.s_b2}
  {#define s_net  S_un.S_un_b.s_b1}
  {#define s_imp  S_un.S_un_w.s_w2}
  {#define s_impno S_un_b.s_b4}
  {#define s_lh    S_un.S_un_b.b_s3}

</i></font><font color="#FF0000"><b>CONST
  </b></font><font color="#008000"><i>{ definition of bits in internet address integers. }
  { on subnets, the decomposition of addresses to    }
  { host and net parts is done according to the      }
  { subnet masks, not the masks here.                }
  {#define IN_CLASSA(i)   (((long)(i) &amp; 0x80000000) == 0) }
  </i></font>IN_CLASSA_NET     <font color="#000080">= </font><font color="#800000">$FF000000</font><font color="#000080">;
  </font>IN_CLASSA_NSHIFT  <font color="#000080">= </font><font color="#800000">24</font><font color="#000080">;
  </font>IN_CLASSA_HOST    <font color="#000080">= </font><font color="#800000">$00FFFFFF</font><font color="#000080">;
  </font>IN_CLASSA_MAX     <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">;

  </font><font color="#008000"><i>{#define IN_CLASSB(i)  (((long)(i) &amp; 0xc0000000) == 0x80000000) }
  </i></font>IN_CLASSB_NET     <font color="#000080">= </font><font color="#800000">$FFFF0000</font><font color="#000080">;
  </font>IN_CLASSB_NSHIFT  <font color="#000080">= </font><font color="#800000">16</font><font color="#000080">;
  </font>IN_CLASSB_HOST    <font color="#000080">= </font><font color="#800000">$0000FFFF</font><font color="#000080">;
  </font>IN_CLASSB_MAX     <font color="#000080">= </font><font color="#800000">65536</font><font color="#000080">;

  </font><font color="#008000"><i>{#define IN_CLASSC(i)  (((long)(i) &amp; 0xc0000000) == 0xc0000000) }
  </i></font>IN_CLASSC_NET     <font color="#000080">= </font><font color="#800000">$FFFFFF00</font><font color="#000080">;
  </font>IN_CLASSC_NSHIFT  <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;
  </font>IN_CLASSC_HOST    <font color="#000080">= </font><font color="#800000">$000000FF</font><font color="#000080">;

  </font>INADDR_ANY        <font color="#000080">= </font><font color="#800000">$00000000</font><font color="#000080">;
  </font>INADDR_LOOPBACK   <font color="#000080">= </font><font color="#800000">$7F000001</font><font color="#000080">;
  </font>INADDR_BROADCAST  <font color="#000080">= </font><font color="#800000">$FFFFFFFF</font><font color="#000080">;
  </font>INADDR_NONE       <font color="#000080">= </font><font color="#800000">$FFFFFFFF</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font><font color="#008000"><i>{ socket addresses, internet style }
  </i></font>sockaddr_in <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>sin_family <font color="#000080">: </font>Integer<font color="#000080">;
    </font>sin_port   <font color="#000080">: </font>u_short<font color="#000080">;
    </font>sin_addr   <font color="#000080">: </font>in_addr<font color="#000080">;
    </font>sin_zero   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char
  <font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>WSADESCRIPTION_LEN <font color="#000080">= </font><font color="#800000">256</font><font color="#000080">;
  </font>WSASYS_STATUS_LEN  <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>WSAData <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>wVersion        <font color="#000080">: </font>WORD<font color="#000080">;
    </font>wHighVersion    <font color="#000080">: </font>WORD<font color="#000080">;
    </font>szDescription   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>WSADESCRIPTION_LEN<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">;
    </font>szSystemStatus  <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>WSASYS_STATUS_LEN<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">;
    </font>iMaxSockets     <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{ unsigned short }
    </i></font>iMaxUdpDg       <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{ unsigned short }
    </i></font>lpVendorInfo    <font color="#000080">: </font>Pointer<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>LPWSADATA <font color="#000080">= ^</font>WSAData<font color="#000080">;

  </font><font color="#008000"><i>{ options for use with [gs]etsockopt at the IP level }
</i></font><font color="#FF0000"><b>CONST
  </b></font>IP_OPTIONS  <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;    </font><font color="#008000"><i>{ set/get IP per-packet options }

  { definitions related to sockets: types, address families, options }
  { taken from BSD sys/socket.h                                      }

  { this is used instead of -1, since the TSocket type is unsigned }
  </i></font>INVALID_SOCKET <font color="#000080">= </font><font color="#FF0000"><b>NOT</b></font><font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>SOCKET_ERROR   <font color="#000080">= -</font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#008000"><i>{ types }
  </i></font>SOCK_STREAM     <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;  </font><font color="#008000"><i>{ stream socket }
  </i></font>SOCK_DGRAM      <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;  </font><font color="#008000"><i>{ datagram socket }
  </i></font>SOCK_RAW        <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;  </font><font color="#008000"><i>{ raw-protocol service }
  </i></font>SOCK_RDM        <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;  </font><font color="#008000"><i>{ reliably-delivered message }
  </i></font>SOCK_SEQPACKET  <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;  </font><font color="#008000"><i>{ sequenced packet stream }

  { option flags per socket }
  </i></font>SO_DEBUG        <font color="#000080">= </font><font color="#800000">$0001</font><font color="#000080">;  </font><font color="#008000"><i>{ turn on debugging info recording }
  </i></font>SO_ACCEOTCONN   <font color="#000080">= </font><font color="#800000">$0002</font><font color="#000080">;  </font><font color="#008000"><i>{ socket has had listen() }
  </i></font>SO_REUSEADDR    <font color="#000080">= </font><font color="#800000">$0004</font><font color="#000080">;  </font><font color="#008000"><i>{ allow local address reuse }
  </i></font>SO_KEEPALIVE    <font color="#000080">= </font><font color="#800000">$0008</font><font color="#000080">;  </font><font color="#008000"><i>{ keep connections alive }
  </i></font>SO_DONTROUTE    <font color="#000080">= </font><font color="#800000">$0010</font><font color="#000080">;  </font><font color="#008000"><i>{ just use interface addresses }
  </i></font>SO_BROADCAST    <font color="#000080">= </font><font color="#800000">$0020</font><font color="#000080">;  </font><font color="#008000"><i>{ permit sending of broadcast messages }
  </i></font>SO_USELOOPBACK  <font color="#000080">= </font><font color="#800000">$0040</font><font color="#000080">;  </font><font color="#008000"><i>{ bypass hardware when possible }
  </i></font>SO_LINGER       <font color="#000080">= </font><font color="#800000">$0080</font><font color="#000080">;  </font><font color="#008000"><i>{ linger on close if data present }
  </i></font>SO_OOBINLINE    <font color="#000080">= </font><font color="#800000">$0100</font><font color="#000080">;  </font><font color="#008000"><i>{ leave received OOB data in line }
  </i></font>SO_DONTLINGER   <font color="#000080">= </font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>SO_LINGER<font color="#000080">);

  </font><font color="#008000"><i>{ additional options }
  </i></font>SO_SNDBUF       <font color="#000080">= </font><font color="#800000">$1001</font><font color="#000080">;  </font><font color="#008000"><i>{ send buffer size }
  </i></font>SO_RCVBUF       <font color="#000080">= </font><font color="#800000">$1002</font><font color="#000080">;  </font><font color="#008000"><i>{ receive buffer size }
  </i></font>SO_SNDLOWAT     <font color="#000080">= </font><font color="#800000">$1003</font><font color="#000080">;  </font><font color="#008000"><i>{ send low-water mark }
  </i></font>SO_RCVLOWAT     <font color="#000080">= </font><font color="#800000">$1004</font><font color="#000080">;  </font><font color="#008000"><i>{ receive low-water mark }
  </i></font>SO_SNDTIMEO     <font color="#000080">= </font><font color="#800000">$1005</font><font color="#000080">;  </font><font color="#008000"><i>{ send timeout }
  </i></font>SO_RCVTIMEO     <font color="#000080">= </font><font color="#800000">$1006</font><font color="#000080">;  </font><font color="#008000"><i>{ receive timeout }
  </i></font>SO_ERROR        <font color="#000080">= </font><font color="#800000">$1007</font><font color="#000080">;  </font><font color="#008000"><i>{ get error status and clear }
  </i></font>SO_TYPE         <font color="#000080">= </font><font color="#800000">$1008</font><font color="#000080">;  </font><font color="#008000"><i>{ get socket type }

  { TCP options }
  </i></font>TCP_NODELAY     <font color="#000080">= </font><font color="#800000">$0001</font><font color="#000080">;

  </font><font color="#008000"><i>{ address families }
  </i></font>AF_UNSPEC       <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;      </font><font color="#008000"><i>{ unspecified }
  </i></font>AF_UNIX         <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;      </font><font color="#008000"><i>{ local to host (pipes, portals) }
  </i></font>AF_INET         <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;      </font><font color="#008000"><i>{ internetwork: UDP, TCP etc }
  </i></font>AF_IMPLINK      <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;      </font><font color="#008000"><i>{ arpanet imp addresses }
  </i></font>AF_PUP          <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;      </font><font color="#008000"><i>{ pup protocols: eg. BSP }
  </i></font>AF_CHAOS        <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;      </font><font color="#008000"><i>{ mit CHAOS protocols }
  </i></font>AF_NS           <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;      </font><font color="#008000"><i>{ XEROX NS protocols }
  </i></font>AF_ISO          <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;      </font><font color="#008000"><i>{ ISO protocols }
  </i></font>AF_OSI          <font color="#000080">= </font>AF_ISO<font color="#000080">;
  </font>AF_ECMA         <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;      </font><font color="#008000"><i>{ european computer manufacturers }
  </i></font>AF_DATAKIT      <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">;      </font><font color="#008000"><i>{ datakit protocols }
  </i></font>AF_CCITT        <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;     </font><font color="#008000"><i>{ CCITT protocols, X.25 etc }
  </i></font>AF_SNA          <font color="#000080">= </font><font color="#800000">11</font><font color="#000080">;     </font><font color="#008000"><i>{ IBM SNA }
  </i></font>AF_DECnet       <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">;     </font><font color="#008000"><i>{ DECnet }
  </i></font>AF_DLI          <font color="#000080">= </font><font color="#800000">13</font><font color="#000080">;     </font><font color="#008000"><i>{ Direct data link interface }
  </i></font>AF_LAT          <font color="#000080">= </font><font color="#800000">14</font><font color="#000080">;     </font><font color="#008000"><i>{ LAT }
  </i></font>AF_HYLINK       <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;     </font><font color="#008000"><i>{ NSC Hyperchannel }
  </i></font>AF_APPLETALK    <font color="#000080">= </font><font color="#800000">16</font><font color="#000080">;     </font><font color="#008000"><i>{ AppleTalk }
  </i></font>AF_NETBIOS      <font color="#000080">= </font><font color="#800000">17</font><font color="#000080">;     </font><font color="#008000"><i>{ NetBios-style addresses }

  </i></font>AF_MAX          <font color="#000080">= </font><font color="#800000">18</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font><font color="#008000"><i>{ structure used by the kernel to store most addresses }
  </i></font>Psockaddr <font color="#000080">= ^</font>sockaddr<font color="#000080">;
  </font>sockaddr <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>sa_family <font color="#000080">: </font>u_short<font color="#000080">;              </font><font color="#008000"><i>{ address family }
    </i></font>sa_data   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">13</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">; </font><font color="#008000"><i>{ up to 14 bytes of direct address }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ structure used by the kernel to pass protocol }
  { information in raw sockets.                   }
  </i></font>sockproto <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>sp_family   <font color="#000080">: </font>u_short<font color="#000080">;  </font><font color="#008000"><i>{ address family }
    </i></font>sp_protocol <font color="#000080">: </font>u_short<font color="#000080">;  </font><font color="#008000"><i>{ protocol }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font><font color="#008000"><i>{ protocol families, same as address families for now }
  </i></font>PF_UNSPEC    <font color="#000080">= </font>AF_UNSPEC<font color="#000080">;
  </font>PF_UNIX      <font color="#000080">= </font>AF_UNIX<font color="#000080">;
  </font>PF_INET      <font color="#000080">= </font>AF_INET<font color="#000080">;
  </font>PF_IMPLINK   <font color="#000080">= </font>AF_IMPLINK<font color="#000080">;
  </font>PF_PUP       <font color="#000080">= </font>AF_PUP<font color="#000080">;
  </font>PF_CHAOS     <font color="#000080">= </font>AF_CHAOS<font color="#000080">;
  </font>PF_NS        <font color="#000080">= </font>AF_NS<font color="#000080">;
  </font>PF_ISO       <font color="#000080">= </font>AF_ISO<font color="#000080">;
  </font>PF_OSI       <font color="#000080">= </font>AF_OSI<font color="#000080">;
  </font>PF_ECMA      <font color="#000080">= </font>AF_ECMA<font color="#000080">;
  </font>PF_DATAKIT   <font color="#000080">= </font>AF_DATAKIT<font color="#000080">;
  </font>PF_CCITT     <font color="#000080">= </font>AF_CCITT<font color="#000080">;
  </font>PF_SNA       <font color="#000080">= </font>AF_SNA<font color="#000080">;
  </font>PF_DECnet    <font color="#000080">= </font>AF_DECnet<font color="#000080">;
  </font>PF_DLI       <font color="#000080">= </font>AF_DLI<font color="#000080">;
  </font>PF_LAT       <font color="#000080">= </font>AF_LAT<font color="#000080">;
  </font>PF_HYLINK    <font color="#000080">= </font>AF_HYLINK<font color="#000080">;
  </font>PF_APPLETALK <font color="#000080">= </font>AF_APPLETALK<font color="#000080">;
  </font>PF_MAX       <font color="#000080">= </font>AF_MAX<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font><font color="#008000"><i>{ structure used for manipulating linger option }
  </i></font>linger <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>l_onoff   <font color="#000080">: </font>u_short<font color="#000080">;  </font><font color="#008000"><i>{ option on/off }
    </i></font>l_linger  <font color="#000080">: </font>u_short<font color="#000080">;  </font><font color="#008000"><i>{ linger time }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font><font color="#008000"><i>{ level number for (get/set)sockopt() to apply to socket itself }
  </i></font>SOL_SOCKET  <font color="#000080">= </font><font color="#800000">$FFFF</font><font color="#000080">;    </font><font color="#008000"><i>{ OPTIONS FOR SOCKET LEVEL }

  { MAXIMUM QUEUE LENGTH SPECIFIABLE BY LISTEN }
  </i></font>SOMAXCONN   <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;

  </font>MSG_OOB       <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;      </font><font color="#008000"><i>{ process out-of-band packet }
  </i></font>MSG_PEEK      <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;      </font><font color="#008000"><i>{ peek at incoming messages }
  </i></font>MSG_DONTROUTE <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;      </font><font color="#008000"><i>{ send without using routing tables }
  </i></font>MSG_MAXIOVLEN <font color="#000080">= </font><font color="#800000">16</font><font color="#000080">;

  </font><font color="#008000"><i>{ define constant based on RFC883, used by gethostbyxxxx() calls }
  </i></font>MAXGETHOSTSTRUCT <font color="#000080">= </font><font color="#800000">1024</font><font color="#000080">;

  </font><font color="#008000"><i>{ define flags to be used with the WSAAsynchSelect() call }
  </i></font>FD_READ       <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">;
  </font>FD_WRITE      <font color="#000080">= </font><font color="#800000">$02</font><font color="#000080">;
  </font>FD_OOB        <font color="#000080">= </font><font color="#800000">$04</font><font color="#000080">;
  </font>FD_ACCEPT     <font color="#000080">= </font><font color="#800000">$08</font><font color="#000080">;
  </font>FD_CONNECT    <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">;
  </font>FD_CLOSE      <font color="#000080">= </font><font color="#800000">$20</font><font color="#000080">;

  </font><font color="#008000"><i>{ all windows sockets error constants are biased }
  { by WSABASEERR from the 'Normal'                }
  </i></font>WSABASEERR    <font color="#000080">= </font><font color="#800000">10000</font><font color="#000080">;
  </font>WSAEINTR      <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">;
  </font>WSAEBADF      <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">9</font><font color="#000080">;
  </font>WSAEACCES     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">13</font><font color="#000080">;
  </font>WSAEFAULT     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">14</font><font color="#000080">;
  </font>WSAEINVAL     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">22</font><font color="#000080">;
  </font>WSAEMFILE     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">24</font><font color="#000080">;

  </font><font color="#008000"><i>{ windows sockets definitions of regular berkeley error constants }
  </i></font>WSAEWOULDBLOCK      <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">35</font><font color="#000080">;
  </font>WSAEINPROGRESS      <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">36</font><font color="#000080">;
  </font>WSAEALREADY         <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">37</font><font color="#000080">;
  </font>WSAENOTSOCK         <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">38</font><font color="#000080">;
  </font>WSAEDESTADDRREQ     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">39</font><font color="#000080">;
  </font>WSAEMSGSIZE         <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">40</font><font color="#000080">;
  </font>WSAEPROTOTYPE       <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">41</font><font color="#000080">;
  </font>WSAENOPROTOOPT      <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">42</font><font color="#000080">;
  </font>WSAEPROTONOSUPPORT  <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">43</font><font color="#000080">;
  </font>WSAESOCKTNOSUPPORT  <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">44</font><font color="#000080">;
  </font>WSAEOPNOTSUPP       <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">45</font><font color="#000080">;
  </font>WSAEPFNOSUPPORT     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">46</font><font color="#000080">;
  </font>WSAEAFNOSUPPORT     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">47</font><font color="#000080">;
  </font>WSAEADDRINUSE       <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">48</font><font color="#000080">;
  </font>WSAEADDRNOTAVAIL    <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">49</font><font color="#000080">;
  </font>WSAENETDOWN         <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">50</font><font color="#000080">;
  </font>WSAENETUNREACH      <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">51</font><font color="#000080">;
  </font>WSAENETRESET        <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">52</font><font color="#000080">;
  </font>WSAECONNABORTED     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">53</font><font color="#000080">;
  </font>WSAECONNRESET       <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">54</font><font color="#000080">;
  </font>WSAENOBUFS          <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">55</font><font color="#000080">;
  </font>WSAEISCONN          <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">56</font><font color="#000080">;
  </font>WSAENOTCONN         <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">57</font><font color="#000080">;
  </font>WSAESHUTDOWN        <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">58</font><font color="#000080">;
  </font>WSAETOOMANYREFS     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">59</font><font color="#000080">;
  </font>WSAETIMEDOUT        <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">60</font><font color="#000080">;
  </font>WSAECONNREFUSED     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">61</font><font color="#000080">;
  </font>WSAELOOP            <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">62</font><font color="#000080">;
  </font>WSAENAMETOOLONG     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">63</font><font color="#000080">;
  </font>WSAEHOSTDOWN        <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">64</font><font color="#000080">;
  </font>WSAEHOSTUNREACH     <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">65</font><font color="#000080">;
  </font>WSAENOTEMPTY        <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">66</font><font color="#000080">;
  </font>WSAEPROCLIM         <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">67</font><font color="#000080">;
  </font>WSAEUSERS           <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">68</font><font color="#000080">;
  </font>WSAEDQUOT           <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">69</font><font color="#000080">;
  </font>WSAESTALE           <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">70</font><font color="#000080">;
  </font>WSAEREMOTE          <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">71</font><font color="#000080">;

  </font><font color="#008000"><i>{ extended windows sockets error constant definitions }
  </i></font>WSASYSNOTREADY      <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">91</font><font color="#000080">;
  </font>WSAVERNOTSUPPORTED  <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">92</font><font color="#000080">;
  </font>WSANOTINITIALISED   <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">93</font><font color="#000080">;

  </font><font color="#008000"><i>{ error return codes from gethostbyname() and gethostbyaddr() }
  { (when using the resolver). note that these errors are       }
  { retrieved via WSAGetLastError() and must therefore follow   }
  { the rules for avoiding clashes with error numbers from      }
  { specific implementations or language run-time systems. for  }
  { this reason the codes are based at WSABASEERR+1001. note    }
  { also that [WSA]NO_ADDRESS is defined only for compatibility }
  { purposes.                                                   }

{#define h_errno WSAGetLastError() }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>h_errno<font color="#000080">: </font>Longint<font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font><font color="#008000"><i>{ authoritative answer: host not found }
  </i></font>WSAHOST_NOT_FOUND <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">1001</font><font color="#000080">;
  </font>HOST_NOT_FOUND    <font color="#000080">= </font>WSAHOST_NOT_FOUND<font color="#000080">;

  </font><font color="#008000"><i>{ non-authoritative: host not found, or SERVERFAIL }
  </i></font>WSATRY_AGAIN      <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">1002</font><font color="#000080">;
  </font>TRY_AGAIN         <font color="#000080">= </font>WSATRY_AGAIN<font color="#000080">;

  </font><font color="#008000"><i>{ non-recoverable errors, FORMERR, REFUSED, NOTIMP }
  </i></font>WSANO_RECOVERY    <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">1003</font><font color="#000080">;
  </font>NO_RECOVERY       <font color="#000080">= </font>WSANO_RECOVERY<font color="#000080">;

  </font><font color="#008000"><i>{ valid name, no data record of requested type }
  </i></font>WSANO_DATA        <font color="#000080">= </font>WSABASEERR<font color="#000080">+</font><font color="#800000">1004</font><font color="#000080">;
  </font>NO_DATA           <font color="#000080">= </font>WSANO_DATA<font color="#000080">;

  </font><font color="#008000"><i>{ no address, look for MX record }
  </i></font>WSANO_ADDRESS     <font color="#000080">= </font>WSANO_DATA<font color="#000080">;
  </font>NO_ADDRESS        <font color="#000080">= </font>WSANO_ADDRESS<font color="#000080">;

  </font><font color="#008000"><i>{ windows sockets errors redefined as regular berkley error constants }
  </i></font>EWOULDBLOCK       <font color="#000080">= </font>WSAEWOULDBLOCK<font color="#000080">;
  </font>EINPROGRESS       <font color="#000080">= </font>WSAEINPROGRESS<font color="#000080">;
  </font>EALREADY          <font color="#000080">= </font>WSAEALREADY<font color="#000080">;
  </font>ENOTSOCK          <font color="#000080">= </font>WSAENOTSOCK<font color="#000080">;
  </font>EDESTADDRREQ      <font color="#000080">= </font>WSAEDESTADDRREQ<font color="#000080">;
  </font>EMSGSIZE          <font color="#000080">= </font>WSAEMSGSIZE<font color="#000080">;
  </font>EPROTOTYPE        <font color="#000080">= </font>WSAEPROTOTYPE<font color="#000080">;
  </font>ENOPROTOOPT       <font color="#000080">= </font>WSAENOPROTOOPT<font color="#000080">;
  </font>EPROTONOSUPPORT   <font color="#000080">= </font>WSAEPROTONOSUPPORT<font color="#000080">;
  </font>ESOCKTNOSUPPORT   <font color="#000080">= </font>WSAESOCKTNOSUPPORT<font color="#000080">;
  </font>EOPNOTSUPPORT     <font color="#000080">= </font>WSAEOPNOTSUPP<font color="#000080">;
  </font>EPFNOSUPPORT      <font color="#000080">= </font>WSAEPFNOSUPPORT<font color="#000080">;
  </font>EAFNOSUPPORT      <font color="#000080">= </font>WSAEAFNOSUPPORT<font color="#000080">;
  </font>EADDRINUSE        <font color="#000080">= </font>WSAEADDRINUSE<font color="#000080">;
  </font>EADDRNOTAVAIL     <font color="#000080">= </font>WSAEADDRNOTAVAIL<font color="#000080">;
  </font>ENETDOWN          <font color="#000080">= </font>WSAENETDOWN<font color="#000080">;
  </font>ENETUNREACH       <font color="#000080">= </font>WSAENETUNREACH<font color="#000080">;
  </font>ENETRESET         <font color="#000080">= </font>WSAENETRESET<font color="#000080">;
  </font>ECONNABORTED      <font color="#000080">= </font>WSAECONNABORTED<font color="#000080">;
  </font>ECONNRESET        <font color="#000080">= </font>WSAECONNRESET<font color="#000080">;
  </font>ENOBUFS           <font color="#000080">= </font>WSAENOBUFS<font color="#000080">;
  </font>EISCONNN          <font color="#000080">= </font>WSAEISCONN<font color="#000080">;
  </font>ENOTCONN          <font color="#000080">= </font>WSAENOTCONN<font color="#000080">;
  </font>ESHUTDOWN         <font color="#000080">= </font>WSAESHUTDOWN<font color="#000080">;
  </font>ETOOMANYREFS      <font color="#000080">= </font>WSAETOOMANYREFS<font color="#000080">;
  </font>ETIMEDOUT         <font color="#000080">= </font>WSAETIMEDOUT<font color="#000080">;
  </font>ECONNREFUSED      <font color="#000080">= </font>WSAECONNREFUSED<font color="#000080">;
  </font>ELOOP             <font color="#000080">= </font>WSAELOOP<font color="#000080">;
  </font>ENAMETOOLONG      <font color="#000080">= </font>WSAENAMETOOLONG<font color="#000080">;
  </font>EHOSTDOWN         <font color="#000080">= </font>WSAEHOSTDOWN<font color="#000080">;
  </font>EHOSTUNREACH      <font color="#000080">= </font>WSAEHOSTUNREACH<font color="#000080">;
  </font>ENOTEMPTY         <font color="#000080">= </font>WSAENOTEMPTY<font color="#000080">;
  </font>EPROCLIM          <font color="#000080">= </font>WSAEPROCLIM<font color="#000080">;
  </font>EUSERS            <font color="#000080">= </font>WSAEUSERS<font color="#000080">;
  </font>EDQUOT            <font color="#000080">= </font>WSAEDQUOT<font color="#000080">;
  </font>ESTALE            <font color="#000080">= </font>WSAESTALE<font color="#000080">;
  </font>EREMOTE           <font color="#000080">= </font>WSAEREMOTE<font color="#000080">;


</font><font color="#008000"><i>{ socket function prototypes }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>accept<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>addr <font color="#000080">: </font>sockaddr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>addrlen <font color="#000080">: </font>Integer<font color="#000080">):
</font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>bind<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#008000"><i>{const} </i></font><font color="#FF0000"><b>VAR </b></font>addr <font color="#000080">: </font>sockaddr<font color="#000080">; </font>namelen <font color="#000080">:
</font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>closesocket<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION
</b></font>connect<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#008000"><i>{const}</i></font><font color="#FF0000"><b>VAR </b></font>name <font color="#000080">: </font>sockaddr<font color="#000080">; </font>namelen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>ioctlsocket<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>cmd <font color="#000080">: </font>LONGINT<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>argp <font color="#000080">: </font>u_long<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>gethostname<font color="#000080">(</font>name <font color="#000080">: </font>PChar<font color="#000080">; </font>namelen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION
</b></font>getpeername<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>name <font color="#000080">: </font>sockaddr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>namelen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>getsockname<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>name <font color="#000080">: </font>sockaddr<font color="#000080">; </font>namelen <font color="#000080">: </font>Integer<font color="#000080">):
</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>getsockopt<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>name <font color="#000080">: </font>sockaddr<font color="#000080">; </font>namelen <font color="#000080">:
</font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>htonl<font color="#000080">(</font>hostlong <font color="#000080">: </font>u_long<font color="#000080">): </font>u_long<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION
</b></font>htons<font color="#000080">(</font>hostshort<font color="#000080">: </font>u_short<font color="#000080">): </font>u_short<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>inet_addr<font color="#000080">(</font><font color="#008000"><i>{const}</i></font>cp <font color="#000080">: </font>PChar<font color="#000080">):
</font>u_long<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>inet_ntoa<font color="#000080">(</font>in_ <font color="#000080">: </font>in_addr<font color="#000080">): </font>Char<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>listen<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">;
</font>backlog <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>ntohl<font color="#000080">(</font>netlong <font color="#000080">: </font>u_long<font color="#000080">): </font>u_long<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>ntohs<font color="#000080">(</font>netshort <font color="#000080">: </font>u_short<font color="#000080">): </font>u_short<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>recv<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>buf <font color="#000080">:
</font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>flags <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>recvfrom<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>buf <font color="#000080">:
</font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>flags <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>from <font color="#000080">: </font>sockaddr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>fromLen <font color="#000080">: </font>Integer<font color="#000080">):
</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>select<font color="#000080">(</font>nfds <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>readfds<font color="#000080">, </font>writefds<font color="#000080">, </font>exceptfds <font color="#000080">:
</font>Tfd_set<font color="#000080">; </font><font color="#008000"><i>{const}</i></font><font color="#FF0000"><b>VAR </b></font>timeout <font color="#000080">: </font>timeval<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>send<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">;
</font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>flags <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>sendto<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">;
</font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>flags <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{const}</i></font><font color="#FF0000"><b>VAR </b></font>to_ <font color="#000080">: </font>sockaddr<font color="#000080">; </font>tolen <font color="#000080">:
</font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>setsockopt<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>level<font color="#000080">, </font>optname <font color="#000080">: </font>Integer<font color="#000080">;
</font>optval <font color="#000080">: </font>Pointer<font color="#000080">; </font>optlen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>shutdown<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">;
</font>how <font color="#000080">: </font>integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>socket<font color="#000080">(</font>af<font color="#000080">, </font>typ<font color="#000080">, </font>protocol <font color="#000080">: </font>Integer<font color="#000080">):
</font>TSocket<font color="#000080">;
</font><font color="#008000"><i>{ database function prototypes }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>gethostbyaddr<font color="#000080">(</font><font color="#008000"><i>{const}</i></font>addr <font color="#000080">: </font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>typ <font color="#000080">: </font>Integer<font color="#000080">): </font>Phostent<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>gethostbyname<font color="#000080">(</font><font color="#008000"><i>{const}</i></font>name <font color="#000080">: </font>PChar<font color="#000080">): </font>Phostent<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>getservbyport<font color="#000080">(</font>port <font color="#000080">: </font>Integer<font color="#000080">; </font>proto <font color="#000080">: </font>Pointer<font color="#000080">): </font>Pservent<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>getservbyname<font color="#000080">(</font><font color="#008000"><i>{const}</i></font>name <font color="#000080">: </font>PChar<font color="#000080">; </font>proto <font color="#000080">: </font>PChar<font color="#008000"><i>{Pointer}</i></font><font color="#000080">): </font>Pservent<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>getprotobynumber<font color="#000080">(</font>proto <font color="#000080">: </font>Integer<font color="#000080">): </font>Pprotoent<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>getprotobyname<font color="#000080">(</font>name <font color="#000080">: </font>PChar<font color="#000080">): </font>Pprotoent<font color="#000080">;

</font><font color="#008000"><i>{ windows extension function prototypes }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>WSACleanup<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAStartup<font color="#000080">(</font>wVersionRequired <font color="#000080">: </font>Word<font color="#000080">; </font>lpwsaData_ <font color="#000080">: </font>LPWSADATA<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSASetLastError<font color="#000080">(</font>iError <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAGetLastError<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAIsBlocking<font color="#000080">: </font>WordBOOL<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAUnhookBlockingHook<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSASetBlockingHook<font color="#000080">(</font>lpBlockFunc <font color="#000080">: </font>TFARPROC<font color="#000080">): </font>TFARPROC<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSACancelBlockingCall<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncGetServByName<font color="#000080">(</font>hWnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>u_int<font color="#000080">;
         </font><font color="#008000"><i>{const} </i></font>name <font color="#000080">: </font>PChar<font color="#000080">; </font><font color="#008000"><i>{const} </i></font>proto <font color="#000080">: </font>Pointer<font color="#000080">;
         </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncGetServByPort<font color="#000080">(</font>hWnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>u_int<font color="#000080">; </font>port <font color="#000080">: </font>Integer<font color="#000080">;
         </font><font color="#008000"><i>{const} </i></font>proto <font color="#000080">: </font>Pointer<font color="#000080">; </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncGetProtoByName<font color="#000080">(</font>hWnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>u_int<font color="#000080">;
         </font><font color="#008000"><i>{const}</i></font>name <font color="#000080">: </font>PChar<font color="#000080">;
         </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncGetProtoByNumber<font color="#000080">(</font>hWnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>u_int<font color="#000080">;
         </font>number <font color="#000080">: </font>Integer<font color="#000080">; </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncGetHostByName<font color="#000080">(</font>hwnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>Integer<font color="#000080">; </font>name <font color="#000080">: </font>PChar<font color="#000080">;
         </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsynchGetHostByAddr<font color="#000080">(</font>hwnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>u_int<font color="#000080">;
         </font>addr <font color="#000080">: </font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>typ <font color="#000080">: </font>Integer<font color="#000080">;
         </font><font color="#008000"><i>{const}</i></font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSACancelAsyncRequest<font color="#000080">(</font>hAsyncTaskhandle <font color="#000080">: </font>THANDLE<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncSelect<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>hwnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wmsg <font color="#000080">: </font>u_int<font color="#000080">; </font>lEvent <font color="#000080">:
</font>Longint<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#008000"><i>{TYPE
  { windows extended data types }
  {xx not needed xx }

</i></font><font color="#FF0000"><b>implementation

PROCEDURE </b></font>FD_CLR<font color="#000080">(</font>fd <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>fdset <font color="#000080">: </font>Tfd_set<font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>q <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>q <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>WHILE  </b></font><font color="#000080">(</font>q <font color="#000080">&lt; </font>FD_SETSIZE<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>fdset<font color="#000080">.</font>fd_array<font color="#000080">[</font>q<font color="#000080">] &lt;&gt; </font>fd<font color="#000080">) </font><font color="#FF0000"><b>DO
    </b></font>Inc<font color="#000080">(</font>q<font color="#000080">);

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>fdset<font color="#000080">.</font>fd_array<font color="#000080">[</font>q<font color="#000080">] = </font>fd<font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    FOR </b></font>q <font color="#000080">:= </font>q <font color="#FF0000"><b>TO </b></font>fdset<font color="#000080">.</font>fd_count<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO
      </b></font>fdset<font color="#000080">.</font>fd_array<font color="#000080">[</font>q<font color="#000080">] := </font>fdset<font color="#000080">.</font>fd_array<font color="#000080">[</font>q<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
    </font>Dec<font color="#000080">(</font>fdset<font color="#000080">.</font>fd_count<font color="#000080">)
  </font><font color="#FF0000"><b>END
END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION  </b></font>FD_ISSET<font color="#000080">(</font>fd <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>fdset <font color="#000080">: </font>Tfd_set<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FD_ISSET <font color="#000080">:= </font>__WSAFDIsSet<font color="#000080">(</font>fd<font color="#000080">, </font>fdset<font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FD_SET<font color="#000080">(</font>fd <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>fdset <font color="#000080">: </font>Tfd_set<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>fdset<font color="#000080">.</font>fd_count <font color="#000080">&lt; </font>FD_SETSIZE<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font>Inc<font color="#000080">(</font>fdset<font color="#000080">.</font>fd_count<font color="#000080">);
    </font>fdset<font color="#000080">.</font>fd_array<font color="#000080">[</font>fdset<font color="#000080">.</font>fd_count<font color="#000080">] := </font>fd
  <font color="#FF0000"><b>END
END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FD_ZERO<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>fdset <font color="#000080">: </font>Tfd_set<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>fdset<font color="#000080">.</font>fd_count <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ operations on timevals }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>timercmp<font color="#000080">(</font>tvp<font color="#000080">, </font>uvp <font color="#000080">: </font>timeval<font color="#000080">; </font>cmp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ the original timercmp took a third parameter of the operator }
{ (was a 'c' macro. But, the original couldn't handle 2        }
{ character operators ('&gt;=' etc) so we're a bit better off.    }
</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>cmp <font color="#000080">= </font><font color="#800000">'&gt;'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font><font color="#008000"><i>{ greater than? }
    </i></font>timercmp <font color="#000080">:= (</font>tvp<font color="#000080">.</font>tv_sec <font color="#000080">&gt; </font>uvp<font color="#000080">.</font>tv_sec<font color="#000080">) </font><font color="#FF0000"><b>OR
                </b></font><font color="#000080">((</font>tvp<font color="#000080">.</font>tv_sec <font color="#000080">= </font>uvp<font color="#000080">.</font>tv_sec<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>tvp<font color="#000080">.</font>tv_usec <font color="#000080">&gt; </font>uvp<font color="#000080">.</font>tv_usec<font color="#000080">))
  </font><font color="#FF0000"><b>END
  ELSE IF </b></font><font color="#000080">(</font>cmp <font color="#000080">= </font><font color="#800000">'='</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font><font color="#008000"><i>{ equal ? }
    </i></font>timercmp <font color="#000080">:= (</font>tvp<font color="#000080">.</font>tv_sec <font color="#000080">= </font>uvp<font color="#000080">.</font>tv_sec<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>tvp<font color="#000080">.</font>tv_usec <font color="#000080">= </font>uvp<font color="#000080">.</font>tv_usec<font color="#000080">)
  </font><font color="#FF0000"><b>END
  ELSE IF </b></font><font color="#000080">(</font>cmp <font color="#000080">= </font><font color="#800000">'&lt;'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font><font color="#008000"><i>{ less than? }
    </i></font>timercmp <font color="#000080">:= (</font>tvp<font color="#000080">.</font>tv_sec <font color="#000080">&lt; </font>uvp<font color="#000080">.</font>tv_sec<font color="#000080">) </font><font color="#FF0000"><b>OR
                </b></font><font color="#000080">((</font>tvp<font color="#000080">.</font>tv_sec <font color="#000080">= </font>uvp<font color="#000080">.</font>tv_sec<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>tvp<font color="#000080">.</font>tv_usec <font color="#000080">&lt; </font>uvp<font color="#000080">.</font>tv_usec<font color="#000080">))
  </font><font color="#FF0000"><b>END
  ELSE IF </b></font><font color="#000080">(</font>cmp <font color="#000080">= </font><font color="#800000">'&gt;='</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>cmp <font color="#000080">= </font><font color="#800000">'=&gt;'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font><font color="#008000"><i>{ greater or equal? }
    </i></font>timercmp <font color="#000080">:= (</font>tvp<font color="#000080">.</font>tv_sec <font color="#000080">&gt;= </font>uvp<font color="#000080">.</font>tv_sec<font color="#000080">) </font><font color="#FF0000"><b>OR
                </b></font><font color="#000080">((</font>tvp<font color="#000080">.</font>tv_sec <font color="#000080">= </font>uvp<font color="#000080">.</font>tv_sec<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>tvp<font color="#000080">.</font>tv_usec <font color="#000080">&gt;= </font>uvp<font color="#000080">.</font>tv_usec<font color="#000080">))
  </font><font color="#FF0000"><b>END
  ELSE IF </b></font><font color="#000080">(</font>cmp <font color="#000080">= </font><font color="#800000">'&lt;='</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>cmp <font color="#000080">= </font><font color="#800000">'=&lt;'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font><font color="#008000"><i>{ less or equal? }
    </i></font>timercmp <font color="#000080">:= (</font>tvp<font color="#000080">.</font>tv_sec <font color="#000080">&lt;= </font>uvp<font color="#000080">.</font>tv_sec<font color="#000080">) </font><font color="#FF0000"><b>OR
                </b></font><font color="#000080">((</font>tvp<font color="#000080">.</font>tv_sec <font color="#000080">= </font>uvp<font color="#000080">.</font>tv_sec<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>tvp<font color="#000080">.</font>tv_usec <font color="#000080">&lt;= </font>uvp<font color="#000080">.</font>tv_usec<font color="#000080">))
  </font><font color="#FF0000"><b>END
  ELSE </b></font><font color="#008000"><i>{ error }
    </i></font>timercmp <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>timerisset<font color="#000080">(</font>tvp <font color="#000080">: </font>timeval<font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>timerisset <font color="#000080">:= </font>tvp<font color="#000080">.</font>tv_sec <font color="#FF0000"><b>OR </b></font>tvp<font color="#000080">.</font>tv_usec
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ commands for ioctlsocket() }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>_IO<font color="#000080">(</font>x<font color="#000080">, </font>y <font color="#000080">: </font>Byte<font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>_IO <font color="#000080">:= </font>IOC_VOID <font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>x <font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font>y
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>_IOR<font color="#000080">(</font>x <font color="#000080">: </font>Char<font color="#000080">; </font>y <font color="#000080">: </font>Byte<font color="#000080">; </font>tSize <font color="#000080">: </font>Integer<font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#008000"><i>{ original took a type as the third parameter, and }
{ used 'sizeof' to get size. (c macro)             }
</i></font><font color="#FF0000"><b>VAR
  </b></font>lRes<font color="#000080">, </font>lTemp <font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>lRes <font color="#000080">:= </font>IOC_OUT<font color="#000080">;
  </font>lTemp <font color="#000080">:= </font>tSize <font color="#FF0000"><b>AND </b></font>IOCPARM_MASK<font color="#000080">; </font>lRes <font color="#000080">:= </font>lRes <font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>lTemp <font color="#FF0000"><b>SHL </b></font><font color="#800000">16</font><font color="#000080">);
  </font>lTemp <font color="#000080">:= </font>Byte<font color="#000080">(</font>x<font color="#000080">); </font>lRes <font color="#000080">:= </font>lRes <font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>lTemp <font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">);
  </font>lRes <font color="#000080">:= </font>lRes <font color="#FF0000"><b>OR </b></font>y<font color="#000080">;
  </font><font color="#008000"><i>{_IOR := IOC_OUT OR ((tSize AND IOCPARM_MASK) SHL 16) OR (Byte(x) SHL 8) OR
y} </i></font>_IOR <font color="#000080">:= </font>lRes <font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>_IOW<font color="#000080">(</font>x <font color="#000080">: </font>Char<font color="#000080">; </font>y<font color="#000080">, </font>tSize <font color="#000080">: </font>Longint<font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#008000"><i>{ as above }
</i></font><font color="#FF0000"><b>VAR
  </b></font>lRes<font color="#000080">, </font>lTemp <font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font><font color="#008000"><i>{lRes := IOC_IN;
  lTemp := tSize AND IOCPARM_MASK;
  lRes := lRes OR (lTemp SHL 16);
  lTemp := Byte(x);
  lRes := lRes OR (lTemp SHL 8);
  lRes := lRes OR y;}

  </i></font>lRes <font color="#000080">:= </font>IOC_IN <font color="#FF0000"><b>OR </b></font><font color="#000080">((</font>tSize <font color="#FF0000"><b>AND </b></font>IOCPARM_MASK<font color="#000080">) </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Longint<font color="#000080">(</font>x<font color="#000080">) </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>OR
</b></font>y<font color="#000080">;
  </font><font color="#008000"><i>{_IOW := IOC_IN OR ((tSize AND IOCPARM_MASK) SHL 16) OR (Byte(x) SHL 8) OR
y}  </i></font>_IOW <font color="#000080">:= </font>lRes
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>FIONREAD<font color="#000080">: </font>Longint<font color="#000080">;     </font><font color="#008000"><i>{ get number of bytes to read }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>FIONREAD <font color="#000080">:= </font>_IOR<font color="#000080">(</font><font color="#800000">'f'</font><font color="#000080">, </font><font color="#800000">127</font><font color="#000080">, </font>Sizeof<font color="#000080">(</font>u_long<font color="#000080">))
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>FIONBIO<font color="#000080">: </font>Longint<font color="#000080">;      </font><font color="#008000"><i>{ set/clear non-blocking I/O }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>FIONBIO <font color="#000080">:= </font>_IOW<font color="#000080">(</font><font color="#800000">'f'</font><font color="#000080">, </font><font color="#800000">126</font><font color="#000080">, </font>Sizeof<font color="#000080">(</font>u_long<font color="#000080">))
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>FIOASYNC<font color="#000080">: </font>Longint<font color="#000080">;     </font><font color="#008000"><i>{ set/clear async I/O }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>FIOASYNC <font color="#000080">:= </font>_IOW<font color="#000080">(</font><font color="#800000">'f'</font><font color="#000080">, </font><font color="#800000">125</font><font color="#000080">, </font>Sizeof<font color="#000080">(</font>u_long<font color="#000080">))
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SIOCSHIWAT<font color="#000080">: </font>Longint<font color="#000080">;   </font><font color="#008000"><i>{set high watermark }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>SIOCSHIWAT <font color="#000080">:= </font>_IOW<font color="#000080">(</font><font color="#800000">'s'</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Sizeof<font color="#000080">(</font>u_long<font color="#000080">))
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SIOCGHIWAT<font color="#000080">: </font>Longint<font color="#000080">;   </font><font color="#008000"><i>{ get high watermark }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>SIOCGHIWAT <font color="#000080">:= </font>_IOR<font color="#000080">(</font><font color="#800000">'s'</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Sizeof<font color="#000080">(</font>u_long<font color="#000080">))
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SIOCSLOWAT<font color="#000080">: </font>Longint<font color="#000080">;   </font><font color="#008000"><i>{ set lo watermark }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>SIOCSLOWAT <font color="#000080">:= </font>_IOW<font color="#000080">(</font><font color="#800000">'s'</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font>Sizeof<font color="#000080">(</font>u_long<font color="#000080">))
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SIOCGLOWAT<font color="#000080">: </font>Longint<font color="#000080">;   </font><font color="#008000"><i>{ get lo watermark }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>SIOCGLOWAT <font color="#000080">:= </font>_IOR<font color="#000080">(</font><font color="#800000">'s'</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font>Sizeof<font color="#000080">(</font>u_long<font color="#000080">))
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SIOCATMARK<font color="#000080">: </font>Longint<font color="#000080">;   </font><font color="#008000"><i>{ at oob mark ? }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>SIOCATMARK <font color="#000080">:= </font>_IOR<font color="#000080">(</font><font color="#800000">'s'</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font>Sizeof<font color="#000080">(</font>u_long<font color="#000080">))
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>h_errno<font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#008000"><i>{#define h_errno WSAGetLastError() }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>h_errno <font color="#000080">:= </font>WSAGetLastError<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ winsock function prototypes }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>accept<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>addr <font color="#000080">: </font>sockaddr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>addrlen <font color="#000080">: </font>Integer<font color="#000080">):
</font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">1</font><font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>bind<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#008000"><i>{const} </i></font><font color="#FF0000"><b>VAR
</b></font>addr <font color="#000080">: </font>sockaddr<font color="#000080">; </font>namelen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>closesocket<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">3</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>connect<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#008000"><i>{const}</i></font><font color="#FF0000"><b>VAR </b></font>name <font color="#000080">: </font>sockaddr<font color="#000080">; </font>namelen <font color="#000080">: </font>Integer<font color="#000080">):
</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">4</font><font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>getpeername<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR
</b></font>name <font color="#000080">: </font>sockaddr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>namelen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">5</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>getsockname<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>name <font color="#000080">: </font>sockaddr<font color="#000080">; </font>namelen <font color="#000080">: </font>Integer<font color="#000080">):
</font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">6</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>getsockopt<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>name <font color="#000080">: </font>sockaddr<font color="#000080">; </font>namelen <font color="#000080">: </font>Integer<font color="#000080">):
</font>Integer<font color="#000080">;         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">7</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>htonl<font color="#000080">(</font>hostlong <font color="#000080">: </font>u_long<font color="#000080">): </font>u_long<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">8</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>htons<font color="#000080">(</font>hostshort<font color="#000080">: </font>u_short<font color="#000080">): </font>u_short<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">9</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>inet_addr<font color="#000080">(</font><font color="#008000"><i>{const}</i></font>cp <font color="#000080">: </font>PChar<font color="#000080">): </font>u_long<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">10</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>inet_ntoa<font color="#000080">(</font>in_ <font color="#000080">: </font>in_addr<font color="#000080">): </font>Char<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">11</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>ioctlsocket<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>cmd <font color="#000080">: </font>LONGINT<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>argp <font color="#000080">: </font>u_long<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">12</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>listen<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>backlog <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">13</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>ntohl<font color="#000080">(</font>netlong <font color="#000080">: </font>u_long<font color="#000080">): </font>u_long<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">14</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>ntohs<font color="#000080">(</font>netshort <font color="#000080">: </font>u_short<font color="#000080">): </font>u_short<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">15</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>recv<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>flags <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">16</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>recvfrom<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>flags <font color="#000080">: </font>Integer<font color="#000080">;
                  </font><font color="#FF0000"><b>VAR </b></font>from <font color="#000080">: </font>sockaddr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>fromLen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">17</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>select<font color="#000080">(</font>nfds <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>readfds<font color="#000080">, </font>writefds<font color="#000080">, </font>exceptfds <font color="#000080">: </font>Tfd_set<font color="#000080">;
                </font><font color="#008000"><i>{const}</i></font><font color="#FF0000"><b>VAR </b></font>timeout <font color="#000080">: </font>timeval<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">18</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>send<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>flags <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">19</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>sendto<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>flags <font color="#000080">: </font>Integer<font color="#000080">;
                </font><font color="#008000"><i>{const}</i></font><font color="#FF0000"><b>VAR </b></font>to_ <font color="#000080">: </font>sockaddr<font color="#000080">; </font>tolen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">20</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>setsockopt<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>level<font color="#000080">, </font>optname <font color="#000080">: </font>Integer<font color="#000080">;
                    </font>optval <font color="#000080">: </font>Pointer<font color="#000080">; </font>optlen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">21</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>shutdown<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>how <font color="#000080">: </font>integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">22</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>socket<font color="#000080">(</font>af<font color="#000080">, </font>typ<font color="#000080">, </font>protocol <font color="#000080">: </font>Integer<font color="#000080">): </font>TSocket<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">23</font><font color="#000080">;

</font><font color="#008000"><i>{ database function prototypes }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>gethostbyaddr<font color="#000080">(</font><font color="#008000"><i>{const}</i></font>addr <font color="#000080">: </font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>typ <font color="#000080">: </font>Integer<font color="#000080">): </font>Phostent<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">51</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>gethostbyname<font color="#000080">(</font><font color="#008000"><i>{const}</i></font>name <font color="#000080">: </font>PChar<font color="#000080">): </font>Phostent<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">52</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>getprotobyname<font color="#000080">(</font>name <font color="#000080">: </font>PChar<font color="#000080">): </font>Pprotoent<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">53</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>getprotobynumber<font color="#000080">(</font>proto <font color="#000080">: </font>Integer<font color="#000080">): </font>Pprotoent<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">54</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>getservbyname<font color="#000080">(</font><font color="#008000"><i>{const}</i></font>name <font color="#000080">: </font>PChar<font color="#000080">; </font>proto <font color="#000080">: </font>PChar<font color="#008000"><i>{Pointer}</i></font><font color="#000080">): </font>Pservent<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">55</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>getservbyport<font color="#000080">(</font>port <font color="#000080">: </font>Integer<font color="#000080">; </font>proto <font color="#000080">: </font>Pointer<font color="#000080">): </font>Pservent<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">56</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>gethostname<font color="#000080">(</font>name <font color="#000080">: </font>PChar<font color="#000080">; </font>namelen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">57</font><font color="#000080">;

</font><font color="#008000"><i>{ windows extension function prototypes }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncSelect<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font>hwnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wmsg <font color="#000080">: </font>u_int<font color="#000080">; </font>lEvent <font color="#000080">:
</font>Longint<font color="#000080">): </font>Integer<font color="#000080">;         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">101</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsynchGetHostByAddr<font color="#000080">(</font>hwnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>u_int<font color="#000080">;
         </font>addr <font color="#000080">: </font>Pointer<font color="#000080">; </font>len<font color="#000080">, </font>typ <font color="#000080">: </font>Integer<font color="#000080">;
         </font><font color="#008000"><i>{const}</i></font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">102</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncGetHostByName<font color="#000080">(</font>hwnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>Integer<font color="#000080">; </font>name <font color="#000080">: </font>PChar<font color="#000080">;
         </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">103</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncGetProtoByNumber<font color="#000080">(</font>hWnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>u_int<font color="#000080">;
         </font>number <font color="#000080">: </font>Integer<font color="#000080">; </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">104</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncGetProtoByName<font color="#000080">(</font>hWnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>u_int<font color="#000080">;
         </font><font color="#008000"><i>{const}</i></font>name <font color="#000080">: </font>PChar<font color="#000080">;
         </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">105</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncGetServByPort<font color="#000080">(</font>hWnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>u_int<font color="#000080">; </font>port <font color="#000080">: </font>Integer<font color="#000080">;
         </font><font color="#008000"><i>{const} </i></font>proto <font color="#000080">: </font>Pointer<font color="#000080">; </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">106</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAAsyncGetServByName<font color="#000080">(</font>hWnd_ <font color="#000080">: </font>HWND<font color="#000080">; </font>wMsg <font color="#000080">: </font>u_int<font color="#000080">;
         </font><font color="#008000"><i>{const} </i></font>name <font color="#000080">: </font>PChar<font color="#000080">; </font><font color="#008000"><i>{const} </i></font>proto <font color="#000080">: </font>Pointer<font color="#000080">;
         </font>buf <font color="#000080">: </font>Pointer<font color="#000080">; </font>buflen <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">107</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSACancelAsyncRequest<font color="#000080">(</font>hAsyncTaskhandle <font color="#000080">: </font>THANDLE<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">108</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSASetBlockingHook<font color="#000080">(</font>lpBlockFunc <font color="#000080">: </font>TFARPROC<font color="#000080">): </font>TFARPROC<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">109</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAUnhookBlockingHook<font color="#000080">: </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">110</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAGetLastError<font color="#000080">: </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">111</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSASetLastError<font color="#000080">(</font>iError <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">112</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSACancelBlockingCall<font color="#000080">: </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">113</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAIsBlocking<font color="#000080">: </font>WordBOOL<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">114</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSAStartup<font color="#000080">(</font>wVersionRequired <font color="#000080">: </font>Word<font color="#000080">; </font>lpwsaData_ <font color="#000080">: </font>LPWSADATA<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">115</font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WSACleanup<font color="#000080">: </font>integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">116</font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>__WSAFDIsSet<font color="#000080">(</font>s <font color="#000080">: </font>TSocket<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>fds <font color="#000080">: </font>Tfd_set<font color="#000080">): </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WINSOCK' </font>index <font color="#800000">151</font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0082.PAS">Original</a><b>]</b></p></body>
</html>
