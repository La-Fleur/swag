<html>
<head><title> "Printer Controls" by ANDREW J. COOK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0023.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{************************************************}
{                                                }
{   AJC Printer Unit for Windows                 }
{                                                }
{   Printer control constants/functions          }
{                                                }
{   Author:  Andrew J. Cook                      }
{            Omaha, NE                           }
{            CompuServe ID:  71331,501           }
{                                                }
{   Written: January 1994                        }
{                                                }
{   Copyright:  None!  I hereby commit this unit }
{                      to the public domain.     }
{                                                }
{************************************************}

{************************************************}
{                                                }
{  New SetPageSize function added and changed    }
{  margin code in SetPrintParams function.       }
{                                                }
{  Modified by:                                  }
{               Paul Mayer                       }
{               ZPAY Payroll Systems, Inc.       }
{               St. Petersburg,  FL              }
{               CompuServe ID: 76711,1141        }
{                                                }
{  Thanks to Kurt Barthelmess Borland Team B for }
{  pointing out what I was doing wrong so I      }
{  could get this function to work after a week  }
{  of trial and error and a lot of test paper!   }
{                                                }
{                                 April 1994     }
{                                                }
{************************************************}

</i></font><font color="#FF0000"><b>unit </b></font>AJCPrntW<font color="#000080">;

</font><font color="#008000"><i>{$F+,O+,S-}

</i></font><font color="#FF0000"><b>interface

uses </b></font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>OPrinter<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>PAJCPrinter <font color="#000080">= ^</font>TAJCPrinter<font color="#000080">;
  </font>TAJCPrinter <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TPrinter<font color="#000080">)
    </font><font color="#FF0000"><b>function </b></font>SetPageOrientation<font color="#000080">(</font>Orientation<font color="#000080">:  </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>SetPageSize<font color="#000080">(</font>PageID<font color="#000080">, </font>NewLength<font color="#000080">, </font>NewWidth <font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>pm_Size <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>pm_Print <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>PAJCPrintOut <font color="#000080">= ^</font>TAJCPrintOut<font color="#000080">;
  </font>TAJCPrintOut <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TPrintOut<font color="#000080">)
    </font>VUnitsPerInch<font color="#000080">:  </font>Integer<font color="#000080">;
    </font>HUnitsPerInch<font color="#000080">:  </font>Integer<font color="#000080">;
    </font>LMarginUnits<font color="#000080">:  </font>Integer<font color="#000080">;
    </font>TMarginUnits<font color="#000080">:  </font>Integer<font color="#000080">;
    </font>RMarginUnits<font color="#000080">:  </font>Integer<font color="#000080">;
    </font>BMarginUnits<font color="#000080">:  </font>Integer<font color="#000080">;
    </font>OriginalAlignmentOptions<font color="#000080">:  </font>Word<font color="#000080">;
    </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font>ATitle<font color="#000080">:  </font>PChar<font color="#000080">);
    </font><font color="#FF0000"><b>destructor </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetPrintParams<font color="#000080">(</font>ADC<font color="#000080">: </font>HDC<font color="#000080">; </font>ASize<font color="#000080">: </font>TPoint<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>VLogPos<font color="#000080">(</font>Pos<font color="#000080">:  </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>HLogPos<font color="#000080">(</font>Pos<font color="#000080">:  </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>VInches<font color="#000080">(</font>Inches<font color="#000080">: </font>Real<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>HInches<font color="#000080">(</font>Inches<font color="#000080">: </font>Real<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>Points<font color="#000080">(</font>APoints<font color="#000080">:  </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>PrintHeader<font color="#000080">(</font>Mode<font color="#000080">, </font>Page<font color="#000080">:  </font>Word<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>PrintFooter<font color="#000080">(</font>Mode<font color="#000080">, </font>Page<font color="#000080">:  </font>Word<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>JustifyLeft<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>JustifyCenter<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>JustifyRight<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>DevModeOut<font color="#000080">, </font>DevModeIn <font color="#000080">: </font>PDevMode<font color="#000080">;

</font><font color="#FF0000"><b>implementation

function </b></font>TAJCPrinter<font color="#000080">.</font>SetPageOrientation<font color="#000080">(</font>Orientation<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>DevMode<font color="#000080">:  </font>PDevMode<font color="#000080">;
  </font>Result<font color="#000080">:  </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SetPageOrientation <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Orientation <font color="#000080">&lt;&gt; </font>dmOrient_Portrait<font color="#000080">) </font><font color="#FF0000"><b>and
     </b></font><font color="#000080">(</font>Orientation <font color="#000080">&lt;&gt; </font>dmOrient_Landscape<font color="#000080">) </font><font color="#FF0000"><b>then
       </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">@</font>ExtDeviceMode <font color="#000080">= </font><font color="#FF0000"><b>nil then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>DevSettings<font color="#000080">^.</font>dmFields <font color="#FF0000"><b>or </b></font>dm_Orientation <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>DevSettings<font color="#000080">^.</font>dmOrientation <font color="#000080">= </font>Orientation <font color="#FF0000"><b>then
    begin
      </b></font>SetPageOrientation <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>GetMem<font color="#000080">(</font>DevMode<font color="#000080">, </font>DevSettingSize<font color="#000080">);
  </font>Move<font color="#000080">(</font>DevSettings<font color="#000080">^, </font>DevMode<font color="#000080">^, </font>DevSettingSize<font color="#000080">);
  </font>DevMode<font color="#000080">^.</font>dmOrientation <font color="#000080">:= </font>Orientation<font color="#000080">;
  </font>Result <font color="#000080">:= </font>ExtDeviceMode<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>DeviceModule<font color="#000080">, </font>DevSettings<font color="#000080">^, </font>Device<font color="#000080">, </font>Port<font color="#000080">,
                          </font>DevMode<font color="#000080">^, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>dm_In_Buffer <font color="#FF0000"><b>or </b></font>dm_Out_Buffer<font color="#000080">);
  </font>FreeMem<font color="#000080">(</font>DevMode<font color="#000080">, </font>DevSettingSize<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Result <font color="#000080">= </font>IDOK <font color="#FF0000"><b>then
    </b></font>SetPageOrientation <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TAJCPrinter<font color="#000080">.</font>SetPageSize<font color="#000080">(</font>PageID<font color="#000080">, </font>NewLength<font color="#000080">, </font>NewWidth <font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>DevModeIn<font color="#000080">:  </font>PDevMode<font color="#000080">;
  </font>Result<font color="#000080">:  </font>Integer<font color="#000080">;
  </font>Size <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SetPageSize <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">@</font>ExtDeviceMode <font color="#000080">= </font><font color="#FF0000"><b>nil then </b></font>exit<font color="#000080">;
  </font>GetMem<font color="#000080">(</font>DevModeIn<font color="#000080">, </font>DevSettingSize<font color="#000080">);
  </font>Result <font color="#000080">:= </font>ExtDeviceMode<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>DeviceModule<font color="#000080">, </font>DevSettings<font color="#000080">^, </font>Device<font color="#000080">, </font>Port<font color="#000080">,
                          </font>DevModeIn<font color="#000080">^, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>dm_Out_Buffer<font color="#000080">);
  </font>DevModeIn<font color="#000080">^.</font>dmDeviceName <font color="#000080">:= </font>DevSettings<font color="#000080">^.</font>dmDeviceName<font color="#000080">;
  </font>DevModeIn<font color="#000080">^.</font>dmSpecVersion <font color="#000080">:= </font>DevSettings<font color="#000080">^.</font>dmSpecVersion<font color="#000080">;
  </font>DevModeIn<font color="#000080">^.</font>dmDriverVersion <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>DevModeIn<font color="#000080">^.</font>dmFields <font color="#000080">:= </font>dm_PaperSize <font color="#FF0000"><b>or </b></font>dm_Paperlength <font color="#FF0000"><b>or </b></font>dm_PaperWidth<font color="#000080">;
  </font>DevModeIn<font color="#000080">^.</font>dmPaperSize <font color="#000080">:= </font>PageId <font color="#008000"><i>{eg dmPaper_User, dmPaper_Letter}</i></font><font color="#000080">;
  </font>DevModeIn<font color="#000080">^.</font>dmPaperLength <font color="#000080">:= </font>NewLength<font color="#000080">; </font><font color="#008000"><i>{in 1/10 of millimeters}
  </i></font>DevModeIn<font color="#000080">^.</font>dmPaperWidth <font color="#000080">:= </font>NewWidth <font color="#008000"><i>{in 1/10 of millimeters}</i></font><font color="#000080">;
  </font>Result <font color="#000080">:= </font>ExtDeviceMode<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>DeviceModule<font color="#000080">, </font>DevSettings<font color="#000080">^, </font>Device<font color="#000080">, </font>Port<font color="#000080">,
                          </font>DevModeIn<font color="#000080">^, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>dm_In_Buffer <font color="#FF0000"><b>or </b></font>dm_Out_Buffer<font color="#000080">);
  </font>FreeMem<font color="#000080">(</font>DevModeIn<font color="#000080">, </font>DevModeIn<font color="#000080">^.</font>dmSize <font color="#000080">+ </font>DevModeIn<font color="#000080">^.</font>dmDriverExtra<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Result <font color="#000080">= </font>IDOK <font color="#FF0000"><b>then
    </b></font>SetPageSize <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TAJCPrintOut<font color="#000080">.</font>Init<font color="#000080">(</font>ATitle<font color="#000080">:  </font>PChar<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>Init<font color="#000080">(</font>ATitle<font color="#000080">);
  </font>OriginalAlignmentOptions <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>TAJCPrintOut<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>OriginalAlignmentOptions <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>SetTextAlign<font color="#000080">(</font>DC<font color="#000080">, </font>OriginalAlignmentOptions<font color="#000080">);

  </font><font color="#FF0000"><b>inherited </b></font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAJCPrintOut<font color="#000080">.</font>SetPrintParams<font color="#000080">(</font>ADC<font color="#000080">: </font>HDC<font color="#000080">; </font>ASize<font color="#000080">: </font>TPoint<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>lpOffset<font color="#000080">, </font>lpDimensions <font color="#000080">: </font>TPoint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>SetPrintParams<font color="#000080">(</font>ADC<font color="#000080">, </font>ASize<font color="#000080">);

  </font>OriginalAlignmentOptions <font color="#000080">:= </font>GetTextAlign<font color="#000080">(</font>DC<font color="#000080">);

  </font>VUnitsPerInch <font color="#000080">:= </font>GetDeviceCaps<font color="#000080">(</font>DC<font color="#000080">, </font>LogPixelsY<font color="#000080">);
  </font>HUnitsPerInch <font color="#000080">:= </font>GetDeviceCaps<font color="#000080">(</font>DC<font color="#000080">, </font>LogPixelsX<font color="#000080">);

  </font>Escape<font color="#000080">(</font>DC<font color="#000080">, </font>GetPhysPageSize<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, @</font>lpDimensions<font color="#000080">);
  </font>Escape<font color="#000080">(</font>DC<font color="#000080">, </font>GetPrintingOffset<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, @</font>lpOffset<font color="#000080">);

  </font>TMarginUnits <font color="#000080">:= </font>lpOffset<font color="#000080">.</font>Y<font color="#000080">;
  </font>LMarginUnits <font color="#000080">:= </font>lpOffset<font color="#000080">.</font>X<font color="#000080">;
  </font>BMarginUnits <font color="#000080">:= (</font>lpDimensions<font color="#000080">.</font>Y <font color="#000080">- (</font>Size<font color="#000080">.</font>Y<font color="#000080">+</font>lpOffset<font color="#000080">.</font>Y<font color="#000080">));
  </font>RMarginUnits <font color="#000080">:= (</font>lpDimensions<font color="#000080">.</font>X <font color="#000080">- (</font>Size<font color="#000080">.</font>X<font color="#000080">+</font>lpOffset<font color="#000080">.</font>X<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TAJCPrintOut<font color="#000080">.</font>VLogPos<font color="#000080">(</font>Pos<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Pos <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>VLogPos <font color="#000080">:= </font>Size<font color="#000080">.</font>Y <font color="#000080">+ </font>Pos <font color="#000080">+ </font>TMarginUnits
  <font color="#FF0000"><b>else
    </b></font>VLogPos <font color="#000080">:= </font>Pos <font color="#000080">- </font>TMarginUnits<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>TAJCPrintOut<font color="#000080">.</font>HLogPos<font color="#000080">(</font>Pos<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Pos <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>HLogPos <font color="#000080">:= </font>Size<font color="#000080">.</font>X <font color="#000080">+ </font>Pos <font color="#000080">+ </font>LMarginUnits
  <font color="#FF0000"><b>else
    </b></font>HLogPos <font color="#000080">:= </font>Pos <font color="#000080">- </font>LMarginUnits<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TAJCPrintOut<font color="#000080">.</font>VInches<font color="#000080">(</font>Inches<font color="#000080">: </font>Real<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>VInches <font color="#000080">:= </font>round<font color="#000080">(</font>Inches <font color="#000080">* </font>VUnitsPerInch<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TAJCPrintOut<font color="#000080">.</font>HInches<font color="#000080">(</font>Inches<font color="#000080">: </font>Real<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>HInches <font color="#000080">:= </font>round<font color="#000080">(</font>Inches <font color="#000080">* </font>HUnitsPerInch<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TAJCPrintOut<font color="#000080">.</font>Points<font color="#000080">(</font>APoints<font color="#000080">:  </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Points <font color="#000080">:= </font>APoints <font color="#000080">* (</font>VUnitsPerInch<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">72</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TAJCPrintOut<font color="#000080">.</font>PrintHeader<font color="#000080">(</font>Mode<font color="#000080">, </font>Page<font color="#000080">:  </font>Word<font color="#000080">):  </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>PrintHeader <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TAJCPrintOut<font color="#000080">.</font>PrintFooter<font color="#000080">(</font>Mode<font color="#000080">, </font>Page<font color="#000080">:  </font>Word<font color="#000080">):  </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>PrintFooter <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAJCPrintOut<font color="#000080">.</font>JustifyLeft<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>AlignmentOptions<font color="#000080">:  </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>AlignmentOptions <font color="#000080">:= </font>GetTextAlign<font color="#000080">(</font>DC<font color="#000080">);
  </font>AlignmentOptions <font color="#000080">:= </font>AlignmentOptions <font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>ta_left <font color="#FF0000"><b>or </b></font>ta_center <font color="#FF0000"><b>or </b></font>ta_right<font color="#000080">);
  </font>AlignmentOptions <font color="#000080">:= </font>AlignmentOptions <font color="#FF0000"><b>or </b></font>ta_left<font color="#000080">;
  </font>SetTextAlign<font color="#000080">(</font>DC<font color="#000080">, </font>AlignmentOptions<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAJCPrintOut<font color="#000080">.</font>JustifyCenter<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>AlignmentOptions<font color="#000080">:  </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>AlignmentOptions <font color="#000080">:= </font>GetTextAlign<font color="#000080">(</font>DC<font color="#000080">);
  </font>AlignmentOptions <font color="#000080">:= </font>AlignmentOptions <font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>ta_left <font color="#FF0000"><b>or </b></font>ta_center <font color="#FF0000"><b>or </b></font>ta_right<font color="#000080">);
  </font>AlignmentOptions <font color="#000080">:= </font>AlignmentOptions <font color="#FF0000"><b>or </b></font>ta_center<font color="#000080">;
  </font>SetTextAlign<font color="#000080">(</font>DC<font color="#000080">, </font>AlignmentOptions<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAJCPrintOut<font color="#000080">.</font>JustifyRight<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>AlignmentOptions<font color="#000080">:  </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>AlignmentOptions <font color="#000080">:= </font>GetTextAlign<font color="#000080">(</font>DC<font color="#000080">);
  </font>AlignmentOptions <font color="#000080">:= </font>AlignmentOptions <font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>ta_left <font color="#FF0000"><b>or </b></font>ta_center <font color="#FF0000"><b>or </b></font>ta_right<font color="#000080">);
  </font>AlignmentOptions <font color="#000080">:= </font>AlignmentOptions <font color="#FF0000"><b>or </b></font>ta_right<font color="#000080">;
  </font>SetTextAlign<font color="#000080">(</font>DC<font color="#000080">, </font>AlignmentOptions<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0023.PAS">Original</a><b>]</b></p></body>
</html>
