<html>
<head><title> "Dynamic Menus" by UNKNOWN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0090.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>MenuAdd<font color="#000080">;
</font><font color="#008000"><i>{
 provided as is, no guarantees, no support

 Question 1: My_ByPosition locates items by position from
             the top of the menu, mf_ByCommand finds an
             idem uses the items id.

 Question 2: These commands start a new column, the one
             separated by a bar the other not separated
             by a bar. If you are not in a PopUpMenu then
             it places the item on a new line.


}

</i></font><font color="#FF0000"><b>Uses
  </b></font>WinProcs<font color="#000080">,
  </font>WinTypes<font color="#000080">,
  </font>OWindows<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>cmEnable     <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;
  </font>cmColor      <font color="#000080">= </font><font color="#800000">102</font><font color="#000080">;
  </font>cmBlackWhite <font color="#000080">= </font><font color="#800000">103</font><font color="#000080">;
  </font>cmAddCommand <font color="#000080">= </font><font color="#800000">104</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>PMyWindow <font color="#000080">= ^</font>TMyWindow<font color="#000080">;
  </font>TMyWindow <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TWindow<font color="#000080">)
      </font>mh<font color="#000080">: </font>HMenu<font color="#000080">;
    </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font>AParent<font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>AName<font color="#000080">: </font>PChar<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Enable<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>cm_First <font color="#000080">+ </font>cmEnable<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Color<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>cm_First <font color="#000080">+ </font>cmColor<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>BlackWhite<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>cm_First <font color="#000080">+ </font>cmBlackWhite<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>AddCommand<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>cm_First <font color="#000080">+ </font>cmAddCommand<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetUpWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>WMLButtonDown<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>wm_First <font color="#000080">+ </font>wm_LButtonDown<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>TMyApp <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>InitMainWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TMyWindow<font color="#000080">.</font>Init<font color="#000080">(</font>AParent<font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>AName<font color="#000080">: </font>PChar<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>TWindow<font color="#000080">.</font>Init<font color="#000080">(</font>AParent<font color="#000080">, </font>AName<font color="#000080">);
  </font>Attr<font color="#000080">.</font>Menu <font color="#000080">:= </font>CreateMenu<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TMyWindow<font color="#000080">.</font>SetUpWindow<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>TWindow<font color="#000080">.</font>SetUpWindow<font color="#000080">;
  </font>mh <font color="#000080">:= </font>CreatePopUpMenu<font color="#000080">;
  </font>AppendMenu<font color="#000080">(</font>Attr<font color="#000080">.</font>Menu<font color="#000080">, </font>mf_PopUp<font color="#000080">, </font>Mh<font color="#000080">, </font><font color="#800000">'&amp;Commands'</font><font color="#000080">);
  </font>AppendMenu<font color="#000080">(</font>Mh<font color="#000080">, </font>mf_String<font color="#000080">, </font>cmEnable<font color="#000080">, </font><font color="#800000">'&amp;Enable Options'</font><font color="#000080">);
  </font>AppendMenu<font color="#000080">(</font>Mh<font color="#000080">, </font>mf_Separator<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">);
  </font>AppendMenu<font color="#000080">(</font>Mh<font color="#000080">, </font>mf_String<font color="#000080">, </font>cmColor<font color="#000080">, </font><font color="#800000">'&amp;Color'</font><font color="#000080">);
  </font>AppendMenu<font color="#000080">(</font>Mh<font color="#000080">, </font>mf_String<font color="#000080">, </font>cmBlackWhite<font color="#000080">, </font><font color="#800000">'&amp;Black/White'</font><font color="#000080">);
  </font>AppendMenu<font color="#000080">(</font>Mh<font color="#000080">, </font>mf_Separator<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">);
  </font>AppendMenu<font color="#000080">(</font>Mh<font color="#000080">, </font>mf_String<font color="#000080">, </font>cmAddCommand<font color="#000080">, </font><font color="#800000">'Add Command'</font><font color="#000080">);
  </font>EnableMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font>mf_ByPosition <font color="#FF0000"><b>or </b></font>mf_Grayed<font color="#000080">);
  </font>EnableMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font>mf_ByPosition <font color="#FF0000"><b>or </b></font>mf_Grayed<font color="#000080">);
  </font>EnableMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font>mf_ByPosition <font color="#FF0000"><b>or </b></font>mf_Grayed<font color="#000080">);
  </font>DrawMenuBar<font color="#000080">(</font>HWindow<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyWindow<font color="#000080">.</font>WMLButtonDown<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>MessageBeep<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>HiLiteMenuItem<font color="#000080">(</font>HWindow<font color="#000080">, </font>Attr<font color="#000080">.</font>Menu<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>mf_ByPosition <font color="#FF0000"><b>or </b></font>mf_HiLite<font color="#000080">);

  </font>SetFocus<font color="#000080">(</font>Attr<font color="#000080">.</font>Menu<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyWindow<font color="#000080">.</font>Enable<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>EnableMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font>mf_ByPosition <font color="#FF0000"><b>or </b></font>mf_Enabled<font color="#000080">);
  </font>EnableMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font>mf_ByPosition <font color="#FF0000"><b>or </b></font>mf_Enabled<font color="#000080">);
  </font>EnableMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font>mf_ByPosition <font color="#FF0000"><b>or </b></font>mf_Enabled<font color="#000080">);
  </font>DeleteMenu<font color="#000080">(</font>Mh<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>mf_ByPosition<font color="#000080">);
  </font>DeleteMenu<font color="#000080">(</font>Mh<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>mf_ByPosition<font color="#000080">);
  </font>CheckMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font>cmColor<font color="#000080">, </font>mf_ByCommand <font color="#FF0000"><b>or </b></font>mf_Checked<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyWindow<font color="#000080">.</font>Color<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>State<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>State <font color="#000080">:= </font>GetMenuState<font color="#000080">(</font>Mh<font color="#000080">, </font>cmColor<font color="#000080">, </font>mf_ByCommand<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>State <font color="#FF0000"><b>and </b></font>mf_Checked<font color="#000080">) = </font>mf_Checked <font color="#FF0000"><b>then
    </b></font>CheckMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font>cmColor<font color="#000080">, </font>mf_ByCommand <font color="#FF0000"><b>or </b></font>mf_UnChecked<font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>CheckMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font>cmColor<font color="#000080">, </font>mf_ByCommand <font color="#FF0000"><b>or </b></font>mf_Checked<font color="#000080">);

  </font>State <font color="#000080">:= </font>GetMenuState<font color="#000080">(</font>Mh<font color="#000080">, </font>cmBlackWhite<font color="#000080">, </font>mf_ByCommand<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>State <font color="#FF0000"><b>and </b></font>mf_Checked<font color="#000080">) = </font>mf_Checked <font color="#FF0000"><b>then
    </b></font>CheckMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font>cmBlackWhite<font color="#000080">, </font>mf_ByCommand <font color="#FF0000"><b>or </b></font>mf_UnChecked<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyWindow<font color="#000080">.</font>BlackWhite<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>State<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>State <font color="#000080">:= </font>GetMenuState<font color="#000080">(</font>Mh<font color="#000080">, </font>cmBlackWhite<font color="#000080">, </font>mf_ByCommand<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>State <font color="#FF0000"><b>and </b></font>mf_Checked<font color="#000080">) = </font>mf_Checked <font color="#FF0000"><b>then
    </b></font>CheckMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font>cmBlackWhite<font color="#000080">, </font>mf_ByCommand <font color="#FF0000"><b>or </b></font>mf_UnChecked<font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>CheckMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font>cmBlackWhite<font color="#000080">, </font>mf_ByCommand <font color="#FF0000"><b>or </b></font>mf_Checked<font color="#000080">);

  </font>State <font color="#000080">:= </font>GetMenuState<font color="#000080">(</font>Mh<font color="#000080">, </font>cmColor<font color="#000080">, </font>mf_ByCommand<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>State <font color="#FF0000"><b>and </b></font>mf_Checked<font color="#000080">) = </font>mf_Checked <font color="#FF0000"><b>then
    </b></font>CheckMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font>cmColor<font color="#000080">, </font>mf_ByCommand <font color="#FF0000"><b>or </b></font>mf_UnChecked<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyWindow<font color="#000080">.</font>AddCommand<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>InsertMenu<font color="#000080">(</font>Mh<font color="#000080">, </font>cmColor<font color="#000080">, </font>mf_String<font color="#000080">, </font>cmEnable<font color="#000080">, </font><font color="#800000">'&amp;Enable Options'</font><font color="#000080">);
  </font>InsertMenu<font color="#000080">(</font>Mh<font color="#000080">, </font>cmColor<font color="#000080">, </font>mf_Separator<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">);
  </font>EnableMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font>mf_ByPosition <font color="#FF0000"><b>or </b></font>mf_Grayed<font color="#000080">);
  </font>EnableMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font>mf_ByPosition <font color="#FF0000"><b>or </b></font>mf_Grayed<font color="#000080">);
  </font>EnableMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font>mf_ByPosition <font color="#FF0000"><b>or </b></font>mf_Grayed<font color="#000080">);
  </font>CheckMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font>cmColor<font color="#000080">, </font>mf_ByCommand <font color="#FF0000"><b>or </b></font>mf_UnChecked<font color="#000080">);
  </font>CheckMenuItem<font color="#000080">(</font>Mh<font color="#000080">, </font>cmBlackWhite<font color="#000080">, </font>mf_ByCommand <font color="#FF0000"><b>or </b></font>mf_UnChecked<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyApp<font color="#000080">.</font>InitMainWindow<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MainWindow <font color="#000080">:= </font>New<font color="#000080">(</font>PMyWindow<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#800000">'MenuAdd'</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>A<font color="#000080">: </font>TMyApp<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>A<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#800000">'Ph2SecA'</font><font color="#000080">);
  </font>A<font color="#000080">.</font>Run<font color="#000080">;
  </font>A<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0090.PAS">Original</a><b>]</b></p></body>
</html>
