<html>
<head><title> "Windows Delay" by WIM VAN DER VEGT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0040.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here a small BPW source which implements a Delay(ms : Word); just like
in the DOS version. Limitations are that only a minimum delay is
guaranteed, so timing is not exact. This is due to the task switching
nature of windows which makes it impossible to generate accurate delays.
For large values it's however quite good.

The timer used has msec accuracy and has overflow every 49 days (if
windows lasts that long in one session.
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Winprocs<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Delay<font color="#000080">(</font>ms <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>theend<font color="#000080">,
  </font>marker  <font color="#000080">: </font>Longint<font color="#000080">;

</font><font color="#FF0000"><b>Begin
</b></font><font color="#008000"><i>{----Potential overflow if windows runs for 49 days without a stop}
  </i></font>marker<font color="#000080">:=</font>GetTickCount<font color="#000080">;
</font><font color="#008000"><i>{$R-}
  </i></font>theend<font color="#000080">:=</font>Longint<font color="#000080">(</font>marker<font color="#000080">+</font>ms<font color="#000080">);
</font><font color="#008000"><i>{$R+}
{----First see if timer overrun will occur and wait for it. Then test as
usual}
  </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>theend<font color="#000080">&lt;</font>marker<font color="#000080">)
    </font><font color="#FF0000"><b>Then While </b></font><font color="#000080">(</font>GetTickCount<font color="#000080">&gt;=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>theend<font color="#000080">&gt;</font>GettickCount<font color="#000080">) </font><font color="#FF0000"><b>Do</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{of Delay}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0040.PAS">Original</a><b>]</b></p></body>
</html>
