<html>
<head><title> "WinG Pascal Import Unit" by BOB SWART</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0064.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: bobs@dragons.nest.nl (Bob Swart)

&gt; For what it's worth, I took a look at it and determined that it is
&gt; not useful for Pascal.  One of the main reasons was that the DLL
&gt; used the C calling convention.

Well, I hate to disagree with you, but it can be done. In fact, it has been
done. Mike Scott has written an interface unit, which is included below. The
unit can also be downloaded from CompuServe (BPASCAL forum) and will be
included on the disk with The Pascal Magazine #5 which includes some articles
on using WinG from Borland Pascal.

Anyway, here's the import unit from Mike (I think a newer version will be on
The Pascal Magazine disk):

{*******************************************************}
{                                                       }
{       WinG Import Unit for Borland Pascal             }
{                                                       }
{       Written by Mike Scott, CIS 100140,2420          }
{       Preliminary version 9th July 1994               }
{                                                       }
{*******************************************************}

</i></font><font color="#FF0000"><b>unit </b></font>WinG <font color="#000080">;

</font><font color="#FF0000"><b>interface

uses </b></font>WinTypes <font color="#000080">;

</font><font color="#008000"><i>{ WinG Types }

</i></font><font color="#FF0000"><b>type
  </b></font>PPointer <font color="#000080">= ^</font>pointer <font color="#000080">;
  </font>PRGBQuad <font color="#000080">= ^</font>TRGBQuad <font color="#000080">;
  </font>WING_DITHER_TYPE <font color="#000080">= </font>word <font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>WING_DISPERSED_4x4 <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">;
  </font>WING_DISPERSED_8x8 <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">;
  </font>WING_CLUSTERED_4x4 <font color="#000080">= </font><font color="#800000">2 </font><font color="#000080">;

</font><font color="#008000"><i>{ WinG DC's &amp; WinG Bitmaps }

</i></font><font color="#FF0000"><b>function  </b></font>WinGCreateDC <font color="#000080">: </font>HDC <font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGCreateBitmap<font color="#000080">( </font>hWinGDC <font color="#000080">: </font>HDC <font color="#000080">;
                            </font>pHeader <font color="#000080">: </font>PBitmapInfo <font color="#000080">;
                            </font>ppBits  <font color="#000080">: </font>PPointer <font color="#000080">) : </font>HBitmap <font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGGetDIBPointer<font color="#000080">( </font>hWinGBitmap <font color="#000080">: </font>HBitmap <font color="#000080">;
                             </font>pHeader     <font color="#000080">: </font>PBitmapInfo <font color="#000080">) : </font>pointer <font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGRecommendDIBFormat<font color="#000080">( </font>pHeader <font color="#000080">: </font>PBitmapInfo <font color="#000080">) : </font>Bool <font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGGetDIBColorTable<font color="#000080">( </font>hWinGDC         <font color="#000080">: </font>HDC <font color="#000080">;
                                </font>StartIndex      <font color="#000080">: </font>word <font color="#000080">;
                                </font>NumberOfEntries <font color="#000080">: </font>word <font color="#000080">;
                                </font>pColors         <font color="#000080">: </font>PRGBQuad <font color="#000080">) : </font>word <font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGSetDIBColorTable<font color="#000080">( </font>hWinGDC         <font color="#000080">: </font>HDC <font color="#000080">;
                                </font>StartIndex      <font color="#000080">: </font>word <font color="#000080">;
                                </font>NumberOfEntries <font color="#000080">: </font>word <font color="#000080">;
                                </font>pColors         <font color="#000080">: </font>PRGBQuad <font color="#000080">) : </font>word <font color="#000080">;

</font><font color="#008000"><i>{ Blts }

</i></font><font color="#FF0000"><b>function  </b></font>WinGBitBlt<font color="#000080">( </font>hdcDest      <font color="#000080">: </font>HDC <font color="#000080">;
                      </font>nXOriginDest <font color="#000080">: </font>integer <font color="#000080">;
                      </font>nYOriginDest <font color="#000080">: </font>integer <font color="#000080">;
                      </font>nWidthDest   <font color="#000080">: </font>integer <font color="#000080">;
                      </font>nHeightDest  <font color="#000080">: </font>integer <font color="#000080">;
                      </font>hdcSrc       <font color="#000080">: </font>HDC <font color="#000080">;
                      </font>nXOriginSrc  <font color="#000080">: </font>integer <font color="#000080">;
                      </font>nYOriginSrc  <font color="#000080">: </font>integer <font color="#000080">) : </font>Bool <font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGStretchBlt<font color="#000080">( </font>hdcDest      <font color="#000080">: </font>HDC <font color="#000080">;
                          </font>nXOriginDest <font color="#000080">: </font>integer <font color="#000080">;
                          </font>nYOriginDest <font color="#000080">: </font>integer <font color="#000080">;
                          </font>nWidthDest   <font color="#000080">: </font>integer <font color="#000080">;
                          </font>nHeightDest  <font color="#000080">: </font>integer <font color="#000080">;
                          </font>hdcSrc       <font color="#000080">: </font>HDC <font color="#000080">;
                          </font>nXOriginSrc  <font color="#000080">: </font>integer <font color="#000080">;
                          </font>nYOriginSrc  <font color="#000080">: </font>integer <font color="#000080">;
                          </font>nWidthSrc    <font color="#000080">: </font>integer <font color="#000080">;
                          </font>nHeightSrc   <font color="#000080">: </font>integer <font color="#000080">) : </font>Bool <font color="#000080">;

</font><font color="#008000"><i>{ Halftoning }

</i></font><font color="#FF0000"><b>function  </b></font>WinGCreateHalftoneBrush<font color="#000080">( </font>DC         <font color="#000080">: </font>HDC <font color="#000080">;
                                   </font>Color      <font color="#000080">: </font>TColorRef <font color="#000080">;
                                   </font>DitherType <font color="#000080">: </font>WING_DITHER_TYPE <font color="#000080">) : </font>HBrush <font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGCreateHalftonePalette <font color="#000080">: </font>HPalette <font color="#000080">;


</font><font color="#FF0000"><b>implementation

function  </b></font>WinGCreateDC <font color="#000080">;              </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WinG' </font>index <font color="#800000">1001 </font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGCreateBitmap <font color="#000080">;          </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WinG' </font>index <font color="#800000">1003 </font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGGetDIBPointer <font color="#000080">;         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WinG' </font>index <font color="#800000">1004 </font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGRecommendDIBFormat <font color="#000080">;    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WinG' </font>index <font color="#800000">1002 </font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGGetDIBColorTable <font color="#000080">;      </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WinG' </font>index <font color="#800000">1005 </font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGSetDIBColorTable <font color="#000080">;      </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WinG' </font>index <font color="#800000">1006 </font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGBitBlt <font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WinG' </font>index <font color="#800000">1010 </font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGStretchBlt <font color="#000080">;            </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WinG' </font>index <font color="#800000">1009 </font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGCreateHalftoneBrush <font color="#000080">;   </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WinG' </font>index <font color="#800000">1008 </font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>WinGCreateHalftonePalette <font color="#000080">; </font><font color="#FF0000"><b>external </b></font><font color="#800000">'WinG' </font>index <font color="#800000">1007 </font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0064.PAS">Original</a><b>]</b></p></body>
</html>
