<html>
<head><title> "Bitmap Startup" by THOMAS WEIDNER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I 've seen a lot of question here arround, how to
display a bitmap befor starting a program in Windows.
Well, this program shows a bitmap without opening a window.
I 'll send you this program for borland pascal.
(Those who use TPW will have to change the USES declaration)

**************************************************************
* Bitmap befor starting the program without opening a window *
**************************************************************
}

</i></font><font color="#FF0000"><b>PROGRAM </b></font>Sample<font color="#000080">;

</font><font color="#FF0000"><b>USES </b></font>Wintypes<font color="#000080">, </font>Winprocs<font color="#000080">, </font>WinCrt<font color="#000080">, </font>Objects<font color="#000080">, </font>OWindows<font color="#000080">, </font>ODialogs<font color="#000080">;

</font><font color="#008000"><i>{$R BITMAP.RES }

</i></font><font color="#FF0000"><b>TYPE

  </b></font>PClipWin <font color="#000080">= ^</font>TClipWin<font color="#000080">;
  </font>TClipWin <font color="#000080">= </font><font color="#FF0000"><b>OBJECT </b></font><font color="#000080">(</font>TWindow<font color="#000080">)
    </font><font color="#FF0000"><b>Constructor </b></font>Init <font color="#000080">(</font>AParent <font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>ATitle <font color="#000080">: </font>PChar<font color="#000080">;
                      </font>AMenu <font color="#000080">: </font>HMenu<font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>GetWindowClass <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>AWndClass <font color="#000080">: </font>TWndClass<font color="#000080">); </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Function  </b></font>GetClassName <font color="#000080">: </font>PChar<font color="#000080">; </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>TClipApp <font color="#000080">= </font><font color="#FF0000"><b>OBJECT </b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>Procedure </b></font>InitMainWindow<font color="#000080">; </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ *** TClipWin *** }

</i></font><font color="#FF0000"><b>Constructor </b></font>TClipWin<font color="#000080">.</font>Init <font color="#000080">(</font>AParent <font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>ATitle <font color="#000080">: </font>PChar<font color="#000080">;
                           </font>AMenu <font color="#000080">: </font>HMenu<font color="#000080">);
</font><font color="#008000"><i>{ ** The main window in this example is a fixed window
     which cannot be resized or moved                   ** }
</i></font><font color="#FF0000"><b>BEGIN
  Inherited </b></font>Init <font color="#000080">(</font>AParent<font color="#000080">, </font>ATitle<font color="#000080">);
</font><font color="#008000"><i>{ ** The sample main window will be open over the whole screen ** }
  </i></font>Attr<font color="#000080">.</font>X <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
  </font>Attr<font color="#000080">.</font>Y <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
  </font>Attr<font color="#000080">.</font>W <font color="#000080">:= </font>GetSystemMetrics <font color="#000080">(</font>sm_CxScreen<font color="#000080">) + </font><font color="#800000">3</font><font color="#000080">;
  </font>Attr<font color="#000080">.</font>H <font color="#000080">:= </font>GetSystemMetrics <font color="#000080">(</font>sm_CyScreen<font color="#000080">) + </font><font color="#800000">3</font><font color="#000080">;
  </font>Attr<font color="#000080">.</font>Style <font color="#000080">:= </font>WS_SYSMENU <font color="#FF0000"><b>OR </b></font>WS_MINIMIZEBOX <font color="#FF0000"><b>OR </b></font>WS_MAXIMIZE<font color="#000080">;
</font><font color="#008000"><i>{ ** The menu must be defined in the resource ** }
  </i></font>Attr<font color="#000080">.</font>Menu <font color="#000080">:= </font>AMenu<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TClipWin<font color="#000080">.</font>GetWindowClass <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>AWndClass <font color="#000080">: </font>TWndClass<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  Inherited </b></font>GetWindowClass <font color="#000080">(</font>AWndClass<font color="#000080">);
</font><font color="#008000"><i>{ ** Also the icon of the program must be defined in the resource ** }
  </i></font>AWndClass<font color="#000080">.</font>HIcon <font color="#000080">:= </font>LoadIcon <font color="#000080">(</font>HInstance<font color="#000080">, </font><font color="#800000">'MAINICON'</font><font color="#000080">);
</font><font color="#008000"><i>{ ** This gray background is a standard which is not heavy colored ** }
  </i></font>AWndClass<font color="#000080">.</font>HBrBackGround <font color="#000080">:= </font>CreateSolidBrush <font color="#000080">(</font>RGB <font color="#000080">(</font><font color="#800000">128</font><font color="#000080">, </font><font color="#800000">128</font><font color="#000080">, </font><font color="#800000">128</font><font color="#000080">));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TClipWin<font color="#000080">.</font>GetClassName <font color="#000080">: </font>PChar<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>GetClassName <font color="#000080">:= </font><font color="#800000">'Bitmap Sample'</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TClipWin<font color="#000080">.</font>SetupWindow<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  Inherited </b></font>SetupWindow<font color="#000080">;
</font><font color="#008000"><i>{ ** DeleteMenu kills the menu point 'MOVE / RESIZE'. The windows can
     now not be resized or moved. It is fixed                        ** }
  </i></font>DeleteMenu <font color="#000080">(</font>GetSystemMenu<font color="#000080">(</font>HWindow<font color="#000080">, </font>FALSE<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">, </font>MF_BYPOSITION<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ *** TClipApp *** }

</i></font><font color="#FF0000"><b>Procedure </b></font>TClipApp<font color="#000080">.</font>InitMainWindow<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>CmdShow <font color="#000080">:= </font>SW_SHOWMAXIMIZED<font color="#000080">;
  </font>MainWindow <font color="#000080">:= </font>New<font color="#000080">(</font>PClipWin<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">, </font><font color="#800000">'Bitmap Sample Window'</font><font color="#000080">,
                    </font>LoadMenu <font color="#000080">(</font>HInstance<font color="#000080">, </font><font color="#800000">'MAINMENU'</font><font color="#000080">)));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>ClipApp <font color="#000080">: </font>TClipApp<font color="#000080">;
  </font>DC<font color="#000080">, </font>MemDC <font color="#000080">: </font>hDC<font color="#000080">;
  </font>Bitmap<font color="#000080">, </font>OldBitmap <font color="#000080">: </font>HBitmap<font color="#000080">;
  </font>BM <font color="#000080">: </font>TBitmap<font color="#000080">;
  </font>Rect <font color="#000080">: </font>TRect<font color="#000080">;
  </font>H<font color="#000080">, </font>W <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Ticks <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{ ** !! DISPLAY THe BITMAP BEFOR APPLICATION.INIT !! ** }

{ ** Create the display context ** }
  </i></font>DC <font color="#000080">:= </font>CreateDC<font color="#000080">(</font><font color="#800000">'DISPLAY'</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
</font><font color="#008000"><i>{ ** Load the bitmap stored in the resource ** }
  </i></font>Bitmap <font color="#000080">:= </font>LoadBitmap<font color="#000080">(</font>HInstance<font color="#000080">, </font>MakeIntResource<font color="#000080">(</font><font color="#800000">'STARTBITMAP'</font><font color="#000080">));
</font><font color="#008000"><i>{ ** Memory context compatibel to the display context ** }
  </i></font>MemDC <font color="#000080">:= </font>CreateCompatibleDC<font color="#000080">(</font>DC<font color="#000080">);
</font><font color="#008000"><i>{ ** Save the actual context ** }
  </i></font>OldBitmap <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>MemDC<font color="#000080">, </font>Bitmap<font color="#000080">);
</font><font color="#008000"><i>{ ** Get the bitmap ** }
  </i></font>GetObject <font color="#000080">(</font>Bitmap<font color="#000080">, </font>SizeOf<font color="#000080">(</font>BM<font color="#000080">),@</font>BM<font color="#000080">);
</font><font color="#008000"><i>{ ** Get height and width of the screen ** }
  </i></font>H <font color="#000080">:= </font>GetSystemMetrics <font color="#000080">(</font>sm_CyScreen<font color="#000080">);
  </font>W <font color="#000080">:= </font>GetSystemMetrics <font color="#000080">(</font>sm_CxScreen<font color="#000080">);
</font><font color="#008000"><i>{ ** Copy the resource bitmap into the memory context and move it
     exactly in the middle of the screen !!                    ** }
  </i></font>BitBlt <font color="#000080">(</font>DC<font color="#000080">,</font>W <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">-(</font>BM<font color="#000080">.</font>bmWidth <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">), </font>H <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">-(</font>BM<font color="#000080">.</font>bmHeight <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">),
          </font>BM<font color="#000080">.</font>bmWidth<font color="#000080">, </font>BM<font color="#000080">.</font>bmHeight<font color="#000080">, </font>MemDC<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>SRCCopy<font color="#000080">);
</font><font color="#008000"><i>{ ** Holds the system for 5 seconds, to study the bitmap.
     5000 = milliseconds ** }
  </i></font>Ticks <font color="#000080">:= </font>GetTickCount<font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
  Until </b></font>ABS <font color="#000080">(</font>Ticks <font color="#000080">- </font>GetTickCount<font color="#000080">) &gt; </font><font color="#800000">5000</font><font color="#000080">;
</font><font color="#008000"><i>{ ** Remove all bitmaps and contexts ** }
  </i></font>DeleteObject <font color="#000080">(</font>SelectObject <font color="#000080">(</font>MemDC<font color="#000080">, </font>OldBitmap<font color="#000080">));
  </font>DeleteDC <font color="#000080">(</font>MemDC<font color="#000080">);
  </font>DeleteDC <font color="#000080">(</font>DC<font color="#000080">);
</font><font color="#008000"><i>{ ** Now start the main window ** }
  </i></font>ClipApp<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#800000">'Bitmap Sample Window'</font><font color="#000080">);
  </font>ClipApp<font color="#000080">.</font>Run<font color="#000080">;
  </font>ClipApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

----------------------- </font>CUT IT <font color="#000080">-- </font>CUT IT <font color="#000080">-----------------------------

</font>This example will show the resource bitmap befor the main window<font color="#000080">,
</font>without opening an other window<font color="#000080">. </font>I made this <font color="#FF0000"><b>program as </b></font>easy <font color="#FF0000"><b>as
</b></font>possible<font color="#000080">. </font>The palette <font color="#FF0000"><b>is not </b></font>included<font color="#000080">, </font>but a <font color="#800000">256 </font>colored palette will
be added <font color="#000080">(</font>selectpalette <font color="#000080">- </font>realizepalette<font color="#000080">) </font>without difficulties<font color="#000080">.
</font>Ofcourse a normal bitmap <font color="#000080">(</font>HDD<font color="#000080">) </font>could also be used instead <font color="#FF0000"><b>of </b></font>the
resource bitmap

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p></body>
</html>
