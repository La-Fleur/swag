<html>
<head><title> "Only ONE copy of EXE" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0068.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>

<font color="#008000"><i>(* This is a program that should ensure only 1 copy of a dos program *)
(* will be able to run under windows.                                *)
(* There are 2 options                                               *)
(* - = add a startup directory                                       *)
(* @ = Look for an alternate window title                            *)
(* you may look at the help below                                    *)

{$I-}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Strings<font color="#000080">,
  </font>WinProcs<font color="#000080">,
  </font>WinTypes<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>ExeError<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">21</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>PChar <font color="#000080">=
  (</font><font color="#800000">'System was out of memory, executable file was corrupt, or relocations were invalid.'</font><font color="#000080">+
   </font><font color="#800000">'  or you may be trying to run a com file without adding .com'#13'Example - EDIT.COM'</font><font color="#000080">,
   </font><font color="#800000">''</font><font color="#000080">,
   </font><font color="#800000">'File was not found.'</font><font color="#000080">,
   </font><font color="#800000">'Path was not found.'</font><font color="#000080">,
   </font><font color="#800000">''</font><font color="#000080">,
   </font><font color="#800000">'Attempt was made to dynamically link to a task, or there was a sharing or network-protection error.'</font><font color="#000080">,
   </font><font color="#800000">'Library required separate data segments for each task.'</font><font color="#000080">,
   </font><font color="#800000">''</font><font color="#000080">,
   </font><font color="#800000">'There was insufficient memory to start the application.'</font><font color="#000080">,
   </font><font color="#800000">''</font><font color="#000080">,
   </font><font color="#800000">'Windows version was incorrect.'</font><font color="#000080">,
   </font><font color="#800000">'Executable file was invalid. Either it was not a Windows application or there was an error in the .EXE image.'</font><font color="#000080">,
   </font><font color="#800000">'Application was designed for a different operating system.'</font><font color="#000080">,
   </font><font color="#800000">'Application was designed for MS-DOS 4.0.'</font><font color="#000080">,
   </font><font color="#800000">'Type of executable file was unknown.'</font><font color="#000080">,
   </font><font color="#800000">'Attempt was made to load a real-mode application (developed for an earlier version of Windows).'</font><font color="#000080">,
   </font><font color="#800000">'Attempt was made to load a second instance of an executable file containing multiple data segments that were '</font><font color="#000080">+
   </font><font color="#800000">'not marked read-only.'</font><font color="#000080">,
   </font><font color="#800000">''</font><font color="#000080">,
   </font><font color="#800000">''</font><font color="#000080">,
   </font><font color="#800000">'Attempt was made to load a compressed executable file. The file must be decompressed before it can be loaded.'</font><font color="#000080">,
   </font><font color="#800000">'Dynamic-link library (DLL) file was invalid. One of the DLLs required to run this application was corrupt.'</font><font color="#000080">,
   </font><font color="#800000">'Application requires 32-bit extensions.'</font><font color="#000080">);


</font><font color="#FF0000"><b>Const
  </b></font>DosError<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>PChar <font color="#000080">=
  (</font><font color="#800000">'File not found'</font><font color="#000080">,</font><font color="#800000">'Path not found'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">'Access denied'</font><font color="#000080">,</font><font color="#800000">'Invalid handle'</font><font color="#000080">,
   </font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">'Not enough memory'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">'Invalid environment'</font><font color="#000080">,</font><font color="#800000">'Invalid format'</font><font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>Path       <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;      </font><font color="#008000"><i>(* Path and program name of program to run - from the command line *)
  </i></font>StartupDir <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;      </font><font color="#008000"><i>(* Directory information removed from the above *)
  </i></font>WindowTitle <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];  </font><font color="#008000"><i>(* Name of the DOS window - appears in the title bar *)


</i></font><font color="#FF0000"><b>Function </b></font>Trim<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  While </b></font>Copy<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">' ' </font><font color="#FF0000"><b>Do
    </b></font>Delete<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>Trim <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetToken<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>Marker<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>P <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>P <font color="#000080">:= </font>Pos<font color="#000080">(</font>Marker<font color="#000080">,</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>P <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>P <font color="#000080">:= </font>Length<font color="#000080">(</font>S<font color="#000080">);
  </font>GetToken <font color="#000080">:= </font>Copy<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>P<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
  </font>Delete<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>P<font color="#000080">);
  </font>S <font color="#000080">:= </font>Trim<font color="#000080">(</font>S<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DispParams<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Msg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Msg <font color="#000080">:= </font><font color="#800000">'Path        :'</font><font color="#000080">+</font>Path<font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">+
         </font><font color="#800000">'Start Dir   :'</font><font color="#000080">+</font>StartupDir<font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">+
         </font><font color="#800000">'WindowTitle :'</font><font color="#000080">+</font>WindowTitle<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>pos<font color="#000080">(</font><font color="#800000">#0</font><font color="#000080">,</font>Msg<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Do
    </b></font>Delete<font color="#000080">(</font>Msg<font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">#0</font><font color="#000080">,</font>Msg<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
  </font>Msg <font color="#000080">:= </font>Msg <font color="#000080">+</font><font color="#800000">#0</font><font color="#000080">;

  </font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,@</font>Msg<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">'Program Start Information'</font><font color="#000080">,</font>mb_OK<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SayErrorHalt<font color="#000080">(</font>Msg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>Msg <font color="#000080">:= </font>Msg<font color="#000080">+</font><font color="#800000">#0</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,@</font>Msg<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">'Program Start Error'</font><font color="#000080">,</font>mb_OKCancel<font color="#000080">) = </font>id_OK <font color="#FF0000"><b>then
    </b></font>DispParams<font color="#000080">;
  </font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SayDOSErrorHalt<font color="#000080">(</font>Err<font color="#000080">: </font>Integer<font color="#000080">;</font>Msg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>ErrStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];  </font><font color="#008000"><i>(* Used when there is an execute error *)
</i></font><font color="#FF0000"><b>Begin
  </b></font>Str<font color="#000080">(</font>Err<font color="#000080">,</font>ErrStr<font color="#000080">);

  </font>Msg <font color="#000080">:= </font>StrPas<font color="#000080">(</font>DosError<font color="#000080">[</font>Err<font color="#000080">])+</font><font color="#800000">#13</font><font color="#000080">+</font><font color="#800000">'Error: '</font><font color="#000080">+</font>ErrStr<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">+</font>Msg<font color="#000080">+</font><font color="#800000">#0</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,@</font>Msg<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">'Program Start Error'</font><font color="#000080">,</font>mb_OKCancel<font color="#000080">) = </font>id_OK <font color="#FF0000"><b>then
    </b></font>DispParams<font color="#000080">;
  </font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SayExeErrorHalt<font color="#000080">(</font>Err<font color="#000080">: </font>Integer<font color="#000080">;</font>Msg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>ErrStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];  </font><font color="#008000"><i>(* Used when there is an execute error *)
</i></font><font color="#FF0000"><b>Begin
  </b></font>Str<font color="#000080">(</font>Err<font color="#000080">,</font>ErrStr<font color="#000080">);

  </font>Msg <font color="#000080">:= </font>StrPas<font color="#000080">(</font>EXEError<font color="#000080">[</font>Err<font color="#000080">])+</font><font color="#800000">#13</font><font color="#000080">+</font><font color="#800000">'Error: '</font><font color="#000080">+</font>ErrStr<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">+</font>Msg<font color="#000080">+</font><font color="#800000">#0</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,@</font>Msg<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">'Program Start Error'</font><font color="#000080">,</font>mb_OKCancel<font color="#000080">) = </font>id_OK <font color="#FF0000"><b>Then
    </b></font>DispParams<font color="#000080">;
  </font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>InstanceID <font color="#000080">: </font>THandle<font color="#000080">;     </font><font color="#008000"><i>(* Handle to the executed program - Just used here to check for errors *)
  </i></font>Wnd        <font color="#000080">: </font>hWnd<font color="#000080">;        </font><font color="#008000"><i>(* Handle to the window of the program *)
  </i></font>iStart     <font color="#000080">: </font>Integer<font color="#000080">;     </font><font color="#008000"><i>(* Used in finding the above *)
  </i></font>iEnd       <font color="#000080">: </font>Integer<font color="#000080">;
  </font>CmdPos     <font color="#000080">: </font>Integer<font color="#000080">;     </font><font color="#008000"><i>(* Position of the program to execute in the system.CmdLine *)
  </i></font>Result     <font color="#000080">: </font>Integer<font color="#000080">;     </font><font color="#008000"><i>(* Check for IO errors *)
</i></font><font color="#FF0000"><b>Begin
  </b></font>Path <font color="#000080">:= </font>Trim<font color="#000080">(</font>StrPas<font color="#000080">(</font>CmdLine<font color="#000080">));

  </font><font color="#008000"><i>(* If any one tries this with a windows program *)
  </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>pos<font color="#000080">(</font>Copy<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),</font><font color="#800000">'?'</font><font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Path <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then
    Begin
      If </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'ONEEXE is a program that will ensure'#13</font><font color="#000080">+
                   </font><font color="#800000">'that only one copy of a DOS program'#13</font><font color="#000080">+
                   </font><font color="#800000">'is active on a machine.  If the DOS'#13</font><font color="#000080">+
                   </font><font color="#800000">'program is already running ONEEXE will'#13</font><font color="#000080">+
                   </font><font color="#800000">'call up the previous copy, if not it will'#13</font><font color="#000080">+
                   </font><font color="#800000">'start the program.'#13</font><font color="#000080">+
                   </font><font color="#800000">'PRESS ENTER FOR EXAMPLES'</font><font color="#000080">,
                   </font><font color="#800000">'Program Info'</font><font color="#000080">,
                   </font>mb_OKCancel<font color="#000080">) = </font>id_OK <font color="#FF0000"><b>Then

      </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Usage:'</font><font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">+
                   </font><font color="#800000">'  EXEONE [@&quot;window name&quot;] [-startup directory] filename'</font><font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">+
                   </font><font color="#800000">'Examples:'</font><font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">+
                   </font><font color="#800000">'  EXEONE COMMAND.COM'</font><font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">+
                   </font><font color="#800000">'  EXEONE -C:\PASFILE D:\BP\BIN\BP.EXE'</font><font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">+
                   </font><font color="#800000">'  ^ERR - title change'#13</font><font color="#000080">+
                   </font><font color="#800000">'  EXEONE @&quot;BORLAND PASCAL 7.0&quot; -C:\PASFILE bp.exe'#13</font><font color="#000080">+
                   </font><font color="#800000">'  ^works'#13</font><font color="#000080">+
                   </font><font color="#800000">'  EXEONE C:\DATA G:\PROGS\CONTACT.EXE'</font><font color="#000080">,
                   </font><font color="#800000">'Program Example Info'</font><font color="#000080">,
                   </font>mb_OK<font color="#000080">);
      </font>Halt<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#008000"><i>(* Set the defaults for no startup directory *)
  </i></font>WindowTitle <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;  </font><font color="#008000"><i>(* Flag no window name specified *)

  (* See if there is a startup directory *)

  </i></font><font color="#FF0000"><b>While </b></font>Pos<font color="#000080">(</font>Copy<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),</font><font color="#800000">'-@'</font><font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Do
    Begin
      If </b></font>Copy<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'-' </font><font color="#FF0000"><b>Then
        Begin
          </b></font>Delete<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>(* Remove the '-' signature *)
          </i></font>StartupDir <font color="#000080">:= </font>GetToken<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);

          </font><font color="#008000"><i>(* Clean the path of extra &quot;|&quot; *)
          </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>StartupDir<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font>StartupDir<font color="#000080">[</font>Length<font color="#000080">(</font>StartupDir<font color="#000080">)],</font><font color="#800000">'\ '</font><font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Do
            </b></font>Delete<font color="#000080">(</font>StartupDir<font color="#000080">,</font>Length<font color="#000080">(</font>StartupDir<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
          </font>ChDir<font color="#000080">(</font>StartupDir<font color="#000080">);
          </font>Result <font color="#000080">:= </font>IoResult<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Result <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>SayDOSErrorHalt<font color="#000080">(</font>Result<font color="#000080">,</font><font color="#800000">'changing directories '</font><font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">+</font>StartupDir<font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

        </font><font color="#008000"><i>(* Window name change - BP needs this *)
      </i></font><font color="#FF0000"><b>If </b></font>Copy<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'@' </font><font color="#FF0000"><b>Then
        Begin
          </b></font>Delete<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>(* Remove the '-' signature *)
          </i></font><font color="#FF0000"><b>If </b></font>Copy<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'&quot;' </font><font color="#FF0000"><b>Then
            Begin
              </b></font>Delete<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>(* Remove the '&quot;' part *)
              </i></font>WindowTitle <font color="#000080">:= </font>GetToken<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">'&quot;'</font><font color="#000080">);
            </font><font color="#FF0000"><b>End
          Else
            </b></font>WindowTitle <font color="#000080">:= </font>GetToken<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#008000"><i>(* Get Window Name - If the program is able to change it's name then this will not work *)
  (* Sorry - The only way to make it work would be to add an name change option *)
  </i></font><font color="#FF0000"><b>If </b></font>WindowTitle <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>Then
    Begin
      </b></font>iStart <font color="#000080">:= </font>Length<font color="#000080">(</font>Path<font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>iStart <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Path<font color="#000080">[</font>iStart<font color="#000080">] &lt;&gt; </font><font color="#800000">'\'</font><font color="#000080">) </font><font color="#FF0000"><b>Do
        </b></font>Dec<font color="#000080">(</font>iStart<font color="#000080">);
      </font>Inc<font color="#000080">(</font>iStart<font color="#000080">);
      </font>iEnd <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>Path<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>iEnd <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
        </b></font>iEnd <font color="#000080">:= </font>Length<font color="#000080">(</font>Path<font color="#000080">)
      </font><font color="#FF0000"><b>Else
        </b></font>Dec<font color="#000080">(</font>iEnd<font color="#000080">);
      </font><font color="#008000"><i>(* Add #0 so these may work as params to windows API *)
      </i></font>WindowTitle <font color="#000080">:= </font>Copy<font color="#000080">(</font>Path<font color="#000080">,</font>iStart<font color="#000080">,</font>iEnd<font color="#000080">-</font>iStart<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">#0</font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>If </b></font>Path <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>Then
    </b></font>SayErrorHalt<font color="#000080">(</font><font color="#800000">'There is no program path.'#13</font><font color="#000080">+
                 </font><font color="#800000">'Check for accuracy of your'#13</font><font color="#000080">+
                 </font><font color="#800000">'commad line.'</font><font color="#000080">);

  </font>Path <font color="#000080">:= </font>Path <font color="#000080">+ </font><font color="#800000">#0</font><font color="#000080">;  </font><font color="#008000"><i>(* Set it up for passing the the API *)
  (* Check for existing dos window *)
  </i></font>Wnd <font color="#000080">:= </font>FindWindow<font color="#000080">(</font><font color="#800000">'tty'</font><font color="#000080">,@</font>WindowTitle<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
  </font><font color="#FF0000"><b>If </b></font>Wnd <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then  </b></font><font color="#008000"><i>(* If it is not running *)
    </i></font><font color="#FF0000"><b>Begin          </b></font><font color="#008000"><i>(* Start it *)
      </i></font>InstanceID <font color="#000080">:= </font>WinExec<font color="#000080">(@</font>Path<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>sw_ShowNormal<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>InstanceID <font color="#000080">&lt; </font><font color="#800000">32 </font><font color="#FF0000"><b>Then
        </b></font>SayEXEErrorHalt<font color="#000080">(</font>Result<font color="#000080">,</font><font color="#800000">'running program '</font><font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">+</font>Path<font color="#000080">);
    </font><font color="#FF0000"><b>End
  Else
    Begin
      </b></font>BringWindowToTop<font color="#000080">(</font>Wnd<font color="#000080">);       </font><font color="#008000"><i>(* Bring it to the top *)
      </i></font>ShowWindow<font color="#000080">(</font>Wnd<font color="#000080">,</font>sw_Restore<font color="#000080">);  </font><font color="#008000"><i>(* And Restore it *)
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0068.PAS">Original</a><b>]</b></p></body>
</html>
