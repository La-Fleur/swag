<html>
<head><title> "DETCWIN.PAS" by GREG ESTABROOKS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ GREG ESTABROOKS }

</i></font><font color="#FF0000"><b>Program </b></font>Win3XInf<font color="#000080">;      </font><font color="#008000"><i>{ Simple Detection routines For Windows 3.X    }
                       { Last Updated March 3/93, Greg Estabrooks     }
</i></font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">,
  </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;    </font><font color="#008000"><i>{ to hold register info }

</i></font><font color="#FF0000"><b>Function </b></font>Win3X <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Routine to determine if Windows is currently running }
</i></font><font color="#FF0000"><b>begin
  </b></font>Regs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$4680</font><font color="#000080">;    </font><font color="#008000"><i>{ Win 3.x Standard check }
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$2F</font><font color="#000080">, </font>Regs<font color="#000080">);     </font><font color="#008000"><i>{ Call Int 2F }
  </i></font><font color="#FF0000"><b>if </b></font>Regs<font color="#000080">.</font>AX <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{ if AX = 0 Win in Real mode }
  </i></font><font color="#FF0000"><b>begin                </b></font><font color="#008000"><i>{ else check For enhanced mode }
    </i></font>Regs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$1600</font><font color="#000080">;  </font><font color="#008000"><i>{ Win 3.x Enhanced check }
    </i></font>Intr<font color="#000080">(</font><font color="#800000">$2F</font><font color="#000080">, </font>Regs<font color="#000080">);   </font><font color="#008000"><i>{ Call Int 2F }
    </i></font><font color="#FF0000"><b>if </b></font>Regs<font color="#000080">.</font>AL <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$80</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$FF</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{ Check returned value }
      </i></font>Win3X <font color="#000080">:= </font>False   <font color="#008000"><i>{ Nope not installed }
    </i></font><font color="#FF0000"><b>else
      </b></font>Win3X <font color="#000080">:= </font>True<font color="#000080">;   </font><font color="#008000"><i>{ Ya it is }
  </i></font><font color="#FF0000"><b>end
  else
    </b></font>Win3X <font color="#000080">:= </font>True<font color="#000080">;     </font><font color="#008000"><i>{ Return True }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>WinVer <font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#008000"><i>{  Returns a Word containing the version of Win Running }
{  Should only be used after checking For Win installed }
{  Or value returned will be meaningless                }
</i></font><font color="#FF0000"><b>begin
  </b></font>Regs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$1600</font><font color="#000080">;    </font><font color="#008000"><i>{  Enhanced mode check }
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$2F</font><font color="#000080">, </font>Regs<font color="#000080">);     </font><font color="#008000"><i>{  Call Int 2F         }
  </i></font>WinVer <font color="#000080">:= </font>Regs<font color="#000080">.</font>AX<font color="#000080">;   </font><font color="#008000"><i>{  Return proper value }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Win3X <font color="#FF0000"><b>then
  begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Windows is Running! '</font><font color="#000080">);    </font><font color="#008000"><i>{ Display version }
    </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Version Running is : '</font><font color="#000080">, </font>Lo<font color="#000080">(</font>WinVer<font color="#000080">), </font><font color="#800000">'.'</font><font color="#000080">, </font>Hi<font color="#000080">(</font>WinVer<font color="#000080">));
  </font><font color="#FF0000"><b>end
  else
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Windows is not Running!'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p></body>
</html>
