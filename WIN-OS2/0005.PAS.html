<html>
<head><title> "Window painting" by MICHAEL VINCZE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
michael a vincze

Below I have re-written your Paint method.  It is commented where I made the
changes. Get in touch with me if you have any questions.
}

</i></font><font color="#FF0000"><b>procedure </b></font>TNumConWindow<font color="#000080">.</font>Paint<font color="#000080">(</font>PaintDC <font color="#000080">: </font>HDC<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>PaintInfo <font color="#000080">: </font>TPaintStruct<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>X<font color="#000080">, </font>Y    <font color="#000080">: </font>Integer<font color="#000080">;
  </font>WRect   <font color="#000080">: </font>TRect<font color="#000080">;
  </font>DeltaX<font color="#000080">,
  </font>DeltaY<font color="#000080">,
  </font>XSize<font color="#000080">,
  </font>YSize   <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Perc    <font color="#000080">: </font>Real<font color="#000080">;
  </font>Str     <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>PC      <font color="#000080">: </font>PChar<font color="#000080">;
  </font>PCP     <font color="#000080">: </font>Integer<font color="#000080">;
  </font>SaveBK  <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>ThePen  <font color="#000080">: </font>HPen<font color="#000080">;
  </font>TheBrush<font color="#000080">: </font>HBrush<font color="#000080">;
  </font>TheRect <font color="#000080">: </font>TRect<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>CP       <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>NumLic   <font color="#000080">= </font><font color="#800000">64</font><font color="#000080">;
  </font>MaxCount <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;
  </font>Count    <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxCount<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer <font color="#000080">= (</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">);
  </font>OutStr   <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">= </font><font color="#800000">'Hello Allen E. Stoner '</font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>GetClientRect<font color="#000080">(</font>HWindow<font color="#000080">, </font>WRect<font color="#000080">);
  </font>XSize <font color="#000080">:= </font>WRect<font color="#000080">.</font>Right <font color="#000080">- </font>WRect<font color="#000080">.</font>Left<font color="#000080">;
  </font>YSize <font color="#000080">:= </font>WRect<font color="#000080">.</font>Bottom <font color="#000080">- </font>WRect<font color="#000080">.</font>Top <font color="#000080">- </font><font color="#800000">40</font><font color="#000080">;

  </font>Perc   <font color="#000080">:= </font>YSize <font color="#000080">/ (</font>NumLic <font color="#000080">* </font><font color="#800000">1.05</font><font color="#000080">);
  </font>DeltaY <font color="#000080">:= </font>Round<font color="#000080">(</font>Perc <font color="#000080">* </font><font color="#800000">10</font><font color="#000080">);

  </font><font color="#008000"><i>{ Draw fat line at bottom of graph.  The color is the system default. }
  </i></font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>YSize<font color="#000080">);
  </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">, </font>XSize<font color="#000080">, </font>YSize<font color="#000080">);
  </font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>YSize <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
  </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">, </font>XSize<font color="#000080">, </font>YSize <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
  </font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>YSize <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">);
  </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">, </font>XSize<font color="#000080">, </font>YSize <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">);

  </font><font color="#008000"><i>{ Draw horizontal lines.  The color is the system default. }
  </i></font>Y <font color="#000080">:= </font>YSize<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>Y <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>Rectangle<font color="#000080">(</font>PaintDC<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Y<font color="#000080">, </font>XSize<font color="#000080">, </font>Y <font color="#000080">- </font>DeltaY<font color="#000080">);
    </font>Y <font color="#000080">:= </font>Y <font color="#000080">- (</font>DeltaY <font color="#000080">* </font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ Fill in rectangle at bottom yellow.  This is the same size as WRect
    except the top is at YSize + 3. }
  </i></font>TheBrush <font color="#000080">:= </font>CreateSolidBrush<font color="#000080">(</font>RGB<font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">, </font><font color="#800000">$FF</font><font color="#000080">, </font><font color="#800000">$00</font><font color="#000080">));
  </font>CopyRect<font color="#000080">(</font>TheRect<font color="#000080">, </font>WRect<font color="#000080">);
  </font>TheRect<font color="#000080">.</font>Top <font color="#000080">:= </font>YSize <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">;
  </font>FillRect<font color="#000080">(</font>PaintDC<font color="#000080">, </font>TheRect<font color="#000080">, </font>TheBrush<font color="#000080">);

  </font><font color="#008000"><i>{ Draw vertical lines red. If you wanted to, you could draw rectangles
    instead of lines. Notice how I've selected a width of 4 for ThePen.
    You could also have a different color for each &quot;bar&quot; by having X index
    into an array of TColorRefs and changing ThePen for each new value of X.}
  </i></font>ThePen <font color="#000080">:= </font>CreatePen<font color="#000080">(</font>PS_SOLID<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font>RGB<font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">, </font><font color="#800000">$00</font><font color="#000080">, </font><font color="#800000">$00</font><font color="#000080">));
  </font>SelectObject<font color="#000080">(</font>PaintDC<font color="#000080">, </font>ThePen<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>X <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MaxCount <font color="#FF0000"><b>do
  begin
    </b></font>MoveTo<font color="#000080">(</font>PaintDC<font color="#000080">, </font>X <font color="#000080">* </font><font color="#800000">10</font><font color="#000080">, </font>YSize<font color="#000080">);
    </font>LineTo<font color="#000080">(</font>PaintDC<font color="#000080">, </font>X <font color="#000080">* </font><font color="#800000">10</font><font color="#000080">, </font>Round<font color="#000080">(</font>YSize <font color="#000080">- (</font>Count<font color="#000080">[</font>X<font color="#000080">] * </font>Perc<font color="#000080">)));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>CP <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then
    </b></font>PCP <font color="#000080">:= </font><font color="#800000">300
  </font><font color="#FF0000"><b>else
    </b></font>PCP <font color="#000080">:= </font>CP <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
  </font>PC <font color="#000080">:= @</font>OutStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];

  </font><font color="#008000"><i>{ Set the color of the text.  Note GetSysColor is used merely as an example.
    Don't forget that the background of the text must also be colored.  This
    color should be yellow, as in TheBrush, however a different color was
    selected for illustration purposes.  Alternatively SetBkMode() could
    be used }
  </i></font>SetTextColor<font color="#000080">(</font>PaintDC<font color="#000080">, </font>GetSysColor<font color="#000080">(</font>COLOR_HIGHLIGHT<font color="#000080">));
  </font>SetBkColor<font color="#000080">(</font>PaintDC<font color="#000080">, </font>RGB<font color="#000080">(</font><font color="#800000">$00</font><font color="#000080">, </font><font color="#800000">$FF</font><font color="#000080">, </font><font color="#800000">$FF</font><font color="#000080">));
  </font><font color="#008000"><i>{ Use SetBkMode () instead of SetBkColor () to see what happens.
    SetBkMode (PaintDC, TRANSPARENT); }

  </i></font>TextOut<font color="#000080">(</font>PaintDC<font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font>YSize<font color="#000080">+</font><font color="#800000">15</font><font color="#000080">, </font>PC<font color="#000080">, </font>Length<font color="#000080">(</font>OutStr<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);

  </font><font color="#008000"><i>{ Don't forget to delete the selected objects. }
  </i></font>DeleteObject<font color="#000080">(</font>ThePen<font color="#000080">);
  </font>DeleteObject<font color="#000080">(</font>TheBrush<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p></body>
</html>
