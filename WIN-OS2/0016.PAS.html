<html>
<head><title> "Detection for WIN 3.X" by GREG ESTABROOKS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{***********************************************************************}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>Win3XInf<font color="#000080">;       </font><font color="#008000"><i>{  Simple Detection routines for Windows 3.X    }
                        {  Last Updated April 28/93, Greg Estabrooks    }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Win3X <font color="#000080">:</font>BOOLEAN<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                </font><font color="#008000"><i>{  Routine to determine if Windows is currently running }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Mov AX,$4680                          </font><font color="#008000"><i>{  Win 3.x Standard check       }
  </i></font><font color="#FF00FF">Int $2F                               </font><font color="#008000"><i>{  Call Int 2F                  }
  </i></font><font color="#FF00FF">Cmp AX,0                              </font><font color="#008000"><i>{  IF AX = 0 Win in real mode   }
  </i></font><font color="#FF00FF">JNE @EnhancedCheck                    </font><font color="#008000"><i>{  If not check for enhanced mode}
  </i></font><font color="#FF00FF">Mov AL,1                              </font><font color="#008000"><i>{  Set Result to true           }
  </i></font><font color="#FF00FF">Jmp @Exit                             </font><font color="#008000"><i>{  Go to end of routine         }
</i></font><font color="#FF00FF">@EnhancedCheck:                         </font><font color="#008000"><i>{  Else check for enhanced mode }
  </i></font><font color="#FF00FF">Mov AX,$1600                          </font><font color="#008000"><i>{  Win 3.x Enhanced check       }
  </i></font><font color="#FF00FF">Int $2F                               </font><font color="#008000"><i>{  Call Int 2F                  }
  </i></font><font color="#FF00FF">Cmp AL,0                              </font><font color="#008000"><i>{  Check returned value         }
  </i></font><font color="#FF00FF">Je @False                             </font><font color="#008000"><i>{  If not one of the below it   }
  </i></font><font color="#FF00FF">Cmp AL,$80                            </font><font color="#008000"><i>{  is NOT installed             }
  </i></font><font color="#FF00FF">Je @False
  Mov AL,1                              </font><font color="#008000"><i>{  Nope it must BE INSTALLED    }
  </i></font><font color="#FF00FF">Jmp @Exit
@False:
  Mov AL,0                              </font><font color="#008000"><i>{  Set Result to False          }
</i></font><font color="#FF00FF">@Exit:
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{Win3X}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>WinVer <font color="#000080">:</font>WORD<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                </font><font color="#008000"><i>{  Returns a word containing the version of Win Running }
                {  Should only be used after checking for Win installed }
                {  Or value returned will be meaning less               }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Mov AX,$1600                     </font><font color="#008000"><i>{    Enhanced mode check             }
  </i></font><font color="#FF00FF">Int $2F                          </font><font color="#008000"><i>{    Call Int 2F                     }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{WinVer}

</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font>Win3X <font color="#FF0000"><b>THEN                         </b></font><font color="#008000"><i>{  If it is running say so      }
   </i></font><font color="#FF0000"><b>BEGIN
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Windows is Running! '</font><font color="#000080">);    </font><font color="#008000"><i>{  Now display version running  }
    </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Version Running is : '</font><font color="#000080">,</font>Lo<font color="#000080">(</font>WinVer<font color="#000080">),</font><font color="#800000">'.'</font><font color="#000080">,</font>Hi<font color="#000080">(</font>WinVer<font color="#000080">));
   </font><font color="#FF0000"><b>END
  ELSE                                  </b></font><font color="#008000"><i>{  If not 'Just say NO!'        }
    </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Windows is not Running!'</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font><font color="#008000"><i>{***********************************************************************}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p></body>
</html>
