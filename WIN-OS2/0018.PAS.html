<html>
<head><title> "Windows Statusline Unit" by THOMAS CARLISLE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(**************************************************************************
 *                                                                        *
 * STATUS.PAS - A Statusline unit, by Thomas S. Carlisle                  *
 *              Free for public use, all I ask is that my name remain     *
 *              with this code.                                           *  
 *                                                                        *
 * This unit provides easy implementation of a status line. The           *
 * statusline will be at the bottom of the screen, and will take on the   *
 * colors defined in the system as button face, and button shadow.        *
 *                                                                        *
 * The statusline can have multiple partitions to display different       *
 * information. For example, you could have a partition that displays     *
 * a clock (see STATUSEX.PAS), another one that displays the current      *
 * file open in a word processing application, or virtually anything you  *
 * can think up.                                                          *
 *                                                                        *
 * The main object is TStatusLine. TStatusline is an abstract object with *
 * limited default functionality. TStatusline is a statusline with no     *
 * partitions. It knows how to draw itself, and most importantly it knows *
 * how to insert partitions. However, TStatusline does not Insert any     *
 * partitions. The user must create a descendant object of TStatusLine    *
 * that overrides the Setup method to insert some partitions.             *
 *                                                                        *
 * A typical Setup method may look something like this:                   *
 *  PROCEDURE TMyStatusline.Setup;                                        *
 *  BEGIN                                                                 *
 *       InsertItem(100,DrawProc);                                        *
 *  END;                                                                  *
 *                                                                        *
 * That would insert a partition that is 100 pixels wide. The second      *
 * parameter is important. It is a procedure. Each partition must be      *
 * passed a procedure so it knows who to call to fill in the partition    *
 * with the appropriate text. The procedure passed in the InsertItem      *
 * statement MUST be a procedure that was previously declared like this:  *
 *                                                                        *
 * PROCEDURE DrawProc(PaintHDC : HDC; VAR PaintInfo : TPaintStruct);FAR;  *
 * BEGIN                                                                  *
 *     { your custom draw code goes here... }                             *
 * END;                                                                   *
 *                                                                        *
 * Note proceduremust be declared as FAR. It also MUST have the exact     *
 * parameter list as shown. In the body, you can do what you want. A      *
 * simple example would be to simply write out a line of text:            *
 *                                                                        *
 * PROCEDURE DrawProc(PaintHDC : HDC; VAR PaintInfo : TPaintStruct);FAR;  *
 * BEGIN                                                                  *
 *     TextOut(PaintHdc,3,1,'Test',4);                                    *
 * END;                                                                   *
 *                                                                        *
 * Usually you will not have a simple procedure like that. For a better,  *
 * more functional example see the procedure Clock in STATUSEX.PAS        *
 *                                                                        *
 *************************************************************************)

</i></font><font color="#FF0000"><b>UNIT </b></font>Status<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

USES
    </b></font>WObjects<font color="#000080">,</font>WinTypes<font color="#000080">,</font>WinProcs<font color="#000080">,</font>WinCrt<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
    </b></font>TPaintProc <font color="#000080">= </font><font color="#FF0000"><b>PROCEDURE</b></font><font color="#000080">(</font>PaintHdc <font color="#000080">: </font>HDC<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>PaintInfo <font color="#000080">: </font>TPaintStruct<font color="#000080">);

    </font>PPartitionCollection <font color="#000080">= ^</font>TPartitionCollection<font color="#000080">;

    </font>TPartitionCollection <font color="#000080">= </font><font color="#FF0000"><b>OBJECT</b></font><font color="#000080">(</font>TCollection<font color="#000080">)
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font>PPartition <font color="#000080">= ^</font>TPartition<font color="#000080">;

    </font>TPartition <font color="#000080">= </font><font color="#FF0000"><b>OBJECT</b></font><font color="#000080">(</font>TWindow<font color="#000080">)
        </font><font color="#FF0000"><b>PRIVATE
         </b></font>LeftPosition<font color="#000080">,
         </font>RightPosition  <font color="#000080">: </font>WORD<font color="#000080">;
         </font>PaintProc      <font color="#000080">: </font>TPaintProc<font color="#000080">;
         </font><font color="#FF0000"><b>CONSTRUCTOR </b></font>Init<font color="#000080">(</font>AParent <font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>ATitle <font color="#000080">: </font>PCHAR<font color="#000080">;
               </font>LPos<font color="#000080">,</font>RPos <font color="#000080">: </font>WORD<font color="#000080">; </font>Proc <font color="#000080">: </font>TPaintProc<font color="#000080">);
         </font><font color="#FF0000"><b>PROCEDURE </b></font>Paint<font color="#000080">(</font>PaintHDC <font color="#000080">: </font>HDC<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>PaintInfo <font color="#000080">: </font>TPaintStruct<font color="#000080">);
              </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    
    </font>PStatusLine <font color="#000080">= ^</font>TStatusLine<font color="#000080">;

    </font>TStatusLine <font color="#000080">= </font><font color="#FF0000"><b>OBJECT</b></font><font color="#000080">(</font>TWindow<font color="#000080">)
        </font><font color="#FF0000"><b>CONSTRUCTOR </b></font>Init<font color="#000080">(</font>AParent <font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>ATitle <font color="#000080">: </font>PCHAR<font color="#000080">);
        </font><font color="#FF0000"><b>PROCEDURE </b></font>Paint<font color="#000080">(</font>PaintHDC <font color="#000080">: </font>HDC<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>PaintInfo <font color="#000080">: </font>TPaintStruct<font color="#000080">);
              </font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>DESTRUCTOR </b></font>Done<font color="#000080">;</font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>PROCEDURE </b></font>InsertItem<font color="#000080">(</font>StrLength <font color="#000080">: </font>WORD<font color="#000080">; </font>Proc <font color="#000080">: </font>TPaintProc<font color="#000080">);
        </font><font color="#FF0000"><b>PROCEDURE </b></font>Setup<font color="#000080">;</font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>FUNCTION </b></font>GetPartition<font color="#000080">(</font>Index <font color="#000080">: </font>BYTE<font color="#000080">):</font>PPartition<font color="#000080">;</font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>PRIVATE
         </b></font>Partitions     <font color="#000080">: </font>PPartitionCollection<font color="#000080">;        
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

</b></font><font color="#008000"><i>(************************** TPartition Methods ***************************)

{ TPartition is an object descendant of TWindow. All TPartition objects
  are child windows with TStatusLine as the parent.

  When a TPartition is inserted in the statusline, it is automaticlly
  inserted right next to the previous TPartition on the statusline.

  The Init constructor method is called whenevr a new TPartition is
  inserted in the statusline. The parameters of Init include the
  TPartition's parent window, its title (Nil), the TPartitions left position
  on the statusline, it's right position on the statusline, and most
  importantly -- the last parameter -- is a procedure parameter. This
  procedure parameter is a user defined procedure that will be used by
  the TPartition.Paint method.

  Each TPartition knows how to draw itself, with the Paint method. The Paint
  method draws an empty partition (i.e - only the frame, not filled with
  text. The paint method calls the user defined procedure, which is
  responsible for filling the partition frame with the appropriate text.

  See STATUSEX.PAS for an example of the user defined procedure           }
    

</i></font><font color="#FF0000"><b>CONSTRUCTOR </b></font>TPartition<font color="#000080">.</font>Init<font color="#000080">(</font>AParent <font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>ATitle <font color="#000080">: </font>PCHAR<font color="#000080">;
       </font>LPos<font color="#000080">,</font>RPos <font color="#000080">: </font>WORD<font color="#000080">; </font>Proc <font color="#000080">: </font>TPaintProc<font color="#000080">);

</font><font color="#FF0000"><b>VAR
   </b></font>R   <font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>TWindow<font color="#000080">.</font>Init<font color="#000080">(</font>AParent<font color="#000080">,</font>ATitle<font color="#000080">);
     </font>LeftPosition<font color="#000080">:=</font>LPos<font color="#000080">;
     </font>RightPosition<font color="#000080">:=</font>RPos<font color="#000080">;
     </font>PaintProc<font color="#000080">:=</font>Proc<font color="#000080">;
     </font><font color="#FF0000"><b>WITH </b></font>Attr <font color="#FF0000"><b>DO BEGIN
          </b></font>Style<font color="#000080">:=</font>Style <font color="#FF0000"><b>OR </b></font>ws_Child<font color="#000080">;
          </font>X<font color="#000080">:=</font>LPos<font color="#000080">;
          </font>Y<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
          </font>W<font color="#000080">:=</font>RPos<font color="#000080">-</font>LPos<font color="#000080">;
          </font>H<font color="#000080">:=</font><font color="#800000">17</font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TPartition<font color="#000080">.</font>Paint<font color="#000080">(</font>PaintHDC <font color="#000080">: </font>HDC<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>PaintInfo <font color="#000080">: </font>TPaintStruct<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>R <font color="#000080">: </font>TRect<font color="#000080">;
   </font>TheBrush<font color="#000080">,
   </font>OldBrush     <font color="#000080">: </font>HBrush<font color="#000080">;
   </font>Pen<font color="#000080">,
   </font>OldPen       <font color="#000080">: </font>HPen<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>GetClientRect<font color="#000080">(</font>HWindow<font color="#000080">,</font>R<font color="#000080">);
     </font>TheBrush<font color="#000080">:=</font>CreateSolidBrush<font color="#000080">(</font>GetSysColor<font color="#000080">(</font>color_BtnFace<font color="#000080">));
     </font>FillRect<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">,</font>TheBrush<font color="#000080">);
     </font>DeleteObject<font color="#000080">(</font>TheBrush<font color="#000080">);

     </font>SetBkColor<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>GetSysColor<font color="#000080">(</font>color_BtnFace<font color="#000080">));
     </font>PaintProc<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>PaintInfo<font color="#000080">);

     </font>Pen<font color="#000080">:=</font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>RGB<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">));
     </font>OldPen<font color="#000080">:=</font>SelectObject<font color="#000080">(</font>PaintHDC<font color="#000080">,</font>Pen<font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHDC<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHDC<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">,</font>R<font color="#000080">.</font>Bottom<font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">15</font><font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">15</font><font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);

     </font>DeleteObject<font color="#000080">(</font>SelectObject<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>OldPen<font color="#000080">));
     </font>Pen<font color="#000080">:=</font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>GetSysColor<font color="#000080">(</font>color_btnShadow<font color="#000080">));
     </font>OldPen<font color="#000080">:=</font>SelectObject<font color="#000080">(</font>PaintHDC<font color="#000080">,</font>Pen<font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>R<font color="#000080">.</font>Bottom<font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">15</font><font color="#000080">);

     </font>DeleteObject<font color="#000080">(</font>SelectObject<font color="#000080">(</font>PaintHDC<font color="#000080">,</font>OldPen<font color="#000080">));     
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(*************************** TStatusLine Methods *************************)

{ TStatusLine is an object descendant of TWindow. TStatusLine has a field
  called Partitions, which is a collection of TPartitions.

  The InsertItem method is the method responsible for inserting new
  TPartitions in the Partition collection.

  The Paint method draws the statusline, and iterates through the Partition
  collection call each ones Paint method. This results in the entire
  statusline being redrawn. }


</i></font><font color="#FF0000"><b>CONSTRUCTOR </b></font>TStatusLine<font color="#000080">.</font>Init<font color="#000080">(</font>AParent <font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>ATitle <font color="#000080">: </font>PCHAR<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>TWindow<font color="#000080">.</font>Init<font color="#000080">(</font>AParent<font color="#000080">,</font>ATitle<font color="#000080">);
     </font><font color="#FF0000"><b>WITH </b></font>Attr <font color="#FF0000"><b>DO BEGIN
          </b></font>Style <font color="#000080">:= </font>Style <font color="#FF0000"><b>OR </b></font>ws_Child <font color="#FF0000"><b>OR </b></font>ws_Border<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>Partitions<font color="#000080">:=</font>New<font color="#000080">(</font>PPartitionCollection<font color="#000080">,</font>Init<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">));
     </font>Setup<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TStatusLine<font color="#000080">.</font>InsertItem<font color="#000080">(</font>StrLength <font color="#000080">: </font>WORD<font color="#000080">; </font>Proc <font color="#000080">: </font>TPaintProc<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     IF </b></font>Partitions<font color="#000080">^.</font>Count<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
        </b></font>Partitions<font color="#000080">^.</font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PPartition<font color="#000080">,</font>Init<font color="#000080">(@</font>Self<font color="#000080">,</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>StrLength<font color="#000080">,
        </font>Proc<font color="#000080">)));
     </font><font color="#FF0000"><b>END
     ELSE BEGIN
       </b></font>Partitions<font color="#000080">^.</font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PPartition<font color="#000080">,</font>Init<font color="#000080">(@</font>Self<font color="#000080">,</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">,</font>PPartition<font color="#000080">(
          </font>Partitions<font color="#000080">^.</font>At<font color="#000080">(</font>Partitions<font color="#000080">^.</font>Count<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">))^.</font>RightPosition<font color="#000080">,</font>PPartition<font color="#000080">(
          </font>Partitions<font color="#000080">^.</font>At<font color="#000080">(</font>Partitions<font color="#000080">^.</font>Count<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">))^.</font>RightPosition<font color="#000080">+</font>StrLength<font color="#000080">,
          </font>Proc<font color="#000080">)));
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>TStatusLine<font color="#000080">.</font>GetPartition<font color="#000080">(</font>Index <font color="#000080">: </font>BYTE<font color="#000080">):</font>PPartition<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>GetPartition<font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>IF </b></font>Partitions<font color="#000080">^.</font>Count<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
        </b></font>GetPartition<font color="#000080">:=</font>Partitions<font color="#000080">^.</font>At<font color="#000080">(</font>Index<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TStatusLine<font color="#000080">.</font>Setup<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TStatusLine<font color="#000080">.</font>Paint<font color="#000080">(</font>PaintHDC <font color="#000080">: </font>HDC<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>PaintInfo <font color="#000080">: </font>TPaintStruct<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>R         <font color="#000080">: </font>TRect<font color="#000080">;
   </font>TheBrush  <font color="#000080">: </font>HBrush<font color="#000080">;
   </font>Pen<font color="#000080">,
   </font>OldPen    <font color="#000080">: </font>HPen<font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>CallPaint<font color="#000080">(</font>P <font color="#000080">: </font>PPartition<font color="#000080">);</font><font color="#FF0000"><b>FAR</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
        </b></font>P<font color="#000080">^.</font>Paint<font color="#000080">(</font>PaintHDC<font color="#000080">,</font>PaintInfo<font color="#000080">);        
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
     </b></font>GetClientRect<font color="#000080">(</font>Parent<font color="#000080">^.</font>HWindow<font color="#000080">,</font>R<font color="#000080">);
     </font>MoveWindow<font color="#000080">(</font>HWindow<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>R<font color="#000080">.</font>Bottom<font color="#000080">-</font><font color="#800000">18</font><font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">-</font>R<font color="#000080">.</font>Left<font color="#000080">,</font>R<font color="#000080">.</font>Bottom<font color="#000080">,</font>TRUE<font color="#000080">);

     </font>GetClientRect<font color="#000080">(</font>HWindow<font color="#000080">,</font>R<font color="#000080">);
     </font><font color="#FF0000"><b>IF </b></font>Partitions<font color="#000080">^.</font>Count<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
        </b></font>R<font color="#000080">.</font>Left<font color="#000080">:=</font>PPartition<font color="#000080">(
              </font>Partitions<font color="#000080">^.</font>At<font color="#000080">(</font>Partitions<font color="#000080">^.</font>Count<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">))^.</font>RightPosition<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>TheBrush<font color="#000080">:=</font>CreateSolidBrush<font color="#000080">(</font>GetSysColor<font color="#000080">(</font>color_BtnFace<font color="#000080">));
     </font>FillRect<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">,</font>TheBrush<font color="#000080">);
     </font>DeleteObject<font color="#000080">(</font>TheBrush<font color="#000080">);

     </font>Pen<font color="#000080">:=</font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>RGB<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">));
     </font>OldPen<font color="#000080">:=</font>SelectObject<font color="#000080">(</font>PaintHDC<font color="#000080">,</font>Pen<font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHDC<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHDC<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">,</font>R<font color="#000080">.</font>Bottom<font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">15</font><font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">15</font><font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);

     </font>DeleteObject<font color="#000080">(</font>SelectObject<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>OldPen<font color="#000080">));
     </font>Pen<font color="#000080">:=</font>CreatePen<font color="#000080">(</font>ps_Solid<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>GetSysColor<font color="#000080">(</font>color_btnShadow<font color="#000080">));
     </font>OldPen<font color="#000080">:=</font>SelectObject<font color="#000080">(</font>PaintHDC<font color="#000080">,</font>Pen<font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Right<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>R<font color="#000080">.</font>Bottom<font color="#000080">);
     </font>MoveTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
     </font>LineTo<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>R<font color="#000080">.</font>Left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>R<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">15</font><font color="#000080">);

     </font>DeleteObject<font color="#000080">(</font>SelectObject<font color="#000080">(</font>PaintHdc<font color="#000080">,</font>OldPen<font color="#000080">));

     </font>Partitions<font color="#000080">^.</font>ForEach<font color="#000080">(@</font>CallPaint<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>DESTRUCTOR </b></font>TStatusLine<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Dispose<font color="#000080">(</font>Partitions<font color="#000080">,</font>Done<font color="#000080">);
     </font>TWindow<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{------------------------   DEMO -------------------------}

 (*************************************************************************
 *                                                                        *
 * STATUSEX.PAS - example program using the STATUS unit.                  *
 *                By Thomas S. Carlisle                                   *
 *                                                                        *
 *                                                                        *
 * This program sets up an example application demonstrating the use of   *
 * the STATUS unit. A main window is created that has a statusline with   *
 * a single partition that will display the current time.                 *
 *                                                                        *
 * I picked a clock example because it demonstrates how the main window   *
 * can communicate with the statusline to tell it a certain partition     *
 * needs to be redrawn.                                                   *
 *                                                                        *
 *************************************************************************)

</i></font><font color="#FF0000"><b>PROGRAM </b></font>StatusEx<font color="#000080">;
</font><font color="#FF0000"><b>USES
    </b></font>WObjects<font color="#000080">,</font>WinTypes<font color="#000080">,</font>WinProcs<font color="#000080">,</font>Status<font color="#000080">,</font>WinDOS<font color="#000080">,</font>Strings<font color="#000080">;

</font><font color="#FF0000"><b>CONST
     </b></font>wm_UpdateTime   <font color="#000080">= </font><font color="#800000">$0400</font><font color="#000080">;  </font><font color="#008000"><i>{ User defined message }
      
</i></font><font color="#FF0000"><b>TYPE
    </b></font>TimeRec <font color="#000080">= </font><font color="#FF0000"><b>RECORD           
            </b></font>Hour<font color="#000080">,
            </font>Min     <font color="#000080">: </font>WORD<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font>PMyStatusLine <font color="#000080">= ^</font>TMyStatusLine<font color="#000080">;

    </font>TMyStatusLine <font color="#000080">= </font><font color="#FF0000"><b>OBJECT</b></font><font color="#000080">(</font>TStatusLine<font color="#000080">)    
        </font><font color="#FF0000"><b>PROCEDURE </b></font>Setup<font color="#000080">;</font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>PROCEDURE </b></font>UpdateTime<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);
             </font><font color="#FF0000"><b>VIRTUAL </b></font>wm_First <font color="#000080">+ </font>wm_UpdateTime<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font>PMyWindow <font color="#000080">= ^</font>TMyWindow<font color="#000080">;

    </font>TMyWindow <font color="#000080">= </font><font color="#FF0000"><b>OBJECT</b></font><font color="#000080">(</font>TWindow<font color="#000080">)
         </font>StatusLine    <font color="#000080">: </font>PMyStatusLine<font color="#000080">;
         </font><font color="#FF0000"><b>CONSTRUCTOR </b></font>Init<font color="#000080">(</font>AParent <font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>ATitle <font color="#000080">: </font>PCHAR<font color="#000080">);
         </font><font color="#FF0000"><b>PROCEDURE </b></font>SetupWindow<font color="#000080">;</font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>DESTRUCTOR </b></font>Done<font color="#000080">;</font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>PROCEDURE </b></font>Timer<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);</font><font color="#FF0000"><b>VIRTUAL </b></font>wm_Timer<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font>TMyApp <font color="#000080">= </font><font color="#FF0000"><b>OBJECT</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
           </font><font color="#FF0000"><b>PROCEDURE </b></font>InitMainWindow<font color="#000080">;</font><font color="#FF0000"><b>VIRTUAL</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>(********************************* Globals **************************)

</i></font><font color="#FF0000"><b>VAR
   </b></font>OldTime      <font color="#000080">: </font>TimeRec<font color="#000080">;    </font><font color="#008000"><i>{ OldTime will be used to keep track of
                                whether or not the time has changed and
                                needs to be redrawn                       }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Clock<font color="#000080">(</font>PaintHdc <font color="#000080">: </font>HDC<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>PaintInfo <font color="#000080">: </font>TPaintStruct<font color="#000080">);</font><font color="#FF0000"><b>FAR</b></font><font color="#000080">;

</font><font color="#008000"><i>{ This procedure MUST be declared as FAR because it is passed as a
  parameter to the statusline, so the statusline will know what procedure
  to call when the statusline needs to be drawn. The statusline draws the
  actual box, but this procedure must fill in the text.

  Note the parameter list. It is mandatory, but also convenient. You will
  need to use the PaintHDC as the device context for your text output. The
  PaintInfo is there just in case you need it. All procedures designed to be
  passed to the statusline to be used to fill in the statusline partitions
  MUST have these two parameters!

  This procedure simply fills the box with the current time.              }

</i></font><font color="#FF0000"><b>VAR
   </b></font>TimeStr      <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
   </font>Hour<font color="#000080">,
   </font>Minute<font color="#000080">,
   </font>Sec<font color="#000080">,
   </font>HSec         <font color="#000080">: </font>WORD<font color="#000080">;
   </font>TempStr<font color="#000080">,
   </font>Temp1        <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>StrCopy<font color="#000080">(</font>TimeStr<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
     </font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Sec<font color="#000080">,</font>HSec<font color="#000080">);
     </font>OldTime<font color="#000080">.</font>Hour<font color="#000080">:=</font>Hour<font color="#000080">;          </font><font color="#008000"><i>{ Fill in OldTime record for future use }
     </i></font>OldTime<font color="#000080">.</font>Min<font color="#000080">:=</font>Minute<font color="#000080">;
     </font>Str<font color="#000080">(</font>Hour<font color="#000080">,</font>TempStr<font color="#000080">);           </font><font color="#008000"><i>{ Build the string that holds the time }
     </i></font>StrCat<font color="#000080">(</font>TimeStr<font color="#000080">,</font>TempStr<font color="#000080">);
     </font>StrCopy<font color="#000080">(</font>TempStr<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
     </font>StrCat<font color="#000080">(</font>TimeStr<font color="#000080">,</font>TempStr<font color="#000080">);
     </font>Str<font color="#000080">(</font>Minute<font color="#000080">,</font>TempStr<font color="#000080">);
     </font><font color="#FF0000"><b>IF </b></font>StrLen<font color="#000080">(</font>TempStr<font color="#000080">)=</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN BEGIN
         </b></font>StrCopy<font color="#000080">(</font>Temp1<font color="#000080">,</font><font color="#800000">'0'</font><font color="#000080">);
         </font>StrCat<font color="#000080">(</font>Temp1<font color="#000080">,</font>TempStr<font color="#000080">);
         </font>StrCopy<font color="#000080">(</font>TempStr<font color="#000080">,</font>Temp1<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
     </font>StrCat<font color="#000080">(</font>TimeStr<font color="#000080">,</font>TempStr<font color="#000080">);
     </font>TextOut<font color="#000080">(</font>PaintHdc<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>TimeStr<font color="#000080">,</font>StrLen<font color="#000080">(</font>TimeStr<font color="#000080">));   </font><font color="#008000"><i>{ Output the time }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(************************ TMyStatusLine Methods ************************)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>TMyStatusLine<font color="#000080">.</font>UpdateTime<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);

</font><font color="#008000"><i>{ This procedure is a response method for TMyStatusLine. It responds to
  the wm_UpdateTime user defined message. The procedure first checks
  the current time against the time in OldTime. If they are different,
  then the clock status window is invalidated, to force it to be redrawn
  with the new time.

  The reason this program is setup to keep track of the OldTime, and have
  this procedure check it, is to avoid flicker that occurs if the time
  is updated when it isn't necessary.                                    }

</i></font><font color="#FF0000"><b>VAR
   </b></font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>HSec <font color="#000080">: </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>HSec<font color="#000080">);
     </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>OldTime<font color="#000080">.</font>Hour<font color="#000080">&lt;&gt;</font>Hour<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>OldTime<font color="#000080">.</font>Min<font color="#000080">&lt;&gt;</font>Min<font color="#000080">) </font><font color="#FF0000"><b>THEN
          </b></font>InvalidateRect<font color="#000080">(</font>GetPartition<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)^.</font>HWindow<font color="#000080">,</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">,</font>TRUE<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TMyStatusLine<font color="#000080">.</font>Setup<font color="#000080">;

</font><font color="#008000"><i>{ Overrides the inherited Setup method. This setup method inserts one
  statusline partition in the status line. }

</i></font><font color="#FF0000"><b>BEGIN
     </b></font>InsertItem<font color="#000080">(</font><font color="#800000">75</font><font color="#000080">,</font>Clock<font color="#000080">);  </font><font color="#008000"><i>{ This inserts a new item in the statsuline.
                              The first parameter is the length (in pixels)
                              of the desired statusline partition. The
                              second parameter is the procedure this new
                              partition will call whenever it needs to be
                              redrawn. As stated earlier, the statusline
                              takes care of drawing the statusline and it's
                              partitions, but the procedure passed here is
                              responsible for filling the partition with
                              text }

                            { If you need more than one partition,
                              simply add more InsertItem statements. Each
                              one can be passed a length and procedure
                              parameter. Very powerful.                  }

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(************************* TMyWindow Methods ***************************)

</i></font><font color="#FF0000"><b>CONSTRUCTOR </b></font>TMyWindow<font color="#000080">.</font>Init<font color="#000080">(</font>AParent <font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>ATitle <font color="#000080">: </font>PCHAR<font color="#000080">);

</font><font color="#008000"><i>{ TMyWindow is a descendant of TWindow. The only difference is it has a
  StatusLine.                                                              }

</i></font><font color="#FF0000"><b>BEGIN
     </b></font>TWindow<font color="#000080">.</font>Init<font color="#000080">(</font>AParent<font color="#000080">,</font>ATitle<font color="#000080">);
     </font>Statusline<font color="#000080">:=</font>New<font color="#000080">(</font>PMyStatusLine<font color="#000080">,</font>Init<font color="#000080">(@</font>Self<font color="#000080">,</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TMyWindow<font color="#000080">.</font>SetupWindow<font color="#000080">;

</font><font color="#008000"><i>{ SetupWindow is needed in this application to start the timer that will
  be used to spark messages every second to make sure the statusline clock
  is kept up to date.                                                      }

</i></font><font color="#FF0000"><b>BEGIN
     </b></font>TWindow<font color="#000080">.</font>SetupWindow<font color="#000080">;
     </font><font color="#FF0000"><b>IF </b></font>SetTimer<font color="#000080">(</font>HWindow<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
        </b></font>MessageBox<font color="#000080">(</font>HWindow<font color="#000080">,</font><font color="#800000">'ERROR'</font><font color="#000080">,</font><font color="#800000">'Timer not available'</font><font color="#000080">,</font>mb_OK<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TMyWindow<font color="#000080">.</font>Timer<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);

</font><font color="#008000"><i>{ Responds to wm_Timer messages. First checks to make sure the incomming
  message is ours (ID=1). If it is, it sends a wm_UpdateTime message
  to the statusline. That is the message the statusline responds to by
  updating the time, if it has changed.                                   }
   
</i></font><font color="#FF0000"><b>BEGIN
     IF </b></font>Msg<font color="#000080">.</font>wParam<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN BEGIN
        </b></font>SendMessage<font color="#000080">(</font>StatusLine<font color="#000080">^.</font>HWindow<font color="#000080">,</font>wm_UpdateTime<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);     
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;     
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>DESTRUCTOR </b></font>TMyWindow<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#008000"><i>{ Cleans up by killing the timer we started, and disposing the statusline }
</i></font><font color="#FF0000"><b>BEGIN
     </b></font>KillTimer<font color="#000080">(</font>HWindow<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font>Dispose<font color="#000080">(</font>StatusLine<font color="#000080">,</font>Done<font color="#000080">);
     </font>TWindow<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************** TMyApp Methods ************************)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>TMyApp<font color="#000080">.</font>InitMainWindow<font color="#000080">;
</font><font color="#008000"><i>{ Gets our main window (TMyWindow) in action }
</i></font><font color="#FF0000"><b>BEGIN
     </b></font>MainWindow<font color="#000080">:=</font>New<font color="#000080">(</font>PMyWindow<font color="#000080">,</font>Init<font color="#000080">(</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">,</font><font color="#800000">'Test'</font><font color="#000080">));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>MyApp   <font color="#000080">: </font>TMyApp<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>MyApp<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#800000">'Test'</font><font color="#000080">);
     </font>MyApp<font color="#000080">.</font>Run<font color="#000080">;
     </font>MyApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p></body>
</html>
