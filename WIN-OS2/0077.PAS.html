<html>
<head><title> "horizontal scroll bar for a list box" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>program </b></font>HorizontalListBox<font color="#000080">;

</font><font color="#FF0000"><b>uses
    </b></font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>OWindows<font color="#000080">, </font>ODialogs<font color="#000080">, </font>Strings<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>id_ListBox1 <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;


</font><font color="#FF0000"><b>type
  </b></font>ListBoxApp <font color="#000080">= </font><font color="#FF0000"><b>Object </b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>InitMainWindow<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PHListBox <font color="#000080">= ^</font>THListBox<font color="#000080">;
  </font>THListBox <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TListBox<font color="#000080">)
      </font><font color="#FF0000"><b>procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PMainWindow <font color="#000080">= ^</font>TMainWindow<font color="#000080">;
  </font>TMainWindow <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TWindow<font color="#000080">)
    </font>ListBox1<font color="#000080">: </font>PHListBox<font color="#000080">;
    </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font>AParent<font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>ATitle<font color="#000080">: </font>PChar<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMainWindow<font color="#000080">.</font>SetupWindow<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>dc<font color="#000080">: </font>Hdc<font color="#000080">;
  </font>StringLength<font color="#000080">, </font>Count<font color="#000080">, </font>I<font color="#000080">: </font>Byte<font color="#000080">;

  </font>Tmp<font color="#000080">, </font>StringSize<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>lbString<font color="#000080">: </font>PChar<font color="#000080">;

</font><font color="#FF0000"><b>begin
  inherited </b></font>SetupWindow<font color="#000080">;
  </font>dc <font color="#000080">:= </font>GetDC<font color="#000080">(</font>hWindow<font color="#000080">);
  </font>StringLength <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#008000"><i>{Add strings to the list box.}
  </i></font>ListBox1<font color="#000080">^.</font>AddString<font color="#000080">(</font><font color="#800000">'This is line 1'</font><font color="#000080">);
  </font>ListBox1<font color="#000080">^.</font>AddString<font color="#000080">(</font><font color="#800000">'This is line 2, which is really long'</font><font color="#000080">);
  </font>ListBox1<font color="#000080">^.</font>AddString<font color="#000080">(</font><font color="#800000">'This is line 3'</font><font color="#000080">);
  </font>ListBox1<font color="#000080">^.</font>AddString<font color="#000080">(</font><font color="#800000">'This is line 4'</font><font color="#000080">);
  </font>ListBox1<font color="#000080">^.</font>AddString<font color="#000080">(</font><font color="#800000">'This is line 5'</font><font color="#000080">);
  </font>ListBox1<font color="#000080">^.</font>AddString<font color="#000080">(</font><font color="#800000">'This is line 6'</font><font color="#000080">);
  </font>ListBox1<font color="#000080">^.</font>AddString<font color="#000080">(</font><font color="#800000">'This is line 7'</font><font color="#000080">);

  </font>ListBox1<font color="#000080">^.</font>AddString<font color="#000080">(</font><font color="#800000">'This is line 8'</font><font color="#000080">);
  </font>ListBox1<font color="#000080">^.</font>AddString<font color="#000080">(</font><font color="#800000">'This is line 9'</font><font color="#000080">);
  </font><font color="#008000"><i>{Count the number of strings inside the list box.}
  </i></font>Count <font color="#000080">:= </font>ListBox1<font color="#000080">^.</font>GetCount<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Count <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>GetMem<font color="#000080">(</font>lbString<font color="#000080">, </font><font color="#800000">255</font><font color="#000080">);
    </font><font color="#008000"><i>{Look at each string in the list box and determine
     the size of the largest one.}
    </i></font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Count <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      </b></font>StringSize <font color="#000080">:= </font>ListBox1<font color="#000080">^.</font>GetString<font color="#000080">(</font>lbString<font color="#000080">, </font>I<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>StringSize <font color="#000080">&lt;= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
        </b></font>MessageBox<font color="#000080">(</font>HWindow<font color="#000080">, </font><font color="#800000">'An error occured extracting string'</font><font color="#000080">,

        </font><font color="#800000">'ERROR'</font><font color="#000080">,</font>mb_Ok <font color="#FF0000"><b>or </b></font>mb_IconExclamation<font color="#000080">);
        </font>Break<font color="#000080">;
      </font><font color="#FF0000"><b>end
      else
      begin
        </b></font><font color="#008000"><i>{The lo word return from GetTextExtent holds the width
         in pixels of the string.}
        </i></font>Tmp <font color="#000080">:= </font>loWord<font color="#000080">(</font>GetTextExtent<font color="#000080">(</font>dc<font color="#000080">, </font>lbString<font color="#000080">, </font>StringSize<font color="#000080">));
        </font><font color="#FF0000"><b>if </b></font>Tmp <font color="#000080">&gt; </font>StringLength <font color="#FF0000"><b>then
          </b></font>StringLength <font color="#000080">:= </font>Tmp<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>FreeMem<font color="#000080">(</font>lbString<font color="#000080">, </font><font color="#800000">255</font><font color="#000080">);
    </font><font color="#008000"><i>{Add one upper case character length to the total length of
    the largest string length .  This allows the list box to

    scroll just beyond the last character in the larges string.}
    </i></font>inc<font color="#000080">(</font>StringLength<font color="#000080">, </font>LoWord<font color="#000080">(</font>GetTextExtent<font color="#000080">(</font>dc<font color="#000080">, </font><font color="#800000">'X'</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">)));
    </font><font color="#008000"><i>{Send a lb_SetHorizontalExtent to the list box.}
    </i></font>SendMessage<font color="#000080">(</font>ListBox1<font color="#000080">^.</font>HWindow<font color="#000080">, </font>lb_SetHorizontalExtent<font color="#000080">,
                </font>StringLength<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end
  else
    </b></font>MessageBox<font color="#000080">(</font>HWindow<font color="#000080">, </font><font color="#800000">'An error occured.  The list box
     </font>has no strings <font color="#FF0000"><b>in </b></font>it<font color="#000080">.</font><font color="#800000">','</font>ERROR<font color="#800000">', mb_Ok or mb_IconExclamation);
  </font>ReleaseDC<font color="#000080">(</font>hWindow<font color="#000080">, </font>dc<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>THListBox<font color="#000080">.</font>SetupWindow<font color="#000080">;

</font><font color="#FF0000"><b>begin
    inherited </b></font>SetupWindow<font color="#000080">;
    </font>Attr<font color="#000080">.</font>Style <font color="#000080">:= </font>Attr<font color="#000080">.</font>Style <font color="#FF0000"><b>or </b></font>WS_HSCROLL<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TMainWindow<font color="#000080">.</font>Init <font color="#000080">(</font>AParent<font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>ATitle<font color="#000080">: </font>PChar<font color="#000080">);
</font><font color="#FF0000"><b>begin
  Inherited </b></font>Init <font color="#000080">(</font>AParent<font color="#000080">, </font>ATitle<font color="#000080">);
  </font>ListBox1 <font color="#000080">:= </font>New<font color="#000080">(</font>PHListBox<font color="#000080">, </font>Init<font color="#000080">(@</font>Self<font color="#000080">, </font>id_ListBox1<font color="#000080">,
                   </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">120</font><font color="#000080">, </font><font color="#800000">100</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ListBoxApp<font color="#000080">.</font>InitMainWindow<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MainWindow <font color="#000080">:= </font>New<font color="#000080">(</font>PMainWindow<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,
                    </font><font color="#800000">'Example of a Horizontal Scrolling List Box'</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var

  </b></font>MyApplication<font color="#000080">: </font>ListBoxApp<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>MyApplication<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#800000">'Min'</font><font color="#000080">);
  </font>MyApplication<font color="#000080">.</font>Run<font color="#000080">;
  </font>MyApplication<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p></body>
</html>
