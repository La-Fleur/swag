<html>
<head><title> "Center Dialog" by DANIEL THOMAS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>Center<font color="#000080">;
</font><font color="#008000"><i>{**************************************************************************}
{*    Center   by Daniel Thomas  CIS 72301,2164                           *}
{*                                                                        *}
{*  This code is hereby donated to the public domain.  Enjoy.             *}
{*                                                                        *}
{*  This unit contains a procedure, CenterPopup, which will center a      *}
{*  Popup window (i.e. a dialog) in it's parent's window.  If it won't    *}
{*  fit inside the parent's window, then it will be centered on top of    *}
{*  the parent.                                                           *}
{*                                                                        *}
{*  Also, if the dialog would be positioned off the screen, it is forced  *}
{*  within the visible screen.                                            *}
{*                                                                        *}
{*  There are a few descendant objects - tCenteredDialog and              *}
{*  tCenteredInputDialog - that make using it a snap.  Just replace an    *}
{*  occurrance of pDialog with pCenteredDialog, and you've got a centered *}
{*  dialog!                                                               *}
{**************************************************************************}

</i></font><font color="#FF0000"><b>Interface

USES </b></font>WinTypes<font color="#000080">,</font>WinProcs<font color="#000080">,</font>WObjects<font color="#000080">,</font>StdDlgs<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>pInteger<font color="#000080">=^</font>integer<font color="#000080">;

  </font>pCenteredDialog<font color="#000080">=^</font>tCenteredDialog<font color="#000080">;
  </font>tCenteredDialog<font color="#000080">=</font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>tDialog<font color="#000080">)
      </font><font color="#FF0000"><b>Procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>pCenteredInputDialog<font color="#000080">=^</font>tCenteredInputDialog<font color="#000080">;
  </font>tCenteredInputDialog<font color="#000080">=</font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>tInputDialog<font color="#000080">)
      </font><font color="#FF0000"><b>Procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CenterPopup<font color="#000080">(</font>aPopup<font color="#000080">,</font>aParent<font color="#000080">: </font>hWnd<font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Procedure </b></font>CenterPopup<font color="#000080">(</font>aPopup<font color="#000080">,</font>aParent<font color="#000080">: </font>hWnd<font color="#000080">);

</font><font color="#FF0000"><b>var
  </b></font>PopupR<font color="#000080">,</font>ParentR  <font color="#000080">: </font>tRect<font color="#000080">;
  </font>ScreenW<font color="#000080">,</font>ScreenH <font color="#000080">: </font>integer<font color="#000080">;
  </font>x<font color="#000080">,</font>y<font color="#000080">,
  </font>PopupW<font color="#000080">,</font>PopupH<font color="#000080">,
  </font>ParentW<font color="#000080">,</font>ParentH <font color="#000080">: </font>word<font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>SetupValues<font color="#000080">(</font>Wnd<font color="#000080">: </font>hWnd<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>R<font color="#000080">: </font>tRect<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>W<font color="#000080">,</font>H <font color="#000080">: </font>word<font color="#000080">);
    </font><font color="#FF0000"><b>begin
      </b></font>GetWindowRect<font color="#000080">(</font>Wnd<font color="#000080">,</font>R<font color="#000080">);
      </font>W <font color="#000080">:= </font>R<font color="#000080">.</font>Right<font color="#000080">-</font>R<font color="#000080">.</font>Left<font color="#000080">;
      </font>H <font color="#000080">:= </font>R<font color="#000080">.</font>Bottom<font color="#000080">-</font>R<font color="#000080">.</font>Top<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{SetupValues}

  </i></font><font color="#FF0000"><b>procedure </b></font>SetupLocation<font color="#000080">(</font>PopupSize<font color="#000080">,</font>ScreenSize<font color="#000080">,</font>ParentSize<font color="#000080">,</font>ParentStart <font color="#000080">: </font>word<font color="#000080">;
                          </font><font color="#FF0000"><b>var </b></font>PopupStart<font color="#000080">: </font>word<font color="#000080">);
    </font><font color="#FF0000"><b>begin
      if </b></font>PopupSize <font color="#000080">&gt; </font>ScreenSize <font color="#FF0000"><b>then
        </b></font>PopupStart <font color="#000080">:= </font><font color="#800000">0
      </font><font color="#FF0000"><b>else
        begin
          if </b></font>PopupSize <font color="#000080">&lt;= </font>ParentSize <font color="#FF0000"><b>then
            </b></font>PopupStart <font color="#000080">:= </font>ParentStart<font color="#000080">+((</font>ParentSize<font color="#000080">-</font>PopupSize<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">)
          </font><font color="#FF0000"><b>else
            </b></font>PopupStart <font color="#000080">:= </font>ParentStart<font color="#000080">-((</font>PopupSize<font color="#000080">-</font>ParentSize<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>PopupStart <font color="#000080">&gt; </font>ScreenSize <font color="#FF0000"><b>then
            </b></font>PopupStart <font color="#000080">:= </font><font color="#800000">0
          </font><font color="#FF0000"><b>else
          if </b></font>PopupStart<font color="#000080">+</font>PopupSize <font color="#000080">&gt; </font>ScreenSize <font color="#FF0000"><b>then
            </b></font>PopupStart <font color="#000080">:= </font>ScreenSize<font color="#000080">-</font>PopupSize<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{SetupLocation}

</i></font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{CenterPopup}
  </i></font>ScreenW <font color="#000080">:= </font>GetSystemMetrics<font color="#000080">(</font>sm_CXScreen<font color="#000080">);
  </font>ScreenH <font color="#000080">:= </font>GetSystemMetrics<font color="#000080">(</font>sm_CYScreen<font color="#000080">);
  </font>SetupValues<font color="#000080">(</font>aPopup<font color="#000080">,</font>PopupR<font color="#000080">,</font>PopupW<font color="#000080">,</font>PopupH<font color="#000080">);
  </font>SetupValues<font color="#000080">(</font>aParent<font color="#000080">,</font>ParentR<font color="#000080">,</font>ParentW<font color="#000080">,</font>ParentH<font color="#000080">);
  </font>SetupLocation<font color="#000080">(</font>PopupW<font color="#000080">,</font>ScreenW<font color="#000080">,</font>ParentW<font color="#000080">,</font>ParentR<font color="#000080">.</font>Left<font color="#000080">,</font>x<font color="#000080">);
  </font>SetupLocation<font color="#000080">(</font>PopupH<font color="#000080">,</font>ScreenH<font color="#000080">,</font>ParentH<font color="#000080">,</font>ParentR<font color="#000080">.</font>Top<font color="#000080">,</font>y<font color="#000080">);
  </font>MoveWindow<font color="#000080">(</font>aPopup<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>PopupW<font color="#000080">,</font>PopupH<font color="#000080">,</font>false<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{CenterPopup}

</i></font><font color="#FF0000"><b>Procedure </b></font>tCenteredDialog<font color="#000080">.</font>SetupWindow<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>tDialog<font color="#000080">.</font>SetupWindow<font color="#000080">;
  </font>CenterPopup<font color="#000080">(</font>HWindow<font color="#000080">, </font>Parent<font color="#000080">^.</font>HWindow<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{tAniOptionsDialog.SetupWindow}

</i></font><font color="#FF0000"><b>Procedure </b></font>tCenteredInputDialog<font color="#000080">.</font>SetupWindow<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>tInputDialog<font color="#000080">.</font>SetupWindow<font color="#000080">;
  </font>CenterPopup<font color="#000080">(</font>HWindow<font color="#000080">, </font>Parent<font color="#000080">^.</font>HWindow<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{tAniOptionsDialog.SetupWindow}



</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p></body>
</html>
