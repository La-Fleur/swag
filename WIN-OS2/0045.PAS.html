<html>
<head><title> "64k TPW/OWL 64k Edit Control" by BRAD MILLARD</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: jmillard@nmsu.edu (James B. Millard)
I'll post this again.  This is my TPW/OWL version of the 64k edit control.
I had to override the Create procedure (I also had to bring the
AttachProperties procedure out of odialogs...).  I have put slightly more
than 64k in this edit control.
}

</i></font><font color="#FF0000"><b>Function </b></font>TEditEx<font color="#000080">.</font>Create<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>HParent            <font color="#000080">: </font>HWnd<font color="#000080">;
    </font>EditDS<font color="#000080">, </font>AInstance  <font color="#000080">: </font>THandle<font color="#000080">;
    </font>EditDSPtr          <font color="#000080">: </font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>DisableAutoCreate<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Parent<font color="#000080">=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>HParent<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>Else </b></font>HParent<font color="#000080">:=</font>Parent<font color="#000080">^.</font>HWindow<font color="#000080">;
   </font>EditDS<font color="#000080">:=</font>GlobalAlloc<font color="#000080">(</font>GMEM_DDEShare <font color="#FF0000"><b>OR </b></font>GMEM_Moveable <font color="#FF0000"><b>OR </b></font>GMEM_ZeroInit<font color="#000080">, </font><font color="#800000">4096</font><font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>EditDS<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>AInstance<font color="#000080">:=</font>HInstance
   <font color="#FF0000"><b>Else Begin
      </b></font>EditDSPtr<font color="#000080">:=</font>GlobalLock<font color="#000080">(</font>EditDS<font color="#000080">);
      </font>LocalInit<font color="#000080">(</font>HiWord<font color="#000080">(</font>LongInt<font color="#000080">(</font>EditDSPtr<font color="#000080">)), </font><font color="#800000">16</font><font color="#000080">, </font>Word<font color="#000080">(</font>GlobalSize<font color="#000080">(</font>EditDS<font color="#000080">)-</font><font color="#800000">16</font><font color="#000080">));
      </font>UnlockSegment<font color="#000080">(</font>HiWord<font color="#000080">(</font>LongInt<font color="#000080">(</font>EditDSPtr<font color="#000080">)));
      </font>AInstance<font color="#000080">:=</font>HiWord<font color="#000080">(</font>LongInt<font color="#000080">(</font>EditDSPtr<font color="#000080">));
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If Register Then With </b></font>Attr <font color="#FF0000"><b>Do </b></font>CreateWindowEx<font color="#000080">(</font>ExStyle<font color="#000080">, </font>GetClassName<font color="#000080">, </font>Title<font color="#000080">,
    </font>Style<font color="#000080">, </font>X<font color="#000080">, </font>Y<font color="#000080">, </font>W<font color="#000080">, </font>H<font color="#000080">, </font>HParent<font color="#000080">, </font>Id<font color="#000080">, </font>AInstance<font color="#000080">, </font>Param<font color="#000080">);
   </font>HWindow<font color="#000080">:=</font>GetDlgItem<font color="#000080">(</font>HParent<font color="#000080">, </font>Attr<font color="#000080">.</font>ID<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>HWindow<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Status<font color="#000080">:=</font>em_InvalidWindow
   <font color="#FF0000"><b>Else If </b></font><font color="#000080">(</font>GetObjectPtr<font color="#000080">(</font>HWindow<font color="#000080">)=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>Then Begin
      </b></font>AttachProperties<font color="#000080">(</font>HWindow<font color="#000080">, @</font>Self<font color="#000080">);
      </font>DefaultProc<font color="#000080">:=</font>TFarProc<font color="#000080">(</font>SetWindowLong<font color="#000080">(</font>HWindow<font color="#000080">, </font>gwl_WndProc<font color="#000080">,
</font>LongInt<font color="#000080">(</font>Instance<font color="#000080">)));
      </font>SetupWindow<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>Create<font color="#000080">:=(</font>Status<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">);
   </font>SendMessage<font color="#000080">(</font>HWindow<font color="#000080">, </font>em_LimitText<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p></body>
</html>
