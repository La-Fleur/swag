<html>
<head><title> "Booting under Windows" by MICHAEL CROSSLEY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0093.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{Casting my eye down the WIN-OS2 snippets of SWAG I noticed an entry:-
	Booting under Windows
submitted in November '93 by Frank Young. It seemed a rather long winded
way of performing a reboot under Windows as there is a very versatile
API call to do this job.

The program presented here demonstrates the use of ExitWindows() - do a
Topic search in the Borland Windows IDE for details, but note the comment
below.

This program doesn't do very much - compile and run it then press the
right mouse button in the main window.}

{From: M. G. Crossley, U.K. 2nd March 1997. email: mike_crossley@msn.com}

</i></font><font color="#FF0000"><b>program </b></font>DoReboot<font color="#000080">;
</font><font color="#008000"><i>{Borland Pascal Object Windows Version 7.0}
</i></font><font color="#FF0000"><b>uses
  </b></font>Wintypes<font color="#000080">,
  </font>Winprocs<font color="#000080">,
  </font>OWindows<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TRebootApp <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>InitMainWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PRebootWin <font color="#000080">= ^</font>TRebootWin<font color="#000080">;
  </font>TRebootWin <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TWindow<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>Reboot<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>wm_First <font color="#000080">+ </font>wm_RButtonDown<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TRebootWin<font color="#000080">.</font>Reboot<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>const
  </b></font>ew_RebootSystem <font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">$43</font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>MessageBox<font color="#000080">(</font>hWindow<font color="#000080">,</font><font color="#800000">'Do you want to reboot?'</font><font color="#000080">,</font><font color="#800000">'Reboot Now?'</font><font color="#000080">,</font>mb_YesNo<font color="#000080">) = 
</font>idYes
  <font color="#FF0000"><b>then
    </b></font><font color="#008000"><i>{Please note that the BORLAND help for ExitWindows() shows the formal
     parameters transposed - well it does on mine!}

    </i></font>ExitWindows<font color="#000080">(</font>ew_RebootSystem<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">) </font><font color="#008000"><i>{****** This is it! ******}

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{TRebootWin.Reboot}

</i></font><font color="#FF0000"><b>procedure </b></font>TRebootApp<font color="#000080">.</font>InitMainWindow<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MainWindow <font color="#000080">:= </font>New<font color="#000080">(</font>PRebootWin<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#800000">'Press the RIGHT mouse button'</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{TRebootApp.InitMainWindow}

</i></font><font color="#FF0000"><b>var
  </b></font>RebootApp <font color="#000080">: </font>TRebootApp<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>RebootApp<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#800000">'Reboot'</font><font color="#000080">);
  </font>RebootApp<font color="#000080">.</font>Run<font color="#000080">;
  </font>RebootApp<font color="#000080">.</font>Done
<font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0093.PAS">Original</a><b>]</b></p></body>
</html>
