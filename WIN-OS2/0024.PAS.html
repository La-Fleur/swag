<html>
<head><title> "32bit Protected Mode" by MORTEN WELINDER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;What you *can* do is these things.

&gt;1. You can modify the limit of a selector from $0000FFFF to
&gt;   $xxxxFFFF so assembler code can use 32-bit addressing.
&gt;   Note that you may not change the lower 16-bit of the limit
&gt;   field, or else the DPMI server crashes.

&gt;2. You can compile a 32-bit assembler procedure into your
&gt;   program.  It just needs a tiny (16 byte) wrapper and must
&gt;   reside in the low 64K of a segment (or else interrupts
&gt;   cannot return correctly).  However, the BP linker does
&gt;   not support 32-bit fixups so there are limits as to what
&gt;   you can put into the assembler code.

&gt;3. If you are willing to give up assembler access to BP
&gt;   variables, then you can make a binary image and link
&gt;   that into your program.  Then you can do whatever pleases
&gt;   you in the assembler procedure.

&gt;If there is interrest, I could post an example routine showing
&gt;this.

Three files are needed: a batch file for assembly, an assembler
file with 32-bit code, and a pascal test program.  The test
program is not supposed to do anything useful.

The code is unsupported.  You must know what you're doing.
You'll need the `exe2bin' or `exetobin' utility; you'll need
BP7 (with Turbo Assembler, and you cannot use TP7).  You must
be using Borland's DPMI or some DPMI that supports 32-bit
programs.  Don't even think about running this on a 286.  When
things go wrong it's not my fault.  Don't tell me you know a
better way to get the segment limit, because so do I.

Morten Welinder
terra@diku.dk

{ THE BATCH FILE }
{ CUT HERE }
{***************************************************************************}

</i></font><font color="#000080">@</font>Echo Off
Tasm <font color="#000080">/</font>M2 <font color="#000080">/</font>T <font color="#000080">/</font>L Test32
<font color="#FF0000"><b>If Not </b></font>Exist Test32<font color="#000080">.</font>Obj <font color="#FF0000"><b>Goto End
</b></font>Tlink <font color="#000080">/</font>x test32 <font color="#000080">&gt;</font>Nul
Exe2bin Test32<font color="#000080">.</font>Exe Test32<font color="#000080">.</font>Bin
Rem Del Test32<font color="#000080">.</font>Exe
Del Test32<font color="#000080">.</font>Obj
<font color="#000080">:</font><font color="#FF0000"><b>End

</b></font><font color="#008000"><i>{ THE ASSEMBLER PROGRAM }
{ CUT HERE }
{***************************************************************************}

</i></font><font color="#000080">; ---------------------------------------------------------------------------
; </font>Example <font color="#800000">32 </font>bit <font color="#FF0000"><b>program for </b></font>use <font color="#FF0000"><b>with </b></font>Borland <font color="#FF0000"><b>Pascal </b></font><font color="#800000">7.0
</font><font color="#000080">; ---------------------------------------------------------------------------
</font>Ideal                                  <font color="#000080">; (</font>Keep Tasm happy<font color="#000080">)
</font>P386
Model Use32 Huge<font color="#000080">,</font><font color="#FF0000"><b>Pascal
</b></font>Segment Code Use32
Assume  Cs<font color="#000080">:</font>Code
<font color="#000080">; ---------------------------------------------------------------------------
</font>Entry0<font color="#000080">:  </font>Movzx Eax<font color="#000080">,[</font>Word Esp<font color="#000080">]          ; </font>Change the stack frame <font color="#FF0000"><b>to </b></font><font color="#800000">32 </font>bits
         <font color="#FF0000"><b>Shr   </b></font><font color="#000080">[</font>Dword Esp<font color="#000080">],</font><font color="#800000">16          </font><font color="#000080">; </font>so <font color="#000080">[</font>Esp<font color="#000080">+</font>xxx<font color="#000080">] </font>works <font color="#FF0000"><b>as </b></font>expected<font color="#000080">.
         </font>Push  Eax
         Jmp   P0
Align <font color="#800000">10</font>h
Entry1<font color="#000080">:  </font>Movzx Eax<font color="#000080">,[</font>Word Esp<font color="#000080">]          ; </font>Aligned <font color="#800000">10</font>h <font color="#FF0000"><b>for </b></font>speed<font color="#000080">.
         </font><font color="#FF0000"><b>Shr   </b></font><font color="#000080">[</font>Dword Esp<font color="#000080">],</font><font color="#800000">16
         </font>Push  Eax
         Jmp   P1
Align <font color="#800000">10</font>h
Entry2<font color="#000080">:  </font>Movzx Eax<font color="#000080">,[</font>Word Esp<font color="#000080">]          ; </font>Aligned <font color="#800000">10</font>h <font color="#FF0000"><b>for </b></font>speed<font color="#000080">.
         </font><font color="#FF0000"><b>Shr   </b></font><font color="#000080">[</font>Dword Esp<font color="#000080">],</font><font color="#800000">16
         </font>Push  Eax
         Jmp   P2
<font color="#000080">; </font>etc<font color="#000080">.
; ---------------------------------------------------------------------------
</font>Align <font color="#800000">10</font>h
Proc P0 <font color="#FF0000"><b>Far </b></font>L1<font color="#000080">:</font>Dword<font color="#000080">,</font>L2<font color="#000080">:</font>Dword
         Mov   Eax<font color="#000080">,[</font>L1<font color="#000080">]                ; </font>Add the parameters
         Add   Eax<font color="#000080">,[</font>L2<font color="#000080">]

         </font>Shld  Edx<font color="#000080">,</font>Eax<font color="#000080">,</font><font color="#800000">16              </font><font color="#000080">; </font>Output <font color="#FF0000"><b>is </b></font>left <font color="#FF0000"><b>in </b></font>Dx<font color="#000080">:</font>Ax
         Ret
Endp
<font color="#000080">; ---------------------------------------------------------------------------
</font>Align <font color="#800000">10</font>h
Proc P1 <font color="#FF0000"><b>Far
         </b></font>Push  Ds                      <font color="#000080">; </font>Call MsDos from a <font color="#800000">32 </font>bit segment
         Mov   Ax<font color="#000080">,</font>Cs                   <font color="#000080">; </font>Never ever perform a software
         Mov   Ds<font color="#000080">,</font>Ax                   <font color="#000080">; </font>interrupt <font color="#FF0000"><b>if </b></font>Ip<font color="#000080">&gt;=</font><font color="#800000">64</font>K<font color="#000080">!
         </font>Mov   Ah<font color="#000080">,</font><font color="#800000">9
         </font>Mov   Edx<font color="#000080">,</font>Offset <font color="#FF0000"><b>Message
         </b></font>Int   <font color="#800000">21</font>h
         Pop   Ds
         Ret

<font color="#FF0000"><b>Message  </b></font>Db    <font color="#800000">'Hello, 32 bit world!'</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">'$'
</font>Endp
<font color="#000080">; ---------------------------------------------------------------------------
</font>Align <font color="#800000">10</font>h
Proc P2 <font color="#FF0000"><b>Far </b></font>P<font color="#000080">:</font>Dword
         Push  Ds
         <font color="#FF0000"><b>Xor   </b></font>Esi<font color="#000080">,</font>Esi
         Lds   Si<font color="#000080">,[</font>Small P<font color="#000080">]
         </font>Mov   Ecx<font color="#000080">,</font><font color="#800000">20000</font>h<font color="#000080">/</font><font color="#800000">4
  </font><font color="#000080">@@</font><font color="#800000">1</font><font color="#000080">:   </font>Mov   <font color="#000080">[</font>Esi<font color="#000080">],</font>Esi
         Add   Esi<font color="#000080">,</font><font color="#800000">4
         </font>Loop  <font color="#000080">@@</font><font color="#800000">1
         </font>Pop   Ds
         Ret
Endp
<font color="#000080">; ---------------------------------------------------------------------------
</font>Ends
<font color="#FF0000"><b>End

</b></font><font color="#008000"><i>{ THE TEST PROGRAM }
{ CUT HERE }
{***************************************************************************}

</i></font><font color="#FF0000"><b>Program   </b></font>Test<font color="#000080">;
</font><font color="#008000"><i>{ ------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Uses      </b></font>Winapi<font color="#000080">, </font>Dos<font color="#000080">;
</font><font color="#008000"><i>{ ------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Const     </b></font>Dpmi_32BitSegment           <font color="#000080">= </font><font color="#800000">$4000</font><font color="#000080">;

</font><font color="#FF0000"><b>Type      </b></font>Dpmi_Descriptor             <font color="#000080">= </font><font color="#FF0000"><b>Record
            </b></font>Limit0015                 <font color="#000080">: </font>Word<font color="#000080">;
            </font>Base0015                  <font color="#000080">: </font>Word<font color="#000080">;
            </font>Base1623                  <font color="#000080">: </font>Byte<font color="#000080">;
            </font>Rights                    <font color="#000080">: </font>Byte<font color="#000080">;   </font><font color="#008000"><i>{ 7=Prsnt, 6-5=Dpl, 4=App,  }
                                                { 3-0=Type                  }
            </i></font>Rights386                 <font color="#000080">: </font>Byte<font color="#000080">;   </font><font color="#008000"><i>{ 7=Gran, 6=Size32, 5=0,    }
                                                { 4=Avail, 3-0=Limit1619    }
            </i></font>Base2431                  <font color="#000080">: </font>Byte<font color="#000080">;
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var       </b></font>Sel      <font color="#000080">: </font>Word<font color="#000080">;
          </font>Oldright <font color="#000080">: </font>Word<font color="#000080">;
          </font>ProcPtr  <font color="#000080">: </font>Pointer<font color="#000080">;
          </font>P1       <font color="#000080">: </font><font color="#FF0000"><b>Function</b></font><font color="#000080">(</font>L1<font color="#000080">,</font>L2<font color="#000080">: </font>LongInt<font color="#000080">): </font>LongInt<font color="#000080">;
          </font>P2       <font color="#000080">: </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;
          </font>P3       <font color="#000080">: </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>P<font color="#000080">: </font>Pointer<font color="#000080">);
          </font>Fil      <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
          </font>Data     <font color="#000080">: </font>Pointer<font color="#000080">;
          </font>Dsel     <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ ------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Procedure </b></font>Dpmi_SetSelectorLimit<font color="#000080">(</font>Sel<font color="#000080">: </font>Word<font color="#000080">; </font>Limit<font color="#000080">: </font>LongInt<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm    </b></font><font color="#FF00FF">Mov   Ax,0008H
       Mov   Bx,[Sel]
       Mov   Dx,[Word Ptr Limit]
       Mov   Cx,[Word Ptr Limit+2]
       Int   31H
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{ ------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Procedure </b></font>Dpmi_GetDescriptor<font color="#000080">(</font>Sel<font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Buffer<font color="#000080">: </font>Dpmi_Descriptor<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm    </b></font><font color="#FF00FF">Mov   Ax,000Bh
       Mov   Bx,[Sel]
       Les   Di,[Buffer]
       Int   31H
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{ ------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Procedure </b></font>Dpmi_SetDescriptor<font color="#000080">(</font>Sel<font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Buffer<font color="#000080">: </font>Dpmi_Descriptor<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm    </b></font><font color="#FF00FF">Mov   Ax,000Ch
       Mov   Bx,[Sel]
       Les   Di,[Buffer]
       Int   31H
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{ ------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Function  </b></font>Dpmi_GetAccessRights<font color="#000080">(</font>Sel<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var       </b></font>Buffer <font color="#000080">: </font>Dpmi_Descriptor<font color="#000080">;
</font><font color="#FF0000"><b>Asm    </b></font><font color="#FF00FF">Mov   Bx,[Sel]
       Push  Bx
       Push  Ss
       Lea   Di,[Buffer]
       Push  Di
       Call  Dpmi_GetDescriptor
       Mov   Ax,[Word Ptr Buffer+5]
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{ ------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Procedure </b></font>Dpmi_SetAccessRights<font color="#000080">(</font>Sel<font color="#000080">: </font>Word<font color="#000080">; </font>Rights<font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var       </b></font>Buffer <font color="#000080">: </font>Dpmi_Descriptor<font color="#000080">;
</font><font color="#FF0000"><b>Asm    </b></font><font color="#FF00FF">Mov   Bx,[Sel]
       Lea   Di,[Buffer]
       Push  Bx
       Push  Ss
       Push  Di
       Push  Bx
       Push  Ss
       Push  Di
       Call  Dpmi_GetDescriptor
       Mov   Ax,[Word Ptr Buffer+5]
       And   Ax,8F00h
       Mov   Bx,[Rights]
       And   Bx,50Ffh
       Or    Ax,Bx
       Mov   [Word Ptr Buffer+5],Ax
       Call  Dpmi_SetDescriptor
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{ ------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Function  </b></font>Dpmi_GetSelectorLimit<font color="#000080">(</font>Sel<font color="#000080">: </font>Word<font color="#000080">): </font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var       </b></font>Buffer <font color="#000080">: </font>Dpmi_Descriptor<font color="#000080">;
</font><font color="#FF0000"><b>Asm    </b></font><font color="#FF00FF">Mov   Bx,[Sel]
       Push  Bx
       Push  Ss
       Lea   Di,[Buffer]
       Push  Di
       Call  Dpmi_GetDescriptor
       Mov   Dx,[Word Ptr Buffer+6]
       Mov   Ax,[Word Ptr Buffer]
       Test  Dl,80H
       Je    @@3
       Mov   Bx,Ax
       Mov   Cl,4
       Shr   Bx,Cl
       Mov   Cl,12
       Shl   Dx,Cl
       Shl   Ax,Cl
       Or    Dx,Bx
       Or    Ax,0Fffh
       Jmp   @@2
  @@3: And   Dx,0Fh
       Jmp   @@2
  @@1: Mov   Ax,0
       Mov   Dx,0
  @@2:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{ ------------------------------------------------------------------------- }
</i></font><font color="#FF0000"><b>Function </b></font>Int2HexN<font color="#000080">(</font>L<font color="#000080">: </font>LongInt<font color="#000080">; </font>N<font color="#000080">:</font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Const    </b></font>Digits <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char <font color="#000080">= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
</font><font color="#FF0000"><b>Var      </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>S<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>N<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Do Begin
    </b></font>S<font color="#000080">:=</font>Digits<font color="#000080">[</font>L <font color="#FF0000"><b>And </b></font><font color="#800000">$F</font><font color="#000080">]+</font>S<font color="#000080">;
    </font>Dec<font color="#000080">(</font>N<font color="#000080">);
    </font>L<font color="#000080">:=</font>L <font color="#FF0000"><b>Shr </b></font><font color="#800000">4</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Int2HexN<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }


</i></font><font color="#FF0000"><b>Begin
  </b></font>Data<font color="#000080">:=</font>GlobalallocPtr<font color="#000080">(</font>Gmem_Zeroinit<font color="#000080">,</font><font color="#800000">$20000</font><font color="#000080">);
  </font>Dsel<font color="#000080">:=</font>Seg<font color="#000080">(</font>Data<font color="#000080">^);
  </font>Dpmi_SetSelectorLimit<font color="#000080">(</font>Dsel<font color="#000080">,</font><font color="#800000">$1FFFF</font><font color="#000080">);

  </font>GetMem<font color="#000080">(</font>ProcPtr<font color="#000080">,</font><font color="#800000">$4000</font><font color="#000080">);
  </font>Assign<font color="#000080">(</font>Fil<font color="#000080">,</font><font color="#800000">'Test32.Bin'</font><font color="#000080">);
  </font>Reset<font color="#000080">(</font>Fil<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>BlockRead<font color="#000080">(</font>Fil<font color="#000080">,</font>ProcPtr<font color="#000080">^,</font>FileSize<font color="#000080">(</font>Fil<font color="#000080">));
  </font>Close<font color="#000080">(</font>Fil<font color="#000080">);
  </font>LongInt<font color="#000080">(@</font>P1<font color="#000080">):=(</font>LongInt<font color="#000080">(</font>ProcPtr<font color="#000080">)+</font><font color="#800000">0</font><font color="#000080">*</font><font color="#800000">16</font><font color="#000080">);
  </font>LongInt<font color="#000080">(@</font>P2<font color="#000080">):=(</font>LongInt<font color="#000080">(</font>ProcPtr<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">*</font><font color="#800000">16</font><font color="#000080">);
  </font>LongInt<font color="#000080">(@</font>P3<font color="#000080">):=(</font>LongInt<font color="#000080">(</font>ProcPtr<font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">*</font><font color="#800000">16</font><font color="#000080">);

  </font>Sel<font color="#000080">:=</font>Seg<font color="#000080">(</font>ProcPtr<font color="#000080">^);
  </font>Oldright<font color="#000080">:=</font>Dpmi_GetAccessRights<font color="#000080">(</font>Sel<font color="#000080">);
  </font>Dpmi_SetAccessRights<font color="#000080">(</font>Sel<font color="#000080">,(</font>Oldright <font color="#FF0000"><b>Or </b></font>Dpmi_32BitSegment<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#800000">$FFF1</font><font color="#000080">+</font><font color="#800000">$A</font><font color="#000080">);

  </font>Writeln<font color="#000080">(</font><font color="#800000">'Proc:   '</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>Sel<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>Ofs<font color="#000080">(</font>ProcPtr<font color="#000080">^),</font><font color="#800000">8</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Base:   '</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>Getselectorbase<font color="#000080">(</font>Sel<font color="#000080">),</font><font color="#800000">8</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Limit:  '</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>Dpmi_GetSelectorLimit<font color="#000080">(</font>Sel<font color="#000080">),</font><font color="#800000">8</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Rights: '</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>Dpmi_GetAccessRights<font color="#000080">(</font>Sel<font color="#000080">),</font><font color="#800000">4</font><font color="#000080">));
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Data:   '</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>Seg<font color="#000080">(</font>Data<font color="#000080">^),</font><font color="#800000">4</font><font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>Ofs<font color="#000080">(</font>Data<font color="#000080">^),</font><font color="#800000">8</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Base:   '</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>Getselectorbase<font color="#000080">(</font>Dsel<font color="#000080">),</font><font color="#800000">8</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Limit:  '</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>Dpmi_GetSelectorLimit<font color="#000080">(</font>Dsel<font color="#000080">),</font><font color="#800000">8</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Rights: '</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>Dpmi_GetAccessRights<font color="#000080">(</font>Dsel<font color="#000080">),</font><font color="#800000">4</font><font color="#000080">));
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Ss:Sp:  '</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>SSeg<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>SPtr<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">));

  </font>Writeln<font color="#000080">(</font><font color="#800000">'Result: '</font><font color="#000080">,</font>Int2HexN<font color="#000080">(</font>P1<font color="#000080">(</font><font color="#800000">$12345678</font><font color="#000080">,</font><font color="#800000">$87654321</font><font color="#000080">),</font><font color="#800000">8</font><font color="#000080">));
  </font>P2<font color="#000080">;
  </font>P3<font color="#000080">(</font>Data<font color="#000080">);

  </font>Dpmi_SetAccessRights<font color="#000080">(</font>Sel<font color="#000080">,</font>Oldright<font color="#000080">);
  </font>Dpmi_SetSelectorLimit<font color="#000080">(</font>Dsel<font color="#000080">,</font><font color="#800000">$FFFF</font><font color="#000080">);
  </font>GlobalfreePtr<font color="#000080">(</font>Data<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p></body>
</html>
