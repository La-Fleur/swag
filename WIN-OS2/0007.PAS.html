<html>
<head><title> ""About" box in Windows" by SCOTT SAMET</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
SCOTT SAMET

&gt; I have a program that is always an icon, but I want to add an &quot;about&quot;
&gt; command to it, to display a dialog box with info on the author and
&gt; the program. Anyone know how to do this or where info on it can be found?

All system menu commands, even those you add, are returned as wm_SysCommand
messages.  You need to check wParam to see if it's one of yours, and if not,
pass it to DefWndProc.
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>OWindows<font color="#000080">, </font>WinProcs<font color="#000080">, </font>WinTypes<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>cm_About <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>TMyApp <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>Procedure </b></font>InitMainWindow<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PMyWin <font color="#000080">= ^</font>TMyWin<font color="#000080">;
  </font>TMyWin <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>TWindow<font color="#000080">)
    </font><font color="#FF0000"><b>Procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>wmSysCommand<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>wm_First <font color="#000080">+ </font>wm_SysCommand<font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>wmQueryOpen<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>wm_First <font color="#000080">+ </font>wm_QueryOpen<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyApp<font color="#000080">.</font>InitMainWindow<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>MainWindow <font color="#000080">:= </font>New<font color="#000080">(</font>PMyWin<font color="#000080">, </font>Init <font color="#000080">(</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">, </font><font color="#800000">'Test Window'</font><font color="#000080">));
  </font><font color="#008000"><i>{ This gives the window a system menu with Move, Switch and Close }
  </i></font>PWindow<font color="#000080">(</font>MainWindow<font color="#000080">)^.</font>Attr<font color="#000080">.</font>Style <font color="#000080">:= </font>ws_Overlapped <font color="#FF0000"><b>or </b></font>ws_Sysmenu<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyWin<font color="#000080">.</font>SetupWindow<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>SysMenu<font color="#000080">: </font>hMenu<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>SysMenu <font color="#000080">:= </font>GetSystemMenu<font color="#000080">(</font>hWindow<font color="#000080">, </font>False<font color="#000080">);
  </font>AppendMenu<font color="#000080">(</font>SysMenu<font color="#000080">, </font>mf_Separator<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">);
  </font>AppendMenu<font color="#000080">(</font>SysMenu<font color="#000080">, </font>mf_String<font color="#000080">, </font>cm_About<font color="#000080">, </font><font color="#800000">'&amp;About'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyWin<font color="#000080">.</font>wmQueryOpen<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{ This keeps the window an icon at all times }
  </i></font>Msg<font color="#000080">.</font>Result <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyWin<font color="#000080">.</font>wmSysCommand<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  Case </b></font>Msg<font color="#000080">.</font>wParam <font color="#FF0000"><b>of
    </b></font>cm_About <font color="#000080">:
      </font>MessageBox<font color="#000080">(</font>hWindow<font color="#000080">, </font><font color="#800000">'About Text'</font><font color="#000080">, </font><font color="#800000">'About Box'</font><font color="#000080">, </font>mb_ok<font color="#000080">)
    </font><font color="#FF0000"><b>Else
      </b></font>DefWndProc <font color="#000080">(</font>Msg<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>App<font color="#000080">:  </font>TMyApp<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>CmdShow <font color="#000080">:= </font>sw_ShowMinimized<font color="#000080">;
  </font>App<font color="#000080">.</font>Init <font color="#000080">(</font><font color="#800000">'Test'</font><font color="#000080">);
  </font>App<font color="#000080">.</font>Run<font color="#000080">;
  </font>App<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to WIN-OS2 SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p></body>
</html>
