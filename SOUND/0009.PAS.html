<html>
<head><title> "SBVOICE.PAS" by AMIT MATHUR</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{---------------------------------------------------------------------------
                   Unit SBVoice (v1.10) For Turbo Pascal 6.0
       For interfacing With the SoundBlaster's digitized voice channel.
           Copyright (c) 1991, Amit K. Mathur, Windsor, Ontario.

                        By: Amit K. Mathur
                            3215 St. Patrick's Drive
                            Windsor, Ontario
                            N9E 3H2 CANADA
                        Ph: (519) 966-6924

 Networks:  RIME(tm) R/O -&gt;WinDSor, ILink (Shareware), NA-Net (Gaming),
            WWIVNet (#198@5950), or direct on NorthSTAR (519)735-1504.

 These routines are released to the public domain.  However I will gladly
 accept contributions towards further development of this and other products.
 Please send any changes or improvements my way.  and I'm interested in
 other SoundBlaster utilities and Programming tools.  Thanks in advance.
 --------------------------------------------------------------------------}

{$O+,F+}
{ Allow this Unit to Be Overlayed (doesn't affect Compilation if you decide
  not to overlay it), and Force Far calls.                                 }

</i></font><font color="#FF0000"><b>Unit </b></font>SBVoice<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses </b></font>MemAlloc<font color="#000080">;                                    </font><font color="#008000"><i>{ Memory Allocation Proc }

</i></font><font color="#FF0000"><b>Var
</b></font><font color="#008000"><i>{$ifNDEF NoSBVoiceArray}                          { to use your own        }
     </i></font>SoundFile<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">64000</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;          </font><font color="#008000"><i>{ whatever size you want }
{$endif}
     </i></font>sgSBDriver<font color="#000080">, </font>ofSBDriver<font color="#000080">: </font>Word<font color="#000080">;                </font><font color="#008000"><i>{ seg and ofs of Driver  }
     </i></font>SBDriver<font color="#000080">: </font>Pointer<font color="#000080">;                           </font><font color="#008000"><i>{ Pointer to the driver  }
     </i></font>StatusWord<font color="#000080">: </font>Word<font color="#000080">;                            </font><font color="#008000"><i>{ stores SB status       }
     </i></font>SBFound<font color="#000080">: </font>Boolean<font color="#000080">;                            </font><font color="#008000"><i>{ whether Init worked    }

</i></font><font color="#FF0000"><b>Procedure </b></font>loaddriver<font color="#000080">(</font>fi<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#008000"><i>{ Loads CT-VOICE.DRV into memory.  'fi' is the path to the driver.         }

</i></font><font color="#FF0000"><b>Procedure </b></font>closedriver<font color="#000080">;
</font><font color="#008000"><i>{ Clean up routine.  not Really necessary if your Program is over.         }

</i></font><font color="#FF0000"><b>Procedure </b></font>loadvoice<font color="#000080">(</font>f<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>start<font color="#000080">,</font>size<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#008000"><i>{ Load 'f' into memory.  Start is the start of the area within
  'f' to load and size is the amount to laod.  if you set size to 0
  then it will load the entire File.                                      }

</i></font><font color="#FF0000"><b>Function </b></font>sb_getversion<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#008000"><i>{ Get the version number of the CT-VOICE.DRV
  Returns the Version number                                              }

</i></font><font color="#FF0000"><b>Function </b></font>sb_init<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#008000"><i>{ Initialize the SoundBlaster.  Call this right after load driver, unless
  you have to change the BaseIOAddress or Interrupt number and haven't
  changed the CT-VOICE.DRV File itself.
  Returns:  0 - no problem
            1 - Sound card failiure
            2 - I/O failiure
            3 - DMA interrupt failiure                                    }

</i></font><font color="#FF0000"><b>Procedure </b></font>sb_output<font color="#000080">(</font>sg<font color="#000080">,</font>os<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#008000"><i>{ Output the digitized Sound.  You must load the Sound first!
  sg and os are the segment and offset of either SoundFile or whatever
  Array you use to store the Sound.  if you use a .VOC File then call
  With 26 added to the offset.                                            }

</i></font><font color="#FF0000"><b>Procedure </b></font>sb_setstatusWord<font color="#000080">(</font>sg<font color="#000080">,</font>os<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#008000"><i>{ Sets the location of the status Word.  This is the third thing you should
  do, after loading the driver and initializing it.
  The StatusWord will contain $0FFFF if input/output is in output, and
  0 when it's done.  It will also hold the values of the markers in voice
  Files if any are encounterred, allowing you to coordinate output with
  your Programs.                                                          }

</i></font><font color="#FF0000"><b>Procedure </b></font>sb_speaker<font color="#000080">(</font>mode<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#008000"><i>{ Set the speaker on/off.  off is mode 0, and On is anything else.  This
  is the fourth thing you should do in your initialization.               }

</i></font><font color="#FF0000"><b>Procedure </b></font>sb_uninstall<font color="#000080">;
</font><font color="#008000"><i>{ Uninstall the driver from memory.   Used by CloseDriver.                }

</i></font><font color="#FF0000"><b>Procedure </b></font>sb_setIOaddress<font color="#000080">(</font>add<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#008000"><i>{ Override the IOaddress found inside the CT-VOICE.DRV File.  Add is the
  new IO address.                                                         }

</i></font><font color="#FF0000"><b>Procedure </b></font>sb_setinterruptnumber<font color="#000080">(</font>intno<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#008000"><i>{ Allows you to override the Interrupt number in the driver.  IntNo is your
  new interrupt number (3, 5, 7 or 9).                                    }

</i></font><font color="#FF0000"><b>Procedure </b></font>sb_stopoutput<font color="#000080">;
</font><font color="#008000"><i>{ Stops the output in progress                                            }

</i></font><font color="#FF0000"><b>Function </b></font>sb_pauseoutput<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#008000"><i>{ PaUses the output in progress.
  Returns:  0 - success
            1 - fail                                                      }

</i></font><font color="#FF0000"><b>Function </b></font>sb_continueoutput<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#008000"><i>{ Continues a paused output.
  Returns:  0 - success
            1 - fail (nothing to continue)                                }

</i></font><font color="#FF0000"><b>Function </b></font>sb_breakloop<font color="#000080">(</font>mode<font color="#000080">:</font>Word<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#008000"><i>{ Breaks out of the currect output loop.
  Modes:  0 - continue round, stop when done
          1 - stop immediately
  Returns:  0 - success
            1 - not in loop                                               }

</i></font><font color="#FF0000"><b>Procedure </b></font>sb_input<font color="#000080">(</font>highlength<font color="#000080">,</font>lowlength<font color="#000080">,</font>seginputbuff<font color="#000080">,</font>ofsinputbuff<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#008000"><i>{ Input digitized Sound.
  HighLength: The high Byte of the length of the input buffer.
  LowLength:  The low Byte of the length of the input buffer.
  SegInputBuff: The Segment of the start of the input buffer.
  ofsInputBuff: The offset of the start of the input buffer.              }

</i></font><font color="#FF0000"><b>Procedure </b></font>sb_setuserFunction<font color="#000080">(</font>segaddress<font color="#000080">,</font>ofsaddress<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#008000"><i>{ Sets up a user Function that the SB calls when it encounters a new data
  block.  It must perForm a Far ret, preserve DS,DI,SI and flag register.
  Clear Carry flag if you want the driver to process the block, or set it
  if your routine will.  It must be clear if the block Type is 0, that
  is the terminate block.
  SegAddress is the segment of your user Function in memory.
  ofsAddress is the ofset of your user Function in memory.                }

</i></font><font color="#FF0000"><b>Implementation

Uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Abort<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'The Following Error Has Occurred: '</font><font color="#000080">,</font>s<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Remedy and try again.  We apologize For any inconvenience.'</font><font color="#000080">);
  </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>loaddriver<font color="#000080">(</font>fi<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>f<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
    </font>k<font color="#000080">: </font>Integer<font color="#000080">;
    </font>t<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];
</font><font color="#FF0000"><b>begin
    </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>fi<font color="#000080">+</font><font color="#800000">'CT-VOICE.DRV'</font><font color="#000080">);
    </font><font color="#008000"><i>{$I-} </i></font>Reset<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>if </b></font>Ioresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>Abort<font color="#000080">(</font><font color="#800000">'Cannot Open '</font><font color="#000080">+</font>fi<font color="#000080">+</font><font color="#800000">'CT-VOICE.DRV'</font><font color="#000080">);
    </font>blockread<font color="#000080">(</font>f<font color="#000080">,</font>Mem<font color="#000080">[</font>sgSBDriver<font color="#000080">:</font>ofSBDriver<font color="#000080">],</font>Filesize<font color="#000080">(</font>f<font color="#000080">));
    </font>close<font color="#000080">(</font>f<font color="#000080">);
    </font>t<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>k<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
        </b></font>t<font color="#000080">:=</font>t<font color="#000080">+</font>chr<font color="#000080">(</font>Mem<font color="#000080">[</font>sgSBDriver<font color="#000080">:</font>ofSBDriver<font color="#000080">+</font>k<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font>t<font color="#000080">&lt;&gt;</font><font color="#800000">'CT-VOICE' </font><font color="#FF0000"><b>then
        </b></font>abort<font color="#000080">(</font><font color="#800000">'Invalid CT-VOICE Driver!'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>closedriver<font color="#000080">;
</font><font color="#FF0000"><b>begin
    </b></font>sb_uninstall<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>dalloc<font color="#000080">(</font>sbdriver<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>abort<font color="#000080">(</font><font color="#800000">'Uninstall Error!'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>loadvoice<font color="#000080">(</font>f<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>start<font color="#000080">,</font>size<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>fi<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
    </font>k<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
    </b></font>assign<font color="#000080">(</font>fi<font color="#000080">,</font>f<font color="#000080">);
    </font><font color="#008000"><i>{$I-} </i></font>Reset<font color="#000080">(</font>fi<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>if </b></font>Ioresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
       </b></font>abort<font color="#000080">(</font><font color="#800000">'Cannot Open '</font><font color="#000080">+</font>f<font color="#000080">+</font><font color="#800000">'!'</font><font color="#000080">);
    </font>k<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font>seek<font color="#000080">(</font>fi<font color="#000080">,</font>start<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>size<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>size<font color="#000080">:=</font>Filesize<font color="#000080">(</font>fi<font color="#000080">);
    </font>blockread<font color="#000080">(</font>fi<font color="#000080">,</font>Mem<font color="#000080">[</font>seg<font color="#000080">(</font>SoundFile<font color="#000080">):</font>ofs<font color="#000080">(</font>SoundFile<font color="#000080">)],</font>size<font color="#000080">);
    </font>close<font color="#000080">(</font>fi<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>sb_getversion<font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">push  bp
   mov   bx,0
   call  SBDriver
   pop   bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>sb_setIOaddress<font color="#000080">(</font>add<font color="#000080">:</font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">push  bp
   mov   bx,1
   mov   ax,add
   call  SBDriver
   pop   bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>sb_setinterruptnumber<font color="#000080">(</font>intno<font color="#000080">:</font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">push  bp
   mov   bx,2
   mov   ax,intno
   call  SBDriver
   pop   bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>sb_stopoutput<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">push  bp
   mov   bx,8
   call  SBDriver
   pop   bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>sb_init<font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">push  bp
   mov   bx, 3
   call  SBDriver
   pop   bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>sb_pauseoutput<font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">push  bp
   mov   bx,10
   call  SBDriver
   pop   bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>sb_continueoutput<font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">push  bp
   mov   bx,11
   call  SBDriver
   pop   bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>sb_breakloop<font color="#000080">(</font>mode<font color="#000080">:</font>Word<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">push  bp
   mov   bx,12
   mov   ax,mode
   call  SBDriver
   pop   bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>sb_output<font color="#000080">(</font>sg<font color="#000080">,</font>os<font color="#000080">:</font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">push bp
    push di
    mov  bx,6
    mov  di,os             </font><font color="#008000"><i>{ offset of voice  }
    </i></font><font color="#FF00FF">mov  es,sg             </font><font color="#008000"><i>{ segment of voice }
    </i></font><font color="#FF00FF">call SBDriver
    pop  di
    pop  bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>sb_input<font color="#000080">(</font>highlength<font color="#000080">,</font>lowlength<font color="#000080">,</font>seginputbuff<font color="#000080">,</font>ofsinputbuff<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">push bp
    push di
    mov  bx,7
    mov  dx,highlength
    mov  cx,lowlength
    mov  es,seginputbuff
    mov  di,ofsinputbuff
    call SBDriver
    pop  di
    pop  bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>sb_setstatusWord<font color="#000080">(</font>sg<font color="#000080">,</font>os<font color="#000080">:</font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">push bp
    push di
    mov  bx,5
    mov  di,os
    mov  es,sg
    call SBDriver
    pop  di
    pop  bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>sb_speaker<font color="#000080">(</font>mode<font color="#000080">:</font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">push  bp
   mov   bx,4
   mov   ax,mode
   call  SBDriver
   pop   bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>sb_uninstall<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">push  bp
   mov   bx,9
   call  SBDriver
   pop   bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>sb_setuserFunction<font color="#000080">(</font>segaddress<font color="#000080">,</font>ofsaddress<font color="#000080">:</font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">push  bp
   mov   dx,segaddress
   mov   ax,ofsaddress
   mov   bx,13
   call  SBDriver
   pop   bp
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{set up SB}

  </i></font><font color="#FF0000"><b>if </b></font>DosMemAvail <font color="#000080">&lt; </font><font color="#800000">5000 </font><font color="#FF0000"><b>then                           </b></font><font color="#008000"><i>{ lower the heap   }
      </i></font>abort<font color="#000080">(</font><font color="#800000">'not Enough Memory'</font><font color="#000080">);                      </font><font color="#008000"><i>{ With $M to fix   }
  </i></font>StatusWord<font color="#000080">:=</font>MAlloc<font color="#000080">(</font>SBDriver<font color="#000080">,</font><font color="#800000">5000</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>StatusWord<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>abort<font color="#000080">(</font><font color="#800000">'Memory Allocation Error'</font><font color="#000080">);

  </font>sgSBDriver<font color="#000080">:=</font>MemW<font color="#000080">[</font>seg<font color="#000080">(</font>SBDriver<font color="#000080">):</font>ofs<font color="#000080">(</font>SBDriver<font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">];
  </font>ofSBDriver<font color="#000080">:=</font>MemW<font color="#000080">[</font>seg<font color="#000080">(</font>SBDriver<font color="#000080">):</font>ofs<font color="#000080">(</font>SBDriver<font color="#000080">)];

  </font>Loaddriver<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);                                      </font><font color="#008000"><i>{ change at will   }
  </i></font><font color="#FF0000"><b>if </b></font>sb_init<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then                                   </b></font><font color="#008000"><i>{ or stick in your }
      </i></font>SBFound<font color="#000080">:=</font>False                                   <font color="#008000"><i>{ own Program init }
  </i></font><font color="#FF0000"><b>else
      </b></font>SBFound<font color="#000080">:=</font>True<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>SBFound <font color="#FF0000"><b>then begin
      </b></font>sb_setstatusWord<font color="#000080">(</font>seg<font color="#000080">(</font>statusWord<font color="#000080">),</font>ofs<font color="#000080">(</font>statusWord<font color="#000080">));
      </font>sb_speaker<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);                                   </font><font color="#008000"><i>{ turn SB on       }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font><font color="#008000"><i>{There's the Unit For .VOC playing.}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
