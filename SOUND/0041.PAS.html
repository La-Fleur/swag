<html>
<head><title> "SB Talk Unit" by MIRKO HOLZER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0041.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Hi! I have the following problem:
&gt; I'm trying to get my Sound Blaster card (version 1.0) to speak a string,
&gt; like the SAY.EXE program that comes with SB.

(Sorry for the german comments, but I'm to lazy to rewrite them &eth;:-|) }

</i></font><font color="#FF0000"><b>Program </b></font>Talk<font color="#000080">;
</font><font color="#008000"><i>{ by Mirko Holzer; 16.2.1994 }

</i></font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">,
  </font>Dos<font color="#000080">,
  </font>Strings<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>cSBTalkSig<font color="#000080">=</font><font color="#800000">'FB '</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>tTalkEpStruc<font color="#000080">=</font><font color="#FF0000"><b>record
    </b></font>Signature<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;  </font><font color="#008000"><i>{Signatur: &quot;FB &quot;}
    </i></font>MajorVers<font color="#000080">: </font>byte<font color="#000080">;                 </font><font color="#008000"><i>{Hauptversion ??}
    </i></font>Entry<font color="#000080">: </font>pointer<font color="#000080">;                  </font><font color="#008000"><i>{Treiber Einsprungadresse}
    </i></font>Unknown<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">23</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;   </font><font color="#008000"><i>{Wei&aacute; nicht was da drin steht...}
    </i></font>DataLen<font color="#000080">: </font>byte<font color="#000080">;                   </font><font color="#008000"><i>{LÑnge des zu sprechenden Strings}
    </i></font>TalkStr<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;  </font><font color="#008000"><i>{Zu sprechender String}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>pTalkEpStruc<font color="#000080">=^</font>tTalkEpStruc<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>sbt<font color="#000080">: </font>pTalkEpStruc<font color="#000080">;
  </font>eing<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>ChkSBT<font color="#000080">: </font>pointer<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ax,$FBFB
  mov bx,0
  mov es,bx
  int $2F
  mov dx,es
  mov ax,bx
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TalkIt<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sb<font color="#000080">: </font>pTalkEpStruc<font color="#000080">; </font>what<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>SBCall<font color="#000080">: </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>sb<font color="#000080">^.</font>DataLen<font color="#000080">:=</font>Length<font color="#000080">(</font>what<font color="#000080">);
  </font>StrPCopy<font color="#000080">(</font>sb<font color="#000080">^.</font>TalkStr<font color="#000080">,</font>what<font color="#000080">);
  </font>SBCall<font color="#000080">:=</font>sb<font color="#000080">^.</font>Entry<font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">les di,sb
    mov bx,di
    mov al,$07
    call [sbcall]
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>begin
  </b></font>sbt<font color="#000080">:=</font>ChkSBT<font color="#000080">;
  </font>ClrScr<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'SBTalker - Test'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'16.2.94 von Mirko Holzer'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>sbt<font color="#000080">^.</font>Signature<font color="#000080">&lt;&gt;</font>cSBTalkSig <font color="#FF0000"><b>then
  begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'The program sbtalk.exe is not installed.'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Programm beendet.'</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
    </font>Halt<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>TalkIt<font color="#000080">(</font>sbt<font color="#000080">,</font><font color="#800000">'Hello, here is S B talker speaking... Please enter your string '</font><font color="#000080">+
             </font><font color="#800000">'or press enter to stop the program.'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Zu sprechenden String eingeben oder &lt;ENTER&gt; drÅcken fÅr Ende.'</font><font color="#000080">);
  </font><font color="#FF0000"><b>Repeat
    </b></font>eing<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
    </font>Readln<font color="#000080">(</font>eing<font color="#000080">);
    </font>TalkIt<font color="#000080">(</font>sbt<font color="#000080">,</font>eing<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>eing<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">;
  </font>TalkIt<font color="#000080">(</font>sbt<font color="#000080">,</font><font color="#800000">'Look out for Demos from.... Terrible Minds Productions'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0041.PAS">Original</a><b>]</b></p></body>
</html>
