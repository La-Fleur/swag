<html>
<head><title> "MOD Tool - Reads MOD Files" by PEDRO MIGUEL BORGES</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0067.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Umm, I don't think you understood my question...  I don't know how
&gt; to play 8 or 16 bit sound  (Like a mod file), I CAN do FM...
&gt; I just want help on making the routines to play things like a
&gt; mod...
&gt; Gotta, go...  Could you please see if you could help me on this,
&gt; though? Justin Greer

 Here is some Pascal source code to Read a (Standard) MOD 4 Tracks:

 READ it's not play, that is another story...

 Here is some example files that you sould see:
 ==============================================
 DEMOVT15.ZIP    MOD's 8 Borland C/ MS C/ (Real Mode/Protected Mode)
                 PAS/C/Assembly
 GOLDPALY.ZIP    MOD's 4 tracks Assembly/Pascal
 MDSS031A.ZIP    MOD's e S3M's  C/Pascal/Assembly
 PPS.ZIP         MOD's 4 tracks Assembly
 TNYPL212.ZIP    MOD's 8 tracks C/Assembly (Real Mode/Protected Mode)
 VTSRC12B.ZIP    MOD's 8 Pascal source of a player
}

</i></font><font color="#FF0000"><b>Unit </b></font>MODTool<font color="#000080">;
</font><font color="#008000"><i>{* Reads information from a Soundtracker module. *}
</i></font><font color="#FF0000"><b>INTERFACE
CONST
   </b></font>MODToolVersion <font color="#000080">= </font><font color="#800000">'v1.0'</font><font color="#000080">;
   </font>MaxIns <font color="#000080">= </font><font color="#800000">31</font><font color="#000080">;
   </font>Octaves <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">36</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>WORD <font color="#000080">=
      (</font><font color="#800000">856</font><font color="#000080">,</font><font color="#800000">808</font><font color="#000080">,</font><font color="#800000">762</font><font color="#000080">,</font><font color="#800000">720</font><font color="#000080">,</font><font color="#800000">678</font><font color="#000080">,</font><font color="#800000">640</font><font color="#000080">,</font><font color="#800000">604</font><font color="#000080">,</font><font color="#800000">570</font><font color="#000080">,</font><font color="#800000">538</font><font color="#000080">,</font><font color="#800000">508</font><font color="#000080">,</font><font color="#800000">480</font><font color="#000080">,</font><font color="#800000">453</font><font color="#000080">,
       </font><font color="#800000">428</font><font color="#000080">,</font><font color="#800000">404</font><font color="#000080">,</font><font color="#800000">381</font><font color="#000080">,</font><font color="#800000">360</font><font color="#000080">,</font><font color="#800000">339</font><font color="#000080">,</font><font color="#800000">320</font><font color="#000080">,</font><font color="#800000">302</font><font color="#000080">,</font><font color="#800000">285</font><font color="#000080">,</font><font color="#800000">269</font><font color="#000080">,</font><font color="#800000">254</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,</font><font color="#800000">226</font><font color="#000080">,
       </font><font color="#800000">214</font><font color="#000080">,</font><font color="#800000">202</font><font color="#000080">,</font><font color="#800000">190</font><font color="#000080">,</font><font color="#800000">180</font><font color="#000080">,</font><font color="#800000">170</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">151</font><font color="#000080">,</font><font color="#800000">143</font><font color="#000080">,</font><font color="#800000">135</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">120</font><font color="#000080">,</font><font color="#800000">113</font><font color="#000080">);
</font><font color="#FF0000"><b>TYPE
   </b></font>InstrumentType <font color="#000080">= </font><font color="#FF0000"><b>RECORD
      </b></font>SampName <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">21</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
      </font>SampLen  <font color="#000080">: </font>WORD<font color="#000080">;
      </font>SampTune <font color="#000080">: </font>BYTE<font color="#000080">;
      </font>SampAmp  <font color="#000080">: </font>BYTE<font color="#000080">;
      </font>SampRepS <font color="#000080">: </font>WORD<font color="#000080">;
      </font>SampRepL <font color="#000080">: </font>WORD<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>MODHeaderType <font color="#000080">= </font><font color="#FF0000"><b>RECORD
      </b></font>MODName  <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">19</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
      </font>MODInstr <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxIns<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>InstrumentType<font color="#000080">;
      </font>MODLen   <font color="#000080">: </font>BYTE<font color="#000080">;
      </font>MODMisc  <font color="#000080">: </font>BYTE<font color="#000080">;
      </font>MODPattr <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
      </font>MODSign  <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>NoteType    <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
   </font>PatternLine <font color="#000080">= </font><font color="#FF0000"><b>RECORD
      </b></font>Channel1<font color="#000080">, </font>Channel2<font color="#000080">,
      </font>Channel3<font color="#000080">, </font>Channel4  <font color="#000080">: </font>NoteType<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>PatternType <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">64</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>PatternLine<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>BuildModScript<font color="#000080">(</font>ModFilename<font color="#000080">, </font>ScriptFilename <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
</font><font color="#FF0000"><b>IMPLEMENTATION
FUNCTION </b></font>ConvertString<font color="#000080">(</font>Source <font color="#000080">: </font>Pointer<font color="#000080">; </font>Size <font color="#000080">: </font>BYTE<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{* INPUT   : Pointer to an ARRAY OF CHAR, length in BYTES
 * OUTPUT  : Pascal string in Size bytes length
 * PURPOSE : Convertor, e.g., converts string ending in NULL to a Pascal
              string. This routine can convert any other memory range
              into a string. }
</i></font><font color="#FF0000"><b>VAR
   </b></font>WorkStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   </b></font>Move<font color="#000080">(</font>Source<font color="#000080">^,</font>WorkStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Size<font color="#000080">);
   </font>WorkStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>CHR<font color="#000080">(</font>Size<font color="#000080">);
   </font>ConvertString <font color="#000080">:= </font>WorkStr<font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>Words<font color="#000080">(</font>FalseWord <font color="#000080">: </font>WORD<font color="#000080">):</font>WORD<font color="#000080">;
</font><font color="#008000"><i>{* INPUT   : Word variable with rotated high/low-byte
 * OUTPUT  : Restored Word, multiplied by 2
 * PURPOSE : Gets a Word value from the MOD file and restores the proper
             high-byte/low-byte sequence; also multiplies the result by
             2, as this function must store the information as Word units
             to coincide with sample length. }
</i></font><font color="#FF0000"><b>BEGIN
   </b></font>Words <font color="#000080">:= (</font>Hi<font color="#000080">(</font>FalseWord<font color="#000080">)+</font>Lo<font color="#000080">(</font>FalseWord<font color="#000080">)*</font><font color="#800000">256</font><font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>NoteName<font color="#000080">(</font>Period <font color="#000080">: </font>WORD<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{* INPUT   : Note length value as WORD
 * OUTPUT  : Note in text as string
 * PURPOSE : Using tuning table, converts pitch values to note names. }
</i></font><font color="#FF0000"><b>CONST
   </b></font>NNames <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>OF String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] =
      (</font><font color="#800000">'C-'</font><font color="#000080">,</font><font color="#800000">'C#'</font><font color="#000080">,</font><font color="#800000">'D-'</font><font color="#000080">,</font><font color="#800000">'D#'</font><font color="#000080">,</font><font color="#800000">'E-'</font><font color="#000080">,</font><font color="#800000">'F-'</font><font color="#000080">,</font><font color="#800000">'F#'</font><font color="#000080">,</font><font color="#800000">'G-'</font><font color="#000080">,</font><font color="#800000">'G#'</font><font color="#000080">,</font><font color="#800000">'A-'</font><font color="#000080">,</font><font color="#800000">'A#'</font><font color="#000080">,</font><font color="#800000">'B-'</font><font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>WorkStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>NCount  <font color="#000080">: </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   </b></font>NCount <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Period <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>NCount <font color="#000080">:= </font><font color="#800000">37</font><font color="#000080">;
      </font>NoteName <font color="#000080">:= </font><font color="#800000">'----'</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>NCount <font color="#000080">&lt;= </font><font color="#800000">36</font><font color="#000080">) </font><font color="#FF0000"><b>DO BEGIN
      IF </b></font><font color="#000080">(</font>Period <font color="#000080">= </font>Octaves<font color="#000080">[</font>NCount<font color="#000080">]) </font><font color="#FF0000"><b>THEN BEGIN
         </b></font>Dec<font color="#000080">(</font>Ncount<font color="#000080">);
         </font>Str<font color="#000080">((</font>NCount <font color="#FF0000"><b>DIV </b></font><font color="#800000">12</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>WorkStr<font color="#000080">);
         </font>NoteName <font color="#000080">:= </font>NNames<font color="#000080">[</font>NCount<font color="#000080">-(</font>NCount <font color="#FF0000"><b>DIV </b></font><font color="#800000">12</font><font color="#000080">)*</font><font color="#800000">12</font><font color="#000080">]+</font>WorkStr<font color="#000080">;
         </font>NCount <font color="#000080">:= </font><font color="#800000">37</font><font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>Inc<font color="#000080">(</font>NCount<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>BuildModScript<font color="#000080">(</font>ModFilename<font color="#000080">, </font>ScriptFilename <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
</font><font color="#008000"><i>{* INPUT   : Module name and name of desired script file
 * OUTPUT  : None
 * PURPOSE : Reads a SoundTracker module and writes the most important
             information to a text file.  The module _must_ contain 31
             instruments, or incorrect results will occur.
             Patterns are stored in sequence. }
</i></font><font color="#FF0000"><b>VAR
   </b></font>ModFile  <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
   </font>ScrFile  <font color="#000080">: </font>TEXT<font color="#000080">;
   </font>Result   <font color="#000080">: </font>WORD<font color="#000080">;
   </font>Header   <font color="#000080">: </font>ModHeaderType<font color="#000080">;
   </font>DummyStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>InsCount <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>PatCount <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>Pattern  <font color="#000080">: </font>PatternType<font color="#000080">;
   </font>HiPatt   <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>Counter  <font color="#000080">: </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{ Make sure that desired MOD file is available }
{$I-}
   </i></font>Assign<font color="#000080">(</font>ModFile<font color="#000080">,</font>ModFilename<font color="#000080">);
   </font>Reset<font color="#000080">(</font>ModFile<font color="#000080">);
   </font>Close<font color="#000080">(</font>ModFile<font color="#000080">);
</font><font color="#008000"><i>{$I+}
   </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Cannot find MOD file: '</font><font color="#000080">,</font>ModFilename<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">'. Sorry.'</font><font color="#000080">);
      </font>HALT<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Read MOD header data into Header variable }
   </i></font>Reset<font color="#000080">(</font>ModFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>BlockRead<font color="#000080">(</font>ModFile<font color="#000080">,</font>Header<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Header<font color="#000080">),</font>Result<font color="#000080">);
</font><font color="#008000"><i>{ Analyze data in Header }
   </i></font><font color="#FF0000"><b>WITH </b></font>Header <font color="#FF0000"><b>DO BEGIN
      </b></font>Assign<font color="#000080">(</font>ScrFile<font color="#000080">,</font>ScriptFilename<font color="#000080">);
      </font>ReWrite<font color="#000080">(</font>ScrFile<font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'Soundtracker module script file '</font><font color="#000080">,</font>ModFilename<font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">);
</font><font color="#008000"><i>{ Write module name }
      </i></font>DummyStr <font color="#000080">:= </font>ConvertString<font color="#000080">(</font>Addr<font color="#000080">(</font>MODName<font color="#000080">),</font>SizeOf<font color="#000080">(</font>MODName<font color="#000080">));
      </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'Module name  : '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
</font><font color="#008000"><i>{ Write module length (valid numbers = 1 - 128) }
      </i></font>Str<font color="#000080">(</font>MODLen<font color="#000080">,</font>DummyStr<font color="#000080">);
      </font>Write  <font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'Module length  : '</font><font color="#000080">,</font>DummyStr<font color="#000080">, </font><font color="#800000">' Pattern(s),'</font><font color="#000080">);
</font><font color="#008000"><i>{ Search for highest pattern number }
      </i></font>HiPatt <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>FOR </b></font>PatCount <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>MODLen <font color="#FF0000"><b>DO
         IF </b></font>ModPattr<font color="#000080">[</font>PatCount<font color="#000080">] &gt;= </font>HiPatt <font color="#FF0000"><b>THEN
            </b></font>HiPatt <font color="#000080">:= </font>ModPattr<font color="#000080">[</font>PatCount<font color="#000080">];
      </font>Str<font color="#000080">(</font>HiPatt<font color="#000080">,</font>DummyStr<font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">' - highest pattern number is '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">);
</font><font color="#008000"><i>{ Write instrument information }
      </i></font><font color="#FF0000"><b>FOR </b></font>InsCount <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>MaxIns <font color="#FF0000"><b>DO BEGIN
         WITH </b></font>MODInstr<font color="#000080">[</font>InsCount<font color="#000080">] </font><font color="#FF0000"><b>DO BEGIN
            </b></font>DummyStr <font color="#000080">:= </font>ConvertString<font color="#000080">(</font>Addr<font color="#000080">(</font>SampName<font color="#000080">),</font>SizeOf<font color="#000080">(</font>SampName<font color="#000080">));
            </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'Instrument # '</font><font color="#000080">,</font>InsCount<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">' = '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
            </font>Str<font color="#000080">(</font>Words<font color="#000080">(</font>SampLen<font color="#000080">):</font><font color="#800000">6</font><font color="#000080">,</font>DummyStr<font color="#000080">);
            </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'Length in bytes = '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
            </font>Str<font color="#000080">(</font>SampTune<font color="#000080">:</font><font color="#800000">6</font><font color="#000080">,</font>DummyStr<font color="#000080">);
            </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'Fine tune       = '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
            </font>Str<font color="#000080">(</font>SampAmp<font color="#000080">:</font><font color="#800000">6</font><font color="#000080">,</font>DummyStr<font color="#000080">);
            </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'Volume          = '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
            </font>Str<font color="#000080">(</font>Words<font color="#000080">(</font>SampRepS<font color="#000080">):</font><font color="#800000">6</font><font color="#000080">,</font>DummyStr<font color="#000080">);
            </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'Repeat start    = '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
            </font>Str<font color="#000080">(</font>Words<font color="#000080">(</font>SampRepL<font color="#000080">):</font><font color="#800000">6</font><font color="#000080">,</font>DummyStr<font color="#000080">);
            </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'Repeat length   = '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
            </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'----------------------------------------'</font><font color="#000080">);
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Read patterns and write note values into script file }
{ (parentheses following pitch name contain sample number of note) }
      </i></font><font color="#FF0000"><b>FOR </b></font>PatCount <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>HiPatt<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>DO BEGIN
         IF NOT</b></font><font color="#000080">(</font>EOF<font color="#000080">(</font>ModFile<font color="#000080">)) </font><font color="#FF0000"><b>THEN
            </b></font>Blockread<font color="#000080">(</font>ModFile<font color="#000080">,</font>Pattern<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Pattern<font color="#000080">),</font>Result<font color="#000080">);
         </font>WriteLn<font color="#000080">(</font><font color="#800000">'Read pattern '</font><font color="#000080">,</font>PatCount<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">);
         </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'Pattern number : '</font><font color="#000080">,</font>PatCount<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">);
         </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'Lines #   Chan.1     Chan.2     Chan.3     Chan.4'</font><font color="#000080">);
         </font><font color="#FF0000"><b>FOR </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">64 </font><font color="#FF0000"><b>DO BEGIN
            </b></font>Write<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'  '</font><font color="#000080">,</font>Counter<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'    '</font><font color="#000080">);
            </font><font color="#FF0000"><b>WITH </b></font>Pattern<font color="#000080">[</font>Counter<font color="#000080">] </font><font color="#FF0000"><b>DO BEGIN
</b></font><font color="#008000"><i>{ Display note and sample number for channel 1 }
               </i></font>DummyStr <font color="#000080">:= </font>NoteName<font color="#000080">((</font>Channel1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$0F</font><font color="#000080">)*</font><font color="#800000">256</font><font color="#000080">+(</font>Channel1<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]));
               </font>Write<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
               </font>Write<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'('</font><font color="#000080">,((</font>Channel1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F0</font><font color="#000080">)+
                                  (</font>Channel1<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">)):</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">')  '</font><font color="#000080">);
</font><font color="#008000"><i>{ Display note and sample number for channel 2 }
               </i></font>DummyStr <font color="#000080">:= </font>NoteName<font color="#000080">((</font>Channel2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$0F</font><font color="#000080">)*</font><font color="#800000">256</font><font color="#000080">+(</font>Channel2<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]));
               </font>Write<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
               </font>Write<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'('</font><font color="#000080">,((</font>Channel2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F0</font><font color="#000080">)+
                                  (</font>Channel2<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">)):</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">')  '</font><font color="#000080">);
</font><font color="#008000"><i>{ Display note and sample number for channel 3 }
               </i></font>DummyStr <font color="#000080">:= </font>NoteName<font color="#000080">((</font>Channel3<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$0F</font><font color="#000080">)*</font><font color="#800000">256</font><font color="#000080">+(</font>Channel3<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]));
               </font>Write<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
               </font>Write<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'('</font><font color="#000080">,((</font>Channel3<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F0</font><font color="#000080">)+
                                  (</font>Channel3<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">)):</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">')  '</font><font color="#000080">);
</font><font color="#008000"><i>{ Display note and sample number for channel 4 }
               </i></font>DummyStr <font color="#000080">:= </font>NoteName<font color="#000080">((</font>Channel4<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$0F</font><font color="#000080">)*</font><font color="#800000">256</font><font color="#000080">+(</font>Channel4<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]));
               </font>Write<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>DummyStr<font color="#000080">);
               </font>Write<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'('</font><font color="#000080">,((</font>Channel4<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F0</font><font color="#000080">)+
                                  (</font>Channel4<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">)):</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">')  '</font><font color="#000080">);
               </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">);
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">,</font><font color="#800000">'-------------------------------------------------'</font><font color="#000080">);
         </font>WriteLn<font color="#000080">(</font>ScrFile<font color="#000080">);
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Close script file and MOD file }
      </i></font>Close<font color="#000080">(</font>ScrFile<font color="#000080">);
      </font>CLose<font color="#000080">(</font>ModFile<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{

MAIN FILE to test MODTOOL.PAS
-------------------------------- MODSCRIP.MOD ------------------------------
}
</i></font><font color="#FF0000"><b>Program </b></font>MODScript<font color="#000080">;
</font><font color="#008000"><i>{* Demo program for MODTOOL unit: Creating a script file *}
</i></font><font color="#FF0000"><b>Uses </b></font>MODTool<font color="#000080">; </font><font color="#008000"><i>{ Use MODTool unit }
</i></font><font color="#FF0000"><b>VAR
   </b></font>WorkStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{ String for processing provided filename }
</i></font><font color="#FF0000"><b>BEGIN
   </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'MODScript v1.0 (C) 1992 Abacus -  Author: Axel Stolz'</font><font color="#000080">);
</font><font color="#008000"><i>{ No command line parameter given? display syntax }
   </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ParamCount <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Syntax : MODSCRIP module[.MOD]'</font><font color="#000080">);
      </font>HALT<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Pass command line paramters }
   </i></font>WorkStr <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#008000"><i>{ If user enters filename and extension, replace extension with &quot;.MOD&quot;}
   </i></font><font color="#FF0000"><b>IF </b></font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>WorkStr<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      </b></font>WorkStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>WorkStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>WorkStr<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
   </font>WriteLn<font color="#000080">(</font><font color="#800000">'Create a script file from a sound module '</font><font color="#000080">,</font>WorkStr<font color="#000080">,</font><font color="#800000">'.MOD !'</font><font color="#000080">);
</font><font color="#008000"><i>{ Create script file }
   </i></font>BuildModScript<font color="#000080">(</font>WorkStr<font color="#000080">+</font><font color="#800000">'.MOD'</font><font color="#000080">,</font>WorkStr<font color="#000080">+</font><font color="#800000">'.TXT'</font><font color="#000080">);
   </font>WriteLn<font color="#000080">(</font><font color="#800000">'Ready. Result stored in '</font><font color="#000080">,</font>WorkStr<font color="#000080">,</font><font color="#800000">'.TXT.'</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0067.PAS">Original</a><b>]</b></p></body>
</html>
