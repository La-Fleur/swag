<html>
<head><title> "SOUNDOFF.PAS" by STEVEN TALLENT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
STEVEN TALLENT

&gt; I am look For a piece of code [...] that will turn off the speaker.

This is tested code, and should do the trick.  It does its work by
turning off the PC speaker 18.2 times per second.  This should reduce
any Sound to maybe a click or two.  Unfortunately, some games and
music software will bypass it (ModPlay, Wolfenstein), but most beeps
and whistles will be gone.  This is a TSR Program, and takes about 3k
memory (yuk), but you can load it high if you want.  I've found it
especially useful during late-night BBSing (no alarms at connect/File
xfer finish). Hope this does the trick!  Considering its size and
relative isolation from normal Programs, I didn't see fit to use CLI/STI.
}

{$M 1024,0,0}  {BTW, is there any way to make this smaller?!?}
{$N-,S-,G+} { Use g- For 8088 systems, g+ For V20 and above }
</i></font><font color="#FF0000"><b>Program </b></font>NoSpeak<font color="#000080">;
</font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ShutOff<font color="#000080">; </font>INTERRUPT<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Port <font color="#000080">[</font><font color="#800000">97</font><font color="#000080">] := </font>Port<font color="#000080">[</font><font color="#800000">97</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">253</font><font color="#000080">; </font><font color="#008000"><i>{Turn off speaker and disconnect timer}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>SetIntVec<font color="#000080">( </font><font color="#800000">$1C</font><font color="#000080">, @</font>ShutOff<font color="#000080">);
  </font>Keep<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p></body>
</html>
