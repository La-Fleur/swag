<html>
<head><title> "PLAYMUSC.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ Here is a Unit that plays music. It came out of this echo recently. }


</i></font><font color="#FF0000"><b>Unit </b></font>Music<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses
  </b></font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>Const
   </b></font>e_note <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;       </font><font color="#008000"><i>{ Eighth Note      }
   </i></font>q_note <font color="#000080">= </font><font color="#800000">30</font><font color="#000080">;       </font><font color="#008000"><i>{ Quarter Note     }
   </i></font>h_note <font color="#000080">= </font><font color="#800000">60</font><font color="#000080">;       </font><font color="#008000"><i>{ Half Note        }
   </i></font>dh_note <font color="#000080">= </font><font color="#800000">90</font><font color="#000080">;      </font><font color="#008000"><i>{ Dotted Half Note }
   </i></font>w_note <font color="#000080">= </font><font color="#800000">120</font><font color="#000080">;      </font><font color="#008000"><i>{ Whole Note       }
   </i></font>R <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;             </font><font color="#008000"><i>{ Rest             }
   </i></font>C <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;             </font><font color="#008000"><i>{ C                }
   </i></font>Cs <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;            </font><font color="#008000"><i>{ C Sharp          }
   </i></font>Db <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;            </font><font color="#008000"><i>{ D Flat           }
   </i></font>D <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;             </font><font color="#008000"><i>{ D                }
   </i></font>Ds <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;            </font><font color="#008000"><i>{ D Sharp          }
   </i></font>Eb <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;            </font><font color="#008000"><i>{ E Flat           }
   </i></font>E <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;             </font><font color="#008000"><i>{ Etc...           }
   </i></font>F <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;
   </font>Fs <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
   </font>Gb <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
   </font>G <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;
   </font>Gs <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">;
   </font>Ab <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">;
   </font>A <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;
   </font><font color="#FF0000"><b>As </b></font><font color="#000080">= </font><font color="#800000">11</font><font color="#000080">;
   </font>Bb <font color="#000080">= </font><font color="#800000">11</font><font color="#000080">;
   </font>B <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PlayTone<font color="#000080">(</font>Octave <font color="#000080">: </font>Byte<font color="#000080">; </font>Note <font color="#000080">: </font>Byte<font color="#000080">; </font>Duration <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>ToneOn<font color="#000080">(</font>Octave   <font color="#000080">: </font>Byte<font color="#000080">; </font>Note     <font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Var
  </b></font>Oct_Val  <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Real<font color="#000080">;
  </font>Freq_Val <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font>C<font color="#000080">..</font>B<font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Real<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Set_Frequencies<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>N <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Freq_Val<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>N <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>To </b></font><font color="#800000">12 </font><font color="#FF0000"><b>Do
    </b></font>Freq_Val<font color="#000080">[</font>N<font color="#000080">] := </font>Freq_Val<font color="#000080">[</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] * </font><font color="#800000">1.0594630944</font><font color="#000080">;
  </font>Oct_Val<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">32.70319566</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>N <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">8 </font><font color="#FF0000"><b>Do
    </b></font>Oct_Val<font color="#000080">[</font>N<font color="#000080">] := </font>Oct_Val<font color="#000080">[</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] * </font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PlayTone<font color="#000080">(</font>Octave <font color="#000080">: </font>Byte<font color="#000080">; </font>Note <font color="#000080">: </font>Byte<font color="#000080">; </font>Duration <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  If </b></font>Note <font color="#000080">= </font>R <font color="#FF0000"><b>Then
    </b></font>NoSound
  <font color="#FF0000"><b>Else
    </b></font>Sound<font color="#000080">(</font>Round<font color="#000080">(</font>Oct_Val<font color="#000080">[</font>Octave<font color="#000080">] * </font>Freq_Val<font color="#000080">[</font>Note<font color="#000080">]));
  </font>Delay<font color="#000080">(</font>Duration<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">);
  </font>NoSound<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ToneOn<font color="#000080">(</font>Octave <font color="#000080">: </font>Byte<font color="#000080">; </font>Note <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  If </b></font>Note <font color="#000080">= </font>R <font color="#FF0000"><b>Then
    </b></font>NoSound
  <font color="#FF0000"><b>Else
    </b></font>Sound<font color="#000080">(</font>Round<font color="#000080">(</font>Oct_Val<font color="#000080">[</font>Octave<font color="#000080">] * </font>Freq_Val<font color="#000080">[</font>Note<font color="#000080">]));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Set_Frequencies<font color="#000080">;
  </font>NoSound<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
  This does not include the actual values of the tones, but it is still
very helpful (more so than if you had the actual freqencies). If you still
want the tones, just substitute the value For the tone into the Procedures
that play the tone.
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p></body>
</html>
