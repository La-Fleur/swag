<html>
<head><title> "Direct output to SB Card" by NORBERT IGL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
NORBERT IGL

&gt;&gt; if you already have the DAC Programming, simply Write out each
&gt;&gt; Byte to the DAC PORT (Write $10, then the data For Direct Mode)
&gt;&gt; Then Delay after each Byte, depending on the Sampling rate.
&gt;&gt; You'll have to play around With the Delay's.

  Just found a piece of source in my Files.... (:-)),
  but i don't know the original author ( RedFox ? )
  and i translated the (orig.) german remarks....
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>Const
  </b></font>ResetPort  <font color="#000080">= </font><font color="#800000">$226</font><font color="#000080">;
  </font>ReadPort   <font color="#000080">= </font><font color="#800000">$22A</font><font color="#000080">;
  </font>WritePort  <font color="#000080">= </font><font color="#800000">$22C</font><font color="#000080">;
  </font>StatusPort <font color="#000080">= </font><font color="#800000">$22C</font><font color="#000080">;
  </font>DataDaPort <font color="#000080">= </font><font color="#800000">$22E</font><font color="#000080">;

  </font><font color="#008000"><i>{ N.I.: Note: Use SB_Port (prev. Msg) to get the correct address.... }

  </i></font>AD_Null       <font color="#000080">= </font><font color="#800000">$80</font><font color="#000080">;
  </font>OK            <font color="#000080">= </font><font color="#800000">0000</font><font color="#000080">;
  </font>NichtGefunden <font color="#000080">= </font><font color="#800000">1000</font><font color="#000080">;
  </font>DirectDAC     <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">;
  </font>SpeakerOn     <font color="#000080">= </font><font color="#800000">$D1</font><font color="#000080">;
  </font>SpeakerOff    <font color="#000080">= </font><font color="#800000">$D3</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>DSPResult   <font color="#000080">: </font>Word<font color="#000080">;
  </font>DSPReadWert <font color="#000080">: </font>Byte<font color="#000080">;

  </font>loop <font color="#000080">: </font>Word<font color="#000080">;
  </font>w    <font color="#000080">: </font>Word<font color="#000080">;
  </font>m    <font color="#000080">: </font>Word<font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>WriteToDSP<font color="#000080">(</font>Command <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  Repeat Until </b></font><font color="#000080">(</font>port<font color="#000080">[</font>StatusPort<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$80</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">;
  </font>port<font color="#000080">[</font>WritePort<font color="#000080">] := </font>Command<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadFromDSP<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Repeat Until </b></font><font color="#000080">(</font>port<font color="#000080">[</font>DataDaPort<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$80</font><font color="#000080">) = </font><font color="#800000">$80</font><font color="#000080">;
  </font>DSPReadWert <font color="#000080">:= </font>port<font color="#000080">[</font>ReadPort<font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ResetDSP<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>MaxVersuch <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MaxVersuch<font color="#000080">:=</font><font color="#800000">100</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>port<font color="#000080">[</font>ResetPort<font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
    </font>Delay<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
    </font>port<font color="#000080">[</font>ResetPort<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
    </font>ReadFromDSP<font color="#000080">;
    </font>dec<font color="#000080">(</font>MaxVersuch<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>DSPReadWert <font color="#000080">= </font><font color="#800000">$AA</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>MaxVersuch <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font>MaxVersuch <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>DSPResult <font color="#000080">:= </font>NichtGefunden
  <font color="#FF0000"><b>else
    </b></font>DSPResult <font color="#000080">:= </font>OK<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;

  </font>ResetDSP<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>DSPResult <font color="#000080">&lt;&gt; </font>OK <font color="#FF0000"><b>then
  begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">' Soundeblaster not found !'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">' Wrong SB-address ?'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">' Demo : direct output to the SoundblasterCard !'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'  &Uacute;&Auml;&Auml;&iquest;  &Uacute;&Auml;&Auml;&iquest;  &Uacute;&Auml;&Auml;&iquest;  &Uacute;&Auml;&Auml;&iquest;  &Uacute;&Auml;&Auml;&iquest;  &Uacute;  creates a square'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'  &sup3;  &sup3;  &sup3;  &sup3;  &sup3;  &sup3;  &sup3;  &sup3;  &sup3;  &sup3;  &sup3;  waveform With an'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'&Auml;&Auml;&Ugrave;  &Agrave;&Auml;&Auml;&Ugrave;  &Agrave;&Auml;&Auml;&Ugrave;  &Agrave;&Auml;&Auml;&Ugrave;  &Agrave;&Auml;&Auml;&Ugrave;  &Agrave;&Auml;&Auml;&Ugrave;  64`er amplitude '</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">(</font><font color="#800000">' RedFox (14.11.91) '</font><font color="#000080">);

    </font>WriteToDSP<font color="#000080">(</font>SpeakerOn<font color="#000080">);               </font><font color="#008000"><i>{ Speaker on }

    </i></font>m <font color="#000080">:= </font><font color="#800000">5000</font><font color="#000080">;                           </font><font color="#008000"><i>{ dynamc Wait (Init) }

    </i></font><font color="#FF0000"><b>For </b></font>loop <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">600 </font><font color="#FF0000"><b>do              </b></font><font color="#008000"><i>{ 600 samples }
    </i></font><font color="#FF0000"><b>begin
      </b></font>dec<font color="#000080">(</font>m<font color="#000080">, </font><font color="#800000">10</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>m <font color="#000080">&lt; </font><font color="#800000">20 </font><font color="#FF0000"><b>then
        </b></font>m <font color="#000080">:= </font><font color="#800000">500</font><font color="#000080">;
      </font>WriteToDSP<font color="#000080">(</font>DirectDAC<font color="#000080">);             </font><font color="#008000"><i>{ command to SB  }
      </i></font>WriteToDSP<font color="#000080">(</font>AD_Null <font color="#000080">+ </font><font color="#800000">32</font><font color="#000080">);          </font><font color="#008000"><i>{ now the sample }

      { rising edge    }
      </i></font><font color="#FF0000"><b>For </b></font>w <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>m <font color="#FF0000"><b>do begin end</b></font><font color="#000080">;      </font><font color="#008000"><i>{ dynamc wait    }

      </i></font>WriteToDSP<font color="#000080">(</font>DirectDAC<font color="#000080">);             </font><font color="#008000"><i>{ command to SB  }
      </i></font>WriteToDSP<font color="#000080">(</font>AD_Null <font color="#000080">- </font><font color="#800000">32</font><font color="#000080">);          </font><font color="#008000"><i>{ falling edge   }

      </i></font><font color="#FF0000"><b>For </b></font>w <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>m <font color="#FF0000"><b>do begin end</b></font><font color="#000080">;      </font><font color="#008000"><i>{ wait again     }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>WriteToDSP<font color="#000080">(</font>SpeakerOff<font color="#000080">);              </font><font color="#008000"><i>{ speaker off }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p></body>
</html>
