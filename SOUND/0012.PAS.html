<html>
<head><title> "VOC2LPT1.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
    This is a Program to export a VOC or other Raw Sound File to a Parallel
port DAC.. (only For LPT1 now, but i think you can make it work on LPT2 by
changing the 'PORT[$0378]' to 'PORT[$0388]'...

 I know, This is a Real mess For figuring it out... I originally had no
intention of posting it, but I believe in free access to info, so here it is!
If you have any questions about it, just ask... and if you figure out where
that bug is (you'll know what I mean, it only plays PART of the VOC) I'd
appreciate input.
}

{This Program Assumes you have a DAC on LPT1}
{$M 65520,0,300000}          {only use memory that is needed}
</i></font><font color="#FF0000"><b>Program </b></font>Voc_Play<font color="#000080">;
</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Wait<font color="#000080">(</font>N <font color="#000080">: </font>Word<font color="#000080">);        </font><font color="#008000"><i>{Very Crude wait routine}
</i></font><font color="#FF0000"><b>Var
  </b></font>counter <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>Counter<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>Ra <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>I2   <font color="#000080">: ^</font>Ra<font color="#000080">;
  </font>spd  <font color="#000080">: </font>Integer<font color="#000080">;
  </font>res  <font color="#000080">: </font>Word<font color="#000080">;
  </font>siz  <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>B    <font color="#000080">: </font>Word<font color="#000080">;
  </font>s    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>f1   <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>Byte<font color="#000080">;
  </font>F    <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Write<font color="#000080">(</font><font color="#800000">'Enter Voc Filename: '</font><font color="#000080">);
  </font>readln<font color="#000080">(</font>S<font color="#000080">);
                             </font><font color="#008000"><i>{Get Size of File}
  </i></font>Assign<font color="#000080">(</font>f1<font color="#000080">,</font>s<font color="#000080">);
  </font>Reset<font color="#000080">(</font>f1<font color="#000080">);
  </font>spd<font color="#000080">:=</font><font color="#800000">30</font><font color="#000080">;                   </font><font color="#008000"><i>{this is the play speed}
  </i></font>siz <font color="#000080">:= </font>FileSize<font color="#000080">(</font>f1<font color="#000080">);
  </font>close<font color="#000080">(</font>f1<font color="#000080">);
                              </font><font color="#008000"><i>{Load up Voc File}
  </i></font>Assign<font color="#000080">(</font>f<font color="#000080">,</font>s<font color="#000080">);
  </font>Reset<font color="#000080">(</font>f<font color="#000080">);
  </font>getmem<font color="#000080">(</font>I2<font color="#000080">,</font>siz<font color="#000080">);               </font><font color="#008000"><i>{Allocate Memory For VOC File}
  </i></font>BlockRead<font color="#000080">(</font>f<font color="#000080">,</font>I2<font color="#000080">^,</font>siz<font color="#000080">,</font>res<font color="#000080">);     </font><font color="#008000"><i>{Load VOC into Memory)
  Writeln('FileSize = ',siz);   {Testing Point, not needed}

  </i></font><font color="#FF0000"><b>Repeat                      </b></font><font color="#008000"><i>{This is the actual Play routine}      </i></font><font color="#FF0000"><b>begin
    For </b></font>b<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>siz <font color="#FF0000"><b>do
    begin
      </b></font>Wait<font color="#000080">(</font>spd<font color="#000080">);            </font><font color="#008000"><i>{Wait a bit}
      </i></font>Port<font color="#000080">[</font><font color="#800000">$0378</font><font color="#000080">]:=</font>I2<font color="#000080">^[</font>b<font color="#000080">];  </font><font color="#008000"><i>{Put Byte to DAC}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end Until </b></font>KeyPressed<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p></body>
</html>
