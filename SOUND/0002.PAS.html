<html>
<head><title> "DETCADLB.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">; </font><font color="#008000"><i>(* Crt Needed For Delay Routine *)

</i></font><font color="#FF0000"><b>Function </b></font>AdlibCard <font color="#000080">: </font>Boolean<font color="#000080">;
 </font><font color="#008000"><i>(* Routine to determine if a Adlib compatible card is installed *)
</i></font><font color="#FF0000"><b>Var
  </b></font>Val1<font color="#000080">,</font>Val2 <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;      </font><font color="#008000"><i>(* Write 60h to register 4 *)
  </i></font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);             </font><font color="#008000"><i>(* Which resets timer 1 and 2 *)
  </i></font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$60</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">);
  </font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;      </font><font color="#008000"><i>(* Write 80h to register 4 *)
  </i></font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);             </font><font color="#008000"><i>(* Which enables interrupts *)
  </i></font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$80</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">);
  </font>Val1 <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">];   </font><font color="#008000"><i>(* Read status Byte *)
  </i></font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">2</font><font color="#000080">;      </font><font color="#008000"><i>(* Write ffh to register 2 *)
  </i></font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);             </font><font color="#008000"><i>(* Which is also Timer 1 *)
  </i></font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$FF</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">);
  </font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;      </font><font color="#008000"><i>(* Write 21h to register 4 *)
  </i></font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);             </font><font color="#008000"><i>(* Which will Start Timer 1 *)
  </i></font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$21</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">85</font><font color="#000080">);            </font><font color="#008000"><i>(* wait 85 microseconds *)
  </i></font>Val2 <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">];   </font><font color="#008000"><i>(* read status Byte *)
  </i></font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;      </font><font color="#008000"><i>(* Repeat the first to steps *)
  </i></font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);             </font><font color="#008000"><i>(* Which will reset both Timers *)
  </i></font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$60</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">);
  </font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
  </font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$80</font><font color="#000080">;    </font><font color="#008000"><i>(* Now test the status Bytes saved *)
  </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Val1 <font color="#FF0000"><b>And </b></font><font color="#800000">$e0</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">((</font>Val2 <font color="#FF0000"><b>And </b></font><font color="#800000">$e0</font><font color="#000080">) = </font><font color="#800000">$c0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
    </b></font>AdlibCard <font color="#000080">:= </font>True    <font color="#008000"><i>(* Card was found *)
  </i></font><font color="#FF0000"><b>Else
    </b></font>AdlibCard <font color="#000080">:= </font>False<font color="#000080">;  </font><font color="#008000"><i>(* No Card Installed *)
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;                       </font><font color="#008000"><i>(* Clear the Screen *)
  </i></font>Write<font color="#000080">(</font><font color="#800000">' Adlib Card '</font><font color="#000080">);        </font><font color="#008000"><i>(* Prepare Response *)
  </i></font><font color="#FF0000"><b>If </b></font>AdlibCard <font color="#FF0000"><b>Then
    </b></font>Writeln<font color="#000080">( </font><font color="#800000">'Found!'</font><font color="#000080">)           </font><font color="#008000"><i>(* There is one *)
  </i></font><font color="#FF0000"><b>Else
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Not Found!'</font><font color="#000080">);       </font><font color="#008000"><i>(* Not! *)
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p></body>
</html>
