<html>
<head><title> "Sonic effects" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>Tones<font color="#000080">;

</font><font color="#008000"><i>{ TONES - a set of functions that provide some
  interesting sonic effects.  Useful for games
  or alerts.                                                                        }

</i></font><font color="#FF0000"><b>INTERFACE

PROCEDURE </b></font>Tone<font color="#000080">(</font>CycleLen<font color="#000080">,</font>NbrCycles<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Noise<font color="#000080">(</font>D<font color="#000080">: </font>Longint<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Chirp<font color="#000080">(</font>F1<font color="#000080">,</font>F2<font color="#000080">,</font>Cycles<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Sound2<font color="#000080">(</font>F<font color="#000080">: </font>Longint<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>NoSound2<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

</b></font><font color="#008000"><i>{ Tone - output a tone

  INP:        cyclen - Length (counts) for 1/2 cycle
         numcyc - number of cycles to make  }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Tone<font color="#000080">(</font>CycleLen<font color="#000080">,</font>NbrCycles<font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#FF0000"><b>VAR
        </b></font>T<font color="#000080">,</font>I<font color="#000080">,</font>J <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
   </b></font>NbrCycles <font color="#000080">:= </font>NbrCycles <font color="#FF0000"><b>SHL </b></font><font color="#800000">1</font><font color="#000080">;  </font><font color="#008000"><i>{# half Cycles}
        </i></font>T <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">];                </font><font color="#008000"><i>{Port contents}
        </i></font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>NbrCycles <font color="#FF0000"><b>DO
                BEGIN
                  </b></font>T <font color="#000080">:= </font>T <font color="#FF0000"><b>XOR </b></font><font color="#800000">2</font><font color="#000080">;
                  </font>Port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">] := </font>T<font color="#000080">;
        </font><font color="#FF0000"><b>FOR </b></font>J <font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>CycleLen <font color="#FF0000"><b>DO
      END
END</b></font><font color="#000080">;


</font><font color="#008000"><i>{ Noise - make noise for a certain amount of
  counts.

  INP:   D - the number of kilocounts of Noise}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Noise<font color="#000080">(</font>D<font color="#000080">: </font>Longint<font color="#000080">);
</font><font color="#FF0000"><b>VAR
        </b></font>Count <font color="#000080">: </font>Longint<font color="#000080">;
        </font>T<font color="#000080">,</font>J<font color="#000080">,</font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
        </b></font>T <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">];
        </font>Count <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>WHILE </b></font>Count <font color="#000080">&lt; </font>D <font color="#FF0000"><b>DO
      BEGIN
         </b></font>J <font color="#000080">:= (</font>Random<font color="#000080">(</font><font color="#800000">32768</font><font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">128</font><font color="#000080">) </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">4</font><font color="#000080">;
         </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>J <font color="#FF0000"><b>DO</b></font><font color="#000080">;
         </font>T <font color="#000080">:= </font>T <font color="#FF0000"><b>XOR </b></font><font color="#800000">2</font><font color="#000080">;
                   </font>Port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">] := </font>T<font color="#000080">;
                        </font>Inc<font color="#000080">(</font>Count<font color="#000080">,</font>J<font color="#000080">)
      </font><font color="#FF0000"><b>END
END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Chirp - create a 'bird Chirp' TYPE Noise

  INP:F1 - # OF counts FOR the starting freq.
                 F2 - # OF counts FOR the ending freq.
  Cycles - # OF Cycles OF each frequency }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Chirp<font color="#000080">(</font>F1<font color="#000080">,</font>F2<font color="#000080">,</font>Cycles<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>VAR
        </b></font>I<font color="#000080">,</font>J<font color="#000080">,</font>K<font color="#000080">,</font>L <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
        </b></font>L <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">];
        </font>Cycles <font color="#000080">:= </font>Cycles <font color="#000080">* </font><font color="#800000">2</font><font color="#000080">;
        </font>I <font color="#000080">:= </font>F1<font color="#000080">;
        </font><font color="#FF0000"><b>WHILE </b></font>I <font color="#000080">&lt;&gt; </font>F2 <font color="#FF0000"><b>DO
                BEGIN
                        FOR </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Cycles <font color="#FF0000"><b>DO
                                BEGIN
                                        </b></font>L <font color="#000080">:= </font>L <font color="#FF0000"><b>XOR </b></font><font color="#800000">2</font><font color="#000080">;
                                        </font>Port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">] := </font>L<font color="#000080">;
                                        </font><font color="#FF0000"><b>FOR </b></font>K <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>I <font color="#FF0000"><b>DO
                                END</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>IF </b></font>F1 <font color="#000080">&gt; </font>F2 <font color="#FF0000"><b>THEN </b></font>Dec<font color="#000080">(</font>I<font color="#000080">)
                        </font><font color="#FF0000"><b>ELSE </b></font>Inc<font color="#000080">(</font>I<font color="#000080">)
                </font><font color="#FF0000"><b>END
END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Sound2 - Generate a continuous tone using the
  internal timer.

  INP:        F - the desired frequeny }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Sound2<font color="#000080">(</font>F<font color="#000080">: </font>Longint<font color="#000080">);
</font><font color="#FF0000"><b>VAR
        </b></font>C <font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
        IF </b></font>F <font color="#000080">&lt; </font><font color="#800000">19 </font><font color="#FF0000"><b>THEN </b></font>F <font color="#000080">:= </font><font color="#800000">19</font><font color="#000080">;             </font><font color="#008000"><i>{Prevent overflow}
        </i></font>C <font color="#000080">:= </font><font color="#800000">1193180 </font><font color="#FF0000"><b>DIV </b></font>F<font color="#000080">;
        </font>Port<font color="#000080">[</font><font color="#800000">$43</font><font color="#000080">] := </font><font color="#800000">$B6</font><font color="#000080">;         </font><font color="#008000"><i>{Program new divisor}
        </i></font>Port<font color="#000080">[</font><font color="#800000">$42</font><font color="#000080">] := </font>C <font color="#FF0000"><b>MOD </b></font><font color="#800000">256</font><font color="#000080">;   </font><font color="#008000"><i>{Rate into the timer}
        </i></font>Port<font color="#000080">[</font><font color="#800000">$42</font><font color="#000080">] := </font>C <font color="#FF0000"><b>DIV </b></font><font color="#800000">256</font><font color="#000080">;
        </font>C <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">];         </font><font color="#008000"><i>{Enable speaker output}
        </i></font>Port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">] := </font>C <font color="#FF0000"><b>OR </b></font><font color="#800000">3     </font><font color="#008000"><i>{from the timer       }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>{ NoSound2 - turn off the continuous tone               }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>NoSound2<font color="#000080">;
</font><font color="#FF0000"><b>VAR
        </b></font>C <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
        </b></font>C <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">];             </font><font color="#008000"><i>{Mask off speaker}
        </i></font>Port<font color="#000080">[</font><font color="#800000">$61</font><font color="#000080">] := </font>C <font color="#FF0000"><b>AND </b></font><font color="#800000">$FC      </font><font color="#008000"><i>{output from timer}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p></body>
</html>
