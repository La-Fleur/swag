<html>
<head><title> "ProAudio Spectrum Mixer Unit" by PAT O'MALLEY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0094.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{--Title:       MVFUNCT.PAS
   Author:      Patrick O'Malley AKA Silicom Slim
   Constact:    e-mail: d005530c@dcfreenet.seflin.lib.fl.us
   Language:    Turbo Pascal v6.0
   Description: Functions and procedures to interface with the ProAudio
                Spectrum's mixer and volume controls.
   Status:      Public Domain

  This unit is a primer for programming the ProAudio Spectum basic or 16, it
doesn't seem to matter.
  IMPORTANT TECH NOTE: All settings are in percent! Just a decimal from 0 to
100. Very odd. And sometimes when you set a volume too low, it will just go
to 0. Basically what you enter will result in a volume +-2 percentage points
off what you entered. Doesn't make much difference.
  I have no idea what CrossChannels are. Or the FMSplitChips thing. They don't
seem too interesting anyhow.
  For the unknowing, mixers and volumes are basically the same thing. Setting
the output of a mixer changes it's volume if you play something that uses
that mixer. For example, a cd-rom drive is attached to the internal mixer
input. The volume functions aren't really just for volumes anyhow. They
control the treble, bass, loudness &amp; enhanced switches too.
  Most of the procedures and functions are simple to understand. The
GetFunctionTable procedure is used internally by the unit.

  I'd like to request code re:SoundBlaster mixer/vol stuff. --}

</i></font><font color="#FF0000"><b>Unit </b></font>MVFunct<font color="#000080">;

</font><font color="#FF0000"><b>interface

CONST
</b></font><font color="#008000"><i>{--volume channel select constants--}
{--These constants are used _only_ with the functions/procedures that use a
   call to functiontable.mvset(or get)volumefunction.
    VolMute is strange. It appears in the COMMON.INC file of the PAS-SDK
   but is never explained and doesn't seem to have an effect.
    VolLoudEnh is also odd. It is supposed to be used to set the Loudness
   and Enhanced switches (and it does). The only problem is that using
   a value of 100% turns _both_ on. Doing a 0% turns off only enhanced then.
   Maybe there is some trick I haven't discovered.
    VolBass &amp; VolTreble set the Bass and Treble.
    VolLeft and VolRight are the master volume settings.
    VolMode is some sort of modal setting. No documentation in the PAS-SDK.--}

</i></font>VolMute    <font color="#000080">= </font><font color="#800000">$40</font><font color="#000080">;
</font>VolLoudEnh <font color="#000080">= </font><font color="#800000">$41</font><font color="#000080">;
</font>VolBass    <font color="#000080">= </font><font color="#800000">$42</font><font color="#000080">;
</font>VolTreble  <font color="#000080">= </font><font color="#800000">$43</font><font color="#000080">;
</font>VolLeft    <font color="#000080">= </font><font color="#800000">$44</font><font color="#000080">;
</font>VolRight   <font color="#000080">= </font><font color="#800000">$45</font><font color="#000080">;
</font>VolMode    <font color="#000080">= </font><font color="#800000">$46</font><font color="#000080">;

</font><font color="#008000"><i>{--mixer selection constants--}
{--These constants are used when a mixer can either be an input of output
   mixer. For example, the internal connector (hooked to the cd-rom drive)
   can either output sound or input it. So you can select the levels at
   which it does these. For outputting sound levels use pmOUTPUTMIXER. --}
</i></font>pmOUTPUTMIXER <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">;
</font>pmINPUTMIXER  <font color="#000080">= </font><font color="#800000">$20</font><font color="#000080">;

</font><font color="#008000"><i>{--left channel selection values--}
{--these constants are used to select which mixer (they are: internal which
   is usually the CD-ROM, external which _can_ be attached to external music
   equiptment, microphone, PCM or digital sound, the internal speaker which
   is re-routed by the pro-audio out it's speakers and the sound-blaster
   emulation mixer. I have no idea what R_ or L_IMIXER is.--}
</i></font>L_FM <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">;
</font>L_IMIXER <font color="#000080">= </font><font color="#800000">$02</font><font color="#000080">;
</font>L_EXT <font color="#000080">= </font><font color="#800000">$03</font><font color="#000080">;
</font>L_INT <font color="#000080">= </font><font color="#800000">$04</font><font color="#000080">;
</font>L_MIC <font color="#000080">= </font><font color="#800000">$05</font><font color="#000080">;
</font>L_PCM <font color="#000080">= </font><font color="#800000">$06</font><font color="#000080">;
</font>L_SPEAKER <font color="#000080">= </font><font color="#800000">$07</font><font color="#000080">;
</font>L_FREE <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">;
</font>L_SBDAC <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">;

</font><font color="#008000"><i>{--right channel selection values--}
{--these constants can be used in places that ask for the channel to, for
   example, change the setting of. they are for the right channel only. --}
</i></font>R_FM <font color="#000080">= </font><font color="#800000">$08</font><font color="#000080">;
</font>R_IMIXER <font color="#000080">= </font><font color="#800000">$09</font><font color="#000080">;
</font>R_EXT <font color="#000080">= </font><font color="#800000">$0A</font><font color="#000080">;
</font>R_INT <font color="#000080">= </font><font color="#800000">$0B</font><font color="#000080">;
</font>R_MIC <font color="#000080">= </font><font color="#800000">$0C</font><font color="#000080">;
</font>R_PCM <font color="#000080">= </font><font color="#800000">$0D</font><font color="#000080">;
</font>R_SPEAKER <font color="#000080">= </font><font color="#800000">$0E</font><font color="#000080">;
</font>R_FREE <font color="#000080">= </font><font color="#800000">$0F</font><font color="#000080">;
</font>R_SBDAC <font color="#000080">= </font><font color="#800000">$0F</font><font color="#000080">;

</font><font color="#008000"><i>{--The following is used for the get/set, on/off procedures--}
</i></font>Get <font color="#000080">= </font>True<font color="#000080">;
</font>Set_ <font color="#000080">= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>On </b></font><font color="#000080">= </font>true<font color="#000080">;
</font>Off <font color="#000080">= </font>false<font color="#000080">;


</font><font color="#FF0000"><b>Type </b></font>tFunctionTable <font color="#000080">= </font><font color="#FF0000"><b>record
                        </b></font>MVSetMixerFunction<font color="#000080">,
                        </font>MVSetVolumeFunction<font color="#000080">,
                        </font>MVSetFilterFunction<font color="#000080">,
                        </font>MVSetCrossChannel<font color="#000080">,
                        </font>MVGetMixerFunction<font color="#000080">,
                        </font>MVGetVolumeFunction<font color="#000080">,
                        </font>MVGetFilterFunction<font color="#000080">,
                        </font>MVGetCrossChannel<font color="#000080">,
                        </font>MVRealSoundSwitch<font color="#000080">,
                        </font>MVFMSplitSwitch     <font color="#000080">: </font>Pointer<font color="#000080">;
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>FunctionTable <font color="#000080">: </font>tFunctionTable<font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>IsMVSOUNDInstalled <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>GetFunctionTable<font color="#000080">;             </font><font color="#008000"><i>{internal, used by MVFUNCT.TPU}
</i></font><font color="#FF0000"><b>Procedure </b></font>SetMasterVolume<font color="#000080">(</font>R<font color="#000080">,</font>L <font color="#000080">: </font>Boolean<font color="#000080">;</font>R_Setting<font color="#000080">,</font>L_Setting <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>SetMixer<font color="#000080">(</font>In_Out<font color="#000080">, </font>Channel_Select <font color="#000080">: </font>Byte<font color="#000080">; </font>Mixer_Setting <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>GetMasterVolume<font color="#000080">(</font>R<font color="#000080">,</font>L <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>R_Setting<font color="#000080">, </font>L_Setting <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Function </b></font>GetMixer<font color="#000080">(</font>In_Out<font color="#000080">, </font>Channel_Select <font color="#000080">: </font>Word<font color="#000080">) : </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetFilter<font color="#000080">(</font>Filter_Setting <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Function </b></font>GetFilter <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Get_Set_RealSound<font color="#000080">(</font>Get_Set <font color="#000080">: </font>Boolean<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>On_Off <font color="#000080">: </font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>SetVolume<font color="#000080">(</font>Channel<font color="#000080">,</font>Setting <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Function </b></font>GetVolume<font color="#000080">(</font>Channel <font color="#000080">: </font>Word<font color="#000080">) : </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>GetIRQ <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>GetDMA <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>implementation

Function </b></font>IsMVSOUNDInstalled <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{Basically this function checks for MVSOUND.SYS, the device driver that is
 required to do the mixer functions that follow. Simple. }
</i></font><font color="#FF0000"><b>Var </b></font>edx <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>IsMVSOUNDInstalled <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov  ax, 0bc00h
    mov  bx, 03f3fh
    xor  cx, cx
    xor  dx, dx
    int  2fh
    xor  cx, bx
    xor  dx, cx
    mov  [edx], dx
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>edx <font color="#000080">= </font><font color="#800000">$4d56 </font><font color="#FF0000"><b>then </b></font>IsMVSOUNDInstalled <font color="#000080">:= </font>True
  <font color="#FF0000"><b>else </b></font>IsMVSOUNDInstalled <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;    </font><font color="#008000"><i>{IsMVSOUNDInstalled func}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetFunctionTable<font color="#000080">;          </font><font color="#008000"><i>{used by the unit}
</i></font><font color="#FF0000"><b>Var </b></font>FTableSeg<font color="#000080">, </font>FTableOfs <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  Asm
    </b></font><font color="#FF00FF">mov  ax, 0bc03h
    int  2fh
    mov  [ftableofs], bx        </font><font color="#008000"><i>{function table offset}
    </i></font><font color="#FF00FF">mov  [ftableseg], dx        </font><font color="#008000"><i>{function table segment}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{--Move the table into the function table of pointers for pascal--}

</i></font>Move<font color="#000080">(</font>Mem<font color="#000080">[</font>ftableseg<font color="#000080">:</font>ftableofs<font color="#000080">],</font>Mem<font color="#000080">[</font>seg<font color="#000080">(</font>functiontable<font color="#000080">):</font>ofs<font color="#000080">(</font>functiontable<font color="#000080">)],</font><font color="#800000">40</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{GetFunctionTable proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>SetMasterVolume<font color="#000080">(</font>R<font color="#000080">,</font>L <font color="#000080">: </font>Boolean<font color="#000080">;</font>R_Setting<font color="#000080">,</font>L_Setting <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#008000"><i>{This procedure is actually the SetVolume procedure but is master volume
 channel specific.
 Vars R&amp;L : Boolean tell it which channel (right or left) to change.
 R_&amp;L_Setting are the % (0-100) to set the channel to.
}
</i></font><font color="#FF0000"><b>Begin
  If </b></font>R <font color="#FF0000"><b>then begin
  asm
    </b></font><font color="#FF00FF">mov  bx, R_Setting
    mov  cx, VolRight
    </font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF00FF">call functiontable.mvsetvolumefunction
    </font><font color="#008000"><i>{$F-}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>L <font color="#FF0000"><b>then begin
  asm
    </b></font><font color="#FF00FF">mov  bx, L_Setting
    mov  cx, VolLeft
    </font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF00FF">call functiontable.mvsetvolumefunction
    </font><font color="#008000"><i>{$F-}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{setmastervolume func}

</i></font><font color="#FF0000"><b>Procedure </b></font>SetMixer<font color="#000080">(</font>In_Out<font color="#000080">, </font>Channel_Select <font color="#000080">: </font>Byte<font color="#000080">; </font>Mixer_Setting <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#008000"><i>{ This procedure is used to set the I/O volume of one of the mixers.
  In_Out is a constant listed above under mixer selection constants.
  Channel_Select is either the right or left constant from the list above
  under channel selection values.
  Mixer_Setting is the % (0-100) to set the volume to.
}
</i></font><font color="#FF0000"><b>Begin
  Asm
    </b></font><font color="#FF00FF">mov  bx, Mixer_Setting
    xor  cx, cx
    xor  dx, dx
    mov  cl, In_Out
    mov  dl, Channel_Select
    </font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF00FF">call functiontable.MVSetMixerFunction
    </font><font color="#008000"><i>{$F-}
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;    </font><font color="#008000"><i>{setmixer proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetMasterVolume<font color="#000080">(</font>R<font color="#000080">,</font>L <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>R_Setting<font color="#000080">, </font>L_Setting <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#008000"><i>{ See SetMaster volume for the variable descriptions.
  Basically returns the current master volume.
}
</i></font><font color="#FF0000"><b>Var </b></font>Temp <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>R <font color="#FF0000"><b>then Begin
  Asm
    </b></font><font color="#FF00FF">mov  cx, VolRight
    </font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF00FF">call functiontable.mvgetvolumefunction
    </font><font color="#008000"><i>{$F-}
    </i></font><font color="#FF00FF">mov  [Temp], bx
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>R_Setting <font color="#000080">:= </font>Temp<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>L <font color="#FF0000"><b>then Begin
  asm
    </b></font><font color="#FF00FF">mov  cx, VolLeft
    </font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF00FF">call functiontable.mvgetvolumefunction
    </font><font color="#008000"><i>{$F-}
    </i></font><font color="#FF00FF">mov  [Temp], bx
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>L_Setting <font color="#000080">:= </font>Temp<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{getmastervolume proc}

</i></font><font color="#FF0000"><b>Function </b></font>GetMixer<font color="#000080">(</font>In_Out<font color="#000080">, </font>Channel_Select <font color="#000080">: </font>Word<font color="#000080">) : </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{ See SetMixer for variable descriptions.
  Basically just returns the volume of the selected mixer.
}
</i></font><font color="#FF0000"><b>Var </b></font>Temp <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  asm
    </b></font><font color="#FF00FF">mov  cx, In_Out
    mov  dx, Channel_Select
    </font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF00FF">call functiontable.mvgetmixerfunction
    </font><font color="#008000"><i>{$F-}
    </i></font><font color="#FF00FF">mov  [temp], bl
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>GetMixer <font color="#000080">:= </font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{getmixersetting proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>SetFilter<font color="#000080">(</font>Filter_Setting <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#008000"><i>{ I'm a little unsure about this function call. Here is what the SDK says:
    0% filters out amything higher than 0khz  (mute)
    100% filters out anything lower than 20khz
  It does mute it, but I can't attach a spectrum analyzer to the speaker
  to test the frequency.
  Filter_Setting is the % to filter?
}
</i></font><font color="#FF0000"><b>Begin
  Asm
    </b></font><font color="#FF00FF">xor  bx, bx
    mov  bl, Filter_Setting
    </font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF00FF">call functiontable.mvsetfilterfunction
    </font><font color="#008000"><i>{$F-}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{setfilter proc}

</i></font><font color="#FF0000"><b>Function </b></font>GetFilter <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{ See SetFilter }
</i></font><font color="#FF0000"><b>Var </b></font>Temp <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  asm
    </b></font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF00FF">call functiontable.mvgetfilterfunction
    </font><font color="#008000"><i>{$F-}
    </i></font><font color="#FF00FF">mov [Temp], bl
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>GetFilter <font color="#000080">:= </font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;  </font><font color="#008000"><i>{getfilter proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>Get_Set_RealSound<font color="#000080">(</font>Get_Set <font color="#000080">: </font>Boolean<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>On_Off <font color="#000080">: </font>boolean<font color="#000080">);
</font><font color="#008000"><i>{ If Get_Set is true then it is gotten, otherwise it is set.
  If On_Off is true then it is turned on, otherwise turned off.

  I added some constants: Get, Set_, On, Off for this procedure. If someone
  wants to make this procedure better, you have my blessing. Yuk.
}
</i></font><font color="#FF0000"><b>Var </b></font>ebx<font color="#000080">, </font>ecx<font color="#000080">, </font>return <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  if </b></font>Get_Set <font color="#FF0000"><b>then </b></font>ecx <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>else </b></font>ecx <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>on_off <font color="#FF0000"><b>then </b></font>ebx <font color="#000080">:= </font><font color="#800000">100 </font><font color="#FF0000"><b>else </b></font>ebx <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov bx, ebx
    mov cx, ecx
    </font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF00FF">call functiontable.mvrealsoundswitch
    </font><font color="#008000"><i>{$F-}
    </i></font><font color="#FF00FF">mov [return], bx
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Get_Set <font color="#FF0000"><b>then
    If </b></font>return <font color="#000080">= </font><font color="#800000">100 </font><font color="#FF0000"><b>then </b></font>On_Off <font color="#000080">:= </font>True
    <font color="#FF0000"><b>else </b></font>On_Off <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;   </font><font color="#008000"><i>{get_set_realsound}

</i></font><font color="#FF0000"><b>Function </b></font>GetIRQ <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{ Returns the IRQ of the PAS }
</i></font><font color="#FF0000"><b>Var </b></font>Res <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  asm
    </b></font><font color="#FF00FF">mov  ax, 0bc04h
    int  2fh
    mov  [res], cl
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>GETIRQ <font color="#000080">:= </font>res<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;   </font><font color="#008000"><i>{getirq proc}

</i></font><font color="#FF0000"><b>Function </b></font>GetDMA <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#008000"><i>{ Returns the DMA of the PAS }
</i></font><font color="#FF0000"><b>Var </b></font>res<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  asm
    </b></font><font color="#FF00FF">mov  ax, 0bc04h
    int  2fh
    mov  [res], bl
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>GetDMA <font color="#000080">:= </font>Res<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;  </font><font color="#008000"><i>{getdma proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>SetVolume<font color="#000080">(</font>Channel<font color="#000080">,</font>Setting <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#008000"><i>{ This procedure will change the setting of a specific channel specified by
  the constants listed under volume channel selection constants.
  Channel is the constant specifying the channel to change
  Setting is the % volume (0-100)
}
</i></font><font color="#FF0000"><b>Begin
  asm
    </b></font><font color="#FF00FF">mov  bx, Setting
    mov  cx, Channel
    </font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF00FF">call functiontable.mvsetvolumefunction
    </font><font color="#008000"><i>{$F-}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;  </font><font color="#008000"><i>{setvolume proc}

</i></font><font color="#FF0000"><b>Function </b></font>GetVolume<font color="#000080">(</font>Channel <font color="#000080">: </font>Word<font color="#000080">) : </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{ See setvolume }
</i></font><font color="#FF0000"><b>Var </b></font>Res<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  asm
    </b></font><font color="#FF00FF">mov  cx, channel
    </font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF00FF">call functiontable.mvgetvolumefunction
    </font><font color="#008000"><i>{$F-}
    </i></font><font color="#FF00FF">mov  [res], bl
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>GetVolume <font color="#000080">:= </font>Res<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{getvolume func}

</i></font><font color="#FF0000"><b>begin
  if </b></font>isMVSOUNDInstalled <font color="#FF0000"><b>then </b></font>getfunctiontable
  <font color="#FF0000"><b>else begin
         </b></font>Writeln<font color="#000080">(</font><font color="#800000">'MVSOUND.SYS is not installed.'</font><font color="#000080">);
         </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0094.PAS">Original</a><b>]</b></p></body>
</html>
