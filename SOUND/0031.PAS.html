<html>
<head><title> "SOUND Machine" by WIM VAN.VOLLENHOVEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{===========================================================================
Date: 08-31-93 (22:24)
From: WIM VAN.VOLLENHOVEN
Subj: Sound Module
---------------------------------------------------------------------------
Well.. here is the source code i've found in a pascal toolbox (ECO)
which emulates the play function of qbasic :-)

{
  call: play(string)

        music_string --- the string containing the encoded music to be
                         played.  the format is the same as that of the
                         microsoft basic play statement.  the string
                         must be &lt;= 254 characters in length.

  calls:  sound
          getint  (internal)

  remarks:  the characters accepted by this routine are:

            a - g       musical notes
            # or +      following a - g note, indicates sharp
            -           following a - g note, indicates flat
            &lt;           move down one octave
            &gt;           move up one octave
            .           dot previous note (extend note duration by 3/2)
            mn          normal duration (7/8 of interval between notes)
            ms          staccato duration
            ml          legato duration
            ln          length of note (n=1-64; 1=whole note,4=quarter note)
            pn          pause length (same n values as ln above)
            tn          tempo,n=notes/minute (n=32-255,default n=120)
            on          octave number (n=0-6,default n=4)
            nn          play note number n (n=0-84)

            the following two commands are ignored by play:

            mf          complete note before continuing
            mb          another process may begin before speaker is
                        finished playing note

  important --- setdefaultnotes must have been called at least once before
                this routine is called.
}

</i></font><font color="#FF0000"><b>unit </b></font>u_play<font color="#000080">;
</font><font color="#FF0000"><b>interface

uses
  </b></font>crt

  <font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>note_octave   <font color="#000080">: </font>integer <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;     </font><font color="#008000"><i>{ current octave for note            }
  </i></font>note_fraction <font color="#000080">: </font>real    <font color="#000080">= </font><font color="#800000">0.875</font><font color="#000080">; </font><font color="#008000"><i>{ fraction of duration given to note }
  </i></font>note_duration <font color="#000080">: </font>integer <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;     </font><font color="#008000"><i>{ duration of note     ^^semi-legato }
  </i></font>note_length   <font color="#000080">: </font>real    <font color="#000080">= </font><font color="#800000">0.25</font><font color="#000080">;  </font><font color="#008000"><i>{ length of note }
  </i></font>note_quarter  <font color="#000080">: </font>real    <font color="#000080">= </font><font color="#800000">500.0</font><font color="#000080">; </font><font color="#008000"><i>{ moderato pace (principal beat)     }



  </i></font><font color="#FF0000"><b>procedure </b></font>quitsound<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>startsound<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>errorbeep<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>warningbeep<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>smallbeep<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>setdefaultnotes<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>play<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>beep<font color="#000080">(</font>h<font color="#000080">, </font>l<font color="#000080">: </font>word<font color="#000080">);



</font><font color="#FF0000"><b>implementation




  procedure </b></font>quitsound<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">: </font>word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    for </b></font>i <font color="#000080">:= </font><font color="#800000">100 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do begin </b></font>sound<font color="#000080">(</font>i<font color="#000080">*</font><font color="#800000">10</font><font color="#000080">); </font>delay<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">800 </font><font color="#FF0000"><b>do begin </b></font>sound<font color="#000080">(</font>i<font color="#000080">*</font><font color="#800000">10</font><font color="#000080">); </font>delay<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>nosound<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>startsound<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">: </font>word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    for </b></font>i <font color="#000080">:= </font><font color="#800000">100 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do begin </b></font>sound<font color="#000080">(</font>i<font color="#000080">*</font><font color="#800000">15</font><font color="#000080">); </font>delay<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">100 </font><font color="#FF0000"><b>do begin </b></font>sound<font color="#000080">(</font>i<font color="#000080">*</font><font color="#800000">15</font><font color="#000080">); </font>delay<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font>nosound<font color="#000080">;
    </font>delay<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">); </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">100 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do begin </b></font>sound<font color="#000080">(</font>i<font color="#000080">*</font><font color="#800000">10</font><font color="#000080">); </font>delay<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>nosound<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>procedure </b></font>errorbeep<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>sound<font color="#000080">(</font><font color="#800000">2000</font><font color="#000080">); </font>delay<font color="#000080">(</font><font color="#800000">75</font><font color="#000080">); </font>sound<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">); </font>delay<font color="#000080">(</font><font color="#800000">75</font><font color="#000080">); </font>nosound<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>procedure </b></font>warningbeep<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>sound<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">); </font>delay<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">); </font>nosound<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>smallbeep<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>sound<font color="#000080">(</font><font color="#800000">300</font><font color="#000080">); </font>delay<font color="#000080">(</font><font color="#800000">50</font><font color="#000080">); </font>nosound<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;





</font><font color="#FF0000"><b>procedure </b></font>setdefaultnotes<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>note_octave   <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;             </font><font color="#008000"><i>{ default octave                      }
   </i></font>note_fraction <font color="#000080">:= </font><font color="#800000">0.875</font><font color="#000080">;         </font><font color="#008000"><i>{ default sustain is semi-legato      }
   </i></font>note_length   <font color="#000080">:= </font><font color="#800000">0.25</font><font color="#000080">;          </font><font color="#008000"><i>{ note is quarter note by default     }
   </i></font>note_quarter  <font color="#000080">:= </font><font color="#800000">500.0</font><font color="#000080">;         </font><font color="#008000"><i>{ moderato pace by default            }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>procedure </b></font>play<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>const
                                      </b></font><font color="#008000"><i>{ offsets in octave of natural notes }
 </i></font>note_offset   <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[ </font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'G' </font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer <font color="#000080">= (</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">);

                                      </font><font color="#008000"><i>{ frequencies for 7 octaves          }
   </i></font>note_freqs<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[ </font><font color="#800000">0 </font><font color="#000080">.. </font><font color="#800000">84 </font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer <font color="#000080">=
</font><font color="#008000"><i>{
      c    c#     d    d#     e     f    f#     g    g#     a    a#     b
}
</i></font><font color="#000080">(    </font><font color="#800000">0</font><font color="#000080">,
     </font><font color="#800000">65</font><font color="#000080">,  </font><font color="#800000">69</font><font color="#000080">,  </font><font color="#800000">73</font><font color="#000080">,  </font><font color="#800000">78</font><font color="#000080">,  </font><font color="#800000">82</font><font color="#000080">,  </font><font color="#800000">87</font><font color="#000080">,  </font><font color="#800000">92</font><font color="#000080">,  </font><font color="#800000">98</font><font color="#000080">, </font><font color="#800000">104</font><font color="#000080">, </font><font color="#800000">110</font><font color="#000080">, </font><font color="#800000">116</font><font color="#000080">, </font><font color="#800000">123</font><font color="#000080">,
    </font><font color="#800000">131</font><font color="#000080">, </font><font color="#800000">139</font><font color="#000080">, </font><font color="#800000">147</font><font color="#000080">, </font><font color="#800000">156</font><font color="#000080">, </font><font color="#800000">165</font><font color="#000080">, </font><font color="#800000">175</font><font color="#000080">, </font><font color="#800000">185</font><font color="#000080">, </font><font color="#800000">196</font><font color="#000080">, </font><font color="#800000">208</font><font color="#000080">, </font><font color="#800000">220</font><font color="#000080">, </font><font color="#800000">233</font><font color="#000080">, </font><font color="#800000">247</font><font color="#000080">,
    </font><font color="#800000">262</font><font color="#000080">, </font><font color="#800000">278</font><font color="#000080">, </font><font color="#800000">294</font><font color="#000080">, </font><font color="#800000">312</font><font color="#000080">, </font><font color="#800000">330</font><font color="#000080">, </font><font color="#800000">350</font><font color="#000080">, </font><font color="#800000">370</font><font color="#000080">, </font><font color="#800000">392</font><font color="#000080">, </font><font color="#800000">416</font><font color="#000080">, </font><font color="#800000">440</font><font color="#000080">, </font><font color="#800000">466</font><font color="#000080">, </font><font color="#800000">494</font><font color="#000080">,
    </font><font color="#800000">524</font><font color="#000080">, </font><font color="#800000">556</font><font color="#000080">, </font><font color="#800000">588</font><font color="#000080">, </font><font color="#800000">624</font><font color="#000080">, </font><font color="#800000">660</font><font color="#000080">, </font><font color="#800000">700</font><font color="#000080">, </font><font color="#800000">740</font><font color="#000080">, </font><font color="#800000">784</font><font color="#000080">, </font><font color="#800000">832</font><font color="#000080">, </font><font color="#800000">880</font><font color="#000080">, </font><font color="#800000">932</font><font color="#000080">, </font><font color="#800000">988</font><font color="#000080">,
   </font><font color="#800000">1048</font><font color="#000080">,</font><font color="#800000">1112</font><font color="#000080">,</font><font color="#800000">1176</font><font color="#000080">,</font><font color="#800000">1248</font><font color="#000080">,</font><font color="#800000">1320</font><font color="#000080">,</font><font color="#800000">1400</font><font color="#000080">,</font><font color="#800000">1480</font><font color="#000080">,</font><font color="#800000">1568</font><font color="#000080">,</font><font color="#800000">1664</font><font color="#000080">,</font><font color="#800000">1760</font><font color="#000080">,</font><font color="#800000">1864</font><font color="#000080">,</font><font color="#800000">1976</font><font color="#000080">,
   </font><font color="#800000">2096</font><font color="#000080">,</font><font color="#800000">2224</font><font color="#000080">,</font><font color="#800000">2352</font><font color="#000080">,</font><font color="#800000">2496</font><font color="#000080">,</font><font color="#800000">2640</font><font color="#000080">,</font><font color="#800000">2800</font><font color="#000080">,</font><font color="#800000">2960</font><font color="#000080">,</font><font color="#800000">3136</font><font color="#000080">,</font><font color="#800000">3328</font><font color="#000080">,</font><font color="#800000">3520</font><font color="#000080">,</font><font color="#800000">3728</font><font color="#000080">,</font><font color="#800000">3952</font><font color="#000080">,
   </font><font color="#800000">4192</font><font color="#000080">,</font><font color="#800000">4448</font><font color="#000080">,</font><font color="#800000">4704</font><font color="#000080">,</font><font color="#800000">4992</font><font color="#000080">,</font><font color="#800000">5280</font><font color="#000080">,</font><font color="#800000">5600</font><font color="#000080">,</font><font color="#800000">5920</font><font color="#000080">,</font><font color="#800000">6272</font><font color="#000080">,</font><font color="#800000">6656</font><font color="#000080">,</font><font color="#800000">7040</font><font color="#000080">,</font><font color="#800000">7456</font><font color="#000080">,</font><font color="#800000">7904 </font><font color="#000080">);

   </font>quarter_note <font color="#000080">= </font><font color="#800000">0.25</font><font color="#000080">;            </font><font color="#008000"><i>{ length of a quarter note }

   </i></font>digits <font color="#000080">: </font><font color="#FF0000"><b>set of </b></font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9' </font><font color="#000080">= [</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">];

</font><font color="#FF0000"><b>var

   </b></font>play_freq     <font color="#000080">: </font>integer<font color="#000080">;        </font><font color="#008000"><i>{ frequency of note to be played }
   </i></font>play_duration <font color="#000080">: </font>integer<font color="#000080">;        </font><font color="#008000"><i>{ duration to sound note }
   </i></font>rest_duration <font color="#000080">: </font>integer<font color="#000080">;        </font><font color="#008000"><i>{ duration of rest after a note }
   </i></font>i             <font color="#000080">: </font>integer<font color="#000080">;        </font><font color="#008000"><i>{ offset in music string }
   </i></font>c             <font color="#000080">: </font>char<font color="#000080">;           </font><font color="#008000"><i>{ current character in music string }
                                   { note frequencies }
   </i></font>freq          <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer <font color="#FF0000"><b>absolute </b></font>note_freqs<font color="#000080">;
   </font>n             <font color="#000080">: </font>integer<font color="#000080">;
   </font>xn            <font color="#000080">: </font>real<font color="#000080">;
   </font>k             <font color="#000080">: </font>integer<font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>getint <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>n<font color="#000080">: </font>integer<font color="#000080">;

  </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ getint }
    </i></font>n <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>while</b></font><font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits<font color="#000080">) </font><font color="#FF0000"><b>do begin </b></font>n <font color="#000080">:= </font>n<font color="#000080">*</font><font color="#800000">10</font><font color="#000080">+</font>ord<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">])-</font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">); </font>inc<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>dec<font color="#000080">(</font>i<font color="#000080">); </font>getint <font color="#000080">:= </font>n<font color="#000080">;
  </font><font color="#FF0000"><b>end   </b></font><font color="#008000"><i>{ getint }</i></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>s <font color="#000080">:= </font>s <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;                   </font><font color="#008000"><i>{ append blank to end of music string }
  </i></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                           </font><font color="#008000"><i>{ point to first character in music }
  </i></font><font color="#FF0000"><b>while</b></font><font color="#000080">(</font>i <font color="#000080">&lt; </font>length<font color="#000080">(</font>s<font color="#000080">)) </font><font color="#FF0000"><b>do begin      </b></font><font color="#008000"><i>{ begin loop over music string }
    </i></font>c <font color="#000080">:= </font>upcase<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]);        </font><font color="#008000"><i>{ get next character in music string }
    </i></font><font color="#FF0000"><b>case </b></font>c <font color="#FF0000"><b>of                 </b></font><font color="#008000"><i>{ interpret it                       }
       </i></font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'G' </font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ a note }
          </i></font>n         <font color="#000080">:= </font>note_offset<font color="#000080">[ </font>c <font color="#000080">];
          </font>play_freq <font color="#000080">:= </font>freq<font color="#000080">[ </font>note_octave <font color="#000080">,</font>n <font color="#000080">];
          </font>xn <font color="#000080">:= </font>note_quarter <font color="#000080">* (</font>note_length <font color="#000080">/ </font>quarter_note<font color="#000080">);
          </font>play_duration <font color="#000080">:= </font>trunc<font color="#000080">(</font>xn <font color="#000080">* </font>note_fraction<font color="#000080">);
          </font>rest_duration <font color="#000080">:= </font>trunc<font color="#000080">(</font>xn <font color="#000080">* (</font><font color="#800000">1.0 </font><font color="#000080">- </font>note_fraction<font color="#000080">));
                                      </font><font color="#008000"><i>{ check for sharp/flat }
          </i></font><font color="#FF0000"><b>if </b></font>s<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'#'</font><font color="#000080">,</font><font color="#800000">'+'</font><font color="#000080">,</font><font color="#800000">'-' </font><font color="#000080">] </font><font color="#FF0000"><b>then
             begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
                </font><font color="#FF0000"><b>case </b></font>s<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>of
                   </b></font><font color="#800000">'#'</font><font color="#000080">,
                   </font><font color="#800000">'+' </font><font color="#000080">: </font>play_freq <font color="#000080">:=
                            </font>freq<font color="#000080">[ </font>note_octave <font color="#000080">,</font>succ<font color="#000080">(</font>n<font color="#000080">) ];
                   </font><font color="#800000">'-' </font><font color="#000080">: </font>play_freq <font color="#000080">:=
                            </font>freq<font color="#000080">[ </font>note_octave <font color="#000080">,</font>pred<font color="#000080">(</font>n<font color="#000080">) ];
                   </font><font color="#FF0000"><b>else  </b></font><font color="#000080">;
                </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ case }</i></font><font color="#000080">;

             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

                   </font><font color="#008000"><i>{ check for note length }

          </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits<font color="#000080">) </font><font color="#FF0000"><b>then
             begin

                </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
                </font>n  <font color="#000080">:= </font>getint<font color="#000080">;
                </font>xn <font color="#000080">:= (</font><font color="#800000">1.0 </font><font color="#000080">/ </font>n<font color="#000080">) / </font>quarter_note<font color="#000080">;

                </font>play_duration <font color="#000080">:=
                    </font>trunc<font color="#000080">(</font>note_fraction <font color="#000080">* </font>note_quarter <font color="#000080">* </font>xn<font color="#000080">);

                </font>rest_duration <font color="#000080">:=
                   </font>trunc<font color="#000080">((</font><font color="#800000">1.0 </font><font color="#000080">- </font>note_fraction<font color="#000080">) *
                          </font>xn <font color="#000080">* </font>note_quarter<font color="#000080">);

             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                   </font><font color="#008000"><i>{ check for dotting }

             </i></font><font color="#FF0000"><b>if </b></font>s<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'.' </font><font color="#FF0000"><b>then
                begin

                   </b></font>xn <font color="#000080">:= </font><font color="#800000">1.0</font><font color="#000080">;

                   </font><font color="#FF0000"><b>while</b></font><font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>do
                      begin
                         </b></font>xn <font color="#000080">:= </font>xn <font color="#000080">* </font><font color="#800000">1.5</font><font color="#000080">;
                         </font>inc<font color="#000080">(</font>i<font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

                   </font>play_duration <font color="#000080">:=
                       </font>trunc<font color="#000080">(</font>play_duration <font color="#000080">* </font>xn<font color="#000080">);

                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

                       </font><font color="#008000"><i>{ play the note }

          </i></font>sound<font color="#000080">(</font>play_freq<font color="#000080">);
          </font>delay<font color="#000080">(</font>play_duration<font color="#000080">);
          </font>nosound<font color="#000080">;
          </font>delay<font color="#000080">(</font>rest_duration<font color="#000080">);
        </font><font color="#FF0000"><b>end   </b></font><font color="#008000"><i>{ a note }</i></font><font color="#000080">;

       </font><font color="#800000">'M' </font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ 'M' commands }
         </i></font>inc<font color="#000080">(</font>i<font color="#000080">);
         </font>c <font color="#000080">:= </font>s<font color="#000080">[</font>i<font color="#000080">];
         </font><font color="#FF0000"><b>case </b></font>c <font color="#FF0000"><b>of
           </b></font><font color="#800000">'F' </font><font color="#000080">: ;
           </font><font color="#800000">'B' </font><font color="#000080">: ;
           </font><font color="#800000">'N' </font><font color="#000080">: </font>note_fraction <font color="#000080">:= </font><font color="#800000">0.875</font><font color="#000080">;
           </font><font color="#800000">'L' </font><font color="#000080">: </font>note_fraction <font color="#000080">:= </font><font color="#800000">1.000</font><font color="#000080">;
           </font><font color="#800000">'S' </font><font color="#000080">: </font>note_fraction <font color="#000080">:= </font><font color="#800000">0.750</font><font color="#000080">;
           </font><font color="#FF0000"><b>else </b></font><font color="#000080">;
         </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ case }</i></font><font color="#000080">;
       </font><font color="#FF0000"><b>end   </b></font><font color="#008000"><i>{ 'M' commands }</i></font><font color="#000080">;

       </font><font color="#800000">'O' </font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ set octave }
         </i></font>inc<font color="#000080">(</font>i<font color="#000080">);
         </font>n <font color="#000080">:= </font>ord<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]) - </font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>n <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>n <font color="#000080">&gt; </font><font color="#800000">6</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>n <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
         </font>note_octave <font color="#000080">:= </font>n<font color="#000080">;
       </font><font color="#FF0000"><b>end   </b></font><font color="#008000"><i>{ set octave }</i></font><font color="#000080">;

       </font><font color="#800000">'&lt;' </font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ drop an octave }
         </i></font><font color="#FF0000"><b>if </b></font>note_octave <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>dec<font color="#000080">(</font>note_octave<font color="#000080">);
       </font><font color="#FF0000"><b>end   </b></font><font color="#008000"><i>{ drop an octave }</i></font><font color="#000080">;

       </font><font color="#800000">'&gt;' </font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ ascend an octave }
         </i></font><font color="#FF0000"><b>if </b></font>note_octave <font color="#000080">&lt; </font><font color="#800000">6 </font><font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>note_octave<font color="#000080">);
       </font><font color="#FF0000"><b>end   </b></font><font color="#008000"><i>{ ascend an octave }</i></font><font color="#000080">;

       </font><font color="#800000">'N' </font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ play note n }
         </i></font>inc<font color="#000080">(</font>i<font color="#000080">); </font>n <font color="#000080">:= </font>getint<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>n <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>n <font color="#000080">&lt;= </font><font color="#800000">84</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
           </b></font>play_freq     <font color="#000080">:= </font>note_freqs<font color="#000080">[ </font>n <font color="#000080">];
           </font>xn            <font color="#000080">:= </font>note_quarter <font color="#000080">* (</font>note_length <font color="#000080">/ </font>quarter_note<font color="#000080">);
           </font>play_duration <font color="#000080">:= </font>trunc<font color="#000080">(</font>xn <font color="#000080">* </font>note_fraction<font color="#000080">);
           </font>rest_duration <font color="#000080">:= </font>trunc<font color="#000080">(</font>xn <font color="#000080">* (</font><font color="#800000">1.0 </font><font color="#000080">- </font>note_fraction<font color="#000080">));
         </font><font color="#FF0000"><b>end else if </b></font><font color="#000080">(</font>n <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
           </b></font>play_freq     <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>play_duration <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
           </font>rest_duration <font color="#000080">:= </font>trunc<font color="#000080">(</font>note_fraction <font color="#000080">* </font>note_quarter <font color="#000080">*
                                 (</font>note_length <font color="#000080">/ </font>quarter_note<font color="#000080">));
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font>sound<font color="#000080">(</font>play_freq<font color="#000080">); </font>delay<font color="#000080">(</font>play_duration<font color="#000080">); </font>nosound<font color="#000080">;
         </font>delay<font color="#000080">(</font>rest_duration<font color="#000080">);
       </font><font color="#FF0000"><b>end   </b></font><font color="#008000"><i>{ play note n }</i></font><font color="#000080">;
       </font><font color="#800000">'L' </font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ set length of notes }
         </i></font>inc<font color="#000080">(</font>i<font color="#000080">); </font>n <font color="#000080">:= </font>getint<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>n <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>note_length <font color="#000080">:= </font><font color="#800000">1.0 </font><font color="#000080">/ </font>n<font color="#000080">;
       </font><font color="#FF0000"><b>end   </b></font><font color="#008000"><i>{ set length of notes }</i></font><font color="#000080">;

       </font><font color="#800000">'T' </font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ # of quarter notes in a minute }
         </i></font>inc<font color="#000080">(</font>i<font color="#000080">); </font>n <font color="#000080">:= </font>getint<font color="#000080">;
         </font>note_quarter <font color="#000080">:= (</font><font color="#800000">1092.0 </font><font color="#000080">/ </font><font color="#800000">18.2 </font><font color="#000080">/ </font>n<font color="#000080">) * </font><font color="#800000">1000.0</font><font color="#000080">;
       </font><font color="#FF0000"><b>end   </b></font><font color="#008000"><i>{ # of quarter notes in a minute }</i></font><font color="#000080">;

       </font><font color="#800000">'P' </font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ pause }
         </i></font>inc<font color="#000080">(</font>i<font color="#000080">); </font>n <font color="#000080">:= </font>getint<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>n <font color="#000080">&lt;  </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>n <font color="#000080">&gt; </font><font color="#800000">64</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>n <font color="#000080">:= </font><font color="#800000">64</font><font color="#000080">;
         </font>play_freq <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>play_duration <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
         </font>rest_duration <font color="#000080">:= </font>trunc<font color="#000080">(((</font><font color="#800000">1.0 </font><font color="#000080">/ </font>n<font color="#000080">) / </font>quarter_note<font color="#000080">) * </font>note_quarter<font color="#000080">);
         </font>sound<font color="#000080">(</font>play_freq<font color="#000080">); </font>delay<font color="#000080">(</font>play_duration<font color="#000080">); </font>nosound<font color="#000080">;
         </font>delay<font color="#000080">(</font>rest_duration<font color="#000080">);
       </font><font color="#FF0000"><b>end   </b></font><font color="#008000"><i>{ pause }</i></font><font color="#000080">;

       </font><font color="#FF0000"><b>else  </b></font><font color="#008000"><i>{ ignore other stuff }</i></font><font color="#000080">;
    </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ case }</i></font><font color="#000080">;
    </font>inc<font color="#000080">(</font>i<font color="#000080">);
  </font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ interpret music }</i></font><font color="#000080">;
  </font>nosound<font color="#000080">;                         </font><font color="#008000"><i>{ make sure sound turned off when through }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>beep<font color="#000080">(</font>h<font color="#000080">, </font>l<font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>sound<font color="#000080">(</font>h<font color="#000080">); </font>delay<font color="#000080">(</font>l<font color="#000080">); </font>nosound<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">. </font><font color="#008000"><i>{ of unit }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p></body>
</html>
