<html>
<head><title> "CD Player Program" by PAT O'MALLEY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0089.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ I noticed that more than a few people wanted to know how to program a
  CD player. I did too, once. So here is the fruit of my labor.
  The programming isn't all that good. I wrote it to be SMALL.

  There are quite a number of unused variables, procedures, etc. Just
  try them!

  I'd like to thank Kristian Leonhard for two of his procedures. Saved a
  big amount of space and bad computing.

  No messages about how I _should_ have coded something. If you can make it
  so much better DO IT.

  I recommend a file called MSCDFUNC.DOC which contains all of the info
  used in this program. EXCEPT for the stuff that Kristian Leonhard wrote.

  Programmed by: Patrick O'Malley, 1995 
}

{$X+}        {I know, bad directive}
</i></font><font color="#FF0000"><b>Program </b></font>CDPlayer<font color="#000080">;
</font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>Type  </b></font>Std <font color="#000080">= </font><font color="#FF0000"><b>record             </b></font><font color="#008000"><i>{read and write}
                 </i></font>length <font color="#000080">: </font>byte<font color="#000080">;
                 </font>subcode <font color="#000080">: </font>byte<font color="#000080">;
                 </font>cmdcode <font color="#000080">: </font>byte<font color="#000080">;
                 </font>status <font color="#000080">: </font>word<font color="#000080">;
                 </font>res <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
                 </font><font color="#008000"><i>{---Nothing special between READ and WRITE----}
                 </i></font>MedDesc <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>XFerAddr <font color="#000080">: </font>Pointer<font color="#000080">;
                 </font>XFerbytes <font color="#000080">: </font>Word<font color="#000080">;
                 </font>SSNum <font color="#000080">: </font>Word<font color="#000080">;
                 </font>ReqPtr <font color="#000080">: </font>Longint<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>Playreq <font color="#000080">= </font><font color="#FF0000"><b>record            </b></font><font color="#008000"><i>{play}
                  </i></font>Length <font color="#000080">: </font>Byte<font color="#000080">;
                  </font>SubCode <font color="#000080">: </font>Byte<font color="#000080">;        </font><font color="#008000"><i>{0?}
                  </i></font>CmdCode <font color="#000080">: </font>Byte<font color="#000080">;        </font><font color="#008000"><i>{132}
                  </i></font>Status <font color="#000080">: </font>Word<font color="#000080">;
                  </font>Res <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
                  </font>AddrMode <font color="#000080">: </font>Byte<font color="#000080">;
                  </font>StrtSec <font color="#000080">: </font>Longint<font color="#000080">;
                  </font>numSect <font color="#000080">: </font>Longint<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>Qinfo <font color="#000080">= </font><font color="#FF0000"><b>record         </b></font><font color="#008000"><i>{QI}           {uses IOCTLI header}
                </i></font>CtlCode <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>{12}
                </i></font>CTl_ADR <font color="#000080">: </font>Byte<font color="#000080">;
                </font>TNO <font color="#000080">: </font>Byte<font color="#000080">;
                </font>POINT <font color="#000080">: </font>Byte<font color="#000080">;
                </font>MIN <font color="#000080">: </font>Byte<font color="#000080">;
                </font>SEC <font color="#000080">: </font>Byte<font color="#000080">;
                </font>Frame <font color="#000080">: </font>Byte<font color="#000080">;
                </font>Zero <font color="#000080">: </font>Byte<font color="#000080">;
                </font>AMIN <font color="#000080">: </font>Byte<font color="#000080">;
                </font>ASEc <font color="#000080">: </font>Byte<font color="#000080">;
                </font>AFRAME <font color="#000080">: </font>Byte<font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>DiskInfo <font color="#000080">= </font><font color="#FF0000"><b>record          </b></font><font color="#008000"><i>{DI}        {uses IOCTLI header}
                   </i></font>CtlCode <font color="#000080">: </font>Byte<font color="#000080">;  </font><font color="#008000"><i>{10}
                   </i></font>LowTrack <font color="#000080">: </font>Byte<font color="#000080">;
                   </font>HiTrack <font color="#000080">: </font>Byte<font color="#000080">;
                   </font>StrtSect <font color="#000080">: </font>Longint<font color="#000080">;
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>TrackInfo <font color="#000080">= </font><font color="#FF0000"><b>record        </b></font><font color="#008000"><i>{TI}         {uses IOCTLI header}
                    </i></font>CtlCode <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>TrackNum <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>TStart <font color="#000080">: </font>Longint<font color="#000080">;
                    </font>TCI <font color="#000080">: </font>Byte<font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>Eject <font color="#000080">= </font><font color="#FF0000"><b>record           </b></font><font color="#008000"><i>{EJ}          {uses IOCTLO header}
                </i></font>CtlCode <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>{0}
              </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>RstDrive <font color="#000080">= </font><font color="#FF0000"><b>record
                   </b></font>CtlCode <font color="#000080">: </font>Byte<font color="#000080">;
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>MedType <font color="#000080">= </font><font color="#FF0000"><b>record
                  </b></font>CtlCode <font color="#000080">: </font>Byte<font color="#000080">;
                  </font>MediaByte <font color="#000080">: </font>Byte<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>OneTime <font color="#000080">= </font><font color="#FF0000"><b>record
                  </b></font>Minute <font color="#000080">: </font>Byte<font color="#000080">;
                  </font>Second <font color="#000080">: </font>Byte<font color="#000080">;
                  </font>Frame  <font color="#000080">: </font>Byte<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>RedBookFormat <font color="#000080">= </font><font color="#FF0000"><b>Record
                        </b></font>Frame  <font color="#000080">: </font>Byte<font color="#000080">;
                        </font>Second <font color="#000080">: </font>Byte<font color="#000080">;
                        </font>Minute <font color="#000080">: </font>Byte<font color="#000080">;
                        </font>Unused <font color="#000080">: </font>Byte<font color="#000080">;
                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>AudioTrackType <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>RedBookFormat<font color="#000080">;

</font><font color="#FF0000"><b>Var      </b></font><font color="#008000"><i>{I think some of these vars are unused ;) }
    </i></font>StdHdr <font color="#000080">: </font>Std<font color="#000080">;
    </font>Play <font color="#000080">: </font>Playreq<font color="#000080">;
    </font>QI <font color="#000080">: </font>Qinfo<font color="#000080">;
    </font>DI <font color="#000080">: </font>DiskInfo<font color="#000080">;
    </font>TI <font color="#000080">: </font>TrackInfo<font color="#000080">;
    </font>EJ <font color="#000080">: </font>Eject<font color="#000080">;
    </font>Rst <font color="#000080">: </font>RstDrive<font color="#000080">;
    </font>Media <font color="#000080">: </font>MedType<font color="#000080">;
    </font><font color="#008000"><i>{---Universal variables---}
    </i></font>TStart <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">64</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>OneTime<font color="#000080">;
    </font>TLength <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">64</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>OneTime<font color="#000080">;
    </font>StdOfs <font color="#000080">: </font>Word<font color="#000080">;
    </font>CDNum <font color="#000080">: </font>Word<font color="#000080">;
    </font>NumDrives <font color="#000080">: </font>Word<font color="#000080">;       </font><font color="#008000"><i>{number of CD-ROM devices found}
    </i></font>TrNum <font color="#000080">: </font>Byte<font color="#000080">;
    </font>DrvList <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">26</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">; </font><font color="#008000"><i>{list of CD-ROM devices}
    </i></font>Tracks <font color="#000080">: </font>AudioTrackType<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LongMul<font color="#000080">(</font>X<font color="#000080">,</font>Y <font color="#000080">: </font>Integer<font color="#000080">) : </font>Longint<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">mov ax,X
  imul Y
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SendDDR<font color="#000080">;
</font><font color="#008000"><i>{Sends a device driver request. In this case to the CD-ROM driver}
</i></font><font color="#FF0000"><b>Begin
  asm
    </b></font><font color="#FF00FF">push ds
    mov ax,ds
    mov es,ax
    mov ax,1510h
    mov bx,StdOfs
    mov cx,CDNum
    Int 2fh
    pop ds
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{sendDDR}

</i></font><font color="#FF0000"><b>Function </b></font>IsInstalled <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  asm
    </b></font><font color="#FF00FF">mov ax,1500h
    int 2fh
    mov numdrives,bx
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Numdrives <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>IsInstalled <font color="#000080">:= </font>False
    <font color="#FF0000"><b>else </b></font>IsInstalled <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{IsInstalled func}

</i></font><font color="#FF0000"><b>Function </b></font>MediaChanged <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>FillChar<font color="#000080">(</font>StdHdr<font color="#000080">,</font>SizeOf<font color="#000080">(</font>StdHdr<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font>StdHdr<font color="#000080">.</font>Length <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>StdHdr<font color="#000080">);
  </font>StdHdr<font color="#000080">.</font>CmdCode <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>XFerAddr <font color="#000080">:= </font>Addr<font color="#000080">(</font>Media<font color="#000080">);
  </font>StdHdr<font color="#000080">.</font>XFerBytes <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
  </font>Media<font color="#000080">.</font>CtlCode <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
  </font>SendDDR<font color="#000080">;
  </font>MediaChanged <font color="#000080">:= </font>Media<font color="#000080">.</font>MediaByte<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetDrvLetrs<font color="#000080">;
</font><font color="#008000"><i>{Gets the list of CD-ROM devices in the system. It returns a number for
each drive. For example, if drive 'D' is a CD-ROM and the only one in the
system, DrvList[1] would equal 3. Remember: A=0,B=1,C=2,D=3. DrvList[x]
can be used to play any cd device. DrvList[2] would be the second device,etc.}
</i></font><font color="#FF0000"><b>Begin
  asm
    </b></font><font color="#FF00FF">mov ax,ds
    mov es,ax
    mov ax,150dh
    mov bx,offset drvlist
    int 2fh
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{getdrvletrs proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetDriverName<font color="#000080">(</font>CDROMNumber<font color="#000080">:</font>Byte<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>Name<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
 </font><font color="#008000"><i>{ Also from Kristian Leonhard. Interesting procedure. }
 { CDROMNumber = 1 .. 26 }
 { 1 means first cdrom number }
 </i></font><font color="#FF0000"><b>Var
  </b></font>Data <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">129</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Byte<font color="#000080">;
  </font>Offs <font color="#000080">: </font>Word<font color="#000080">;
  </font>Segm <font color="#000080">: </font>Word<font color="#000080">;
  </font>DSeg <font color="#000080">: </font>Word<font color="#000080">;
  </font>DOfs <font color="#000080">: </font>Word<font color="#000080">;
  </font>Z    <font color="#000080">: </font>Word<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>Offs<font color="#000080">:=</font>Ofs<font color="#000080">(</font>Data<font color="#000080">);
  </font>Segm<font color="#000080">:=</font>Seg<font color="#000080">(</font>Data<font color="#000080">);
  </font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">mov  ax,segm
   mov  es,ax
   mov  bx,offs
   mov  ax,1501h
   int  2fh
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>DSeg<font color="#000080">:=</font>MemW<font color="#000080">[</font>segm<font color="#000080">:(</font>Offs<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">)];
  </font>DOfs<font color="#000080">:=</font>MemW<font color="#000080">[</font>segm<font color="#000080">:(</font>Offs<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)]+((</font>CDROMNumber<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">5</font><font color="#000080">);
  </font>Z<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Mem<font color="#000080">[</font>DSeg<font color="#000080">:</font>DOfs<font color="#000080">+</font>Z<font color="#000080">]&lt;&gt;</font><font color="#800000">$20</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Z<font color="#000080">&lt;</font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>Do
  Begin
   </b></font>Inc<font color="#000080">(</font>Z<font color="#000080">);
   </font>Mem<font color="#000080">[</font>Seg<font color="#000080">(</font>Name<font color="#000080">):</font>Ofs<font color="#000080">(</font>Name<font color="#000080">)]:=</font>Z<font color="#000080">;
   </font>Mem<font color="#000080">[</font>Seg<font color="#000080">(</font>Name<font color="#000080">):</font>Ofs<font color="#000080">(</font>Name<font color="#000080">)+</font>Z<font color="#000080">]:=</font>Mem<font color="#000080">[</font>DSeg<font color="#000080">:(</font>DOfs<font color="#000080">+</font><font color="#800000">9</font><font color="#000080">+</font>Z<font color="#000080">)];
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Inc<font color="#000080">(</font>Z<font color="#000080">);
  </font>Mem<font color="#000080">[</font>Seg<font color="#000080">(</font>Name<font color="#000080">):</font>Ofs<font color="#000080">(</font>Name<font color="#000080">)]:=</font>Z<font color="#000080">;
  </font>Mem<font color="#000080">[</font>Seg<font color="#000080">(</font>Name<font color="#000080">):</font>Ofs<font color="#000080">(</font>Name<font color="#000080">)+</font>Z<font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{getdrivername proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetAudioTrackInfo<font color="#000080">(</font>Handle<font color="#000080">:</font>Word<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>AudioTrack<font color="#000080">:</font>AudioTrackType<font color="#000080">);
</font><font color="#008000"><i>{Thanks to Kristian Leonhard for this procedure. Sure beats my old
 one!                                                             }
</i></font><font color="#FF0000"><b>Label
 </b></font>Error<font color="#000080">,</font>Exit<font color="#000080">,</font>Error2<font color="#000080">,</font>Exit2<font color="#000080">,</font>Error3<font color="#000080">,</font>Exit3<font color="#000080">;
</font><font color="#FF0000"><b>Var
 </b></font>Buffer <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1024</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Byte<font color="#000080">;
 </font>BufSeg <font color="#000080">: </font>Word<font color="#000080">;
 </font>BufOfs <font color="#000080">: </font>Word<font color="#000080">;
 </font>Err    <font color="#000080">: </font>Boolean<font color="#000080">;
 </font>Z      <font color="#000080">: </font>Byte<font color="#000080">;
 </font>Max<font color="#000080">,</font>Min<font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>WriteTimeFromSec<font color="#000080">(</font>Sec<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 </b></font>Writeln<font color="#000080">((</font>Sec <font color="#FF0000"><b>div </b></font><font color="#800000">60</font><font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">,</font>Sec<font color="#000080">-((</font>Sec <font color="#FF0000"><b>div </b></font><font color="#800000">60</font><font color="#000080">)*</font><font color="#800000">60</font><font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
 </b></font>BufSeg<font color="#000080">:=</font>Seg<font color="#000080">(</font>Buffer<font color="#000080">);
 </font>BufOfs<font color="#000080">:=</font>Ofs<font color="#000080">(</font>Buffer<font color="#000080">);
 </font><font color="#008000"><i>{ Get StartTrack &amp; EndTrack }
 </i></font><font color="#FF0000"><b>Asm
          </b></font><font color="#FF00FF">push ds
          mov  ax,BufSeg
          mov  ds,ax
          mov  dx,BufOfs
          mov  bx,dx
          mov  al,0ah
          mov  ds:[bx],al
          mov  bx,Handle
          mov  cx,7
          mov  ax,4402h
          int  21h
          jc   Error
          mov  al,0h
          mov  Err,al
          jmp  Exit
 Error  : mov  al,1h
          mov  Err,al
          jmp  Exit
 Exit   : pop  ds
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If Not </b></font>Err <font color="#FF0000"><b>Then
 Begin
  </b></font>Max<font color="#000080">:=</font>Buffer<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font>Min<font color="#000080">:=</font>Buffer<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
  </font>AudioTrack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>Max<font color="#000080">].</font>Frame<font color="#000080">:=</font>Buffer<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>AudioTrack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>Max<font color="#000080">].</font>Second<font color="#000080">:=</font>Buffer<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
  </font>AudioTrack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>Max<font color="#000080">].</font>Minute<font color="#000080">:=</font>Buffer<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];
  </font><font color="#008000"><i>{ Get Rest of audio info }
  </i></font><font color="#FF0000"><b>For </b></font>Z<font color="#000080">:=</font>Min <font color="#FF0000"><b>To </b></font>Max <font color="#FF0000"><b>Do
  Begin
   Asm
          </b></font><font color="#FF00FF">push ds
          mov  ax,BufSeg
          mov  ds,ax
          mov  dx,BufOfs
          mov  bx,dx
          mov  al,0bh
          mov  ds:[bx],al
          mov  al,z
          mov  ds:[bx+1],al
          mov  bx,Handle
          mov  cx,7
          mov  ax,4402h
          int  21h
          jc   Error
          mov  al,0h
          mov  Err,al
          jmp  Exit2
 Error2 : mov  al,1h
          mov  Err,al
          jmp  Exit2
 Exit2  : pop  ds
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>AudioTrack<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">][</font>Z<font color="#000080">].</font>Frame<font color="#000080">:=</font>Buffer<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font>AudioTrack<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">][</font>Z<font color="#000080">].</font>Second<font color="#000080">:=</font>Buffer<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>AudioTrack<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">][</font>Z<font color="#000080">].</font>Minute<font color="#000080">:=</font>Buffer<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>For </b></font>Z<font color="#000080">:=</font>Min<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Max <font color="#FF0000"><b>Do
  Begin
   Asm
          </b></font><font color="#FF00FF">push ds
          mov  ax,BufSeg
          mov  ds,ax
          mov  dx,BufOfs
          mov  bx,dx
          mov  al,0bh
          mov  ds:[bx],al
          mov  al,z
          mov  ds:[bx+1],al
          mov  bx,Handle
          mov  cx,7
          mov  ax,4402h
          int  21h
          jc   Error
          mov  al,0h
          mov  Err,al
          jmp  Exit3
 Error3 : mov  al,1h
          mov  Err,al
          jmp  Exit3
 Exit3  : pop  ds
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>AudioTrack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>Z<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">].</font>Frame<font color="#000080">:=</font>Buffer<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font>AudioTrack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>Z<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">].</font>Second<font color="#000080">:=</font>Buffer<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>AudioTrack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>Z<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">].</font>Minute<font color="#000080">:=</font>Buffer<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'AudioCD Info : '</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Start       End       Total'</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Z<font color="#000080">:=</font>Min <font color="#FF0000"><b>To </b></font>Max <font color="#FF0000"><b>Do
  Begin
    </b></font>Write<font color="#000080">(</font>AudioTrack<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">][</font>Z<font color="#000080">].</font>Minute<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">,</font>AudioTrack<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">][</font>Z<font color="#000080">].</font>Second<font color="#000080">,</font><font color="#800000">'         '</font><font color="#000080">,
          </font>AudioTrack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>Z<font color="#000080">].</font>Minute<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">,</font>AudioTrack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>Z<font color="#000080">].</font>Second<font color="#000080">,</font><font color="#800000">'      '</font><font color="#000080">);
    </font>WriteTimeFromSec<font color="#000080">(((</font>AudioTrack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>Z<font color="#000080">].</font>Minute<font color="#000080">-</font>AudioTrack<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">][</font>Z<font color="#000080">].</font>Minute<font color="#000080">)
                  *</font><font color="#800000">60</font><font color="#000080">)+(</font>AudioTrack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">][</font>Z<font color="#000080">].</font>Second<font color="#000080">-</font>AudioTrack<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">][</font>Z<font color="#000080">].</font>Second<font color="#000080">));
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>End
 Else
 Begin
  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error reading audio info'</font><font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font>Writeln<font color="#000080">(</font><font color="#800000">'Press a key'</font><font color="#000080">);
 </font>Readkey<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{getaudiotrackinfo proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>SubtractTime<font color="#000080">(</font>Min1<font color="#000080">,</font>Sec1<font color="#000080">,</font>F1<font color="#000080">,</font>Min2<font color="#000080">,</font>Sec2<font color="#000080">,</font>F2 <font color="#000080">: </font>Byte<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>RMin<font color="#000080">,</font>RSec<font color="#000080">,</font>RF <font color="#000080">:
</font>Byte<font color="#000080">);</font><font color="#008000"><i>{Subtracts Min1,Sec1 from Min2,Sec2  (Min2-Min1,etc)}
{Places answers in RMin and RSec}
</i></font><font color="#FF0000"><b>Var </b></font>D <font color="#000080">: </font>Real<font color="#000080">;
    </font>S1<font color="#000080">,</font>S2<font color="#000080">,</font>R <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{Check to see if F2 &gt; F1. If not, subtract one from S2, add 75 to F2,
   subtract and place result. then convert rest to packed}
  </i></font><font color="#FF0000"><b>If </b></font>F2<font color="#000080">-</font>F1 <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
    </b></font>S2 <font color="#000080">:= </font>S2 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
    </font>F2 <font color="#000080">:= </font>F2 <font color="#000080">+ </font><font color="#800000">75</font><font color="#000080">;
    </font>RF <font color="#000080">:= </font>F2<font color="#000080">-</font>F1<font color="#000080">;
  </font><font color="#FF0000"><b>end else </b></font>RF <font color="#000080">:= </font>F2<font color="#000080">-</font>F1<font color="#000080">;      </font><font color="#008000"><i>{recent addition -- check}
  {convert to packed}
  </i></font>S1 <font color="#000080">:= </font>Min1<font color="#000080">*</font><font color="#800000">60</font><font color="#000080">+</font>Sec1<font color="#000080">;
  </font>S2 <font color="#000080">:= </font>Min2<font color="#000080">*</font><font color="#800000">60</font><font color="#000080">+</font>Sec2<font color="#000080">;
  </font><font color="#008000"><i>{do subtraction}
  </i></font>R <font color="#000080">:= </font>S2<font color="#000080">-</font>S1<font color="#000080">;
  </font><font color="#008000"><i>{Is R &gt; 60, if so then divide r by 60 to find RMin}
  {mult. frac(r) by 60 to fin rsec}
  </i></font><font color="#FF0000"><b>If </b></font>R <font color="#000080">&gt;= </font><font color="#800000">60 </font><font color="#FF0000"><b>then begin
    </b></font>D <font color="#000080">:= </font>R <font color="#000080">/ </font><font color="#800000">60</font><font color="#000080">;
    </font>RMin <font color="#000080">:= </font>Trunc<font color="#000080">(</font>D<font color="#000080">);
    </font>D <font color="#000080">:= </font>Frac<font color="#000080">(</font>D<font color="#000080">) * </font><font color="#800000">60</font><font color="#000080">;
    </font>RSec <font color="#000080">:= </font>Trunc<font color="#000080">(</font>D<font color="#000080">);
  </font><font color="#FF0000"><b>end
  else begin
    </b></font>RMin <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>RSec <font color="#000080">:= </font>R<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{SubtractTime}

</i></font><font color="#FF0000"><b>Procedure </b></font>EjectCd<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>StdHdr<font color="#000080">.</font>Length <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>StdHdr<font color="#000080">);
  </font>StdHdr<font color="#000080">.</font>Subcode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>CmdCode <font color="#000080">:= </font><font color="#800000">12</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>MedDesc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>XFerAddr <font color="#000080">:= </font>ADDR<font color="#000080">(</font>EJ<font color="#000080">);
  </font>StdHdr<font color="#000080">.</font>XFerBytes <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>SSNum <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>ReqPtr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>EJ<font color="#000080">.</font>CtlCode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>SendDDR<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ejectcd proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>ResetCD<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>StdHdr<font color="#000080">.</font>Length <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>StdHdr<font color="#000080">);
  </font>StdHdr<font color="#000080">.</font>Subcode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>CmdCode <font color="#000080">:= </font><font color="#800000">12</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>MedDesc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>XFerAddr <font color="#000080">:= </font>ADDR<font color="#000080">(</font>RST<font color="#000080">);
  </font>StdHdr<font color="#000080">.</font>XFerBytes <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>SSNum <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>ReqPtr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Rst<font color="#000080">.</font>CtlCode <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
  </font>SendDDR<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{resetcd proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetDiskInfo<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>StdHdr<font color="#000080">.</font>Length <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>StdHdr<font color="#000080">);
  </font>StdHdr<font color="#000080">.</font>SubCode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>CmdCode <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>MedDesc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>XFerAddr <font color="#000080">:= </font>Addr<font color="#000080">(</font>DI<font color="#000080">);
  </font>StdHdr<font color="#000080">.</font>XFerBytes <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>SSNum <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Stdhdr<font color="#000080">.</font>ReqPtr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>DI<font color="#000080">.</font>CtlCode <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
  </font>SendDDR<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{getdiskinfo proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetTrackInfo<font color="#000080">(</font>Track <font color="#000080">: </font>Byte<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>Start <font color="#000080">: </font>Longint<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>StdHdr<font color="#000080">.</font>Length <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>StdHdr<font color="#000080">);
  </font>StdHdr<font color="#000080">.</font>SubCode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>CmdCode <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
  </font>Stdhdr<font color="#000080">.</font>MedDesc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Stdhdr<font color="#000080">.</font>XFerAddr <font color="#000080">:= </font>Addr<font color="#000080">(</font>TI<font color="#000080">);
  </font>StdHdr<font color="#000080">.</font>XFerBytes <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>SSNum <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StdHdr<font color="#000080">.</font>ReqPtr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>TI<font color="#000080">.</font>CtlCode <font color="#000080">:= </font><font color="#800000">11</font><font color="#000080">;
  </font>TI<font color="#000080">.</font>TrackNum <font color="#000080">:= </font>Track<font color="#000080">;
  </font>SendDDR<font color="#000080">;
  </font>Start <font color="#000080">:= </font>TI<font color="#000080">.</font>TStart<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{GetTrackInfo Proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetTrackLengths<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>Loop <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{place track starts in TStart}
  </i></font><font color="#FF0000"><b>For </b></font>Loop <font color="#000080">:= </font>DI<font color="#000080">.</font>LowTrack <font color="#FF0000"><b>to </b></font>DI<font color="#000080">.</font>HiTrack <font color="#FF0000"><b>do Begin
    </b></font>TStart<font color="#000080">[</font>Loop<font color="#000080">].</font>Minute <font color="#000080">:= </font>Tracks<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">,</font>Loop<font color="#000080">].</font>Minute<font color="#000080">;
    </font>TStart<font color="#000080">[</font>Loop<font color="#000080">].</font>Second <font color="#000080">:= </font>Tracks<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">,</font>Loop<font color="#000080">].</font>Second<font color="#000080">;
    </font>TStart<font color="#000080">[</font>Loop<font color="#000080">].</font>Frame <font color="#000080">:= </font>Tracks<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">,</font>Loop<font color="#000080">].</font>Frame<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{find lengths of tracks}
  </i></font><font color="#FF0000"><b>For </b></font>Loop <font color="#000080">:= </font>DI<font color="#000080">.</font>LowTrack <font color="#FF0000"><b>to </b></font>DI<font color="#000080">.</font>HiTrack <font color="#FF0000"><b>do

</b></font>SubtractTime<font color="#000080">(</font>Tracks<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">,</font>Loop<font color="#000080">].</font>Minute<font color="#000080">,</font>Tracks<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">,</font>Loop<font color="#000080">].</font>Second<font color="#000080">,</font>Tracks<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">,</font>Loop<font color="#000080">].</font>Frame<font color="#000080">,
</font>Tracks<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font>Loop<font color="#000080">].</font>Minute<font color="#000080">,</font>Tracks<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font>Loop<font color="#000080">].</font>Second<font color="#000080">,</font>Tracks<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font>Loop<font color="#000080">].</font>Frame<font color="#000080">,

</font>TLength<font color="#000080">[</font>Loop<font color="#000080">].</font>Minute<font color="#000080">,</font>TLength<font color="#000080">[</font>Loop<font color="#000080">].</font>Second<font color="#000080">,</font>TLength<font color="#000080">[</font>Loop<font color="#000080">].</font>Frame<font color="#000080">);</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{gettracklengths proc}
</i></font><font color="#FF0000"><b>Procedure </b></font>PlayCD<font color="#000080">(</font>Start<font color="#000080">,</font>Length <font color="#000080">: </font>Longint<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>Play<font color="#000080">.</font>Length <font color="#000080">:= </font><font color="#800000">13</font><font color="#008000"><i>{SizeOf(Play)}</i></font><font color="#000080">;
  </font>Play<font color="#000080">.</font>SubCode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Play<font color="#000080">.</font>CMdCode <font color="#000080">:= </font><font color="#800000">132</font><font color="#000080">;
  </font>Play<font color="#000080">.</font>AddrMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Play<font color="#000080">.</font>StrtSec <font color="#000080">:= </font>Start<font color="#000080">;
  </font>Play<font color="#000080">.</font>NumSect <font color="#000080">:= </font>Length<font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">push ds
    mov ax,ds
    mov es,ax
    mov ax,1510h
    mov bx,offset play
    mov cx,CDNum
    Int 2fh
    pop ds
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;   </font><font color="#008000"><i>{playcd proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>PlayTrack<font color="#000080">(</font>TrackNum <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>LMin<font color="#000080">,</font>LSec<font color="#000080">,</font>LF<font color="#000080">,
    </font>SMin<font color="#000080">,</font>SSec<font color="#000080">,</font>SF <font color="#000080">: </font>Byte<font color="#000080">;
    </font>S<font color="#000080">,</font>L <font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>LMin <font color="#000080">:= </font>TLength<font color="#000080">[</font>TrackNum<font color="#000080">].</font>Minute<font color="#000080">;
  </font>LSec <font color="#000080">:= </font>TLength<font color="#000080">[</font>TrackNum<font color="#000080">].</font>Second<font color="#000080">;
  </font>LF <font color="#000080">:= </font>TLength<font color="#000080">[</font>TrackNum<font color="#000080">].</font>Frame<font color="#000080">;
  </font>SMin <font color="#000080">:= </font>TStart<font color="#000080">[</font>TrackNum<font color="#000080">].</font>Minute<font color="#000080">;
  </font>SSec <font color="#000080">:= </font>TStart<font color="#000080">[</font>Tracknum<font color="#000080">].</font>Second<font color="#000080">;
  </font>SF <font color="#000080">:= </font>TStart<font color="#000080">[</font>TrackNum<font color="#000080">].</font>Frame<font color="#000080">;
  </font>L <font color="#000080">:= </font>LongMul<font color="#000080">(</font>LMin<font color="#000080">,</font><font color="#800000">75</font><font color="#000080">*</font><font color="#800000">60</font><font color="#000080">)+</font>LongMul<font color="#000080">(</font>LSec<font color="#000080">,</font><font color="#800000">75</font><font color="#000080">)+</font>LF<font color="#000080">-</font><font color="#800000">150</font><font color="#000080">;
  </font>S <font color="#000080">:= </font>LongMul<font color="#000080">(</font>SMin<font color="#000080">,</font><font color="#800000">60</font><font color="#000080">*</font><font color="#800000">75</font><font color="#000080">)+</font>LongMul<font color="#000080">(</font>SSec<font color="#000080">,</font><font color="#800000">75</font><font color="#000080">)+</font>SF<font color="#000080">-</font><font color="#800000">150</font><font color="#000080">;
  </font>PlayCD<font color="#000080">(</font>S<font color="#000080">,</font>L<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{playtrack proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>PlayTracks<font color="#000080">(</font>First<font color="#000080">,</font>Second <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#008000"><i>{Plays everything from the first to the second tracks. Not used.}
</i></font><font color="#FF0000"><b>Var </b></font>Strt <font color="#000080">: </font>OneTime<font color="#000080">;
    </font>X <font color="#000080">: </font>Byte<font color="#000080">;
    </font>LngthTime <font color="#000080">: </font>Longint<font color="#000080">;
    </font>L<font color="#000080">,</font>S <font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>LngthTime <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Strt <font color="#000080">:= </font>TStart<font color="#000080">[</font>First<font color="#000080">];
  </font><font color="#FF0000"><b>For </b></font>X <font color="#000080">:= </font>First <font color="#FF0000"><b>to </b></font>Second <font color="#FF0000"><b>do
    </b></font>LngthTime <font color="#000080">:= </font>LngthTime <font color="#000080">+
</font>LongMul<font color="#000080">(</font>TLength<font color="#000080">[</font>X<font color="#000080">].</font>Minute<font color="#000080">,</font><font color="#800000">75</font><font color="#000080">*</font><font color="#800000">60</font><font color="#000080">)+</font>LongMul<font color="#000080">(</font>TLength<font color="#000080">[</font>X<font color="#000080">].</font>Second<font color="#000080">,</font><font color="#800000">75</font><font color="#000080">)+
</font>TLength<font color="#000080">[</font>X<font color="#000080">].</font>Frame<font color="#000080">-</font><font color="#800000">150</font><font color="#000080">;  </font>L <font color="#000080">:= </font>LngthTime<font color="#000080">;
  </font>S <font color="#000080">:= </font>LongMul<font color="#000080">(</font>Strt<font color="#000080">.</font>Minute<font color="#000080">,</font><font color="#800000">60</font><font color="#000080">*</font><font color="#800000">75</font><font color="#000080">)+</font>LongMul<font color="#000080">(</font>Strt<font color="#000080">.</font>Second<font color="#000080">,</font><font color="#800000">75</font><font color="#000080">)+</font>Strt<font color="#000080">.</font>Frame<font color="#000080">-</font><font color="#800000">150</font><font color="#000080">;
  </font>PlayCD<font color="#000080">(</font>S<font color="#000080">,</font>L<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{playtracks proc}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetAudioInfo<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>CDName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>CDHandle <font color="#000080">: </font>Word<font color="#000080">;
    </font>CDFile <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GetDriverName<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>CDName<font color="#000080">);
  </font>Assign<font color="#000080">(</font>CDFile<font color="#000080">,</font>CDName<font color="#000080">);
  </font>Reset<font color="#000080">(</font>CDFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>CDHandle <font color="#000080">:= </font>MemW<font color="#000080">[</font>SSeg<font color="#000080">:</font>Ofs<font color="#000080">(</font>CDFile<font color="#000080">)];
  </font>GetAudioTrackInfo<font color="#000080">(</font>CDHandle<font color="#000080">,</font>Tracks<font color="#000080">);
  </font>Close<font color="#000080">(</font>CDFile<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{getaudioinfo}

</i></font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{--Set some universal constants--}
  </i></font>StdOfs <font color="#000080">:= </font>Ofs<font color="#000080">(</font>StdHdr<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>IsInstalled <font color="#FF0000"><b>then begin
    </b></font>GetDrvLetrs<font color="#000080">;
    </font>CDNum <font color="#000080">:= </font>DrvList<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
  </font><font color="#FF0000"><b>End
  else Begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'MSCDEX and/or CD-ROM not detected! Aborting'</font><font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#008000"><i>{--reset drive then play a track--}
  </i></font>ResetCD<font color="#000080">;  </font><font color="#008000"><i>{My CD won't play music CDs without a reset first. Driver prob.}
  </i></font>MediaChanged<font color="#000080">;  </font><font color="#008000"><i>{have to run it once to get a correct answer the next time}
  </i></font>GetAudioInfo<font color="#000080">;  </font><font color="#008000"><i>{  not that I use it here again ;)}
  </i></font>GetDiskInfo<font color="#000080">;
  </font>GetTrackLengths<font color="#000080">;
  </font><font color="#008000"><i>{$I-}
  </i></font><font color="#FF0000"><b>Repeat
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Enter track number to play ('</font><font color="#000080">,</font>DI<font color="#000080">.</font>LowTrack<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">,</font>DI<font color="#000080">.</font>HiTrack<font color="#000080">,</font><font color="#800000">'):'</font><font color="#000080">);
    </font>Readln<font color="#000080">(</font>TrNum<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>IOResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>TrNum <font color="#000080">&lt;= </font>DI<font color="#000080">.</font>HiTrack<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>TrNum <font color="#000080">&gt;= </font>DI<font color="#000080">.</font>LowTrack<font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font>PlayTrack<font color="#000080">(</font>TrNum<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>A word about CDNum<font color="#000080">: </font>CDNum <font color="#FF0000"><b>is </b></font>the number <font color="#FF0000"><b>of </b></font>the drive where A<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">,</font>B<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">,</font>C<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">,</font>D<font color="#000080">=</font><font color="#800000">3.
</font><font color="#FF0000"><b>On </b></font>my system the CD <font color="#FF0000"><b>is </b></font>drive D so CDNum would be <font color="#800000">3. </font>HOWEVER<font color="#000080">: </font><font color="#FF0000"><b>In </b></font>the
GetDriverName <font color="#FF0000"><b>procedure</b></font><font color="#000080">, </font>CDROMNumber <font color="#FF0000"><b>is NOT </b></font>the same<font color="#000080">. </font>It <font color="#FF0000"><b>is </b></font>the number <font color="#FF0000"><b>of
</b></font>the CDROM drive you want <font color="#FF0000"><b>to </b></font>play<font color="#000080">. </font>That <font color="#FF0000"><b>is</b></font><font color="#000080">, </font><font color="#FF0000"><b>if </b></font>you have more than <font color="#800000">1 </font>CDROM<font color="#000080">.
</font>So <font color="#FF0000"><b>if </b></font>you have <font color="#800000">2 </font>CDROM drives<font color="#000080">, </font>D<font color="#000080">&amp;</font>E<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>CDROMNumber <font color="#000080">= </font><font color="#800000">1 </font>would activate
drive D <font color="#FF0000"><b>and </b></font>CDROMNumber<font color="#000080">=</font><font color="#800000">2 </font>would activate E<font color="#000080">. </font>Simple<font color="#000080">. </font>Keep it <font color="#FF0000"><b>on </b></font><font color="#800000">1 </font><font color="#FF0000"><b>and
</b></font>things _should_ go OK<font color="#000080">.

</font>Pat O<font color="#800000">'Malley AKA Silicon Slim
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0089.PAS">Original</a><b>]</b></p></body>
</html>
