<html>
<head><title> "DSP VOC Player" by JEFF PEIFFER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Well, I saw your message and so I thought that you could use this.  It
is a .VOC player that doesn't use CT-Voice.DRV.  If you don't have a
copy of DSP (It has been posted here many times before) then just mail
me and I'll post a copy of it for you.  This program should work fine
(at least it does on my computer).  Hope you like it...
}

</i></font><font color="#FF0000"><b>program </b></font>play_voc<font color="#000080">; </font><font color="#008000"><i>{ without ct-voice.drv }
</i></font><font color="#FF0000"><b>uses </b></font>DSP<font color="#000080">, </font>crt<font color="#000080">;
</font><font color="#FF0000"><b>Type </b></font>SoundBufType <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65528</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>SoundDat<font color="#000080">: ^</font>SoundBufType<font color="#000080">;
    </font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>f <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
    </font>s <font color="#000080">: </font>word<font color="#000080">;
    </font>freq <font color="#000080">: </font>word<font color="#000080">;
    </font>h <font color="#000080">: </font><font color="#FF0000"><b>record
         </b></font>signature  <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">19</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;  </font><font color="#008000"><i>{ vendor's name }
         </i></font>Terminator <font color="#000080">: </font>Byte<font color="#000080">;
         </font>data_start <font color="#000080">: </font>word<font color="#000080">;          </font><font color="#008000"><i>{ start of data in file }
         </i></font>version    <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{ min. driver version required }
         </i></font>id         <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{ 1-complement of version field+$1234 }
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                      </font><font color="#008000"><i>{ used to indentify a .voc file }
    </i></font>d <font color="#000080">: </font><font color="#FF0000"><b>record
         </b></font>id   <font color="#000080">: </font>byte<font color="#000080">; </font><font color="#008000"><i>{ = 1 }
         </i></font>len  <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">; </font><font color="#008000"><i>{ length of voice data (len data +
2)}
         </i></font>sr   <font color="#000080">: </font>byte<font color="#000080">; </font><font color="#008000"><i>{ sr = 256 - (1,000,000 / sampling rate) }
         </i></font>pack <font color="#000080">: </font>byte<font color="#000080">; </font><font color="#008000"><i>{ 0: unpacked, 1: 4-bit, 2: 2.6 bit, 3: 2 bit
packed}    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{$i-}
 </i></font>clrscr<font color="#000080">;
 </font>New<font color="#000080">(</font>SoundDat<font color="#000080">);
 </font>ResetDSP<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
 </font>SpeakerOn<font color="#000080">;
 </font>Filename<font color="#000080">:=</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>filename<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>filename <font color="#000080">:= </font>filename <font color="#000080">+ </font><font color="#800000">'.voc'</font><font color="#000080">;
 </font>assign<font color="#000080">(</font>f<font color="#000080">, </font>filename<font color="#000080">);
 </font>reset<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
 </font>blockread<font color="#000080">(</font>f<font color="#000080">, </font>h<font color="#000080">, </font><font color="#800000">26</font><font color="#000080">);
 </font>blockread<font color="#000080">(</font>f<font color="#000080">, </font>d<font color="#000080">, </font><font color="#800000">6</font><font color="#000080">);
 </font>seek<font color="#000080">(</font>f<font color="#000080">,</font>h<font color="#000080">.</font>data_start<font color="#000080">);
 </font>freq <font color="#000080">:= </font>round<font color="#000080">(</font><font color="#800000">1000000 </font><font color="#000080">/ (</font><font color="#800000">256 </font><font color="#000080">- </font>d<font color="#000080">.</font>sr<font color="#000080">));
 </font>s    <font color="#000080">:= </font>ord<font color="#000080">(</font>d<font color="#000080">.</font>len<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]) + </font>ord<font color="#000080">(</font>d<font color="#000080">.</font>len<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) * </font><font color="#800000">256 </font><font color="#000080">+ </font>ord<font color="#000080">(</font>d<font color="#000080">.</font>len<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) * </font><font color="#800000">256 </font><font color="#000080">* </font><font color="#800000">256</font><font color="#000080">;
 </font>blockread<font color="#000080">(</font>F<font color="#000080">, </font>SoundDat<font color="#000080">^, </font>S<font color="#000080">);
 </font>writeln<font color="#000080">(</font><font color="#800000">'-----------header----------'</font><font color="#000080">);
 </font>writeln<font color="#000080">(</font><font color="#800000">'signature: '</font><font color="#000080">, </font>h<font color="#000080">.</font>signature<font color="#000080">);
 </font>writeln<font color="#000080">(</font><font color="#800000">'data_start: '</font><font color="#000080">, </font>h<font color="#000080">.</font>data_start<font color="#000080">);
 </font>writeln<font color="#000080">(</font><font color="#800000">'version: '</font><font color="#000080">, </font>hi<font color="#000080">(</font>h<font color="#000080">.</font>version<font color="#000080">), </font><font color="#800000">'.'</font><font color="#000080">, </font>lo<font color="#000080">(</font>h<font color="#000080">.</font>version<font color="#000080">));
 </font>writeln<font color="#000080">(</font><font color="#800000">'id: '</font><font color="#000080">, </font>h<font color="#000080">.</font>id<font color="#000080">);
 </font>writeln<font color="#000080">;
 </font>writeln<font color="#000080">(</font><font color="#800000">'------------data-----------'</font><font color="#000080">);
 </font>writeln<font color="#000080">(</font><font color="#800000">'len: '</font><font color="#000080">, </font>s<font color="#000080">);
 </font>writeln<font color="#000080">(</font><font color="#800000">'freq: '</font><font color="#000080">, </font>freq<font color="#000080">);
 </font>writeln<font color="#000080">(</font><font color="#800000">'pack: '</font><font color="#000080">, </font>d<font color="#000080">.</font>pack<font color="#000080">);
 </font>writeln<font color="#000080">(</font><font color="#800000">'Filepos: '</font><font color="#000080">, </font>FilePos<font color="#000080">(</font>F<font color="#000080">));
 </font>readkey<font color="#000080">;



 </font>close<font color="#000080">(</font>f<font color="#000080">);
 </font><font color="#008000"><i>{$i-}

 </i></font><font color="#FF0000"><b>if </b></font>ioresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
   </b></font>writeln<font color="#000080">(</font><font color="#800000">'Can''t play voc file &quot;' </font><font color="#000080">+ </font>filename <font color="#000080">+ </font><font color="#800000">'&quot;.'</font><font color="#000080">);
   </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font>playback<font color="#000080">(</font>SoundDat<font color="#000080">, </font>s<font color="#000080">, </font>freq<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SOUND SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p></body>
</html>
