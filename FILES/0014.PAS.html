<html>
<head><title> "Set File Time (TOUCH)" by GAYLE DAVIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(* FT.PAS *)
(* Set file to a specific date *)

</i></font><font color="#FF0000"><b>USES </b></font>TPCrt<font color="#000080">, </font>Dos<font color="#000080">, </font>Misc<font color="#000080">, </font>TimeDate<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>f <font color="#000080">: </font>TEXT<font color="#000080">;
  </font>h<font color="#000080">, </font>m<font color="#000080">, </font>s<font color="#000080">, </font>hund <font color="#000080">: </font>WORD<font color="#000080">; </font><font color="#008000"><i>{ For GetTime}
  </i></font>ftime <font color="#000080">: </font>LONGINT<font color="#000080">; </font><font color="#008000"><i>{ For Get/SetFTime}
  </i></font>dt <font color="#000080">: </font>DateTime<font color="#000080">; </font><font color="#008000"><i>{ For Pack/UnpackTime}
  </i></font>DateS <font color="#000080">: </font>DateStr<font color="#000080">;
  </font>FName <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Syntax<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
        </b></font>ResetAttr <font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
        </font>CLRSCR<font color="#000080">;
        </font>GOTOXY <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">);
        </font>WRITELN <font color="#000080">(</font><font color="#800000">'FT.EXE    GDSOFT (c) 1992'</font><font color="#000080">);
        </font>WRITELN <font color="#000080">(</font><font color="#800000">'Usage   : FT filename date'</font><font color="#000080">, </font><font color="#800000">#07</font><font color="#000080">);
        </font>HALT <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>UpperCase <font color="#000080">(</font>InpStr <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>INTEGER<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
   FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH <font color="#000080">(</font>InpStr<font color="#000080">) </font><font color="#FF0000"><b>DO
       </b></font>UpperCase <font color="#000080">[</font>i<font color="#000080">] := </font>UPCASE <font color="#000080">(</font>InpStr <font color="#000080">[</font>i<font color="#000080">]);
   </font>UpperCase <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>InpStr <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LeadingZero <font color="#000080">(</font>w <font color="#000080">: </font>WORD<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>STR <font color="#000080">(</font>w <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">, </font>s<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>LENGTH <font color="#000080">(</font>s<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
    </b></font>s <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>s<font color="#000080">;
  </font>LeadingZero <font color="#000080">:= </font>s<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>ResetAttr <font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
  </font>CLRSCR<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>PARAMCOUNT <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>OR NOT </b></font>Exist <font color="#000080">(</font>PARAMSTR <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) ) </font><font color="#FF0000"><b>THEN </b></font>Syntax<font color="#000080">;
  </font>FName <font color="#000080">:= </font>UpperCase <font color="#000080">(</font>PARAMSTR <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) );
  </font><font color="#FF0000"><b>IF NOT </b></font>ValidDate <font color="#000080">(</font>PARAMSTR <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) ) </font><font color="#FF0000"><b>THEN </b></font>DateS <font color="#000080">:= </font>PlainDate <font color="#FF0000"><b>ELSE </b></font>DateS <font color="#000080">:= </font>PARAMSTR <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
  </font>ASSIGN <font color="#000080">(</font>f<font color="#000080">, </font>FName<font color="#000080">);
  </font>RESET <font color="#000080">(</font>f<font color="#000080">);
  </font>GETFTIME <font color="#000080">(</font>f<font color="#000080">, </font>ftime<font color="#000080">); </font><font color="#008000"><i>{ Get creation time }
  </i></font>UNPACKTIME <font color="#000080">(</font>ftime<font color="#000080">, </font>dt<font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'File '</font><font color="#000080">, </font>FName<font color="#000080">, </font><font color="#800000">' created at '</font><font color="#000080">, </font>LeadingZero <font color="#000080">(</font>dt<font color="#000080">.</font>hour<font color="#000080">),
          </font><font color="#800000">':'</font><font color="#000080">, </font>LeadingZero <font color="#000080">(</font>dt<font color="#000080">.</font>min<font color="#000080">), </font><font color="#800000">':'</font><font color="#000080">,
          </font>LeadingZero <font color="#000080">(</font>dt<font color="#000080">.</font>sec<font color="#000080">), </font><font color="#800000">' on '</font><font color="#000080">, </font>dt<font color="#000080">.</font>Month<font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">, </font>dt<font color="#000080">.</font>day<font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">, </font>dt<font color="#000080">.</font>year<font color="#000080">);
  </font><font color="#FF0000"><b>WITH </b></font>dt <font color="#FF0000"><b>DO
    BEGIN
      </b></font>FTime <font color="#000080">:= </font>PackDateTime <font color="#000080">(</font>DateS<font color="#000080">, </font>PlainTime<font color="#000080">);
      </font>WRITELN <font color="#000080">(</font><font color="#800000">'Setting file datestamp to '</font><font color="#000080">, </font>MakeSlashDate <font color="#000080">(</font>DateS<font color="#000080">) );
      </font>SETFTIME <font color="#000080">(</font>f<font color="#000080">, </font>ftime<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>CLOSE <font color="#000080">(</font>f<font color="#000080">);   </font><font color="#008000"><i>{ Close file }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.



</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p></body>
</html>
