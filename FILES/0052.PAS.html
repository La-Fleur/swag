<html>
<head><title> "DOS pipe as input" by LEE KIRBY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0052.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>PROGRAM </b></font>DFile<font color="#000080">;

</font><font color="#008000"><i>{ Purpose: Given, DIR [filespec] /S /B, delete all occurrences of [filespec] }
{          from the current directory on.                                    }
{ Example: dir *.bak /s /b | dfile                                           }

</i></font><font color="#FF0000"><b>VAR
   </b></font>In_File       <font color="#000080">: </font>TEXT<font color="#000080">;    </font><font color="#008000"><i>{ for standard input }
   </i></font>Key           <font color="#000080">: </font>CHAR<font color="#000080">;    </font><font color="#008000"><i>{ for user confirmation }
   </i></font>Files_Deleted <font color="#000080">: </font>INTEGER<font color="#000080">; </font><font color="#008000"><i>{ for number of files deleted }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetKey <font color="#000080">: </font>CHAR<font color="#000080">;

</font><font color="#008000"><i>{ The ASCII code is in AL, which is the place you need }
{ it to be as the byte return value of a function. }
{ Provided by Drew Veliath of 1:272/60@fidonet.org }

</i></font><font color="#FF0000"><b>INLINE </b></font><font color="#000080">( </font><font color="#800000">$B4 </font><font color="#000080">/ </font><font color="#800000">$00 </font><font color="#000080">/  </font><font color="#008000"><i>{ MOV AH,0 }
         </i></font><font color="#800000">$CD </font><font color="#000080">/ </font><font color="#800000">$16 </font><font color="#000080">); </font><font color="#008000"><i>{ INT $16 }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Delete_Files <font color="#000080">( </font><font color="#FF0000"><b>VAR </b></font>In_File       <font color="#000080">: </font>TEXT<font color="#000080">;
                         </font><font color="#FF0000"><b>VAR </b></font>Files_Deleted <font color="#000080">: </font>INTEGER <font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Trgt_File <font color="#000080">: </font>TEXT<font color="#000080">;    </font><font color="#008000"><i>{ for file to be deleted }
   </i></font>File_Spec <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;  </font><font color="#008000"><i>{ for filespec entered by user }

</i></font><font color="#FF0000"><b>BEGIN
   WHILE NOT </b></font>EOF <font color="#000080">( </font>In_File <font color="#000080">) </font><font color="#FF0000"><b>DO BEGIN
      </b></font>READLN <font color="#000080">( </font>In_File<font color="#000080">, </font>File_Spec <font color="#000080">);
      </font>ASSIGN <font color="#000080">( </font>Trgt_File<font color="#000080">, </font>File_Spec <font color="#000080">);
      </font><font color="#008000"><i>{$I-}
      </i></font>ERASE <font color="#000080">( </font>Trgt_File <font color="#000080">);
      </font><font color="#008000"><i>{$I+}
      </i></font><font color="#FF0000"><b>IF </b></font>IORESULT <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
         </b></font>INC <font color="#000080">( </font>Files_Deleted <font color="#000080">);
         </font>WRITELN <font color="#000080">( </font><font color="#800000">'Deleted '</font><font color="#000080">, </font>File_Spec <font color="#000080">)
         </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{ IF IORESULT = 0 }
      </i></font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{ WHILE NOT EOF ( In_File ) }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ PROCEDURE Delete_Files }

</i></font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{ main program }
   </i></font>WRITE <font color="#000080">(  </font><font color="#800000">'Are you sure [yn]?  ' </font><font color="#000080">);
   </font>Key <font color="#000080">:= </font>GetKey<font color="#000080">;
   </font>WRITELN<font color="#000080">;
   </font>Files_Deleted <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>IF </b></font>UPCASE <font color="#000080">( </font>Key <font color="#000080">) = </font><font color="#800000">'Y' </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>ASSIGN <font color="#000080">( </font>In_File<font color="#000080">, </font><font color="#800000">'' </font><font color="#000080">);  </font><font color="#008000"><i>{ assign In_File to standard input }
      </i></font>RESET <font color="#000080">( </font>In_File <font color="#000080">);
      </font>Delete_Files <font color="#000080">( </font>In_File<font color="#000080">, </font>Files_Deleted <font color="#000080">);
      </font>CLOSE <font color="#000080">( </font>In_File <font color="#000080">)
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ IF UPCASE ( Key ) = 'Y' }
   </i></font>WRITELN<font color="#000080">;
   </font>WRITELN <font color="#000080">( </font>Files_Deleted<font color="#000080">, </font><font color="#800000">' file(s) deleted.' </font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">. </font><font color="#008000"><i>{ main program }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0052.PAS">Original</a><b>]</b></p></body>
</html>
