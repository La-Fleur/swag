<html>
<head><title> "File Encryption" by KANDA'JALEN EIRSIE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0062.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Is there out there that has any good encription code.. something like rsa?

{****************************************************************************}
{                Unit to Compute in a Very Pascal Way                        }
{****************************************************************************}
{                      Incredible File Utilities                             }
{****************************************************************************}
{              Version : 1.0                  Dec  1990                      }
{****************************************************************************}
</i></font><font color="#FF0000"><b>Unit </b></font>FileUtil <font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>Interface uses </b></font>dos <font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>Const
     </b></font>Crea  <font color="#000080">= </font><font color="#800000">'UNIT FILEUTIL.TPU V.1.0 By: Jeffrey N. Thompson' </font><font color="#000080">;
     </font>Creat <font color="#000080">= </font><font color="#800000">'(C) Copywrite 1990,1991 By KJE Software Opportunities
</font>Exclusively<font color="#800000">' ;{ Procedure and function List }
</font><font color="#FF0000"><b>Function  </b></font>FileExists<font color="#000080">(</font>pathname<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean <font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>KillFile<font color="#000080">(</font>pathname <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean <font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>cryptB<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Rec <font color="#000080">; </font>size <font color="#000080">: </font>word <font color="#000080">; </font>Sym <font color="#000080">: </font>Byte<font color="#000080">) ;
</font><font color="#FF0000"><b>Procedure </b></font>CryptStr<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Rec <font color="#000080">; </font>Size <font color="#000080">: </font>Word <font color="#000080">; </font>Ecrypt <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) ;
</font><font color="#FF0000"><b>Procedure </b></font>CryptS<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Rec <font color="#000080">; </font>Size <font color="#000080">: </font>Word <font color="#000080">; </font>Seed <font color="#000080">: </font>longint<font color="#000080">) ;
</font><font color="#FF0000"><b>Function  </b></font>CryptfileStr<font color="#000080">(</font>Fname<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Ecrypt <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>integer <font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>CryptfileWithFile<font color="#000080">(</font>Fname<font color="#000080">,</font>Keyname <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer <font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>CryptFileS<font color="#000080">(</font>Fname <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">; </font>Seed <font color="#000080">: </font>longint<font color="#000080">) : </font>integer <font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>Implementation    </b></font><font color="#008000"><i>{ Uses }
{ Procedures and functions follow }
{****************************************************************************}
{ Check if a filename Exists in the current drive and directory. }
</i></font><font color="#FF0000"><b>Function </b></font>FileExists<font color="#000080">(</font>pathname <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean <font color="#000080">;
</font><font color="#FF0000"><b>Var
        </b></font>search <font color="#000080">: </font>searchrec <font color="#000080">;
        </font>exists <font color="#000080">: </font>boolean <font color="#000080">;
</font><font color="#FF0000"><b>Begin   </b></font><font color="#008000"><i>{ Exists }
     </i></font>exists <font color="#000080">:= </font>false <font color="#000080">;
     </font>findfirst<font color="#000080">(</font>pathname<font color="#000080">,</font>anyfile<font color="#000080">,</font>search<font color="#000080">) ;
     </font>exists <font color="#000080">:= (</font>doserror <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>search<font color="#000080">.</font>name <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">) ;
     </font>fileexists <font color="#000080">:= </font>exists <font color="#000080">;
</font><font color="#FF0000"><b>End </b></font><font color="#000080">;  </font><font color="#008000"><i>{ Exists }
{****************************************************************************}
 { Destroys a file.  Unrecoverably }
</i></font><font color="#FF0000"><b>function  </b></font>KillFile<font color="#000080">(</font>pathname <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean <font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>kfile <font color="#000080">: </font><font color="#FF0000"><b>file </b></font><font color="#000080">;
   </font>buffer <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2048</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">;
   </font>numread<font color="#000080">,</font>numwritten <font color="#000080">: </font>word <font color="#000080">;
   </font>I  <font color="#000080">: </font>integer <font color="#000080">;
   </font>j2 <font color="#000080">: </font>longint <font color="#000080">;
   </font>found <font color="#000080">: </font>boolean <font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{$F-}
   </i></font><font color="#FF0000"><b>if </b></font>fileexists<font color="#000080">(</font>pathname<font color="#000080">) </font><font color="#FF0000"><b>then
   begin
        </b></font>found <font color="#000080">:= </font>true <font color="#000080">;
        </font>assign<font color="#000080">(</font>kfile<font color="#000080">,</font>pathname<font color="#000080">) ;
        </font>setfattr<font color="#000080">(</font>kfile<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">) ;
        </font>reset<font color="#000080">(</font>kfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) ;
        </font><font color="#FF0000"><b>repeat
             </b></font>Blockread<font color="#000080">(</font>kfile<font color="#000080">,</font>buffer<font color="#000080">,</font>sizeof<font color="#000080">(</font>buffer<font color="#000080">),</font>numread<font color="#000080">) ;
             </font>j2 <font color="#000080">:= </font>filepos<font color="#000080">(</font>kfile<font color="#000080">) ;
             </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numread <font color="#FF0000"><b>do </b></font>buffer<font color="#000080">[</font>i<font color="#000080">] := </font>random<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">) ;
             </font>seek<font color="#000080">(</font>kfile<font color="#000080">,</font>j2<font color="#000080">-</font>numread<font color="#000080">) ;
             </font>blockwrite<font color="#000080">(</font>kfile<font color="#000080">,</font>buffer<font color="#000080">,</font>numread<font color="#000080">,</font>numwritten<font color="#000080">) ;
             </font>seek<font color="#000080">(</font>kfile<font color="#000080">,</font>j2<font color="#000080">) ;
        </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>numread <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>numwritten <font color="#000080">&lt;&gt; </font>numread<font color="#000080">) ;
        </font>close<font color="#000080">(</font>kfile<font color="#000080">) ;
        </font>erase<font color="#000080">(</font>kfile<font color="#000080">) ;
   </font><font color="#FF0000"><b>end else </b></font>found <font color="#000080">:= </font>false <font color="#000080">;
</font><font color="#008000"><i>{$F+}
     </i></font>killfile <font color="#000080">:= (</font>ioresult<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>found<font color="#000080">) ;
  </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
 { Encrypt a record of SIZE with a Byte Sized SYMbol }
</i></font><font color="#FF0000"><b>procedure </b></font>cryptb<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Rec <font color="#000080">; </font>size <font color="#000080">: </font>word <font color="#000080">; </font>Sym <font color="#000080">: </font>Byte<font color="#000080">) ;

</font><font color="#FF0000"><b>type
    </b></font>buffers <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65535</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>I <font color="#000080">: </font>word <font color="#000080">;
   </font>buffer <font color="#000080">: ^</font>buffers <font color="#000080">;

</font><font color="#FF0000"><b>begin
     </b></font>buffer <font color="#000080">:= </font><font color="#FF0000"><b>nil </b></font><font color="#000080">;
     </font>buffer <font color="#000080">:= @</font>rec <font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>size <font color="#FF0000"><b>do </b></font>buffer<font color="#000080">^[</font>I<font color="#000080">] := </font>buffer<font color="#000080">^[</font>i<font color="#000080">] </font><font color="#FF0000"><b>xor </b></font>sym <font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
 { Encrypts a record of SIZE with a Sliding String method }
</i></font><font color="#FF0000"><b>procedure </b></font>CryptStr<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Rec <font color="#000080">; </font>Size <font color="#000080">: </font>Word <font color="#000080">; </font>Ecrypt <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) ;
</font><font color="#FF0000"><b>type
    </b></font>buffers <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65535</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>I<font color="#000080">,</font>J <font color="#000080">: </font>word <font color="#000080">;
   </font>buffer <font color="#000080">: ^</font>buffers <font color="#000080">;
   </font>l <font color="#000080">: </font>integer <font color="#000080">;
   </font>c1 <font color="#000080">: </font>char <font color="#000080">;

</font><font color="#FF0000"><b>begin
     </b></font>l <font color="#000080">:= </font>length<font color="#000080">(</font>ecrypt<font color="#000080">) ;
     </font><font color="#FF0000"><b>if </b></font>l <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then
     begin
          </b></font>c1 <font color="#000080">:= </font>ecrypt<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] ;
          </font>cryptb<font color="#000080">(</font>rec<font color="#000080">,</font>size<font color="#000080">,</font>byte<font color="#000080">(</font>c1<font color="#000080">)) ;
          </font>exit <font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>l<font color="#000080">&lt;</font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>exit <font color="#000080">;
     </font>buffer <font color="#000080">:= </font><font color="#FF0000"><b>nil </b></font><font color="#000080">;
     </font>buffer <font color="#000080">:= @</font>rec <font color="#000080">;
     </font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>size <font color="#FF0000"><b>do
     begin
          </b></font>buffer<font color="#000080">^[</font>I<font color="#000080">] := </font>buffer<font color="#000080">^[</font>i<font color="#000080">] </font><font color="#FF0000"><b>xor </b></font>byte<font color="#000080">(</font>ecrypt<font color="#000080">[</font>j<font color="#000080">]) ;
          </font>inc<font color="#000080">(</font>j<font color="#000080">) ;
          </font><font color="#FF0000"><b>if </b></font>j <font color="#000080">&gt; </font>l <font color="#FF0000"><b>then
          begin
               </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;
               </font>c1 <font color="#000080">:= </font>ecrypt<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] ;
               </font>move<font color="#000080">(</font>ecrypt<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>ecrypt<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>l<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) ;
               </font>ecrypt<font color="#000080">[</font>l<font color="#000080">] := </font>c1 <font color="#000080">;
          </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
 { Encrypts a record of SIZE  with a list of random numbers produced by
 Initial Seeding with SEED }
</i></font><font color="#FF0000"><b>procedure </b></font>cryptS<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Rec <font color="#000080">; </font>size <font color="#000080">: </font>word <font color="#000080">; </font>Seed <font color="#000080">: </font>longint<font color="#000080">) ;

</font><font color="#FF0000"><b>type
    </b></font>buffers <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65535</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>I <font color="#000080">: </font>word <font color="#000080">;
   </font>buffer <font color="#000080">: ^</font>buffers <font color="#000080">;

</font><font color="#FF0000"><b>begin
     </b></font>randseed <font color="#000080">:= </font>seed <font color="#000080">;
     </font>buffer <font color="#000080">:= </font><font color="#FF0000"><b>nil </b></font><font color="#000080">;
     </font>buffer <font color="#000080">:= @</font>rec <font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>size <font color="#FF0000"><b>do </b></font>buffer<font color="#000080">^[</font>I<font color="#000080">] := </font>buffer<font color="#000080">^[</font>i<font color="#000080">] </font><font color="#FF0000"><b>xor </b></font>byte<font color="#000080">(</font>random<font color="#000080">(</font><font color="#800000">254</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) ;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{ Encrypts a file, with a string using a sliding string method }
{ String em up! }
</i></font><font color="#FF0000"><b>function </b></font>CryptfileStr<font color="#000080">(</font>Fname<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Ecrypt <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>integer <font color="#000080">;
</font><font color="#FF0000"><b>const
     </b></font>tempfilename <font color="#000080">= </font><font color="#800000">'KJETLHM.DS2' </font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>fromfile<font color="#000080">,</font>tofile <font color="#000080">: </font><font color="#FF0000"><b>file </b></font><font color="#000080">;
   </font>buffer <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2048</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">;
   </font>numread<font color="#000080">,</font>numwritten<font color="#000080">,</font>attr <font color="#000080">: </font>word <font color="#000080">;
   </font>error <font color="#000080">: </font>boolean <font color="#000080">;
   </font>I<font color="#000080">,</font>J<font color="#000080">,</font>L <font color="#000080">: </font>integer <font color="#000080">;
   </font>j2 <font color="#000080">: </font>longint <font color="#000080">;
   </font>c1 <font color="#000080">: </font>char <font color="#000080">;

</font><font color="#FF0000"><b>begin
     if not </b></font>fileexists<font color="#000080">(</font>fname<font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          </b></font>cryptfileStr <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;
          </font>exit <font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>ecrypt<font color="#000080">) &lt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>then
     begin
          </b></font>cryptfileStr <font color="#000080">:= </font><font color="#800000">2 </font><font color="#000080">;
          </font>exit <font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font>l <font color="#000080">:= </font>length<font color="#000080">(</font>ecrypt<font color="#000080">) ;
</font><font color="#008000"><i>{$I-}
     </i></font>assign<font color="#000080">(</font>fromfile<font color="#000080">,</font>fname<font color="#000080">) ;
     </font>assign<font color="#000080">(</font>tofile<font color="#000080">,</font>tempfilename<font color="#000080">) ;
     </font>getfattr<font color="#000080">(</font>fromfile<font color="#000080">,</font>attr<font color="#000080">) ;
     </font>setfattr<font color="#000080">(</font>fromfile<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">) ;
     </font>reset<font color="#000080">(</font>fromfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) ;
     </font>rewrite<font color="#000080">(</font>tofile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) ;
     </font><font color="#FF0000"><b>repeat
          </b></font>blockread<font color="#000080">(</font>fromfile<font color="#000080">,</font>buffer<font color="#000080">,</font>sizeof<font color="#000080">(</font>buffer<font color="#000080">),</font>numread<font color="#000080">) ;
          </font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;
          </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>sizeof<font color="#000080">(</font>buffer<font color="#000080">) </font><font color="#FF0000"><b>do
          begin
               </b></font>buffer<font color="#000080">[</font>I<font color="#000080">] := </font>buffer<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>xor </b></font>byte<font color="#000080">(</font>ecrypt<font color="#000080">[</font>j<font color="#000080">]) ;
               </font>inc<font color="#000080">(</font>j<font color="#000080">) ;
               </font><font color="#FF0000"><b>if </b></font>j <font color="#000080">&gt; </font>l <font color="#FF0000"><b>then
               begin
                    </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;
                    </font>c1 <font color="#000080">:= </font>ecrypt<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] ;
                    </font>move<font color="#000080">(</font>ecrypt<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>ecrypt<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>l<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) ;
                    </font>ecrypt<font color="#000080">[</font>l<font color="#000080">] := </font>c1 <font color="#000080">;
               </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
          </font>blockwrite<font color="#000080">(</font>tofile<font color="#000080">,</font>buffer<font color="#000080">,</font>numread<font color="#000080">,</font>numwritten<font color="#000080">) ;
     </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>numread <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>numwritten <font color="#000080">&lt;&gt; </font>numread<font color="#000080">) ;
     </font>close<font color="#000080">(</font>tofile<font color="#000080">) ;
     </font>close<font color="#000080">(</font>fromfile<font color="#000080">) ;
     </font>error <font color="#000080">:= </font>killfile<font color="#000080">(</font>fname<font color="#000080">) ;
     </font>rename<font color="#000080">(</font>tofile<font color="#000080">,</font>fname<font color="#000080">) ;
     </font>setfattr<font color="#000080">(</font>tofile<font color="#000080">,</font>attr<font color="#000080">) ;
</font><font color="#008000"><i>{$I+}
     </i></font>cryptfileStr <font color="#000080">:= (</font>IOresult<font color="#000080">)
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
 { encrypts a file with another file as the key, using a sliding method
 }
{ File this sucker! }
</i></font><font color="#FF0000"><b>Function </b></font>CryptfileWithFile<font color="#000080">(</font>Fname<font color="#000080">,</font>Keyname <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer <font color="#000080">;
</font><font color="#FF0000"><b>const
     </b></font>Tempfilename <font color="#000080">= </font><font color="#800000">'KJETLHM.DS3' </font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>Infile<font color="#000080">,</font>Keyfile<font color="#000080">,</font>Outfile <font color="#000080">: </font><font color="#FF0000"><b>file </b></font><font color="#000080">;
   </font>Bfile <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>Byte <font color="#000080">;
   </font>inBuffer<font color="#000080">,</font>keybuffer<font color="#000080">,</font>outbuffer <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2048</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">;
   </font>attr<font color="#000080">,</font>kattr <font color="#000080">: </font>word <font color="#000080">;
   </font>I<font color="#000080">,</font>J <font color="#000080">: </font>longint <font color="#000080">;
   </font>numread<font color="#000080">,</font>numwritten<font color="#000080">,</font>numkread <font color="#000080">: </font>word <font color="#000080">;
   </font>error <font color="#000080">: </font>boolean <font color="#000080">;

</font><font color="#FF0000"><b>begin
     if not </b></font>fileexists<font color="#000080">(</font>fname<font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          </b></font>cryptfilewithfile <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;
          </font>exit <font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font><font color="#FF0000"><b>if not </b></font>fileexists<font color="#000080">(</font>keyname<font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          </b></font>cryptfilewithfile <font color="#000080">:= </font><font color="#800000">2  </font><font color="#000080">;
          </font>exit <font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font><font color="#008000"><i>{$I-}
     </i></font>Assign<font color="#000080">(</font>infile<font color="#000080">,</font>fname<font color="#000080">) ;
     </font>assign<font color="#000080">(</font>keyfile<font color="#000080">,</font>keyname<font color="#000080">) ;
     </font>assign<font color="#000080">(</font>outfile<font color="#000080">,</font>tempfilename<font color="#000080">) ;
     </font>getfattr<font color="#000080">(</font>infile<font color="#000080">,</font>attr<font color="#000080">) ;
     </font>getfattr<font color="#000080">(</font>keyfile<font color="#000080">,</font>kattr<font color="#000080">) ;
     </font>setfattr<font color="#000080">(</font>infile<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">) ;
     </font>setfattr<font color="#000080">(</font>keyfile<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">) ;
     </font>reset<font color="#000080">(</font>infile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) ;
     </font>reset<font color="#000080">(</font>keyfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) ;
     </font>rewrite<font color="#000080">(</font>outfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) ;
     </font><font color="#FF0000"><b>repeat
          </b></font><font color="#008000"><i>{ Fill the input buffer }
          </i></font>blockread<font color="#000080">(</font>infile<font color="#000080">,</font>inbuffer<font color="#000080">,</font>sizeof<font color="#000080">(</font>inbuffer<font color="#000080">),</font>numread<font color="#000080">) ;
          </font><font color="#008000"><i>{ Fill the key buffer }
          </i></font>blockread<font color="#000080">(</font>keyfile<font color="#000080">,</font>keybuffer<font color="#000080">,</font>sizeof<font color="#000080">(</font>keybuffer<font color="#000080">),</font>numkread<font color="#000080">) ;
          </font>j <font color="#000080">:= </font>numkread <font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>numkread <font color="#000080">&lt; </font>numread <font color="#FF0000"><b>then </b></font><font color="#008000"><i>{ The Keyfile is smaller }
          </i></font><font color="#FF0000"><b>repeat  </b></font><font color="#008000"><i>{ Keep resetting and reading until the buffer is full }
               </i></font>reset<font color="#000080">(</font>keyfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) ;
               </font>blockread<font color="#000080">(</font>keyfile<font color="#000080">,</font>keybuffer<font color="#000080">[</font>j<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>numread<font color="#000080">-</font>j<font color="#000080">,</font>numkread<font color="#000080">) ;
               </font>j <font color="#000080">:= </font>j <font color="#000080">+ </font>numkread <font color="#000080">;
               </font><font color="#FF0000"><b>if </b></font>j <font color="#000080">&gt; </font>numread <font color="#FF0000"><b>then </b></font>HALT<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">) ;
          </font><font color="#FF0000"><b>until </b></font>j <font color="#000080">= </font>numread <font color="#000080">;
          </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numread <font color="#FF0000"><b>do
           </b></font>outbuffer<font color="#000080">[</font>I<font color="#000080">] := </font>inbuffer<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>XOR </b></font>keybuffer<font color="#000080">[</font>I<font color="#000080">] ;
          </font>blockwrite<font color="#000080">(</font>outfile<font color="#000080">,</font>outbuffer<font color="#000080">,</font>numread<font color="#000080">,</font>numwritten<font color="#000080">) ;
     </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>numread <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>numwritten <font color="#000080">&lt;&gt; </font>numread<font color="#000080">) ;
     </font>close<font color="#000080">(</font>keyfile<font color="#000080">) ;
     </font>setfattr<font color="#000080">(</font>keyfile<font color="#000080">,</font>kattr<font color="#000080">) ;  </font><font color="#008000"><i>{ Restore the attributes }
     </i></font>close<font color="#000080">(</font>infile<font color="#000080">) ;
     </font>close<font color="#000080">(</font>outfile<font color="#000080">) ;
     </font><font color="#008000"><i>{ Now destroy the old file }
     </i></font>error <font color="#000080">:= </font>killfile<font color="#000080">(</font>fname<font color="#000080">) ;
     </font>rename<font color="#000080">(</font>outfile<font color="#000080">,</font>fname<font color="#000080">) ;
     </font>setfattr<font color="#000080">(</font>outfile<font color="#000080">,</font>attr<font color="#000080">) ;
</font><font color="#008000"><i>{$I+}
     </i></font>cryptfilewithfile <font color="#000080">:= </font>IoResult <font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
 { Encrypts a file, using a list of random numbers generated with an
 initial SEED.   The Seed is your key } 
</i></font><font color="#FF0000"><b>function </b></font>CryptfileS<font color="#000080">(</font>Fname<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Seed <font color="#000080">: </font>Longint<font color="#000080">) : </font>integer <font color="#000080">;
</font><font color="#FF0000"><b>const
     </b></font>tempfilename <font color="#000080">= </font><font color="#800000">'KJETLHM.DS4' </font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>fromfile<font color="#000080">,</font>tofile <font color="#000080">: </font><font color="#FF0000"><b>file </b></font><font color="#000080">;
   </font>buffer <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2048</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">;
   </font>numread<font color="#000080">,</font>numwritten<font color="#000080">,</font>attr <font color="#000080">: </font>word <font color="#000080">;
   </font>I <font color="#000080">: </font>integer <font color="#000080">;
   </font>error <font color="#000080">: </font>boolean <font color="#000080">;

</font><font color="#FF0000"><b>begin
     if not </b></font>fileexists<font color="#000080">(</font>fname<font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          </b></font>cryptfileS <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;
          </font>exit <font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font>randseed <font color="#000080">:= </font>seed <font color="#000080">;
</font><font color="#008000"><i>{$I-}
     </i></font>assign<font color="#000080">(</font>fromfile<font color="#000080">,</font>fname<font color="#000080">) ;
     </font>assign<font color="#000080">(</font>tofile<font color="#000080">,</font>tempfilename<font color="#000080">) ;
     </font>getfattr<font color="#000080">(</font>fromfile<font color="#000080">,</font>attr<font color="#000080">) ;
     </font>setfattr<font color="#000080">(</font>fromfile<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">) ;
     </font>reset<font color="#000080">(</font>fromfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) ;
     </font>rewrite<font color="#000080">(</font>tofile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) ;
     </font><font color="#FF0000"><b>repeat
          </b></font>blockread<font color="#000080">(</font>fromfile<font color="#000080">,</font>buffer<font color="#000080">,</font>sizeof<font color="#000080">(</font>buffer<font color="#000080">),</font>numread<font color="#000080">) ;
          </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numread <font color="#FF0000"><b>do
           </b></font>buffer<font color="#000080">[</font>I<font color="#000080">] := </font>buffer<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>xor </b></font>byte<font color="#000080">(</font>random<font color="#000080">(</font><font color="#800000">254</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) ;
          </font>blockwrite<font color="#000080">(</font>tofile<font color="#000080">,</font>buffer<font color="#000080">,</font>numread<font color="#000080">,</font>numwritten<font color="#000080">) ;
     </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>numread <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>numwritten <font color="#000080">&lt;&gt; </font>numread<font color="#000080">) ;
     </font>close<font color="#000080">(</font>tofile<font color="#000080">) ;
     </font>close<font color="#000080">(</font>fromfile<font color="#000080">) ;
     </font>error <font color="#000080">:= </font>killfile<font color="#000080">(</font>fname<font color="#000080">);
     </font>rename<font color="#000080">(</font>tofile<font color="#000080">,</font>fname<font color="#000080">) ;
     </font>setfattr<font color="#000080">(</font>tofile<font color="#000080">,</font>attr<font color="#000080">) ;
</font><font color="#008000"><i>{$I+}
     </i></font>cryptfileS <font color="#000080">:= </font>IOresult  <font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
{****************************************************************************}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">. </font><font color="#008000"><i>{ Unit }

{
These are not weird math methods of encryption.  They are simple
 Extreemly fast XOR methods.  By using multiple methods on various parts
 of a file, or database, you can foil any attempt at cracking.  This is
 true because the cracker has no way of knowing where to start, even if
 he possesses the keys..

     I have a standing challenge, if anyone cares to take it...  Here
 are the methods, I'll post a small file, and even give you the keys I
 used to ecrypt a simple one line sentence.  If you can crack it, I'll
 buy you a pentium computer!
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0062.PAS">Original</a><b>]</b></p></body>
</html>
