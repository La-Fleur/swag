<html>
<head><title> "Data Input/Output Routines" by BOJAN LANDEKIC</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0072.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I am posting these because I feel they have been &quot;optimized' beyond my
abilities.  If you find a way to further optimize it, by speed, memory
requirements, and other things, please SEND ME THE VERSION!

I have a favour to ask all pascalians.  These routines seem to lock up
sometimes during the Retrieve_Function when I'm in a tight memory situation.
I say tight as I have less then 500k free in one of my programs.  If
someone could rewrite the part which copies (ie. BufSize parts), I would
gladly appreciate it.  Thanks!
}

</i></font><font color="#FF0000"><b>UNIT </b></font>DATAIO<font color="#000080">;
</font><font color="#008000"><i>{                        DATA Input/Output Routines

                      Given to the People as FreeWare
                          Includable into SWAG and
                         made expecialy for SWAG :)
                           AUTHOR: BOJAN LANDEKIC
                           SUBJECT: FILE DATA STORAGE (DATAIO)

 These routines allow you to take any number of files (max 255 as I used BYTE
 but you can change the limit to 65535 by using WORD instead).  As I said, it
 allows you to take that many files (or less) and include them into a single
 file (ie. ALLFILES.DAT).  Then you can retrieve/add/delete/view this file.
 I am testing out DATAIO v2.0 with encryption and compression routines, and
 that will be released into the Freeware as well.

 The three sub-units I use are STRIO (string handlers), FILEIO (file in/out
 routines) and VARS (a global declaration unit that is included everywhere).

 Each routine is a FUNCTION and returns an error code (0 if okay).  The
 error codes are examplained under the name of each of the functions.

 Even though this is made freeware I BEG everybody not to make changes and
 distribute them as their own work &lt;grin&gt;.  If you make changes, LET ME KNOW
 as I plan to make a compression program competitive to ZIP/ARJ and others.

 The routines which use the constant BufSize are taken from either FILES.SWG,
 COPYMOVE.SWG, or DOS.SWG from SWAG archives.  I cannot remember who the
 original author is, but I will check and when I find out, you will be
 credited.

}

</i></font><font color="#FF0000"><b>INTERFACE

Uses </b></font>Vars<font color="#000080">,
     </font>StrIo<font color="#000080">,
     </font>FileIO<font color="#000080">,
     </font>Crt<font color="#000080">,
     </font>Dos<font color="#000080">;

     </font><font color="#FF0000"><b>FUNCTION </b></font>Retrieve_File<font color="#000080">(</font>DataFilename<font color="#000080">, </font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Display<font color="#000080">: </font>Boolean<font color="#000080">): </font>Byte<font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Add_File<font color="#000080">(</font>DataFilename<font color="#000080">, </font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Display<font color="#000080">: </font>Boolean<font color="#000080">): </font>Byte<font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Remove_File<font color="#000080">(</font>DataFilename<font color="#000080">, </font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Display<font color="#000080">: </font>Boolean<font color="#000080">): </font>Byte<font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Show_File<font color="#000080">(</font>DataFilename<font color="#000080">, </font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

FUNCTION </b></font>Retrieve_File<font color="#000080">(</font>DataFilename<font color="#000080">, </font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Display<font color="#000080">: </font>Boolean<font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{
     This function returns the following:

     0 - [filename] has been retrieved successfully from [DataFilename]
     1 - [DataFilename] was not found/does not exist/was not specified
     2 - Header is incorrect (wrong file maybe?)
     3 - [Filename] was not found in [datafilename]
     4 - Not enough memory for FileBuf (decrese FileBuf)
     5 - Not enough disk space for the to-be-extracted file

     Datafile is formed like this

     XXXXXXXXXX   - The header
     ----------   - Individual file header #1  (information)
     CCCCCCCCCC   - File #1 itself (data/code segment)
     CCCCCCCCCC
     CCCCCCCCCC
     ----------   - Individual file header #2  (information)
     CCCCCCCCCC   - file #2 itself (data/code segment)
     CCCCCCCCCC
     CCCCCCCCCC
     CCCCCCCCCC
     CCCCCCCCCC
     ...          - ... you get the general idea
}
         </i></font><font color="#FF0000"><b>Const
              </b></font>BufSize <font color="#000080">= </font><font color="#800000">16384</font><font color="#000080">;

         </font><font color="#008000"><i>{for the copy part}
         </i></font><font color="#FF0000"><b>Type
             </b></font>FBuf <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>BufSize<font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
             </font>Fbf  <font color="#000080">= ^</font>FBuf<font color="#000080">;

          </font><font color="#FF0000"><b>Var
             </b></font>y<font color="#000080">,                         </font><font color="#008000"><i>{date function}
             </i></font>m<font color="#000080">,
             </font>d<font color="#000080">,
             </font>dow<font color="#000080">,
             </font>h<font color="#000080">,                         </font><font color="#008000"><i>{time function}
             </i></font>min<font color="#000080">,
             </font>s<font color="#000080">,
             </font>hund        <font color="#000080">: </font>Word<font color="#000080">;
             </font>CurrentFile <font color="#000080">: </font>Byte<font color="#000080">;        </font><font color="#008000"><i>{for searching through files}
             </i></font>DataFile<font color="#000080">,
             </font>ExtractFile <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;        </font><font color="#008000"><i>{file that's to be extracted}
             </i></font>Difference  <font color="#000080">: </font>Longint<font color="#000080">;     </font><font color="#008000"><i>{could be a WORD: diff betwen now-real}
             </i></font>OldPos<font color="#000080">,                    </font><font color="#008000"><i>{used for updating the ORIGINAL header}
             </i></font>ExtractPos  <font color="#000080">: </font>LongInt<font color="#000080">;     </font><font color="#008000"><i>{current size of extractfile}

             </i></font>Bread<font color="#000080">,                      </font><font color="#008000"><i>{for fast/error-free copying}
             </i></font>Bwrite   <font color="#000080">:    </font>word<font color="#000080">;
             </font>FileBuf  <font color="#000080">:    ^</font>fbf<font color="#000080">;

             </font>OldX<font color="#000080">,
             </font>OldY        <font color="#000080">: </font>Byte<font color="#000080">;        </font><font color="#008000"><i>{for display purposes only}

          </i></font><font color="#FF0000"><b>Begin
               </b></font><font color="#008000"><i>{Check for enough available memory}
               </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>MemAvail <font color="#000080">&gt; </font>BufSize<font color="#000080">) </font><font color="#FF0000"><b>then
                  </b></font>New<font color="#000080">(</font>FileBuf<font color="#000080">)
               </font><font color="#FF0000"><b>Else
                   begin
                        </b></font>Retrieve_File <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
                        </font>Exit<font color="#000080">;
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#008000"><i>{check if file exists, or if a filename has been specified}
               </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DataFilename <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                  </b></font><font color="#000080">(</font>Filename <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                  NOT </b></font>FileExists<font color="#000080">(</font>DataFilename<font color="#000080">) </font><font color="#FF0000"><b>Then
                      Begin
                           </b></font>Retrieve_File <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                           </font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
                           </font>Exit<font color="#000080">;
                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#008000"><i>{open the file}
               </i></font>Assign<font color="#000080">(</font>DataFile<font color="#000080">, </font>DataFilename<font color="#000080">);
               </font>Filemode <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
               </font>Reset<font color="#000080">(</font>DataFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

               </font><font color="#008000"><i>{open the file to be extracted/made}
               </i></font>Assign<font color="#000080">(</font>ExtractFile<font color="#000080">, </font>Filename<font color="#000080">);
               </font>Filemode <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
               </font>Rewrite<font color="#000080">(</font>ExtractFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

               </font><font color="#008000"><i>{check for the header id}
               </i></font>BlockRead<font color="#000080">(</font>DataFile<font color="#000080">, </font>Header<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));
               </font><font color="#FF0000"><b>If NOT </b></font><font color="#000080">(</font>Header<font color="#000080">.</font>Identification <font color="#000080">= </font>Id_Check<font color="#000080">) </font><font color="#FF0000"><b>Then
                  Begin
                       </b></font><font color="#008000"><i>{if the header not the same then it's not one of ours}
                       </i></font>Retrieve_File <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                       </font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
                       </font>Exit<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#008000"><i>{Go to the beginning of the first individual file header}
               </i></font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));

               </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                  Begin
                       </b></font>Write<font color="#000080">(</font><font color="#800000">'Searching...'</font><font color="#000080">);
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font><font color="#008000"><i>{loop through all the entries until [filename] is found}
               </i></font><font color="#FF0000"><b>For </b></font>CurrentFile <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Header<font color="#000080">.</font>NumberOfFiles <font color="#FF0000"><b>Do
                   Begin
                        </b></font><font color="#008000"><i>{read the header}
                        </i></font>FillChar<font color="#000080">(</font>FileHeader<font color="#000080">, </font>SizeOf<font color="#000080">(</font>FileHeader<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
                        </font>BlockRead<font color="#000080">(</font>DataFile<font color="#000080">, </font>FileHeader<font color="#000080">, </font>SizeOf<font color="#000080">(</font>FileHeader<font color="#000080">));

                        </font><font color="#008000"><i>{so the user doesn't think we're lazy :)}
                        {Writeln('Processing...');
                        Writeln('Filename : ', FileHeader.Filename);
                        Writeln('Size     : ', FileHeader.RealSize);}

                        {compare this file to the one the user wants}
                        </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>FileHeader<font color="#000080">.</font>Filename <font color="#000080">= </font>Filename<font color="#000080">) </font><font color="#FF0000"><b>Then
                           Begin
                                </b></font><font color="#008000"><i>{A-Ha, it is the file, extract it!}
                                {check for disk space}
                                </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DiskFree<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">) &lt; </font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">) </font><font color="#FF0000"><b>Then
                                   Begin
                                        </b></font>Retrieve_File <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
                                        </font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
                                        </font>Close<font color="#000080">(</font>DataFile<font color="#000080">);
                                        </font>Close<font color="#000080">(</font>ExtractFile<font color="#000080">);
                                        </font>Exit<font color="#000080">;
                                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                </font>ExtractPos <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                                </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                                   Begin
                                        </b></font>TextBackground<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
                                        </font>TextColor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
                                        </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                                        </font>ClrEol<font color="#000080">;
                                        </font>Write<font color="#000080">(</font><font color="#800000">'Extracting ' </font><font color="#000080">+ </font>Filename <font color="#000080">+ </font><font color="#800000">': '</font><font color="#000080">);
                                        </font>OldX <font color="#000080">:= </font>WhereY<font color="#000080">;
                                        </font>OldY <font color="#000080">:= </font>WhereY<font color="#000080">;
                                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                </font><font color="#008000"><i>{make sure we update the header, since the
                                 file is being &quot;updated&quot; as you might see}
                                </i></font>OldPos <font color="#000080">:= </font>FilePos<font color="#000080">(</font>DataFile<font color="#000080">);
                                </font>GetDate<font color="#000080">(</font>y<font color="#000080">, </font>m<font color="#000080">, </font>d<font color="#000080">, </font>dow<font color="#000080">);
                                </font>GetTime<font color="#000080">(</font>h<font color="#000080">, </font>min<font color="#000080">, </font>s<font color="#000080">, </font>hund<font color="#000080">);
                                </font>Header<font color="#000080">.</font>UpdatedOn <font color="#000080">:= </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>m<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">'-' </font><font color="#000080">+
                                                    </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>d<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">'-' </font><font color="#000080">+
                                                    </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>y<font color="#000080">), </font><font color="#800000">4</font><font color="#000080">) +
                                                    </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>h<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">':' </font><font color="#000080">+
                                                    </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>min<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">);
                                </font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
                                </font>BlockWrite<font color="#000080">(</font>DataFile<font color="#000080">, </font>Header<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));
                                </font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font>OldPos<font color="#000080">);
                                </font><font color="#FF0000"><b>Repeat
                                      </b></font>BlockRead<font color="#000080">(</font>DataFile<font color="#000080">, </font>FileBuf<font color="#000080">^, </font>BufSize<font color="#000080">, </font>Bread<font color="#000080">);
                                      </font>BlockWrite<font color="#000080">(</font>ExtractFile<font color="#000080">, </font>FileBuf<font color="#000080">^, </font>Bread<font color="#000080">, </font>Bwrite<font color="#000080">);
                                      </font>Inc<font color="#000080">(</font>ExtractPos<font color="#000080">, </font>Bread<font color="#000080">);
                                      </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                                         Begin
                                              </b></font>GotoXY<font color="#000080">(</font>OldX<font color="#000080">, </font>OldY<font color="#000080">);
                                              </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>ExtractPos <font color="#000080">&lt;= </font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">) </font><font color="#FF0000"><b>Then
                                                 </b></font>Write<font color="#000080">(</font>StatusBar<font color="#000080">(</font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">, </font>ExtractPos<font color="#000080">, </font><font color="#800000">42</font><font color="#000080">))
                                              </font><font color="#FF0000"><b>Else
                                                  </b></font>Write<font color="#000080">(</font>StatusBar<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">42</font><font color="#000080">)); </font><font color="#008000"><i>{100% effect :)}
                                         </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Bread <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Bread <font color="#000080">&lt;&gt; </font>Bwrite<font color="#000080">) </font><font color="#FF0000"><b>OR
                                      </b></font><font color="#000080">(</font>ExtractPos <font color="#000080">&gt; </font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">);

                                </font><font color="#008000"><i>{To compensate for the over-write}
                                </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>ExtractPos <font color="#000080">&gt; </font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">) </font><font color="#FF0000"><b>Then
                                   Begin
                                        </b></font>Difference <font color="#000080">:= (</font>ExtractPos <font color="#000080">- </font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">);
                                        </font><font color="#008000"><i>{Seek to the part where THIS file is supposed to end}
                                        </i></font>Seek<font color="#000080">(</font>ExtractFile<font color="#000080">, </font>FilePos<font color="#000080">(</font>ExtractFile<font color="#000080">) - </font>Difference<font color="#000080">);
                                        </font><font color="#008000"><i>{Erase the extra garbage}
                                        </i></font>Truncate<font color="#000080">(</font>Extractfile<font color="#000080">);
                                        </font><font color="#008000"><i>{Unneccesery, but just to be sure for multiple extractions}
                                        </i></font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font>FilePos<font color="#000080">(</font>DataFile<font color="#000080">) - </font>Difference<font color="#000080">);
                                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                </font><font color="#008000"><i>{extracted, now we quit}
                                </i></font>Retrieve_File <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                                </font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
                                </font>Close<font color="#000080">(</font>DataFile<font color="#000080">);
                                </font>Close<font color="#000080">(</font>ExtractFile<font color="#000080">);
                                </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                                   Begin
                                        </b></font>GotoXY<font color="#000080">(</font>OldX<font color="#000080">, </font>OldY<font color="#000080">);
                                        </font>ClrEol<font color="#000080">;
                                        </font>Writeln<font color="#000080">(</font><font color="#800000">'Done!'</font><font color="#000080">);
                                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                </font>Exit<font color="#000080">;
                           </font><font color="#FF0000"><b>End
                        Else
                            Begin
                                 </b></font><font color="#008000"><i>{Go to next record, right}
                                 </i></font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font>FilePos<font color="#000080">(</font>DataFile<font color="#000080">) + </font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">);
                            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#008000"><i>{If we get to here, means the file was not in the datafile}
               </i></font>Retrieve_File <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
               </font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
               </font>Close<font color="#000080">(</font>DataFile<font color="#000080">);
               </font>Close<font color="#000080">(</font>ExtractFile<font color="#000080">);
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>Add_File<font color="#000080">(</font>DataFilename<font color="#000080">, </font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Display<font color="#000080">: </font>Boolean<font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{ - The part that &quot;copyies&quot; the file was gotten from SWAG, the original
    author of the &quot;copying&quot; part was Floor A.C. Naaijkens
}

{
     This function can possibly return the following values:

     0 - [filename] has been successfully added to [datafilename]
     1 - [datafilename] and/or [filename] have not be specified/don't exist
     2 - Could not create/open [datafilename]
     3 - [datafilename] is not one of our files, wrong file type maybe??
     4 - [filename] opening error
     5 - Not enough memory (on the stack, 16386 needed)..  Decrease BufSize
     6 - Error during copy
     7 - No more files allowed (254 file limit reached
}

         {for the copy part}
         </i></font><font color="#FF0000"><b>Const
              </b></font>BufSize <font color="#000080">= </font><font color="#800000">16384</font><font color="#000080">;

         </font><font color="#008000"><i>{for the copy part}
         </i></font><font color="#FF0000"><b>Type
             </b></font>FBuf <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>BufSize<font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
             </font>Fbf  <font color="#000080">= ^</font>FBuf<font color="#000080">;

         </font><font color="#FF0000"><b>Var
            </b></font>y<font color="#000080">,
            </font>m<font color="#000080">,
            </font>d<font color="#000080">,
            </font>dow<font color="#000080">,                        </font><font color="#008000"><i>{for the date}
            </i></font>h<font color="#000080">,
            </font>min<font color="#000080">,
            </font>s<font color="#000080">,
            </font>hund    <font color="#000080">: </font>Word<font color="#000080">;             </font><font color="#008000"><i>{for the time}

            </i></font>DataFile<font color="#000080">,
            </font>AddFile <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;             </font><font color="#008000"><i>{file to be added}
            </i></font>NewFile <font color="#000080">: </font>Boolean<font color="#000080">;          </font><font color="#008000"><i>{specifies wheter [datafile] is new}

            </i></font>Bread<font color="#000080">,                      </font><font color="#008000"><i>{for fast/error-free copying}
            </i></font>Bwrite   <font color="#000080">:    </font>word<font color="#000080">;
            </font>FileBuf  <font color="#000080">:    ^</font>fbf<font color="#000080">;

            </font>OldX<font color="#000080">,
            </font>OldY     <font color="#000080">: </font>Byte<font color="#000080">;
            </font>StartAt  <font color="#000080">: </font>LongInt<font color="#000080">;         </font><font color="#008000"><i>{for display purposes only}

            </i></font>DirInfo     <font color="#000080">: </font>SearchRec<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font><font color="#008000"><i>{Check for enough available memory}
              </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>MemAvail <font color="#000080">&gt; </font>BufSize<font color="#000080">) </font><font color="#FF0000"><b>then
                 </b></font>New<font color="#000080">(</font>FileBuf<font color="#000080">)
              </font><font color="#FF0000"><b>else
                  begin
                       </b></font>Add_File <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
                       </font>Exit
                  <font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#008000"><i>{check if file exists, or if a filename has been specified}
               </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DataFilename <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Filename <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                  Begin
                       </b></font>Add_File <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                       </font>Exit<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#008000"><i>{check if the datafile exists}
               </i></font>Assign<font color="#000080">(</font>DataFile<font color="#000080">, </font>DataFilename<font color="#000080">);
               </font><font color="#FF0000"><b>IF NOT </b></font>FileExists<font color="#000080">(</font>Datafilename<font color="#000080">) </font><font color="#FF0000"><b>Then
                  Begin
                       </b></font><font color="#008000"><i>{$I-}
                       </i></font>FileMode <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                       </font>Rewrite<font color="#000080">(</font>DataFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                       </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                          Begin
                               </b></font>Add_File <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                               </font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
                               </font>Exit<font color="#000080">;
                          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                       </font><font color="#008000"><i>{$I+}
                       </i></font>NewFile <font color="#000080">:= </font>True<font color="#000080">;
                  </font><font color="#FF0000"><b>End
               Else
                   Begin
                        </b></font>FileMode <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                        </font><font color="#008000"><i>{$I-}
                        </i></font>Reset<font color="#000080">(</font>DataFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                        </font><font color="#008000"><i>{$I+}
                        </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                           Begin
                                </b></font>Add_File <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                                </font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
                                </font>Exit<font color="#000080">;
                           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                        </font>NewFile <font color="#000080">:= </font>False<font color="#000080">;
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#FF0000"><b>If </b></font>NewFile <font color="#FF0000"><b>Then
                  </b></font><font color="#008000"><i>{New file initialization}
                  </i></font><font color="#FF0000"><b>Begin
                       </b></font>Getdate<font color="#000080">(</font>y<font color="#000080">, </font>m<font color="#000080">, </font>d<font color="#000080">, </font>dow<font color="#000080">);
                       </font>GetTime<font color="#000080">(</font>h<font color="#000080">, </font>min<font color="#000080">, </font>s<font color="#000080">, </font>hund<font color="#000080">);
                       </font>FillChar<font color="#000080">(</font>Header<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Header<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
                       </font>Header<font color="#000080">.</font>Identification <font color="#000080">:= </font>Id_Check<font color="#000080">;
                       </font>Header<font color="#000080">.</font>CreatedOn <font color="#000080">:= </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>m<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">'-' </font><font color="#000080">+
                                           </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>d<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">'-' </font><font color="#000080">+
                                           </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>y<font color="#000080">), </font><font color="#800000">4</font><font color="#000080">) +
                                           </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>h<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">':' </font><font color="#000080">+
                                           </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>min<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">);
                       </font>Header<font color="#000080">.</font>UpdatedOn <font color="#000080">:= </font>Header<font color="#000080">.</font>CreatedOn<font color="#000080">;
                       </font>Header<font color="#000080">.</font>NumberOfFiles <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                       </font>BlockWrite<font color="#000080">(</font>DataFile<font color="#000080">, </font>Header<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));
                       </font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#008000"><i>{Already existing file initialization}
               </i></font>BlockRead<font color="#000080">(</font>Datafile<font color="#000080">, </font>Header<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));

                    </font><font color="#008000"><i>{check for the ID string}
               </i></font><font color="#FF0000"><b>If NOT </b></font><font color="#000080">(</font>Header<font color="#000080">.</font>Identification <font color="#000080">= </font>Id_Check<font color="#000080">) </font><font color="#FF0000"><b>Then
                  Begin
                       </b></font>Add_File <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
                       </font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
                       </font>Close<font color="#000080">(</font>DataFile<font color="#000080">);
                       </font>Exit<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#008000"><i>{Go to the appropriate place in the datafile where
                the writing will start}
               </i></font>Filename <font color="#000080">:= </font>Strip_Path<font color="#000080">(</font>UCase<font color="#000080">(</font>Filename<font color="#000080">));
               </font>FindFirst<font color="#000080">(</font>Filename<font color="#000080">, </font>Archive<font color="#000080">, </font>DirInfo<font color="#000080">);
               </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>DosError <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Do
                     Begin
                          </b></font>Assign<font color="#000080">(</font>AddFile<font color="#000080">, </font>DirInfo<font color="#000080">.</font>Name<font color="#000080">);
                          </font>Filemode <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                          </font><font color="#008000"><i>{$I-}
                          </i></font>Reset<font color="#000080">(</font>AddFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                          </font><font color="#008000"><i>{$I+}
                          </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                             Begin
                                  </b></font>Add_File <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
                                  </font>Close<font color="#000080">(</font>DataFile<font color="#000080">);
                                  </font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
                                  </font>Exit<font color="#000080">;
                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                          </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Header<font color="#000080">.</font>NumberOffiles <font color="#000080">&gt; </font><font color="#800000">254</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                             Begin
                                  </b></font>Add_File <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;
                                  </font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
                                  </font>Close<font color="#000080">(</font>DataFile<font color="#000080">);
                                  </font>Exit<font color="#000080">;
                             </font><font color="#FF0000"><b>End
                          Else
                              </b></font>Inc<font color="#000080">(</font>Header<font color="#000080">.</font>NumberOfFiles<font color="#000080">);

                          </font>Header<font color="#000080">.</font>UpdatedOn <font color="#000080">:= </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>m<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">'-' </font><font color="#000080">+
                                              </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>d<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">'-' </font><font color="#000080">+
                                              </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>y<font color="#000080">), </font><font color="#800000">4</font><font color="#000080">) +
                                              </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>h<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">':' </font><font color="#000080">+
                                              </font>Leading_Zero<font color="#000080">(</font>ITOA<font color="#000080">(</font>min<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">);
                          </font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
                          </font>BlockWrite<font color="#000080">(</font>DataFile<font color="#000080">, </font>Header<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));
                          </font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font>FileSize<font color="#000080">(</font>DataFile<font color="#000080">));

                          </font><font color="#008000"><i>{Here we set the individual file header to the appropriate
                          information}
                          </i></font>FillChar<font color="#000080">(</font>FileHeader<font color="#000080">, </font>SizeOf<font color="#000080">(</font>FileHeader<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);

                          </font>FileHeader<font color="#000080">.</font>Attribute <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                          </font>FileHeader<font color="#000080">.</font>Filename <font color="#000080">:= </font>Dirinfo<font color="#000080">.</font>Name<font color="#000080">;
                          </font>FileHeader<font color="#000080">.</font>CompType <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                          </font>FileHeader<font color="#000080">.</font>RealSize <font color="#000080">:= </font>FileSize<font color="#000080">(</font>AddFile<font color="#000080">);
                          </font>FileHeader<font color="#000080">.</font>CompSize <font color="#000080">:= </font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">;
                          </font>FileHeader<font color="#000080">.</font>Crc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

                          </font><font color="#008000"><i>{check for disk space}
                          </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DiskFree<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">) &lt; </font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">) </font><font color="#FF0000"><b>Then
                             Begin
                                  </b></font>Add_File <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
                                  </font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
                                  </font>Close<font color="#000080">(</font>DataFile<font color="#000080">);
                                  </font>Exit<font color="#000080">;
                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                          </font>BlockWrite<font color="#000080">(</font>DataFile<font color="#000080">, </font>FileHeader<font color="#000080">, </font>SizeOf<font color="#000080">(</font>FileHeader<font color="#000080">));

                          </font><font color="#008000"><i>{copy the file}
                          </i></font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                             Begin
                                  </b></font>TextBackground<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
                                  </font>TextColor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
                                  </font>Write<font color="#000080">(</font><font color="#800000">'Adding ' </font><font color="#000080">+ </font>Dirinfo<font color="#000080">.</font>Name <font color="#000080">+ </font><font color="#800000">': '</font><font color="#000080">);
                                  </font>OldX <font color="#000080">:= </font>WhereX<font color="#000080">;
                                  </font>OldY <font color="#000080">:= </font>WhereY<font color="#000080">;
                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                          </font>StartAt <font color="#000080">:= </font>FilePos<font color="#000080">(</font>DataFile<font color="#000080">);
                          </font><font color="#FF0000"><b>Repeat
                                </b></font>BlockRead<font color="#000080">(</font>AddFile<font color="#000080">, </font>FileBuf<font color="#000080">^, </font>BufSize<font color="#000080">, </font>Bread<font color="#000080">);
                                </font>BlockWrite<font color="#000080">(</font>DataFile<font color="#000080">, </font>FileBuf<font color="#000080">^, </font>Bread<font color="#000080">, </font>Bwrite<font color="#000080">);
                                </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                                   Begin
                                        </b></font>GotoXY<font color="#000080">(</font>OldX<font color="#000080">, </font>OldY<font color="#000080">);
                                        </font>Write<font color="#000080">(</font>StatusBar<font color="#000080">(</font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">, (</font>FilePos<font color="#000080">(</font>DataFile<font color="#000080">) - </font>StartAt<font color="#000080">), </font><font color="#800000">50</font><font color="#000080">));
                                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                          </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Bread <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Bread <font color="#000080">&lt;&gt; </font>Bwrite<font color="#000080">);

                          </font>Close<font color="#000080">(</font>AddFile<font color="#000080">);
                          </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                             Begin
                                  </b></font>GotoXY<font color="#000080">(</font>OldX<font color="#000080">, </font>Oldy<font color="#000080">);
                                  </font>ClrEol<font color="#000080">;
                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                          </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Bread <font color="#000080">&lt;&gt; </font>Bwrite<font color="#000080">) </font><font color="#FF0000"><b>then
                             Begin
                                  If </b></font>Display <font color="#FF0000"><b>Then
                                     </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error occured while adding!'</font><font color="#000080">);
                                  </font>Add_File <font color="#000080">:= </font><font color="#800000">6
                             </font><font color="#FF0000"><b>End
                          Else
                              Begin
                                   If </b></font>Display <font color="#FF0000"><b>Then
                                      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Done!'</font><font color="#000080">);
                                   </font>Add_File <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                          </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{while loop}
               </i></font>Dispose<font color="#000080">(</font>FileBuf<font color="#000080">);
               </font>Close<font color="#000080">(</font>DataFile<font color="#000080">);
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>Remove_File<font color="#000080">(</font>DataFilename<font color="#000080">, </font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Display<font color="#000080">: </font>Boolean<font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{  This function returns the following:

   0 - [filename] has been succcessfully deleted from Datafilename
   1 - [filename] or [datafilename] are empty or [datafilename] does not exist
   2 - Not enough disk space (minimum = file size of [datafilename])
   3 - [datafilename] is not of our type.  Maybe not the right format? Hmm..:)
}
         </i></font><font color="#FF0000"><b>Const
              </b></font>tFilename    <font color="#000080">:    </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">] = </font><font color="#800000">'DATA.!!!'</font><font color="#000080">; </font><font color="#008000"><i>{temporary file}

         </i></font><font color="#FF0000"><b>Var
            </b></font>OldX<font color="#000080">,
            </font>OldY<font color="#000080">,                          </font><font color="#008000"><i>{for display}
            </i></font>TotalFiles<font color="#000080">,                    </font><font color="#008000"><i>{just for the heck of it}
            </i></font>CurrentFile    <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{the for-end loop}
            </i></font>eFileHeader    <font color="#000080">: </font>tFileHeader<font color="#000080">;  </font><font color="#008000"><i>{Empty file header}
            </i></font>tDataFile<font color="#000080">,                     </font><font color="#008000"><i>{only used by the Rename function}
            </i></font>DataFile       <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;         </font><font color="#008000"><i>{file being worked on}
            </i></font>OldPos         <font color="#000080">: </font>Longint<font color="#000080">;      </font><font color="#008000"><i>{to be sure pointer is always there}

            </i></font>Cur_File<font color="#000080">,                   </font><font color="#008000"><i>{for multiple file additions}
            </i></font>Search_File <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];
            </font>Cur_Ext<font color="#000080">,
            </font>Search_Ext  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];

         </font><font color="#FF0000"><b>Begin
              </b></font>Assign<font color="#000080">(</font>DataFile<font color="#000080">, </font>DataFilename<font color="#000080">);
              </font>Assign<font color="#000080">(</font>tDataFile<font color="#000080">, </font>tFilename<font color="#000080">);

              </font><font color="#008000"><i>{check if file exists, or if a filename has been specified}
              </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DataFilename <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                  </b></font><font color="#000080">(</font>Filename <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                  </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>FileExists<font color="#000080">(</font>DataFilename<font color="#000080">)) </font><font color="#FF0000"><b>Then
                       Begin
                            </b></font>Remove_File <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                            </font>Exit<font color="#000080">;
                       </font><font color="#FF0000"><b>End
                  Else
                      </b></font>Reset<font color="#000080">(</font>DataFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

              </font><font color="#008000"><i>{check for disk space}
              </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DiskFree<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">) &lt; </font>FileSize<font color="#000080">(</font>DataFile<font color="#000080">)) </font><font color="#FF0000"><b>Then
                 Begin
                      </b></font>Remove_File <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                      </font>Close<font color="#000080">(</font>DataFile<font color="#000080">);
                      </font>Exit<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font><font color="#008000"><i>{check for the header id}
              </i></font>BlockRead<font color="#000080">(</font>DataFile<font color="#000080">, </font>Header<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));
              </font><font color="#FF0000"><b>If NOT </b></font><font color="#000080">(</font>Header<font color="#000080">.</font>Identification <font color="#000080">= </font>Id_Check<font color="#000080">) </font><font color="#FF0000"><b>Then
                 Begin
                      </b></font><font color="#008000"><i>{if the header is not the same then it's not one of ours}
                      </i></font>Remove_File <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
                      </font>Exit<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#008000"><i>{Go to the beginning of the first individual file header}
               </i></font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));

               </font>Filename <font color="#000080">:= </font>UCase<font color="#000080">(</font>Filename<font color="#000080">);
               </font>TotalFiles <font color="#000080">:= </font>Header<font color="#000080">.</font>NumberOfFiles<font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                  Begin
                       </b></font>Writeln<font color="#000080">;
                       </font>Write<font color="#000080">(</font><font color="#800000">'Removing: ' </font><font color="#000080">+ </font>Filename<font color="#000080">);
                       </font>OldX <font color="#000080">:= </font>WhereX <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                       </font>OldY <font color="#000080">:= </font>WhereY<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font><font color="#008000"><i>{loop through all the entries until [filename] is found}
{BUG!          Header.NumberOfFiles seems to change for some reason here!!}
               </i></font>Search_File <font color="#000080">:= </font>Copy<font color="#000080">(</font>Filename<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>Filename<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
               </font>Search_Ext <font color="#000080">:= </font>Copy<font color="#000080">(</font>Filename<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>Filename<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>Filename<font color="#000080">));
               </font><font color="#FF0000"><b>For </b></font>CurrentFile <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>TotalFiles <font color="#FF0000"><b>Do
                   Begin
                        </b></font><font color="#008000"><i>{read the header}
                        </i></font>FillChar<font color="#000080">(</font>eFileHeader<font color="#000080">, </font>SizeOf<font color="#000080">(</font>eFileHeader<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
                        </font>BlockRead<font color="#000080">(</font>DataFile<font color="#000080">, </font>eFileHeader<font color="#000080">, </font>SizeOf<font color="#000080">(</font>eFileHeader<font color="#000080">));
                        </font>OldPos <font color="#000080">:= </font>FilePos<font color="#000080">(</font>DataFile<font color="#000080">);

                        </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                           Begin
                                </b></font>GotoXy<font color="#000080">(</font>OldX<font color="#000080">, </font>OldY<font color="#000080">);
                                </font>Write<font color="#000080">(</font>StatusBar<font color="#000080">(</font>TotalFiles<font color="#000080">, </font>CurrentFile<font color="#000080">, </font><font color="#800000">48</font><font color="#000080">));
                           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                        </font><font color="#008000"><i>{compare this file to the one the user wants}
                        </i></font>Cur_File <font color="#000080">:= </font>Copy<font color="#000080">(</font>eFileHeader<font color="#000080">.</font>Filename<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>eFileHeader<font color="#000080">.</font>Filename<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
                        </font>Cur_Ext<font color="#000080">:=</font>Copy<font color="#000080">(</font>eFileHeader<font color="#000080">.</font>Filename<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>eFileHeader<font color="#000080">.</font>Filename<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>eFileHeader<font color="#000080">.</font>Filename<font color="#000080">));
                        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>Compare_Filenames<font color="#000080">(</font>Search_File<font color="#000080">, </font>Cur_File<font color="#000080">)) </font><font color="#FF0000"><b>OR
                           </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>Compare_Filenames<font color="#000080">(</font>Search_Ext<font color="#000080">, </font>Cur_Ext<font color="#000080">)) </font><font color="#FF0000"><b>Then
                                Begin
                                     </b></font><font color="#008000"><i>{remove it from the original archive}
                                     </i></font>Retrieve_File<font color="#000080">(</font>DataFilename<font color="#000080">, </font>eFileHeader<font color="#000080">.</font>Filename<font color="#000080">, </font>False<font color="#000080">);
                                     </font><font color="#008000"><i>{add it to the temporary archive}
                                     </i></font>Add_File<font color="#000080">(</font>tFilename<font color="#000080">, </font>eFileHeader<font color="#000080">.</font>Filename<font color="#000080">, </font>False<font color="#000080">);
                                     </font><font color="#008000"><i>{go to the next file}
                                </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                        </font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font>OldPos <font color="#000080">+ </font>eFileHeader<font color="#000080">.</font>RealSize<font color="#000080">);
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font>Close<font color="#000080">(</font>DataFile<font color="#000080">);
               </font>Erase<font color="#000080">(</font>DataFile<font color="#000080">);
               </font>Rename<font color="#000080">(</font>tDataFile<font color="#000080">, </font>DataFilename<font color="#000080">);
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>Show_File<font color="#000080">(</font>DataFilename<font color="#000080">, </font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{ This functions returns the following:

   0 - Displayed
   1 - [datafilename] is blank or does not exist!
   2 - File is of wrong type, meaning it's not one made by this program.
}

         </i></font><font color="#FF0000"><b>Var
            </b></font>OldY           <font color="#000080">: </font>Byte<font color="#000080">;
            </font>DataFile       <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
            </font>CurrentFile    <font color="#000080">: </font>Byte<font color="#000080">;

            </font>Cur_File<font color="#000080">,                        </font><font color="#008000"><i>{current file name without extension}
            </i></font>Search_File    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];      </font><font color="#008000"><i>{file name without the extension}
            </i></font>Cur_Ext<font color="#000080">,                         </font><font color="#008000"><i>{current file extension only, no name}
            </i></font>Search_Ext     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];      </font><font color="#008000"><i>{file extension only, no name}
            </i></font>TotalFiles     <font color="#000080">: </font>Byte<font color="#000080">;           </font><font color="#008000"><i>{counter for displayed files}
            </i></font>TotalBytes     <font color="#000080">: </font>Longint<font color="#000080">;        </font><font color="#008000"><i>{counter for displayed bytes}

         </i></font><font color="#FF0000"><b>Begin
               </b></font><font color="#008000"><i>{check if file exists, or if a filename has been specified}
               </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DataFilename <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                  </b></font><font color="#008000"><i>{(Filename = '') OR}       {not implemented yet}
                  </i></font><font color="#FF0000"><b>NOT </b></font>FileExists<font color="#000080">(</font>DataFilename<font color="#000080">) </font><font color="#FF0000"><b>Then
                      Begin
                           </b></font>Show_File <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                           </font>Exit<font color="#000080">;
                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#008000"><i>{open the file}
               </i></font>Assign<font color="#000080">(</font>DataFile<font color="#000080">, </font>DataFilename<font color="#000080">);
               </font>Reset<font color="#000080">(</font>DataFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

               </font><font color="#008000"><i>{check for the header id}
               </i></font>BlockRead<font color="#000080">(</font>DataFile<font color="#000080">, </font>Header<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));
               </font><font color="#FF0000"><b>If NOT </b></font><font color="#000080">(</font>Header<font color="#000080">.</font>Identification <font color="#000080">= </font>Id_Check<font color="#000080">) </font><font color="#FF0000"><b>Then
                  Begin
                       </b></font><font color="#008000"><i>{if the header is not the same then it's not one of ours}
                       </i></font>Show_File <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                       </font>Exit<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#008000"><i>{Go to the beginning of the first individual file header!
                This is done already by BlockRead, but just to be on the
                safe side :)}
               </i></font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));

               </font><font color="#008000"><i>{loop through all the entries until [filename] is found}
               </i></font>Writeln<font color="#000080">;
               </font>Writeln<font color="#000080">;
               </font>Write<font color="#000080">(</font><font color="#800000">'Listing of ' </font><font color="#000080">+ </font>DataFilename<font color="#000080">);
               </font>GotoXY<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">, </font>WhereY<font color="#000080">);
               </font>Write<font color="#000080">(</font>FileSize<font color="#000080">(</font>DataFile<font color="#000080">));
               </font>Write<font color="#000080">(</font><font color="#800000">' ('</font><font color="#000080">);
               </font>Write<font color="#000080">(</font>FileSize<font color="#000080">(</font>DataFile<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">1024</font><font color="#000080">);
               </font>Write<font color="#000080">(</font><font color="#800000">'k)'</font><font color="#000080">);
               </font>Writeln<font color="#000080">;
               </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
               </font>Write<font color="#000080">(</font><font color="#800000">'Created On: '</font><font color="#000080">);
               </font>Write<font color="#000080">(</font>Copy<font color="#000080">(</font>Header<font color="#000080">.</font>CreatedOn<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">));
               </font>Write<font color="#000080">(</font><font color="#800000">' at '</font><font color="#000080">);
               </font>Write<font color="#000080">(</font>Copy<font color="#000080">(</font>Header<font color="#000080">.</font>CreatedOn<font color="#000080">, </font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">));
               </font>GotoXY<font color="#000080">(</font><font color="#800000">35</font><font color="#000080">, </font>WhereY<font color="#000080">);
               </font>Write<font color="#000080">(</font><font color="#800000">'Last updated On: '</font><font color="#000080">);
               </font>Write<font color="#000080">(</font>Copy<font color="#000080">(</font>Header<font color="#000080">.</font>UpdatedOn<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">));
               </font>Write<font color="#000080">(</font><font color="#800000">' at '</font><font color="#000080">);
               </font>Write<font color="#000080">(</font>Copy<font color="#000080">(</font>Header<font color="#000080">.</font>UpdatedOn<font color="#000080">, </font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">));
               </font>GotoXY<font color="#000080">(</font><font color="#800000">71</font><font color="#000080">, </font>WhereY<font color="#000080">);
               </font>Write<font color="#000080">(</font><font color="#800000">' Files: '</font><font color="#000080">);
               </font>Write<font color="#000080">(</font>Header<font color="#000080">.</font>NumberOffiles<font color="#000080">);
               </font>Writeln<font color="#000080">;
               </font>Writeln<font color="#000080">;
               </font>Writeln<font color="#000080">(</font><font color="#800000">'FILENAME.EXT  SIZE                '</font><font color="#000080">);
               </font>Writeln<font color="#000080">(</font><font color="#800000">'------------  --------------------'</font><font color="#000080">);


               </font>TotalBytes <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
               </font>TotalFiles <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
               </font>Search_File <font color="#000080">:= </font>Copy<font color="#000080">(</font>Filename<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>Filename<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
               </font>Search_Ext <font color="#000080">:= </font>Copy<font color="#000080">(</font>Filename<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>Filename<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>Filename<font color="#000080">));

               </font><font color="#FF0000"><b>For </b></font>CurrentFile <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Header<font color="#000080">.</font>NumberOfFiles <font color="#FF0000"><b>Do
                   Begin
                        </b></font><font color="#008000"><i>{read the header}
                        </i></font>FillChar<font color="#000080">(</font>FileHeader<font color="#000080">, </font>SizeOf<font color="#000080">(</font>FileHeader<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
                        </font>BlockRead<font color="#000080">(</font>DataFile<font color="#000080">, </font>FileHeader<font color="#000080">, </font>SizeOf<font color="#000080">(</font>FileHeader<font color="#000080">));

                        </font><font color="#008000"><i>{so the user doesn't think we're lazy :)}

                        </i></font>Cur_File <font color="#000080">:= </font>Copy<font color="#000080">(</font>FileHeader<font color="#000080">.</font>Filename<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>FileHeader<font color="#000080">.</font>Filename<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
                        </font>Cur_Ext <font color="#000080">:= </font>Copy<font color="#000080">(</font>FileHeader<font color="#000080">.</font>Filename<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>FileHeader<font color="#000080">.</font>Filename<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>FileHeader<font color="#000080">.</font>Filename<font color="#000080">));
                        </font><font color="#FF0000"><b>If </b></font>Compare_Filenames<font color="#000080">(</font>Search_File<font color="#000080">, </font>Cur_File<font color="#000080">) </font><font color="#FF0000"><b>Then
                           If </b></font>Compare_Filenames<font color="#000080">(</font>Search_Ext<font color="#000080">, </font>Cur_Ext<font color="#000080">) </font><font color="#FF0000"><b>Then
                              Begin
                                   </b></font>OldY <font color="#000080">:= </font>WhereY<font color="#000080">;
                                   </font>Write<font color="#000080">(</font>FileHeader<font color="#000080">.</font>Filename<font color="#000080">);
                                   </font>GotoXY<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">, </font>OldY<font color="#000080">);
                                   </font>Write<font color="#000080">(</font><font color="#800000">' ' </font><font color="#000080">:(</font><font color="#800000">11 </font><font color="#000080">- </font>Length<font color="#000080">(</font>ITOA<font color="#000080">(</font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">))));
                                   </font>Write<font color="#000080">(</font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">);
                                   </font>Writeln<font color="#000080">;
                                   </font>Inc<font color="#000080">(</font>TotalBytes<font color="#000080">, </font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">);
                                   </font>Inc<font color="#000080">(</font>TotalFiles<font color="#000080">);
                              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                        </font><font color="#008000"><i>{go to the next record}
                        </i></font>Seek<font color="#000080">(</font>DataFile<font color="#000080">, </font>FilePos<font color="#000080">(</font>DataFile<font color="#000080">) + </font>FileHeader<font color="#000080">.</font>RealSize<font color="#000080">);
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font>Writeln<font color="#000080">(</font><font color="#800000">'------------  --------------------'</font><font color="#000080">);
               </font>OldY <font color="#000080">:= </font>WhereY<font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>TotalBytes <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'No files'</font><font color="#000080">)
               </font><font color="#FF0000"><b>Else
                   If </b></font><font color="#000080">(</font>TotalFiles <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                      </b></font>Write<font color="#000080">(</font><font color="#800000">'1 file'</font><font color="#000080">)
                   </font><font color="#FF0000"><b>Else
                       </b></font>Write<font color="#000080">(</font>ITOA<font color="#000080">(</font>TotalFiles<font color="#000080">), </font><font color="#800000">' files'</font><font color="#000080">);
               </font>GotoXY<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">, </font>OldY<font color="#000080">);
               </font>Write<font color="#000080">(</font><font color="#800000">' ' </font><font color="#000080">:(</font><font color="#800000">11 </font><font color="#000080">- </font>Length<font color="#000080">(</font>ITOA<font color="#000080">(</font>TotalBytes<font color="#000080">))));
               </font>Write<font color="#000080">(</font>TotalBytes<font color="#000080">);
               </font>Writeln<font color="#000080">;
               </font><font color="#008000"><i>{If we get to here, means everything's cool}
               </i></font>Close<font color="#000080">(</font>DataFile<font color="#000080">);
               </font>Show_File <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.

</font><font color="#008000"><i>{
 ****************************************************************************
 **** UNIT: VARS.PAS ********************************************************
 ****************************************************************************
}
</i></font><font color="#FF0000"><b>UNIT </b></font>VARS<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

TYPE
    </b></font><font color="#008000"><i>{You can always use these :)}
    </i></font>St20   <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
    </font>St40   <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">40</font><font color="#000080">];
    </font>St60   <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">60</font><font color="#000080">];
    </font>St80   <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];

    </font>tHeader <font color="#000080">= </font><font color="#FF0000"><b>Record
            </b></font>Identification<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];      </font><font color="#008000"><i>{The id string, See ID_Check}
            {CreatedOn/UpdatedOn are like this MM-DD-YYYYHH:MM}
            </i></font>CreatedOn     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">15</font><font color="#000080">];      </font><font color="#008000"><i>{creation date, shouldn't change}
            </i></font>UpdatedOn     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">15</font><font color="#000080">];      </font><font color="#008000"><i>{last modification date}
            </i></font>NumberOfFiles <font color="#000080">: </font>Byte<font color="#000080">;            </font><font color="#008000"><i>{number of files in this file}
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font>tFileHeader <font color="#000080">= </font><font color="#FF0000"><b>Record
                </b></font>Attribute <font color="#000080">: </font>Byte<font color="#000080">;            </font><font color="#008000"><i>{Attributes:  
                                              0 - None
                                              1 - Hidden (N/A)
                                              2 - System (N/A)
                                              3 - Read Only (N/A)
                                              4 - Archive (N/A)
                                              5 - Directory (N/A)
                                              6 - Label (N/A)
                                             }
                </i></font>Filename  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];      </font><font color="#008000"><i>{Filename as: FILENAME.EXT}
                </i></font>CompType  <font color="#000080">: </font>Byte<font color="#000080">;            </font><font color="#008000"><i>{compression type:
                                              0 - None/Store
                                              1 - LZH (N/A)
                                             }
                </i></font>EncrType  <font color="#000080">: </font>Byte<font color="#000080">;            </font><font color="#008000"><i>{encryption type:
                                              0 - None/Store
                                              1 - XOR (N/A)
                                              2 - RSA (N/A)
                                             }
                </i></font>RealSize  <font color="#000080">: </font>Longint<font color="#000080">;         </font><font color="#008000"><i>{actual size}
                </i></font>CompSize  <font color="#000080">: </font>Longint<font color="#000080">;         </font><font color="#008000"><i>{compressed size} {N/A}
                </i></font>Crc       <font color="#000080">: </font>Longint<font color="#000080">;         </font><font color="#008000"><i>{Circular Redundancy Check} {N/A}
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>Header      <font color="#000080">: </font>tHeader<font color="#000080">;               </font><font color="#008000"><i>{the MAIN header}
   </i></font>FileHeader  <font color="#000080">: </font>tFileHeader<font color="#000080">;           </font><font color="#008000"><i>{each file's header}

</i></font><font color="#FF0000"><b>CONST
     </b></font><font color="#008000"><i>{Please modify the ID_Check to a unique value used in your programs!
      I use the below one, as there's virtually no chance of anyone using the
      one below.  It just makes sure that incase a .DAT file loses the ID it
      can't be read!  Sometimes I lower the String[20] to String[2] and make
      it 'PK', &lt;grin&gt;}
     </i></font>Id_Check          <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">]  = </font><font color="#800000">#5#255'DATAIO File'</font><font color="#000080">;  </font><font color="#008000"><i>{for checking!}


</i></font><font color="#FF0000"><b>IMPLEMENTATION

BEGIN
END</b></font><font color="#000080">.

</font><font color="#008000"><i>{
 ****************************************************************************
 **** UNIT: FILEIO.PAS ******************************************************
 ****************************************************************************
}
</i></font><font color="#FF0000"><b>UNIT </b></font>FILEIO<font color="#000080">;


</font><font color="#FF0000"><b>INTERFACE

Uses </b></font>Vars<font color="#000080">,
     </font>Dos<font color="#000080">;

     </font><font color="#008000"><i>{This is from the Borland Pascal's HELP files.  I'm not sure if it's
     legel to post this one, but if it's not, people in SWAG, please
     replace FileExists function with anyone of the ones you guys have in
     FILES.SWG :)}
     </i></font><font color="#FF0000"><b>FUNCTION </b></font>FileExists<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
     </font><font color="#008000"><i>{Author is from SWAG archives' FILES.SWG, whoever you are, let me know
     and I will credit you}
     </i></font><font color="#FF0000"><b>FUNCTION </b></font>Compare_FileNames<font color="#000080">(</font>SearchStr<font color="#000080">,</font>NameStr<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>boolean<font color="#000080">;
     </font><font color="#008000"><i>{Author is from SWAG archives' FILES.SWG, whoever you are, let me know
     and I will credit you}
     </i></font><font color="#FF0000"><b>PROCEDURE </b></font>WipeFile<font color="#000080">(</font>fn<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);


</font><font color="#FF0000"><b>IMPLEMENTATION

FUNCTION </b></font>FileExists<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{
 *** Boolean function that returns True if the file exists;otherwise,
     it returns False. Closes the file if it exists.
 ***
}
         </i></font><font color="#FF0000"><b>Var
            </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Begin
              </b></font><font color="#008000"><i>{$I-}
              </i></font>Assign<font color="#000080">(</font>F<font color="#000080">, </font>FileName<font color="#000080">);
              </font>FileMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;  </font><font color="#008000"><i>{ Set file access to read only }
              </i></font>Reset<font color="#000080">(</font>F<font color="#000080">);
              </font>Close<font color="#000080">(</font>F<font color="#000080">);
              </font><font color="#008000"><i>{$I+}
              </i></font>FileExists <font color="#000080">:= (</font>IOResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FileName <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">);
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;  </font><font color="#008000"><i>{ FileExists }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Compare_FileNames<font color="#000080">(</font>SearchStr<font color="#000080">,</font>NameStr<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{
 Compare SearchStr with NameStr, and allow wildcards in SearchStr.
 The following wildcards are allowed:
 *ABC*        matches everything which contains ABC
 [A-C]*       matches everything that starts with either A,B or C
 [ADEF-JW-Z]  matches A,D,E,F,G,H,I,J,W,V,X,Y or Z
 ABC?         matches ABC, ABC1, ABC2, ABCA, ABCB etc.
 ABC[?]       matches ABC1, ABC2, ABCA, ABCB etc. (but not ABC)
 ABC*         matches everything starting with ABC
 (for using with DOS filenames like DOS (and 4DOS), you must split the
  filename in the extention and the filename, and compare them seperately)
}

</i></font><font color="#FF0000"><b>var
 </b></font>LastW<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">cld
 push ds
 lds si,SearchStr
 les di,NameStr
 xor ah,ah
 lodsb
 mov cx,ax
 mov al,es:[di]
 inc di
 mov bx,ax
 or cx,cx
 jnz @ChkChr
 or bx,bx
 jz @ChrAOk
 jmp @ChrNOk
 xor dh,dh
@ChkChr:
 lodsb
 cmp al,'*'
 jne @ChkQues
 dec cx
 jz @ChrAOk
 mov dh,1
 mov LastW,cx
 jmp @ChkChr
@ChkQues:
 cmp al,'?'
 jnz @NormChr
 inc di
 or bx,bx
 je @ChrOk
 dec bx
 jmp @ChrOk
@NormChr:
 or bx,bx
 je @ChrNOk
</font><font color="#008000"><i>{From here to @No4DosChr is used for [0-9]/[?]/[!0-9] 4DOS wildcards...}
 </i></font><font color="#FF00FF">cmp al,'['
 jne @No4DosChr
 cmp word ptr [si],']?'
 je @SkipRange
 mov ah,byte ptr es:[di]
 xor dl,dl
 cmp byte ptr [si],'!'
 jnz @ChkRange
 inc si
 dec cx
 jz @ChrNOk
 inc dx
@ChkRange:
 lodsb
 dec cx
 jz @ChrNOk
 cmp al,']'
 je @NChrNOk
 cmp ah,al
 je @NChrOk
 cmp byte ptr [si],'-'
 jne @ChkRange
 inc si
 dec cx
 jz @ChrNOk
 cmp ah,al
 jae @ChkR2
 inc si              </font><font color="#008000"><i>{Throw a-Z &lt; away}
 </i></font><font color="#FF00FF">dec cx
 jz @ChrNOk
 jmp @ChkRange
@ChkR2:
 lodsb
 dec cx
 jz @ChrNOk
 cmp ah,al
 ja @ChkRange        </font><font color="#008000"><i>{= jbe @NChrOk; jmp @ChkRange}
</i></font><font color="#FF00FF">@NChrOk:
 or dl,dl
 jnz @ChrNOk
 inc dx
@NChrNOk:
 or dl,dl
 jz @ChrNOk
@NNChrOk:
 cmp al,']'
 je @NNNChrOk
@SkipRange:
 lodsb
 cmp al,']'
 loopne @SkipRange
 jne @ChrNOk
@NNNChrOk:
 dec bx
 inc di
 jmp @ChrOk
@No4DosChr:
 cmp es:[di],al
 jne @ChrNOk
 inc di
 dec bx
@ChrOk:
 xor dh,dh
 dec cx
 jnz @ChkChr        </font><font color="#008000"><i>{ Can't use loop, distance &gt;128 bytes }
 </i></font><font color="#FF00FF">or bx,bx
 jnz @ChrNOk
@ChrAOk:
 mov al,1
 jmp @EndR
@ChrNOk:
 or dh,dh
 jz @IChrNOk
 jcxz @IChrNOk
 or bx,bx
 jz @IChrNOk
 inc di
 dec bx
 jz @IChrNOk
 mov ax,[LastW]
 sub ax,cx
 add cx,ax
 sub si,ax
 dec si
 jmp @ChkChr
@IChrNOk:
 mov al,0
@EndR:
 pop ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>WipeFile<font color="#000080">(</font>fn<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
          </font><font color="#FF0000"><b>Var
             </b></font>size<font color="#000080">,
             </font>total<font color="#000080">: </font>longint<font color="#000080">;
             </font>loop<font color="#000080">,
             </font>towrite<font color="#000080">,
             </font>numwritten<font color="#000080">: </font>word<font color="#000080">;
             </font>f<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
             </font>buffer<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1024</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;

          </font><font color="#FF0000"><b>begin
               </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>fn<font color="#000080">);
               </font>filemode <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
               </font>setfattr<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font>doserror <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
                  begin
                       </b></font>rename<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'~~~~~~~~.~~~'</font><font color="#000080">);
                       </font>rename<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'~'</font><font color="#000080">);
                       </font><font color="#FF0000"><b>for </b></font>loop <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>sizeof<font color="#000080">(</font>buffer<font color="#000080">) </font><font color="#FF0000"><b>do
                           </b></font>buffer<font color="#000080">[</font>loop<font color="#000080">] := </font>random<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">);

                       </font>reset<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                       </font>size <font color="#000080">:= </font>filesize<font color="#000080">(</font>f<font color="#000080">);
                       </font>total <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                       </font><font color="#FF0000"><b>repeat
                             </b></font><font color="#008000"><i>{Figure out how much to write }
                             </i></font>towrite <font color="#000080">:= </font>sizeof<font color="#000080">(</font>buffer<font color="#000080">);
                             </font><font color="#FF0000"><b>if </b></font>towrite<font color="#000080">+</font>total <font color="#000080">&gt; </font>size <font color="#FF0000"><b>then
                                </b></font>towrite <font color="#000080">:= </font>size <font color="#000080">- </font>total<font color="#000080">;

                             </font>blockwrite<font color="#000080">(</font>f<font color="#000080">,</font>buffer<font color="#000080">,</font>towrite<font color="#000080">,</font>numwritten<font color="#000080">);
                             </font>inc<font color="#000080">(</font>total<font color="#000080">,</font>numwritten<font color="#000080">);
                       </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>total <font color="#000080">= </font>size<font color="#000080">);

                       </font>Seek<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
                       </font>Truncate<font color="#000080">(</font>f<font color="#000080">);

                       </font>close<font color="#000080">(</font>f<font color="#000080">);
                       </font>erase<font color="#000080">(</font>f<font color="#000080">);
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.

</font><font color="#008000"><i>{
 ****************************************************************************
 **** UNIT: STRIO.PAS *******************************************************
 ****************************************************************************
}
{ *** Handles string in/output and various conversion routines
  ***
}

</i></font><font color="#FF0000"><b>Unit </b></font>StrIO<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

Uses </b></font>Vars<font color="#000080">;

     </font><font color="#008000"><i>{From SWAG's CRT, modified to allow for Barlength}
     </i></font><font color="#FF0000"><b>FUNCTION </b></font>StatusBar<font color="#000080">(</font>total<font color="#000080">, </font>amt<font color="#000080">, </font>barlength<font color="#000080">: </font>longint<font color="#000080">): </font>St80<font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>ITOA<font color="#000080">(</font>i<font color="#000080">: </font>longint<font color="#000080">): </font>St40<font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>ATOI<font color="#000080">(</font>s<font color="#000080">: </font>St40<font color="#000080">): </font>LongInt<font color="#000080">;
     </font><font color="#008000"><i>{From SWAG}
     </i></font><font color="#FF0000"><b>FUNCTION </b></font>UpCase<font color="#000080">(</font>c<font color="#000080">: </font>Char<font color="#000080">): </font>Char<font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>UCase<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>RepStr<font color="#000080">(</font>Times<font color="#000080">: </font>Byte<font color="#000080">; </font>Which<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Strip_Path<font color="#000080">(</font>Fullfilename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Leading_Zero<font color="#000080">(</font>Number<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Digits<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Read_Str<font color="#000080">(</font>StrLen     <font color="#000080">: </font>Byte<font color="#000080">;
                       </font>InputFg<font color="#000080">,
                       </font>InputBg    <font color="#000080">: </font>Integer<font color="#000080">;
                       </font>Hidden<font color="#000080">,
                       </font>Spaces     <font color="#000080">: </font>Char<font color="#000080">;
                       </font>SpinWanted<font color="#000080">,
                       </font>Display<font color="#000080">,
                       </font>Upper<font color="#000080">,
                       </font>OnlyNumbers<font color="#000080">,
                       </font>AutoReturn <font color="#000080">: </font>Boolean<font color="#000080">;
                       </font><font color="#FF0000"><b>Default    </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>PROCEDURE </b></font>Flush_Keyboard_Buffer<font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Right_Pad<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>MaxLength<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Right_Strip<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FUNCTION </b></font>Right_Justify<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>sl<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>CharStr<font color="#000080">(</font>HowMuch<font color="#000080">: </font>Byte<font color="#000080">; </font>WithWhatChar<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{
 *** fills charStr with withwhatchar to the howmuch
 ***
}
         </i></font><font color="#FF0000"><b>Var
            </b></font>j       <font color="#000080">: </font>Integer<font color="#000080">;
            </font>TempStr <font color="#000080">: </font>St80<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>TempStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>HowMuch <font color="#FF0000"><b>Do
                  </b></font>Insert<font color="#000080">(</font>WithWhatChar<font color="#000080">, </font>TempStr<font color="#000080">, </font>J<font color="#000080">);
              </font>CharStr <font color="#000080">:= </font>TempStr<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;




</font><font color="#FF0000"><b>FUNCTION </b></font>StatusBar<font color="#000080">(</font>total<font color="#000080">, </font>amt<font color="#000080">, </font>barlength<font color="#000080">: </font>longint<font color="#000080">): </font>St80<font color="#000080">;
</font><font color="#008000"><i>{         Const
              BarLength = 30;}

         </i></font><font color="#FF0000"><b>Var
            </b></font>a<font color="#000080">,
            </font>b<font color="#000080">,
            </font>c<font color="#000080">,
            </font>d       <font color="#000080">: </font>longint<font color="#000080">;
            </font>sD      <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{for conversion}
            </i></font>percent <font color="#000080">: </font>real<font color="#000080">;
            </font>st      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              If </b></font><font color="#000080">(</font>total <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>amt <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                 Begin
                      </b></font>StatusBar <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                      </font>Exit<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Amt <font color="#000080">&gt; </font>Total<font color="#000080">) </font><font color="#FF0000"><b>Then
                 </b></font>amt <font color="#000080">:= </font>total<font color="#000080">;
              </font>Percent <font color="#000080">:= </font>Amt <font color="#000080">/ </font>Total <font color="#000080">* (</font>Barlength <font color="#000080">* </font><font color="#800000">10</font><font color="#000080">);
              </font>a <font color="#000080">:= </font>trunc<font color="#000080">(</font>percent<font color="#000080">);
              </font>b <font color="#000080">:= </font>a <font color="#FF0000"><b>div </b></font><font color="#800000">10</font><font color="#000080">;
              </font>c <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
              </font>percent <font color="#000080">:= </font>amt <font color="#000080">/ </font>total <font color="#000080">* </font><font color="#800000">100</font><font color="#000080">;
              </font>d <font color="#000080">:= </font>trunc<font color="#000080">(</font>percent<font color="#000080">);
              </font>Str<font color="#000080">(</font>d<font color="#000080">, </font>sD<font color="#000080">);
              </font>st <font color="#000080">:= </font><font color="#800000">' (' </font><font color="#000080">+ </font>sD <font color="#000080">+ </font><font color="#800000">'%)'</font><font color="#000080">;
              </font>StatusBar <font color="#000080">:= </font>CharStr<font color="#000080">(</font>b <font color="#000080">* </font>c<font color="#000080">, </font><font color="#800000">#219</font><font color="#000080">) + </font>CharStr<font color="#000080">(</font>Barlength <font color="#000080">- (</font>b <font color="#000080">* </font>c<font color="#000080">), </font><font color="#800000">#176</font><font color="#000080">) + </font>st<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;




</font><font color="#FF0000"><b>FUNCTION </b></font>ITOA<font color="#000080">(</font>i<font color="#000080">: </font>longint<font color="#000080">): </font>St40<font color="#000080">;
</font><font color="#008000"><i>{
 *** Converts integers into alphanumericals or strings
 ***
}
         </i></font><font color="#FF0000"><b>Var
            </b></font>stTemp<font color="#000080">: </font>St20<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>Str<font color="#000080">(</font>i<font color="#000080">, </font>stTemp<font color="#000080">);
              </font>ITOA <font color="#000080">:= </font>stTemp<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>ATOI<font color="#000080">(</font>s<font color="#000080">: </font>St40<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#008000"><i>{
 *** Converts a string into a integer/real
 ***
}
         </i></font><font color="#FF0000"><b>Var
            </b></font>Code<font color="#000080">: </font>Integer<font color="#000080">;
            </font>lTemp<font color="#000080">: </font>LongInt<font color="#000080">;
            </font>rTemp<font color="#000080">: </font>Real<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>Val<font color="#000080">(</font>s<font color="#000080">, </font>rTemp<font color="#000080">, </font>Code<font color="#000080">);
              </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Code <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                 </b></font>rTemp <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>lTemp <font color="#000080">:= </font>Trunc<font color="#000080">(</font>rTemp<font color="#000080">);
              </font>ATOI <font color="#000080">:= </font>lTemp<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>UpCase<font color="#000080">(</font>C<font color="#000080">: </font>Char<font color="#000080">): </font>Char<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">; </font><font color="#008000"><i>{ will replace TP's built-in upcase }
         </i></font><font color="#FF0000"><b>ASM
            </b></font><font color="#FF00FF">MOV DL, C
            MOV AX, $6520
            INT $21
            MOV AL, DL           </font><font color="#008000"><i>{ function result in AL                 }
         </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>UCase<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{
 *** Converts any string(s) into upper case letters
 ***
}
         </i></font><font color="#FF0000"><b>Var
            </b></font>J <font color="#000080">: </font>Integer<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>Do
                  </b></font>s<font color="#000080">[</font>J<font color="#000080">] := </font>StrIo<font color="#000080">.</font>UpCase<font color="#000080">(</font>s<font color="#000080">[</font>J<font color="#000080">]);
              </font>UCase <font color="#000080">:= </font>S<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>RepStr<font color="#000080">(</font>Times<font color="#000080">: </font>Byte<font color="#000080">; </font>Which<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Var
            </b></font>J        <font color="#000080">: </font>Byte<font color="#000080">;
            </font>tString  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>tString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Times <font color="#FF0000"><b>Do
                  </b></font>tString <font color="#000080">:= </font>tString <font color="#000080">+ </font>Which<font color="#000080">;
              </font>RepStr <font color="#000080">:= </font>tString<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>Strip_Path<font color="#000080">(</font>Fullfilename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Var
            </b></font>tString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>tString <font color="#000080">:= </font>FullFilename<font color="#000080">;
              </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">, </font>tString<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Do
                    </b></font>Delete<font color="#000080">(</font>tString<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">, </font>tString<font color="#000080">));
              </font>Strip_Path <font color="#000080">:= </font>tString<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{
 Makes sure that NUMBER is DIGITS digits.  Ie if DIGITS = 10 and NUMBER = 29
 the result is 0000000029, 10 DIGITS :) Simple hugh?
}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Leading_Zero<font color="#000080">(</font>Number<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Digits<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Var
            </b></font>tString   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;             </font><font color="#008000"><i>{temporary zero holding spot}
            </i></font>NeedZeros <font color="#000080">: </font>Integer<font color="#000080">;            </font><font color="#008000"><i>{Number of zeros needed}
            </i></font>J         <font color="#000080">: </font>Byte<font color="#000080">;               </font><font color="#008000"><i>{for the FOR-LOOP}

         </i></font><font color="#FF0000"><b>Begin
              </b></font>tString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font>NeedZeros <font color="#000080">:= </font>Digits <font color="#000080">- </font>Length<font color="#000080">(</font>Number<font color="#000080">);
              </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>NeedZeros <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                 Begin
                      for </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>NeedZeros <font color="#FF0000"><b>Do
                          </b></font>tString <font color="#000080">:= </font>tString <font color="#000080">+ </font><font color="#800000">'0'</font><font color="#000080">;
                      </font>tString <font color="#000080">:= </font>tString <font color="#000080">+ </font>Number<font color="#000080">;
                 </font><font color="#FF0000"><b>End
              Else
                  </b></font>tString <font color="#000080">:= </font>Number<font color="#000080">;

              </font>Leading_Zero <font color="#000080">:= </font>tString<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>Read_Str<font color="#000080">(</font>StrLen     <font color="#000080">: </font>Byte<font color="#000080">;
                  </font>InputFg<font color="#000080">,
                  </font>InputBg    <font color="#000080">: </font>Integer<font color="#000080">;
                  </font>Hidden<font color="#000080">,
                  </font>Spaces     <font color="#000080">: </font>Char<font color="#000080">;
                  </font>SpinWanted<font color="#000080">,
                  </font>Display<font color="#000080">,
                  </font>Upper<font color="#000080">,
                  </font>OnlyNumbers<font color="#000080">,
                  </font>AutoReturn <font color="#000080">: </font>Boolean<font color="#000080">;
                  </font><font color="#FF0000"><b>Default    </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{
 *** Gets string from local/remote
     StrLen - String length
     InputFg - Foreground for input
     InputBg - Background for input
     Hidden - character to display instead of entered characters or #0
     Spaces - Character to display where nothing is written.
     Display - Display output
     Upper - force upper case
     OnlyNumbers - Characters between 0-9 are allowed, nothing else
     AutoReturn - Wheter to hig enter automatically after STRLENth character
     SpinWanted - Wheter or not to spin a character
     Default - Text displayed as if user/modem typed it in.
 ***
}
         </i></font><font color="#FF0000"><b>Var
            </b></font>ChIn    <font color="#000080">: </font>Char<font color="#000080">;         </font><font color="#008000"><i>{character read in}
            </i></font>StrCount<font color="#000080">: </font>Integer<font color="#000080">;      </font><font color="#008000"><i>{current location in string}
            </i></font>J       <font color="#000080">: </font>Integer<font color="#000080">;      </font><font color="#008000"><i>{used in For-loop combo}
            </i></font>TempStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;       </font><font color="#008000"><i>{temporary string}
            </i></font>OldX<font color="#000080">,
            </font>OldY<font color="#000080">,
            </font>OldFg<font color="#000080">,
            </font>OldBg    <font color="#000080">: </font>Word<font color="#000080">;         </font><font color="#008000"><i>{save coordinates}
            </i></font>SpinCount<font color="#000080">: </font>Byte<font color="#000080">;

         </font><font color="#FF0000"><b>Const
              </b></font>Spin   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char <font color="#000080">= (</font><font color="#800000">'|'</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font><font color="#800000">'\'</font><font color="#000080">);

         </font><font color="#FF0000"><b>Begin
              </b></font>TempStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font>ChIn <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
              </font>StrCount <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>SpinCount <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

              </font><font color="#FF0000"><b>if Default </b></font><font color="#000080">&lt;&gt; </font><font color="#800000">#0 </font><font color="#FF0000"><b>Then
                 Begin
                      </b></font>TempStr <font color="#000080">:= </font><font color="#FF0000"><b>Default</b></font><font color="#000080">;
                      </font>StrCount <font color="#000080">:= </font>Length<font color="#000080">(</font>TempStr<font color="#000080">);
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                Begin
                     </b></font>OldX <font color="#000080">:= </font>WhereX<font color="#000080">;
                     </font>OldY <font color="#000080">:= </font>WhereY<font color="#000080">;
                     </font>OldFg <font color="#000080">:= </font>TextAttr <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">;
                     </font>OldBg <font color="#000080">:= </font>TextAttr <font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">;
                     </font>TextColor<font color="#000080">(</font>InputFg<font color="#000080">);  </font>TextBackground<font color="#000080">(</font>InputBg<font color="#000080">);
                     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Spaces <font color="#000080">&lt; </font><font color="#800000">#32</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                        </b></font>Spaces <font color="#000080">:= </font><font color="#800000">#32</font><font color="#000080">;
                     </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>StrLen <font color="#FF0000"><b>Do
                         </b></font>Write<font color="#000080">(</font>Spaces<font color="#000080">);
                     </font>GotoXY<font color="#000080">(</font>OldX<font color="#000080">, </font>OldY<font color="#000080">);
                     </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font><font color="#FF0000"><b>Default </b></font><font color="#000080">&lt;&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                        Begin
                             For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font><font color="#FF0000"><b>Default</b></font><font color="#000080">) </font><font color="#FF0000"><b>Do
                                 If </b></font><font color="#000080">(</font>Hidden <font color="#000080">&lt;&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                                    </b></font>Write<font color="#000080">(</font>Hidden<font color="#000080">)
                                 </font><font color="#FF0000"><b>Else
                                     </b></font>Write<font color="#000080">(</font><font color="#FF0000"><b>Default</b></font><font color="#000080">[</font>J<font color="#000080">]);
                        </font><font color="#FF0000"><b>End
                End</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>Repeat
                    Repeat
                          If </b></font>SpinWanted <font color="#FF0000"><b>Then
                             Begin
                                  </b></font>Inc<font color="#000080">(</font>SpinCount<font color="#000080">);
                                  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>SpinCount <font color="#000080">&gt; </font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                                     </b></font>SpinCount <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                                  </font>Write<font color="#000080">(</font>Spin<font color="#000080">[</font>SpinCount<font color="#000080">]);
                                  </font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                                  </font>Delay<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">);
                                  </font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
                                  </font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                    </font><font color="#FF0000"><b>Until </b></font>Keypressed<font color="#000080">;
                    </font>ChIn <font color="#000080">:= </font>Readkey<font color="#000080">;

                    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>ChIn <font color="#000080">= </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                       </b></font>Exit<font color="#000080">;

                    </font><font color="#FF0000"><b>If </b></font>Upper <font color="#FF0000"><b>then
                       </b></font>ChIn <font color="#000080">:= </font>Upcase<font color="#000080">(</font>ChIn<font color="#000080">);

                    </font><font color="#FF0000"><b>Case </b></font>UpCase<font color="#000080">(</font>ChIn<font color="#000080">) </font><font color="#FF0000"><b>Of
                        </b></font><font color="#800000">#19</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{left arrow}
                                   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>StrCount <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                                      Begin
                                           </b></font>Dec<font color="#000080">(</font>StrCount<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                                           </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                                              </b></font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                         </font><font color="#800000">#4</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{right arrow}
                                   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>StrCount <font color="#000080">&lt; </font>StrLen<font color="#000080">) </font><font color="#FF0000"><b>Then
                                      Begin
                                           </b></font>Inc<font color="#000080">(</font>StrCount<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                                           </font>Insert<font color="#000080">(</font><font color="#800000">#32</font><font color="#000080">, </font>TempStr<font color="#000080">, </font>StrCount<font color="#000080">);
                                           </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                                              </b></font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                         </font><font color="#800000">#8</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                                  If </b></font><font color="#000080">(</font>StrCount <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                                     Begin
                                          </b></font>Dec<font color="#000080">(</font>StrCount<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
                                          </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                                            Begin
                                                 </b></font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                                                 </font>Write<font color="#000080">(</font>Spaces<font color="#000080">);
                                                 </font>GotoXY<font color="#000080">(</font>WhereX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
                                            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                          </font>Delete<font color="#000080">(</font>TempStr<font color="#000080">, </font>Length<font color="#000080">(</font>TempStr<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
                                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                  </font>ChIn <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                         </font><font color="#800000">#13</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                                   If </b></font>Display <font color="#FF0000"><b>Then
                                      </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>WhereY <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
                              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                       </font><font color="#800000">#32</font><font color="#000080">..</font><font color="#800000">#255</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                                       If </b></font><font color="#000080">(</font>StrCount <font color="#000080">&lt; </font>StrLen<font color="#000080">) </font><font color="#FF0000"><b>Then
                                          Begin
                                               If </b></font>OnlyNumbers <font color="#FF0000"><b>Then
                                                  Begin
                                                       Case </b></font>ChIn <font color="#FF0000"><b>Of
                                                       </b></font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">, </font><font color="#800000">'.'</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                                                                           </b></font>Inc<font color="#000080">(</font>StrCount<font color="#000080">);
                                                                           </font>Insert<font color="#000080">(</font>ChIn<font color="#000080">, </font>TempStr<font color="#000080">, </font>StrCount<font color="#000080">);
                                                                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                                       </font><font color="#FF0000"><b>Else </b></font><font color="#008000"><i>{anything except numbers}
                                                           </i></font>ChIn <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
                                                       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                                  </font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{if onlynumbers then}
                                               </i></font><font color="#FF0000"><b>Else
                                                   Begin
                                                       </b></font>Inc<font color="#000080">(</font>StrCount<font color="#000080">);
                                                       </font>Insert<font color="#000080">(</font>ChIn<font color="#000080">, </font>TempStr<font color="#000080">, </font>StrCount<font color="#000080">);
                                                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                          </font><font color="#FF0000"><b>End
                                       Else
                                           </b></font>ChIn <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
                                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>Else
                            </b></font>ChIn <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
                         </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{case}

                         </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>StrCount <font color="#000080">= </font>StrLen<font color="#000080">) </font><font color="#FF0000"><b>Then
                            Begin
                                 If </b></font>AutoReturn <font color="#FF0000"><b>Then
                                    Begin
                                         </b></font>ChIn <font color="#000080">:= </font><font color="#800000">#13</font><font color="#000080">;
                                         </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>WhereY <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
                                    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                         </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>ChIn <font color="#000080">&lt;&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                            if </b></font><font color="#000080">(</font>Hidden <font color="#000080">&gt; </font><font color="#800000">#32</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font><font color="#008000"><i>{space or no pw}
                               </i></font>Write<font color="#000080">(</font>Hidden<font color="#000080">)
                            </font><font color="#FF0000"><b>Else
                                </b></font>Write<font color="#000080">(</font>ChIn<font color="#000080">);
              </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>ChIn <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>ChIn <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">);

              </font><font color="#FF0000"><b>If </b></font>Display <font color="#FF0000"><b>Then
                 Begin
                      </b></font>TextColor<font color="#000080">(</font>OldFg<font color="#000080">);
                      </font>TextBackground<font color="#000080">(</font>OldBg<font color="#000080">);
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font>Read_Str <font color="#000080">:= </font>TempStr<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#FF0000"><b>PROCEDURE </b></font>Flush_Keyboard_Buffer<font color="#000080">;
          </font><font color="#FF0000"><b>Var
             </b></font>ChIn        <font color="#000080">: </font>Char<font color="#000080">;        </font><font color="#008000"><i>{for clearing the keyboard buffer}

          </i></font><font color="#FF0000"><b>Begin
               While </b></font>Keypressed <font color="#FF0000"><b>Do
                     </b></font>ChIn <font color="#000080">:= </font>ReadKey<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>Right_Pad<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>MaxLength<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Const
              </b></font>tString <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;
              </font>HowMany <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
              </font>J       <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>J <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>HowMany <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>tString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

              </font><font color="#008000"><i>{check for greater then number strings}
              </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>s<font color="#000080">) &gt; </font>MaxLength<font color="#000080">) </font><font color="#FF0000"><b>Then
                 Begin
                      </b></font>tString <font color="#000080">:= </font>Copy<font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>MaxLength<font color="#000080">);
                      </font>Exit<font color="#000080">;
                 </font><font color="#FF0000"><b>End
              Else
                  Begin
                       </b></font>HowMany <font color="#000080">:= (</font>MaxLength <font color="#000080">- </font>Length<font color="#000080">(</font>s<font color="#000080">));
                       </font><font color="#FF0000"><b>Repeat
                             </b></font>Inc<font color="#000080">(</font>J<font color="#000080">);
                             </font>tString <font color="#000080">:= </font>tString <font color="#000080">+ </font><font color="#800000">#32</font><font color="#000080">;
                       </font><font color="#FF0000"><b>Until </b></font>J <font color="#000080">&gt;= </font>HowMany<font color="#000080">;
                       </font>tString <font color="#000080">:= </font>s <font color="#000080">+ </font>tString<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font>Right_Pad <font color="#000080">:= </font>tString<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Right_Strip<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Var
            </b></font>StrLen<font color="#000080">,
            </font>Count        <font color="#000080">: </font>Byte<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>StrLen <font color="#000080">:= </font>Length<font color="#000080">(</font>s<font color="#000080">);
              </font>Count  <font color="#000080">:= </font>StrLen <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
              </font><font color="#FF0000"><b>Repeat
                    </b></font>Dec<font color="#000080">(</font>Count<font color="#000080">);
              </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>s<font color="#000080">[</font>Count<font color="#000080">] &lt;&gt; </font><font color="#800000">#32</font><font color="#000080">);
              </font>Delete<font color="#000080">(</font>s<font color="#000080">, </font>Count <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>StrLen <font color="#000080">- </font>Count<font color="#000080">);
              </font>Right_Strip <font color="#000080">:= </font>S<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Right_Justify<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>sl<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Var
            </b></font>tString2<font color="#000080">,
            </font>tString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
            </font>Where<font color="#000080">,
            </font>HowMuch<font color="#000080">: </font>Byte<font color="#000080">;

         </font><font color="#FF0000"><b>Begin
              </b></font>tString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font>tString2 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font>tString <font color="#000080">:= </font>s<font color="#000080">;
              </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>tString<font color="#000080">) &gt; </font>Sl <font color="#FF0000"><b>Then
                 Begin
                      </b></font>tString2 <font color="#000080">:= </font>Copy<font color="#000080">(</font>tString<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Sl<font color="#000080">);
                      </font>Right_Justify <font color="#000080">:= </font>tString2<font color="#000080">;
                      </font>Exit<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

              </font>Where <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
              </font>Where <font color="#000080">:= </font>sl <font color="#000080">- </font>Length<font color="#000080">(</font>tString<font color="#000080">);

              </font>FillChar<font color="#000080">(</font>tString2<font color="#000080">, </font>Where<font color="#000080">, </font><font color="#800000">#32</font><font color="#000080">);
              </font>Insert<font color="#000080">(</font>tString<font color="#000080">, </font>tString2<font color="#000080">, </font>Where<font color="#000080">);
              </font>Delete<font color="#000080">(</font>tString2<font color="#000080">, </font>Where <font color="#000080">+ </font>Length<font color="#000080">(</font>tString<font color="#000080">), </font>Length<font color="#000080">(</font>tString2<font color="#000080">) - (</font>Where <font color="#000080">+ </font>Length<font color="#000080">(</font>tString<font color="#000080">)) + </font><font color="#800000">1</font><font color="#000080">);
              </font>Right_Justify <font color="#000080">:= </font>tString2<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;




</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.

</font><font color="#008000"><i>{
PLEASE!  Anybody who can optimize this so it doesn't require as much
stack/heap space as it does now, I'd really appreciate it.  Also, if you
find a way to replace ANYTHING in here with ASM (or in any of the sub-units)
PLEASE MAIL ME THE MODIFICATIONS!  Mail to miki.landekic@canrem.com or leave
mail in the pascal echo you saw this in to Miki Landekic.  Thanks in advance

(written by Bojan Landekic)
}

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0072.PAS">Original</a><b>]</b></p></body>
</html>
