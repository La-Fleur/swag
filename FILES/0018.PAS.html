<html>
<head><title> "Find Data at end of EXE" by ROB PERELMAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">===========================================================================
 </font>BBS<font color="#000080">: </font>Canada Remote Systems
Date<font color="#000080">: </font><font color="#800000">06</font><font color="#000080">-</font><font color="#800000">24</font><font color="#000080">-</font><font color="#800000">93 </font><font color="#000080">(</font><font color="#800000">15</font><font color="#000080">:</font><font color="#800000">37</font><font color="#000080">)             </font>Number<font color="#000080">: </font><font color="#800000">27580
</font>From<font color="#000080">: </font>ROB PERELMAN                 Refer<font color="#800000">#</font><font color="#000080">: </font>NONE
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>ALL                           Recvd<font color="#000080">: </font>NO  
Subj<font color="#000080">: </font><font color="#FF0000"><b>End of </b></font>EXE                     Conf<font color="#000080">: (</font><font color="#800000">1221</font><font color="#000080">) </font>F<font color="#000080">-</font><font color="#FF0000"><b>PASCAL
</b></font><font color="#000080">---------------------------------------------------------------------------
</font>This <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>unit </b></font>I wrote but it crashed a few times <font color="#FF0000"><b>on </b></font>me<font color="#000080">, </font>so here <font color="#FF0000"><b>is </b></font>an
updated <font color="#FF0000"><b>unit for </b></font>anyone<font color="#800000">'s use.  Remember not to use it from the TP
</font>editor because <font color="#FF0000"><b>if </b></font>you compile <font color="#FF0000"><b>to </b></font>memory<font color="#000080">, </font>PARAMSTR<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>is </b></font>the editor<font color="#000080">, </font><font color="#FF0000"><b>and
if </b></font>you compile <font color="#FF0000"><b>to </b></font>disk<font color="#000080">, </font>you will <font color="#FF0000"><b>not </b></font>have any data<font color="#000080">.

</font><font color="#FF0000"><b>Unit </b></font>ExeEnd<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Var </b></font>EndOfExe<font color="#000080">: </font>LongInt<font color="#000080">; </font><font color="#008000"><i>{Shows the end of the EXE file}
    </i></font>ExeFile<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">; </font><font color="#008000"><i>{The EXE file positioned at the end}
    </i></font>Data<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#008000"><i>{If there is data after the EXE}

</i></font><font color="#FF0000"><b>Implementation

Type </b></font>EXEHeader<font color="#000080">=</font><font color="#FF0000"><b>Record
      </b></font>ID<font color="#000080">: </font>Word<font color="#000080">;                  </font><font color="#008000"><i>{ EXE file id }
      </i></font>ByteMod<font color="#000080">: </font>Word<font color="#000080">;             </font><font color="#008000"><i>{ Load module image size mod 512 }
      </i></font>Pages<font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{ File size (including header) div 512 }
      </i></font>RelocItems<font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>{ Number of relocation table items }
      </i></font>Size<font color="#000080">: </font>word<font color="#000080">;                </font><font color="#008000"><i>{ Header size in 16-byte paragraphs }
      </i></font>MinParagraphs<font color="#000080">: </font>Word<font color="#000080">;       </font><font color="#008000"><i>{ Minimum number of paragraphs above program }
      </i></font>MaxParagraphs<font color="#000080">: </font>Word<font color="#000080">;       </font><font color="#008000"><i>{ Maximum number of paragraphs above program }
      </i></font>StackSeg<font color="#000080">: </font>Word<font color="#000080">;            </font><font color="#008000"><i>{ Displacement of stack segment }
      </i></font>SPReg<font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{ Initial SP register value }
      </i></font>CheckSum<font color="#000080">: </font>Integer<font color="#000080">;         </font><font color="#008000"><i>{ Word checksum - negative sum (not used) }
      </i></font>IPReg<font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{ Initial IP register value }
      </i></font>CodeSeg<font color="#000080">: </font>Word<font color="#000080">;             </font><font color="#008000"><i>{ Displacement of code segment }
      </i></font>FirstReloc<font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>{ First relocation item }
      </i></font>OvlN<font color="#000080">: </font>Word                 <font color="#008000"><i>{ Overlay number }
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>CorrectExe<font color="#000080">=</font><font color="#800000">$5A4D</font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>Exe<font color="#000080">: </font>EXEHeader<font color="#000080">;
    </font>ReadIn<font color="#000080">: </font>Integer<font color="#000080">;
    </font>OldExitProc<font color="#000080">: </font>Pointer<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CloseExe<font color="#000080">; </font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>ExitProc<font color="#000080">:=</font>OldExitProc<font color="#000080">;
  </font>Close<font color="#000080">(</font>ExeFile<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>OldExitProc<font color="#000080">:=</font>ExitProc<font color="#000080">;
  </font>ExitProc<font color="#000080">:=@</font>CloseExe<font color="#000080">;
  </font>Assign<font color="#000080">(</font>ExeFile<font color="#000080">, </font>ParamStr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">));
  </font>Reset<font color="#000080">(</font>ExeFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font>BlockRead<font color="#000080">(</font>ExeFile<font color="#000080">, </font>Exe<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Exe<font color="#000080">), </font>ReadIn<font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>Exe <font color="#FF0000"><b>do If </b></font><font color="#000080">(</font>ReadIn<font color="#000080">&lt;&gt;</font>SizeOf<font color="#000080">(</font>Exe<font color="#000080">)) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ID<font color="#000080">&lt;&gt;</font>CorrectExe<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>EndOfExe<font color="#000080">:=</font><font color="#800000">0
    </font><font color="#FF0000"><b>Else </b></font>EndOfExe<font color="#000080">:=</font>Pages<font color="#000080">*</font><font color="#800000">512</font><font color="#000080">+</font>ByteMod<font color="#000080">-</font><font color="#800000">512</font><font color="#000080">;
  </font>Seek<font color="#000080">(</font>ExeFile<font color="#000080">, </font>EndOfExe<font color="#000080">);
  </font>Data<font color="#000080">:=</font><font color="#FF0000"><b>Not </b></font>EOF<font color="#000080">(</font>ExeFile<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

 * </font>QMPro <font color="#800000">1.50 4 </font><font color="#000080">* &quot;</font>Call waiting<font color="#000080">&quot;, </font>great <font color="#FF0000"><b>if </b></font>you have two friends


<font color="#000080">--- </font>WM v3<font color="#000080">.</font><font color="#800000">00</font><font color="#000080">/</font><font color="#800000">92</font><font color="#000080">-</font><font color="#800000">0215
 </font><font color="#000080">* </font>Origin<font color="#000080">: </font>High Country East<font color="#000080">, </font>Ramona<font color="#000080">, </font>CA <font color="#000080">(</font><font color="#800000">619</font><font color="#000080">)-</font><font color="#800000">789</font><font color="#000080">-</font><font color="#800000">4391  </font><font color="#000080">(</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">202</font><font color="#000080">/</font><font color="#800000">1308.0</font><font color="#000080">)
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p></body>
</html>
