<html>
<head><title> "Collection of handy DOS utilities" by KITO MANN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0108.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$A+,B-,D+,E-,F+,I-,L+,N-,O+,R-,S+,V-}

</i></font><font color="#FF0000"><b>Unit </b></font>CWare<font color="#000080">;

</font><font color="#008000"><i>(* Version 1.1 - CollisionWare Premium SoftWare - Compiled by Kito Mann *)
(* This unit is a simple collection of some some procedures aquired     *)
(* from other programs and myself. New versions will have added         *)
(* procedures, and the present ones will be improved. Comments, bugs,   *)
(* and questions accepted.                                              *)
(* Keep in mind that there is NO WARANTY! It IS NOT GAURANTEED that all *)
(* these procedures will work!                                          *)
(* If you modify the procedures included, or add your own, I request    *)
(* that you send me a copy of the new unit and source code.             *)

(* It'd probably be helpful if you declare ErrorCode: byte in your main *)
(* program. It is used as an Error variable much like the DosError used *)
(* in the DOS unit.                                                     *)

(* The Collision Theory pm-BBS *)
(*         24 hours            *)
(*      (703)503-9441          * &lt;--- NUMBER AND HOUR CHANGE! *)
(*         Burke, VA           *)
(* &quot;Dedicated to Intelligent   *)
(*        Conversation&quot;        *)

</i></font><font color="#FF0000"><b>INTERFACE

Uses </b></font>Crt<font color="#000080">,
     </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>MaxDirEnteries<font color="#000080">=       </font><font color="#800000">20</font><font color="#000080">;    </font><font color="#008000"><i>{ Maximum number of directories that can be specified to search }
                               { This doesn't include those searched &quot;below&quot; ones specified.   }

</i></font><font color="#FF0000"><b>type
  </b></font>FullNameStr<font color="#000080">=          </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];                 </font><font color="#008000"><i>{ Type for storing name+dot+extention                                 }
  </i></font>DirSearchEntry<font color="#000080">=       </font><font color="#FF0000"><b>record                      </b></font><font color="#008000"><i>{ This data type is used to store all the paths that will be searched }
                          </i></font>Dir<font color="#000080">:         </font>DirStr<font color="#000080">;      </font><font color="#008000"><i>{   &lt;-- Path to search                                                }
                          </i></font>Name<font color="#000080">:        </font>FullNameStr<font color="#000080">; </font><font color="#008000"><i>{   &lt;-- File spec to search                                           }
                          </i></font>Below<font color="#000080">:       </font>boolean<font color="#000080">;     </font><font color="#008000"><i>{   &lt;-- TRUE=search directories below the specified one               }
                        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ProcType<font color="#000080">=             </font><font color="#FF0000"><b>procedure</b></font><font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>SearchRec<font color="#000080">; </font>P<font color="#000080">: </font>PathStr<font color="#000080">);
  </font>AnyStr<font color="#000080">=               </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">255</font><font color="#000080">];


</font><font color="#FF0000"><b>var
  </b></font>EngineMask<font color="#000080">:           </font>FullNameStr<font color="#000080">;
  </font>EngineAttr<font color="#000080">:           </font>byte<font color="#000080">;
  </font>EngineProc<font color="#000080">:           </font>ProcType<font color="#000080">;
  </font>EngineCode<font color="#000080">:           </font>byte<font color="#000080">;

  </font>Reg<font color="#000080">:                  </font>Registers<font color="#000080">;   </font><font color="#008000"><i>{ Register storage for DOS calls }
  </i></font>OldSeg<font color="#000080">,</font>OldOfs<font color="#000080">:        </font>word<font color="#000080">;
  </font>BufData<font color="#000080">:              </font>longint<font color="#000080">;
  </font>BufferSeg<font color="#000080">:            </font>word<font color="#000080">;
  </font>BufferOfs<font color="#000080">:            </font>word<font color="#000080">;
  </font>BufferLen<font color="#000080">:            </font>word<font color="#000080">;
  </font>BufferPtr<font color="#000080">:            </font>pointer<font color="#000080">;
  </font>T<font color="#000080">:                    </font>text<font color="#000080">;
  </font>P<font color="#000080">:                    </font>PathStr<font color="#000080">;


</font><font color="#008000"><i>(* File and Keyboard Buffer procedures *)

</i></font><font color="#FF0000"><b>function </b></font>FileFound<font color="#000080">(</font>F<font color="#000080">: </font>ComStr<font color="#000080">): </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SearchEngine<font color="#000080">(</font>Mask<font color="#000080">: </font>PathStr<font color="#000080">; </font>Attr<font color="#000080">: </font>byte<font color="#000080">; </font>Proc<font color="#000080">: </font>ProcType<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>ErrorCode<font color="#000080">: </font>byte<font color="#000080">);

</font><font color="#FF0000"><b>function </b></font>GoodDirectory<font color="#000080">(</font>S<font color="#000080">: </font>SearchRec<font color="#000080">): </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SearchOneDir<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>SearchRec<font color="#000080">; </font>P<font color="#000080">: </font>PathStr<font color="#000080">);

</font><font color="#FF0000"><b>procedure </b></font>SearchEngineAll<font color="#000080">(</font>Path<font color="#000080">: </font>PathStr<font color="#000080">; </font>Mask<font color="#000080">: </font>FullNameStr<font color="#000080">; </font>Attr<font color="#000080">: </font>byte<font color="#000080">;
                          </font>Proc<font color="#000080">: </font>ProcType<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>ErrorCode<font color="#000080">: </font>byte<font color="#000080">);

</font><font color="#FF0000"><b>procedure </b></font>IPP<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>NewExitProc2<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ResetBuffer<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>BufSize<font color="#000080">: </font>word<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>InBuffer<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>InstallInterruptHandler<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DeleteFiles<font color="#000080">(</font>P<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>procedure </b></font>DeleteDir<font color="#000080">(</font>P<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>procedure </b></font>ListFiles<font color="#000080">(</font>P<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>complete<font color="#000080">:</font>boolean<font color="#000080">; </font>pausenum<font color="#000080">:</font>integer<font color="#000080">);

</font><font color="#008000"><i>(* Misc. String procedures *)

</i></font><font color="#FF0000"><b>function </b></font>DateString<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TimeString<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Tab<font color="#000080">(</font>s1<font color="#000080">,</font>s2<font color="#000080">:</font>AnyStr<font color="#000080">; </font>i<font color="#000080">:</font>integer<font color="#000080">);

</font><font color="#FF0000"><b>Function </b></font>UpCaseString<font color="#000080">(</font>StrIn <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Convert a string to upper case }

</i></font><font color="#FF0000"><b>Function </b></font>PathOnly<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Strip any filename information from a file specification }

</i></font><font color="#FF0000"><b>Function </b></font>NameOnly<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Strip any path information from a file specification }

</i></font><font color="#FF0000"><b>Function </b></font>BaseNameOnly<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Strip any path and extension information from a file specification }

</i></font><font color="#FF0000"><b>Function </b></font>ExtOnly<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Return only the extension portion of a filename }

</i></font><font color="#FF0000"><b>Function </b></font>IntStr<font color="#000080">(</font>Int <font color="#000080">: </font>LongInt<font color="#000080">; </font>Form <font color="#000080">: </font>Integer<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Convert an Integer variable to a string }

</i></font><font color="#FF0000"><b>Function </b></font>Strr<font color="#000080">(</font>Int<font color="#000080">:</font>LongInt<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Same as IntStr but does not use the variable &quot;Form&quot; }

</i></font><font color="#FF0000"><b>Function </b></font>SameFile<font color="#000080">(</font>File1<font color="#000080">, </font>File2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Call to find out if File1 has a name equivalent to File2.  Both filespecs }
{ may contain wildcards.                                                    }


</i></font><font color="#FF0000"><b>IMPLEMENTATION

</b></font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>function </b></font>FileFound<font color="#000080">(</font>F<font color="#000080">: </font>ComStr<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{
  This returns TRUE if the file F exists, FALSE otherwise.  F can contain
  wildcard characters.
}
</i></font><font color="#FF0000"><b>var
  </b></font>SRec<font color="#000080">:                 </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SRec<font color="#000080">.</font>Name <font color="#000080">:= </font><font color="#800000">'*'</font><font color="#000080">;
  </font>FindFirst<font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>SRec<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>SRec<font color="#000080">.</font>Name<font color="#000080">=</font><font color="#800000">'*' </font><font color="#FF0000"><b>then </b></font>FileFound <font color="#000080">:= </font>false <font color="#FF0000"><b>else </b></font>FileFound <font color="#000080">:= </font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>(********* The following search engine routines are sneakly swiped *********)
(********* from Turbo Technix v1n6.  See there for further details *********)

</i></font><font color="#FF0000"><b>procedure </b></font>SearchEngine<font color="#000080">(</font>Mask<font color="#000080">: </font>PathStr<font color="#000080">; </font>Attr<font color="#000080">: </font>byte<font color="#000080">; </font>Proc<font color="#000080">: </font>ProcType<font color="#000080">;
                       </font><font color="#FF0000"><b>var </b></font>ErrorCode<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>S<font color="#000080">:                    </font>SearchRec<font color="#000080">;
  </font>P<font color="#000080">:                    </font>PathStr<font color="#000080">;
  </font>Ext<font color="#000080">:                  </font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FSplit<font color="#000080">(</font>Mask<font color="#000080">, </font>P<font color="#000080">, </font>Mask<font color="#000080">, </font>Ext<font color="#000080">);
  </font>Mask <font color="#000080">:= </font>Mask<font color="#000080">+</font>Ext<font color="#000080">;
  </font>FindFirst<font color="#000080">(</font>P<font color="#000080">+</font>Mask<font color="#000080">,</font>Attr<font color="#000080">,</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>DosError<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>ErrorCode <font color="#000080">:= </font>DosError<font color="#000080">;
    </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>Proc<font color="#000080">(</font>S<font color="#000080">, </font>P<font color="#000080">);
    </font>FindNext<font color="#000080">(</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>DosError<font color="#000080">=</font><font color="#800000">18 </font><font color="#FF0000"><b>then </b></font>ErrorCode <font color="#000080">:= </font><font color="#800000">0
  </font><font color="#FF0000"><b>else </b></font>ErrorCode <font color="#000080">:= </font>DosError<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>function </b></font>GoodDirectory<font color="#000080">(</font>S<font color="#000080">: </font>SearchRec<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GoodDirectory <font color="#000080">:= (</font>S<font color="#000080">.</font>name<font color="#000080">&lt;&gt;</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>S<font color="#000080">.</font>Name<font color="#000080">&lt;&gt;</font><font color="#800000">'..'</font><font color="#000080">) </font><font color="#FF0000"><b>and
  </b></font><font color="#000080">(</font>S<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font>Directory<font color="#000080">=</font>Directory<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>procedure </b></font>SearchOneDir<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>SearchRec<font color="#000080">; </font>P<font color="#000080">: </font>PathStr<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>GoodDirectory<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>P <font color="#000080">:= </font>P<font color="#000080">+</font>S<font color="#000080">.</font>Name<font color="#000080">;
    </font>SearchEngine<font color="#000080">(</font>P<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>EngineMask<font color="#000080">,</font>EngineAttr<font color="#000080">,</font>EngineProc<font color="#000080">,</font>EngineCode<font color="#000080">);
    </font>SearchEngine<font color="#000080">(</font>P<font color="#000080">+</font><font color="#800000">'\*.*'</font><font color="#000080">,</font>Directory <font color="#FF0000"><b>or </b></font>Archive<font color="#000080">, </font>SearchOneDir<font color="#000080">,</font>EngineCode<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>procedure </b></font>SearchEngineAll<font color="#000080">(</font>Path<font color="#000080">: </font>PathStr<font color="#000080">; </font>Mask<font color="#000080">: </font>FullNameStr<font color="#000080">; </font>Attr<font color="#000080">: </font>byte<font color="#000080">;
                          </font>Proc<font color="#000080">: </font>ProcType<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>ErrorCode<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>EngineMask <font color="#000080">:= </font>Mask<font color="#000080">;
  </font>EngineProc <font color="#000080">:= </font>Proc<font color="#000080">;
  </font>EngineAttr <font color="#000080">:= </font>Attr<font color="#000080">;
  </font>SearchEngine<font color="#000080">(</font>Path<font color="#000080">+</font>Mask<font color="#000080">,</font>Attr<font color="#000080">,</font>Proc<font color="#000080">,</font>ErrorCode<font color="#000080">);
  </font>SearchEngine<font color="#000080">(</font>Path<font color="#000080">+</font><font color="#800000">'*.*'</font><font color="#000080">,</font>Directory <font color="#FF0000"><b>or </b></font>Archive<font color="#000080">,</font>SearchOneDir<font color="#000080">,</font>ErrorCode<font color="#000080">);
  </font>ErrorCode <font color="#000080">:= </font>EngineCode<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(************** Thus ends the sneakly swiped code *************)

{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>procedure </b></font>IPP<font color="#000080">;
</font><font color="#008000"><i>{ Interrupt pre-processor.  This is a new handler for interrupt 29h which
  provides special functions.  See comments in IHAND.ASM}
</i></font><font color="#FF0000"><b>begin
  InLine</b></font><font color="#000080">(
      </font><font color="#800000">$06</font><font color="#000080">/                   </font><font color="#008000"><i>{          push    es                      }
      </i></font><font color="#800000">$1E</font><font color="#000080">/                   </font><font color="#008000"><i>{          push    ds                      }
      </i></font><font color="#800000">$53</font><font color="#000080">/                   </font><font color="#008000"><i>{          push    bx                      }
      </i></font><font color="#800000">$57</font><font color="#000080">/                   </font><font color="#008000"><i>{          push    di                      }
      </i></font><font color="#800000">$BB</font><font color="#000080">/</font><font color="#800000">$3F</font><font color="#000080">/</font><font color="#800000">$3F</font><font color="#000080">/           </font><font color="#008000"><i>{          mov     bx, 3f3fh               }
      </i></font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$C3</font><font color="#000080">/               </font><font color="#008000"><i>{          mov     es, bx                  }
      </i></font><font color="#800000">$BB</font><font color="#000080">/</font><font color="#800000">$3F</font><font color="#000080">/</font><font color="#800000">$3F</font><font color="#000080">/           </font><font color="#008000"><i>{          mov     bx, 3f3fh               }
      </i></font><font color="#800000">$26</font><font color="#000080">/</font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$3F</font><font color="#000080">/           </font><font color="#008000"><i>{          mov     di, word ptr [es:bx]    }
      </i></font><font color="#800000">$26</font><font color="#000080">/</font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$5F</font><font color="#000080">/</font><font color="#800000">$02</font><font color="#000080">/       </font><font color="#008000"><i>{          mov     ds, word ptr [es:bx+2]  }
      </i></font><font color="#800000">$88</font><font color="#000080">/</font><font color="#800000">$05</font><font color="#000080">/               </font><font color="#008000"><i>{          mov     byte ptr [di], al       }
      </i></font><font color="#800000">$26</font><font color="#000080">/</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$07</font><font color="#000080">/           </font><font color="#008000"><i>{          inc     word ptr [es:bx]        }
      </i></font><font color="#800000">$5F</font><font color="#000080">/                   </font><font color="#008000"><i>{          pop     di                      }
      </i></font><font color="#800000">$5B</font><font color="#000080">/                   </font><font color="#008000"><i>{          pop     bx                      }
      </i></font><font color="#800000">$1F</font><font color="#000080">/                   </font><font color="#008000"><i>{          pop     ds                      }
      </i></font><font color="#800000">$07</font><font color="#000080">/                   </font><font color="#008000"><i>{          pop     es                      }
      </i></font><font color="#800000">$3C</font><font color="#000080">/</font><font color="#800000">$0A</font><font color="#000080">/               </font><font color="#008000"><i>{          cmp     al, 10                  }
      </i></font><font color="#800000">$75</font><font color="#000080">/</font><font color="#800000">$28</font><font color="#000080">/               </font><font color="#008000"><i>{          jne     looper                  }
      </i></font><font color="#800000">$50</font><font color="#000080">/                   </font><font color="#008000"><i>{          push    ax                      }
      </i></font><font color="#800000">$52</font><font color="#000080">/                   </font><font color="#008000"><i>{          push    dx                      }
      </i></font><font color="#800000">$51</font><font color="#000080">/                   </font><font color="#008000"><i>{          push    cx                      }
      </i></font><font color="#800000">$53</font><font color="#000080">/                   </font><font color="#008000"><i>{          push    bx                      }
      </i></font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$03</font><font color="#000080">/               </font><font color="#008000"><i>{          mov     ah, 3                   }
      </i></font><font color="#800000">$B7</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/               </font><font color="#008000"><i>{          mov     bh, 0                   }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/               </font><font color="#008000"><i>{          int     10h                     }
      </i></font><font color="#800000">$80</font><font color="#000080">/</font><font color="#800000">$FE</font><font color="#000080">/</font><font color="#800000">$18</font><font color="#000080">/           </font><font color="#008000"><i>{          cmp     dh, 24                  }
      </i></font><font color="#800000">$75</font><font color="#000080">/</font><font color="#800000">$15</font><font color="#000080">/               </font><font color="#008000"><i>{          jne     popper                  }
      </i></font><font color="#800000">$FE</font><font color="#000080">/</font><font color="#800000">$CE</font><font color="#000080">/               </font><font color="#008000"><i>{          dec     dh                      }
      </i></font><font color="#800000">$B7</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/               </font><font color="#008000"><i>{          mov     bh, 0                   }
      </i></font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$02</font><font color="#000080">/               </font><font color="#008000"><i>{          mov     ah, 2                   }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/               </font><font color="#008000"><i>{          int     10h                     }
      </i></font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/           </font><font color="#008000"><i>{          mov     ax, 0601h               }
      </i></font><font color="#800000">$B7</font><font color="#000080">/</font><font color="#800000">$07</font><font color="#000080">/               </font><font color="#008000"><i>{          mov     bh, 7                   }
      </i></font><font color="#800000">$B9</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$11</font><font color="#000080">/           </font><font color="#008000"><i>{          mov     cx, 1100h               }
      </i></font><font color="#800000">$BA</font><font color="#000080">/</font><font color="#800000">$4F</font><font color="#000080">/</font><font color="#800000">$18</font><font color="#000080">/           </font><font color="#008000"><i>{          mov     dx, 184fh               }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/               </font><font color="#008000"><i>{          int     10h                     }
      </i></font><font color="#800000">$5B</font><font color="#000080">/                   </font><font color="#008000"><i>{  popper: pop     bx                      }
      </i></font><font color="#800000">$59</font><font color="#000080">/                   </font><font color="#008000"><i>{          pop     cx                      }
      </i></font><font color="#800000">$5A</font><font color="#000080">/                   </font><font color="#008000"><i>{          pop     dx                      }
      </i></font><font color="#800000">$58</font><font color="#000080">/                   </font><font color="#008000"><i>{          pop     ax                      }
      </i></font><font color="#800000">$9C</font><font color="#000080">/                   </font><font color="#008000"><i>{  looper: pushf                           }
      </i></font><font color="#800000">$9A</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/   </font><font color="#008000"><i>{          call    far [0:0]               }
      </i></font><font color="#800000">$CF</font><font color="#000080">);                  </font><font color="#008000"><i>{          iret                            }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>procedure </b></font>NewExitProc2<font color="#000080">;
</font><font color="#008000"><i>{ This exit procedure removes the interrupt 29h handler from memory and places
  the cursor at the bottom of the screen. }
</i></font><font color="#FF0000"><b>begin
  </b></font>Reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$25</font><font color="#000080">;
  </font>Reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$29</font><font color="#000080">;
  </font>Reg<font color="#000080">.</font>DS <font color="#000080">:= </font>OldSeg<font color="#000080">;
  </font>Reg<font color="#000080">.</font>DX <font color="#000080">:= </font>OldOfs<font color="#000080">;
  </font>MsDos<font color="#000080">(</font>Reg<font color="#000080">);
  </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">);
  </font>TextAttr <font color="#000080">:= </font><font color="#800000">$07</font><font color="#000080">;
  </font>ClrEol<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>procedure </b></font>ResetBuffer<font color="#000080">;
</font><font color="#008000"><i>{ Reset pointers to the text buffer, effectivly deleting any text in it }
</i></font><font color="#FF0000"><b>begin
  </b></font>MemW<font color="#000080">[</font>seg<font color="#000080">(</font>BufData<font color="#000080">):</font>ofs<font color="#000080">(</font>BufData<font color="#000080">)] := </font>BufferOfs<font color="#000080">;    </font><font color="#008000"><i>{ Set first 2 bytes of BufData to point to buffer offset }
  </i></font>MemW<font color="#000080">[</font>seg<font color="#000080">(</font>BufData<font color="#000080">):</font>ofs<font color="#000080">(</font>BufData<font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">] := </font>BufferSeg<font color="#000080">;  </font><font color="#008000"><i>{ And next two bytes to point to buffer segment }
  </i></font>MemW<font color="#000080">[</font>seg<font color="#000080">(</font>IPP<font color="#000080">):</font>ofs<font color="#000080">(</font>IPP<font color="#000080">)+</font><font color="#800000">21</font><font color="#000080">] := </font>seg<font color="#000080">(</font>BufData<font color="#000080">);    </font><font color="#008000"><i>{ Now point the interrupt routine to BufData for pointer }
  </i></font>MemW<font color="#000080">[</font>seg<font color="#000080">(</font>IPP<font color="#000080">):</font>ofs<font color="#000080">(</font>IPP<font color="#000080">)+</font><font color="#800000">26</font><font color="#000080">] := </font>ofs<font color="#000080">(</font>BufData<font color="#000080">);    </font><font color="#008000"><i>{  to the text buffer }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>function </b></font>BufSize<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#008000"><i>{ This returns the number of characters in the text buffer.  It's what BufData
  now points to minus what is origionally pointed to, eg, the number of times
  IPP incremented it }
</i></font><font color="#FF0000"><b>begin
  </b></font>BufSize <font color="#000080">:= </font>MemW<font color="#000080">[</font>seg<font color="#000080">(</font>BufData<font color="#000080">):</font>ofs<font color="#000080">(</font>BufData<font color="#000080">)]-</font>BufferOfs<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>function </b></font>InBuffer<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>integer<font color="#000080">;
</font><font color="#008000"><i>{ This searched the text buffer for the string S, and if it's found returns
  the offset in the buffer.  If it's not found a -1 is returned }
</i></font><font color="#FF0000"><b>var
  </b></font>L<font color="#000080">,</font>M<font color="#000080">:                  </font>word<font color="#000080">;
  </font>X<font color="#000080">:                    </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>X <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>L <font color="#000080">:= </font>BufferOfs<font color="#000080">;
  </font>M <font color="#000080">:= </font>BufSize<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>X<font color="#000080">&lt;=</font>length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>L<font color="#000080">&lt;=</font>M<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    if </b></font>Mem<font color="#000080">[</font>BufferSeg<font color="#000080">:</font>L<font color="#000080">]=</font>byte<font color="#000080">(</font>S<font color="#000080">[</font>X<font color="#000080">]) </font><font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>X<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>X <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>Inc<font color="#000080">(</font>L<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>X<font color="#000080">&gt;</font>length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>InBuffer <font color="#000080">:= </font>L<font color="#000080">-</font>length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>InBuffer <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>procedure </b></font>InstallInterruptHandler<font color="#000080">;
</font><font color="#008000"><i>{ Installs the int 29h handler }
</i></font><font color="#FF0000"><b>begin
  </b></font>BufferLen <font color="#000080">:= </font><font color="#800000">$4000</font><font color="#000080">;  </font><font color="#008000"><i>{ Set up a 16k buffer }
  </i></font>GetMem<font color="#000080">(</font>BufferPtr<font color="#000080">,</font>BufferLen<font color="#000080">);  </font><font color="#008000"><i>{ Allocate memory pointed at by BufferPtr }
  </i></font>BufferSeg <font color="#000080">:= </font>seg<font color="#000080">(</font>BufferPtr<font color="#000080">^);  </font><font color="#008000"><i>{ Read segment and offset of buffer for easy access }
  </i></font>BufferOfs <font color="#000080">:= </font>ofs<font color="#000080">(</font>BufferPtr<font color="#000080">^);
  </font>ResetBuffer<font color="#000080">;    </font><font color="#008000"><i>{ Place these values in the IPP routine, resetting buffer }
  </i></font>Reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$35</font><font color="#000080">;
  </font>Reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$29</font><font color="#000080">;  </font><font color="#008000"><i>{ DOS service 35h, get interrupt vector for 29h }
  </i></font>MsDos<font color="#000080">(</font>Reg<font color="#000080">);
  </font>OldSeg <font color="#000080">:= </font>Reg<font color="#000080">.</font>ES<font color="#000080">;   </font><font color="#008000"><i>{ Store the segment and offset of the old vector for later use }
  </i></font>OldOfs <font color="#000080">:= </font>Reg<font color="#000080">.</font>BX<font color="#000080">;
  </font>MemW<font color="#000080">[</font>seg<font color="#000080">(</font>IPP<font color="#000080">):</font>ofs<font color="#000080">(</font>IPP<font color="#000080">)+</font><font color="#800000">90</font><font color="#000080">] := </font>Reg<font color="#000080">.</font>BX<font color="#000080">;  </font><font color="#008000"><i>{ And store them so IPP can call the routine }
  </i></font>MemW<font color="#000080">[</font>seg<font color="#000080">(</font>IPP<font color="#000080">):</font>ofs<font color="#000080">(</font>IPP<font color="#000080">)+</font><font color="#800000">92</font><font color="#000080">] := </font>Reg<font color="#000080">.</font>ES<font color="#000080">;
  </font>Reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$29</font><font color="#000080">; </font><font color="#008000"><i>{ DOS service 25h, set interrupt vector 29h }
  </i></font>Reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$25</font><font color="#000080">;
  </font>Reg<font color="#000080">.</font>DS <font color="#000080">:= </font>seg<font color="#000080">(</font>IPP<font color="#000080">);    </font><font color="#008000"><i>{ Store segment and offset for IPP.  The +16 is to skip TP stack }
  </i></font>Reg<font color="#000080">.</font>DX <font color="#000080">:= </font>ofs<font color="#000080">(</font>IPP<font color="#000080">)+</font><font color="#800000">16</font><font color="#000080">; </font><font color="#008000"><i>{ maintainence routines }
  </i></font>MsDos<font color="#000080">(</font>Reg<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

  </i></font><font color="#FF0000"><b>procedure </b></font>DeleteFiles<font color="#000080">(</font>P<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
  </font><font color="#008000"><i>{
    Delete all files in the directory named, including
    Hidden, Read-only, System and other file types.
  }
  </i></font><font color="#FF0000"><b>var
    </b></font>SRec<font color="#000080">:               </font>SearchRec<font color="#000080">;
    </font>ErrorCode<font color="#000080">:          </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>FindFirst<font color="#000080">(</font>P<font color="#000080">+</font><font color="#800000">'\*.*'</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>SRec<font color="#000080">);
    </font><font color="#FF0000"><b>while </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do
    begin
      </b></font>Assign<font color="#000080">(</font>T<font color="#000080">, </font>P<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>SRec<font color="#000080">.</font>Name<font color="#000080">);
      </font>SetFAttr<font color="#000080">(</font>T<font color="#000080">,</font>Archive<font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Deleting '</font><font color="#000080">,</font>P<font color="#000080">,+</font><font color="#800000">'\'</font><font color="#000080">+</font>Srec<font color="#000080">.</font>Name<font color="#000080">);
      </font><font color="#008000"><i>{$I-}
      </i></font>Erase<font color="#000080">(</font>T<font color="#000080">);
      </font><font color="#008000"><i>{$I+}
      </i></font>ErrorCode <font color="#000080">:= </font>IOResult<font color="#000080">;
      </font>FindNext<font color="#000080">(</font>SRec<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>ErrorCode <font color="#000080">:= </font>IOResult<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>procedure </b></font>DeleteDir<font color="#000080">(</font>P<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#008000"><i>{ Simply deletes specified directory }

</i></font><font color="#FF0000"><b>var </b></font>ErrorCode<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DeleteFiles<font color="#000080">(</font>P<font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>RmDir<font color="#000080">(</font>P<font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font>ErrorCode <font color="#000080">:= </font>IOResult<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>procedure </b></font>ListFiles<font color="#000080">(</font>P<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>complete<font color="#000080">:</font>boolean<font color="#000080">; </font>pausenum<font color="#000080">:</font>integer<font color="#000080">);
  </font><font color="#008000"><i>{
   If complete is true then will show the name and file size of every
   file. Otherwise will just show the filename. Numlines is the number
   of files it will display before a pause. 0 means no pause.
  }
  </i></font><font color="#FF0000"><b>var
    </b></font>SRec<font color="#000080">:               </font>SearchRec<font color="#000080">;
    </font>ErrorCode<font color="#000080">:          </font>byte<font color="#000080">;
    </font>Size<font color="#000080">:               </font>AnyStr<font color="#000080">;
    </font>Index<font color="#000080">:              </font>integer<font color="#000080">;
    </font>TheChar<font color="#000080">:            </font>char<font color="#000080">;
    </font>Quit<font color="#000080">:               </font>boolean<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    </b></font>Quit<font color="#000080">:=</font>false<font color="#000080">;
    </font>FindFirst<font color="#000080">(</font>P<font color="#000080">+</font><font color="#800000">'\*.*'</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>SRec<font color="#000080">);
    </font>Index<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do
    begin
       if </b></font>Index<font color="#000080">=</font>pausenum <font color="#FF0000"><b>then 
       begin
        </b></font>write<font color="#000080">(</font><font color="#800000">'[Q=quit, ANY KEY=continue]:'</font><font color="#000080">);
        </font>TheChar<font color="#000080">:=</font>UpCase<font color="#000080">(</font>ReadKey<font color="#000080">); </font>writeln<font color="#000080">(</font>TheChar<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>TheChar<font color="#000080">=</font><font color="#800000">'Q' </font><font color="#FF0000"><b>then </b></font>quit<font color="#000080">:=</font>true<font color="#000080">;
        </font>writeln<font color="#000080">;
        </font>Index<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if NOT </b></font>Quit <font color="#FF0000"><b>then 
      if </b></font>complete <font color="#FF0000"><b>then begin
        </b></font>Size<font color="#000080">:=</font>strr<font color="#000080">(</font>Srec<font color="#000080">.</font>Size<font color="#000080">);
        </font>tab<font color="#000080">(</font>Srec<font color="#000080">.</font>Name<font color="#000080">,</font>Size<font color="#000080">,</font><font color="#800000">15</font><font color="#000080">);
        </font>writeln<font color="#000080">;
      </font><font color="#FF0000"><b>end else
      </b></font>writeln<font color="#000080">(</font>Srec<font color="#000080">.</font>Name<font color="#000080">);
      </font>FindNext<font color="#000080">(</font>SRec<font color="#000080">);
      </font>Inc<font color="#000080">(</font>Index<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>ErrorCode <font color="#000080">:= </font>IOResult<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

  </i></font><font color="#FF0000"><b>function </b></font>DateString<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{
    Returns the current date in a string of the form:  MON ## YEAR.
    E.g, 21 Feb 1989 or 02 Jan 1988.
  }
  </i></font><font color="#FF0000"><b>const
    </b></font>Month<font color="#000080">:              </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]=
                        (</font><font color="#800000">'Jan'</font><font color="#000080">,</font><font color="#800000">'Feb'</font><font color="#000080">,</font><font color="#800000">'Mar'</font><font color="#000080">,</font><font color="#800000">'Apr'</font><font color="#000080">,</font><font color="#800000">'May'</font><font color="#000080">,</font><font color="#800000">'Jun'</font><font color="#000080">,
                         </font><font color="#800000">'Jul'</font><font color="#000080">,</font><font color="#800000">'Aug'</font><font color="#000080">,</font><font color="#800000">'Sep'</font><font color="#000080">,</font><font color="#800000">'Oct'</font><font color="#000080">,</font><font color="#800000">'Nov'</font><font color="#000080">,</font><font color="#800000">'Dec'</font><font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>Y<font color="#000080">,</font>M<font color="#000080">,</font>D<font color="#000080">,</font>Junk<font color="#000080">:         </font>word<font color="#000080">;
    </font>DS<font color="#000080">,</font>YS<font color="#000080">:              </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];
  </font><font color="#FF0000"><b>begin
    </b></font>GetDate<font color="#000080">(</font>Y<font color="#000080">,</font>M<font color="#000080">,</font>D<font color="#000080">,</font>Junk<font color="#000080">);
    </font>Str<font color="#000080">(</font>Y<font color="#000080">,</font>YS<font color="#000080">);
    </font>Str<font color="#000080">(</font>D<font color="#000080">,</font>DS<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>DS<font color="#000080">)&lt;</font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>DS <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">+</font>DS<font color="#000080">;
    </font>DateString <font color="#000080">:= </font>DS<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">+</font>Month<font color="#000080">[</font>M<font color="#000080">]+</font><font color="#800000">' '</font><font color="#000080">+</font>YS<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

  </i></font><font color="#FF0000"><b>function </b></font>TimeString<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{
    Returns the current time in the form:  HH:MM am/pm
    E.g, 12:00 am or 09:12 pm.
  }
  </i></font><font color="#FF0000"><b>var
    </b></font>H<font color="#000080">,</font>M<font color="#000080">,</font>Junk<font color="#000080">:           </font>word<font color="#000080">;
    </font>HS<font color="#000080">,</font>MS<font color="#000080">:              </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];
    </font>Am<font color="#000080">:                 </font>boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>GetTime<font color="#000080">(</font>H<font color="#000080">,</font>M<font color="#000080">,</font>Junk<font color="#000080">,</font>Junk<font color="#000080">);
    </font><font color="#FF0000"><b>case </b></font>H <font color="#FF0000"><b>of
      </b></font><font color="#800000">0</font><font color="#000080">:     </font><font color="#FF0000"><b>begin
               </b></font>Am <font color="#000080">:= </font>true<font color="#000080">;
               </font>H <font color="#000080">:= </font><font color="#800000">12</font><font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">: </font>Am <font color="#000080">:= </font>true<font color="#000080">;
      </font><font color="#800000">12</font><font color="#000080">:    </font>Am <font color="#000080">:= </font>false<font color="#000080">;
      </font><font color="#FF0000"><b>else   begin
               </b></font>Am <font color="#000080">:= </font>false<font color="#000080">;
               </font>H <font color="#000080">:= </font>H<font color="#000080">-</font><font color="#800000">12</font><font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Str<font color="#000080">(</font>H<font color="#000080">,</font>HS<font color="#000080">);
    </font>Str<font color="#000080">(</font>M<font color="#000080">,</font>MS<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>HS<font color="#000080">)&lt;</font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>HS <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">+</font>HS<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>MS<font color="#000080">)&lt;</font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>MS <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">+</font>MS<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>Am <font color="#FF0000"><b>then </b></font>TimeString <font color="#000080">:= </font>HS<font color="#000080">+</font><font color="#800000">':'</font><font color="#000080">+</font>MS<font color="#000080">+</font><font color="#800000">' am'
    </font><font color="#FF0000"><b>else </b></font>TimeString <font color="#000080">:= </font>HS<font color="#000080">+</font><font color="#800000">':'</font><font color="#000080">+</font>MS<font color="#000080">+</font><font color="#800000">' pm'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>procedure </b></font>Tab<font color="#000080">(</font>s1<font color="#000080">,</font>s2<font color="#000080">:</font>AnyStr<font color="#000080">; </font>i<font color="#000080">:</font>integer<font color="#000080">);

</font><font color="#008000"><i>{ Writes s1, then goes to i-length(s1) and writes s2 }

</i></font><font color="#FF0000"><b>var </b></font>j<font color="#000080">,</font>k<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>j<font color="#000080">:=</font>length<font color="#000080">(</font>s1<font color="#000080">);
  </font>i<font color="#000080">:=</font>i<font color="#000080">-</font>j<font color="#000080">;
  </font>write<font color="#000080">(</font>s1<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>k<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>i <font color="#FF0000"><b>do </b></font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
  </font>write<font color="#000080">(</font>s2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Function </b></font>UpCaseString<font color="#000080">(</font>StrIn <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   Inline</b></font><font color="#000080">(                   </font><font color="#008000"><i>{ Thanks to Phil Burns for this routine }

      </i></font><font color="#800000">$1E</font><font color="#000080">/                   </font><font color="#008000"><i>{         PUSH    DS                ; Save DS}
      </i></font><font color="#800000">$C5</font><font color="#000080">/</font><font color="#800000">$76</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/           </font><font color="#008000"><i>{         LDS     SI,[BP+6]         ; Get source string address}
      </i></font><font color="#800000">$C4</font><font color="#000080">/</font><font color="#800000">$7E</font><font color="#000080">/</font><font color="#800000">$0A</font><font color="#000080">/           </font><font color="#008000"><i>{         LES     DI,[BP+10]        ; Get result string address}
      </i></font><font color="#800000">$FC</font><font color="#000080">/                   </font><font color="#008000"><i>{         CLD                       ; Forward direction for strings}
      </i></font><font color="#800000">$AC</font><font color="#000080">/                   </font><font color="#008000"><i>{         LODSB                     ; Get length of source string}
      </i></font><font color="#800000">$AA</font><font color="#000080">/                   </font><font color="#008000"><i>{         STOSB                     ; Copy to result string}
      </i></font><font color="#800000">$30</font><font color="#000080">/</font><font color="#800000">$ED</font><font color="#000080">/               </font><font color="#008000"><i>{         XOR     CH,CH}
      </i></font><font color="#800000">$88</font><font color="#000080">/</font><font color="#800000">$C1</font><font color="#000080">/               </font><font color="#008000"><i>{         MOV     CL,AL             ; Move string length to CL}
      </i></font><font color="#800000">$E3</font><font color="#000080">/</font><font color="#800000">$0E</font><font color="#000080">/               </font><font color="#008000"><i>{         JCXZ    Exit              ; Skip if null string}
                             {;}
      </i></font><font color="#800000">$AC</font><font color="#000080">/                   </font><font color="#008000"><i>{UpCase1: LODSB                     ; Get next source character}
      </i></font><font color="#800000">$3C</font><font color="#000080">/</font><font color="#800000">$61</font><font color="#000080">/               </font><font color="#008000"><i>{         CMP     AL,'a'            ; Check if lower-case letter}
      </i></font><font color="#800000">$72</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/               </font><font color="#008000"><i>{         JB      UpCase2}
      </i></font><font color="#800000">$3C</font><font color="#000080">/</font><font color="#800000">$7A</font><font color="#000080">/               </font><font color="#008000"><i>{         CMP     AL,'z'}
      </i></font><font color="#800000">$77</font><font color="#000080">/</font><font color="#800000">$02</font><font color="#000080">/               </font><font color="#008000"><i>{         JA      UpCase2}
      </i></font><font color="#800000">$2C</font><font color="#000080">/</font><font color="#800000">$20</font><font color="#000080">/               </font><font color="#008000"><i>{         SUB     AL,'a'-'A'        ; Convert to uppercase}
                             {;}
      </i></font><font color="#800000">$AA</font><font color="#000080">/                   </font><font color="#008000"><i>{UpCase2: STOSB                     ; Store in result}
      </i></font><font color="#800000">$E2</font><font color="#000080">/</font><font color="#800000">$F2</font><font color="#000080">/               </font><font color="#008000"><i>{         LOOP    UpCase1}
                             {;}
      </i></font><font color="#800000">$1F</font><font color="#000080">);                  </font><font color="#008000"><i>{Exit:    POP     DS                ; Restore DS}

</i></font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{UpCaseString}</i></font><font color="#000080">;

</font><font color="#008000"><i>{ -------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Function </b></font>PathOnly<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>Dir  <font color="#000080">: </font>DirStr<font color="#000080">;
   </font>Name <font color="#000080">: </font>NameStr<font color="#000080">;
   </font>Ext  <font color="#000080">: </font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>FSplit<font color="#000080">(</font>FileName<font color="#000080">, </font>Dir<font color="#000080">, </font>Name<font color="#000080">, </font>Ext<font color="#000080">);
   </font>PathOnly <font color="#000080">:= </font>Dir<font color="#000080">;
</font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{PathOnly}</i></font><font color="#000080">;

</font><font color="#008000"><i>{ --------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Function </b></font>NameOnly<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Strip any path information from a file specification }
</i></font><font color="#FF0000"><b>Var
   </b></font>Dir  <font color="#000080">: </font>DirStr<font color="#000080">;
   </font>Name <font color="#000080">: </font>NameStr<font color="#000080">;
   </font>Ext  <font color="#000080">: </font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>FSplit<font color="#000080">(</font>FileName<font color="#000080">, </font>Dir<font color="#000080">, </font>Name<font color="#000080">, </font>Ext<font color="#000080">);
   </font>NameOnly <font color="#000080">:= </font>Name <font color="#000080">+ </font>Ext<font color="#000080">;
</font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{NameOnly}</i></font><font color="#000080">;

</font><font color="#008000"><i>{ --------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Function </b></font>BaseNameOnly<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Strip any path and extension from a file specification }
</i></font><font color="#FF0000"><b>Var
   </b></font>Dir  <font color="#000080">: </font>DirStr<font color="#000080">;
   </font>Name <font color="#000080">: </font>NameStr<font color="#000080">;
   </font>Ext  <font color="#000080">: </font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>FSplit<font color="#000080">(</font>FileName<font color="#000080">, </font>Dir<font color="#000080">, </font>Name<font color="#000080">, </font>Ext<font color="#000080">);
   </font>BaseNameOnly <font color="#000080">:= </font>Name<font color="#000080">;
</font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{BaseNameOnly}</i></font><font color="#000080">;

</font><font color="#008000"><i>{ --------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Function </b></font>ExtOnly<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Strip the path and name from a file specification.  Return only the }
{ filename extension.                                                 }
</i></font><font color="#FF0000"><b>Var
   </b></font>Dir  <font color="#000080">: </font>DirStr<font color="#000080">;
   </font>Name <font color="#000080">: </font>NameStr<font color="#000080">;
   </font>Ext  <font color="#000080">: </font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>FSplit<font color="#000080">(</font>FileName<font color="#000080">, </font>Dir<font color="#000080">, </font>Name<font color="#000080">, </font>Ext<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>Ext<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Delete<font color="#000080">(</font>Ext<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
   </font>ExtOnly <font color="#000080">:= </font>Ext<font color="#000080">;
</font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{ExtOnly}</i></font><font color="#000080">;

</font><font color="#008000"><i>{ --------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Function </b></font>IntStr<font color="#000080">(</font>Int <font color="#000080">: </font>LongInt<font color="#000080">; </font>Form <font color="#000080">: </font>Integer<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>Form <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Str<font color="#000080">(</font>Int<font color="#000080">, </font>S<font color="#000080">)
   </font><font color="#FF0000"><b>else
      </b></font>Str<font color="#000080">(</font>Int<font color="#000080">:</font>Form<font color="#000080">, </font>S<font color="#000080">);
   </font>IntStr <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{IntStr}</i></font><font color="#000080">;

</font><font color="#008000"><i>{ --------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Function </b></font>Strr<font color="#000080">(</font>Int <font color="#000080">: </font>LongInt<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{ Added for my own sake - KM }
</i></font><font color="#FF0000"><b>Var
   </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Str<font color="#000080">(</font>Int<font color="#000080">, </font>S<font color="#000080">);
   </font>Strr <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{Strr}</i></font><font color="#000080">;

</font><font color="#008000"><i>{ --------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Function </b></font>SameName<font color="#000080">(</font>N1<font color="#000080">, </font>N2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{
  Function to compare filespecs.

  Wildcards allowed in either name.
  Filenames should be compared seperately from filename extensions by using
     seperate calls to this function
        e.g.  FName1.Ex1
              FName2.Ex2
              are they the same?
              they are if SameName(FName1, FName2) AND SameName(Ex1, Ex2)

  Wildcards work the way DOS should've let them work (eg. *XX.DAT doesn't
  match just any file...only those with 'XX' as the last two characters of
  the name portion and 'DAT' as the extension).

  This routine calls itself recursively to resolve wildcard matches.

}
</i></font><font color="#FF0000"><b>Var
   </b></font>P1<font color="#000080">, </font>P2 <font color="#000080">: </font>Integer<font color="#000080">;
   </font>Match  <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>P1    <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font>P2    <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font>Match <font color="#000080">:= </font>TRUE<font color="#000080">;

   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>N1<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>N2<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>Match <font color="#000080">:= </font>True
   <font color="#FF0000"><b>else
      If </b></font>Length<font color="#000080">(</font>N1<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
         If </b></font>N2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'*' </font><font color="#FF0000"><b>then
            </b></font>Match <font color="#000080">:= </font>TRUE
         <font color="#FF0000"><b>else
            </b></font>Match <font color="#000080">:= </font>FALSE
      <font color="#FF0000"><b>else
         If </b></font>Length<font color="#000080">(</font>N2<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
            If </b></font>N1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'*' </font><font color="#FF0000"><b>then
               </b></font>Match <font color="#000080">:= </font>TRUE
            <font color="#FF0000"><b>else
               </b></font>Match <font color="#000080">:= </font>FALSE<font color="#000080">;

   </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Match <font color="#000080">= </font>TRUE<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>P1 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N1<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>P2 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N2<font color="#000080">)) </font><font color="#FF0000"><b>do
      If </b></font><font color="#000080">(</font>N1<font color="#000080">[</font>P1<font color="#000080">] = </font><font color="#800000">'?'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>N2<font color="#000080">[</font>P2<font color="#000080">] = </font><font color="#800000">'?'</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
         </b></font>Inc<font color="#000080">(</font>P1<font color="#000080">);
         </font>Inc<font color="#000080">(</font>P2<font color="#000080">);
      </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{then}
      </i></font><font color="#FF0000"><b>else
         If </b></font>N1<font color="#000080">[</font>P1<font color="#000080">] = </font><font color="#800000">'*' </font><font color="#FF0000"><b>then begin
            </b></font>Inc<font color="#000080">(</font>P1<font color="#000080">);
            </font><font color="#FF0000"><b>If </b></font>P1 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N1<font color="#000080">) </font><font color="#FF0000"><b>then begin
               While </b></font><font color="#000080">(</font>P2 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N2<font color="#000080">)) </font><font color="#FF0000"><b>and Not </b></font>SameName<font color="#000080">(</font>Copy<font color="#000080">(</font>N1<font color="#000080">,</font>P1<font color="#000080">,</font>Length<font color="#000080">(</font>N1<font color="#000080">)-</font>P1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">), </font>Copy<font color="#000080">(</font>N2<font color="#000080">,</font>P2<font color="#000080">,</font>Length<font color="#000080">(</font>N2<font color="#000080">)-</font>P2<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>do
                  </b></font>Inc<font color="#000080">(</font>P2<font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font>P2 <font color="#000080">&gt; </font>Length<font color="#000080">(</font>N2<font color="#000080">) </font><font color="#FF0000"><b>then
                  </b></font>Match <font color="#000080">:= </font>FALSE
               <font color="#FF0000"><b>else begin
                  </b></font>P1 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N1<font color="#000080">));
                  </font>P2 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N2<font color="#000080">));
               </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{if}</i></font><font color="#000080">;
            </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{then}
            </i></font><font color="#FF0000"><b>else
               </b></font>P2 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N2<font color="#000080">));
         </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{then}
         </i></font><font color="#FF0000"><b>else
            If </b></font>N2<font color="#000080">[</font>P2<font color="#000080">] = </font><font color="#800000">'*' </font><font color="#FF0000"><b>then begin
               </b></font>Inc<font color="#000080">(</font>P2<font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font>P2 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N2<font color="#000080">) </font><font color="#FF0000"><b>then begin
                  While </b></font><font color="#000080">(</font>P1 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N1<font color="#000080">)) </font><font color="#FF0000"><b>and Not </b></font>SameName<font color="#000080">(</font>Copy<font color="#000080">(</font>N1<font color="#000080">,</font>P1<font color="#000080">,</font>Length<font color="#000080">(</font>N1<font color="#000080">)-</font>P1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">), </font>Copy<font color="#000080">(</font>N2<font color="#000080">,</font>P2<font color="#000080">,</font>Length<font color="#000080">(</font>N2<font color="#000080">)-</font>P2<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>do
                     </b></font>Inc<font color="#000080">(</font>P1<font color="#000080">);
                  </font><font color="#FF0000"><b>If </b></font>P1 <font color="#000080">&gt; </font>Length<font color="#000080">(</font>N1<font color="#000080">) </font><font color="#FF0000"><b>then
                     </b></font>Match <font color="#000080">:= </font>FALSE
                  <font color="#FF0000"><b>else begin
                     </b></font>P1 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N1<font color="#000080">));
                     </font>P2 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N2<font color="#000080">));
                  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{if}</i></font><font color="#000080">;
               </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{then}
               </i></font><font color="#FF0000"><b>else
                  </b></font>P1 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N1<font color="#000080">));
            </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{then}
            </i></font><font color="#FF0000"><b>else
               If </b></font>UpCase<font color="#000080">(</font>N1<font color="#000080">[</font>P1<font color="#000080">]) = </font>UpCase<font color="#000080">(</font>N2<font color="#000080">[</font>P2<font color="#000080">]) </font><font color="#FF0000"><b>then begin
                  </b></font>Inc<font color="#000080">(</font>P1<font color="#000080">);
                  </font>Inc<font color="#000080">(</font>P2<font color="#000080">);
               </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{then}
               </i></font><font color="#FF0000"><b>else
                  </b></font>Match <font color="#000080">:= </font>FALSE<font color="#000080">;

   </font><font color="#FF0000"><b>If </b></font>P1 <font color="#000080">&gt; </font>Length<font color="#000080">(</font>N1<font color="#000080">) </font><font color="#FF0000"><b>then begin
      While </b></font><font color="#000080">(</font>P2 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N2<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>N2<font color="#000080">[</font>P2<font color="#000080">] = </font><font color="#800000">'*'</font><font color="#000080">) </font><font color="#FF0000"><b>do
         </b></font>Inc<font color="#000080">(</font>P2<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>P2 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N2<font color="#000080">) </font><font color="#FF0000"><b>then
         </b></font>Match <font color="#000080">:= </font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{if}</i></font><font color="#000080">;

   </font><font color="#FF0000"><b>If </b></font>P2 <font color="#000080">&gt; </font>Length<font color="#000080">(</font>N2<font color="#000080">) </font><font color="#FF0000"><b>then begin
      While </b></font><font color="#000080">(</font>P1 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N1<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>N1<font color="#000080">[</font>P1<font color="#000080">] = </font><font color="#800000">'*'</font><font color="#000080">) </font><font color="#FF0000"><b>do
         </b></font>Inc<font color="#000080">(</font>P1<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>P1 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N1<font color="#000080">) </font><font color="#FF0000"><b>then
         </b></font>Match <font color="#000080">:= </font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{if}</i></font><font color="#000080">;

   </font>SameName <font color="#000080">:= </font>Match<font color="#000080">;

</font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{SameName}</i></font><font color="#000080">;

</font><font color="#008000"><i>{ ---------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Function </b></font>SameFile<font color="#000080">(</font>File1<font color="#000080">, </font>File2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>Path1<font color="#000080">, </font>Path2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin

   </b></font>File1 <font color="#000080">:= </font>FExpand<font color="#000080">(</font>File1<font color="#000080">);
   </font>File2 <font color="#000080">:= </font>FExpand<font color="#000080">(</font>File2<font color="#000080">);
   </font>Path1 <font color="#000080">:= </font>PathOnly<font color="#000080">(</font>File1<font color="#000080">);
   </font>Path2 <font color="#000080">:= </font>PathOnly<font color="#000080">(</font>File2<font color="#000080">);

   </font>SameFile <font color="#000080">:= </font>SameName<font color="#000080">(</font>BaseNameOnly<font color="#000080">(</font>File1<font color="#000080">), </font>BaseNameOnly<font color="#000080">(</font>File2<font color="#000080">)) </font><font color="#FF0000"><b>AND
               </b></font>SameName<font color="#000080">(</font>ExtOnly<font color="#000080">(</font>File1<font color="#000080">), </font>ExtOnly<font color="#000080">(</font>File2<font color="#000080">))           </font><font color="#FF0000"><b>AND
               </b></font><font color="#000080">(</font>Path1 <font color="#000080">= </font>Path2<font color="#000080">);

</font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{SameFile}</i></font><font color="#000080">;

</font><font color="#008000"><i>{ ---------------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{Unit CWARE}</i></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0108.PAS">Original</a><b>]</b></p></body>
</html>
