<html>
<head><title> "DelTree Equivalent" by STEVE ROGERS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
  Erase is the proper procedure to delete one file. Here's a program I
  wrote a while back that does the same thin DELTREE does. Look it over
  and see if it helps get you started. BTW, I modified this a bit to
  remove commercial lib refs so there may be a syntax bug or two...

  RFD.PAS - Copyright 1991 Steve Rogers
  Released to public domain since DOS6 has DelTree... :)
}

{$m 16384,0,8192}
{$i-}

</i></font><font color="#FF0000"><b>uses
  </b></font>crt<font color="#000080">,</font>dos<font color="#000080">;

</font><font color="#008000"><i>{-----------------------}
</i></font><font color="#FF0000"><b>function </b></font>rfd<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>s <font color="#000080">: </font>pathstr<font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>f <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
  </font>d <font color="#000080">: </font>searchrec<font color="#000080">;
  </font>temp <font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'Removing '</font><font color="#000080">+</font>s<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">);

  </font>findfirst<font color="#000080">(</font>s<font color="#000080">+</font><font color="#800000">'\*.*'</font><font color="#000080">,</font>anyfile<font color="#000080">-</font>directory<font color="#000080">,</font>d<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>doserror<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin

    </b></font><font color="#008000"><i>{ Use DOS to get rid of the lion's share of files }
    </i></font>swapvectors<font color="#000080">;
    </font>exec<font color="#000080">(</font>getenv<font color="#000080">(</font><font color="#800000">'COMSPEC'</font><font color="#000080">),</font><font color="#800000">'echo y|del '</font><font color="#000080">+</font>s<font color="#000080">+</font><font color="#800000">'\*.* &gt;nul'</font><font color="#000080">);
    </font>swapvectors<font color="#000080">;

    </font><font color="#008000"><i>{ Now get the stragglers }
    </i></font>findfirst<font color="#000080">(</font>s<font color="#000080">+</font><font color="#800000">'\*.*'</font><font color="#000080">,</font>anyfile<font color="#000080">-</font>directory<font color="#000080">,</font>d<font color="#000080">);
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>doserror<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
      </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>s<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>d<font color="#000080">.</font>name<font color="#000080">);
      </font>setfattr<font color="#000080">(</font>f<font color="#000080">,</font>archive<font color="#000080">);
      </font>erase<font color="#000080">(</font>f<font color="#000080">);
      </font>findnext<font color="#000080">(</font>d<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ Now process the subs }
  </i></font>findfirst<font color="#000080">(</font>s<font color="#000080">+</font><font color="#800000">'\*.*'</font><font color="#000080">,</font>directory<font color="#000080">,</font>d<font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>doserror<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
    if </b></font><font color="#000080">(</font>d<font color="#000080">.</font>attr <font color="#FF0000"><b>and </b></font>directory <font color="#000080">= </font>directory<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>d<font color="#000080">.</font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&lt;&gt;</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>temp<font color="#000080">:= </font>rfd<font color="#000080">(</font>s<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>d<font color="#000080">.</font>name<font color="#000080">);
    </font>findnext<font color="#000080">(</font>d<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>rmdir<font color="#000080">(</font>s<font color="#000080">);
  </font>rfd<font color="#000080">:= (</font>ioresult<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------}
</i></font><font color="#FF0000"><b>begin
  </b></font>clrscr<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'RFD - Remove Full Directory  Copyright 1991 Steve Rogers'</font><font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>paramcount<font color="#000080">&lt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>writeln<font color="#000080">(</font><font color="#800000">'Syntax is: RFD &lt;directory&gt;'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else begin
    if </b></font>rfd<font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>writeln<font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">' removed. All files and subs deleted.'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'Unable to find or remove '</font><font color="#000080">+</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p></body>
</html>
