<html>
<head><title> "File Exist in Assembler" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$A+,B-,D+,E+,F-,G+,I+,L+,N-,O-,P-,Q-,R-,S+,T-,V-,X+,Y+}
{$M 16384,0,655360}

{&Auml; Fido Pascal Conference &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml; PASCAL &Auml;
Msg  : 193 of 292
From : Wilbert van Leijen                  2:281/256.14         14 May 93  19:29
To   : Vince Laurent                       1:382/10.0
Subj : a few questions...
&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
07 May 93, Vince Laurent writes to All:

 VL&gt; 1. What is the quickest way to check for the existance of a file?
 VL&gt;    I am going to be running the application on a network and would
 VL&gt;    like to minimize network traffic.

You cannot bypass the file server for this purpose, the reason should be
obvious.  So peer-to-peer communication protocols are out.

Suggestion: obtain the file's attributes using INT 21h, AH=43h, DS:DX -&gt; ASCIIZ
filename.
If this call sets the carry flag, the file doesn't exist.  Otherwise, it does.
Advantage: no need for an attempt to open it.}

</i></font><font color="#FF0000"><b>Function </b></font>FileExist<font color="#000080">(</font>filename <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;

</font><font color="#FF0000"><b>ASM
        </b></font><font color="#FF00FF">PUSH   DS
        LDS    SI, [filename]      </font><font color="#008000"><i>{ make ASCIIZ }
        </i></font><font color="#FF00FF">XOR    AH, AH
        LODSB
        XCHG   AX, BX
        MOV    Byte Ptr [SI+BX], 0
        MOV    DX, SI
        MOV    AX, 4300h           </font><font color="#008000"><i>{ get file attributes }
        </i></font><font color="#FF00FF">INT    21h
        MOV    AL, False
        JC     @1                  </font><font color="#008000"><i>{ fail? }
        </i></font><font color="#FF00FF">INC    AX
@1:     POP    DS
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ FileExist }

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p></body>
</html>
