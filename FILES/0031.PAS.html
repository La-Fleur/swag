<html>
<head><title> "Filesize & ZeroByte Files" by DAVID DANIEL ANDERSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
From: DAVIDDANIEL ANDERSON         Refer#: 2239
Subj: FileSize in DOS                Conf: (232) T_Pascal_R

The FileSize &quot;returns the number of components&quot; in a file.  Thus, it
may not work as you might assume on untyped files, or files of records.

The file should be declared as a file of byte or char or as a text
file, in order to use FileSize.

An alternative to FileSize is to use the SearchRec type in the DOS
unit.  This program deletes a file if it is 0 bytes.  The filespec is
provided by the user on the command line, and can contain wildcards.
*)

</i></font><font color="#FF0000"><b>PROGRAM </b></font>delete_0_byte_files<font color="#000080">;
</font><font color="#FF0000"><b>USES </b></font>Dos<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>MaybeZero   <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>Byte<font color="#000080">;   </font><font color="#008000"><i>{ the file in question }
   </i></font>DirInfo     <font color="#000080">: </font>SearchRec<font color="#000080">;      </font><font color="#008000"><i>{ a record of the file }
   </i></font>FMask       <font color="#000080">: </font>PathStr<font color="#000080">;        </font><font color="#008000"><i>{ entire path as specified by user }
   </i></font>MZName      <font color="#000080">: </font>PathStr<font color="#000080">;        </font><font color="#008000"><i>{ path of file in question }
   </i></font>FDir        <font color="#000080">: </font>DirStr<font color="#000080">;         </font><font color="#008000"><i>{ dir of file in question }
   </i></font>FName       <font color="#000080">: </font>NameStr<font color="#000080">;        </font><font color="#008000"><i>{ name of file in question }
   </i></font>FExt        <font color="#000080">: </font>ExtStr<font color="#000080">;         </font><font color="#008000"><i>{ ext of file in question }
   </i></font>NZero       <font color="#000080">: </font>Word<font color="#000080">;           </font><font color="#008000"><i>{ number of files deleted }

</i></font><font color="#FF0000"><b>BEGIN
     </b></font>NZero <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>IF </b></font>ParamCount <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
        </b></font>FMask <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)     </font><font color="#008000"><i>{ use command line info, if it exists }
     </i></font><font color="#FF0000"><b>ELSE BEGIN
        </b></font>Writeln<font color="#000080">(</font><font color="#800000">'You must specify a file_mask, such as &quot;*.*&quot;!'</font><font color="#000080">);
        </font>Halt<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>FSplit<font color="#000080">(</font>FExpand<font color="#000080">(</font>FMask<font color="#000080">),</font>FDir<font color="#000080">,</font>FName<font color="#000080">,</font>FExt<font color="#000080">);  </font><font color="#008000"><i>{ split cmdlind info into }
     </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>FName <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>THEN                       </b></font><font color="#008000"><i>{ components }
        </i></font>FMask <font color="#000080">:= </font>FMask <font color="#000080">+ </font><font color="#800000">'*.*'</font><font color="#000080">;          </font><font color="#008000"><i>{ if only a DOS path was specified, }
     </i></font>FindFirst<font color="#000080">(</font>FMask<font color="#000080">, </font>Archive<font color="#000080">, </font>DirInfo<font color="#000080">);    </font><font color="#008000"><i>{ append a wildcard spec }

     </i></font><font color="#FF0000"><b>WHILE </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>DO               </b></font><font color="#008000"><i>{ check every valid file for size }
     </i></font><font color="#FF0000"><b>BEGIN                               </b></font><font color="#008000"><i>{ append path to name, to allow }
          </i></font>MZName <font color="#000080">:= </font>FDir<font color="#000080">+</font>DirInfo<font color="#000080">.</font>Name<font color="#000080">;  </font><font color="#008000"><i>{ paths and drives other than current }
          </i></font>Assign<font color="#000080">(</font>MaybeZero<font color="#000080">,</font>MZName<font color="#000080">);    </font><font color="#008000"><i>{ use Assign since Erase can only work }
                                             { on *files*, -not- file names }
          </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>DirInfo<font color="#000080">.</font>Size <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN  </b></font><font color="#008000"><i>{ THE MEAT! use the SearchRec }
             </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Deleting '</font><font color="#000080">,</font>MZName<font color="#000080">);     </font><font color="#008000"><i>{ for determining file size }
             </i></font>Erase<font color="#000080">(</font>MaybeZero<font color="#000080">);             </font><font color="#008000"><i>{ give a message and delete it }
             </i></font>NZero <font color="#000080">:= </font>NZero <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;           </font><font color="#008000"><i>{ incremented counter, of course }
          </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

          </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);               </font><font color="#008000"><i>{ look for another matching file }
     </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Files Deleted: '</font><font color="#000080">,</font>NZero<font color="#000080">);     </font><font color="#008000"><i>{ simply display total # deleted }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p></body>
</html>
