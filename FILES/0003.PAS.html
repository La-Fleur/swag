<html>
<head><title> "FILEMODE.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">RB <font color="#000080">&gt; </font>I use a shared <font color="#FF0000"><b>File to </b></font>transfer info between
   <font color="#000080">&gt; </font>multitasker Windows that are running the same application<font color="#000080">.
   &gt; </font>Lately<font color="#000080">, </font>I have been getting Runtime errors <font color="#800000">2</font><font color="#000080">, </font><font color="#800000">5 </font><font color="#000080">&amp; </font><font color="#800000">162 </font><font color="#FF0000"><b>in </b></font>the following spo

<font color="#FF0000"><b>Try to set </b></font>the <font color="#000080">&quot;</font>FileMode<font color="#000080">&quot; </font>Constant <font color="#FF0000"><b>to </b></font><font color="#800000">66 </font><font color="#000080">(</font>read<font color="#000080">/</font>Write<font color="#000080">) </font><font color="#FF0000"><b>or
</b></font><font color="#800000">64 </font><font color="#000080">(</font>read<font color="#000080">) </font>beFore opening it<font color="#000080">.  </font>Here<font color="#800000">'s a map of valid values
</font><font color="#FF0000"><b>to </b></font>FileMode<font color="#000080">:

                               ----- </font>Sharing Method <font color="#000080">-----
</font>Access         Compatibility   Deny   Deny    Deny   Deny
Method            Mode         Both   Write   Read   None
___<font color="#000080">------------------------------------------------------
</font>Read Only           <font color="#800000">0           16     32      48     64
</font>Write Only          <font color="#800000">1           17     33      49     65
</font>Read<font color="#000080">/</font>Write          <font color="#800000">2</font><font color="#000080">*          </font><font color="#800000">18     34      50     66

 </font><font color="#000080">* = </font><font color="#FF0000"><b>default

File </b></font>locking <font color="#FF0000"><b>is </b></font>seldom useful <font color="#FF0000"><b>For </b></font>Real life applications<font color="#000080">.
</font>Sometimes however<font color="#000080">, </font><font color="#FF0000"><b>File </b></font>locking MAY be appropriate<font color="#000080">, </font>such <font color="#FF0000"><b>as
</b></font>when a Compiled list <font color="#FF0000"><b>is </b></font>produced at the Printer<font color="#000080">; </font><font color="#FF0000"><b>if </b></font>users
are allowed <font color="#FF0000"><b>to </b></font>update the database <font color="#FF0000"><b>then</b></font><font color="#000080">, </font>the list can contain
multiple instances <font color="#FF0000"><b>of </b></font>a <font color="#FF0000"><b>Record or </b></font>reference<font color="#000080">...  :-)

</font>Use <font color="#FF0000"><b>Record </b></font>locking instead<font color="#000080">, </font>when required<font color="#000080">, </font><font color="#FF0000"><b>For </b></font>most purposes
<font color="#FF0000"><b>and </b></font>add logic <font color="#FF0000"><b>to </b></font>prevent disasters <font color="#FF0000"><b>and </b></font>user misunderstandings<font color="#000080">.
</font>Users will generally be more happy <font color="#FF0000"><b>if </b></font>they<font color="#800000">'re not denied
</font>Write access all the time<font color="#000080">...  :-)

</font>RB <font color="#000080">&gt; </font>Perhaps I need <font color="#FF0000"><b>to </b></font>disable I<font color="#000080">/</font>O checking <font color="#FF0000"><b>and </b></font>put <font color="#FF0000"><b>in </b></font>some Delays <font color="#FF0000"><b>if
   </b></font><font color="#000080">&gt; </font>this <font color="#FF0000"><b>File is </b></font>being accessed simulataneously<font color="#000080">.  </font>Also<font color="#000080">, </font>the size <font color="#FF0000"><b>of </b></font>this <font color="#FF0000"><b>File

</b></font>Definately disable I<font color="#000080">/</font>O checking<font color="#000080">.  </font>Don<font color="#800000">'t add Delays if you
</font>can avoid it<font color="#000080">.  </font>Beware <font color="#FF0000"><b>of </b></font>dead<font color="#000080">-</font>lock situations which occur
when two <font color="#FF0000"><b>or </b></font>more users access the same <font color="#FF0000"><b>File With </b></font>inadequate
access rights <font color="#FF0000"><b>and </b></font>they<font color="#800000">'re all put on hold Until the File
</font><font color="#FF0000"><b>is </b></font>released by the other<font color="#000080">...  </font>One way <font color="#FF0000"><b>to </b></font>catch these situations
<font color="#FF0000"><b>is to </b></font>retry a specified number <font color="#FF0000"><b>of </b></font>times <font color="#FF0000"><b>and then </b></font>cancel the
operation <font color="#FF0000"><b>With </b></font>an error <font color="#FF0000"><b>message </b></font>perhaps<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p></body>
</html>
