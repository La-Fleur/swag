<html>
<head><title> "File Sharing" by HYPERDRIVE SOFTWARE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Also, please note, this unit has not been completely tested.  It may
(and most probably does) have bugs in it.  If (and when) any are
discovered, please contact me, so I can update my routines also.

**************************
*     SHARE.PAS v1.0     *
*                        *
*  General purpose file  *
*    sharing routines    *
**************************

1992-93 HyperDrive Software
Released into the public domain.
}

{$S-,R-,D-}
{$IFOPT O+}
  {$F+}
{$ENDIF}

</i></font><font color="#FF0000"><b>unit </b></font>Share<font color="#000080">;

</font><font color="#FF0000"><b>interface

const
  </b></font>MaxLockRetries <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;

  </font>NormalMode <font color="#000080">= </font><font color="#800000">$02</font><font color="#000080">; </font><font color="#008000"><i>{ ---- 0010 }
  </i></font>ReadOnly   <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">; </font><font color="#008000"><i>{ ---- 0000 }
  </i></font>WriteOnly  <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">; </font><font color="#008000"><i>{ ---- 0001 }
  </i></font>ReadWrite  <font color="#000080">= </font><font color="#800000">$02</font><font color="#000080">; </font><font color="#008000"><i>{ ---- 0010 }
  </i></font>DenyAll    <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">; </font><font color="#008000"><i>{ 0001 ---- }
  </i></font>DenyWrite  <font color="#000080">= </font><font color="#800000">$20</font><font color="#000080">; </font><font color="#008000"><i>{ 0010 ---- }
  </i></font>DenyRead   <font color="#000080">= </font><font color="#800000">$30</font><font color="#000080">; </font><font color="#008000"><i>{ 0011 ---- }
  </i></font>DenyNone   <font color="#000080">= </font><font color="#800000">$40</font><font color="#000080">; </font><font color="#008000"><i>{ 0100 ---- }
  </i></font>NoInherit  <font color="#000080">= </font><font color="#800000">$70</font><font color="#000080">; </font><font color="#008000"><i>{ 1000 ---- }

</i></font><font color="#FF0000"><b>type
  </b></font>Taskers <font color="#000080">= (</font>NoTasker<font color="#000080">, </font>DesqView<font color="#000080">, </font>DoubleDOS<font color="#000080">, </font>Windows<font color="#000080">, </font>OS2<font color="#000080">, </font>NetWare<font color="#000080">);

</font><font color="#FF0000"><b>var
  </b></font>MultiTasking <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>MultiTasker  <font color="#000080">: </font>Taskers<font color="#000080">;
  </font>VideoSeg     <font color="#000080">: </font>Word<font color="#000080">;
  </font>VideoOfs     <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SetFileMode<font color="#000080">(</font>Mode <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#008000"><i>{- Set filemode for typed/untyped files }
</i></font><font color="#FF0000"><b>procedure </b></font>ResetFileMode<font color="#000080">;
</font><font color="#008000"><i>{- Reset filemode to ReadWrite (02h) }
</i></font><font color="#FF0000"><b>procedure </b></font>LockFile<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">);
</font><font color="#008000"><i>{- Lock file F }
</i></font><font color="#FF0000"><b>procedure </b></font>UnLockFile<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">);
</font><font color="#008000"><i>{- Unlock file F }
</i></font><font color="#FF0000"><b>procedure </b></font>LockBytes<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">;  </font>Start<font color="#000080">, </font>Bytes <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#008000"><i>{- Lock Bytes bytes of file F, starting with Start }
</i></font><font color="#FF0000"><b>procedure </b></font>UnLockBytes<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">;  </font>Start<font color="#000080">, </font>Bytes <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#008000"><i>{- Unlock Bytes bytes of file F, starting with Start }
</i></font><font color="#FF0000"><b>procedure </b></font>LockRecords<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">;  </font>Start<font color="#000080">, </font>Records <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#008000"><i>{- Lock Records records of file F, starting with Start }
</i></font><font color="#FF0000"><b>procedure </b></font>UnLockRecords<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">;  </font>Start<font color="#000080">, </font>Records <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#008000"><i>{- Unlock Records records of file F, starting with Start }
</i></font><font color="#FF0000"><b>function  </b></font>TimeOut <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{- Check for LockRetry timeout }
</i></font><font color="#FF0000"><b>procedure </b></font>TimeOutReset<font color="#000080">;
</font><font color="#008000"><i>{- Reset internal LockRetry counter }
</i></font><font color="#FF0000"><b>function  </b></font>InDos<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{- Is DOS busy? }
</i></font><font color="#FF0000"><b>procedure </b></font>GiveTimeSlice<font color="#000080">;
</font><font color="#008000"><i>{- Give up remaining CPU time slice }
</i></font><font color="#FF0000"><b>procedure </b></font>BeginCrit<font color="#000080">;
</font><font color="#008000"><i>{- Enter critical region }
</i></font><font color="#FF0000"><b>procedure </b></font>EndCrit<font color="#000080">;
</font><font color="#008000"><i>{- End critical region }

</i></font><font color="#FF0000"><b>implementation

uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>InDosFlag <font color="#000080">: ^</font>Word<font color="#000080">;
  </font>LockRetry <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>FLock<font color="#000080">(</font>Handle <font color="#000080">: </font>Word<font color="#000080">; </font>Pos<font color="#000080">, </font>Len <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>Inline</b></font><font color="#000080">(
  </font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$5C</font><font color="#000080">/    </font><font color="#008000"><i>{  mov   AX,$5C00        ;DOS FLOCK, Lock subfunction}
  </i></font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$5E</font><font color="#000080">/</font><font color="#800000">$04</font><font color="#000080">/    </font><font color="#008000"><i>{  mov   BX,[BP + 04]    ;Place file handle in Bx register}
  </i></font><font color="#800000">$C4</font><font color="#000080">/</font><font color="#800000">$56</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/    </font><font color="#008000"><i>{  les   DX,[BP + 06]    ;Load position in ES:DX}
  </i></font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$C1</font><font color="#000080">/        </font><font color="#008000"><i>{  mov   CX,ES           ;Move ES pointer to CX register}
  </i></font><font color="#800000">$C4</font><font color="#000080">/</font><font color="#800000">$7E</font><font color="#000080">/</font><font color="#800000">$08</font><font color="#000080">/    </font><font color="#008000"><i>{  les   DI,[BP + 08]    ;Load length in ES:DI}
  </i></font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$C6</font><font color="#000080">/        </font><font color="#008000"><i>{  mov   SI,ES           ;Move ES pointer to SI register}
  </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$21</font><font color="#000080">);       </font><font color="#008000"><i>{  int   $21             ;Call DOS}

</i></font><font color="#FF0000"><b>procedure </b></font>FUnlock<font color="#000080">(</font>Handle <font color="#000080">: </font>Word<font color="#000080">; </font>Pos<font color="#000080">, </font>Len <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>Inline</b></font><font color="#000080">(
  </font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/</font><font color="#800000">$5C</font><font color="#000080">/    </font><font color="#008000"><i>{  mov   AX,$5C01        ;DOS FLOCK, Unlock subfunction}
  </i></font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$5E</font><font color="#000080">/</font><font color="#800000">$04</font><font color="#000080">/    </font><font color="#008000"><i>{  mov   BX,[BP + 04]    ;Place file handle in Bx register}
  </i></font><font color="#800000">$C4</font><font color="#000080">/</font><font color="#800000">$56</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/    </font><font color="#008000"><i>{  les   DX,[BP + 06]    ;Load position in ES:DX}
  </i></font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$C1</font><font color="#000080">/        </font><font color="#008000"><i>{  mov   CX,ES           ;Move ES pointer to CX register}
  </i></font><font color="#800000">$C4</font><font color="#000080">/</font><font color="#800000">$7E</font><font color="#000080">/</font><font color="#800000">$08</font><font color="#000080">/    </font><font color="#008000"><i>{  les   DI,[BP + 08]    ;Load length in ES:DI}
  </i></font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$C6</font><font color="#000080">/        </font><font color="#008000"><i>{  mov   SI,ES           ;Move ES pointer to SI register}
  </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$21</font><font color="#000080">);       </font><font color="#008000"><i>{  int   $21             ;Call DOS}

</i></font><font color="#FF0000"><b>procedure </b></font>SetFileMode<font color="#000080">(</font>Mode <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>FileMode <font color="#000080">:= </font>Mode<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ResetFileMode<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FileMode <font color="#000080">:= </font>NormalMode<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>LockFile<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">);
</font><font color="#FF0000"><b>begin
  If not </b></font>MultiTasking <font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;

  </font><font color="#FF0000"><b>While </b></font>InDos <font color="#FF0000"><b>do
    </b></font>GiveTimeSlice<font color="#000080">;

  </font>FLock<font color="#000080">(</font>FileRec<font color="#000080">(</font>F<font color="#000080">).</font>Handle<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>FileSize<font color="#000080">(</font><font color="#FF0000"><b>File</b></font><font color="#000080">(</font>F<font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>UnLockFile<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">);
</font><font color="#FF0000"><b>begin
  If not </b></font>MultiTasking <font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;

  </font><font color="#FF0000"><b>While </b></font>InDos <font color="#FF0000"><b>do
    </b></font>GiveTimeSlice<font color="#000080">;

  </font>FLock<font color="#000080">(</font>FileRec<font color="#000080">(</font>F<font color="#000080">).</font>Handle<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>FileSize<font color="#000080">(</font><font color="#FF0000"><b>File</b></font><font color="#000080">(</font>F<font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>LockBytes<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">;  </font>Start<font color="#000080">, </font>Bytes <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>begin
  If not </b></font>MultiTasking <font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;

  </font><font color="#FF0000"><b>While </b></font>InDos <font color="#FF0000"><b>do
    </b></font>GiveTimeSlice<font color="#000080">;

  </font>FLock<font color="#000080">(</font>FileRec<font color="#000080">(</font>F<font color="#000080">).</font>Handle<font color="#000080">, </font>Start<font color="#000080">, </font>Bytes<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>UnLockBytes<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">;  </font>Start<font color="#000080">, </font>Bytes <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>begin
  If not </b></font>MultiTasking <font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;

  </font><font color="#FF0000"><b>While </b></font>InDos <font color="#FF0000"><b>do
    </b></font>GiveTimeSlice<font color="#000080">;

  </font>FLock<font color="#000080">(</font>FileRec<font color="#000080">(</font>F<font color="#000080">).</font>Handle<font color="#000080">, </font>Start<font color="#000080">, </font>Bytes<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>LockRecords<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">;  </font>Start<font color="#000080">, </font>Records <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>begin
  If not </b></font>MultiTasking <font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;

  </font><font color="#FF0000"><b>While </b></font>InDos <font color="#FF0000"><b>do
    </b></font>GiveTimeSlice<font color="#000080">;

  </font>FLock<font color="#000080">(</font>FileRec<font color="#000080">(</font>F<font color="#000080">).</font>Handle<font color="#000080">, </font>Start <font color="#000080">* </font>FileRec<font color="#000080">(</font>F<font color="#000080">).</font>RecSize<font color="#000080">, </font>Records <font color="#000080">* </font>FileRec<font color="#000080">(</font>F<font color="#000080">).</font>RecSize<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>UnLockRecords<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">;  </font>Start<font color="#000080">, </font>Records <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>begin
  If not </b></font>MultiTasking <font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;

  </font><font color="#FF0000"><b>While </b></font>InDos <font color="#FF0000"><b>do
    </b></font>GiveTimeSlice<font color="#000080">;

  </font>FLock<font color="#000080">(</font>FileRec<font color="#000080">(</font>F<font color="#000080">).</font>Handle<font color="#000080">, </font>Start <font color="#000080">* </font>FileRec<font color="#000080">(</font>F<font color="#000080">).</font>RecSize<font color="#000080">, </font>Records <font color="#000080">* </font>FileRec<font color="#000080">(</font>F<font color="#000080">).</font>RecSize<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TimeOut <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GiveTimeSlice<font color="#000080">;
  </font>TimeOut <font color="#000080">:= </font>True<font color="#000080">;

  </font><font color="#FF0000"><b>If </b></font>MultiTasking <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>LockRetry <font color="#000080">&lt; </font>MaxLockRetries<font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>TimeOut <font color="#000080">:= </font>False<font color="#000080">;
    </font>Inc<font color="#000080">(</font>LockRetry<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TimeOutReset<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>LockRetry <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>InDos <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>InDos <font color="#000080">:= </font>InDosFlag<font color="#000080">^ &gt; </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GiveTimeSlice<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">cmp   MultiTasker, DesqView
  je    @DVwait
  cmp   MultiTasker, DoubleDOS
  je    @DoubleDOSwait
  cmp   MultiTasker, Windows
  je    @WinOS2wait
  cmp   MultiTasker, OS2
  je    @WinOS2wait
  cmp   MultiTasker, NetWare
  je    @Netwarewait
 @Doswait:
  int   $28
  jmp   @WaitDone
 @DVwait:
  mov   AX,$1000
  int   $15
  jmp   @WaitDone
 @DoubleDOSwait:
  mov   AX,$EE01
  int   $21
  jmp   @WaitDone
 @WinOS2wait:
  mov   AX,$1680
  int   $2F
  jmp   @WaitDone
 @Netwarewait:
  mov   BX,$000A
  int   $7A
  jmp   @WaitDone
 @WaitDone:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>BeginCrit<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">cmp   MultiTasker, DesqView
  je    @DVCrit
  cmp   MultiTasker, DoubleDOS
  je    @DoubleDOSCrit
  cmp   MultiTasker, Windows
  je    @WinCrit
  jmp   @EndCrit
 @DVCrit:
  mov   AX,$101B
  int   $15
  jmp   @EndCrit
 @DoubleDOSCrit:
  mov   AX,$EA00
  int   $21
  jmp   @EndCrit
 @WinCrit:
  mov   AX,$1681
  int   $2F
  jmp   @EndCrit
 @EndCrit:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>EndCrit<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">cmp   MultiTasker, DesqView
  je    @DVCrit
  cmp   MultiTasker, DoubleDOS
  je    @DoubleDOSCrit
  cmp   MultiTasker, Windows
  je    @WinCrit
  jmp   @EndCrit
 @DVCrit:
  mov   AX,$101C
  int   $15
  jmp   @EndCrit
 @DoubleDOSCrit:
  mov   AX,$EB00
  int   $21
  jmp   @EndCrit
 @WinCrit:
  mov   AX,$1682
  int   $2F
  jmp   @EndCrit
 @EndCrit:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{- Init }
  </i></font>LockRetry<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#FF0000"><b>asm
   </b></font><font color="#FF00FF">@CheckDV:
    mov   AX, $2B01
    mov   CX, $4445
    mov   DX, $5351
    int   $21
    cmp   AL, $FF
    je    @CheckDoubleDOS
    mov   MultiTasker, DesqView
    jmp   @CheckDone
   @CheckDoubleDOS:
    mov   AX, $E400
    int   $21
    cmp   AL, $00
    je    @CheckWindows
    mov   MultiTasker, DoubleDOS
    jmp   @CheckDone
   @CheckWindows:
    mov   AX, $1600
    int   $2F
    cmp   AL, $00
    je    @CheckOS2
    cmp   AL, $80
    je    @CheckOS2
    mov   MultiTasker, Windows
    jmp   @CheckDone
   @CheckOS2:
    mov   AX, $3001
    int   $21
    cmp   AL, $0A
    je    @InOS2
    cmp   AL, $14
    jne   @CheckNetware
   @InOS2:
    mov   MultiTasker, OS2
    jmp   @CheckDone
   @CheckNetware:
    mov   AX,$7A00
    int   $2F
    cmp   AL,$FF
    jne   @NoTasker
    mov   MultiTasker, NetWare
    jmp   @CheckDone
   @NoTasker:
    mov   MultiTasker, NoTasker
   @CheckDone:
    </font><font color="#008000"><i>{-Set MultiTasking }
    </i></font><font color="#FF00FF">cmp   MultiTasker, NoTasker
    mov   VideoSeg, $B800
    mov   VideoOfs, $0000
    je    @NoMultiTasker
    mov   MultiTasking, $01
    </font><font color="#008000"><i>{-Get video address }
    </i></font><font color="#FF00FF">mov   AH, $FE
    les   DI, [$B8000000]
    int   $10
    mov   VideoSeg, ES
    mov   VideoOfs, DI
    jmp   @Done
   @NoMultiTasker:
    mov   MultiTasking, $00
   @Done:
    </font><font color="#008000"><i>{-Get InDos flag }
    </i></font><font color="#FF00FF">mov   AH, $34
    int   $21
    mov   WORD PTR InDosFlag, BX
    mov   WORD PTR InDosFlag + 2, ES
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p></body>
</html>
