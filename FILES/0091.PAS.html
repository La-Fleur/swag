<html>
<head><title> "Clear All attributes on Files" by SCOTT TUNSTALL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0091.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>program </b></font>Delattr<font color="#000080">;

</font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Usage<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'DELATTR (C) 1995 Scott Tunstall.'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Gets rid of those annoying undeletable files quickly !'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Usage:'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'DELATTR [-r] [-s] [-a] [-h] &lt;FileSpec&gt;'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'   -r will remove the READ ONLY attribute of a file,'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'   -s will remove the SYSTEM attribute,'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'   -a will remove the ARCHIVE attribute,'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'   -h will remove the HIDDEN attribute.'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'If you do not specify any attribute parameters, the'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'program assumes you want to remove ALL of the'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'specified file''s attributes. Or Something. :-) '</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Use ATTRIB if all you want to do is ADD or VIEW '</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'the attributes of file(s).'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>BreakDownMask<font color="#000080">(</font>TheMask<font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Begin
     If </b></font>TheMask <font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
        Begin
        If </b></font>TheMask <font color="#FF0000"><b>AND </b></font>Archive <font color="#000080">= </font>Archive <font color="#FF0000"><b>Then
           </b></font>Write<font color="#000080">(</font><font color="#800000">'A '</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>TheMask <font color="#FF0000"><b>AND </b></font>Directory <font color="#000080">= </font>Directory <font color="#FF0000"><b>Then
           </b></font>Write<font color="#000080">(</font><font color="#800000">'D '</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>TheMask <font color="#FF0000"><b>AND </b></font>Hidden <font color="#000080">= </font>Hidden <font color="#FF0000"><b>Then
           </b></font>Write<font color="#000080">(</font><font color="#800000">'H '</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>TheMask <font color="#FF0000"><b>AND </b></font>ReadOnly <font color="#000080">= </font>ReadOnly <font color="#FF0000"><b>Then
           </b></font>Write<font color="#000080">(</font><font color="#800000">'R '</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>TheMask <font color="#FF0000"><b>AND </b></font>SysFile <font color="#000080">= </font>SysFile <font color="#FF0000"><b>Then
           </b></font>Write<font color="#000080">(</font><font color="#800000">'S '</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>TheMask <font color="#FF0000"><b>AND </b></font>VolumeID <font color="#000080">= </font>VolumeID <font color="#FF0000"><b>Then
           </b></font>Write<font color="#000080">(</font><font color="#800000">'V '</font><font color="#000080">);
        </font><font color="#FF0000"><b>End
     Else
         </b></font>Write<font color="#000080">(</font><font color="#800000">'NULL '</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{
ReadOnly     &sup3;  $01
Hidden       &sup3;  $02
SysFile      &sup3;  $04
VolumeID     &sup3;  $08
Directory    &sup3;  $10
Archive      &sup3;  $20
AnyFile      &sup3;  $3F
}

</i></font><font color="#FF0000"><b>Procedure </b></font>DoAttrib<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>Count<font color="#000080">: </font>Byte<font color="#000080">;
    </font>FileToChange<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
    </font>TempParam<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>CurrentByteMask<font color="#000080">: </font>Word<font color="#000080">;
    </font>ByteMask <font color="#000080">: </font>Word<font color="#000080">;
    </font>SearchRc<font color="#000080">: </font>SearchRec<font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>ByteMask<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font>ParamCount <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
        </b></font>ByteMask<font color="#000080">:=</font><font color="#800000">$2f
     </font><font color="#FF0000"><b>Else
         For </b></font>Count<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>ParamCount <font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
             Begin
             </b></font>TempParam<font color="#000080">:=</font>ParamStr<font color="#000080">(</font>Count<font color="#000080">);
             </font><font color="#FF0000"><b>If </b></font>TempParam<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'-' </font><font color="#FF0000"><b>Then
             Begin
                Case </b></font>upcase<font color="#000080">(</font>TempParam<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>of
                </b></font><font color="#800000">'A'</font><font color="#000080">: </font>ByteMask<font color="#000080">:=</font>ByteMask <font color="#FF0000"><b>OR </b></font>Archive<font color="#000080">;
                </font><font color="#800000">'D'</font><font color="#000080">: </font>ByteMask<font color="#000080">:=</font>ByteMask <font color="#FF0000"><b>OR </b></font>Directory<font color="#000080">;
                </font><font color="#800000">'H'</font><font color="#000080">: </font>ByteMask<font color="#000080">:=</font>ByteMask <font color="#FF0000"><b>OR </b></font>Hidden<font color="#000080">;
                </font><font color="#800000">'R'</font><font color="#000080">: </font>ByteMask<font color="#000080">:=</font>ByteMask <font color="#FF0000"><b>OR </b></font>ReadOnly<font color="#000080">;
                </font><font color="#800000">'S'</font><font color="#000080">: </font>ByteMask<font color="#000080">:=</font>ByteMask <font color="#FF0000"><b>OR </b></font>SysFile<font color="#000080">;
                </font><font color="#800000">'V'</font><font color="#000080">: </font>ByteMasK<font color="#000080">:=</font>ByteMask <font color="#FF0000"><b>OR </b></font>VolumeID<font color="#000080">;
                </font><font color="#FF0000"><b>Else
                    Begin
                    </b></font>Write<font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">));
                    </font>Writeln<font color="#000080">(</font>Paramstr<font color="#000080">(</font>Count<font color="#000080">),</font><font color="#800000">' is not a valid switch !'</font><font color="#000080">);
                    </font>Halt<font color="#000080">;
                    </font><font color="#FF0000"><b>End
                End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>End
             Else
                 Begin
                 </b></font>Write<font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">));
                 </font>Writeln<font color="#000080">(</font>ParamStr<font color="#000080">(</font>Count<font color="#000080">),</font><font color="#800000">' is not recognised as a switch !'</font><font color="#000080">);
                 </font>Halt<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font>FindFirst<font color="#000080">(</font>ParamStr<font color="#000080">(</font>ParamCount<font color="#000080">),</font>AnyFile<font color="#000080">, </font>SearchRc<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>DosError <font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
        Begin
        While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
              Begin
              </b></font>Assign<font color="#000080">(</font>FileToChange<font color="#000080">,</font>SearchRc<font color="#000080">.</font>Name<font color="#000080">);
              </font>GetFAttr<font color="#000080">(</font>FileToChange<font color="#000080">,</font>CurrentByteMask<font color="#000080">);

              </font><font color="#FF0000"><b>If </b></font>CurrentByteMask <font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
                 Begin

                 </b></font>CurrentByteMask<font color="#000080">:=</font>CurrentByteMask <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#800000">65535 </font><font color="#000080">- </font>ByteMask<font color="#000080">);
                 </font><font color="#FF0000"><b>If </b></font>ByteMask <font color="#000080">&lt;&gt;</font><font color="#800000">$2f </font><font color="#FF0000"><b>Then
                    Begin
                    </b></font>Write<font color="#000080">(</font><font color="#800000">'Changed attributes of '</font><font color="#000080">,</font>SearchRc<font color="#000080">.</font>Name<font color="#000080">,</font><font color="#800000">' to '</font><font color="#000080">);
                    </font>BreakDownMask<font color="#000080">(</font>CurrentByteMask<font color="#000080">);
                    </font><font color="#FF0000"><b>End
                 Else
                     </b></font>Write<font color="#000080">(</font><font color="#800000">'Removed all attributes from '</font><font color="#000080">,</font>SearchRc<font color="#000080">.</font>Name<font color="#000080">);

                 </font>SetFAttr<font color="#000080">(</font>FileToChange<font color="#000080">,</font>CurrentByteMask<font color="#000080">);

                 </font><font color="#FF0000"><b>If </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
                    </b></font>Write<font color="#000080">(</font><font color="#800000">' [OK].'</font><font color="#000080">)
                 </font><font color="#FF0000"><b>Else
                     </b></font>Write<font color="#000080">(</font><font color="#800000">'[Access Denied]'</font><font color="#000080">);

                 </font>Writeln<font color="#000080">;

                 </font>FindNext<font color="#000080">(</font>SearchRc<font color="#000080">);
                 </font><font color="#FF0000"><b>End
              Else
                  Begin
                  </b></font>Writeln<font color="#000080">(</font>SearchRc<font color="#000080">.</font>Name<font color="#000080">, </font><font color="#800000">' has no file attributes [OK].'</font><font color="#000080">);
                  </font>FindNext<font color="#000080">(</font>SearchRc<font color="#000080">);
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

        </font>Writeln<font color="#000080">;
        </font>Writeln<font color="#000080">(</font><font color="#800000">'Operation complete.'</font><font color="#000080">);
        </font>Writeln<font color="#000080">;

        </font><font color="#FF0000"><b>End
     Else
         Begin
         </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Could not find the specified file(s) !'</font><font color="#000080">);
         </font>Writeln<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;





</font><font color="#FF0000"><b>Begin
     If </b></font>ParamCount <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
        </b></font>Usage
     <font color="#FF0000"><b>Else
         </b></font>Doattrib<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0091.PAS">Original</a><b>]</b></p></body>
</html>
