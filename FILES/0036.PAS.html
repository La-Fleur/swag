<html>
<head><title> "Another File Hider" by TIMO SALMI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0036.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
ts@uwasa.fi (Timo Salmi)

 Q: How can one hide (or unhide) a directory using a TP Program?

 A: SetFAttr which first comes to mind cannot be used For this.
Instead interrupt Programming is required.  Here is the code.
Incidentally, since MsDos 5.0 the attrib command can be used to hide
and unhide directories.
(* Hide a directory. Before using it would be prudent to check
   that the directory exists, and that it is a directory.
   With a contribution from Jan Nielsen jak@hdc.hha.dk
   Based on information from Duncan (1986), p. 410 *)
}
</i></font><font color="#FF0000"><b>Procedure </b></font>HIDE<font color="#000080">(</font>dirname <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>regs<font color="#000080">, </font>SizeOf<font color="#000080">(</font>regs<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);    </font><font color="#008000"><i>{ standard precaution }
  </i></font>dirname <font color="#000080">:= </font>dirname <font color="#000080">+ </font><font color="#800000">#0</font><font color="#000080">;           </font><font color="#008000"><i>{ requires ASCII Strings }
  </i></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$43</font><font color="#000080">;                    </font><font color="#008000"><i>{ Function }
  </i></font>regs<font color="#000080">.</font>al <font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;                    </font><font color="#008000"><i>{ subFunction }
  </i></font>regs<font color="#000080">.</font>ds <font color="#000080">:= </font>Seg<font color="#000080">(</font>dirname<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);        </font><font color="#008000"><i>{ point to the name }
  </i></font>regs<font color="#000080">.</font>dx <font color="#000080">:= </font>Ofs<font color="#000080">(</font>dirname<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
  </font>regs<font color="#000080">.</font>cx <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">; </font><font color="#008000"><i>{ set bit 1 on }     { to unhide set regs.cx := 0 }
  </i></font>Intr <font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">, </font>regs<font color="#000080">);                  </font><font color="#008000"><i>{ call the interrupt }
  </i></font><font color="#FF0000"><b>if </b></font>regs<font color="#000080">.</font>Flags <font color="#FF0000"><b>and </b></font>FCarry <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{ were we successful }
    </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Failed to hide'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0036.PAS">Original</a><b>]</b></p></body>
</html>
