<html>
<head><title> "Is String in File" by JOHN HOWARD</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0056.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>PROGRAM </b></font>HI_There<font color="#000080">;
</font><font color="#008000"><i>(*   Syntax:  there  textfile  number  /quotedstring
   where textfile is filename, number is a line offset, &amp; quotedstring is a
   group of characters without embedded control codes.  Purpose is to go to a
   given line offset in the text file, search that line for the string, and
   report via DOS error 1=True or 0=False depending upon if it was there.

Example:  there.exe  there.pas  0  /'program'
   would return error level 1 (True) since 'program' is on the first line.

Author:  John Howard                                   Date:  January 5, 1994
Copyright 1994  Howard International,  P.O. Box 34633, NKC, MO 64116

Restrictions:  You are free to use this program but I retain commercial
               ownership.  You may not charge someone to use this program.
Note:          Case sensitive.  Front or Back quote is removed.  No trailing
               whitespace is removed from the string.  Zero-based line offset.
               Returns DOS error level values: 0 thru 4 ******* *)
{$DEFINE debug}
</i></font><font color="#FF0000"><b>VAR
   </b></font>F<font color="#000080">: </font>text<font color="#000080">;          </font><font color="#008000"><i>(* CHAIN.TXT dropfile used by WWIV BBS *)
   </i></font>LineNo<font color="#000080">: </font>word<font color="#000080">;     </font><font color="#008000"><i>(* Line Number from 0..65535 *)
   </i></font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Substring of 1..255 characters *)
   </i></font>CmdLine<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;  </font><font color="#008000"><i>(* string[127] command-line string *)

   </i></font>Test<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;     </font><font color="#008000"><i>(* temporary search line *)
   </i></font>Code<font color="#000080">: </font>integer<font color="#000080">;    </font><font color="#008000"><i>(* temporary result of VAL conversion *)
   </i></font>I<font color="#000080">: </font>word<font color="#000080">;          </font><font color="#008000"><i>(* temporary index of current line *)
   </i></font>B<font color="#000080">: </font>byte<font color="#000080">;          </font><font color="#008000"><i>(* temporary index of command-line string *)
</i></font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{ MAIN }
      {$I-}  (* Turn OFF input/output checking to prevent run-time error *)
      (* Open an existing text file *)
      </i></font>Assign<font color="#000080">(</font>F<font color="#000080">, </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
      </font>Reset<font color="#000080">(</font>F<font color="#000080">);
      </font><font color="#008000"><i>{$I+}  (* Turn ON I/O *)
      </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Halt<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">); </font><font color="#008000"><i>{writeln('File not found');}
      (* Get text from command line and convert into a number *)
      </i></font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">), </font>LineNo<font color="#000080">, </font>Code<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>Code <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Halt<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">); </font><font color="#008000"><i>{writeln('Bad number at position: ', Code);}
      (* Get quoted string or un-broken string. NO end whitespace removed! *)
      </i></font>Move<font color="#000080">(</font>Mem<font color="#000080">[</font>PrefixSeg<font color="#000080">:</font><font color="#800000">$80</font><font color="#000080">], </font>CmdLine<font color="#000080">, </font>Mem<font color="#000080">[</font>PrefixSeg<font color="#000080">:</font><font color="#800000">$80</font><font color="#000080">] + </font><font color="#800000">1</font><font color="#000080">);
      </font>S <font color="#000080">:= </font>CmdLine<font color="#000080">;
</font><font color="#008000"><i>{$IFDEF debug}                  </i></font>writeln<font color="#000080">(</font>S<font color="#000080">);  </font><font color="#008000"><i>{$ENDIF}
      </i></font>B <font color="#000080">:= </font>Pos<font color="#000080">( </font><font color="#800000">'/'</font><font color="#000080">, </font>S<font color="#000080">);
</font><font color="#008000"><i>{$IFDEF debug}                  </i></font>writeln<font color="#000080">(</font><font color="#800000">'CmdLine pos '</font><font color="#000080">, </font>B<font color="#000080">);  </font><font color="#008000"><i>{$ENDIF}
      </i></font>Delete<font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>B<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">#39 </font><font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);                   </font><font color="#008000"><i>(* start quote *)
      </i></font><font color="#FF0000"><b>if </b></font>S<font color="#000080">[</font>Length<font color="#000080">(</font>S<font color="#000080">)] = </font><font color="#800000">#39 </font><font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>S<font color="#000080">, </font>Length<font color="#000080">(</font>S<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);   </font><font color="#008000"><i>(* end quote *)
      </i></font><font color="#FF0000"><b>if </b></font>S <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>Halt<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">); </font><font color="#008000"><i>{writeln('Empty string not allowed');}
{$IFDEF debug}                  </i></font>writeln<font color="#000080">(</font><font color="#800000">'Line: '</font><font color="#000080">, </font>LineNo<font color="#000080">);  </font><font color="#008000"><i>{$ENDIF}
{$IFDEF debug}                  </i></font>writeln<font color="#000080">(</font>S<font color="#000080">);  </font><font color="#008000"><i>{$ENDIF}
      (* Go to specified line within text file *)
      </i></font>I <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>while not </b></font>Eof<font color="#000080">(</font>F<font color="#000080">) </font><font color="#FF0000"><b>do
          begin
          </b></font>Readln<font color="#000080">(</font>F<font color="#000080">, </font>Test<font color="#000080">);
</font><font color="#008000"><i>{$IFDEF debug}                  </i></font>writeln<font color="#000080">(</font>Test<font color="#000080">);  </font><font color="#008000"><i>{$ENDIF}
          </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>I <font color="#000080">= </font>LineNo<font color="#000080">) </font><font color="#FF0000"><b>then
             begin
             if </b></font>Pos<font color="#000080">(</font>S<font color="#000080">, </font>Test<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
             </b></font><font color="#008000"><i>(* String S matched substr Test at position *)
                </i></font><font color="#FF0000"><b>begin
                </b></font>Close<font color="#000080">(</font>F<font color="#000080">);
</font><font color="#008000"><i>{$IFDEF debug}                  </i></font>writeln<font color="#000080">(</font><font color="#800000">'True '</font><font color="#000080">, </font>I<font color="#000080">);  </font><font color="#008000"><i>{$ENDIF}
                </i></font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);   </font><font color="#008000"><i>(* Return True *)
                </i></font><font color="#FF0000"><b>end
             else
             </b></font><font color="#008000"><i>(* Search string not found *)
                </i></font><font color="#FF0000"><b>begin
                </b></font>Close<font color="#000080">(</font>F<font color="#000080">);
</font><font color="#008000"><i>{$IFDEF debug}                  </i></font>writeln<font color="#000080">(</font><font color="#800000">'False '</font><font color="#000080">, </font>I<font color="#000080">);  </font><font color="#008000"><i>{$ENDIF}
                </i></font>Halt<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);   </font><font color="#008000"><i>(* Return False *)
                </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#008000"><i>(* Move to the next line *)
          </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>I <font color="#000080">&lt; </font><font color="#800000">65535</font><font color="#000080">) </font><font color="#FF0000"><b>then
             </b></font>INC<font color="#000080">(</font>I<font color="#000080">)               </font><font color="#008000"><i>{I := I + 1}
          </i></font><font color="#FF0000"><b>else
             begin
             </b></font>Close<font color="#000080">(</font>F<font color="#000080">);
             </font>Halt<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{while}
      (* Close the existing text file *)
      </i></font>Close<font color="#000080">(</font>F<font color="#000080">);
      </font>Halt<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);     </font><font color="#008000"><i>(* Return False *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.  </font><font color="#008000"><i>{ MAIN }

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0056.PAS">Original</a><b>]</b></p></body>
</html>
