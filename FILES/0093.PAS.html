<html>
<head><title> "Copy Multiple files to any dir" by SCOTT TUNSTALL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0093.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
MULTI COPY

This program will copy multiple files to a specified area. I
hope that this shit works too.

This program cannot copy files to a single file nor can it be
expected to know the difference between a file and a directory;

Therefore you must append a back-slash if copying
into a directory.

Example: To Copy COMMAND.COM into C:\tp7\code\work

You'd use MCOPY COMMAND.COM C:\tp7\code\work\
}

</i></font><font color="#FF0000"><b>Program </b></font>Mcopy<font color="#000080">;

</font><font color="#FF0000"><b>Uses </b></font>dos<font color="#000080">;


</font><font color="#008000"><i>{$R+}


</i></font><font color="#FF0000"><b>Procedure </b></font>Usage<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Multiple File Copier  (C) 1995 Scott Tunstall. '</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Usage :'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'MCOPY &lt;FileSpec1&gt; [..FileSpec2] [..FileSpec3 etc.]  &lt;DestSpec&gt;'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'You can copy as many different types of file in one go as can'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'fit on one line just as long as you specify a destination, '</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'which must ALWAYS be the last parameter.'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Also, make sure that if you are copying to a directory that a &quot;\&quot;'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'is appended to the directory name otherwise the copy will FAIL !.'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Example: C:\WORK should be C:\WORK\ with this program.'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Error<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'You need to specify at least two parameters, a source and a'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'destination! '</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Type MCOPY ? for help.'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;






</font><font color="#FF0000"><b>Function </b></font>CopyFile<font color="#000080">(</font>SourceFile<font color="#000080">, </font>TargetFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{ Return codes:  0 successful
                 1 source and target the same
                 2 cannot open source
                 3 unable to create target
                 4 error during copy
}
</i></font><font color="#FF0000"><b>Var
  </b></font>Source<font color="#000080">,
  </font>Target  <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
  </font>BRead<font color="#000080">,
  </font>BWrite  <font color="#000080">: </font>Word<font color="#000080">;
  </font>FileBuf <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2048</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  If </b></font>SourceFile <font color="#000080">= </font>TargetFile <font color="#FF0000"><b>then
  begin
    </b></font>CopyFile <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Assign<font color="#000080">(</font>Source<font color="#000080">,</font>SourceFile<font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>Reset<font color="#000080">(</font>Source<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>CopyFile <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



  </font>Assign<font color="#000080">(</font>Target<font color="#000080">,</font>TargetFile<font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>ReWrite<font color="#000080">(</font>Target<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>CopyFile <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Repeat
    </b></font>BlockRead<font color="#000080">(</font>Source<font color="#000080">,</font>FileBuf<font color="#000080">,</font>SizeOf<font color="#000080">(</font>FileBuf<font color="#000080">),</font>BRead<font color="#000080">);
    </font>BlockWrite<font color="#000080">(</font>Target<font color="#000080">,</font>FileBuf<font color="#000080">,</font>Bread<font color="#000080">,</font>BWrite<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Bread <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Bread <font color="#000080">&lt;&gt; </font>BWrite<font color="#000080">);
  </font>Close<font color="#000080">(</font>Source<font color="#000080">);
  </font>Close<font color="#000080">(</font>Target<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Bread <font color="#000080">&lt;&gt; </font>BWrite <font color="#FF0000"><b>then
    </b></font>CopyFile <font color="#000080">:= </font><font color="#800000">4
  </font><font color="#FF0000"><b>else
    </b></font>CopyFile <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{of func CopyFile}




</i></font><font color="#FF0000"><b>Procedure </b></font>BeginCopying<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>DestinationSpec<font color="#000080">: </font>PathStr<font color="#000080">;
    </font>SourceCount<font color="#000080">: </font>byte<font color="#000080">;
    </font>SourceFileSpec<font color="#000080">: </font>PathStr<font color="#000080">;
    </font>SearchRecord<font color="#000080">: </font>SearchRec<font color="#000080">;
    </font>Errorcode<font color="#000080">: </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>DestinationSpec<font color="#000080">:=</font>ParamStr<font color="#000080">(</font>ParamCount<font color="#000080">);

     </font><font color="#FF0000"><b>For </b></font>SourceCount<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ParamCount<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
         Begin
         </b></font>SourceFileSpec<font color="#000080">:=</font>ParamStr<font color="#000080">(</font>SourceCount<font color="#000080">);
         </font>FindFirst<font color="#000080">(</font>SourceFileSpec<font color="#000080">,</font><font color="#800000">$27</font><font color="#000080">,</font>SearchRecord<font color="#000080">);

         </font><font color="#FF0000"><b>If </b></font>DosError <font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            Begin
            </b></font>Writeln<font color="#000080">;
            </font>Writeln<font color="#000080">(</font><font color="#800000">'Cannot open source file(s) !'</font><font color="#000080">);
            </font>Writeln<font color="#000080">;
            </font><font color="#FF0000"><b>End
         Else
             Begin
             Repeat
                   </b></font>Write<font color="#000080">(</font>SearchRecord<font color="#000080">.</font>Name<font color="#000080">,</font><font color="#800000">'..'</font><font color="#000080">);
                   </font>ErrorCode<font color="#000080">:=</font>CopyFile<font color="#000080">(</font>SearchRecord<font color="#000080">.</font>Name<font color="#000080">,</font>DestinationSpec<font color="#000080">+</font>SearchRecord<font color="#000080">.</font>Name<font color="#000080">);

                   </font><font color="#FF0000"><b>If </b></font>ErrorCode<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
                      Begin
                      </b></font>Write<font color="#000080">(</font><font color="#800000">'Error ('</font><font color="#000080">,</font>ErrorCode<font color="#000080">,</font><font color="#800000">') : '</font><font color="#000080">);
                      </font><font color="#FF0000"><b>Case </b></font>ErrorCode <font color="#FF0000"><b>Of
                      </b></font><font color="#800000">1</font><font color="#000080">: </font>Writeln<font color="#000080">(</font><font color="#800000">'Source and destination are the same !'</font><font color="#000080">);
                      </font><font color="#800000">2</font><font color="#000080">: </font>Writeln<font color="#000080">(</font><font color="#800000">'Cannot open source file(s) !'</font><font color="#000080">);
                      </font><font color="#800000">3</font><font color="#000080">: </font>Writeln<font color="#000080">(</font><font color="#800000">'Unable to create destination file(s) !'</font><font color="#000080">);
                      </font><font color="#800000">4</font><font color="#000080">: </font>Writeln<font color="#000080">(</font><font color="#800000">'Copying error. Check disk integrities !'</font><font color="#000080">);
                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>End
                   Else
                       </b></font>Writeln<font color="#000080">(</font><font color="#800000">'copied.'</font><font color="#000080">);


                   </font>FindNext<font color="#000080">(</font>SearchRecord<font color="#000080">);

             </font><font color="#FF0000"><b>Until </b></font>DosError <font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">;

             </font>Writeln<font color="#000080">;
             </font>Writeln<font color="#000080">(</font><font color="#800000">'Operation Complete. '</font><font color="#000080">);
             </font>Writeln<font color="#000080">;
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;




</font><font color="#FF0000"><b>Begin
     If </b></font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">'?' </font><font color="#FF0000"><b>Then
        </b></font>Usage
     <font color="#FF0000"><b>Else
         If </b></font>ParamCount <font color="#000080">&lt;</font><font color="#800000">2 </font><font color="#FF0000"><b>Then
            </b></font>Error
         <font color="#FF0000"><b>Else
             </b></font>BeginCopying<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0093.PAS">Original</a><b>]</b></p></body>
</html>
