<html>
<head><title> "Record Scrolling" by ROBERT MATSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 ms&gt; Does anybody have a database scroling rutine. When I say a database
 ms&gt; scroling rutine I mean that you have som records which is longer than the
 ms&gt; screen and then you need to scroll up or down to view the rest of it.

 ms&gt; In the rutine you should could scroll up and down.

  Here is a copy of a sort of generic viewing routine incorporating most of
the VT100 keyboard commands, including home/end and pgup/pgdn.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>PrintScr<font color="#000080">;

</font><font color="#FF0000"><b>Type
   </b></font>GenFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];

</font><font color="#FF0000"><b>Var
   </b></font>QuitBrowse <font color="#000080">: </font>Boolean<font color="#000080">;
   </font>BalString  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
   </font>M<font color="#000080">, </font>Lin<font color="#000080">, </font>Top <font color="#000080">: </font>Integer<font color="#000080">;
   </font>Com<font color="#000080">, </font>Key <font color="#000080">: </font>Char<font color="#000080">;
   </font>DtaLen   <font color="#000080">: </font>Word<font color="#000080">;
   </font>ViewFile <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>GenFile<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>ClrScr<font color="#000080">;
   </font>QuitBrowse <font color="#000080">:= </font>False<font color="#000080">;
   </font>Top <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

   </font>Assign<font color="#000080">(</font>ViewFile<font color="#000080">,</font><font color="#800000">'yourfile.txt'</font><font color="#000080">);
   </font>Reset<font color="#000080">(</font>ViewFile<font color="#000080">);
   </font>DtaLen <font color="#000080">:= </font>Filesize<font color="#000080">(</font>ViewFile<font color="#000080">) -</font><font color="#800000">1</font><font color="#000080">;

   </font><font color="#FF0000"><b>While Not </b></font>QuitBrowse <font color="#FF0000"><b>Do
     Begin
       For </b></font>Lin <font color="#000080">:= </font>Top <font color="#FF0000"><b>to </b></font><font color="#000080">(</font>Top<font color="#000080">+</font><font color="#800000">24</font><font color="#000080">) </font><font color="#FF0000"><b>Do
         Begin
           </b></font>Seek<font color="#000080">(</font>ViewFile<font color="#000080">,</font>Lin<font color="#000080">);
           </font>Read<font color="#000080">(</font>ViewFile<font color="#000080">,</font>LineData<font color="#000080">);
           </font>RetrLine<font color="#000080">(</font>DtaHandle<font color="#000080">,</font>Lin<font color="#000080">);
           </font>BalString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#80</font><font color="#000080">;
           </font><font color="#FF0000"><b>For </b></font>M <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">80 </font><font color="#FF0000"><b>Do
             </b></font>BalString<font color="#000080">[</font>M<font color="#000080">] := </font>LineData<font color="#000080">[</font>M<font color="#000080">];
           </font>QWrite<font color="#000080">((</font>Lin<font color="#000080">-</font>Top<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>CfgData<font color="#000080">.</font>IFo<font color="#000080">+</font>CfgData<font color="#000080">.</font>IBa<font color="#000080">,</font>BalString<font color="#000080">);
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font>Com <font color="#000080">:= </font>ReadKey<font color="#000080">;
       </font><font color="#FF0000"><b>Case </b></font>Com <font color="#FF0000"><b>Of
         </b></font><font color="#800000">#0</font><font color="#000080">:
            </font><font color="#FF0000"><b>Begin
              </b></font>Key <font color="#000080">:= </font>ReadKey<font color="#000080">;
              </font><font color="#FF0000"><b>Case </b></font>Key <font color="#FF0000"><b>Of
                </b></font><font color="#800000">#73 </font><font color="#000080">: </font><font color="#008000"><i>{ PgUp }
                     </i></font><font color="#FF0000"><b>Begin
                       </b></font>Top <font color="#000080">:= </font>Top <font color="#000080">-</font><font color="#800000">24</font><font color="#000080">;
                       </font><font color="#FF0000"><b>If </b></font>Top <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Top <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#800000">#81 </font><font color="#000080">: </font><font color="#008000"><i>{ PgDn }
                     </i></font><font color="#FF0000"><b>Begin
                       </b></font>Top <font color="#000080">:= </font>Top <font color="#000080">+</font><font color="#800000">24</font><font color="#000080">;
                       </font><font color="#FF0000"><b>If </b></font>Top <font color="#000080">&gt; </font>DtaLen <font color="#FF0000"><b>Then
                          </b></font>Top <font color="#000080">:= </font>DtaLen<font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#800000">#72 </font><font color="#000080">: </font><font color="#008000"><i>{ Up Arrow }
                     </i></font><font color="#FF0000"><b>Begin
                       </b></font>Dec<font color="#000080">(</font>Top<font color="#000080">);
                       </font><font color="#FF0000"><b>If </b></font>Top <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Top <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#800000">#80 </font><font color="#000080">: </font><font color="#008000"><i>{ Dn Arrow }
                     </i></font><font color="#FF0000"><b>Begin
                       </b></font>Inc<font color="#000080">(</font>Top<font color="#000080">);
                       </font><font color="#FF0000"><b>If </b></font>Top <font color="#000080">&gt; </font>DtaLen <font color="#FF0000"><b>Then
                          </b></font>Top <font color="#000080">:= </font>DtaLen<font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#800000">#119</font><font color="#000080">,</font><font color="#800000">#132 </font><font color="#000080">: </font><font color="#008000"><i>{ ^Home / ^PgUp }
                      </i></font>Top <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                </font><font color="#800000">#117</font><font color="#000080">,</font><font color="#800000">#118 </font><font color="#000080">: </font><font color="#008000"><i>{ ^End / ^PgDn }
                      </i></font><font color="#FF0000"><b>Begin
                        </b></font>Top <font color="#000080">:= </font>DtaLen <font color="#000080">-</font><font color="#800000">5</font><font color="#000080">;
                        </font><font color="#FF0000"><b>If </b></font>Top <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Top <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ Case Key }
            </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ Case #0 }

         </i></font><font color="#800000">#27</font><font color="#000080">: </font><font color="#008000"><i>{ ESC }
             </i></font>QuitBrowse <font color="#000080">:= </font>True<font color="#000080">;

       </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ Case Com }
     </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ Procedure PrintScr }


  </i></font>You will<font color="#000080">, </font><font color="#FF0000"><b>of </b></font>course<font color="#000080">, </font>need <font color="#FF0000"><b>to </b></font>modify the parameters <font color="#FF0000"><b>and </b></font>such <font color="#FF0000"><b>to </b></font>fit your own
needs<font color="#000080">. </font><font color="#FF0000"><b>As </b></font>a rule<font color="#000080">, </font>I use this <font color="#FF0000"><b>as </b></font>a pattern <font color="#FF0000"><b>for </b></font>viewing routines<font color="#000080">, </font>adjusting <font color="#FF0000"><b>as
</b></font>required <font color="#FF0000"><b>for </b></font>the <font color="#FF0000"><b>type of </b></font>material being displayed<font color="#000080">.

  </font>Good luck<font color="#000080">,

</font>RB


</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p></body>
</html>
