<html>
<head><title> "FILSHAR3.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">FileSHARinG <font color="#000080">!


</font>When sharing Files concurrently<font color="#000080">, </font>by means <font color="#FF0000"><b>of For </b></font>example a multitasker <font color="#FF0000"><b>or </b></font>a
network<font color="#000080">, </font>it <font color="#FF0000"><b>is </b></font>necessary <font color="#FF0000"><b>to </b></font>use the <font color="#FF0000"><b>File </b></font>sharing <font color="#FF0000"><b>as </b></font>provided by the Dos
command SHARE<font color="#000080">, </font><font color="#FF0000"><b>or as </b></font>provided by a Network shell <font color="#000080">(</font><font color="#FF0000"><b>In </b></font>Novell <font color="#FF0000"><b>File </b></font>sharing <font color="#FF0000"><b>is
</b></font>supported by the network shell <font color="#FF0000"><b>on </b></font>Servers<font color="#000080">, </font><font color="#FF0000"><b>not </b></font>locally<font color="#000080">. </font>Check your network
documentation <font color="#FF0000"><b>For </b></font>more inFormation<font color="#000080">).

</font><font color="#FF0000"><b>File </b></font>sharing <font color="#FF0000"><b>is </b></font>simple <font color="#FF0000"><b>in </b></font>TP<font color="#000080">/</font>BP<font color="#000080">, </font>since the system Variable FileMode defines
<font color="#FF0000"><b>in </b></font>what mode a certain <font color="#FF0000"><b>File is </b></font>opened <font color="#FF0000"><b>in</b></font><font color="#000080">:

</font><font color="#FF0000"><b>Const
   </b></font>fmReadOnly  <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">;  </font><font color="#008000"><i>(* *)
   </i></font>fmWriteOnly <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">;  </font><font color="#008000"><i>(* Only one of these should be used *)
   </i></font>fmReadWrite <font color="#000080">= </font><font color="#800000">$02</font><font color="#000080">;  </font><font color="#008000"><i>(* *)

   </i></font>fmDenyAll   <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">;  </font><font color="#008000"><i>(* together With only one of these  *)
   </i></font>fmDenyWrite <font color="#000080">= </font><font color="#800000">$20</font><font color="#000080">;  </font><font color="#008000"><i>(* *)
   </i></font>fmDenyRead  <font color="#000080">= </font><font color="#800000">$30</font><font color="#000080">;  </font><font color="#008000"><i>(* *)
   </i></font>fmDenyNone  <font color="#000080">= </font><font color="#800000">$40</font><font color="#000080">;  </font><font color="#008000"><i>(* *)

   </i></font>fmNoInherit <font color="#000080">= </font><font color="#800000">$70</font><font color="#000080">;  </font><font color="#008000"><i>(* Set For &quot;No inheritance&quot;         *)


</i></font>Construction the FileMode Variable <font color="#FF0000"><b>is </b></font>easy<font color="#000080">, </font>just add the appropriate values<font color="#000080">:

</font>FileMode<font color="#000080">:=</font>fmReadOnly<font color="#000080">+</font>fmDenyNone<font color="#000080">;
      (</font>Open <font color="#FF0000"><b>File For </b></font>reading only<font color="#000080">, </font>allow read <font color="#FF0000"><b>and </b></font>Write<font color="#000080">.)

</font>FileMode<font color="#000080">:=</font>fmReadWrite<font color="#000080">+</font>fmDenyWrite<font color="#000080">;
      (</font>Open <font color="#FF0000"><b>File For </b></font>both read <font color="#FF0000"><b>and </b></font>Write<font color="#000080">, </font>deny Write<font color="#000080">.)

</font>FileMode<font color="#000080">:=</font>fmReadWrite<font color="#000080">+</font>fmDenyAll<font color="#000080">;
      (</font>Open <font color="#FF0000"><b>File For </b></font>both read <font color="#FF0000"><b>and </b></font>Write<font color="#000080">, </font>deny all<font color="#000080">.)

</font>Say you open the <font color="#FF0000"><b>File in </b></font><font color="#000080">&quot;</font>fmReadWrite<font color="#000080">+</font>fmDenyWrite<font color="#000080">&quot;. </font>This will let you read
<font color="#FF0000"><b>and </b></font>Write freely <font color="#FF0000"><b>in </b></font>the <font color="#FF0000"><b>File</b></font><font color="#000080">, </font><font color="#FF0000"><b>While </b></font>other processes can freely read the <font color="#FF0000"><b>File</b></font><font color="#000080">.
</font><font color="#FF0000"><b>if </b></font>another process tries <font color="#FF0000"><b>to </b></font>open the <font color="#FF0000"><b>File For </b></font>writing<font color="#000080">, </font>that process will get
the error <font color="#000080">&quot;</font>Access denied<font color="#000080">&quot;.

(</font>fmNoInherit <font color="#FF0000"><b>is </b></font>seldom used <font color="#000080">- </font>it defines <font color="#FF0000"><b>if </b></font>a childprocess spawn from your
process will be able <font color="#FF0000"><b>to </b></font>use the Filehandle provided by your process<font color="#000080">.)

</font>The FileMode Variable <font color="#FF0000"><b>is </b></font>only used when the <font color="#FF0000"><b>File is </b></font>opened<font color="#000080">;

 ...
</font>Assign<font color="#000080">(</font>F<font color="#000080">,</font>FileName<font color="#000080">);
</font>FileMode<font color="#000080">:=</font>fmReadOnly<font color="#000080">+</font>fmDenyNone<font color="#000080">;
</font>Reset<font color="#000080">(</font>F<font color="#000080">);
</font>FileMode<font color="#000080">:=&lt;</font>Whatever<font color="#000080">&gt;    </font><font color="#008000"><i>(* Changing FileMode here does not affect the
                           Files already opened *)

</i></font>By <font color="#FF0000"><b>default</b></font><font color="#000080">, </font>FileMode <font color="#FF0000"><b>is </b></font>defined <font color="#FF0000"><b>as </b></font>FileMode<font color="#000080">:=</font><font color="#800000">$02 </font><font color="#FF0000"><b>in </b></font>TP<font color="#000080">/</font>BP<font color="#000080">, </font>this <font color="#FF0000"><b>is </b></font>referred
<font color="#FF0000"><b>to as </b></font><font color="#000080">&quot;</font>Compatibility mode<font color="#000080">&quot; </font><font color="#FF0000"><b>in </b></font>the TP<font color="#000080">/</font>BP docs<font color="#000080">. </font>Two processes accessing the
same <font color="#FF0000"><b>File With </b></font>this Filemode results <font color="#FF0000"><b>in </b></font>the critical error <font color="#000080">&quot;</font>Sharing
violation<font color="#000080">&quot;.
----------------------------------------------------------------------
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p></body>
</html>
