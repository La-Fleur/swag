<html>
<head><title> "Convert ICO file to INC file" by AVONTURE CHRISTOPHE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0099.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{

   The purpose  of this  program is to  convert an ICON  into an  INC file.




               &Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;
               &ordm;                                        &ordm;&deg;
               &ordm;          AVONTURE CHRISTOPHE           &ordm;&deg;
               &ordm;              AVC SOFTWARE              &ordm;&deg;
               &ordm;     BOULEVARD EDMOND MACHTENS 157/53   &ordm;&deg;
               &ordm;           B-1080 BRUXELLES             &ordm;&deg;
               &ordm;              BELGIQUE                  &ordm;&deg;
               &ordm;                                        &ordm;&deg;
               &Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;&deg;
               &deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;

}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>No_Extension <font color="#000080">(</font>st <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>wExtension <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

   </b></font>wExtension <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>st<font color="#000080">);
   </font>Delete <font color="#000080">(</font>St<font color="#000080">, </font>wExtension<font color="#000080">, </font>Length<font color="#000080">(</font>st<font color="#000080">));
   </font>No_Extension <font color="#000080">:= </font>st<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>CONST

   </b></font>IcoSize  <font color="#000080">= </font><font color="#800000">766</font><font color="#000080">;
   </font>FileName <font color="#000080">= </font><font color="#800000">'TEST.ICO'</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
   </b></font>Buffer <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>IcoSize<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>fIco    <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>Buffer<font color="#000080">;
   </font>fSource <font color="#000080">: </font>Text<font color="#000080">;
   </font>Buf     <font color="#000080">: ^</font>Buffer<font color="#000080">;
   </font>I       <font color="#000080">: </font>Word<font color="#000080">;


</font><font color="#FF0000"><b>BEGIN

   IF </b></font>PARAMCOUNT<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      BEGIN
         </b></font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
         </font>Writeln <font color="#000080">(</font><font color="#800000">'AVC Software (c) AVONTURE Christophe'</font><font color="#000080">);
         </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
         </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
         </font>Writeln <font color="#000080">(</font><font color="#800000">'Convert an ICO file to a pascal source file.'</font><font color="#000080">);
         </font>Writeln <font color="#000080">(</font><font color="#800000">'Type ICO2PAS followed by the name of the ICO (extension must be there).'</font><font color="#000080">);
         </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
         </font>Writeln <font color="#000080">(</font><font color="#800000">'  Example  ICO2PAS WINWORD.ICO will create a WINWORD.INC file'</font><font color="#000080">);
         </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
         </font>Halt<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font>GetMem <font color="#000080">(</font>Buf<font color="#000080">, </font>IcoSize<font color="#000080">);

   </font>Assign <font color="#000080">(</font>fIco<font color="#000080">, </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
   </font>FileMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>Reset <font color="#000080">(</font>fIco<font color="#000080">);

   </font>Read <font color="#000080">(</font>fIco<font color="#000080">, </font>Buf<font color="#000080">^);

   </font>Close <font color="#000080">(</font>fIco<font color="#000080">);


   </font>Assign <font color="#000080">(</font>fSource<font color="#000080">, </font>No_Extension <font color="#000080">(</font>FileName<font color="#000080">)+</font><font color="#800000">'.INC'</font><font color="#000080">);
   </font>FIleMode <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font>Rewrite <font color="#000080">(</font>fSource<font color="#000080">);

   </font>Writeln <font color="#000080">(</font>fSource<font color="#000080">, </font><font color="#800000">'Const '</font><font color="#000080">+</font>No_Extension <font color="#000080">(</font>FileName<font color="#000080">)+</font><font color="#800000">'_ICO : Array[1..766] of Byte ='</font><font color="#000080">);

   </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>IcoSize<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO
      IF </b></font>I <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
         </b></font>Write <font color="#000080">(</font>fSource<font color="#000080">, </font><font color="#800000">'           ('</font><font color="#000080">, </font>Buf<font color="#000080">^[</font>I<font color="#000080">],</font><font color="#800000">','</font><font color="#000080">)
      </font><font color="#FF0000"><b>ELSE IF </b></font>I <font color="#FF0000"><b>Mod </b></font><font color="#800000">20 </font><font color="#000080">= </font><font color="#800000">19 </font><font color="#FF0000"><b>THEN
         BEGIN
            </b></font>Writeln <font color="#000080">(</font>fSource<font color="#000080">, </font>Buf<font color="#000080">^[</font>I<font color="#000080">],</font><font color="#800000">','</font><font color="#000080">);
            </font>Write <font color="#000080">(</font>fSource<font color="#000080">, </font><font color="#800000">'            '</font><font color="#000080">);
         </font><font color="#FF0000"><b>END
      ELSE
         </b></font>Write <font color="#000080">(</font>fSource<font color="#000080">, </font>Buf<font color="#000080">^[</font>I<font color="#000080">],</font><font color="#800000">','</font><font color="#000080">);

   </font>Write <font color="#000080">(</font>fSource<font color="#000080">, </font>Buf<font color="#000080">^[</font>IcoSize<font color="#000080">],</font><font color="#800000">');'</font><font color="#000080">);

   </font>Close <font color="#000080">(</font>fSource<font color="#000080">);

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0099.PAS">Original</a><b>]</b></p></body>
</html>
