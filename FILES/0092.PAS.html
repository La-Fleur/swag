<html>
<head><title> "Multiple File Delete" by SCOTT TUNSTALL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0092.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
DELM - Multiple delete

(C) 1996 Scott Tunstall.

Without entering any crap utils like CO, DR etc you can do this
straight from the command line.. nice 'n' easy !! :)

}


</i></font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Usage<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'DELM - Delete Multiple Files quickly via command line.'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'(C) 1996 Scott Tunstall. All rights reserved.'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Usage :'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'DELM &lt;FileSpec1&gt; [FileSpec2] [FileSpec3..]'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#FF0000"><b>Procedure </b></font>RemoveFiles<font color="#000080">(</font>FirstParmToUse<font color="#000080">, </font>EndParm<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Var
    </b></font>Fails<font color="#000080">: </font>byte<font color="#000080">;                </font><font color="#008000"><i>{ No of missed files }
    </i></font>Count<font color="#000080">: </font>byte<font color="#000080">;
    </font>Rec<font color="#000080">: </font>SearchRec<font color="#000080">;
    </font>FileToErase<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>Fails<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>Count<font color="#000080">:=</font>FirstParmToUse <font color="#FF0000"><b>To </b></font>EndParm <font color="#FF0000"><b>do
         Begin
         </b></font>FindFirst<font color="#000080">(</font>ParamStr<font color="#000080">(</font>Count<font color="#000080">), </font><font color="#800000">$2F</font><font color="#000080">, </font>Rec<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>DosError <font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            Begin
            </b></font>Writeln<font color="#000080">(</font><font color="#800000">'No file matches the pattern '</font><font color="#000080">, </font>ParamStr<font color="#000080">(</font>Count<font color="#000080">), </font><font color="#800000">'!'</font><font color="#000080">);
            </font>Inc<font color="#000080">(</font>Fails<font color="#000080">);
            </font><font color="#FF0000"><b>End
         Else
             while </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
             Begin
                  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Deleting '</font><font color="#000080">, </font>Rec<font color="#000080">.</font>Name<font color="#000080">, </font><font color="#800000">'.'</font><font color="#000080">);
                  </font>Assign<font color="#000080">(</font>FileToErase<font color="#000080">, </font>Rec<font color="#000080">.</font>Name<font color="#000080">);
                  </font><font color="#008000"><i>{$i-}
                  </i></font>Erase<font color="#000080">(</font>FileToErase<font color="#000080">);
                  </font><font color="#008000"><i>{$i+}
                  </i></font>FindNext<font color="#000080">(</font>Rec<font color="#000080">);
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>Halt<font color="#000080">(</font>Fails<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;




</font><font color="#FF0000"><b>Begin
     If </b></font>ParamCount <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
        </b></font>Usage
     <font color="#FF0000"><b>Else
         </b></font>RemoveFiles<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>ParamCount<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0092.PAS">Original</a><b>]</b></p></body>
</html>
