<html>
<head><title> "Filedate and Time" by GREG ESTABROOKS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0047.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
ET&gt;How can I change the file's date and time without opening that file??
ET&gt;I appreciate (some) example source code, so I can look how it is done.
ET&gt;Thanks.

 In order to change a files date/timestamp you'll have open the file
 whether you use the TP SetFTime routine or use Int 21h Function 5701
 BUT by Opening it for reading you can change it to whatever you want.
 If you open it for writing then the TimeStamp will automatically be
 changed to whatever the time was when you closed it.

 Here's a little demo that changes the files timestamp to whatever the
 current time is:
 (NOTE this does not test for existance of the file before settingthe time.)}

{*******************************************************************}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>SetFileDateAndTimeDemo<font color="#000080">; </font><font color="#008000"><i>{ Jan 8/93, Greg Estabrooks.        }
</i></font><font color="#FF0000"><b>USES </b></font>CRT<font color="#000080">,                       </font><font color="#008000"><i>{ IMPORT Clrscr,Writeln.            }
     </i></font>DOS<font color="#000080">;                       </font><font color="#008000"><i>{ IMPORT SetFTime,PackTime,DateTime,}
                                { GetTime,GetDate.                  }
</i></font><font color="#FF0000"><b>VAR
   </b></font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100 <font color="#000080">:</font>WORD<font color="#000080">;   </font><font color="#008000"><i>{ Variables to hold current time.   }
   </i></font>Year<font color="#000080">,</font>Mon<font color="#000080">,</font>Day<font color="#000080">,</font>DayoW  <font color="#000080">:</font>WORD<font color="#000080">;   </font><font color="#008000"><i>{ Variables to hold current date.   }
   </i></font>F2Change <font color="#000080">:</font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;              </font><font color="#008000"><i>{ Handle for file to change.        }
   </i></font>NewTime  <font color="#000080">:</font>LONGINT<font color="#000080">;           </font><font color="#008000"><i>{ Longint Holding new Date/Time.    }
   </i></font>FTime    <font color="#000080">:</font>DateTime<font color="#000080">;          </font><font color="#008000"><i>{ For use with packtime.            }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Clrscr<font color="#000080">;                       </font><font color="#008000"><i>{ Clear the screen.                 }
  </i></font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">); </font><font color="#008000"><i>{ Get Current System Time.          }
  </i></font>GetDate<font color="#000080">(</font>Year<font color="#000080">,</font>Mon<font color="#000080">,</font>Day<font color="#000080">,</font>DayoW<font color="#000080">);  </font><font color="#008000"><i>{ Get Current System Date.          }
  </i></font>FTime<font color="#000080">.</font>Year <font color="#000080">:= </font>Year<font color="#000080">;           </font><font color="#008000"><i>{ Assign new year.                  }
  </i></font>FTime<font color="#000080">.</font>Month<font color="#000080">:= </font>Mon<font color="#000080">;            </font><font color="#008000"><i>{ Assign new month.                 }
  </i></font>FTime<font color="#000080">.</font>Day <font color="#000080">:= </font>Day<font color="#000080">;             </font><font color="#008000"><i>{ Assign New Day.                   }
  </i></font>FTime<font color="#000080">.</font>Hour<font color="#000080">:= </font>Hour<font color="#000080">;            </font><font color="#008000"><i>{ Assign New hour.                  }
  </i></font>FTime<font color="#000080">.</font>Min <font color="#000080">:= </font>Min<font color="#000080">;             </font><font color="#008000"><i>{ Assign New Minute.                }
  </i></font>FTime<font color="#000080">.</font>Sec <font color="#000080">:= </font>Sec<font color="#000080">;             </font><font color="#008000"><i>{ Assign New Seconds.               }
  </i></font>PackTime<font color="#000080">(</font>FTime<font color="#000080">,</font>NewTime<font color="#000080">);      </font><font color="#008000"><i>{ Now covert Time/Date to a longint.}
  </i></font>Assign<font color="#000080">(</font>F2Change<font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)); </font><font color="#008000"><i>{ Assign file handle to file to change.}
  </i></font>Reset<font color="#000080">(</font>F2Change<font color="#000080">);              </font><font color="#008000"><i>{ Open file for reading.            }
  </i></font>SetFTime<font color="#000080">(</font>F2Change<font color="#000080">,</font>NewTime<font color="#000080">);   </font><font color="#008000"><i>{ Now change to our time.           }
  </i></font>Close<font color="#000080">(</font>F2Change<font color="#000080">);              </font><font color="#008000"><i>{ Close File.                       }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font><font color="#008000"><i>{SetFileDateAndTimeDemo}
{*******************************************************************}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0047.PAS">Original</a><b>]</b></p></body>
</html>
