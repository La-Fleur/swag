<html>
<head><title> "File date & time stamp unit" by ALBERT L. FOWLER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0098.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ I made this to time stamp my programs with a time stamp giving the
  version no.  Much of it is courtesy of SWAG and TP6's on line help.

  Use, improve, modify or whatever, but at one's own risk.

                             Albert L. Fowler.
                             Kircaldy, Scotland                    }
{------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>Program </b></font>time_and_date_stamp_the_passed_file<font color="#000080">;      </font><font color="#008000"><i>{ stamp_it.pas }

(*  A file date and time stamping facility.

                 By A. L. Fowler 10th November 1996 *)

</i></font><font color="#FF0000"><b>Uses
</b></font>Dos<font color="#000080">, </font>Crt<font color="#000080">, </font>List_A<font color="#000080">;      </font><font color="#008000"><i>{ for List_A.pas see below }

</i></font><font color="#FF0000"><b>Var
  </b></font>hrs<font color="#000080">, </font>mins    <font color="#000080">: </font>Word<font color="#000080">;        </font><font color="#008000"><i>{ to set time stamp }


</i></font><font color="#FF0000"><b>Function </b></font>LeadingZero <font color="#000080">(</font>w <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>s     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Str <font color="#000080">(</font>w <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">, </font>s<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Length <font color="#000080">(</font>s<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
     </b></font>s <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>s<font color="#000080">;
  </font>LeadingZero <font color="#000080">:= </font>s<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>header<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GotoXY <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font>TextColor <font color="#000080">(</font><font color="#800000">14</font><font color="#000080">);
  </font>Write <font color="#000080">(</font><font color="#800000">'STAMP_IT A File Time &amp; Date Updating Facility.  By  A. L. Fowler. 1996'</font><font color="#000080">);
  </font>NormVideo<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>check_passed_param<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>s     <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
  </font>f     <font color="#000080">: </font>Text<font color="#000080">;
  </font>ft    <font color="#000080">: </font>LongInt<font color="#000080">;            </font><font color="#008000"><i>{ For Get/SetFTime }
  </i></font>dt    <font color="#000080">: </font>DateTime<font color="#000080">;        </font><font color="#008000"><i>{ For Pack/UnpackTime }


</i></font><font color="#FF0000"><b>Begin
  </b></font>GetDir <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>s<font color="#000080">);             </font><font color="#008000"><i>{ 0 = Current drive }
  </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>ParamCount <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
     Begin
     </b></font>header<font color="#000080">;
     </font>GotoXY <font color="#000080">(</font><font color="#800000">14</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
     </font>TextColor <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
     </font>Write <font color="#000080">(</font><font color="#800000">'STAMP_IT  Does not have a following filename'</font><font color="#000080">);
     </font>GotoXY <font color="#000080">(</font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">);
     </font>Write <font color="#000080">(</font><font color="#800000">'e.g.  '</font><font color="#000080">, </font>s<font color="#000080">, </font><font color="#800000">'\STAMP_IT  [drive:][path][filename]'</font><font color="#000080">);
     </font>NormVideo<font color="#000080">;
     </font>GotoXY <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">);
     </font>Halt <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>If Not </b></font>FileExists <font color="#000080">(</font>ParamStr <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) ) </font><font color="#FF0000"><b>Then
     Begin
     </b></font>header<font color="#000080">;
     </font>TextColor <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
     </font>GotoXY <font color="#000080">(</font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
     </font>Write <font color="#000080">(</font><font color="#800000">'  File  '</font><font color="#000080">, </font>UpperCase <font color="#000080">(</font>ParamStr <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) ), </font><font color="#800000">'  not found.'</font><font color="#000080">);
     </font>GotoXY <font color="#000080">(</font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">);
     </font>Write <font color="#000080">(</font><font color="#800000">'Syntax  '</font><font color="#000080">, </font>s<font color="#000080">, </font><font color="#800000">'\STAMP_IT  [drive:][path][filename]'</font><font color="#000080">);
     </font>NormVideo<font color="#000080">;
     </font>GotoXY <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">);
     </font>Halt <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
     </font><font color="#FF0000"><b>End
  Else
     </b></font>GotoXY <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
  </font>TextColor <font color="#000080">(</font><font color="#800000">11</font><font color="#000080">);
  </font>Write <font color="#000080">(</font>UpperCase <font color="#000080">(</font>ParamStr <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) ) );

  </font>Assign <font color="#000080">(</font>f<font color="#000080">, </font>ParamStr <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) );
  </font>Reset <font color="#000080">(</font>f<font color="#000080">);                 </font><font color="#008000"><i>{ Open specified File }
  </i></font>GetFTime <font color="#000080">(</font>f<font color="#000080">, </font>ft<font color="#000080">);            </font><font color="#008000"><i>{ Get creation time }
  </i></font>UnpackTime <font color="#000080">(</font>ft<font color="#000080">, </font>dt<font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>dt <font color="#FF0000"><b>Do
       Begin
       </b></font>Write <font color="#000080">(</font><font color="#800000">' [ Time Stamped '</font><font color="#000080">, </font>LeadingZero <font color="#000080">(</font>hour<font color="#000080">), </font><font color="#800000">':'</font><font color="#000080">, </font>LeadingZero <font color="#000080">(</font>min<font color="#000080">),
       </font><font color="#800000">':'</font><font color="#000080">, </font>LeadingZero <font color="#000080">(</font>sec<font color="#000080">), </font><font color="#800000">' &amp; Dated '</font><font color="#000080">, </font>day<font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font>month<font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font>year<font color="#000080">, </font><font color="#800000">' ]'</font><font color="#000080">);
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>GotoXY <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
  </font>WriteLn <font color="#000080">(</font><font color="#800000">'Will be Stamped with Today''s Date &amp; given a Time Stamp you can choose.'</font><font color="#000080">);
  </font>NormVideo<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>choose_time_stamp<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>yn<font color="#000080">, </font>ap<font color="#000080">, </font>Confirm      <font color="#000080">: </font>Char<font color="#000080">;
  </font>_h<font color="#000080">,  </font>_m    <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>c<font color="#000080">, </font>h<font color="#000080">, </font>inp  <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Label
  </b></font>again<font color="#000080">, </font>h1<font color="#000080">, </font>m1<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>hrs  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>mins <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>_h  <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">;
  </font>_m  <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">;

  </font>FlushKeyBuffer<font color="#000080">;
  </font>again <font color="#000080">:
  </font>GotoXY <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">);
  </font>TextColor <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
  </font>Write <font color="#000080">(</font><font color="#800000">'Is the Default Time Stamp of 12:01a Acceptable?  Y/N  '</font><font color="#000080">);
  </font>CursorOff<font color="#000080">;
  </font>yn <font color="#000080">:= </font>ReadKey<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>yn <font color="#000080">= </font><font color="#800000">#13 </font><font color="#FF0000"><b>Then
     Goto </b></font>again<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>yn <font color="#000080">= </font><font color="#800000">#27 </font><font color="#FF0000"><b>Then
     Begin
     </b></font>CursorOn<font color="#000080">;
     </font>NormVideo<font color="#000080">;
     </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">);
     </font>Halt <font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">( </font>UpCase <font color="#000080">(</font>yn<font color="#000080">) </font><font color="#FF0000"><b>In </b></font><font color="#000080">[ </font><font color="#800000">'N'</font><font color="#000080">, </font><font color="#800000">'Y'</font><font color="#000080">] )  </font><font color="#FF0000"><b>Then
     Begin                       </b></font><font color="#008000"><i>{ Only accept y or n }
     </i></font>Alarm<font color="#000080">;
     </font><font color="#FF0000"><b>Goto </b></font>again<font color="#000080">;
     </font><font color="#FF0000"><b>End
  Else

     If </b></font>UpCase <font color="#000080">(</font>yn<font color="#000080">) = </font><font color="#800000">'N' </font><font color="#FF0000"><b>Then            </b></font><font color="#008000"><i>{ User time stamp requested }

    </i></font><font color="#FF0000"><b>Begin   </b></font><font color="#008000"><i>{ of user input }

    </i></font>h1 <font color="#000080">:        </font><font color="#008000"><i>{ Do not accept nul or error input }
    </i></font>GotoXY <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
    </font>Write <font color="#000080">(</font><font color="#800000">'Enter hours. '</font><font color="#000080">);
    </font>ReadLn <font color="#000080">(</font>_h<font color="#000080">);

    </font><font color="#FF0000"><b>If </b></font>_h  <font color="#000080">= </font><font color="#800000">'0' </font><font color="#FF0000"><b>Then
       </b></font>_h <font color="#000080">:= </font><font color="#800000">'00'</font><font color="#000080">;                </font><font color="#008000"><i>{ ok its a bodge }

    </i></font><font color="#FF0000"><b>If </b></font>Ord <font color="#000080">(</font>_h <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &gt;= </font><font color="#800000">3 </font><font color="#FF0000"><b>Then     </b></font><font color="#008000"><i>{ oversize hours inputs }
       </i></font><font color="#FF0000"><b>Begin
       </b></font>GotoXY <font color="#000080">(</font><font color="#800000">17</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
       </font>Write <font color="#000080">(</font><font color="#800000">'           Input not recognised, enter again.   '</font><font color="#000080">);
       </font>Alarm<font color="#000080">;
       </font><font color="#FF0000"><b>Goto </b></font>h1<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#008000"><i>{ First delete any leading zeros in the hours string }
    </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Ord <font color="#000080">(</font>_h <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &gt;=  </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>_h <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'0'</font><font color="#000080">) </font><font color="#FF0000"><b>Then
       </b></font>_h <font color="#000080">:= </font>Copy <font color="#000080">(</font>_h<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font>Ord <font color="#000080">(</font>_h <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) - </font><font color="#800000">1</font><font color="#000080">);

    </font>Val <font color="#000080">(</font>_h<font color="#000080">, </font>hrs<font color="#000080">,  </font>c<font color="#000080">);                    </font><font color="#008000"><i>{ Convert to hrs }
    </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>c <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">( </font>hrs <font color="#000080">&gt; </font><font color="#800000">23 </font><font color="#000080">) </font><font color="#FF0000"><b>Then    </b></font><font color="#008000"><i>{ Rubbish inputs }
       </i></font><font color="#FF0000"><b>Begin
       </b></font>GotoXY <font color="#000080">(</font><font color="#800000">17</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
       </font>Write <font color="#000080">(</font><font color="#800000">'           Hours  in the Range 0 to 23 please.  '</font><font color="#000080">);
       </font>Alarm<font color="#000080">;
       </font><font color="#FF0000"><b>Goto </b></font>h1<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font>m1 <font color="#000080">:            </font><font color="#008000"><i>{ Do not accept nul or error input }
    </i></font>GotoXY <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">);
    </font>Write <font color="#000080">(</font><font color="#800000">'Enter mins.  '</font><font color="#000080">);
    </font>ReadLn <font color="#000080">(</font>_m<font color="#000080">);

    </font><font color="#FF0000"><b>If </b></font>_m  <font color="#000080">= </font><font color="#800000">'0' </font><font color="#FF0000"><b>Then
       </b></font>_m <font color="#000080">:= </font><font color="#800000">'00'</font><font color="#000080">;              </font><font color="#008000"><i>{ ok its another bodge }

    </i></font><font color="#FF0000"><b>If </b></font>Ord <font color="#000080">(</font>_m <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &gt;= </font><font color="#800000">3 </font><font color="#FF0000"><b>Then   </b></font><font color="#008000"><i>{ oversize mins inputs }
       </i></font><font color="#FF0000"><b>Begin
       </b></font>GotoXY <font color="#000080">(</font><font color="#800000">17</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">);
       </font>Write <font color="#000080">(</font><font color="#800000">'           Input not recognised, enter again.   '</font><font color="#000080">);
       </font>Alarm<font color="#000080">;
       </font><font color="#FF0000"><b>Goto </b></font>m1<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#008000"><i>{ First delete any leading zeros in the mins string }
    </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Ord <font color="#000080">(</font>_m <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &gt;=  </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>_m <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'0'</font><font color="#000080">) </font><font color="#FF0000"><b>Then
       </b></font>_m <font color="#000080">:= </font>Copy <font color="#000080">(</font>_m<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font>Ord <font color="#000080">(</font>_m <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) - </font><font color="#800000">1</font><font color="#000080">);

    </font>Val <font color="#000080">(</font>_m<font color="#000080">, </font>mins<font color="#000080">, </font>c<font color="#000080">);                            </font><font color="#008000"><i>{ Convert to min }
    </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>c <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">( </font>mins <font color="#000080">&gt; </font><font color="#800000">59 </font><font color="#000080">) </font><font color="#FF0000"><b>Then           </b></font><font color="#008000"><i>{ Rubbish inputs }
       </i></font><font color="#FF0000"><b>Begin
       </b></font>GotoXY <font color="#000080">(</font><font color="#800000">17</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">);
       </font>Write <font color="#000080">(</font><font color="#800000">'           Minutes in the Range 0 to 59 please.  '</font><font color="#000080">);
       </font>Alarm<font color="#000080">;
       </font><font color="#FF0000"><b>Goto </b></font>m1<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;    </font><font color="#008000"><i>{ of user input }

  </i></font><font color="#FF0000"><b>If </b></font>UpCase <font color="#000080">(</font>yn<font color="#000080">) = </font><font color="#800000">'Y' </font><font color="#FF0000"><b>Then       </b></font><font color="#008000"><i>{ User accepts 12:01a }
     </i></font><font color="#FF0000"><b>Begin
     </b></font>_h  <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">;
     </font>Val <font color="#000080">(</font>_h<font color="#000080">, </font>hrs<font color="#000080">,  </font>c<font color="#000080">);        </font><font color="#008000"><i>{ Convert to hrs }
     </i></font>_m  <font color="#000080">:= </font><font color="#800000">'1'</font><font color="#000080">;
     </font>Val <font color="#000080">(</font>_m<font color="#000080">, </font>mins<font color="#000080">, </font>c<font color="#000080">);        </font><font color="#008000"><i>{ Convert to min }
     </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Begin                 </b></font><font color="#008000"><i>{ Section produces time in  am pm format }
  </i></font><font color="#FF0000"><b>If </b></font>hrs <font color="#000080">&lt; </font><font color="#800000">12 </font><font color="#FF0000"><b>Then      </b></font><font color="#008000"><i>{ now convert hrs &amp; mins for user to see }
     </i></font><font color="#FF0000"><b>Begin
     </b></font>ap <font color="#000080">:= </font><font color="#800000">'a'</font><font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font>hrs <font color="#000080">= </font><font color="#800000">0  </font><font color="#FF0000"><b>Then
    </b></font>_h <font color="#000080">:= </font><font color="#800000">'12'</font><font color="#000080">;
     </font><font color="#FF0000"><b>End
  Else
     Begin
     </b></font>ap <font color="#000080">:= </font><font color="#800000">'p'</font><font color="#000080">;
     </font>h <font color="#000080">:= </font>hrs <font color="#000080">- </font><font color="#800000">12</font><font color="#000080">;                </font><font color="#008000"><i>{ to display in am pm format }
     </i></font>Str <font color="#000080">(</font>h<font color="#000080">, </font>_h<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>mins <font color="#000080">&lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>Then
     </b></font>_m <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>_m<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;    </font><font color="#008000"><i>{ am pm on screen information }

  </i></font>GotoXY <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">);
  </font>Write <font color="#000080">(</font><font color="#800000">'File will be Time Stamped '</font><font color="#000080">, </font>_h<font color="#000080">, </font><font color="#800000">':'</font><font color="#000080">, </font>_m<font color="#000080">, </font>ap<font color="#000080">);

  </font>GotoXY <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">14</font><font color="#000080">);
  </font>Write <font color="#000080">(</font><font color="#800000">'Is this acceptable? . . . . Y/N '</font><font color="#000080">);
  </font>Confirm <font color="#000080">:= </font>ReadKey<font color="#000080">;

  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Confirm <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Confirm <font color="#000080">= </font><font color="#800000">#110</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Confirm <font color="#000080">= </font><font color="#800000">#78</font><font color="#000080">) </font><font color="#FF0000"><b>Then
     Begin                     </b></font><font color="#008000"><i>{ Esc , N or n pressed }
     </i></font>GotoXY <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">14</font><font color="#000080">);
     </font>Write <font color="#000080">(</font><font color="#800000">'Exit confirmed, file has not been changed.'</font><font color="#000080">);
     </font>CursorOn<font color="#000080">;
     </font>GotoXY <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">);
     </font>NormVideo<font color="#000080">;
     </font>Halt <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Confirm <font color="#000080">= </font><font color="#800000">#89</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Confirm <font color="#000080">= </font><font color="#800000">#121</font><font color="#000080">) </font><font color="#FF0000"><b>Then
     </b></font>GotoXY <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">);
  </font>CursorOn<font color="#000080">;
  </font>NormVideo<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>stamp_file<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>f     <font color="#000080">: </font>Text<font color="#000080">;
  </font>ftime <font color="#000080">: </font>LongInt<font color="#000080">;                    </font><font color="#008000"><i>{ For Get/SetFTime }
  </i></font>dt    <font color="#000080">: </font>DateTime<font color="#000080">;                   </font><font color="#008000"><i>{ For Pack/UnpackTime }
  </i></font>year<font color="#000080">, </font>month<font color="#000080">, </font>day<font color="#000080">, </font>DofW    <font color="#000080">: </font>Word<font color="#000080">;   </font><font color="#008000"><i>{ for GetDate }

</i></font><font color="#FF0000"><b>Begin
  </b></font>Assign <font color="#000080">(</font>f<font color="#000080">, </font>ParamStr <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) );
  </font>GetDate <font color="#000080">(</font>year<font color="#000080">, </font>month<font color="#000080">, </font>day<font color="#000080">, </font>DofW<font color="#000080">);     </font><font color="#008000"><i>{ Today''s Date  }
  </i></font>Reset <font color="#000080">(</font>f<font color="#000080">);                            </font><font color="#008000"><i>{ Open existing File }
  </i></font>GetFTime <font color="#000080">(</font>f<font color="#000080">, </font>ftime<font color="#000080">);                  </font><font color="#008000"><i>{ Get old creation time }
  </i></font>UnpackTime <font color="#000080">(</font>ftime<font color="#000080">, </font>dt<font color="#000080">);
  </font>GotoXY <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">17</font><font color="#000080">);
  </font>TextColor <font color="#000080">(</font><font color="#800000">11</font><font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>dt <font color="#FF0000"><b>Do
       Begin
       </b></font>Write <font color="#000080">(</font><font color="#800000">'Old File TimeStamp was:  '</font><font color="#000080">, </font>LeadingZero <font color="#000080">(</font>hour<font color="#000080">), </font><font color="#800000">':'</font><font color="#000080">, </font>LeadingZero
       <font color="#000080">(</font>min<font color="#000080">), </font><font color="#800000">':'</font><font color="#000080">, </font>LeadingZero <font color="#000080">(</font>sec<font color="#000080">), </font><font color="#800000">'    Dated:  '</font><font color="#000080">, </font>day<font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font>month<font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font>year<font color="#000080">);

       </font>GetDate <font color="#000080">(</font>year<font color="#000080">, </font>month<font color="#000080">, </font>day<font color="#000080">, </font>DofW<font color="#000080">);   </font><font color="#008000"><i>{ Again to Set/Confirm today's date }
       </i></font>hour <font color="#000080">:= </font>hrs<font color="#000080">;
       </font>min  <font color="#000080">:= </font>mins<font color="#000080">;             </font><font color="#008000"><i>{ These for chosen time stamp }
       </i></font>sec  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

       </font>PackTime <font color="#000080">(</font>dt<font color="#000080">, </font>ftime<font color="#000080">);
       </font>Reset <font color="#000080">(</font>f<font color="#000080">);
       </font><font color="#008000"><i>{ Re-open File For reading otherwise, close will update time }
       </i></font>SetFTime <font color="#000080">(</font>f<font color="#000080">, </font>ftime<font color="#000080">);

       </font>GetFTime <font color="#000080">(</font>f<font color="#000080">, </font>ftime<font color="#000080">);                </font><font color="#008000"><i>{ Get new creation time }
       </i></font>UnpackTime <font color="#000080">(</font>ftime<font color="#000080">, </font>dt<font color="#000080">);
       </font>GotoXY <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">19</font><font color="#000080">);
       </font><font color="#FF0000"><b>With </b></font>dt <font color="#FF0000"><b>Do
        Begin
        </b></font>Write <font color="#000080">(</font><font color="#800000">'New File TimeStamp  is:  '</font><font color="#000080">, </font>LeadingZero <font color="#000080">(</font>hour<font color="#000080">), </font><font color="#800000">':'</font><font color="#000080">,
        </font>LeadingZero <font color="#000080">(</font>min<font color="#000080">),
        </font><font color="#800000">':'</font><font color="#000080">, </font>LeadingZero <font color="#000080">(</font>sec<font color="#000080">), </font><font color="#800000">'    Dated:  '</font><font color="#000080">, </font>day<font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font>month<font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font>year <font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>GotoXY <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">);
  </font>Close <font color="#000080">(</font>f<font color="#000080">);        </font><font color="#008000"><i>{ Close File }
  </i></font>NormVideo<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Begin
  </b></font>ClrScr<font color="#000080">;
  </font>check_passed_param<font color="#000080">;
  </font>header<font color="#000080">;
  </font>choose_time_stamp<font color="#000080">;
  </font>stamp_file<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Unit </b></font>LIST_A<font color="#000080">;

</font><font color="#008000"><i>(* LIST_A a simple list, used in STAMPIT, etc. *)

</i></font><font color="#FF0000"><b>Interface
Uses </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CursorOff<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>CursorOn<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>FlushKeyBuffer<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Alarm<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>FileExists <font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>UpperCase <font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Implementation

</b></font><font color="#008000"><i>{*****************************************************************************}

</i></font><font color="#FF0000"><b>Procedure </b></font>CursorOff<font color="#000080">;
  </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV   ax, $0100
  MOV   cx, $2607
  Int   $10
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CursorOn<font color="#000080">;
  </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV   ax, $0100
  MOV   cx, $0506
  Int   $10
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FlushKeyBuffer<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>recpack <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  With </b></font>recpack <font color="#FF0000"><b>Do
       Begin
       </b></font>ax <font color="#000080">:= (</font><font color="#800000">$0c </font><font color="#FF0000"><b>ShL </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#800000">6</font><font color="#000080">;
       </font>dx <font color="#000080">:= </font><font color="#800000">$00ff</font><font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Intr <font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">, </font>recpack<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;     </font><font color="#008000"><i>{FlushKeyBuffer}


</i></font><font color="#FF0000"><b>Function </b></font>FileExists <font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Returns True if file exists; otherwise, it returns  False.
       Closes the file and exists.  }
</i></font><font color="#FF0000"><b>Var
  </b></font>f <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{$I-}
  </i></font>Assign <font color="#000080">(</font>f<font color="#000080">, </font>FileName<font color="#000080">);
  </font>Reset <font color="#000080">(</font>f<font color="#000080">);
  </font>Close <font color="#000080">(</font>f<font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font>FileExists <font color="#000080">:= (</font>IOResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>FileName <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;      </font><font color="#008000"><i>{ FileExists }


</i></font><font color="#FF0000"><b>Function </b></font>UpperCase <font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Ord <font color="#000080">(</font>s <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>Do
      If </b></font>s <font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">] </font><font color="#FF0000"><b>Then
     </b></font>Dec <font color="#000080">(</font>s <font color="#000080">[</font>I<font color="#000080">], </font><font color="#800000">32</font><font color="#000080">);
  </font>UpperCase <font color="#000080">:= </font>s<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Alarm<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Sound <font color="#000080">(</font><font color="#800000">466</font><font color="#000080">);
  </font>Delay <font color="#000080">(</font><font color="#800000">150</font><font color="#000080">);
  </font>Sound <font color="#000080">(</font><font color="#800000">349</font><font color="#000080">);
  </font>Delay <font color="#000080">(</font><font color="#800000">200</font><font color="#000080">);
  </font>NoSound<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0098.PAS">Original</a><b>]</b></p></body>
</html>
