<html>
<head><title> "File Select Menu" by AVONTURE CHRISTOPHE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0101.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{

   File select menu unit.  Something like a FileListBox unit.

   You can select a file from a listbox and change directory or disk if 
   needed (and allowed by the programmer: see the Attribut propertie.)

   Remarks
   -------

       The (Y1 - Y0) value must be greater than 15.  This means that the
           number of columns of the file select window must be at least of
           16 characters.
       The flTouche will be used in order to know which key the user has
           pressed (13 for Enter key, 59 for F1 key, and so on)
       The Escape key or F10 key will terminate the selection without any
           filename in return of the function

               &Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;
               &ordm;                                        &ordm;&deg;
               &ordm;          AVONTURE CHRISTOPHE           &ordm;&deg;
               &ordm;              AVC SOFTWARE              &ordm;&deg;
               &ordm;     BOULEVARD EDMOND MACHTENS 157/53   &ordm;&deg;
               &ordm;           B-1080 BRUXELLES             &ordm;&deg;
               &ordm;              BELGIQUE                  &ordm;&deg;
               &ordm;                                        &ordm;&deg;
               &Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;&deg;
               &deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;


    This is one of my very best unit.  Please send me a postcard if you find
    it usefull.  Thanks in advance!

    ==&gt; Hey, is there somebody  in the United States of America?  I have &lt;==
    ==&gt; received postcard from severall country but none from the States &lt;==
    ==&gt;                           Be the first!                          &lt;==

}

</i></font><font color="#FF0000"><b>Unit </b></font>FileList<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Const </b></font>FlTouche <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;                 </font><font color="#008000"><i>{ Key that the user has pressed }
      </i></font>FName    <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;                          </font><font color="#008000"><i>{ Selected filename }

</i></font><font color="#FF0000"><b>Type </b></font>Str14 <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">14</font><font color="#000080">];

     </font>FileListP <font color="#000080">= </font><font color="#FF0000"><b>Record
       </b></font>X0<font color="#000080">, </font>X1<font color="#000080">, </font>Y0<font color="#000080">, </font>Y1 <font color="#000080">: </font>Byte<font color="#000080">;                         </font><font color="#008000"><i>{ Window coordinates }
       </i></font>TAttr          <font color="#000080">: </font>Byte<font color="#000080">;                        </font><font color="#008000"><i>{ Color of the window }
       </i></font>TBarre         <font color="#000080">: </font>Byte<font color="#000080">;                    </font><font color="#008000"><i>{ Color of the select bar }
       </i></font>Masque         <font color="#000080">: </font>Str14<font color="#000080">;                   </font><font color="#008000"><i>{ Mask - *.*,  *.BAT, ... }
       </i></font>Attribut       <font color="#000080">: </font>Word<font color="#000080">;    </font><font color="#008000"><i>{ File attribut: only files matching this }
                                              { attribut will be displayed }
       </i></font>ChgRep         <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#008000"><i>{ Do we must return to the original path? }
     </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{ The only public function. }

</i></font><font color="#FF0000"><b>Function </b></font>GetFName <font color="#000080">(</font>Donnees <font color="#000080">: </font>FileListP<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Uses </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>TCadre     <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>Double    <font color="#000080">: </font>Tcadre <font color="#000080">= (</font><font color="#800000">'&Eacute;'</font><font color="#000080">,</font><font color="#800000">'&Iacute;'</font><font color="#000080">,</font><font color="#800000">'&raquo;'</font><font color="#000080">,</font><font color="#800000">'&ordm;'</font><font color="#000080">,</font><font color="#800000">'&ordm;'</font><font color="#000080">,</font><font color="#800000">'&Egrave;'</font><font color="#000080">,</font><font color="#800000">'&Iacute;'</font><font color="#000080">,</font><font color="#800000">'&frac14;'</font><font color="#000080">);
      </font>MaxFich <font color="#000080">= </font><font color="#800000">1024</font><font color="#000080">;                       </font><font color="#008000"><i>{ Max number of displayed file }

</i></font><font color="#FF0000"><b>Var </b></font>NbrFich <font color="#000080">: </font>Byte<font color="#000080">;                                 </font><font color="#008000"><i>{ File number per line }
    </i></font>NbrF    <font color="#000080">: </font>Byte<font color="#000080">;                                     </font><font color="#008000"><i>{ Working variable }
    </i></font>NbrFRep <font color="#000080">: </font>Word<font color="#000080">;                 </font><font color="#008000"><i>{ Number of file find in the directory }
    </i></font>TabF    <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxFich<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Str14<font color="#000080">;              </font><font color="#008000"><i>{ The directory... }
    </i></font>I<font color="#000080">, </font>J    <font color="#000080">: </font>Byte<font color="#000080">;
    </font>DosFich <font color="#000080">: </font>SearchRec<font color="#000080">;
    </font>Rep     <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Disque  <font color="#000080">: </font>Byte<font color="#000080">;
    </font>MaxF    <font color="#000080">: </font>Byte<font color="#000080">;
    </font>X_Barre <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Y_Barre <font color="#000080">: </font>Byte<font color="#000080">;
    </font>wPos     <font color="#000080">: </font>Byte<font color="#000080">;
    </font>TBack   <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Complet <font color="#000080">: </font>Boolean<font color="#000080">;                          </font><font color="#008000"><i>{ Is there several screen? }
    </i></font>RepAct  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>{ This function will return True if the disk exist, false otherwise }

</i></font><font color="#FF0000"><b>Function </b></font>Disque_Exist <font color="#000080">(</font>Disq<font color="#000080">: </font>Byte<font color="#000080">) : </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
             </b></font><font color="#FF00FF">Push Ds

             Cmp Disq, 2                  </font><font color="#008000"><i>{ Test if this is a floppy drive }
             </i></font><font color="#FF00FF">Jbe @@A_or_B

             Mov Ax, 4409h                     </font><font color="#008000"><i>{ Hard disk or network one? }
             </i></font><font color="#FF00FF">Mov Bl, Disq
             Int 21h

             Jc  @@False

             Mov Ax, 1
             Jmp @@Fin

@@A_or_B:    Mov Ah, 44h
             Mov Al, 0Eh
             Mov Bl, Disq
             Int 21h

             Cmp Al, Disq
             Jnz @@False

             Mov Ax, 1

             Jmp @@Fin

@@False:     Mov Ax, 1500h                     </font><font color="#008000"><i>{ Test if the disk is a CD }
             </i></font><font color="#FF00FF">Mov Bx, 0000h
             Int 2Fh

             Xor Ax, Ax

             Cmp Bx, 0
             Jz @@Fin

             Inc Cl
             Cmp Cl, [Disq]
             Jne @@Fin

             Mov Ax, 1

@@Fin:       Pop Ds

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Write a string at the specified screen coordinates and with the given
  color attribut
}

</i></font><font color="#FF0000"><b>Procedure </b></font>WriteStrXY <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>TAttr<font color="#000080">, </font>TBack <font color="#000080">: </font>Word<font color="#000080">; </font>Texte <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Var </b></font>Offset   <font color="#000080">: </font>Word<font color="#000080">;
    </font>i        <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Attr     <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin

    </b></font>offset <font color="#000080">:= </font>Y <font color="#000080">* </font><font color="#800000">160 </font><font color="#000080">+ </font>X <font color="#FF0000"><b>Shl </b></font><font color="#800000">1</font><font color="#000080">;
    </font>Attr <font color="#000080">:= ((</font>TAttr<font color="#000080">+(</font>TBack <font color="#FF0000"><b>Shl </b></font><font color="#800000">4</font><font color="#000080">)) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">);

    </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length <font color="#000080">(</font>Texte<font color="#000080">) </font><font color="#FF0000"><b>do Begin
        </b></font>MemW<font color="#000080">[</font><font color="#800000">$B800</font><font color="#000080">:</font>Offset<font color="#000080">] := </font>Attr <font color="#FF0000"><b>or </b></font>Ord<font color="#000080">(</font>Texte<font color="#000080">[</font>i<font color="#000080">]);
        </font>Inc <font color="#000080">(</font>Offset<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Return the full filename }

</i></font><font color="#FF0000"><b>Function </b></font>TrueName <font color="#000080">(</font>FName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>Regs <font color="#000080">: </font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>Begin

  </b></font>FName <font color="#000080">:= </font>FName <font color="#000080">+ </font><font color="#800000">#0</font><font color="#000080">;

  </font>Regs<font color="#000080">.</font>Ah <font color="#000080">:= </font><font color="#800000">$60</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>Ds <font color="#000080">:= </font>Seg<font color="#000080">(</font>FName<font color="#000080">);
  </font>Regs<font color="#000080">.</font>Si <font color="#000080">:= </font>Ofs<font color="#000080">(</font>FName<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
  </font>Regs<font color="#000080">.</font>Es <font color="#000080">:= </font>Seg<font color="#000080">(</font>Temp<font color="#000080">);
  </font>Regs<font color="#000080">.</font>Di <font color="#000080">:= </font>Ofs<font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
  </font>Intr <font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">, </font>Regs<font color="#000080">);

  </font>DosError <font color="#000080">:= </font>Regs<font color="#000080">.</font>Ax <font color="#000080">* ((</font>Regs<font color="#000080">.</font>Flags <font color="#FF0000"><b>And </b></font>FCarry<font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">7</font><font color="#000080">);

  </font>Temp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#255</font><font color="#000080">;
  </font>Temp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr <font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">#0</font><font color="#000080">, </font>Temp<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);

  </font><font color="#FF0000"><b>If </b></font>DosError <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

  </font>TrueName <font color="#000080">:= </font>Temp<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Read a character on the screen at the specified coordinates
}

</i></font><font color="#FF0000"><b>Procedure </b></font>ReadCar <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>word<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>Attr <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Carac <font color="#000080">: </font>Char<font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>Car      <font color="#000080">: ^</font>char<font color="#000080">;
    </font>Attribut <font color="#000080">: ^</font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin

     </b></font>New <font color="#000080">(</font>car<font color="#000080">);
     </font>Car <font color="#000080">:= </font>ptr <font color="#000080">(</font><font color="#800000">$B800</font><font color="#000080">,(</font>Y<font color="#000080">*</font><font color="#800000">160 </font><font color="#000080">+ </font>X <font color="#FF0000"><b>Shl </b></font><font color="#800000">1</font><font color="#000080">));
     </font>Carac <font color="#000080">:= </font>car<font color="#000080">^;
     </font>New <font color="#000080">(</font>attribut<font color="#000080">);
     </font>Attribut <font color="#000080">:= </font>ptr <font color="#000080">(</font><font color="#800000">$B800</font><font color="#000080">,(</font>Y<font color="#000080">*</font><font color="#800000">160 </font><font color="#000080">+ </font>X <font color="#FF0000"><b>Shl </b></font><font color="#800000">1 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">));
     </font>Attr <font color="#000080">:= </font>attribut<font color="#000080">^;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Draw a cadre
}

</i></font><font color="#FF0000"><b>Procedure </b></font>Cadre <font color="#000080">(</font>ColD<font color="#000080">, </font>LigD<font color="#000080">, </font>ColF<font color="#000080">, </font>LigF<font color="#000080">, </font>Attr<font color="#000080">, </font>Back <font color="#000080">: </font>Byte<font color="#000080">; </font>Cad <font color="#000080">: </font>TCadre<font color="#000080">);

</font><font color="#FF0000"><b>Var
   </b></font>X<font color="#000080">, </font>Y<font color="#000080">, </font>I<font color="#000080">, </font>Longueur<font color="#000080">, </font>Hauteur <font color="#000080">: </font>Byte<font color="#000080">;
   </font>sLine <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin

     </b></font>X <font color="#000080">:= </font>WhereX<font color="#000080">;  </font>Y <font color="#000080">:= </font>WhereY<font color="#000080">;
     </font>Longueur <font color="#000080">:= (</font>ColF<font color="#000080">-</font>ColD<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">;
     </font>Hauteur  <font color="#000080">:= (</font>LigF<font color="#000080">-</font>LigD<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">;

     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">, </font>LigD<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);

     </font>FillChar <font color="#000080">(</font>sLine<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Longueur<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
     </font>sLine <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Longueur<font color="#000080">);
     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>LigD<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>sLine<font color="#000080">);

     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">+</font>Longueur<font color="#000080">, </font>LigD<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]);

     </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Hauteur <font color="#FF0000"><b>Do Begin
         </b></font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">, </font>LigD<font color="#000080">+</font>I<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);

         </font>FillChar <font color="#000080">(</font>sLine<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Longueur<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">);
         </font>sLine <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Longueur<font color="#000080">);
         </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>LigD<font color="#000080">+</font>I<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>sLine<font color="#000080">);

         </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">+</font>Longueur<font color="#000080">, </font>LigD<font color="#000080">+</font>I<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">, </font>LigF<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]);

     </font>FillChar <font color="#000080">(</font>sLine<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Longueur<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">]);
     </font>sLine <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Longueur<font color="#000080">);
     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>LigF<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>sLine<font color="#000080">);

     </font>WriteStrXy <font color="#000080">(</font>ColD<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">+</font>Longueur<font color="#000080">, </font>LigF<font color="#000080">, </font>Attr<font color="#000080">, </font>Back<font color="#000080">, </font>Cad<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">]);

     </font>GotoXy <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Fill the TabF array with the name of each file found in the directory
}

</i></font><font color="#FF0000"><b>Procedure </b></font>SearchCurrentDir <font color="#000080">(</font>Masque <font color="#000080">: </font>Str14<font color="#000080">; </font>Attribut <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#FF0000"><b>Begin

   </b></font>FillChar <font color="#000080">(</font>TabF<font color="#000080">, </font>SizeOf <font color="#000080">(</font>TabF<font color="#000080">), </font><font color="#800000">' '</font><font color="#000080">);             </font><font color="#008000"><i>{ Initialize the array }

   </i></font>I <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font>Disque <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

   </font><font color="#FF0000"><b>If </b></font>Disque_Exist  <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[A:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist  <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[B:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist  <font color="#000080">(</font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[C:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist  <font color="#000080">(</font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[D:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist  <font color="#000080">(</font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[E:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist  <font color="#000080">(</font><font color="#800000">6</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[F:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist  <font color="#000080">(</font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[G:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist  <font color="#000080">(</font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[H:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist  <font color="#000080">(</font><font color="#800000">9</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[I:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[J:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">11</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[K:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">12</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[L:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">13</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[M:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">14</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[N:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">15</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[O:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[P:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">17</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[Q:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">18</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[R:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">19</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[S:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">20</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[T:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">21</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[U:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">22</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[V:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">23</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[W:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">24</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[X:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[Y:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Disque_Exist <font color="#000080">(</font><font color="#800000">26</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'[Z:..]'</font><font color="#000080">; </font>Inc <font color="#000080">(</font>I<font color="#000080">); </font>Inc <font color="#000080">(</font>Disque<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                             </font><font color="#008000"><i>{ Test if we can show path name or only file? }
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Attribut <font color="#FF0000"><b>and </b></font><font color="#800000">16</font><font color="#000080">) = </font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin          </b></font><font color="#008000"><i>{ We can show path name }

      </i></font>Rep <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

      </font>FindFirst <font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font>DosFich<font color="#000080">);

      </font>FindNext <font color="#000080">(</font>DosFich<font color="#000080">);

      </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do Begin

        If </b></font><font color="#000080">(</font>DosFich<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font>Directory <font color="#000080">= </font>Directory<font color="#000080">) </font><font color="#FF0000"><b>then Begin

           </b></font><font color="#008000"><i>{ We have found a directory }

           </i></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">'&lt;'</font><font color="#000080">+</font>DosFich<font color="#000080">.</font>Name<font color="#000080">+</font><font color="#800000">'&gt;'</font><font color="#000080">;

           </font>Inc <font color="#000080">(</font>I<font color="#000080">);

           </font>Inc <font color="#000080">(</font>Rep<font color="#000080">);

        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

        </font>FindNext <font color="#000080">(</font>DosFich<font color="#000080">);

      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#008000"><i>{ Clear the attribute bit of Directory only }

   </i></font>Attribut <font color="#000080">:= </font>Attribut <font color="#FF0000"><b>and not </b></font><font color="#800000">16</font><font color="#000080">;

   </font><font color="#008000"><i>{ Test if we can show file name or not }

   </i></font><font color="#FF0000"><b>If Not </b></font><font color="#000080">(</font>Attribut <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin                </b></font><font color="#008000"><i>{ We can show file name }

     </i></font>FindFirst <font color="#000080">(</font>Masque<font color="#000080">, </font>Attribut<font color="#000080">, </font>DosFich<font color="#000080">);

     </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do Begin

         If Not </b></font><font color="#000080">(</font>DosFich<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font>Attribut <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin
           </b></font>TabF<font color="#000080">[</font>I<font color="#000080">] := </font>DosFich<font color="#000080">.</font>Name<font color="#000080">;
           </font>Inc <font color="#000080">(</font>I<font color="#000080">);
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>FindNext <font color="#000080">(</font>DosFich<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font>NbrFRep <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Write the filename or the path name
}

</i></font><font color="#FF0000"><b>Procedure </b></font>Prompt <font color="#000080">(</font>X <font color="#000080">, </font>Y<font color="#000080">, </font>TAttr <font color="#000080">: </font>Byte<font color="#000080">; </font>Option <font color="#000080">: </font>Str14<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font>GotoXY <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);
   </font>WriteStrXy <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>TAttr<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Option<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Give the possibility to the user to select a name. }

</i></font><font color="#FF0000"><b>Function </b></font>MChoix <font color="#000080">(</font>X0<font color="#000080">, </font>Y0<font color="#000080">, </font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X<font color="#000080">, </font>Y<font color="#000080">, </font>TAttr<font color="#000080">, </font>TBarre <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Handle the select bar
}

</i></font><font color="#FF0000"><b>Procedure </b></font>SurBrillance <font color="#000080">(</font>X<font color="#000080">, </font>TBarre <font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Var </b></font>Attribut <font color="#000080">: </font>Word<font color="#000080">;
    </font>Offset   <font color="#000080">: </font>Word<font color="#000080">;
    </font>i        <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Lig      <font color="#000080">: </font>Str14<font color="#000080">;
    </font>Attr     <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Chh      <font color="#000080">: </font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Begin

     </b></font>offset <font color="#000080">:= </font>Y <font color="#000080">* </font><font color="#800000">160 </font><font color="#000080">+ </font>X <font color="#000080">* </font><font color="#800000">2</font><font color="#000080">;

     </font>Lig <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

     </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>Do Begin
         </b></font>ReadCar <font color="#000080">(</font>X<font color="#000080">+</font>I<font color="#000080">, </font>Y<font color="#000080">, </font>Attr<font color="#000080">, </font>Chh<font color="#000080">);
         </font>Lig <font color="#000080">:= </font>Lig <font color="#000080">+ </font>Chh<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">13 </font><font color="#FF0000"><b>do Begin
         </b></font>MemW<font color="#000080">[</font><font color="#800000">$B800</font><font color="#000080">:</font>Offset<font color="#000080">] := (</font>TBarre <font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font>Ord<font color="#000080">(</font>Lig<font color="#000080">[</font>I<font color="#000080">]);
         </font>Inc <font color="#000080">(</font>Offset<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Construct the screen with the bar and the file/path name
}

</i></font><font color="#FF0000"><b>Procedure </b></font>Affiche <font color="#000080">(</font>X0<font color="#000080">, </font>Y0 <font color="#000080">: </font>Byte<font color="#000080">; </font>Depart <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#FF0000"><b>Begin

   </b></font>GotoXy <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>NbrF <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>wPos <font color="#000080">:= </font>Depart<font color="#000080">;
   </font>X_Barre <font color="#000080">:= </font>X0<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">; </font>Y_Barre <font color="#000080">:= </font>Y0<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;

   </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font>Depart <font color="#FF0000"><b>to </b></font><font color="#000080">(</font>Depart<font color="#000080">+(</font>MaxF<font color="#000080">*</font>NbrFich<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do Begin

      If Not </b></font><font color="#000080">(</font>J <font color="#000080">&gt; </font>NbrFRep<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Prompt <font color="#000080">(</font>X_Barre<font color="#000080">, </font>Y_Barre<font color="#000080">, </font>TAttr<font color="#000080">, </font>TabF<font color="#000080">[</font>J<font color="#000080">]+</font><font color="#800000">'                   '</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else </b></font>Prompt <font color="#000080">(</font>X_Barre<font color="#000080">, </font>Y_Barre<font color="#000080">, </font>TAttr<font color="#000080">, </font><font color="#800000">'                      '</font><font color="#000080">);

      </font>Inc <font color="#000080">(</font>NbrF<font color="#000080">);

      </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">(</font>NbrF <font color="#000080">&lt; </font>NbrFich<font color="#000080">) </font><font color="#FF0000"><b>then Begin

         </b></font>Inc <font color="#000080">(</font>Y_Barre<font color="#000080">);
         </font>X_Barre <font color="#000080">:= </font>X0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
         </font>NbrF <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

      </font><font color="#FF0000"><b>End
      Else </b></font>Inc <font color="#000080">(</font>X_Barre<font color="#000080">, </font><font color="#800000">13</font><font color="#000080">);

   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Main of MChoix function }

</i></font><font color="#FF0000"><b>Var
   </b></font>Ch <font color="#000080">: </font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Begin

   </b></font>GotoXy <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);

   </font>wPos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

   </font>SurBrillance <font color="#000080">(</font>X<font color="#000080">, </font>TBarre<font color="#000080">);

   </font><font color="#FF0000"><b>Repeat

       </b></font>Ch <font color="#000080">:= </font>Readkey<font color="#000080">; </font><font color="#FF0000"><b>If </b></font>Ch <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>then </b></font>Ch <font color="#000080">:= </font>Readkey<font color="#000080">;

       </font>SurBrillance <font color="#000080">(</font>X<font color="#000080">, </font>TAttr<font color="#000080">);

       </font><font color="#FF0000"><b>Case </b></font>Ch <font color="#FF0000"><b>Of

        </b></font><font color="#800000">#72 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>{UpKey}
                 </i></font><font color="#FF0000"><b>If </b></font>Complet <font color="#FF0000"><b>then Begin
                   If </b></font><font color="#000080">(</font>wPos <font color="#000080">- </font>NbrFich <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">&lt; </font>NbrFRep<font color="#000080">) </font><font color="#FF0000"><b>then Begin
                      </b></font>Dec <font color="#000080">(</font>Y<font color="#000080">); </font>Dec <font color="#000080">(</font>wPos<font color="#000080">, </font>NbrFich<font color="#000080">);
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                 </font><font color="#FF0000"><b>End
                 Else
                  If </b></font><font color="#000080">((</font>Y<font color="#000080">-</font><font color="#800000">1 </font><font color="#000080">= </font>Y0<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#000080">(</font>wPos <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">&lt; </font>NbrFich<font color="#000080">))) </font><font color="#FF0000"><b>then Begin
                        </b></font>wPos <font color="#000080">:= </font>wPos <font color="#000080">- (((</font>X <font color="#000080">- </font>X0<font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">13</font><font color="#000080">));
                        </font>Affiche <font color="#000080">(</font>X0<font color="#000080">, </font>Y0<font color="#000080">, </font>Abs<font color="#000080">(</font>wPos<font color="#000080">-(</font>NbrFich<font color="#000080">*</font>MaxF<font color="#000080">)));
                        </font>X <font color="#000080">:= </font>X0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
                        </font>Y <font color="#000080">:= </font>Y0 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                  </font><font color="#FF0000"><b>End
                  Else If Not </b></font><font color="#000080">(</font>wPos <font color="#000080">- </font>NbrFich <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin
                      </b></font>Dec <font color="#000080">(</font>Y<font color="#000080">); </font>Dec <font color="#000080">(</font>wPos<font color="#000080">, </font>NbrFich<font color="#000080">);
                  </font><font color="#FF0000"><b>End
                  Else If Not </b></font><font color="#000080">(</font>wPos <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">&gt; </font>NbrFRep<font color="#000080">) </font><font color="#FF0000"><b>then Begin
                      If </b></font><font color="#000080">(</font>wPos <font color="#000080">- </font>NbrFich <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">&lt; </font>NbrFRep<font color="#000080">) </font><font color="#FF0000"><b>then Begin
                         </b></font>Dec <font color="#000080">(</font>Y<font color="#000080">); </font>Dec <font color="#000080">(</font>wPos<font color="#000080">, </font>NbrFich<font color="#000080">);
                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#800000">#80 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>{DownKey}
                 </i></font><font color="#FF0000"><b>If </b></font>Complet <font color="#FF0000"><b>then Begin
                   If </b></font><font color="#000080">(</font>wPos <font color="#000080">+ </font>NbrFich <font color="#000080">-</font><font color="#800000">1 </font><font color="#000080">&lt; </font>NbrFRep<font color="#000080">) </font><font color="#FF0000"><b>then Begin
                      </b></font>Inc <font color="#000080">(</font>Y<font color="#000080">); </font>inc <font color="#000080">(</font>wPos<font color="#000080">, </font>NbrFich<font color="#000080">);
                   </font><font color="#FF0000"><b>End
                 End
                 Else
                  If </b></font><font color="#000080">(</font>wPos <font color="#000080">+ </font>NbrFich <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">&lt; </font>NbrFich<font color="#000080">*</font>MaxF<font color="#000080">) </font><font color="#FF0000"><b>then Begin
                      </b></font>Inc <font color="#000080">(</font>Y<font color="#000080">); </font>inc <font color="#000080">(</font>wPos<font color="#000080">, </font>NbrFich<font color="#000080">);
                  </font><font color="#FF0000"><b>End
                  Else If </b></font><font color="#000080">(</font>Y<font color="#000080">+</font><font color="#800000">1 </font><font color="#000080">= </font>Y1<font color="#000080">) </font><font color="#FF0000"><b>then Begin
                        </b></font>wPos <font color="#000080">:= </font>wPos <font color="#000080">- (((</font>X <font color="#000080">- </font>X0<font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">13</font><font color="#000080">));
                        </font>Affiche <font color="#000080">(</font>X0<font color="#000080">, </font>Y0<font color="#000080">, </font>wPos<font color="#000080">+</font>NbrFich<font color="#000080">);
                        </font>X <font color="#000080">:= </font>X0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
                        </font>Y <font color="#000080">:= </font>Y0 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                   </font><font color="#FF0000"><b>End
                   Else If Not </b></font><font color="#000080">(</font>wPos <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">&gt; </font>NbrFRep<font color="#000080">) </font><font color="#FF0000"><b>then Begin
                      If </b></font><font color="#000080">(</font>wPos <font color="#000080">+ </font>NbrFich  <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">&lt; </font>NbrFRep<font color="#000080">) </font><font color="#FF0000"><b>then Begin
                         </b></font>Inc <font color="#000080">(</font>Y<font color="#000080">); </font>inc <font color="#000080">(</font>wPos<font color="#000080">, </font>NbrFich<font color="#000080">);
                      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#800000">#77 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>{Right}
                 </i></font><font color="#FF0000"><b>If </b></font>Complet <font color="#FF0000"><b>then Begin
                   If Not </b></font><font color="#000080">(</font>wPos<font color="#000080">+</font><font color="#800000">1 </font><font color="#000080">&gt; </font>NbrFRep<font color="#000080">) </font><font color="#FF0000"><b>then Begin
                     If Not </b></font><font color="#000080">(</font>X <font color="#000080">+ </font><font color="#800000">13 </font><font color="#000080">&gt; (</font>X0<font color="#000080">+(</font>NbrFich<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*(</font><font color="#800000">13</font><font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">)) </font><font color="#FF0000"><b>then Begin
                      </b></font>Inc <font color="#000080">(</font>X<font color="#000080">, </font><font color="#800000">13</font><font color="#000080">); </font>Inc <font color="#000080">(</font>wPos<font color="#000080">);
                     </font><font color="#FF0000"><b>End
                     Else If Not </b></font><font color="#000080">(</font>Y <font color="#000080">&gt; </font>Y0 <font color="#000080">+ (</font>NbrFRep <font color="#FF0000"><b>Div </b></font>NbrFich<font color="#000080">)) </font><font color="#FF0000"><b>then Begin
                       </b></font>X <font color="#000080">:= </font>X0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">; </font>Inc <font color="#000080">(</font>Y<font color="#000080">); </font>Inc <font color="#000080">(</font>wPos<font color="#000080">);
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>End
                 End
                 Else Begin
                   If Not </b></font><font color="#000080">(</font>wPos<font color="#000080">+</font><font color="#800000">1 </font><font color="#000080">&gt; </font>NbrFich<font color="#000080">*</font>MaxF<font color="#000080">) </font><font color="#FF0000"><b>then Begin
                     If Not </b></font><font color="#000080">(</font>X <font color="#000080">+ </font><font color="#800000">13 </font><font color="#000080">&gt; (</font>X0<font color="#000080">+(</font>NbrFich<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*(</font><font color="#800000">13</font><font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">)) </font><font color="#FF0000"><b>then Begin
                      </b></font>Inc <font color="#000080">(</font>X<font color="#000080">, </font><font color="#800000">13</font><font color="#000080">); </font>Inc <font color="#000080">(</font>wPos<font color="#000080">);
                     </font><font color="#FF0000"><b>End
                     Else If Not </b></font><font color="#000080">(</font>Y <font color="#000080">&gt; </font>Y0 <font color="#000080">+ (</font>NbrFich<font color="#000080">*</font>MaxF <font color="#FF0000"><b>Div </b></font>NbrFich<font color="#000080">)) </font><font color="#FF0000"><b>then Begin
                       </b></font>X <font color="#000080">:= </font>X0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">; </font>Inc <font color="#000080">(</font>Y<font color="#000080">); </font>Inc <font color="#000080">(</font>wPos<font color="#000080">);
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>End
                   Else If </b></font><font color="#000080">((</font>Y<font color="#000080">+</font><font color="#800000">1 </font><font color="#000080">= </font>Y1<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((((</font>X <font color="#000080">- </font>X0<font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">13 </font><font color="#000080">) +  </font><font color="#800000">1</font><font color="#000080">) = </font>NbrFich<font color="#000080">)) </font><font color="#FF0000"><b>then Begin
                        </b></font>Affiche <font color="#000080">(</font>X0<font color="#000080">, </font>Y0<font color="#000080">, </font>wPos<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
                        </font>X <font color="#000080">:= </font>X0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
                        </font>Y <font color="#000080">:= </font>Y0 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                   </font><font color="#FF0000"><b>End
                   Else If Not </b></font><font color="#000080">(</font>wPos <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">&gt; </font>NbrFRep<font color="#000080">) </font><font color="#FF0000"><b>then Begin
                     If Not </b></font><font color="#000080">(</font>X <font color="#000080">+ </font><font color="#800000">13 </font><font color="#000080">&gt; (</font>X0<font color="#000080">+(</font>NbrFich<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*(</font><font color="#800000">13</font><font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">)) </font><font color="#FF0000"><b>then Begin
                      </b></font>Inc <font color="#000080">(</font>X<font color="#000080">, </font><font color="#800000">13</font><font color="#000080">); </font>Inc <font color="#000080">(</font>wPos<font color="#000080">);
                     </font><font color="#FF0000"><b>End
                     Else If Not </b></font><font color="#000080">(</font>Y <font color="#000080">&gt; </font>Y0 <font color="#000080">+ (</font>NbrFich<font color="#000080">*</font>MaxF <font color="#FF0000"><b>Div </b></font>NbrFich<font color="#000080">)) </font><font color="#FF0000"><b>then Begin
                       </b></font>X <font color="#000080">:= </font>X0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">; </font>Inc <font color="#000080">(</font>Y<font color="#000080">); </font>Inc <font color="#000080">(</font>wPos<font color="#000080">);
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                 </font><font color="#FF0000"><b>End
              End</b></font><font color="#000080">;
        </font><font color="#800000">#75 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>{Left}
                </i></font><font color="#FF0000"><b>If </b></font>Complet <font color="#FF0000"><b>then Begin
                  If Not </b></font><font color="#000080">(</font>X <font color="#000080">= </font>X0<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin
                     </b></font>Dec <font color="#000080">(</font>X<font color="#000080">, </font><font color="#800000">13</font><font color="#000080">); </font>Dec <font color="#000080">(</font>wPos<font color="#000080">);
                  </font><font color="#FF0000"><b>End
                  Else If Not </b></font><font color="#000080">(</font>Y <font color="#000080">&lt; </font>Y0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin
                     </b></font>X <font color="#000080">:= </font>X0<font color="#000080">+((</font>NbrFich<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*(</font><font color="#800000">13</font><font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">);
                     </font>Dec <font color="#000080">(</font>Y<font color="#000080">); </font>Dec <font color="#000080">(</font>wPos<font color="#000080">);
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>End
                Else
                  If </b></font><font color="#000080">((</font>Y<font color="#000080">-</font><font color="#800000">1 </font><font color="#000080">= </font>Y0<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((((</font>X <font color="#000080">- </font>X0<font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">13</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>and Not </b></font><font color="#000080">(</font>wPos <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then Begin
                        </b></font>wPos <font color="#000080">:= </font>wPos <font color="#000080">- (((</font>X <font color="#000080">- </font>X0<font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">13</font><font color="#000080">));
                        </font>Affiche <font color="#000080">(</font>X0<font color="#000080">, </font>Y0<font color="#000080">, </font>Abs<font color="#000080">(</font>wPos<font color="#000080">-(</font>NbrFich<font color="#000080">*</font>MaxF<font color="#000080">)));
                        </font>X <font color="#000080">:= </font>X0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
                        </font>Y <font color="#000080">:= </font>Y0 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                  </font><font color="#FF0000"><b>End
                  Else If Not </b></font><font color="#000080">(</font>X <font color="#000080">= </font>X0<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin
                       </b></font>Dec <font color="#000080">(</font>wPos<font color="#000080">); </font>Dec <font color="#000080">(</font>X<font color="#000080">, </font><font color="#800000">13</font><font color="#000080">);
                  </font><font color="#FF0000"><b>End
                  Else If Not </b></font><font color="#000080">(</font>Y <font color="#000080">&lt; </font>Y0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin
                     </b></font>X <font color="#000080">:= </font>X0<font color="#000080">+((</font>NbrFich<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*(</font><font color="#800000">13</font><font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">);
                     </font>Dec <font color="#000080">(</font>Y<font color="#000080">); </font>Dec <font color="#000080">(</font>wPos<font color="#000080">);
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

       </font>GotoXy <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);

       </font>SurBrillance <font color="#000080">(</font>X<font color="#000080">, </font>TBarre<font color="#000080">);

       </font><font color="#008000"><i>{ Only Enter key, Escape key or Function key (F1-F10) can stopped
         the selection
       }

   </i></font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">#13</font><font color="#000080">, </font><font color="#800000">#27</font><font color="#000080">, </font><font color="#800000">#59</font><font color="#000080">..</font><font color="#800000">#68</font><font color="#000080">]);

   </font><font color="#008000"><i>{ FLTouche retains the value of the pressed key }

   </i></font>FLTouche <font color="#000080">:= </font>Ord<font color="#000080">(</font>Ch<font color="#000080">);

   </font><font color="#008000"><i>{ If the pressed key is not F10 or Escape then return the filename }

   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Ch <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Ch <font color="#000080">= </font><font color="#800000">#68</font><font color="#000080">)) </font><font color="#FF0000"><b>then </b></font>MChoix <font color="#000080">:= </font><font color="#800000">''
   </font><font color="#FF0000"><b>Else </b></font>MChoix <font color="#000080">:= </font>TabF<font color="#000080">[</font>wPos<font color="#000080">];

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ The only function public.
}

</i></font><font color="#FF0000"><b>Function </b></font>GetFName <font color="#000080">(</font>Donnees <font color="#000080">: </font>FileListP<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>FinJ   <font color="#000080">: </font>Word<font color="#000080">;
    </font>NomRep <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin

   </b></font>TBack <font color="#000080">:= </font>TextAttr<font color="#000080">;

   </font><font color="#FF0000"><b>With </b></font>Donnees <font color="#FF0000"><b>Do Begin

     </b></font>TextAttr <font color="#000080">:= </font>TAttr<font color="#000080">;

     </font><font color="#008000"><i>{ The window must be at least 17 columns great }

     </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>X1 <font color="#000080">- </font>X0 <font color="#000080">&lt; </font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>X1 <font color="#000080">:= </font>X0 <font color="#000080">+ </font><font color="#800000">16</font><font color="#000080">;

     </font><font color="#008000"><i>{ Process the number of file per line }

     </i></font>NbrFich <font color="#000080">:= ((( </font>X1 <font color="#000080">- </font>X0<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">13</font><font color="#000080">);

     </font><font color="#FF0000"><b>Repeat

       </b></font><font color="#008000"><i>{ Show the current directory }

       </i></font>SearchCurrentDir <font color="#000080">(</font>Masque<font color="#000080">, </font>Attribut<font color="#000080">);

       </font>MaxF <font color="#000080">:= </font>Y1 <font color="#000080">- </font>Y0 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;

       </font><font color="#008000"><i>{ Draw a cadre on the screen
       }

       </i></font>Cadre <font color="#000080">(</font>X0<font color="#000080">, </font>Y0<font color="#000080">, </font>X1<font color="#000080">, </font>Y1<font color="#000080">, (</font>TAttr <font color="#FF0000"><b>And </b></font><font color="#800000">$F</font><font color="#000080">), (</font>TAttr <font color="#FF0000"><b>Shr </b></font><font color="#800000">4</font><font color="#000080">), </font>Double<font color="#000080">);

       </font>X_Barre <font color="#000080">:= </font>X0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
       </font>Y_Barre <font color="#000080">:= </font>Y0 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;

       </font>NbrF <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

       </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>NbrFRep <font color="#000080">&gt; </font>MaxF <font color="#000080">* </font>NbrFich<font color="#000080">) </font><font color="#FF0000"><b>then Begin
            </b></font>FinJ <font color="#000080">:= </font>MaxF<font color="#000080">*</font>NbrFich<font color="#000080">;
            </font>Complet <font color="#000080">:= </font>False<font color="#000080">;
       </font><font color="#FF0000"><b>End
       Else Begin
            </b></font>FinJ <font color="#000080">:= </font>NbrFRep<font color="#000080">;
            </font>Complet <font color="#000080">:= </font>True<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

       </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>FinJ <font color="#FF0000"><b>do Begin

         </b></font>Prompt <font color="#000080">(</font>X_Barre<font color="#000080">, </font>Y_Barre<font color="#000080">, </font>TAttr<font color="#000080">, </font>TabF<font color="#000080">[</font>J<font color="#000080">]);
         </font>Inc <font color="#000080">(</font>NbrF<font color="#000080">);

         </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">(</font>NbrF <font color="#000080">&lt; </font>NbrFich<font color="#000080">) </font><font color="#FF0000"><b>then Begin

             </b></font>Inc <font color="#000080">(</font>Y_Barre<font color="#000080">);
             </font>X_Barre <font color="#000080">:= </font>X0 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
             </font>NbrF <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

         </font><font color="#FF0000"><b>End
         Else </b></font>Inc <font color="#000080">(</font>X_Barre<font color="#000080">, </font><font color="#800000">13</font><font color="#000080">);

       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

       </font><font color="#008000"><i>{ Give the possibility to the user to select a file/path name or
         another disk }

       </i></font>FName <font color="#000080">:= </font>MChoix <font color="#000080">(</font>X0<font color="#000080">, </font>Y0<font color="#000080">, </font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X0<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>Y0<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>TAttr<font color="#000080">, </font>TBarre<font color="#000080">);

       </font>gotoxy <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);

       </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">((</font>FLTouche <font color="#000080">= </font><font color="#800000">27</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>FLTouche <font color="#000080">= </font><font color="#800000">68</font><font color="#000080">)) </font><font color="#FF0000"><b>then Begin

          If Not </b></font><font color="#000080">(</font>wPos <font color="#000080">&gt; </font>Disque <font color="#000080">+ </font>Rep<font color="#000080">) </font><font color="#FF0000"><b>then Begin

             </b></font><font color="#008000"><i>{ The user has pressed the Enter key on a disk specification or
               on a path name }

             </i></font>FName <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; </font>FLTouche <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

          </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">(</font>wPos <font color="#000080">&gt; </font>Disque<font color="#000080">) </font><font color="#FF0000"><b>then Begin

             </b></font><font color="#008000"><i>{ Change the active disk }

             </i></font>NomRep <font color="#000080">:= </font>Copy <font color="#000080">(</font>TabF<font color="#000080">[</font>wPos<font color="#000080">], </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);

             </font><font color="#008000"><i>{$I-}
             </i></font>ChDir <font color="#000080">(</font>NomRep<font color="#000080">);
             </font><font color="#008000"><i>{$I+}

          </i></font><font color="#FF0000"><b>End

          Else If Not </b></font><font color="#000080">(</font>wPos <font color="#000080">&gt; </font>Disque<font color="#000080">+</font>Rep<font color="#000080">) </font><font color="#FF0000"><b>then Begin

             </b></font><font color="#008000"><i>{ Change the current path }

             </i></font>NomRep <font color="#000080">:= </font>Copy <font color="#000080">(</font>TabF<font color="#000080">[</font>wPos<font color="#000080">], </font><font color="#800000">2</font><font color="#000080">, </font>Length<font color="#000080">(</font>TabF<font color="#000080">[</font>wPos<font color="#000080">]) - </font><font color="#800000">2</font><font color="#000080">);

             </font><font color="#008000"><i>{$I-}
             </i></font>ChDir <font color="#000080">(</font>NomRep<font color="#000080">);
             </font><font color="#008000"><i>{$I+}

          </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

       </font><font color="#FF0000"><b>End

       Else </b></font>ChDir <font color="#000080">(</font>RepAct<font color="#000080">);

   </font><font color="#FF0000"><b>Until Not </b></font><font color="#000080">((</font>FLTouche <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FName <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">));

   </font><font color="#008000"><i>{ Return the selected file name }

   </i></font><font color="#FF0000"><b>If Not </b></font><font color="#000080">(</font>FName <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>GetFName <font color="#000080">:= </font>TrueName <font color="#000080">(</font>FName<font color="#000080">)
   </font><font color="#FF0000"><b>Else </b></font>GetFName <font color="#000080">:= </font>FName<font color="#000080">;

   </font><font color="#FF0000"><b>If </b></font>ChgRep <font color="#FF0000"><b>then </b></font>ChDir <font color="#000080">(</font>RepAct<font color="#000080">);

   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font>TextAttr <font color="#000080">:= </font>TBack<font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin

    </b></font>RepAct <font color="#000080">:= </font>TrueName <font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">));              </font><font color="#008000"><i>{ Save the current path }

    </i></font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font>Length <font color="#000080">(</font>RepAct<font color="#000080">) </font><font color="#FF0000"><b>Downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
        If </b></font>RepAct<font color="#000080">[</font>J<font color="#000080">] = </font><font color="#800000">'\' </font><font color="#FF0000"><b>then Begin
           </b></font>I <font color="#000080">:= </font>J<font color="#000080">;
           </font>J <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font>RepAct <font color="#000080">:= </font>Copy <font color="#000080">(</font>RepAct<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>I<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font><font color="#008000"><i>{  ----------------------------- cut here -------------------------------- }
{

   Example of the file select menu unit


               &Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;
               &ordm;                                        &ordm;&deg;
               &ordm;          AVONTURE CHRISTOPHE           &ordm;&deg;
               &ordm;              AVC SOFTWARE              &ordm;&deg;
               &ordm;     BOULEVARD EDMOND MACHTENS 157/53   &ordm;&deg;
               &ordm;           B-1080 BRUXELLES             &ordm;&deg;
               &ordm;              BELGIQUE                  &ordm;&deg;
               &ordm;                                        &ordm;&deg;
               &Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;&deg;
               &deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;

}

{ Include the FileList unit }

</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">, </font>Filelist<font color="#000080">;

</font><font color="#008000"><i>{ What you must do: declare a variable based on the FileListP type and 
  initialized it in your code }

</i></font><font color="#FF0000"><b>Var </b></font>FFilelist <font color="#000080">: </font>FileListP<font color="#000080">;
    </font>NomF      <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;          </font><font color="#008000"><i>{ Stored the full name of the selected file }

</i></font><font color="#FF0000"><b>Begin

   </b></font>ClrScr<font color="#000080">;

   </font><font color="#008000"><i>{ If you set the Attribut  propertie to &quot;AnyFile - VolumeId - Directoy&quot;
     then the user can't  change directory.  So he must select a file from
     the current directory with no possibility to go to other directory or
     disk!  For a list  of value, see  the SearchRec  function in the  DOS 
     unit: values used by my unit are the same. 

     Remember that the (Y1 - Y0) value must be greater than 15.  If no, the
     unit will automatically set the Y1 value to (15 - Y0) + Y1.

     The Masque propertie is the DOS match pattern: works exactly like the
     SearchRec function. 

     The TAttr value represent the color -0 to 255- of the window.  Exactly
     like the Attr CRT variable.

     The TBarre value represent the color -0 to 255- of the main bar: the bar
     with it you can select a file, directory or drive. Exactly like the Attr
     CRT variable. 

     You the  user  has  select  a  file (and  perhaps changed  drive  and/or 
     directory), the ChgRep  value specifies to your program if the unit must
     go back to  the original path  after the selection or not.  The original 
     path is the current path  just before the GetFName  function is called. }

   </i></font><font color="#FF0000"><b>With </b></font>FFileList <font color="#FF0000"><b>Do Begin

       </b></font>X0       <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;       </font><font color="#008000"><i>{ Size                    }
       </i></font>X1       <font color="#000080">:= </font><font color="#800000">78</font><font color="#000080">;      </font><font color="#008000"><i>{         of              }
       </i></font>Y0       <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;       </font><font color="#008000"><i>{             the         }
       </i></font>Y1       <font color="#000080">:= </font><font color="#800000">17</font><font color="#000080">;      </font><font color="#008000"><i>{                  window }
       </i></font>TAttr    <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;      </font><font color="#008000"><i>{ window color attribut   }
       </i></font>TBarre   <font color="#000080">:= </font><font color="#800000">57</font><font color="#000080">;      </font><font color="#008000"><i>{ bar color attribut      }
       </i></font>Masque   <font color="#000080">:= </font><font color="#800000">'*.*'</font><font color="#000080">;   </font><font color="#008000"><i>{ File Mask               }
       </i></font>Attribut <font color="#000080">:= </font><font color="#800000">$3F</font><font color="#000080">-</font><font color="#800000">$08</font><font color="#000080">; </font><font color="#008000"><i>{ AnyFile - VolumeId      }
       </i></font>ChgRep   <font color="#000080">:= </font>True<font color="#000080">;    </font><font color="#008000"><i>{ Return to original path }

   </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#008000"><i>{ Call the filename selector }

   </i></font>NomF <font color="#000080">:= </font>GetFName <font color="#000080">(</font>FFileList<font color="#000080">);

   </font><font color="#008000"><i>{ Here a file has been selected and his full name if stored in NomF. }

   </i></font>ClrScr<font color="#000080">;

   </font><font color="#008000"><i>{ And show the selected file name.
   
     A file is select only the user press on the Enter key under the filename.

     If the user has pressed the Escape Key or a function key (from F1 to F10),
     then the result of the GetFName function is emtpy.  So, in this example, 
     the NomF variable is equal to &quot;&quot; and the flTouche is set to the ASCII 
     value of the Key: 13 if Enter, 27 if Escape, 59 if F1, 60 if F2, ...

     The flTouche variable is declared in the unit so don't declared it again }

   </i></font>Writeln <font color="#000080">(</font><font color="#800000">'Selected file : '</font><font color="#000080">,</font>NomF<font color="#000080">,</font><font color="#800000">' ... Key pressed (ASCII value) '</font><font color="#000080">,</font>flTouche<font color="#000080">);

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0101.PAS">Original</a><b>]</b></p></body>
</html>
