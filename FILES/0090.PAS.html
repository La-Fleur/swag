<html>
<head><title> "File TOUCH Utility" by BRIAN LEITHER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0090.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>BFTIME<font color="#000080">; </font><font color="#008000"><i>{(C) 1995 - Brian Leiter - 03/11/1995}

</i></font><font color="#FF0000"><b>Uses </b></font>DOS<font color="#000080">,</font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>H<font color="#000080">,</font>M<font color="#000080">,</font>S<font color="#000080">,</font>Hund         <font color="#000080">: </font>Word<font color="#000080">;       </font><font color="#008000"><i>{ For GetTime         }
    </i></font>FTime              <font color="#000080">: </font>Longint<font color="#000080">;    </font><font color="#008000"><i>{ For Get/SetFTime    }
    </i></font>DT                 <font color="#000080">: </font>DateTime<font color="#000080">;   </font><font color="#008000"><i>{ For Pack/UnpackTime }
    </i></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>Dow <font color="#000080">: </font>Word<font color="#000080">;       </font><font color="#008000"><i>{ For Date            }
    </i></font>F<font color="#000080">,</font>F1               <font color="#000080">: </font>Text<font color="#000080">;       </font><font color="#008000"><i>{ For File Name       }
    </i></font>Log                <font color="#000080">: </font>Boolean<font color="#000080">;    </font><font color="#008000"><i>{ For Log File        }
    </i></font>Count              <font color="#000080">: </font>Integer<font color="#000080">;    </font><font color="#008000"><i>{ For File Count      }
    </i></font>DirInfo            <font color="#000080">: </font>SearchRec<font color="#000080">;  </font><font color="#008000"><i>{ For Search Info     }

</i></font><font color="#FF0000"><b>Const </b></font>Days <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] =
      (</font><font color="#800000">'Sunday'</font><font color="#000080">,</font><font color="#800000">'Monday'</font><font color="#000080">,</font><font color="#800000">'Tuesday'</font><font color="#000080">,</font><font color="#800000">'Wednesday'</font><font color="#000080">,</font><font color="#800000">'Thursday'</font><font color="#000080">,</font><font color="#800000">'Friday'</font><font color="#000080">,</font><font color="#800000">'Saturday'</font><font color="#000080">);
      </font>CDrive<font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Help<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>ClrScr<font color="#000080">;
  </font>Textcolor<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">);</font>Writeln<font color="#000080">(</font><font color="#800000">'&thorn; BFTIME v1.0 - A File Date/Timestamp Updater Program &thorn;'</font><font color="#000080">);
  </font>Textcolor<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);</font>Writeln<font color="#000080">(</font><font color="#800000">'&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);</font>Textcolor<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Command Line Usage:  BFTIME [FILE MASK] (Log File)'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);</font>Textcolor<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Ex 1: BFTIME *.ZIP                    &lt;&Auml;&Auml;&Auml;&lt; No Log File'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Ex 2: BFTIME *.ZIP C:\LOG\BFTIME.LOG  &lt;&Auml;&Auml;&Auml;&lt; Log File Used'</font><font color="#000080">);
  </font>Textcolor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'                 '</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'      &sup3;      &sup3;     &Agrave;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&lt; Path &amp; Name Of Log File'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'      &sup3;      &sup3;'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'      &sup3;      &Agrave;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&lt; Mask For Files To Be Updated'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'      &sup3;'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'      &Agrave;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&lt; Executionable Program File'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);</font>Sound<font color="#000080">(</font><font color="#800000">850</font><font color="#000080">);</font>Delay<font color="#000080">(</font><font color="#800000">350</font><font color="#000080">);</font>NoSound<font color="#000080">;</font>Sound<font color="#000080">(</font><font color="#800000">650</font><font color="#000080">);</font>Delay<font color="#000080">(</font><font color="#800000">350</font><font color="#000080">);</font>NoSound<font color="#000080">;</font>Sound<font color="#000080">(</font><font color="#800000">850</font><font color="#000080">);</font>Delay<font color="#000080">(</font><font color="#800000">350</font><font color="#000080">);</font>NoSound<font color="#000080">;
  </font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CheckParams<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Log<font color="#000080">:=</font>False<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>ParamCount<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ParamCount<font color="#000080">&gt;</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Help<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>ParamCount<font color="#000080">=</font><font color="#800000">2 </font><font color="#FF0000"><b>Then </b></font>Log<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DateNow<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GetDate<font color="#000080">(</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>Dow<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Log<font color="#000080">=</font>True <font color="#FF0000"><b>Then
  Begin
    </b></font>Assign<font color="#000080">(</font>F1<font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">));
    </font><font color="#008000"><i>{$I-}</i></font>Reset<font color="#000080">(</font>F1<font color="#000080">);</font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>IF </b></font>IOResult<font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Rewrite<font color="#000080">(</font>F1<font color="#000080">);
    </font>Append<font color="#000080">(</font>F1<font color="#000080">);
    </font>Writeln<font color="#000080">(</font>F1<font color="#000080">,</font><font color="#800000">'START  LOG: '</font><font color="#000080">,</font>Days<font color="#000080">[</font>Dow<font color="#000080">],</font><font color="#800000">', '</font><font color="#000080">,</font>Month<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font>Day<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font>Year<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">' &thorn; BFTIME v1.0'</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LeadingZero<font color="#000080">(</font>W <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;     </font><font color="#008000"><i>{ For File Name       }

</i></font><font color="#FF0000"><b>Begin
  </b></font>Str<font color="#000080">(</font>W<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>S<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>Then </b></font>S <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>S<font color="#000080">;
  </font>LeadingZero <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Importit<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>FindFirst<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">), </font>Archive<font color="#000080">, </font>DirInfo<font color="#000080">);
  </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Do
  Begin
    </b></font>Count<font color="#000080">:=</font>Count<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font>Assign<font color="#000080">(</font>F<font color="#000080">,</font>DirInfo<font color="#000080">.</font>Name<font color="#000080">);
    </font>Reset<font color="#000080">(</font>F<font color="#000080">);
    </font>GetTime<font color="#000080">(</font>H<font color="#000080">,</font>M<font color="#000080">,</font>S<font color="#000080">,</font>Hund<font color="#000080">);
    </font>GetDate<font color="#000080">(</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>Dow<font color="#000080">);
    </font>GetFTime<font color="#000080">(</font>F<font color="#000080">,</font>FTime<font color="#000080">);
    </font>Gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">);
    </font>Textcolor<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'&thorn; '</font><font color="#000080">,</font>DirInfo<font color="#000080">.</font>Name<font color="#000080">,</font><font color="#800000">' Was Re-Dated And Re-Timestamped At '
    </font><font color="#000080">,</font>LeadingZero<font color="#000080">(</font>h<font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">,</font>LeadingZero<font color="#000080">(</font>m<font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">,</font>LeadingZero<font color="#000080">(</font>s<font color="#000080">));
    </font><font color="#FF0000"><b>If </b></font>Log<font color="#000080">=</font>True <font color="#FF0000"><b>Then
    Begin
      </b></font>Append<font color="#000080">(</font>F1<font color="#000080">);
      </font>Writeln<font color="#000080">(</font>F1<font color="#000080">,</font><font color="#800000">'    &thorn; '</font><font color="#000080">,</font>DirInfo<font color="#000080">.</font>Name<font color="#000080">,</font><font color="#800000">' Was Re-Dated And Re-Timestamped At '
      </font><font color="#000080">,</font>LeadingZero<font color="#000080">(</font>h<font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">,</font>LeadingZero<font color="#000080">(</font>m<font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">,</font>LeadingZero<font color="#000080">(</font>s<font color="#000080">));
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>UnpackTime<font color="#000080">(</font>FTime<font color="#000080">,</font>DT<font color="#000080">);
    </font><font color="#FF0000"><b>With </b></font>DT <font color="#FF0000"><b>Do
    Begin
      </b></font>GetDate<font color="#000080">(</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>Dow<font color="#000080">);
      </font>Day<font color="#000080">:=</font>Day<font color="#000080">;
      </font>Month<font color="#000080">:=</font>Month<font color="#000080">;
      </font>Year<font color="#000080">:=</font>Year<font color="#000080">;
      </font>Hour <font color="#000080">:= </font>H<font color="#000080">;
      </font>Min <font color="#000080">:= </font>M<font color="#000080">;
      </font>Sec <font color="#000080">:= </font>S<font color="#000080">;
      </font>PackTime<font color="#000080">(</font>DT<font color="#000080">,</font>FTime<font color="#000080">);
      </font>Reset<font color="#000080">(</font>F<font color="#000080">);
      </font>SetFTime<font color="#000080">(</font>F<font color="#000080">,</font>FTime<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Close<font color="#000080">(</font>F<font color="#000080">);
    </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">);
  </font>Textcolor<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Count<font color="#000080">&gt;=</font><font color="#800000">1 </font><font color="#FF0000"><b>Then </b></font>Writeln<font color="#000080">(</font><font color="#800000">'&thorn; Operation Successfull - There Were '</font><font color="#000080">,</font>Count<font color="#000080">,</font><font color="#800000">' Files Updated!'</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Count<font color="#000080">&lt;=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
  Begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'&thorn; Operation Failed - There Were No Files Matches Found!'</font><font color="#000080">);
    </font>Sound<font color="#000080">(</font><font color="#800000">350</font><font color="#000080">);</font>Delay<font color="#000080">(</font><font color="#800000">350</font><font color="#000080">);</font>NoSound<font color="#000080">; </font>Sound<font color="#000080">(</font><font color="#800000">150</font><font color="#000080">);</font>Delay<font color="#000080">(</font><font color="#800000">350</font><font color="#000080">);</font>NoSound<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Log<font color="#000080">=</font>True <font color="#FF0000"><b>Then
  Begin
    </b></font>Append<font color="#000080">(</font>F1<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Count<font color="#000080">&lt;=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Writeln<font color="#000080">(</font>F1<font color="#000080">,</font><font color="#800000">'    &thorn; Operation Failed - No File Match Found &thorn;'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font>F1<font color="#000080">,</font><font color="#800000">'END OF LOG: BFTIME (C) 1995 Brian Leiter, All Rights Reserved'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font>F1<font color="#000080">,</font><font color="#800000">'&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;'</font><font color="#000080">);
    </font>Close<font color="#000080">(</font>F1<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Logo<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Clrscr<font color="#000080">;
  </font>Textcolor<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);</font>Textbackground<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'&Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'&ordm; -=&thorn; BFTIME v1.0 &thorn;=-               03/11/95 &ordm;'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'&ordm;                                            &ordm;'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'&ordm;      File Date And Timestamp Updater       &ordm;'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'&ordm;                                            &ordm;'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'&ordm; (C) 1995 Brian Leiter, All Rights Reserved &ordm;'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'&Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;'</font><font color="#000080">);
  </font>Textbackground<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin</b></font><font color="#000080">;
</font>CheckParams<font color="#000080">;
</font>Logo<font color="#000080">;
</font>DateNow<font color="#000080">;
</font>Importit<font color="#000080">;
</font>Textcolor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0090.PAS">Original</a><b>]</b></p></body>
</html>
