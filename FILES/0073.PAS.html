<html>
<head><title> "Hiding Files" by RICK HAINES</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0073.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here are some routines for Hiding files, making read only files and
stuff.  Let me know what you think.  Any comments, criticism, or rude
remarks are welcome.

{ *********************** Files Unit *********************** }
{ **************** Written by: Rick Haines ***************** }
{ ***************** Last Revised 02/02/95 ****************** }

</i></font><font color="#FF0000"><b>Unit </b></font>Files<font color="#000080">;

</font><font color="#FF0000"><b>Interface

 </b></font><font color="#008000"><i>{ Note: All FileNames MUST end in a null Char }
 { EX:   HideFile(FileName+#0);                }
 { EX:   HideFile('MyFile.Exe'+#0);            }

 </i></font><font color="#FF0000"><b>Function </b></font>HideFile<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Byte<font color="#000080">;     </font><font color="#008000"><i>{ Hide FileName }
 </i></font><font color="#FF0000"><b>Function </b></font>SystemFile<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Byte<font color="#000080">;   </font><font color="#008000"><i>{ Make FileName a System File}
 </i></font><font color="#FF0000"><b>Function </b></font>ReadOnlyFile<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Byte<font color="#000080">; </font><font color="#008000"><i>{ Make FileName ReadOnly     }
 </i></font><font color="#FF0000"><b>Function </b></font>NormalFile<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Byte<font color="#000080">;   </font><font color="#008000"><i>{ Make FileName a Normal File}
 </i></font><font color="#FF0000"><b>Function </b></font>FileAttributes<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">; </font><font color="#008000"><i>{ Returns Attributes of }

</i></font><font color="#FF0000"><b>Implementation

 Function </b></font>HideFile<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">Push DS           </font><font color="#008000"><i>{ Push Data Segment                  }
   </i></font><font color="#FF00FF">LDS DX, FileName  </font><font color="#008000"><i>{ Nul Terminated String of FileName  }
   </i></font><font color="#FF00FF">Inc DX            </font><font color="#008000"><i>{ Get Rid Of Length Byte             }
   </i></font><font color="#FF00FF">Mov AH, 43h       </font><font color="#008000"><i>{ Dos Function 43h, File Change Mode }
   </i></font><font color="#FF00FF">Mov AL, 1         </font><font color="#008000"><i>{ Change Attributes                  }
   </i></font><font color="#FF00FF">Mov CX, 2         </font><font color="#008000"><i>{ Bit 1, Hide It                     }
   </i></font><font color="#FF00FF">Int 21h           </font><font color="#008000"><i>{ Call Dos                           }
   </i></font><font color="#FF00FF">JC @Done          </font><font color="#008000"><i>{ See if there was an error          }
   </i></font><font color="#FF00FF">Mov AL, 0         </font><font color="#008000"><i>{ If Not, Then No Error              }
  </i></font><font color="#FF00FF">@Done:
   Pop DS            </font><font color="#008000"><i>{ Pop Data Segment                   }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Function </b></font>SystemFile<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">Push DS           </font><font color="#008000"><i>{ Push Data Segment                  }
   </i></font><font color="#FF00FF">LDS DX, FileName  </font><font color="#008000"><i>{ Nul Terminated String of FileName  }
   </i></font><font color="#FF00FF">Inc DX            </font><font color="#008000"><i>{ Get Rid Of Length Byte             }
   </i></font><font color="#FF00FF">Mov AH, 43h       </font><font color="#008000"><i>{ Dos Function 43h, File Change Mode }
   </i></font><font color="#FF00FF">Mov AL, 1         </font><font color="#008000"><i>{ Change Attributes                  }
   </i></font><font color="#FF00FF">Mov CX, 4         </font><font color="#008000"><i>{ Bit 3, System File                 }
   </i></font><font color="#FF00FF">Int 21h           </font><font color="#008000"><i>{ Call Dos                           }
   </i></font><font color="#FF00FF">JC @Done          </font><font color="#008000"><i>{ See if there was an error          }
   </i></font><font color="#FF00FF">Mov AL, 0         </font><font color="#008000"><i>{ If Not, Then No Error              }
  </i></font><font color="#FF00FF">@Done:
   Pop DS            </font><font color="#008000"><i>{ Pop Data Segment                   }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Function </b></font>ReadOnlyFile<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">Push DS           </font><font color="#008000"><i>{ Push Data Segment                  }
   </i></font><font color="#FF00FF">LDS DX, FileName  </font><font color="#008000"><i>{ Nul Terminated String of FileName  }
   </i></font><font color="#FF00FF">Inc DX            </font><font color="#008000"><i>{ Get Rid Of Length Byte             }
   </i></font><font color="#FF00FF">Mov AH, 43h       </font><font color="#008000"><i>{ Dos Function 43h, File Change Mode }
   </i></font><font color="#FF00FF">Mov AL, 1         </font><font color="#008000"><i>{ Change Attributes                  }
   </i></font><font color="#FF00FF">Mov CX, 1         </font><font color="#008000"><i>{ Bit 0, Read Only                   }
   </i></font><font color="#FF00FF">Int 21h           </font><font color="#008000"><i>{ Call Dos                           }
   </i></font><font color="#FF00FF">JC @Done          </font><font color="#008000"><i>{ See if there was an error          }
   </i></font><font color="#FF00FF">Mov AL, 0         </font><font color="#008000"><i>{ If Not, Then No Error              }
  </i></font><font color="#FF00FF">@Done:
   Pop DS            </font><font color="#008000"><i>{ Pop Data Segment                   }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Function </b></font>NormalFile<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">Push DS           </font><font color="#008000"><i>{ Push Data Segment                  }
   </i></font><font color="#FF00FF">LDS DX, FileName  </font><font color="#008000"><i>{ Nul Terminated String of FileName  }
   </i></font><font color="#FF00FF">Inc DX            </font><font color="#008000"><i>{ Get Rid of Length Byte             }
   </i></font><font color="#FF00FF">Mov AH, 43h       </font><font color="#008000"><i>{ Dos Function 43h, File Change Mode }
   </i></font><font color="#FF00FF">Mov AL, 1         </font><font color="#008000"><i>{ Change Attributes                  }
   </i></font><font color="#FF00FF">Mov CX, 0         </font><font color="#008000"><i>{ Nothing, UnEverything it           }
   </i></font><font color="#FF00FF">Int 21h           </font><font color="#008000"><i>{ Call Dos                           }
   </i></font><font color="#FF00FF">JC @Done          </font><font color="#008000"><i>{ See if there was an error          }
   </i></font><font color="#FF00FF">Mov AL, 0         </font><font color="#008000"><i>{ If not, then no error              }
  </i></font><font color="#FF00FF">@Done:
   Pop DS            </font><font color="#008000"><i>{ Pop Data Segment                   }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Function </b></font>FileAttributes<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">Push DS           </font><font color="#008000"><i>{ Push Data Segment                  }
   </i></font><font color="#FF00FF">LDS DX, FileName  </font><font color="#008000"><i>{ Nul Terminated String of FileName  }
   </i></font><font color="#FF00FF">Inc DX            </font><font color="#008000"><i>{ Get Rid of Length Byte             }
   </i></font><font color="#FF00FF">Mov AH, 43h       </font><font color="#008000"><i>{ Dos Function 43h, File Change Mode }
   </i></font><font color="#FF00FF">Mov AL, 0         </font><font color="#008000"><i>{ Return Attributes                  }
   </i></font><font color="#FF00FF">Int 21h           </font><font color="#008000"><i>{ Call Dos                           }
   </i></font><font color="#FF00FF">JC @Error         </font><font color="#008000"><i>{ See if there was an error          }
   </i></font><font color="#FF00FF">Mov AX, CX        </font><font color="#008000"><i>{ Return Attributes                  }
   </i></font><font color="#FF00FF">Jmp @Done
  @Error:
   Mov AX, -1        </font><font color="#008000"><i>{ Return -1 For Error                }
  </i></font><font color="#FF00FF">@Done:
   Pop DS            </font><font color="#008000"><i>{ Pop Data Segment                   }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0073.PAS">Original</a><b>]</b></p></body>
</html>
