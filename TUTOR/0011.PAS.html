<html>
<head><title> "DOS File functions (special topic 1)" by GLENN GROTZINGER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TUTOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">                        Turbo <font color="#FF0000"><b>Pascal for </b></font>DOS Tutorial
                              by Glenn Grotzinger
                 Part <font color="#800000">8 </font><font color="#000080">-- </font>DOS <font color="#FF0000"><b>file </b></font>functions <font color="#000080">(</font>special topic <font color="#800000">1</font><font color="#000080">)
               </font>All parts copyright <font color="#000080">(</font>c<font color="#000080">) </font><font color="#800000">1995 </font>by Glenn Grotzinger

Here<font color="#800000">'s a solution to part 7....

</font><font color="#FF0000"><b>program </b></font>part7<font color="#000080">;

  </font><font color="#008000"><i>{ demos 2 functions defined in part 7 to be written.  Convert base 10
    to anybase, and convert anybase to base 10 }

  </i></font><font color="#FF0000"><b>function </b></font>power<font color="#000080">(</font>int<font color="#000080">, </font>ord<font color="#000080">: </font>integer<font color="#000080">):</font>longint<font color="#000080">;
    </font><font color="#008000"><i>{ support function required for xbase2dec.  Simplistic
      implementation of taking a power. }
    </i></font><font color="#FF0000"><b>var
      </b></font>i<font color="#000080">, </font>endit<font color="#000080">: </font>longint<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>endit <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ord <font color="#FF0000"><b>do
        </b></font>endit <font color="#000080">:= </font>endit <font color="#000080">* </font>int<font color="#000080">;
      </font>power <font color="#000080">:= </font>endit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>dec2xbase<font color="#000080">(</font>int<font color="#000080">: </font>longint<font color="#000080">; </font>base<font color="#000080">: </font>integer<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#008000"><i>{ converts base 10 to any base &lt; 37 }
    </i></font><font color="#FF0000"><b>const
      </b></font>numguide<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">= </font><font color="#800000">'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font><font color="#000080">;
      </font><font color="#008000"><i>{ the guide string I mentioned as a hint }
    </i></font><font color="#FF0000"><b>var
      </b></font>i<font color="#000080">: </font>integer<font color="#000080">;
      </font>hold<font color="#000080">, </font>chkprod1<font color="#000080">, </font>chkprod2<font color="#000080">: </font>longint<font color="#000080">;
      </font>endstr<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>begin
      if </b></font>base <font color="#000080">&gt; </font><font color="#800000">36 </font><font color="#FF0000"><b>then
        </b></font>dec2xbase <font color="#000080">:= </font><font color="#800000">'!' </font><font color="#008000"><i>{ a signal character to say our function failed }
      </i></font><font color="#FF0000"><b>else
        begin
          </b></font>endstr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
          </font>hold <font color="#000080">:= </font>int<font color="#000080">;
          </font><font color="#FF0000"><b>while </b></font>chkprod1 <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
            begin
              </b></font>chkprod1 <font color="#000080">:= </font>hold <font color="#FF0000"><b>div </b></font>base<font color="#000080">; </font><font color="#008000"><i>{ using method described when I }
              </i></font>chkprod2 <font color="#000080">:= </font>hold <font color="#FF0000"><b>mod </b></font>base<font color="#000080">; </font><font color="#008000"><i>{ demoed doing it manually }
              </i></font>endstr <font color="#000080">:= </font>numguide<font color="#000080">[</font>chkprod2 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] + </font>endstr<font color="#000080">;
                        </font><font color="#008000"><i>{ actual representation }
              </i></font>hold <font color="#000080">:= </font>chkprod1<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>dec2xbase <font color="#000080">:= </font>endstr<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>xbase2dec<font color="#000080">(</font>int<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>base<font color="#000080">: </font>integer<font color="#000080">):</font>longint<font color="#000080">;
    </font><font color="#008000"><i>{ converts any base &lt; 37 to base 10 }
    </i></font><font color="#FF0000"><b>const
      </b></font>numguide<font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">= </font><font color="#800000">'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font><font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>i<font color="#000080">, </font>powr<font color="#000080">: </font>integer<font color="#000080">;
      </font>endresult<font color="#000080">: </font>longint<font color="#000080">;
      </font>intlength<font color="#000080">: </font>integer<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      if </b></font>base <font color="#000080">&gt; </font><font color="#800000">36 </font><font color="#FF0000"><b>then
        </b></font>xbase2dec <font color="#000080">:= -</font><font color="#800000">1 </font><font color="#008000"><i>{signal fucntion has failed }
      </i></font><font color="#FF0000"><b>else
        begin
          </b></font>endresult <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
          </font>powr <font color="#000080">:= </font>length<font color="#000080">(</font>int<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">;
          </font><font color="#FF0000"><b>while </b></font>i <font color="#000080">&lt;&gt; </font>length<font color="#000080">(</font>int<font color="#000080">)+</font><font color="#800000">1 </font><font color="#FF0000"><b>do   </b></font><font color="#008000"><i>{ compute back to base 10 }
            </i></font><font color="#FF0000"><b>begin
              </b></font>endresult <font color="#000080">:= </font>endresult <font color="#000080">+ (</font>pos<font color="#000080">(</font>int<font color="#000080">[</font>i<font color="#000080">], </font>numguide<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) *
                           </font>power<font color="#000080">(</font>base<font color="#000080">, </font>powr<font color="#000080">);
              </font>i <font color="#000080">:= </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
              </font>powr <font color="#000080">:= </font>powr <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>xbase2dec <font color="#000080">:= </font>endresult<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>var
    </b></font>numread<font color="#000080">, </font>numbase<font color="#000080">: </font>longint<font color="#000080">;
    </font>convbase<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>write<font color="#000080">(</font><font color="#800000">'Enter a number (base 10): '</font><font color="#000080">);
    </font>readln<font color="#000080">(</font>numread<font color="#000080">);
    </font>write<font color="#000080">(</font><font color="#800000">'What base do you want to convert to? '</font><font color="#000080">);
    </font>readln<font color="#000080">(</font>numbase<font color="#000080">);
    </font>writeln<font color="#000080">;
    </font>convbase <font color="#000080">:= </font>dec2xbase<font color="#000080">(</font>numread<font color="#000080">, </font>numbase<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>convbase <font color="#000080">= </font><font color="#800000">'!' </font><font color="#FF0000"><b>then
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'Use a base less than 37'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else begin
      </b></font>writeln<font color="#000080">(</font>numread<font color="#000080">, </font><font color="#800000">' (base 10) is '</font><font color="#000080">, </font>convbase<font color="#000080">, </font><font color="#800000">' (base '</font><font color="#000080">, </font>numbase<font color="#000080">, </font><font color="#800000">').'</font><font color="#000080">);
      </font>numread <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#008000"><i>{ required setting of initial read var to 0 to prove our functions work }
      </i></font>writeln<font color="#000080">(</font><font color="#800000">'To check: '</font><font color="#000080">, </font>convbase<font color="#000080">, </font><font color="#800000">' (base '</font><font color="#000080">, </font>numbase<font color="#000080">, </font><font color="#800000">') is '</font><font color="#000080">,
               </font>xbase2dec<font color="#000080">(</font>convbase<font color="#000080">, </font>numbase<font color="#000080">), </font><font color="#800000">' (base 10).'</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>Now <font color="#FF0000"><b>on with </b></font>the show<font color="#000080">....</font>This <font color="#FF0000"><b>is </b></font>going <font color="#FF0000"><b>to </b></font>be more <font color="#FF0000"><b>of </b></font>a special topics practice
thing<font color="#000080">.  </font><font color="#FF0000"><b>As </b></font>a note<font color="#000080">, </font>all <font color="#FF0000"><b>of </b></font>the commands I use here will require you <font color="#FF0000"><b>to </b></font>use
the dos <font color="#FF0000"><b>or </b></font>windos <font color="#FF0000"><b>unit</b></font><font color="#000080">....</font>also<font color="#000080">, </font>have your TP Programmers Reference handy <font color="#FF0000"><b>to
</b></font>look up several <font color="#FF0000"><b>of </b></font>the basic functions that I will list here<font color="#000080">.

</font>A simple <font color="#FF0000"><b>if </b></font>successful<font color="#000080">...
=========================
</font>How <font color="#FF0000"><b>do </b></font>we check <font color="#FF0000"><b>if </b></font>any <font color="#FF0000"><b>of </b></font>these<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>our prior reset<font color="#000080">/</font>rewrite calls are
successful<font color="#000080">?  </font>We toggle the I compiler option before a valid <font color="#FF0000"><b>file </b></font>oper<font color="#000080">-
</font>ator<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>we check the variable <font color="#FF0000"><b>in </b></font>IOResult<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">, </font><font color="#FF0000"><b>then
</b></font>we know there <font color="#FF0000"><b>is </b></font>a problem<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">, </font>how <font color="#FF0000"><b>do </b></font>we check <font color="#FF0000"><b>if </b></font>a <font color="#FF0000"><b>file
</b></font>exists <font color="#FF0000"><b>on </b></font>the drive before we read from it<font color="#000080">?

</font><font color="#FF0000"><b>function </b></font>exists<font color="#000080">(</font>filename<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>ourfile<font color="#000080">: </font>text<font color="#000080">; </font><font color="#008000"><i>{ can be defined to be any type we want }
  </i></font><font color="#FF0000"><b>begin
    </b></font>assign<font color="#000080">(</font>ourfile<font color="#000080">, </font>filename<font color="#000080">);  </font><font color="#008000"><i>{ let the program know about the file }
    {$I-}</i></font>reset<font color="#000080">(</font>ourfile<font color="#000080">);</font><font color="#008000"><i>{$I+}   { toggle I, on a reset. Both MUST be there }
    </i></font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0
    </font><font color="#008000"><i>{ did something go wrong?  With reset, if file did not exist, something
      would be wrong }
      </i></font>exists <font color="#000080">:= </font>false           <font color="#008000"><i>{ indicate file doesn't exist }
    </i></font><font color="#FF0000"><b>else  </b></font><font color="#008000"><i>{ file exists }
      </i></font><font color="#FF0000"><b>begin
        </b></font>close<font color="#000080">(</font>ourfile<font color="#000080">); </font><font color="#008000"><i>{ we need to close the file since if it's there, }
        </i></font>exist <font color="#000080">:= </font>true<font color="#000080">;  </font><font color="#008000"><i>{ we just opened it.  Also, indicate it's there. }
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>This method can be used <font color="#FF0000"><b>with </b></font>any <font color="#FF0000"><b>file function </b></font>like that <font color="#FF0000"><b>as </b></font>long <font color="#FF0000"><b>as </b></font>the
system <font color="#FF0000"><b>is </b></font>aware <font color="#FF0000"><b>of </b></font>the <font color="#FF0000"><b>file</b></font><font color="#000080">, </font><font color="#FF0000"><b>to </b></font>indicate success<font color="#000080">, </font>possibilities<font color="#000080">, </font>etc<font color="#000080">.,
</font><font color="#FF0000"><b>in </b></font>whatever logical means the command indicates<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>reset<font color="#000080">, </font>one logically
can say that <font color="#FF0000"><b>if </b></font>something goes wrong <font color="#FF0000"><b>with </b></font>it<font color="#000080">, </font>the <font color="#FF0000"><b>file </b></font>isn<font color="#800000">'t there, or the
</font>path <font color="#FF0000"><b>is </b></font>invalid<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>rewrite<font color="#000080">, </font>one logically can say <font color="#FF0000"><b>if </b></font>the path isn<font color="#800000">'t
</font>right <font color="#FF0000"><b>or </b></font>available<font color="#000080">, </font><font color="#FF0000"><b>or if </b></font>there<font color="#800000">'s no disk space, or a variety of reasons.

</font>The I compiler directive indicates turning <font color="#FF0000"><b>ON or </b></font>OFF input<font color="#000080">/</font>output checking<font color="#000080">.
</font>The <font color="#FF0000"><b>default for </b></font>most compilers <font color="#FF0000"><b>is </b></font><font color="#008000"><i>{$I+}</i></font><font color="#000080">.  </font><font color="#FF0000"><b>As </b></font>compiler directives go<font color="#000080">, </font>we
must toggle it back<font color="#000080">, </font>because the area after the change <font color="#FF0000"><b>is in </b></font>effect<font color="#000080">, </font><font color="#FF0000"><b>and
</b></font>we only want it <font color="#FF0000"><b>for </b></font>the <font color="#FF0000"><b>case of </b></font>the command we want <font color="#FF0000"><b>to </b></font>check<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>I<font color="#000080">/</font>O
checking <font color="#FF0000"><b>is on</b></font><font color="#000080">, </font>the <font color="#FF0000"><b>program </b></font>would <font color="#FF0000"><b>end in </b></font>a run<font color="#000080">-</font>time error <font color="#000080">(</font>you may have
noticed this<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>you have tried <font color="#FF0000"><b>to </b></font>access non<font color="#000080">-</font>existent files <font color="#FF0000"><b>in </b></font>your
experimentation <font color="#FF0000"><b>with </b></font>reading<font color="#000080">/</font>writing text files<font color="#000080">). </font><font color="#FF0000"><b>If </b></font>I<font color="#000080">/</font>O checking <font color="#FF0000"><b>is </b></font>off
<font color="#000080">(</font><font color="#008000"><i>{$I-}</i></font><font color="#000080">, </font>the result <font color="#FF0000"><b>of </b></font>the command <font color="#FF0000"><b>is </b></font>logged <font color="#FF0000"><b>in </b></font>a global variable named
IOResult<font color="#000080">.

</font>Being able <font color="#FF0000"><b>to </b></font>subvert run<font color="#000080">-</font>time errors <font color="#FF0000"><b>is </b></font>good <font color="#FF0000"><b>to </b></font>be able <font color="#FF0000"><b>to do</b></font><font color="#000080">, </font>especially
<font color="#FF0000"><b>for </b></font>a DOS <font color="#FF0000"><b>file function type program</b></font><font color="#000080">, </font>where you even deal <font color="#FF0000"><b>with </b></font>files<font color="#000080">.
</font><font color="#FF0000"><b>If </b></font>the user specifies an incorrect <font color="#FF0000"><b>file to </b></font>read<font color="#000080">, </font>you can return an intel<font color="#000080">-
</font>ligible<font color="#000080">, </font>user<font color="#000080">-</font>understandable error <font color="#FF0000"><b>message </b></font>that the filename they gave
does <font color="#FF0000"><b>not </b></font>exist <font color="#FF0000"><b>on </b></font>the drive<font color="#000080">.

</font>A list <font color="#FF0000"><b>of </b></font>run<font color="#000080">-</font>time error possibilities may be found <font color="#FF0000"><b>on </b></font>page <font color="#800000">260 </font><font color="#FF0000"><b>of </b></font>the
TP7 programmers reference<font color="#000080">.

</font>Straight <font color="#FF0000"><b>Forward </b></font>Things
<font color="#000080">=======================
        </font>I will list several commands <font color="#FF0000"><b>for </b></font>working <font color="#FF0000"><b>with </b></font>files <font color="#FF0000"><b>and </b></font>DOS
which are relatively straight<font color="#000080">-</font><font color="#FF0000"><b>forward to </b></font>use<font color="#000080">.  </font><font color="#FF0000"><b>Unit </b></font>used<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>command<font color="#000080">,
</font><font color="#FF0000"><b>then </b></font>a short description<font color="#000080">.  </font>Detailed descriptions follow <font color="#FF0000"><b>if </b></font>needed<font color="#000080">.  </font>I
will mainly cover the DOS <font color="#FF0000"><b>unit </b></font>variants<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>you use TPW<font color="#000080">, </font>look up the
WinDOS variant equivalents<font color="#000080">...</font>Be sure <font color="#FF0000"><b>to </b></font>look each <font color="#FF0000"><b>of </b></font>these up <font color="#FF0000"><b>in </b></font>any
<font color="#FF0000"><b>case</b></font><font color="#000080">.... </font>By all means<font color="#000080">, </font>play <font color="#FF0000"><b>with </b></font>each <font color="#FF0000"><b>of </b></font>these <font color="#FF0000"><b>to </b></font>understand them<font color="#000080">.
</font>Notes <font color="#FF0000"><b>on </b></font>some <font color="#FF0000"><b>of </b></font>these things will appear later<font color="#000080">.

</font>System<font color="#000080">: </font>ChDir<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);  </font><font color="#008000"><i>{ changes the current directory to path in Str }
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>DiskFree<font color="#000080">(</font>Drive<font color="#000080">: </font>byte<font color="#000080">):</font>longint<font color="#000080">; </font><font color="#008000"><i>{ free bytes on Drive }
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>DiskSize<font color="#000080">(</font>Drive<font color="#000080">: </font>byte<font color="#000080">):</font>longint<font color="#000080">; </font><font color="#008000"><i>{ total bytes on Drive }
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>DosVersion<font color="#000080">: </font>word<font color="#000080">; </font><font color="#008000"><i>{ tells us what version of DOS we have }
</i></font>DOS<font color="#000080">: </font>EnvCount<font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{ how many environment strings? }
</i></font>DOS<font color="#000080">: </font>EnvStr<font color="#000080">(</font>index<font color="#000080">: </font>integer<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#008000"><i>{return a specific environment string}
</i></font>System<font color="#000080">: </font>erase<font color="#000080">(</font><font color="#FF0000"><b>file</b></font><font color="#000080">: </font>filetype<font color="#000080">);  </font><font color="#008000"><i>{erases an external file}
</i></font>System<font color="#000080">: </font>FilePos<font color="#000080">(</font><font color="#FF0000"><b>file</b></font><font color="#000080">: </font>filetype<font color="#000080">): </font>longint<font color="#000080">; </font><font color="#008000"><i>{returns current position in file}
</i></font>System<font color="#000080">: </font>FileSize<font color="#000080">(</font><font color="#FF0000"><b>file</b></font><font color="#000080">: </font>filetype<font color="#000080">): </font>longint<font color="#000080">; </font><font color="#008000"><i>{returns a file's size}
</i></font>DOS<font color="#000080">: </font>FSearch<font color="#000080">(</font>filename<font color="#000080">: </font>PathStr<font color="#000080">; </font>dirlist<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>Pathstr <font color="#008000"><i>{search for a file}
</i></font>DOS<font color="#000080">: </font>FSplit<font color="#000080">(...  </font><font color="#008000"><i>{split a filename into a dir, name, and ext}
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>Getdate<font color="#000080">(... </font><font color="#008000"><i>{ gets the current date of the operating system.}
</i></font>System<font color="#000080">:</font>GetDir<font color="#000080">(</font>drive<font color="#000080">; </font>str<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">); </font><font color="#008000"><i>{gets current directory}
</i></font>DOS<font color="#000080">: </font>GetEnv<font color="#000080">(...  </font><font color="#008000"><i>{gets the specified environment variable}
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>GetFAttr <font color="#000080">(... </font><font color="#008000"><i>{ returns file attributes of a file }
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>GetFTime <font color="#000080">(... </font><font color="#008000"><i>{ get the date and time of a file }
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>GetTime<font color="#000080">(... </font><font color="#008000"><i>{ get current time }
</i></font>System<font color="#000080">: </font>Halt<font color="#000080">(</font>code<font color="#000080">); </font><font color="#008000"><i>{ quits program immediately with an errorlevel }
</i></font>System<font color="#000080">: </font>MkDir<font color="#000080">(</font>str<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">); </font><font color="#008000"><i>{ makes a directory named str }
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>PackTime<font color="#000080">(... </font><font color="#008000"><i>{ packs a time/date }
</i></font>System<font color="#000080">: </font>Rename<font color="#000080">(</font><font color="#FF0000"><b>file</b></font><font color="#000080">: </font>filetype<font color="#000080">); </font><font color="#008000"><i>{ renames an external file }
</i></font>System<font color="#000080">: </font>RmDir<font color="#000080">(</font>str<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">); </font><font color="#008000"><i>{ removes a dir named str }
</i></font>System<font color="#000080">: </font>Seek<font color="#000080">(</font><font color="#FF0000"><b>file</b></font><font color="#000080">: </font>filetype<font color="#000080">); </font><font color="#008000"><i>{ finds an element # in a file }
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>SetDate<font color="#000080">( ... </font><font color="#008000"><i>{ sets the date on the machine }
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>SetFTime<font color="#000080">(... </font><font color="#008000"><i>{ sets the date and time of a file }
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>SetTime<font color="#000080">(...  </font><font color="#008000"><i>{ set the time on the machine }
</i></font>DOS<font color="#000080">/</font>WinDos<font color="#000080">: </font>UnpackTime<font color="#000080">(... </font><font color="#008000"><i>{ unpacks a time/date to datetime record }

</i></font>Notes <font color="#FF0000"><b>on </b></font>some <font color="#FF0000"><b>of </b></font>the commands listed above that aren<font color="#800000">'t that self-
</font>explanatory
<font color="#000080">---------------------------------------------------------------------
</font>Diskfree<font color="#000080">(</font>Drive<font color="#000080">: </font>byte<font color="#000080">): </font>longint<font color="#000080">;
</font>DiskSize<font color="#000080">(</font>Drive<font color="#000080">: </font>byte<font color="#000080">): </font>longint<font color="#000080">;
     </font>Drive <font color="#FF0000"><b>is </b></font>a numerical byte<font color="#000080">: </font><font color="#800000">0 </font><font color="#FF0000"><b>is </b></font>the current drive<font color="#000080">.
                                </font><font color="#800000">1 </font><font color="#FF0000"><b>is </b></font>A drive<font color="#000080">.
                                </font><font color="#800000">2 </font><font color="#FF0000"><b>is </b></font>B drive<font color="#000080">.
                                </font><font color="#800000">3 </font><font color="#FF0000"><b>is </b></font>C drive<font color="#000080">.
                                </font><font color="#FF0000"><b>and </b></font>so <font color="#FF0000"><b>on and </b></font>so forth<font color="#000080">.

</font>NOTE<font color="#000080">: </font>DiskFree <font color="#FF0000"><b>and </b></font>DiskSize are limited from what I understand <font color="#FF0000"><b>to </b></font><font color="#000080">&lt; </font><font color="#800000">1 </font>gig<font color="#000080">?
(</font>Please correct me <font color="#FF0000"><b>if </b></font>I am <font color="#FF0000"><b>not </b></font>quoting this right<font color="#000080">).  </font>I know there <font color="#FF0000"><b>is </b></font>a
limit there somewhere<font color="#000080">...

</font>DosVersion<font color="#000080">(</font>version<font color="#000080">: </font>word<font color="#000080">);
     </font>You have <font color="#FF0000"><b>to </b></font>use HI <font color="#FF0000"><b>and </b></font>LO functions here <font color="#FF0000"><b>as </b></font>described <font color="#FF0000"><b>in </b></font>part <font color="#800000">7.
     </font>The high order <font color="#FF0000"><b>of </b></font>this expression would be a minor revision number
     <font color="#FF0000"><b>and </b></font>the low order <font color="#FF0000"><b>of </b></font>this expression would be a major revision
     number<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>you have DOS <font color="#800000">6.20</font><font color="#000080">, </font>the high order would be
     <font color="#800000">20</font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>the low order would be <font color="#800000">6.

</font>Any expression that <font color="#FF0000"><b>uses packed and </b></font>unpacked date <font color="#FF0000"><b>and </b></font>time<font color="#000080">.
     </font>There <font color="#FF0000"><b>is </b></font>two <font color="#FF0000"><b>of </b></font>the functions listed above called packtime <font color="#FF0000"><b>and
     </b></font>unpacktime<font color="#000080">.  </font>There <font color="#FF0000"><b>is </b></font>a special <font color="#FF0000"><b>record </b></font>already defined <font color="#FF0000"><b>in </b></font>DOS
     called DateTime <font color="#000080">(</font><font color="#FF0000"><b>or </b></font>TDateTime <font color="#FF0000"><b>in </b></font>WinDOS<font color="#000080">).  </font>Both <font color="#FF0000"><b>of </b></font>these are defined
     like this<font color="#000080">:

     </font>DateTime <font color="#008000"><i>{ or TDateTime -- they're the same } </i></font><font color="#000080">= </font><font color="#FF0000"><b>record
        </b></font>Year<font color="#000080">, </font>Month<font color="#000080">, </font>Day<font color="#000080">, </font>Hour<font color="#000080">, </font>Min<font color="#000080">, </font>Sec<font color="#000080">: </font>word<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>A <font color="#FF0000"><b>packed </b></font>time <font color="#FF0000"><b>is </b></font>stored <font color="#FF0000"><b>as </b></font>a longint<font color="#000080">;

</font>Good use <font color="#FF0000"><b>of </b></font>an erase<font color="#000080">/</font>rename<font color="#000080">, </font>etc<font color="#000080">, </font>etc<font color="#000080">...
     </font>Make a <font color="#FF0000"><b>procedure </b></font>that does the assign<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>error checks<font color="#000080">, </font><font color="#FF0000"><b>then do
     </b></font>the command<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>the command <font color="#FF0000"><b>requires </b></font>the <font color="#FF0000"><b>file to </b></font>be an assigned
     <font color="#FF0000"><b>file </b></font>variable<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">:

     </font><font color="#FF0000"><b>procedure </b></font>deletefile<font color="#000080">(</font>filename<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
       </font><font color="#FF0000"><b>var
         </b></font>afile<font color="#000080">: </font>text<font color="#000080">; </font><font color="#008000"><i>{ It can be anything we will find out }
       </i></font><font color="#FF0000"><b>begin
         </b></font>assign<font color="#000080">(</font>afile<font color="#000080">, </font>filename<font color="#000080">);
         </font><font color="#008000"><i>{$I-}</i></font>erase<font color="#000080">(</font>afile<font color="#000080">);</font><font color="#008000"><i>{$I+}
         </i></font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
           </b></font>writeln<font color="#000080">(</font><font color="#800000">'Erasure unsuccessful.'</font><font color="#000080">);
         </font><font color="#FF0000"><b>else
           </b></font>writeln<font color="#000080">(</font>filename<font color="#000080">, </font><font color="#800000">' has been erased from your drive!'</font><font color="#000080">);
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>Note<font color="#000080">: </font>This erase command <font color="#FF0000"><b>is </b></font>recoverable by use <font color="#FF0000"><b>of </b></font>an undelete <font color="#FF0000"><b>program</b></font><font color="#000080">.
</font>The rewrite <font color="#FF0000"><b>is not </b></font><font color="#000080">(</font>all you<font color="#800000">'ll see is a 0 byte file that replaces the
</font><font color="#FF0000"><b>file </b></font>you rewritten<font color="#000080">).

</font>Parameter Passing
<font color="#000080">=================
</font>You may have noted that we can get parameters <font color="#FF0000"><b>in </b></font>from the command<font color="#000080">-
</font>line <font color="#FF0000"><b>to </b></font>some programs we have used<font color="#000080">, </font>such <font color="#FF0000"><b>as </b></font>PKZIP <font color="#FF0000"><b>and </b></font>PKUNZIP<font color="#000080">.
</font>We can write <font color="#FF0000"><b>and </b></font>design our programs <font color="#FF0000"><b>to do </b></font>such a similar thing<font color="#000080">.

</font>Paramcount<font color="#000080">: </font>integer<font color="#000080">;  </font><font color="#008000"><i>{ holds the number of command-line parameters used }
</i></font>Paramstr<font color="#000080">(</font>num<font color="#000080">: </font>integer<font color="#000080">): </font><font color="#FF0000"><b>string </b></font><font color="#008000"><i>{ specific command-line parameter }

</i></font>An example<font color="#000080">: </font>Write a text <font color="#FF0000"><b>file out to </b></font>the screen using full error<font color="#000080">-</font>checking<font color="#000080">,
</font><font color="#FF0000"><b>and </b></font>taking the filename from the command<font color="#000080">-</font>line<font color="#000080">.  </font>Describes a command<font color="#000080">-</font>line
parameter describing a single <font color="#FF0000"><b>file</b></font><font color="#000080">.

</font><font color="#FF0000"><b>program </b></font>typefile<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>param1<font color="#000080">, </font>instr<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>thefile<font color="#000080">: </font>text<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>paramcount <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then  </b></font><font color="#008000"><i>{ if there is not one command-line parameter }
      </i></font><font color="#FF0000"><b>begin
        </b></font><font color="#008000"><i>{ show some help to the user }
        </i></font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);    </font><font color="#008000"><i>{ quit the program right here }
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>param1 <font color="#000080">:= </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{ corresponds to %1 in batch file processing }
    { always good to do -- found that addressing the function directly as
      a string causes problems }
    </i></font>assign<font color="#000080">(</font>thefile<font color="#000080">, </font>param1<font color="#000080">);
    </font><font color="#008000"><i>{$I-}</i></font>reset<font color="#000080">(</font>thefile<font color="#000080">);</font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
        </b></font>writeln<font color="#000080">(</font><font color="#800000">'This file doesn''t exist!'</font><font color="#000080">);
        </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>readln<font color="#000080">(</font>thefile<font color="#000080">, </font>instr<font color="#000080">);
    </font><font color="#008000"><i>{ if the file is there, no need to error check reads, if our logic
      is correct }
    </i></font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>thefile<font color="#000080">) </font><font color="#FF0000"><b>do
      begin
        </b></font>writeln<font color="#000080">(</font>instr<font color="#000080">);
        </font>readln<font color="#000080">(</font>thefile<font color="#000080">, </font>instr<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>writeln<font color="#000080">(</font>instr<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>Now<font color="#000080">, </font>what <font color="#FF0000"><b>if </b></font>we want <font color="#FF0000"><b>to </b></font>determine a <font color="#FF0000"><b>file </b></font>based <font color="#FF0000"><b>on </b></font>a command<font color="#000080">-</font>line parameter<font color="#000080">.
</font>This isn<font color="#800000">'t exactly complete error checking, as we aren'</font>t processing whether
the <font color="#FF0000"><b>file </b></font>we specify <font color="#FF0000"><b>is </b></font>a directory <font color="#FF0000"><b>or not </b></font><font color="#000080">(</font>EVERYTHING <font color="#FF0000"><b>to </b></font>DOS <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>file of
</b></font>some sort<font color="#000080">, </font>including a directory<font color="#000080">, </font>we can<font color="#800000">'t exactly TYPE a directory...).
</font>That was a demo <font color="#FF0000"><b>of </b></font>picking up command<font color="#000080">-</font>line parameters<font color="#000080">, </font>here<font color="#800000">'s how we
</font>process a filename parameter so we are addressing the correct thing<font color="#000080">,
</font>EVEN a directory<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>series <font color="#FF0000"><b>of </b></font>files <font color="#000080">(</font>Remember wildcards <font color="#FF0000"><b>in </b></font>DOS<font color="#000080">?  </font>The
usage <font color="#FF0000"><b>of </b></font><font color="#000080">* </font><font color="#FF0000"><b>and </b></font><font color="#000080">? </font><font color="#FF0000"><b>in </b></font>specification <font color="#FF0000"><b>of </b></font>files<font color="#000080">).

</font>We use Fexpand<font color="#000080">, </font>Fsplit<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>GetFattr <font color="#FF0000"><b>with </b></font>doing this<font color="#000080">, </font><font color="#FF0000"><b>as </b></font>well <font color="#FF0000"><b>as </b></font>some DOS
defined constants which distinguish between different attributes <font color="#FF0000"><b>of </b></font>files<font color="#000080">.
</font>They are additive<font color="#000080">, </font>BTW<font color="#000080">.

     </font><font color="#FF0000"><b>File </b></font>Attribute Constants
     <font color="#000080">------------------------
        </font>ReadOnly       <font color="#800000">$01
        </font>Hidden         <font color="#800000">$02
        </font>System <font color="#FF0000"><b>File    </b></font><font color="#800000">$04
        </font>Volume ID      <font color="#800000">$08
        </font>Directory      <font color="#800000">$10
        </font>Archive        <font color="#800000">$20
        </font>AnyFile        <font color="#800000">$3F

</font>Look at the DOS dir command <font color="#FF0000"><b>for </b></font>an example<font color="#000080">.  </font>Vary what you <font color="#FF0000"><b>type in</b></font><font color="#000080">,
</font>including directory names<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>variants <font color="#000080">(.., \, </font><font color="#FF0000"><b>and </b></font>just a dirname<font color="#000080">).
</font>See how it acts<font color="#000080">.  </font>That<font color="#800000">'s what we want to emulate.  I will lead in
</font><font color="#FF0000"><b>to </b></font>part <font color="#800000">9 </font>by placing something used <font color="#FF0000"><b>in </b></font>planning called pseudocode
here <font color="#FF0000"><b>to do </b></font>such a thing<font color="#000080">.

</font>EXPAND FILENAME <font color="#FF0000"><b>ON </b></font>COMMAND LINE <font color="#FF0000"><b>TO </b></font>FULL DIR<font color="#000080">, </font>NAME<font color="#000080">, </font><font color="#FF0000"><b>AND </b></font>EXTENSION<font color="#000080">.
</font><font color="#FF0000"><b>IF </b></font>THE <font color="#FF0000"><b>END OF </b></font>THE FILENAME DOES <font color="#FF0000"><b>NOT </b></font>HAVE A <font color="#000080">\ </font><font color="#FF0000"><b>THEN
    </b></font>GET <font color="#FF0000"><b>FILE </b></font>ATTRIBUTE<font color="#000080">.
    </font><font color="#FF0000"><b>IF </b></font>NO DOSERROR <font color="#FF0000"><b>AND </b></font>THE <font color="#FF0000"><b>FILE IS </b></font>A DIRECTORY
       ADD A <font color="#000080">\ </font><font color="#FF0000"><b>TO </b></font>THE <font color="#FF0000"><b>END OF </b></font>THE FILENAME<font color="#000080">.
</font><font color="#FF0000"><b>END</b></font><font color="#000080">-</font><font color="#FF0000"><b>IF</b></font><font color="#000080">.
</font>SPLIT FILENAME INTO PROPER DIR<font color="#000080">, </font>NAME <font color="#FF0000"><b>AND </b></font>EXT<font color="#000080">.
</font><font color="#FF0000"><b>IF </b></font>NO NAME<font color="#000080">, </font><font color="#FF0000"><b>THEN </b></font>PLACE A <font color="#000080">* </font>THERE<font color="#000080">.
</font><font color="#FF0000"><b>IF </b></font>NO EXTENSION<font color="#000080">, </font><font color="#FF0000"><b>THEN </b></font>PLACE A <font color="#000080">.* </font>THERE<font color="#000080">.
</font>FULL FILENAME <font color="#000080">= </font>DIR<font color="#000080">, </font>NAME<font color="#000080">, </font><font color="#FF0000"><b>AND </b></font>EXTENSION TOGETHER<font color="#000080">.

</font>You will have <font color="#FF0000"><b>to </b></font>interpret this into viable code <font color="#FF0000"><b>for </b></font>the programming
problem at the <font color="#FF0000"><b>end of </b></font>the part<font color="#000080">.

</font>Listing a Sequence <font color="#FF0000"><b>of </b></font>Files
<font color="#000080">===========================
</font>Now<font color="#000080">, </font><font color="#FF0000"><b>to </b></font>answer the question<font color="#000080">, </font>what <font color="#FF0000"><b>if </b></font>we want <font color="#FF0000"><b>to </b></font>actually <font color="#FF0000"><b>do </b></font>something
<font color="#FF0000"><b>with </b></font>multiple files <font color="#000080">(</font>specified <font color="#FF0000"><b>with </b></font><font color="#000080">* </font><font color="#FF0000"><b>and </b></font><font color="#000080">?), </font>instead <font color="#FF0000"><b>of </b></font>just one <font color="#FF0000"><b>file
</b></font><font color="#000080">(</font><font color="#FF0000"><b>if </b></font>we want just one <font color="#FF0000"><b>file</b></font><font color="#000080">, </font><font color="#FF0000"><b>if </b></font>we <font color="#FF0000"><b>do </b></font>the i<font color="#000080">/</font>o checking <font color="#FF0000"><b>on </b></font>reset <font color="#FF0000"><b>or
</b></font>rewrite<font color="#000080">, </font>we will get an error <font color="#FF0000"><b>if </b></font>they use <font color="#000080">* </font><font color="#FF0000"><b>or </b></font><font color="#000080">? </font><font color="#FF0000"><b>in </b></font>the name<font color="#000080">.).

</font>We need <font color="#FF0000"><b>to </b></font>define the usage <font color="#FF0000"><b>of </b></font>a <font color="#FF0000"><b>record as </b></font>a searchrec <font color="#FF0000"><b>type for </b></font>DOS
<font color="#000080">(</font><font color="#FF0000"><b>or </b></font>TSearchRec <font color="#FF0000"><b>for </b></font>WinDos<font color="#000080">).

      </font>searchrec <font color="#000080">= </font><font color="#FF0000"><b>record
         </b></font>fill<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">21</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
         </font>attr<font color="#000080">: </font>byte<font color="#000080">;       </font><font color="#008000"><i>{ additive from the file attribute constants }
         </i></font>time<font color="#000080">: </font>longint<font color="#000080">;    </font><font color="#008000"><i>{ Packed Time }
         </i></font>size<font color="#000080">: </font>longint<font color="#000080">;    </font><font color="#008000"><i>{ Size of file }
         </i></font>name<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">]; </font><font color="#008000"><i>{ name of file }
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>This <font color="#FF0000"><b>record</b></font><font color="#000080">, </font><font color="#FF0000"><b>as </b></font>well <font color="#FF0000"><b>as </b></font>DateTime <font color="#FF0000"><b>is </b></font>defined <font color="#FF0000"><b>in </b></font>the DOS <font color="#FF0000"><b>unit</b></font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>we don<font color="#800000">'t
</font>NEED <font color="#FF0000"><b>to </b></font>define these <font color="#FF0000"><b>in </b></font>our programs<font color="#000080">...</font>They are used <font color="#FF0000"><b>with </b></font>the FindFirst
<font color="#FF0000"><b>and </b></font>FindNext procedures<font color="#000080">, </font>which are demoed below<font color="#000080">, </font>listing all filenames
<font color="#FF0000"><b>in </b></font>the current directory<font color="#000080">.

</font><font color="#FF0000"><b>program </b></font>tutorial19<font color="#000080">; </font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>fileinfo<font color="#000080">: </font>searchrec<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>findfirst<font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">, </font><font color="#800000">$37</font><font color="#000080">, </font>fileinfo<font color="#000080">);
    </font><font color="#FF0000"><b>while </b></font>doserror <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do         </b></font><font color="#008000"><i>{ 18 = no more files }
      </i></font><font color="#FF0000"><b>begin
        </b></font>writeln<font color="#000080">(</font>fileinfo<font color="#000080">.</font>name<font color="#000080">);
        </font>findnext<font color="#000080">(</font>fileinfo<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#FF0000"><b>As </b></font>a note<font color="#000080">: . </font><font color="#FF0000"><b>and </b></font><font color="#000080">.. </font>are filenames<font color="#000080">.  . </font><font color="#FF0000"><b>is </b></font>the base <font color="#FF0000"><b>of </b></font>the <font color="#FF0000"><b>file </b></font>system<font color="#000080">, ..
</font><font color="#FF0000"><b>is </b></font>the next directory up<font color="#000080">....

</font>Executing a <font color="#FF0000"><b>Program
</b></font><font color="#000080">===================
</font>You can execute a <font color="#FF0000"><b>program </b></font>from your <font color="#FF0000"><b>program </b></font>by using the exec <font color="#FF0000"><b>procedure</b></font><font color="#000080">.
</font>You also have <font color="#FF0000"><b>to </b></font>use the <font color="#800000">$</font>M compiler directive<font color="#000080">.  </font>It<font color="#800000">'s a directive to
</font>determine the stack size<font color="#000080">, </font><font color="#FF0000"><b>as </b></font>well <font color="#FF0000"><b>as </b></font>the minimum <font color="#FF0000"><b>and </b></font>maximum heap size<font color="#000080">.
</font>You must <font color="#FF0000"><b>set </b></font>this <font color="#FF0000"><b>for to </b></font>get the memory <font color="#FF0000"><b>to </b></font>run the <font color="#FF0000"><b>program</b></font><font color="#000080">.  </font>The format
<font color="#FF0000"><b>of </b></font>the <font color="#800000">$</font>M compiler directive <font color="#FF0000"><b>is </b></font>this<font color="#000080">:

  </font><font color="#008000"><i>{$M &lt;stacksize&gt;,&lt;minheapsize&gt;,&lt;maxheapsize&gt;}

</i></font><font color="#FF0000"><b>If </b></font>you don<font color="#800000">'t set this, maxheapsize defaults to all of your conventional
</font>memory<font color="#000080">, </font>definitely <font color="#FF0000"><b>not </b></font>good <font color="#FF0000"><b>if </b></font>we want <font color="#FF0000"><b>to </b></font>give the memory <font color="#FF0000"><b>to </b></font>a <font color="#FF0000"><b>program
to </b></font>even run <font color="#000080">(</font>nothing will happen <font color="#FF0000"><b>if </b></font>the <font color="#FF0000"><b>program </b></font>doesn<font color="#800000">'t have the memory
</font><font color="#FF0000"><b>to </b></font>run<font color="#000080">).  </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">, </font>we will use <font color="#008000"><i>{$M $4000,0,0}</i></font><font color="#000080">.  </font>Here <font color="#FF0000"><b>is </b></font>the format
<font color="#FF0000"><b>of </b></font>the EXEC command<font color="#000080">.

  </font>exec<font color="#000080">(&lt;</font>command interpreter path<font color="#000080">&gt;, &lt;</font>command<font color="#000080">&gt;);

</font>command interpreter path <font color="#000080">-&gt; </font>Where <font color="#FF0000"><b>is </b></font>COMMAND<font color="#000080">.</font>COM<font color="#000080">?  </font>We can use getenv
<font color="#FF0000"><b>to </b></font>get the environment variable named COMSPEC <font color="#FF0000"><b>to </b></font>get this<font color="#000080">.  </font>I<font color="#800000">'ve had
</font>people <font color="#FF0000"><b>try to </b></font>rebunk me <font color="#FF0000"><b>to </b></font>say that you could just say exec<font color="#000080">(&lt;</font>command<font color="#000080">&gt;);.
</font>It DOES <font color="#FF0000"><b>NOT </b></font>WORK<font color="#000080">! (</font>the compiler says something about expecting a <font color="#000080">,.
</font>You must <font color="#FF0000"><b>do </b></font>it this way<font color="#000080">!) -- </font>I<font color="#800000">'m only trying to head off this issue.

</font>command <font color="#000080">-&gt; </font>This must be <font color="#000080">/</font>C <font color="#000080">+ </font>whatever command you call<font color="#000080">....

</font>Another command used <font color="#FF0000"><b>in </b></font>combination <font color="#FF0000"><b>with </b></font>this <font color="#FF0000"><b>is </b></font>called swapvectors<font color="#000080">.
</font>It <font color="#FF0000"><b>is </b></font>a parameterless <font color="#FF0000"><b>procedure </b></font>which makes sure our <font color="#FF0000"><b>program </b></font>we call
doesn<font color="#800000">'t literally stomp all over anything we may have done with the
</font>system<font color="#000080">.  </font>We call it before <font color="#FF0000"><b>and </b></font>after our exec <font color="#FF0000"><b>procedure</b></font><font color="#000080">.

</font>Here<font color="#800000">'s an example:

</font><font color="#008000"><i>{$M $4000,0,0}
</i></font><font color="#FF0000"><b>program </b></font>tutorial20<font color="#000080">; </font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>command<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>write<font color="#000080">(</font><font color="#800000">'Enter a DOS command: '</font><font color="#000080">);
    </font>readln<font color="#000080">(</font>command<font color="#000080">);
    </font>command <font color="#000080">:= </font><font color="#800000">'/C' </font><font color="#000080">+ </font>command<font color="#000080">;
    </font><font color="#008000"><i>{ we must put the /C there to satisfy COMMAND.COM }
    </i></font>swapvectors<font color="#000080">;
    </font>exec<font color="#000080">(</font>getenv<font color="#000080">(</font><font color="#800000">'COMSPEC'</font><font color="#000080">), </font>command<font color="#000080">);
    </font>swapvectors<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>doserror <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'Dos Error '</font><font color="#000080">, </font>doserror<font color="#000080">, </font><font color="#800000">' occurred.'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'Successful shell to DOS.'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>Use DosExitCode <font color="#FF0000"><b>in </b></font>addition <font color="#FF0000"><b>to </b></font>doserror <font color="#FF0000"><b>to </b></font>determine the results <font color="#FF0000"><b>of </b></font>the
exec<font color="#800000">'d procedure.  This function returns a word, which we have to use
</font>the HI <font color="#FF0000"><b>and </b></font>LO functions <font color="#FF0000"><b>on</b></font><font color="#000080">.  </font>LO code results correspond <font color="#FF0000"><b>to </b></font>errorlevel
returned <font color="#FF0000"><b>out of </b></font>DOS <font color="#000080">(</font>remember batch <font color="#FF0000"><b>file </b></font>programming<font color="#000080">?).  </font>A list <font color="#FF0000"><b>of </b></font>HI
code results follow<font color="#000080">:

            </font><font color="#800000">0       </font>Normal Termination
            <font color="#800000">1       </font>Terminated by Ctrl<font color="#000080">+</font>C
            <font color="#800000">2       </font>Terminated by Device Error
            <font color="#800000">3       </font>Terminated <font color="#FF0000"><b>as </b></font>a TSR<font color="#000080">.
 
</font>Conclusion
<font color="#000080">==========
</font>We have covered the major issues <font color="#FF0000"><b>in </b></font>DOS <font color="#FF0000"><b>file </b></font>commands<font color="#000080">, </font><font color="#FF0000"><b>as </b></font>well <font color="#FF0000"><b>as
</b></font>listing some <font color="#FF0000"><b>of </b></font>the straight<font color="#000080">-</font><font color="#FF0000"><b>forward </b></font>commands that are <font color="#FF0000"><b>in Pascal
to </b></font>work <font color="#FF0000"><b>with </b></font>DOS<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>you looked those up<font color="#000080">, </font>you would have found that
most <font color="#FF0000"><b>of </b></font>those things are pretty straight<font color="#000080">-</font><font color="#FF0000"><b>forward</b></font><font color="#000080">.  </font>Here <font color="#FF0000"><b>is </b></font>a practice
programming problem that duplicates the <font color="#FF0000"><b>function of </b></font>the DIR command
<font color="#FF0000"><b>in </b></font>DOS<font color="#000080">, </font>showing us files <font color="#FF0000"><b>with </b></font>specified information<font color="#000080">.  </font>It will be a
clone <font color="#FF0000"><b>with </b></font>different functions<font color="#000080">, </font>though<font color="#000080">.  </font>Let us see<font color="#000080">....

</font>Practice Programming Problem <font color="#800000">#8
</font><font color="#000080">===============================
        </font>Write a <font color="#FF0000"><b>program in Pascal and </b></font>entirely <font color="#FF0000"><b>Pascal </b></font>that will show
us a listing <font color="#FF0000"><b>of </b></font>all files <font color="#FF0000"><b>in </b></font>a directory given <font color="#FF0000"><b>on </b></font>the command<font color="#000080">-</font>line<font color="#000080">.
</font>It should also support command line parameters that change <font color="#FF0000"><b>function</b></font><font color="#000080">,
</font>such <font color="#FF0000"><b>as </b></font><font color="#800000">'/?' </font><font color="#FF0000"><b>and </b></font><font color="#800000">'/P'</font><font color="#000080">.  </font>Those are the two command<font color="#000080">-</font>line parameters that
we should support <font color="#000080">(</font>be sure we make it <font color="#FF0000"><b>case </b></font>insensitive<font color="#000080">).  /? </font><font color="#FF0000"><b>or </b></font><font color="#000080">-?
</font>will show us help <font color="#FF0000"><b>and </b></font>a listing <font color="#FF0000"><b>of </b></font>who wrote the <font color="#FF0000"><b>program and then
</b></font>terminate the <font color="#FF0000"><b>program</b></font><font color="#000080">.  /</font>P <font color="#FF0000"><b>or </b></font><font color="#000080">-</font>p should make it so we pause the screen
output <font color="#FF0000"><b>on </b></font>each page<font color="#000080">.  </font>It also should handle any error<font color="#000080">-</font>checking that
it may need <font color="#FF0000"><b>to </b></font>perform <font color="#FF0000"><b>as </b></font>presented <font color="#FF0000"><b>in </b></font>this part<font color="#000080">.

</font>Functions<font color="#000080">:
</font><font color="#800000">1</font><font color="#000080">) </font>Show us <font color="#FF0000"><b>for </b></font>each filename <font color="#FF0000"><b>on </b></font>one line<font color="#000080">, </font>a size<font color="#000080">, </font><font color="#FF0000"><b>file </b></font>attributes<font color="#000080">, </font>date
<font color="#FF0000"><b>and </b></font>time<font color="#000080">.
</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>For </b></font>the whole listing <font color="#FF0000"><b>of </b></font>files<font color="#000080">, </font>show us<font color="#000080">: </font>The volume <font color="#FF0000"><b>label</b></font><font color="#000080">, </font>Size <font color="#FF0000"><b>of </b></font>the
drive we listed<font color="#000080">, </font>bytes free <font color="#FF0000"><b>on </b></font>the drive we listed<font color="#000080">, </font>total number <font color="#FF0000"><b>of
</b></font>files listed<font color="#000080">, </font>total number <font color="#FF0000"><b>of </b></font>directories listed<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>DOS version that
<font color="#FF0000"><b>is </b></font>being used at the current time<font color="#000080">.
</font><font color="#800000">3</font><font color="#000080">) </font>All integers <font color="#FF0000"><b>or </b></font>longints <font color="#000080">&gt; </font><font color="#800000">999 </font>should be delinated by commas<font color="#000080">, </font><font color="#FF0000"><b>or
</b></font>periods<font color="#000080">, </font>whatever you use<font color="#000080">.
</font><font color="#800000">4</font><font color="#000080">) </font>Write r <font color="#FF0000"><b>for </b></font>read<font color="#000080">-</font>only<font color="#000080">, </font>a <font color="#FF0000"><b>for </b></font>archive<font color="#000080">, </font>s <font color="#FF0000"><b>for </b></font>system<font color="#000080">, </font>h <font color="#FF0000"><b>for </b></font>hidden<font color="#000080">.
</font>Put the proper ones that apply by each <font color="#FF0000"><b>file </b></font>that it lists<font color="#000080">.
</font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>For </b></font>reading command<font color="#000080">-</font>line parameters<font color="#000080">, </font>be sure <font color="#FF0000"><b>to </b></font>make the order
non<font color="#000080">-</font>specific<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">, </font>MYDIR c<font color="#000080">:\</font>windows <font color="#000080">/</font>p <font color="#FF0000"><b>and </b></font>MYDIR <font color="#000080">/</font>p c<font color="#000080">:\</font>windows
should accomplish the same thing<font color="#000080">, </font>viewing the windows directory <font color="#FF0000"><b>with
</b></font>page pausing<font color="#000080">.

</font>Hints<font color="#000080">:
</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>If </b></font>a <font color="#FF0000"><b>file with </b></font>a volumeID attribute exists <font color="#FF0000"><b>in </b></font>the main directory <font color="#FF0000"><b>of
</b></font>a drive<font color="#000080">, </font>the name <font color="#FF0000"><b>of </b></font>the <font color="#FF0000"><b>file is </b></font>the volumeID <font color="#FF0000"><b>of </b></font>the drive<font color="#000080">.
</font><font color="#800000">2</font><font color="#000080">) </font>Work <font color="#FF0000"><b>with </b></font>the number <font color="#FF0000"><b>as </b></font>a <font color="#FF0000"><b>string and </b></font>go from the right <font color="#FF0000"><b>end to </b></font>the
left <font color="#FF0000"><b>end to </b></font>place commas <font color="#FF0000"><b>as </b></font>strings <font color="#FF0000"><b>for function </b></font>point <font color="#800000">3.
3</font><font color="#000080">) </font>You may want <font color="#FF0000"><b>to </b></font>use a designed <font color="#FF0000"><b>record type to </b></font>hold the final data
you are going <font color="#FF0000"><b>to </b></font>write <font color="#FF0000"><b>as </b></font>you go obtain it <font color="#FF0000"><b>to </b></font>make things easier<font color="#000080">.
</font><font color="#800000">4</font><font color="#000080">) </font>This DIR listing command you are writing should <font color="#FF0000"><b>function </b></font>from the
command<font color="#000080">-</font>line <font color="#FF0000"><b>with </b></font>regards <font color="#FF0000"><b>to </b></font>filespec exactly like the DOS dir
command<font color="#000080">.  </font>Check this one by playing around <font color="#FF0000"><b>with </b></font>the DOS dir command<font color="#000080">.
</font><font color="#800000">5</font><font color="#000080">) </font>Hint <font color="#FF0000"><b>for </b></font>the <font color="#800000">#5 </font><font color="#FF0000"><b>function</b></font><font color="#000080">.  </font>Hold the parameter strings <font color="#FF0000"><b>in </b></font>an <font color="#FF0000"><b>array
and </b></font>write some code <font color="#FF0000"><b>to </b></font>differentiate between command<font color="#000080">-</font>line params <font color="#FF0000"><b>and
</b></font>the actual path you want <font color="#FF0000"><b>to </b></font>view<font color="#000080">.
</font><font color="#800000">6</font><font color="#000080">) </font><font color="#FF0000"><b>For </b></font>the <font color="#FF0000"><b>string with </b></font>the attributes<font color="#000080">, </font>build your <font color="#FF0000"><b>string</b></font><font color="#000080">.  </font>You can
directly address <font color="#FF0000"><b>and </b></font>build a <font color="#FF0000"><b>string with </b></font>certain portions <font color="#FF0000"><b>as </b></font>long
<font color="#FF0000"><b>as </b></font>you start <font color="#FF0000"><b>with </b></font>a valid length <font color="#FF0000"><b>of </b></font>something<font color="#000080">.  </font>I will explain this
<font color="#FF0000"><b>in </b></font>the next part<font color="#000080">.

</font>Sample output <font color="#FF0000"><b>for </b></font>yourdir command<font color="#000080">.
----------------------------------
</font>C<font color="#000080">:\&gt;</font>mydir <font color="#000080">/?

</font>MYDIR <font color="#000080">(</font>c<font color="#000080">) </font><font color="#800000">1996 </font>by Glenn Grotzinger<font color="#000080">.  </font><font color="#008000"><i>{ put your name here, of course }

</i></font>Help<font color="#000080">:
  </font>MYDIR <font color="#000080">&lt;</font>filespec<font color="#000080">&gt; /&lt;</font>parameters<font color="#000080">&gt;
  </font>filespec <font color="#FF0000"><b>is </b></font>the filename<font color="#000080">/</font>dirname<font color="#000080">(</font>s<font color="#000080">) </font>we want <font color="#FF0000"><b>to </b></font>list<font color="#000080">.
  </font>parameters are <font color="#000080">? </font><font color="#FF0000"><b>or </b></font>P
       <font color="#000080">? --&gt; </font>this help<font color="#000080">.
       </font>P <font color="#000080">--&gt; </font>pause <font color="#FF0000"><b>on </b></font>each screen page<font color="#000080">.

</font>C<font color="#000080">:\&gt;</font>mydir

MYDIR <font color="#000080">(</font>c<font color="#000080">) </font><font color="#800000">1996 </font>by Glenn Grotzinger<font color="#000080">.

</font><font color="#FF0000"><b>File </b></font>listing <font color="#FF0000"><b>for</b></font><font color="#000080">: </font>C<font color="#000080">:\*.*

.                                                  [</font>DIR<font color="#000080">]
..                                                 [</font>DIR<font color="#000080">]
</font>CONFIG<font color="#000080">.</font>SYS              <font color="#800000">122    12</font><font color="#000080">-</font><font color="#800000">12</font><font color="#000080">-</font><font color="#800000">95    03</font><font color="#000080">:</font><font color="#800000">45</font>pm  rash
DESCRIPT<font color="#000080">.</font>ION            <font color="#800000">182    12</font><font color="#000080">-</font><font color="#800000">28</font><font color="#000080">-</font><font color="#800000">95    12</font><font color="#000080">:</font><font color="#800000">14</font>am  <font color="#000080">-</font>a<font color="#000080">--    
</font>ARCHIVE<font color="#000080">.</font>ZIP      <font color="#800000">14</font><font color="#000080">,</font><font color="#800000">432</font><font color="#000080">,</font><font color="#800000">322    03</font><font color="#000080">-</font><font color="#800000">24</font><font color="#000080">-</font><font color="#800000">93    09</font><font color="#000080">:</font><font color="#800000">15</font>pm  r<font color="#000080">--</font>h  

Volume <font color="#FF0000"><b>label</b></font><font color="#000080">:          </font>Total files<font color="#000080">: </font><font color="#800000">3      </font>Total dirs<font color="#000080">: </font><font color="#800000">2
</font>DOS Version<font color="#000080">: </font><font color="#800000">6.22

14</font><font color="#000080">,</font><font color="#800000">432</font><font color="#000080">,</font><font color="#800000">626 </font>bytes<font color="#000080">.
</font><font color="#800000">214</font><font color="#000080">,</font><font color="#800000">232</font><font color="#000080">,</font><font color="#800000">123 </font>bytes used <font color="#FF0000"><b>out of </b></font><font color="#800000">543</font><font color="#000080">,</font><font color="#800000">212</font><font color="#000080">,</font><font color="#800000">123 </font>total bytes<font color="#000080">.

</font>You get the general idea<font color="#000080">....</font>BTW<font color="#000080">, </font><font color="#FF0000"><b>for </b></font>me<font color="#000080">, </font>this one <font color="#FF0000"><b>is </b></font><font color="#800000">310 </font>lines<font color="#000080">..
</font>The next practice <font color="#FF0000"><b>program </b></font>given will be <font color="#FF0000"><b>in </b></font>part <font color="#800000">10.  </font>This one
<font color="#FF0000"><b>and </b></font>the one <font color="#FF0000"><b>in </b></font>part <font color="#800000">10 </font>will be the longest <font color="#FF0000"><b>and </b></font>probably most
complex ones <font color="#FF0000"><b>in </b></font>the whole <font color="#FF0000"><b>set of pascal </b></font>tutorials<font color="#000080">.  </font>It would be
good <font color="#FF0000"><b>for </b></font>ANYBODY who wants the practice <font color="#FF0000"><b>to do </b></font>these<font color="#000080">.

</font>Next time
<font color="#000080">=========
</font>We will <font color="#FF0000"><b>do </b></font>the first part <font color="#FF0000"><b>of </b></font>the tutorial covering applications
development<font color="#000080">.  </font><font color="#FF0000"><b>In </b></font>doing that<font color="#000080">, </font>we will develop this DIR equivalent
that I posed above<font color="#000080">.  </font><font color="#FF0000"><b>Do </b></font>practice<font color="#000080">, </font>though<font color="#000080">, </font><font color="#FF0000"><b>and do </b></font>this one<font color="#000080">.  </font>Any
comments<font color="#000080">, </font>questions<font color="#000080">, </font>etc<font color="#000080">, </font>may go <font color="#FF0000"><b>to </b></font>ggrotz<font color="#000080">@</font><font color="#800000">2</font>sprint<font color="#000080">.</font>net<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TUTOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p></body>
</html>
