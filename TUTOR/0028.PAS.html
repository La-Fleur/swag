<html>
<head><title> "INTRODUCTION TO ASSEMBLY" by GAVIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TUTOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0028.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">A introduction <font color="#FF0000"><b>to </b></font>x86 assembly
Written by Gavin Estey		          email<font color="#000080">: </font>gavin<font color="#000080">@</font>senator<font color="#000080">.</font>demon<font color="#000080">.</font>co<font color="#000080">.</font>uk        
	
This document <font color="#FF0000"><b>is </b></font>version<font color="#000080">: 

</font><font color="#800000">0.9 </font>Beta <font color="#800000">2</font><font color="#000080">/</font><font color="#800000">19</font><font color="#000080">/</font><font color="#800000">95


</font>This will hopefully be the final version <font color="#FF0000"><b>of </b></font>this unless somebody finds some 
mistakes <font color="#FF0000"><b>in </b></font>it<font color="#000080">. </font>I have spent over <font color="#800000">620 </font>minutes creating this document <font color="#000080">(</font><font color="#FF0000"><b>not 
</b></font>including writing <font color="#FF0000"><b>or </b></font>testing the code <font color="#FF0000"><b>or </b></font>the original text document<font color="#000080">) </font>so I hope 
you will find it useful<font color="#000080">.

</font>This version <font color="#FF0000"><b>is </b></font>still <font color="#FF0000"><b>in </b></font>testing which means that I cannot be sure that all the code 
will compile <font color="#FF0000"><b>and </b></font>work correctly<font color="#000080">. </font>I have done my best <font color="#FF0000"><b>to </b></font>make sure that all the 
information contained <font color="#FF0000"><b>in </b></font>this document <font color="#FF0000"><b>is </b></font>correct<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>any mistakes are found 
please could you notify me be email<font color="#000080">.

</font><font color="#FF0000"><b>If </b></font>someone who has a computer that doesn<font color="#000080">’</font>t have a VGA card<font color="#000080">/</font>monitor could you 
please compile the code <font color="#FF0000"><b>on </b></font>P29 that checks what graphics the computer can handle 
<font color="#FF0000"><b>and </b></font>tell me <font color="#FF0000"><b>if </b></font>it returned DX <font color="#FF0000"><b>as </b></font><font color="#800000">0. 

</font>This document was written by Gavin Estey<font color="#000080">. </font>No part <font color="#FF0000"><b>of </b></font>this can be reproduced <font color="#FF0000"><b>and </b></font>sold 
<font color="#FF0000"><b>in </b></font>any commercial product without my written permission <font color="#000080">(</font>email me <font color="#FF0000"><b>for </b></font>more 
information<font color="#000080">). </font>I am <font color="#FF0000"><b>not </b></font>responsible <font color="#FF0000"><b>for </b></font>any damage caused <font color="#FF0000"><b>in </b></font>anyway from this 
document<font color="#000080">.

</font><font color="#FF0000"><b>If </b></font>you enjoy this document <font color="#FF0000"><b>then </b></font>a donation would be gratefully received<font color="#000080">. </font>No payment 
<font color="#FF0000"><b>is </b></font>necessary but none will turned down<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>any mistakes are noticed <font color="#FF0000"><b>then </b></font>I would like <font color="#FF0000"><b>to 
</b></font>be notified<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you would like any other help <font color="#FF0000"><b>or </b></font>have suggestions <font color="#FF0000"><b>for </b></font>a later version <font color="#FF0000"><b>of 
</b></font>this document<font color="#000080">.</font>	     

Firstly you will need a suitable <font color="#FF0000"><b>assembler to </b></font>compile your programs<font color="#000080">. </font>All examples have 
been tested <font color="#FF0000"><b>with </b></font>two compilers<font color="#000080">: </font>A86 <font color="#FF0000"><b>and </b></font>Turbo <font color="#FF0000"><b>Assembler</b></font><font color="#000080">&acirc;  </font>ver <font color="#800000">4. </font>A86 <font color="#FF0000"><b>is </b></font>a very 
good shareware <font color="#FF0000"><b>assembler </b></font>capable <font color="#FF0000"><b>of </b></font>producing code up <font color="#FF0000"><b>to </b></font><font color="#800000">80286. </font>This can be found 
<font color="#FF0000"><b>on </b></font>your local simtel mirror <font color="#000080">(</font><font color="#FF0000"><b>try </b></font>ftp<font color="#000080">.</font>demon<font color="#000080">.</font>co<font color="#000080">.</font>uk <font color="#FF0000"><b>or </b></font>ftp<font color="#000080">.</font>cdrom<font color="#000080">.</font>com<font color="#000080">) </font>under 
simtel<font color="#000080">/</font>msdos<font color="#000080">/</font>asmutil called A86V322<font color="#000080">.</font>ZIP<font color="#000080">. 

</font>Firstly I am going <font color="#FF0000"><b>to </b></font>talk about SEGMENTS <font color="#FF0000"><b>and </b></font>OFFSETS<font color="#000080">. </font>This <font color="#000080">(</font><font color="#FF0000"><b>for </b></font>me anyway<font color="#000080">) </font><font color="#FF0000"><b>is 
</b></font>probably the hardest part <font color="#FF0000"><b>of </b></font>assembly <font color="#FF0000"><b>to </b></font>understand<font color="#000080">. 


</font>Segments <font color="#FF0000"><b>and </b></font>offsets<font color="#000080">:

</font>The original designers <font color="#FF0000"><b>of </b></font>the <font color="#800000">8088 </font>decided that nobody will every need <font color="#FF0000"><b>to </b></font>use more 
that one megabyte <font color="#FF0000"><b>of </b></font>memory<font color="#000080">. </font>So they built the chip so it couldn<font color="#800000">'t access above that. 
</font>The problem <font color="#FF0000"><b>is to </b></font>access a whole megabyte <font color="#800000">20 </font>bits are needed <font color="#000080">(</font>one bit being either a 
one <font color="#FF0000"><b>or </b></font>a zero<font color="#000080">). </font>Registers only have <font color="#800000">16 </font>bits <font color="#FF0000"><b>and </b></font>they didn<font color="#800000">'t want to use two because 
</font>that would be <font color="#800000">32 </font>bits <font color="#FF0000"><b>and </b></font>they thought that this would be too much <font color="#FF0000"><b>for </b></font>anyone<font color="#000080">. </font>They 
decided <font color="#FF0000"><b>to do </b></font>the addressing <font color="#FF0000"><b>with </b></font>two registers but <font color="#FF0000"><b>not </b></font><font color="#800000">32 </font>bits<font color="#000080">. </font><font color="#FF0000"><b>Is </b></font>this confusing<font color="#000080">? 
</font>Blame the designers <font color="#FF0000"><b>of </b></font>the <font color="#800000">8088.

</font>OFFSET <font color="#000080">= </font>SEGMENT <font color="#000080">* </font><font color="#800000">16
</font>SEGMENT <font color="#000080">= </font>OFFSET <font color="#000080">/ </font><font color="#800000">16 </font><font color="#000080">(</font>the lower <font color="#800000">4 </font>bits are lost<font color="#000080">)

</font>SEGMENT <font color="#000080">* </font><font color="#800000">16</font>	<font color="#000080">|</font><font color="#800000">0010010000010000 </font><font color="#000080">- ---|  </font>range <font color="#000080">(</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">65535</font><font color="#000080">) * </font><font color="#800000">16
</font>OFFSET         		<font color="#000080">|-- - -</font><font color="#800000">0100100000100010</font><font color="#000080">|  </font>range <font color="#000080">(</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">65535</font><font color="#000080">)
</font><font color="#800000">20 </font>bit address		<font color="#000080">|</font><font color="#800000">00101000100100100010</font><font color="#000080">|  </font>range <font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">1048575 </font><font color="#000080">(</font><font color="#800000">1 </font>MEG<font color="#000080">)
</font>		             <font color="#000080">=====  </font>DS <font color="#000080">=====
</font>		                      <font color="#000080">====== </font>SI <font color="#000080">===== 

(</font>note DS <font color="#FF0000"><b>and </b></font>SI overlap<font color="#000080">). </font>This <font color="#FF0000"><b>is </b></font>how DS<font color="#000080">:</font>SI <font color="#FF0000"><b>is </b></font>used <font color="#FF0000"><b>to </b></font>make a <font color="#800000">20 </font>bit address<font color="#000080">. </font>The 
segment <font color="#FF0000"><b>is in </b></font>DS <font color="#FF0000"><b>and </b></font>the offset <font color="#FF0000"><b>is in </b></font>SI<font color="#000080">.
</font>Segment registers are<font color="#000080">: </font>CS<font color="#000080">, </font>DS<font color="#000080">, </font>ES<font color="#000080">, </font>SS<font color="#000080">. </font><font color="#FF0000"><b>On </b></font>the <font color="#800000">386</font><font color="#000080">+ </font>there are also FS <font color="#000080">&amp; </font>GS

Offset registers  are<font color="#000080">: </font>BX<font color="#000080">, </font>DI<font color="#000080">, </font>SI<font color="#000080">, </font>BP<font color="#000080">, </font>SP<font color="#000080">, </font>IP<font color="#000080">.  </font><font color="#FF0000"><b>In </b></font><font color="#800000">386</font><font color="#000080">+ </font><font color="#FF0000"><b>protected </b></font>mode<font color="#000080">, </font>ANY general 
<font color="#FF0000"><b>register </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>a segment <font color="#FF0000"><b>register</b></font><font color="#000080">) </font>can be used <font color="#FF0000"><b>as </b></font>an  Offset <font color="#FF0000"><b>register</b></font><font color="#000080">.  (</font><font color="#FF0000"><b>Except </b></font>IP<font color="#000080">, </font>which 
you can<font color="#800000">'t access.)

</font>Registers<font color="#000080">:

</font>AX<font color="#000080">, </font>BX<font color="#000080">, </font>CX <font color="#FF0000"><b>and </b></font>DX are general purpose registers<font color="#000080">. </font><font color="#FF0000"><b>On </b></font>a <font color="#800000">386</font><font color="#000080">+ </font>they are <font color="#800000">32 </font>bits<font color="#000080">; </font>EAX<font color="#000080">, 
</font>EBX<font color="#000080">, </font>ECX <font color="#FF0000"><b>and </b></font>EDX<font color="#000080">. </font>The all can be split up into high <font color="#FF0000"><b>and </b></font>low parts<font color="#000080">, </font>each being <font color="#800000">8 </font>bits<font color="#000080">.

</font>EAX 	<font color="#800000">32 </font>bits
AX 	<font color="#800000">16 </font>bits   
AH	<font color="#800000">8 </font>bits
AL	<font color="#800000">8 </font>bits

This means that you can use AH <font color="#FF0000"><b>and </b></font>AL <font color="#FF0000"><b>to </b></font>store different numbers <font color="#FF0000"><b>and </b></font>treat them <font color="#FF0000"><b>as 
</b></font>separate registers <font color="#FF0000"><b>for </b></font>some tasks<font color="#000080">.

</font>BX <font color="#000080">(</font>BH<font color="#000080">/</font>BL<font color="#000080">): </font>same <font color="#FF0000"><b>as </b></font>AX         
CX <font color="#000080">(</font>CH<font color="#000080">/</font>CL<font color="#000080">): </font>Same <font color="#FF0000"><b>as </b></font>AX <font color="#000080">(</font>used <font color="#FF0000"><b>for </b></font>loops<font color="#000080">)
</font>DX <font color="#000080">(</font>DH<font color="#000080">/</font>DL<font color="#000080">): </font>Same <font color="#FF0000"><b>as </b></font>AX <font color="#000080">(</font>used <font color="#FF0000"><b>for </b></font>multiplication<font color="#000080">/</font>division<font color="#000080">)

</font>DI <font color="#FF0000"><b>and </b></font>SI are index registers <font color="#FF0000"><b>and </b></font>can be used <font color="#FF0000"><b>as </b></font>offset registers<font color="#000080">.

</font>SP<font color="#000080">: </font>Stack Pointer<font color="#000080">. </font>Does just that<font color="#000080">. </font>Points <font color="#FF0000"><b>to </b></font>the current position <font color="#FF0000"><b>in </b></font>the stack<font color="#000080">. </font>Don<font color="#800000">'t 
</font>alter unless you REALLY know what you are doing <font color="#FF0000"><b>or </b></font>want <font color="#FF0000"><b>to </b></font>crash your computer<font color="#000080">.


</font>The Stack<font color="#000080">:

</font>This <font color="#FF0000"><b>is and </b></font>area <font color="#FF0000"><b>of </b></font>memory that <font color="#FF0000"><b>is </b></font>like a stack <font color="#FF0000"><b>of </b></font>plates<font color="#000080">. </font>The last one you put <font color="#FF0000"><b>on is </b></font>the 
first one that you take off <font color="#000080">(</font>LOFO<font color="#000080">). </font><font color="#FF0000"><b>If </b></font>another piece <font color="#FF0000"><b>of </b></font>data <font color="#FF0000"><b>is </b></font>put <font color="#FF0000"><b>on </b></font>the stack it grows 
downwards<font color="#000080">.
 
</font>Diagram <font color="#800000">1</font><font color="#000080">: </font>This shows how the stack <font color="#FF0000"><b>is </b></font>organised 

PUSH <font color="#FF0000"><b>and </b></font>POP<font color="#000080">:

</font>Push puts a value onto the stack <font color="#FF0000"><b>and </b></font>pop takes it back off<font color="#000080">. </font>Here<font color="#800000">'s some code. (you 
</font>can<font color="#800000">'t compile this - yet.)

</font>	push cx         <font color="#000080">;</font>put cx <font color="#FF0000"><b>on </b></font>the stack
	push ax         <font color="#000080">;</font>put ax <font color="#FF0000"><b>on </b></font>the stack
	<font color="#000080">.
</font>	<font color="#000080">.
</font>	<font color="#000080">.               ;</font>this <font color="#FF0000"><b>is </b></font>going <font color="#FF0000"><b>to </b></font>pop them back <font color="#FF0000"><b>in 
</b></font>	<font color="#000080">.</font>			 <font color="#000080">;</font>the wrong so they are reversed
	pop cx          <font color="#000080">;</font>put value from stack into cx
	pop ax          <font color="#000080">;</font>put value from stack into ax

This means that cx <font color="#FF0000"><b>is </b></font>equal <font color="#FF0000"><b>to </b></font>what ax <font color="#FF0000"><b>is and </b></font>ax <font color="#FF0000"><b>is </b></font>equal <font color="#FF0000"><b>to </b></font>what cx was<font color="#000080">.


</font>Some instructions<font color="#000080">:

</font>MOV<font color="#000080">: </font>this moves a value from one place <font color="#FF0000"><b>to </b></font>another<font color="#000080">.

</font>Syntax<font color="#000080">:
</font>MOV destination<font color="#000080">, </font>source

<font color="#FF0000"><b>for </b></font>example<font color="#000080">:
</font>	MOV ax<font color="#000080">,</font><font color="#800000">10       </font><font color="#000080">;</font>moves an immediate value into ax 
	MOV bx<font color="#000080">,</font>cx       <font color="#000080">;</font>moves value from cx into bx


INT<font color="#000080">: </font>calls a DOS <font color="#FF0000"><b>or </b></font>BIOS <font color="#FF0000"><b>function</b></font><font color="#000080">, </font>mainly <font color="#FF0000"><b>to do </b></font>something you would rather <font color="#FF0000"><b>not 
</b></font>write a <font color="#FF0000"><b>function for </b></font>e<font color="#000080">.</font>g<font color="#000080">. </font>change video mode<font color="#000080">, </font>open a <font color="#FF0000"><b>file </b></font>etc<font color="#000080">.

</font>Syntax<font color="#000080">:
</font>INT interrupt number

Note<font color="#000080">: </font>an h after a number denotes that that number <font color="#FF0000"><b>is in </b></font>hex<font color="#000080">.

</font>	INT <font color="#800000">21</font>h         <font color="#000080">;</font>Calls DOS standard interrupt <font color="#800000">21</font>h
	INT <font color="#800000">10</font>h         <font color="#000080">;</font>Calls the Video BIOS interrupt

All interrupts need a value <font color="#FF0000"><b>to </b></font>specify what subroutine <font color="#FF0000"><b>to </b></font>use<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>usually <font color="#FF0000"><b>in </b></font>AH<font color="#000080">. </font><font color="#FF0000"><b>To 
</b></font>print a <font color="#FF0000"><b>message on </b></font>the screen all you need <font color="#FF0000"><b>to do is </b></font>this<font color="#000080">:

</font>	MOV ah<font color="#000080">,</font><font color="#800000">9      </font><font color="#000080">;</font>subroutine number <font color="#800000">9
</font>	INT <font color="#800000">21</font>h       <font color="#000080">;</font>call the interrupt



But first you have <font color="#FF0000"><b>to </b></font>specify what <font color="#FF0000"><b>to </b></font>print<font color="#000080">. </font>This <font color="#FF0000"><b>function </b></font>needs DS<font color="#000080">:</font>DX <font color="#FF0000"><b>to </b></font>be a <font color="#FF0000"><b>far 
</b></font>pointer <font color="#FF0000"><b>to </b></font>where the <font color="#FF0000"><b>string is</b></font><font color="#000080">. </font>The <font color="#FF0000"><b>string </b></font>has <font color="#FF0000"><b>to </b></font>be terminated <font color="#FF0000"><b>with </b></font>a dollar sign <font color="#000080">(</font><font color="#800000">$</font><font color="#000080">). 

</font>This example shows how it works<font color="#000080">:
</font>	MyMessage db    <font color="#000080">&quot;</font>This <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>message</b></font><font color="#000080">!</font><font color="#800000">$</font><font color="#000080">&quot;
</font>	<font color="#000080">.
</font>	<font color="#000080">.
</font>	<font color="#000080">.
</font>	mov dx<font color="#000080">,</font>OFFSET MyMessage
	mov ax<font color="#000080">,</font>SEG MyMessage
	mov ds<font color="#000080">,</font>ax
	mov ah<font color="#000080">,</font><font color="#800000">9
</font>	int <font color="#800000">21</font>h

DB declares a piece <font color="#FF0000"><b>of </b></font>data<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>the same <font color="#FF0000"><b>as in </b></font>BASIC<font color="#000080">:
</font>	LET MyMessage<font color="#800000">$ </font><font color="#000080">= &quot;</font>This <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>message</b></font><font color="#000080">!&quot;

</font>DB declares a byte<font color="#000080">, </font>DW declares a word <font color="#FF0000"><b>and </b></font>DD declares a Dword<font color="#000080">.

</font>This <font color="#FF0000"><b>is </b></font>your first assembly <font color="#FF0000"><b>program</b></font><font color="#000080">. </font>Cut this <font color="#FF0000"><b>in and then </b></font>assemble it<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you are using 
A86<font color="#000080">, </font><font color="#FF0000"><b>type</b></font><font color="#000080">: 
</font>	A86 name <font color="#FF0000"><b>of file
If </b></font>you are using Turbo <font color="#FF0000"><b>Assembler then type</b></font><font color="#000080">:
</font>	tasm name <font color="#FF0000"><b>of file
</b></font>	tlink name <font color="#FF0000"><b>of file </b></font>minus extention
<font color="#FF0000"><b>With </b></font>tlink you can make a <font color="#000080">.</font>COM <font color="#FF0000"><b>file </b></font>by using a <font color="#000080">/</font>t switch<font color="#000080">.


;</font>THIS <font color="#FF0000"><b>IS </b></font>A SIMPLE <font color="#FF0000"><b>PROGRAM TO </b></font>DISPLAY A <font color="#FF0000"><b>MESSAGE ON </b></font>THE 
<font color="#000080">;</font>SCREEN<font color="#000080">. </font>SHOULD OUTPUT This <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>message</b></font><font color="#000080">! </font><font color="#FF0000"><b>TO </b></font>SCREEN <font color="#FF0000"><b>AND 
</b></font><font color="#000080">;</font>RETURN <font color="#FF0000"><b>WITH </b></font>NO ERRORLEVEL<font color="#000080">. </font>THIS CAN<font color="#000080">’</font>T BE MADE INTO A 
<font color="#000080">.</font>COM <font color="#FF0000"><b>FILE WITH </b></font>TLINK <font color="#FF0000"><b>AS </b></font>IT GENERATES AN ERROR<font color="#000080">.
</font>	
	<font color="#000080">.</font>MODEL SMALL <font color="#000080">;</font>Ignore the first two lines
			   <font color="#000080">;</font>I<font color="#800000">'ll explain what this means later.
</font>	<font color="#000080">.</font>STACK	   <font color="#000080">;</font>allocate a stack
	<font color="#000080">.</font>CODE        <font color="#000080">;</font>a directive <font color="#FF0000"><b>to </b></font>start code segment
	
	START<font color="#000080">:       ;</font>generally a good name <font color="#FF0000"><b>to </b></font>use <font color="#FF0000"><b>as </b></font>an 	
			   <font color="#000080">;</font>entry point

	JMP <font color="#FF0000"><b>BEGIN    </b></font><font color="#000080">;</font>jump <font color="#FF0000"><b>to BEGIN</b></font><font color="#000080">: (</font>like <font color="#FF0000"><b>goto</b></font><font color="#000080">)

</font>	MyMessage db <font color="#000080">&quot;</font>This <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>message</b></font><font color="#000080">!</font><font color="#800000">$</font><font color="#000080">&quot; 
</font>	
	<font color="#FF0000"><b>BEGIN</b></font><font color="#000080">:       ;</font>code starts here

	mov dx<font color="#000080">,</font>OFFSET MyMessage	<font color="#000080">;</font>put the offset <font color="#FF0000"><b>of message 
</b></font>						<font color="#000080">;</font><font color="#FF0000"><b>in </b></font>DX
	mov ax<font color="#000080">,</font>SEG MyMessage	<font color="#000080">;</font>put the segment that the 
						<font color="#000080">;</font><font color="#FF0000"><b>message is in in </b></font>AX
	mov ds<font color="#000080">,</font>ax				<font color="#000080">;</font>copy AX into DS
	mov ah<font color="#000080">,</font><font color="#800000">9</font>				<font color="#000080">;</font>move <font color="#800000">9 </font>into ah <font color="#FF0000"><b>to </b></font>call
	int <font color="#800000">21</font>h				<font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">9 </font><font color="#FF0000"><b>of </b></font>interrupt 
						<font color="#000080">;</font><font color="#800000">21</font>h <font color="#000080">- </font>display a <font color="#FF0000"><b>string to 
</b></font>						<font color="#000080">;</font>screen<font color="#000080">.

</font>	MOV ax<font color="#000080">,</font><font color="#800000">4</font>c00h <font color="#000080">;</font>move the value <font color="#FF0000"><b>of </b></font><font color="#800000">4</font>c00 hex into AX
	INT <font color="#800000">21</font>h      <font color="#000080">;</font>call interrupt <font color="#800000">21</font>h<font color="#000080">, </font>subroutine <font color="#800000">4</font>C 
<font color="#000080">;</font>which returns control <font color="#FF0000"><b>to </b></font>dos<font color="#000080">, </font>otherwise it would <font color="#FF0000"><b>of 
</b></font><font color="#000080">;</font>crashed<font color="#000080">. </font>The <font color="#800000">00 </font><font color="#FF0000"><b>on </b></font>the <font color="#FF0000"><b>end </b></font>means what errorlevel it 
<font color="#000080">;</font>would return <font color="#FF0000"><b>to </b></font>DOS<font color="#000080">. </font>This can be checked <font color="#FF0000"><b>in </b></font>a batch <font color="#FF0000"><b>file
</b></font>	
	<font color="#FF0000"><b>END </b></font>START    <font color="#000080">;</font><font color="#FF0000"><b>end </b></font>here



Some instructions that you need <font color="#FF0000"><b>to </b></font>know<font color="#000080">:

</font>This <font color="#FF0000"><b>is </b></font>just a list <font color="#FF0000"><b>of </b></font>some basic assembly instructions that are very important <font color="#FF0000"><b>and </b></font>are 
used often<font color="#000080">.

</font>ADD	Add the contents <font color="#FF0000"><b>of </b></font>one number <font color="#FF0000"><b>to </b></font>another

Syntax<font color="#000080">:

</font>	ADD operand1<font color="#000080">,</font>operand2

This adds operand2 <font color="#FF0000"><b>to </b></font>operand1<font color="#000080">. </font>The answer <font color="#FF0000"><b>is </b></font>stored <font color="#FF0000"><b>in </b></font>operand1<font color="#000080">. </font>Immediate data 
cannot be used <font color="#FF0000"><b>as </b></font>operand1 but can be used <font color="#FF0000"><b>as </b></font>operand2<font color="#000080">.

</font>SUB	Subtract one number from another

Syntax<font color="#000080">:
</font>	SUB operand1<font color="#000080">,</font>operand2

This subtracts operand2 from operand1<font color="#000080">. </font>Immediate data cannot be used <font color="#FF0000"><b>as </b></font>operand1 
but can be used <font color="#FF0000"><b>as </b></font>operand2<font color="#000080">.

</font>MUL	Multiplies two unsigned integers <font color="#000080">(</font>always positive<font color="#000080">)
</font>IMUL	Multiplies two signed integers <font color="#000080">(</font>either positive <font color="#FF0000"><b>or </b></font>negitive<font color="#000080">)

</font>Syntax<font color="#000080">: 
</font>	MUL <font color="#FF0000"><b>register or </b></font>variable
	IMUL <font color="#FF0000"><b>register or </b></font>variable

This multiples the <font color="#FF0000"><b>register </b></font>given by the number <font color="#FF0000"><b>in </b></font>AL <font color="#FF0000"><b>or </b></font>AX depending <font color="#FF0000"><b>on </b></font>the size <font color="#FF0000"><b>of 
</b></font>the operand<font color="#000080">. </font>The answer <font color="#FF0000"><b>is </b></font>given <font color="#FF0000"><b>in </b></font>AX<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>the answer <font color="#FF0000"><b>is </b></font>bigger than <font color="#800000">16 </font>bits <font color="#FF0000"><b>then </b></font>the 
answer <font color="#FF0000"><b>is in </b></font>DX<font color="#000080">:</font>AX <font color="#000080">(</font>the high <font color="#800000">16 </font>bits <font color="#FF0000"><b>in </b></font>DX <font color="#FF0000"><b>and </b></font>the low <font color="#800000">16 </font>bits <font color="#FF0000"><b>in </b></font>AX<font color="#000080">). 

</font><font color="#FF0000"><b>On </b></font>a <font color="#800000">386</font><font color="#000080">, </font><font color="#800000">486 </font><font color="#FF0000"><b>or </b></font>Pentium the EAX <font color="#FF0000"><b>register </b></font>can be used <font color="#FF0000"><b>and </b></font>the answer <font color="#FF0000"><b>is </b></font>stored <font color="#FF0000"><b>in 
</b></font>EDX<font color="#000080">:</font>EAX<font color="#000080">.

</font><font color="#FF0000"><b>DIV</b></font>	Divides two unsigned integers<font color="#000080">(</font>always positive<font color="#000080">)
</font>IDIV 	Divides two signed integers <font color="#000080">(</font>either positive <font color="#FF0000"><b>or </b></font>negitive<font color="#000080">)

</font>Syntax<font color="#000080">:
</font>	<font color="#FF0000"><b>DIV register or </b></font>variable
	IDIV <font color="#FF0000"><b>register or </b></font>variable

This works <font color="#FF0000"><b>in </b></font>the same way <font color="#FF0000"><b>as </b></font>MUL <font color="#FF0000"><b>and </b></font>IMUL by dividing the number <font color="#FF0000"><b>in </b></font>AX by the 
<font color="#FF0000"><b>register or </b></font>variable given<font color="#000080">. </font>The answer <font color="#FF0000"><b>is </b></font>stored <font color="#FF0000"><b>in </b></font>two places<font color="#000080">. </font>AL stores the answer 
<font color="#FF0000"><b>and </b></font>the remainder <font color="#FF0000"><b>is in </b></font>AH<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>the operand <font color="#FF0000"><b>is </b></font>a <font color="#800000">16 </font>bit <font color="#FF0000"><b>register </b></font>than the number <font color="#FF0000"><b>in 
</b></font>DX<font color="#000080">:</font>AX <font color="#FF0000"><b>is </b></font>divided by the operand <font color="#FF0000"><b>and </b></font>the answer <font color="#FF0000"><b>is </b></font>stored <font color="#FF0000"><b>in </b></font>AX <font color="#FF0000"><b>and </b></font>remainder <font color="#FF0000"><b>in 
</b></font>DX<font color="#000080">.


</font>The way we entered the address <font color="#FF0000"><b>of </b></font>the <font color="#FF0000"><b>message </b></font>we wanted <font color="#FF0000"><b>to </b></font>print was a bit 
cumbersome<font color="#000080">. </font>It took three lines <font color="#FF0000"><b>and </b></font>it isn<font color="#000080">’</font>t the easiest thing <font color="#FF0000"><b>to </b></font>remember

	mov dx<font color="#000080">,</font>OFFSET MyMessage						
	mov ax<font color="#000080">,</font>SEG MyMessage						
	mov ds<font color="#000080">,</font>ax		

We can replace all this <font color="#FF0000"><b>with </b></font>just one line<font color="#000080">. </font>This makes the code easier <font color="#FF0000"><b>to </b></font>read <font color="#FF0000"><b>and </b></font>it 
easier <font color="#FF0000"><b>to </b></font>remember<font color="#000080">. </font>This only works <font color="#FF0000"><b>if </b></font>the data <font color="#FF0000"><b>is </b></font>only <font color="#FF0000"><b>in </b></font>the data <font color="#FF0000"><b>is in </b></font>one segment i<font color="#000080">.</font>e<font color="#000080">. 
</font>small memory model<font color="#000080">.

</font>	lea dx<font color="#000080">,</font>MyMessage
<font color="#FF0000"><b>or</b></font>	mov dx<font color="#000080">,</font>OFFSET MyMessage
Using lea <font color="#FF0000"><b>is </b></font>slightly slower <font color="#FF0000"><b>and </b></font>results <font color="#FF0000"><b>in </b></font>code which <font color="#FF0000"><b>is </b></font>larger<font color="#000080">.

</font>LEA means Load Effective Address<font color="#000080">.

</font>Syntax<font color="#000080">:
</font>LEA destination<font color="#000080">,</font>source

Desination can be any <font color="#800000">16 </font>bit <font color="#FF0000"><b>register and </b></font>the source must be a memory operand <font color="#000080">(</font>bit <font color="#FF0000"><b>of 
</b></font>data <font color="#FF0000"><b>in </b></font>memory<font color="#000080">). </font>It puts the offset address <font color="#FF0000"><b>of </b></font>the source <font color="#FF0000"><b>in </b></font>the destination<font color="#000080">.

</font>Keyboard input<font color="#000080">:

</font>We are going <font color="#FF0000"><b>to </b></font>use interrupt <font color="#800000">16</font>h<font color="#000080">, </font><font color="#FF0000"><b>function </b></font><font color="#800000">00</font>h <font color="#FF0000"><b>to </b></font>read the keyboard<font color="#000080">. </font>This gets a key 
from the keyboard buffer<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>there isn<font color="#800000">'t one, it waits until there is. It returns the SCAN 
</font>code <font color="#FF0000"><b>in </b></font>AH <font color="#FF0000"><b>and </b></font>the ASCII translation <font color="#FF0000"><b>in </b></font>AL<font color="#000080">.

        </font>MOV ah<font color="#000080">,</font><font color="#800000">00</font>h		<font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">00</font>h <font color="#FF0000"><b>of
   </b></font>INT <font color="#800000">16</font>h		<font color="#000080">;</font>interrupt <font color="#800000">16</font>h

All we need <font color="#FF0000"><b>to </b></font>worry about <font color="#FF0000"><b>for </b></font>now <font color="#FF0000"><b>is </b></font>the ascii value which <font color="#FF0000"><b>is in </b></font>al<font color="#000080">.

</font>Printing a character<font color="#000080">:

</font>The problem <font color="#FF0000"><b>is </b></font>that we have the key that has been pressed <font color="#FF0000"><b>in </b></font>ah<font color="#000080">. </font>How <font color="#FF0000"><b>do </b></font>we display 
it<font color="#000080">? </font>We can<font color="#800000">'t use function 9h because for that we need to have already defined the string 
</font>which has <font color="#FF0000"><b>to end with </b></font>a dollar sign<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>what we <font color="#FF0000"><b>do </b></font>instead<font color="#000080">:

;</font>after calling <font color="#FF0000"><b>function </b></font><font color="#800000">00</font>h <font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">16</font>h
        MOV dl<font color="#000080">,</font>al       <font color="#000080">;</font>move al <font color="#000080">(</font>ascii code<font color="#000080">) </font>into dl
        MOV ah<font color="#000080">,</font><font color="#800000">02</font>h      <font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">02</font>h <font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">21</font>h
        INT <font color="#800000">21</font>h         <font color="#000080">;</font>call interrupt <font color="#800000">21</font>h

<font color="#FF0000"><b>If </b></font>you want <font color="#FF0000"><b>to </b></font>save the value <font color="#FF0000"><b>of </b></font>ah <font color="#FF0000"><b>then </b></font>push it before <font color="#FF0000"><b>and </b></font>pop it afterwards<font color="#000080">.


</font>Control flow<font color="#000080">:
</font>Firstly<font color="#000080">, </font>the most basic command<font color="#000080">:
</font>	JMP <font color="#FF0000"><b>label 
</b></font>This <font color="#FF0000"><b>is </b></font>the same <font color="#FF0000"><b>as GOTO in </b></font>basic<font color="#000080">.

</font>        	JMP ALabel
     <font color="#000080">.
</font>	<font color="#000080">.
</font>	ALabel<font color="#000080">:
</font>     	<font color="#000080">;</font>code <font color="#FF0000"><b>to do </b></font>something

What <font color="#FF0000"><b>do </b></font>we <font color="#FF0000"><b>do if </b></font>we want <font color="#FF0000"><b>to </b></font>compare somthing<font color="#000080">. </font>We have just got a key from the user 
but we want <font color="#FF0000"><b>to do </b></font>something <font color="#FF0000"><b>with </b></font>it<font color="#000080">. </font>Lets print something <font color="#FF0000"><b>out if </b></font>it <font color="#FF0000"><b>is </b></font>equal <font color="#FF0000"><b>to 
</b></font>somethine <font color="#FF0000"><b>else</b></font><font color="#000080">. </font>How <font color="#FF0000"><b>do </b></font>we <font color="#FF0000"><b>do </b></font>that<font color="#000080">? </font>Its easy<font color="#000080">. </font>We use the jump <font color="#FF0000"><b>on </b></font>condition 
commands<font color="#000080">. </font>Here <font color="#FF0000"><b>is </b></font>a list <font color="#FF0000"><b>of </b></font>them<font color="#000080">:

</font>Jump <font color="#FF0000"><b>on </b></font>condition commands<font color="#000080">:

</font>JA
jumps <font color="#FF0000"><b>if </b></font>the first number was above the second number

JAE
same <font color="#FF0000"><b>as </b></font>above<font color="#000080">, </font>but will also jump <font color="#FF0000"><b>if </b></font>they are equal

JB
jumps <font color="#FF0000"><b>if </b></font>the first number was below the second

JBE
same <font color="#FF0000"><b>as </b></font>above<font color="#000080">, </font>but will also jump <font color="#FF0000"><b>if </b></font>they are equal

JNA
jumps <font color="#FF0000"><b>if </b></font>the first number was <font color="#FF0000"><b>NOT </b></font>above  <font color="#000080">(</font>same <font color="#FF0000"><b>as </b></font>JBE<font color="#000080">)

</font>JNAE
jumps <font color="#FF0000"><b>if </b></font>the first number was <font color="#FF0000"><b>NOT </b></font>above <font color="#FF0000"><b>or </b></font>the same <font color="#FF0000"><b>as </b></font><font color="#000080">(</font>same <font color="#FF0000"><b>as </b></font>JB<font color="#000080">)

</font>JNB
jumps <font color="#FF0000"><b>if </b></font>the first number was <font color="#FF0000"><b>NOT </b></font>below <font color="#000080">(</font>same <font color="#FF0000"><b>as </b></font>JAE<font color="#000080">)

</font>JNBE
jumps <font color="#FF0000"><b>if </b></font>the first number was <font color="#FF0000"><b>NOT </b></font>below <font color="#FF0000"><b>or </b></font>the same <font color="#FF0000"><b>as </b></font><font color="#000080">(</font>same <font color="#FF0000"><b>as </b></font>JA<font color="#000080">)

</font>JZ
jumps <font color="#FF0000"><b>if </b></font>the two numbers were equal

JE
same <font color="#FF0000"><b>as </b></font>JZ<font color="#000080">, </font>just a different name

JNZ
jumps <font color="#FF0000"><b>if </b></font>the two numbers are <font color="#FF0000"><b>NOT </b></font>equal

JNE
same <font color="#FF0000"><b>as </b></font>above



<font color="#000080">[</font>NOTE<font color="#000080">: </font>There are quite a few more but these are the most useful<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you want the full 
list <font color="#FF0000"><b>then </b></font>get a good assembly book<font color="#000080">]

</font>They are very easy <font color="#FF0000"><b>to </b></font>use<font color="#000080">.

</font>Syntax<font color="#000080">:
        </font>CMP <font color="#FF0000"><b>register </b></font>containing value<font color="#000080">, </font>a value
    jump command destination    

An example <font color="#FF0000"><b>of </b></font>this <font color="#FF0000"><b>is</b></font><font color="#000080">:
      </font>cmp al<font color="#000080">,</font><font color="#800000">'Y'      </font><font color="#000080">;</font>compare the value <font color="#FF0000"><b>in </b></font>al <font color="#FF0000"><b>with </b></font>Y
      je ItsYES       <font color="#000080">;</font><font color="#FF0000"><b>if </b></font>it <font color="#FF0000"><b>is </b></font>equal <font color="#FF0000"><b>then </b></font>jump <font color="#FF0000"><b>to </b></font>ItsYES


The following <font color="#FF0000"><b>program is </b></font>an example <font color="#FF0000"><b>of </b></font>how <font color="#FF0000"><b>to </b></font>use control <font color="#FF0000"><b>and </b></font>input <font color="#FF0000"><b>and </b></font>output<font color="#000080">.

.</font>MODEL  SMALL
<font color="#000080">.</font>STACK 					<font color="#000080">;</font>define a stack
<font color="#000080">.</font>CODE
Start<font color="#000080">:</font>					<font color="#000080">;</font>a good place <font color="#FF0000"><b>to </b></font>start<font color="#000080">.
         
      </font>lea dx<font color="#000080">,</font>StartUpMessage  	<font color="#000080">;</font>display a <font color="#FF0000"><b>message on </b></font>th e
						<font color="#000080">;</font>screen
      mov ah<font color="#000080">,</font><font color="#800000">9                </font><font color="#000080">;</font>using <font color="#FF0000"><b>function </b></font><font color="#800000">09</font>h
      int <font color="#800000">21</font>h                 <font color="#000080">;</font><font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">21</font>h
      lea dx<font color="#000080">,</font>Instructions     <font color="#000080">;</font>display a <font color="#FF0000"><b>message on </b></font>the 
						<font color="#000080">;</font>screen  
      mov ah<font color="#000080">,</font><font color="#800000">9                </font><font color="#000080">;</font>using <font color="#FF0000"><b>function </b></font><font color="#800000">09</font>h
      int <font color="#800000">21</font>h                 <font color="#000080">;</font><font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">21</font>h
      
	 mov ah<font color="#000080">,</font><font color="#800000">00</font>h              <font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">00</font>h <font color="#FF0000"><b>of
      </b></font>int <font color="#800000">16</font>h                 <font color="#000080">;</font>interrupt <font color="#800000">16</font>h gets a 	
						<font color="#000080">;</font>character from user     
      mov bl<font color="#000080">,</font>al               <font color="#000080">;</font>save bl    
      mov dl<font color="#000080">,</font>al               <font color="#000080">;</font>move ascii value <font color="#FF0000"><b>of </b></font>key 
				        	<font color="#000080">;</font>pressed <font color="#FF0000"><b>to </b></font>dl
      
	 mov ah<font color="#000080">,</font><font color="#800000">02</font>h              <font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">02</font>h <font color="#FF0000"><b>of 
      </b></font>int <font color="#800000">21</font>h                 <font color="#000080">;</font>interrupt <font color="#800000">21</font>h displays a 
				          <font color="#000080">;</font>character <font color="#FF0000"><b>to </b></font>screen
      cmp bl<font color="#000080">,</font><font color="#800000">'Y'              </font><font color="#000080">;</font><font color="#FF0000"><b>is </b></font>al<font color="#000080">=</font>Y<font color="#000080">?
      </font>je Thanks    		     <font color="#000080">;</font><font color="#FF0000"><b>if </b></font>yes <font color="#FF0000"><b>then goto </b></font>Thanks
 	 cmp bl<font color="#000080">,</font><font color="#800000">'y'              </font><font color="#000080">;</font><font color="#FF0000"><b>is </b></font>al<font color="#000080">=</font>y<font color="#000080">?
      </font>je Thanks          	<font color="#000080">;</font><font color="#FF0000"><b>if </b></font>yes <font color="#FF0000"><b>then goto </b></font>Thanks
      jmp TheEnd
Thanks<font color="#000080">:
      </font>lea dx<font color="#000080">,</font>ThanksMsg        <font color="#000080">;</font>display <font color="#FF0000"><b>message
      </b></font>mov ah<font color="#000080">,</font><font color="#800000">9                </font><font color="#000080">;</font>using <font color="#FF0000"><b>function </b></font><font color="#800000">9
      </font>int <font color="#800000">21</font>h                 <font color="#000080">;</font><font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">21</font>h
TheEnd<font color="#000080">:
      </font>lea dx<font color="#000080">,</font>GoodBye          <font color="#000080">;</font>print goodbye <font color="#FF0000"><b>message
      </b></font>mov ah<font color="#000080">,</font><font color="#800000">9                </font><font color="#000080">;</font>using <font color="#FF0000"><b>function </b></font><font color="#800000">9
      </font>int <font color="#800000">21</font>h                 <font color="#000080">;</font><font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">21</font>h
      mov AX<font color="#000080">,</font><font color="#800000">4</font>C00h            <font color="#000080">;</font>terminate <font color="#FF0000"><b>program and</b></font> 	
						<font color="#000080">;</font>return <font color="#FF0000"><b>to </b></font>DOS using
      INT <font color="#800000">21</font>h                 <font color="#000080">;</font>interrupt <font color="#800000">21</font>h <font color="#FF0000"><b>function </b></font><font color="#800000">4</font>CH

<font color="#000080">.</font>DATA                            
<font color="#000080">;</font><font color="#800000">0</font>Dh<font color="#000080">,</font><font color="#800000">0</font>Ah adds a enter at the beginning

StartUpMessage DB <font color="#000080">&quot;</font>A Simple Input <font color="#FF0000"><b>Program</b></font><font color="#800000">$</font><font color="#000080">&quot;     
</font>Instructions  DB <font color="#800000">0</font>Dh<font color="#000080">,</font><font color="#800000">0</font>Ah<font color="#000080">,&quot;</font>Just press a Y <font color="#FF0000"><b>to </b></font>continue<font color="#000080">...</font><font color="#800000">$</font><font color="#000080">”                  
</font>ThanksMsg      DB <font color="#800000">0</font>Dh<font color="#000080">,</font><font color="#800000">0</font>Ah<font color="#000080">,&quot;</font>Thanks <font color="#FF0000"><b>for </b></font>pressing Y<font color="#000080">!</font><font color="#800000">$</font><font color="#000080">&quot;    
</font>GoodBye        DB <font color="#800000">0</font>Dh<font color="#000080">,</font><font color="#800000">0</font>Ah<font color="#000080">,&quot;</font>Have a nice day<font color="#000080">!</font><font color="#800000">$</font><font color="#000080">&quot;

        </font><font color="#FF0000"><b>END 


</b></font>Procedures<font color="#000080">:

</font>Assembly<font color="#000080">, </font>like C <font color="#FF0000"><b>and Pascal </b></font>can have procedures<font color="#000080">. </font>These are very useful <font color="#FF0000"><b>for </b></font>series <font color="#FF0000"><b>of 
</b></font>commands that have <font color="#FF0000"><b>to </b></font>be repeated often<font color="#000080">. 

</font>This <font color="#FF0000"><b>is </b></font>how a <font color="#FF0000"><b>procedure is </b></font>defined<font color="#000080">:

</font>PROC AProcedure
    <font color="#000080">.
    .          ;</font>some code <font color="#FF0000"><b>to do </b></font>something       
    <font color="#000080">.
    </font>RET		<font color="#000080">;</font><font color="#FF0000"><b>if </b></font>this <font color="#FF0000"><b>is not </b></font>here <font color="#FF0000"><b>then </b></font>your computer 
			<font color="#000080">;</font>will crash
ENDP AProcedure

You can specify how you want the <font color="#FF0000"><b>procedure to </b></font>be called by adding a <font color="#FF0000"><b>FAR or </b></font>a 
<font color="#FF0000"><b>NEAR </b></font>after the <font color="#FF0000"><b>procedure </b></font>name<font color="#000080">. </font>Otherwise it defaults <font color="#FF0000"><b>to </b></font>the memory model you are 
using<font color="#000080">. </font><font color="#FF0000"><b>For </b></font>now you are better off <font color="#FF0000"><b>not </b></font>doing this <font color="#FF0000"><b>until </b></font>you become more experianced<font color="#000080">. </font>I 
usually add a <font color="#FF0000"><b>NEAR in as </b></font>compilers can<font color="#000080">’</font>t decide between a <font color="#FF0000"><b>near and </b></font>a <font color="#FF0000"><b>far </b></font>very well<font color="#000080">. 
</font>This means <font color="#FF0000"><b>if </b></font>the jump needs <font color="#FF0000"><b>to </b></font>be <font color="#FF0000"><b>far </b></font>the compiler will warn you <font color="#FF0000"><b>and </b></font>you can change 
it<font color="#000080">.

</font>This <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>program </b></font>which <font color="#FF0000"><b>uses </b></font>a <font color="#FF0000"><b>procedure</b></font><font color="#000080">.

;</font>a simple <font color="#FF0000"><b>program with </b></font>a <font color="#FF0000"><b>procedure </b></font>that prints a <font color="#FF0000"><b>message 
</b></font><font color="#000080">;</font>onto the screen<font color="#000080">. (</font>Use <font color="#000080">/</font>t switch <font color="#FF0000"><b>with </b></font>tlink<font color="#000080">). </font>Should 
<font color="#000080">;</font>display Hello There<font color="#000080">! </font><font color="#FF0000"><b>on </b></font>the screen<font color="#000080">.

.</font>MODEL  TINY
<font color="#000080">.</font>CODE
ORG     <font color="#800000">100</font>h

MAIN    PROC
	   JMP Start 		  <font color="#000080">;</font>skip the data
HI      DB <font color="#000080">&quot;</font>Hello There<font color="#000080">!</font><font color="#800000">$</font><font color="#000080">&quot; ;</font>define a <font color="#FF0000"><b>message
</b></font>Start<font color="#000080">:</font>				  <font color="#000080">;</font>a good place <font color="#FF0000"><b>to </b></font>start<font color="#000080">.
        </font>Call Display_Hi    <font color="#000080">;</font>Call the <font color="#FF0000"><b>procedure
        </b></font>MOV AX<font color="#000080">,</font><font color="#800000">4</font>C00h       <font color="#000080">;</font>terminate <font color="#FF0000"><b>program and </b></font>return 
					  <font color="#000080">;</font><font color="#FF0000"><b>to </b></font>DOS using
        INT <font color="#800000">21</font>h            <font color="#000080">;</font>interrupt <font color="#800000">21</font>h <font color="#FF0000"><b>function </b></font><font color="#800000">4</font>Ch

Display_Hi PROC            <font color="#000080">;</font>Defines start <font color="#FF0000"><b>of procedure
        </b></font>lea dx<font color="#000080">,</font>HI          <font color="#000080">;</font>put offset <font color="#FF0000"><b>of message </b></font>into DX
        mov ah<font color="#000080">,</font><font color="#800000">9           </font><font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">9 </font><font color="#FF0000"><b>of 
        </b></font>int <font color="#800000">21</font>h            <font color="#000080">;</font>interrupt <font color="#800000">21</font>h
        RET                <font color="#000080">;</font>THIS HAS <font color="#FF0000"><b>TO </b></font>BE HERE
Display_Hi ENDP            <font color="#000080">;</font>Defines <font color="#FF0000"><b>end of procedure

</b></font>Main    ENDP
        <font color="#FF0000"><b>END </b></font>MAIN


Memory Models<font color="#000080">:

</font>We have been using the <font color="#000080">.</font>MODEL directive <font color="#FF0000"><b>to </b></font>specify what <font color="#FF0000"><b>type of </b></font>memory model we  
use<font color="#000080">, </font>but what does this mean<font color="#000080">?

</font>Syntax<font color="#000080">:
</font>	<font color="#000080">.</font>MODEL MemoryModel

Where MemoryModel can be SMALL<font color="#000080">, </font>COMPACT<font color="#000080">, </font>MEDIUM<font color="#000080">, </font>LARGE<font color="#000080">, </font>HUGE<font color="#000080">, 
</font>TINY <font color="#FF0000"><b>OR </b></font>FLAT<font color="#000080">.

</font>Tiny<font color="#000080">: 
</font>This means that there <font color="#FF0000"><b>is </b></font>only one segment <font color="#FF0000"><b>for </b></font>both code <font color="#FF0000"><b>and </b></font>data<font color="#000080">. </font>This <font color="#FF0000"><b>type of 
program </b></font>can be a <font color="#000080">.</font>COM <font color="#FF0000"><b>file</b></font><font color="#000080">.

</font>Small<font color="#000080">:
</font>This means that by <font color="#FF0000"><b>default </b></font>all code <font color="#FF0000"><b>is </b></font>place <font color="#FF0000"><b>in </b></font>one physical segment <font color="#FF0000"><b>and </b></font>likewise all 
data declared <font color="#FF0000"><b>in </b></font>the data segment <font color="#FF0000"><b>is </b></font>also placed <font color="#FF0000"><b>in </b></font>one physical segment<font color="#000080">. </font>This means 
that all proedures <font color="#FF0000"><b>and </b></font>variables are addressed <font color="#FF0000"><b>as NEAR </b></font>by pointing at offsets only<font color="#000080">.

</font>Compact<font color="#000080">:
</font>This means that by <font color="#FF0000"><b>default </b></font>all elements <font color="#FF0000"><b>of </b></font>code <font color="#000080">(</font>procedures<font color="#000080">) </font>are placed <font color="#FF0000"><b>in </b></font>one physical 
segment but each element <font color="#FF0000"><b>of </b></font>data can be placed <font color="#FF0000"><b>in </b></font>its own physical segment<font color="#000080">. </font>This 
means that data elements are addressed by pointing at both at the segment <font color="#FF0000"><b>and </b></font>offset 
addresses<font color="#000080">. </font>Code elements <font color="#000080">(</font>procedures<font color="#000080">) </font>are <font color="#FF0000"><b>NEAR and </b></font>varaibles are <font color="#FF0000"><b>FAR</b></font><font color="#000080">.

</font>Medium<font color="#000080">:
</font>This <font color="#FF0000"><b>is </b></font>the opposite <font color="#FF0000"><b>to </b></font>compact<font color="#000080">. </font>Data elements are <font color="#FF0000"><b>near and </b></font>procedures are <font color="#FF0000"><b>FAR</b></font><font color="#000080">.

</font>Large<font color="#000080">:
</font>This means that both procedures <font color="#FF0000"><b>and </b></font>variables are <font color="#FF0000"><b>FAR</b></font><font color="#000080">. </font>You have <font color="#FF0000"><b>to </b></font>point at both the 
segment <font color="#FF0000"><b>and </b></font>offset addresses<font color="#000080">.

</font>Flat<font color="#000080">:
</font>This isn<font color="#000080">’</font>t used much <font color="#FF0000"><b>as </b></font>it <font color="#FF0000"><b>is for </b></font><font color="#800000">32 </font>bit unsegmented memory space<font color="#000080">. </font><font color="#FF0000"><b>For </b></font>this you need a 
dos extender<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>what you would have <font color="#FF0000"><b>to </b></font>use <font color="#FF0000"><b>if </b></font>you were writing a <font color="#FF0000"><b>program to 
interface with </b></font>a C<font color="#000080">/</font>C<font color="#000080">++ </font><font color="#FF0000"><b>program </b></font>that used a dos extender such <font color="#FF0000"><b>as </b></font>DOS4GW <font color="#FF0000"><b>or 
</b></font>PharLap<font color="#000080">.



</font>Macros<font color="#000080">:

(</font>All code examples given are <font color="#FF0000"><b>for </b></font>macros <font color="#FF0000"><b>in </b></font>Turbo <font color="#FF0000"><b>Assembler</b></font><font color="#000080">. </font><font color="#FF0000"><b>For </b></font>A86 either see the 
documentation <font color="#FF0000"><b>or </b></font>look <font color="#FF0000"><b>in </b></font>the A86 macro example later <font color="#FF0000"><b>in </b></font>this document<font color="#000080">).

</font>Macros are very useful <font color="#FF0000"><b>for </b></font>doing something that <font color="#FF0000"><b>is </b></font>done often but <font color="#FF0000"><b>for </b></font>which a 
<font color="#FF0000"><b>procedure </b></font>can<font color="#000080">’</font>t be use<font color="#000080">. </font>Macros are substituted when the <font color="#FF0000"><b>program is </b></font>compiled <font color="#FF0000"><b>to </b></font>the 
code which they contain<font color="#000080">.

</font>This <font color="#FF0000"><b>is </b></font>the syntax <font color="#FF0000"><b>for </b></font>defining a macro<font color="#000080">:

</font>Name_of_macro	macro		
<font color="#000080">;
;</font>a sequence <font color="#FF0000"><b>of </b></font>instructions 
<font color="#000080">;
</font>endm

These two examples are <font color="#FF0000"><b>for </b></font>macros that take away the boring job <font color="#FF0000"><b>of </b></font>pushing <font color="#FF0000"><b>and 
</b></font>popping certain registers<font color="#000080">:

</font>	SaveRegs macro
		pop ax
		pop bx
		pop cx
		pop dx
	endm
	RestoreRegs macro
		pop dx
		pop cx
		pop bx
		pop ax
	endm
Note that the registers are popped <font color="#FF0000"><b>in </b></font>the reverse order <font color="#FF0000"><b>to </b></font>they wer popped<font color="#000080">.

</font><font color="#FF0000"><b>To </b></font>use a macro <font color="#FF0000"><b>in </b></font>you <font color="#FF0000"><b>program </b></font>you just use the name <font color="#FF0000"><b>of </b></font>the macro <font color="#FF0000"><b>as </b></font>an ordinary 
macro instruction<font color="#000080">:

</font>	SaveRegs
	<font color="#000080">;</font>some other instructions
	RestoreRegs



This example shows how you can use a macro <font color="#FF0000"><b>to </b></font>save typing <font color="#FF0000"><b>in</b></font><font color="#000080">. </font>This macro simply 
prints <font color="#FF0000"><b>out </b></font>a variable <font color="#FF0000"><b>to </b></font>the screen<font color="#000080">.

</font>The only problems <font color="#FF0000"><b>with </b></font>macros <font color="#FF0000"><b>is </b></font>that <font color="#FF0000"><b>if </b></font>you overuse them it leads <font color="#FF0000"><b>to </b></font>you <font color="#FF0000"><b>program 
</b></font>getting bigger <font color="#FF0000"><b>and </b></font>bigger <font color="#FF0000"><b>and </b></font>that you have problems <font color="#FF0000"><b>with </b></font>multiple definition <font color="#FF0000"><b>of </b></font>labels 
<font color="#FF0000"><b>and </b></font>variables<font color="#000080">. </font>The correct way <font color="#FF0000"><b>to </b></font>solve this problem <font color="#FF0000"><b>is to </b></font>use the LOCAL directive <font color="#FF0000"><b>for 
</b></font>declaring names inside macros<font color="#000080">.

</font>Syntax<font color="#000080">:
</font>	LOCAL name 
Where <font color="#000080">“</font>name<font color="#000080">” </font><font color="#FF0000"><b>is </b></font>the name <font color="#FF0000"><b>of </b></font>a local variable <font color="#FF0000"><b>or label</b></font><font color="#000080">.

</font><font color="#FF0000"><b>If </b></font>you have comments <font color="#FF0000"><b>in </b></font>a macro everytime you use that macro the comments will be 
added again into your source code<font color="#000080">. </font>This means that it will become unesescarily long<font color="#000080">. 
</font>The way <font color="#FF0000"><b>to </b></font>get round this <font color="#FF0000"><b>is to </b></font>define comments <font color="#FF0000"><b>with </b></font>a <font color="#000080">;; </font>instead <font color="#FF0000"><b>of </b></font>a <font color="#000080">;. </font>This example 
illustrates this<font color="#000080">.

</font>	<font color="#000080">;</font>a normal comment
	<font color="#000080">;;</font>a comment <font color="#FF0000"><b>in </b></font>a macro <font color="#FF0000"><b>to </b></font>save space

Macros <font color="#FF0000"><b>with </b></font>parameters<font color="#000080">:
</font>Another useful <font color="#FF0000"><b>property of </b></font>macros <font color="#FF0000"><b>is </b></font>that they can have parameters<font color="#000080">. </font>The number <font color="#FF0000"><b>of 
</b></font>parameters <font color="#FF0000"><b>is </b></font>only restricted by the length <font color="#FF0000"><b>of </b></font>the line<font color="#000080">. 

</font>Syntax<font color="#000080">:
</font>Name_of_Macro macro par1<font color="#000080">,</font>par2<font color="#000080">,</font>par3
<font color="#000080">;
;</font>commands go here
endm

This <font color="#FF0000"><b>is </b></font>an example that adds the first <font color="#FF0000"><b>and </b></font>second parameters <font color="#FF0000"><b>and </b></font>puts the result <font color="#FF0000"><b>in </b></font>the 
third<font color="#000080">:

</font>	AddMacro macro num1<font color="#000080">,</font>num2<font color="#000080">,</font>result
		push ax		<font color="#000080">;</font>save ax from being destroyed
		mov ax<font color="#000080">,</font>num1	<font color="#000080">;</font>put num1 into ax
		add ax<font color="#000080">,</font>num2	<font color="#000080">;</font>add num2 <font color="#FF0000"><b>to </b></font>it
		mov result<font color="#000080">,</font>ax	<font color="#000080">;</font>move answer into result
		pop ax		<font color="#000080">;</font>restore ax
	endm

<font color="#FF0000"><b>On </b></font>the next page there <font color="#FF0000"><b>is </b></font>an example <font color="#FF0000"><b>of </b></font>some a useful macro <font color="#FF0000"><b>to </b></font>exit <font color="#FF0000"><b>to </b></font>dos <font color="#FF0000"><b>with </b></font>a 
specified <font color="#000080">. </font>There are two versions <font color="#FF0000"><b>of </b></font>this <font color="#FF0000"><b>program </b></font>because both A86 <font color="#FF0000"><b>and </b></font>Turbo 
<font color="#FF0000"><b>Assembler </b></font>handle macros differently<font color="#000080">.


;</font>this <font color="#FF0000"><b>is </b></font>a simple <font color="#FF0000"><b>program </b></font>which does nothing but use a 
<font color="#000080">;</font>macro <font color="#FF0000"><b>to </b></font>exit <font color="#FF0000"><b>to </b></font>dos<font color="#000080">. </font>This will only work <font color="#FF0000"><b>with </b></font>tasm <font color="#FF0000"><b>and 
</b></font><font color="#000080">;</font>should be compiled like this<font color="#000080">: </font>tasm <font color="#000080">/</font>m2 macro<font color="#000080">.</font><font color="#FF0000"><b>asm 
</b></font><font color="#FF00FF">;because tasm needs more than one pass to work out what 
;to do with macros. It does cause a warning but this can 
;be ignored.

.MODEL small 
.STACK
.CODE        ;start the code segment                                  

Start:       ;a good a place as any to start this

;now lets go back to dos with another macro
</font>	<font color="#FF00FF">BackToDOS 0     ;the errorlevel will be 0

BackToDOS macro errorlevel  

;;this is a macro to exit to dos with a specified 
;;errorlevel given. No test is done to make sure that a 
;;procedure is actually passed or it is within range.
</font>			    
	<font color="#FF00FF">mov ah,4Ch          ;;terminate program and return                              
</font>					<font color="#FF00FF">;;to DOS using
</font>	<font color="#FF00FF">mov al,errorlevel   ;;put errorlevel into al        
</font>	<font color="#FF00FF">int 21h             ;;interrupt 21h function 4Ch 

</font>	<font color="#FF00FF">endm</font>				<font color="#FF00FF">;;</font><font color="#FF0000"><b>end </b></font>macro
<font color="#FF0000"><b>end</b></font>					<font color="#000080">;</font><font color="#FF0000"><b>end program


</b></font>Procedures that pass parametres<font color="#000080">:
</font>Procedures can be made even more useful <font color="#FF0000"><b>if </b></font>they can be made <font color="#FF0000"><b>to </b></font>pass parameters <font color="#FF0000"><b>to 
</b></font>each other<font color="#000080">. </font>There are three ways <font color="#FF0000"><b>of </b></font>doing this <font color="#FF0000"><b>and </b></font>I will cover all three methods<font color="#000080">:
  </font><font color="#FF0000"><b>In </b></font>registers<font color="#000080">,
  </font><font color="#FF0000"><b>In </b></font>memory<font color="#000080">,
  </font><font color="#FF0000"><b>In </b></font>stack<font color="#000080">.

</font><font color="#FF0000"><b>In </b></font>registers<font color="#000080">:

</font>Advantages<font color="#000080">:</font>		Easy <font color="#FF0000"><b>to do and </b></font>fast<font color="#000080">.
</font>Disadvantages<font color="#000080">:</font> 	The <font color="#FF0000"><b>is not </b></font>many registers<font color="#000080">.

</font>This <font color="#FF0000"><b>is </b></font>very easy <font color="#FF0000"><b>to do</b></font><font color="#000080">, </font>all you have <font color="#FF0000"><b>to do is to is </b></font>move the parameters into registers 
before calling the <font color="#FF0000"><b>procedure</b></font><font color="#000080">. </font>This example adds two numbers together <font color="#FF0000"><b>and then 
</b></font>divides by the third it <font color="#FF0000"><b>then </b></font>returns the answer <font color="#FF0000"><b>in </b></font>dx<font color="#000080">.

</font>	push ax		<font color="#000080">;</font>save value <font color="#FF0000"><b>of </b></font>ax
	push bx		<font color="#000080">;</font>save value <font color="#FF0000"><b>of </b></font>bx
	push cx		<font color="#000080">;</font>save value <font color="#FF0000"><b>of </b></font>cx
	mov ax<font color="#000080">,</font><font color="#800000">10</font>		<font color="#000080">;</font>first parameter <font color="#FF0000"><b>is </b></font><font color="#800000">10</font>			
	mov bx<font color="#000080">,</font><font color="#800000">20</font>		<font color="#000080">;</font>second parameter <font color="#FF0000"><b>is </b></font><font color="#800000">20
</font>	mov cx<font color="#000080">,</font><font color="#800000">3</font>		<font color="#000080">;</font>third parameter <font color="#FF0000"><b>is </b></font><font color="#800000">3
</font>	Call ChangeNumbers <font color="#000080">;</font>call <font color="#FF0000"><b>procedure
</b></font>	pop cx		<font color="#000080">;</font>restore cx
	pop bx		<font color="#000080">;</font>restore bx
	pop ax		<font color="#000080">;</font>restore dx 
<font color="#000080">.....
</font>ChangeNumbers PROC	<font color="#000080">;</font>Defines start <font color="#FF0000"><b>of procedure
</b></font>	add ax<font color="#000080">,</font>bx		<font color="#000080">;</font>adds number <font color="#FF0000"><b>in </b></font>bx <font color="#FF0000"><b>to </b></font>ax
	<font color="#FF0000"><b>div </b></font>cx		<font color="#000080">;</font>divides ax by cx
	mov dx<font color="#000080">,</font>ax		<font color="#000080">;</font>return answer <font color="#FF0000"><b>in </b></font>dx
	ret
ChangeNumbers ENDP	<font color="#000080">;</font>defines <font color="#FF0000"><b>end of procedure


</b></font>How <font color="#FF0000"><b>to </b></font>use a debugger<font color="#000080">:

</font>This <font color="#FF0000"><b>is </b></font>a good time <font color="#FF0000"><b>to </b></font>use a debugger <font color="#FF0000"><b>to </b></font>find <font color="#FF0000"><b>out </b></font>what your <font color="#FF0000"><b>program is </b></font>actually doing<font color="#000080">. 
</font>I am going <font color="#FF0000"><b>to </b></font>demonstrate how <font color="#FF0000"><b>to </b></font>use Turbo Debugger <font color="#FF0000"><b>to </b></font>check <font color="#FF0000"><b>if </b></font>this <font color="#FF0000"><b>program is 
</b></font>working properly<font color="#000080">. </font>First we need <font color="#FF0000"><b>to </b></font>compile this <font color="#FF0000"><b>program to </b></font>either a <font color="#000080">.</font>EXE <font color="#FF0000"><b>or </b></font><font color="#000080">.</font>COM 
<font color="#FF0000"><b>file</b></font><font color="#000080">. </font><font color="#FF0000"><b>Then type</b></font><font color="#000080">:
</font>	td name <font color="#FF0000"><b>of file
</b></font>Turbo Debugger <font color="#FF0000"><b>then </b></font>loads<font color="#000080">. </font>You can see the instructions that make up your programs<font color="#000080">,  
</font><font color="#FF0000"><b>for </b></font>example the first few lines <font color="#FF0000"><b>of </b></font>this <font color="#FF0000"><b>program is </b></font>shown <font color="#FF0000"><b>as</b></font><font color="#000080">:
</font>	cs<font color="#000080">:</font><font color="#800000">0000 50</font>		push   ax
	cs<font color="#000080">:</font><font color="#800000">0001 53</font>		push   bx
	cs<font color="#000080">:</font><font color="#800000">0002 51</font>		push   cx
<font color="#000080">(</font>This might be slighly different than <font color="#FF0000"><b>is </b></font>shown <font color="#FF0000"><b>on </b></font>your screen but hopefully you will get 
the main idea<font color="#000080">)
 
</font>This diagram shows what the Turbo Debugger<font color="#000080">&acirc;  </font>screen looks like

The numbers that are moved into the registers are different that the ones that we typed 
<font color="#FF0000"><b>in </b></font>because they are represented <font color="#FF0000"><b>in </b></font>their hex form <font color="#000080">(</font>base <font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>as </b></font>this <font color="#FF0000"><b>is </b></font>the easiest base <font color="#FF0000"><b>to 
</b></font>convert <font color="#FF0000"><b>to and </b></font>from binary <font color="#FF0000"><b>and </b></font>that it <font color="#FF0000"><b>is </b></font>easier <font color="#FF0000"><b>to </b></font>understand than binary also<font color="#000080">. 

</font>At the left <font color="#FF0000"><b>of </b></font>this display there <font color="#FF0000"><b>is </b></font>a box showing the contents <font color="#FF0000"><b>of </b></font>the registers<font color="#000080">. </font>At this 
time all the main registers are empty<font color="#000080">. </font>Now press F7 this means that the first line <font color="#FF0000"><b>of </b></font>the 
<font color="#FF0000"><b>program is </b></font>run<font color="#000080">. </font><font color="#FF0000"><b>As </b></font>the first line pushed the ax <font color="#FF0000"><b>register </b></font>into the stack<font color="#000080">, </font>you can see that 
the stack pointer <font color="#000080">(</font>SP<font color="#000080">) </font>has changed<font color="#000080">. </font>Press F7 <font color="#FF0000"><b>until </b></font>the line which <font color="#FF0000"><b>contains </b></font>mov 
ax<font color="#000080">,</font><font color="#800000">000</font>A <font color="#FF0000"><b>is </b></font>highlighted<font color="#000080">. </font>Now press it again<font color="#000080">. </font>Now <font color="#FF0000"><b>if </b></font>you look at the box which <font color="#FF0000"><b>contains 
</b></font>the contents <font color="#FF0000"><b>of </b></font>the registers you can see that AX <font color="#FF0000"><b>contains </b></font>A<font color="#000080">. </font>Press it again <font color="#FF0000"><b>and </b></font>BX 
now <font color="#FF0000"><b>contains </b></font><font color="#800000">14</font><font color="#000080">, </font>press it again <font color="#FF0000"><b>and </b></font>CX <font color="#FF0000"><b>contains </b></font><font color="#800000">3. </font>Now <font color="#FF0000"><b>if </b></font>you press F7 again you can 
see that AX now <font color="#FF0000"><b>contains </b></font><font color="#800000">1E </font>which <font color="#FF0000"><b>is </b></font>A<font color="#000080">+</font><font color="#800000">14. </font>Press it again <font color="#FF0000"><b>and </b></font>now AX <font color="#FF0000"><b>contains </b></font>A 
again<font color="#000080">, </font>A being <font color="#800000">1E </font>divided by <font color="#800000">3 </font><font color="#000080">(</font><font color="#800000">30</font><font color="#000080">/</font><font color="#800000">3 </font><font color="#000080">= </font><font color="#800000">10</font><font color="#000080">). </font>Press F7 again <font color="#FF0000"><b>and </b></font>you will see that DX 
now also <font color="#FF0000"><b>contains </b></font>A<font color="#000080">. </font>Press it three more times <font color="#FF0000"><b>and </b></font>you can see that CX<font color="#000080">,</font>BX <font color="#FF0000"><b>and </b></font>AX 
are all <font color="#FF0000"><b>set </b></font>back <font color="#FF0000"><b>to </b></font>their origional values <font color="#FF0000"><b>of </b></font>zero<font color="#000080">.


</font>Passing through memory<font color="#000080">:

</font>Advantages<font color="#000080">:</font>		Easy <font color="#FF0000"><b>to do and </b></font>can use more parameters
Disadvantages<font color="#000080">:</font> 	Can be slower 

<font color="#FF0000"><b>To </b></font>pass parameters through memory all you need <font color="#FF0000"><b>to do is </b></font>copy them <font color="#FF0000"><b>to </b></font>a variable 
which <font color="#FF0000"><b>is </b></font>stored <font color="#FF0000"><b>in </b></font>memory<font color="#000080">. </font>You can use a varable <font color="#FF0000"><b>in </b></font>the same way that you can use a 
<font color="#FF0000"><b>register </b></font>but commands <font color="#FF0000"><b>with </b></font>registers are a lot faster<font color="#000080">. </font>This table shows the timing <font color="#FF0000"><b>for 
</b></font>the MOV command <font color="#FF0000"><b>with </b></font>registers <font color="#FF0000"><b>and then </b></font>variables <font color="#FF0000"><b>and then </b></font>the amount <font color="#FF0000"><b>of </b></font>clock 
cycles <font color="#000080">(</font>the speed <font color="#000080">- </font>smaller faster<font color="#000080">) </font>it takes <font color="#FF0000"><b>to do </b></font>them<font color="#000080">. 

</font>KEY<font color="#000080">:</font> 	reg8 means an <font color="#800000">8 </font>bit <font color="#FF0000"><b>register </b></font>eg AL
	mem8 means an <font color="#800000">8 </font>bit variable declared <font color="#FF0000"><b>with </b></font>DB
	reg16 means an <font color="#800000">16 </font>bit <font color="#FF0000"><b>register </b></font>eg AX
	mem16 means an <font color="#800000">16 </font>bit variable declared <font color="#FF0000"><b>with </b></font>DW
	imm8 means an immediate byte eg MOV al<font color="#000080">,</font><font color="#800000">8
</font>	imm16 means an immediate word eg MOV ax<font color="#000080">,</font><font color="#800000">8

</font>Instruction
<font color="#800000">486
386
286
86

</font>MOV reg<font color="#000080">/</font>mem8<font color="#000080">,</font>reg8
<font color="#800000">1
2</font><font color="#000080">/</font><font color="#800000">2
2</font><font color="#000080">/</font><font color="#800000">3
2</font><font color="#000080">/</font><font color="#800000">9

</font>MOV reg<font color="#000080">,</font>mem16<font color="#000080">,</font>reg16
<font color="#800000">1
2</font><font color="#000080">/</font><font color="#800000">2
2</font><font color="#000080">/</font><font color="#800000">3
2</font><font color="#000080">/</font><font color="#800000">9

</font>MOV reg8<font color="#000080">,</font>reg<font color="#000080">/</font>mem8
<font color="#800000">1
2</font><font color="#000080">/</font><font color="#800000">4
2</font><font color="#000080">/</font><font color="#800000">5
2</font><font color="#000080">/</font><font color="#800000">8

</font>MOV reg16<font color="#000080">,</font>reg<font color="#000080">/</font>mem16
<font color="#800000">1
2</font><font color="#000080">/</font><font color="#800000">4
2</font><font color="#000080">/</font><font color="#800000">5
2</font><font color="#000080">/</font><font color="#800000">8

</font>MOV reg8<font color="#000080">,</font>imm8
<font color="#800000">1
2
2
4

</font>MOV reg16<font color="#000080">,</font>imm16
<font color="#800000">1
2
2
4

</font>MOV reg<font color="#000080">/</font>mem8<font color="#000080">,</font>imm8
<font color="#800000">1
2</font><font color="#000080">/</font><font color="#800000">2
2</font><font color="#000080">/</font><font color="#800000">3
4</font><font color="#000080">/</font><font color="#800000">10

</font>MOV reg<font color="#000080">/</font>mem16<font color="#000080">,</font>imm16
<font color="#800000">1
2</font><font color="#000080">/</font><font color="#800000">2
2</font><font color="#000080">/</font><font color="#800000">3
4</font><font color="#000080">/</font><font color="#800000">10

</font>These timings are taking from the <font color="#000080">‘</font>Borland<font color="#000080">&acirc; </font>Turbo <font color="#FF0000"><b>Assembler</b></font><font color="#000080">&acirc; </font>Quick Reference<font color="#000080">’

</font>This shows that <font color="#FF0000"><b>on </b></font>the <font color="#800000">8086 </font>using variables <font color="#FF0000"><b>in </b></font>memory can make the instuction four 
times <font color="#FF0000"><b>as </b></font>slow<font color="#000080">. </font>This means that you should avoid using too many variables 
unnecessarily<font color="#000080">. </font><font color="#FF0000"><b>On </b></font>the <font color="#800000">486 </font>it doesn<font color="#000080">’</font>t matter <font color="#FF0000"><b>as </b></font>both instructions take the same amount 
<font color="#FF0000"><b>of </b></font>time<font color="#000080">.

</font>The method actually used <font color="#FF0000"><b>is </b></font>nearly identical <font color="#FF0000"><b>to </b></font>passing parameters <font color="#FF0000"><b>in </b></font>registers<font color="#000080">. </font>This 
example <font color="#FF0000"><b>is </b></font>just another version <font color="#FF0000"><b>of </b></font>the example given <font color="#FF0000"><b>for </b></font>passing <font color="#FF0000"><b>in </b></font>registers<font color="#000080">.


</font>FirstParam  db <font color="#800000">0  </font><font color="#000080">;</font>these are all variables <font color="#FF0000"><b>to </b></font>store
SecondParam db <font color="#800000">0  </font><font color="#000080">;</font>the parameters <font color="#FF0000"><b>for </b></font>the <font color="#FF0000"><b>program</b></font>	
ThirdParam  db <font color="#800000">0
</font>Answer	  db <font color="#800000">0
</font><font color="#000080">.....
</font>	mov FirstParam<font color="#000080">,</font><font color="#800000">10</font>	<font color="#000080">;</font>first parameter <font color="#FF0000"><b>is </b></font><font color="#800000">10</font>		
	mov SecondParam<font color="#000080">,</font><font color="#800000">20</font>	<font color="#000080">;</font>second parameter <font color="#FF0000"><b>is </b></font><font color="#800000">20
</font>	mov ThirdParam<font color="#000080">,</font><font color="#800000">3</font>	<font color="#000080">;</font>third parameter <font color="#FF0000"><b>is </b></font><font color="#800000">3
</font>	Call ChangeNumbers
<font color="#000080">.....
</font>ChangeNumbers PROC	     <font color="#000080">;</font>Defines start <font color="#FF0000"><b>of procedure
</b></font>	push ax			<font color="#000080">;</font>save ax
	push bx			<font color="#000080">;</font>save bx
	mov ax<font color="#000080">,</font>FirstParam	<font color="#000080">;</font>copy FirstParam into ax
	mov bx<font color="#000080">,</font>SecondParam	<font color="#000080">;</font>copy SecondParam into bx
	add ax<font color="#000080">,</font>bx			<font color="#000080">;</font>adds number <font color="#FF0000"><b>in </b></font>bx <font color="#FF0000"><b>to </b></font>ax
	mov bx<font color="#000080">,</font>ThirdParam	<font color="#000080">;</font>copy ThirdParam into bx 
	<font color="#FF0000"><b>div </b></font>bx			<font color="#000080">;</font>divides ax by bx
	mov Answer<font color="#000080">,</font>ax		<font color="#000080">;</font>return answer <font color="#FF0000"><b>in </b></font>Answer
	pop bx			<font color="#000080">;</font>restore bx
	pop ax			<font color="#000080">;</font>restore ax
	ret
ChangeNumbers ENDP		<font color="#000080">;</font>defines <font color="#FF0000"><b>end of procedure
</b></font>	
This way may seem more complicated but it <font color="#FF0000"><b>is not </b></font>really suited <font color="#FF0000"><b>for </b></font>small numbers <font color="#FF0000"><b>of 
</b></font>this <font color="#FF0000"><b>type of </b></font>parameters<font color="#000080">. </font>It <font color="#FF0000"><b>is </b></font>much more useful when dealing <font color="#FF0000"><b>with </b></font>strings <font color="#FF0000"><b>or </b></font>large 
numbers <font color="#FF0000"><b>of </b></font>big values<font color="#000080">.



</font>Passing through Stack<font color="#000080">:

</font>This <font color="#FF0000"><b>is </b></font>the most powerful <font color="#FF0000"><b>and </b></font>flexible method <font color="#FF0000"><b>of </b></font>passing parameters<font color="#000080">. </font>This example 
shows the ChangeNumbers <font color="#FF0000"><b>procedure </b></font>that has been rewritten <font color="#FF0000"><b>to </b></font>pass its parameters 
through the stack<font color="#000080">. 
</font>	mov ax<font color="#000080">,</font><font color="#800000">10</font>		<font color="#000080">;</font>first parameter <font color="#FF0000"><b>is </b></font><font color="#800000">10</font>			
	mov bx<font color="#000080">,</font><font color="#800000">20</font>		<font color="#000080">;</font>second parameter <font color="#FF0000"><b>is </b></font><font color="#800000">20
</font>	mov cx<font color="#000080">,</font><font color="#800000">3</font>		<font color="#000080">;</font>third parameter <font color="#FF0000"><b>is </b></font><font color="#800000">3
</font>	push ax		<font color="#000080">;</font>put first parameter <font color="#FF0000"><b>on </b></font>stack
	push bx		<font color="#000080">;</font>put second parameter <font color="#FF0000"><b>on </b></font>stack
	push cx		<font color="#000080">;</font>put third parameter <font color="#FF0000"><b>on </b></font>stack
	Call ChangeNumbers
<font color="#000080">.....
</font>ChangeNumbers PROC	<font color="#000080">;</font>Defines start <font color="#FF0000"><b>of procedure
</b></font>	push bp
	mov bp<font color="#000080">,</font>sp
	mov ax<font color="#000080">,[</font>bp<font color="#000080">+</font><font color="#800000">8</font><font color="#000080">]</font>	<font color="#000080">;</font>get the parameters from bp
	mov bx<font color="#000080">,[</font>bp<font color="#000080">+</font><font color="#800000">6</font><font color="#000080">]  ;</font>remember that first it <font color="#FF0000"><b>is </b></font>last <font color="#FF0000"><b>out
</b></font>	mov cx<font color="#000080">,[</font>bp<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">]</font>	<font color="#000080">;</font>so number <font color="#FF0000"><b>is </b></font>larger
	add ax<font color="#000080">,</font>bx		<font color="#000080">;</font>adds number <font color="#FF0000"><b>in </b></font>bx <font color="#FF0000"><b>to </b></font>ax
	<font color="#FF0000"><b>div </b></font>cx		<font color="#000080">;</font>divides ax by cx
	mov dx<font color="#000080">,</font>ax		<font color="#000080">;</font>return answer <font color="#FF0000"><b>in </b></font>dx
	ret
ChangeNumbers ENDP	<font color="#000080">;</font>defines <font color="#FF0000"><b>end of procedure

</b></font>This diagram shows the contents <font color="#FF0000"><b>of </b></font>the stack <font color="#FF0000"><b>for </b></font>a <font color="#FF0000"><b>program with </b></font>two parameters<font color="#000080">:
 

</font><font color="#FF0000"><b>To </b></font>get a parameter from the stack all you need <font color="#FF0000"><b>to do is </b></font>work <font color="#FF0000"><b>out </b></font>where it <font color="#FF0000"><b>is</b></font><font color="#000080">. </font>The last 
parameter <font color="#FF0000"><b>is </b></font>at BP<font color="#000080">+</font><font color="#800000">2 </font><font color="#FF0000"><b>and then </b></font>the next <font color="#FF0000"><b>and </b></font>BP<font color="#000080">+</font><font color="#800000">4.


</font>Files <font color="#FF0000"><b>and </b></font>how <font color="#FF0000"><b>to </b></font>used them<font color="#000080">:

</font>Files can be opened<font color="#000080">, </font>read <font color="#FF0000"><b>and </b></font>written <font color="#FF0000"><b>to</b></font><font color="#000080">. </font>DOS has some ways <font color="#FF0000"><b>of </b></font>doing this which save 
us the trouble <font color="#FF0000"><b>of </b></font>writing our own routines<font color="#000080">. </font>Yes<font color="#000080">, </font>more interrupts<font color="#000080">. </font>Here <font color="#FF0000"><b>is </b></font>a list <font color="#FF0000"><b>of 
</b></font>helpful functions <font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">21</font>h that we are going <font color="#FF0000"><b>to </b></font>need <font color="#FF0000"><b>to </b></font>use <font color="#FF0000"><b>for </b></font>our simple <font color="#FF0000"><b>file 
</b></font>viewer<font color="#000080">.

</font><font color="#FF0000"><b>Function </b></font><font color="#800000">3</font>Dh<font color="#000080">: </font>open <font color="#FF0000"><b>file
</b></font>Opens an existing <font color="#FF0000"><b>file for </b></font>reading<font color="#000080">, </font>writing <font color="#FF0000"><b>or </b></font>appending <font color="#FF0000"><b>on </b></font>the specified drive <font color="#FF0000"><b>and 
</b></font>filename<font color="#000080">.

</font>INPUT<font color="#000080">:
        </font>AH <font color="#000080">= </font><font color="#800000">3</font>Dh
        AL <font color="#000080">= </font>access mode
             bits <font color="#800000">0</font><font color="#000080">-</font><font color="#800000">2   000 </font><font color="#000080">= </font>read only
                        <font color="#800000">001 </font><font color="#000080">= </font>write only
                        <font color="#800000">010 </font><font color="#000080">= </font>read<font color="#000080">/</font>write
             bits <font color="#800000">4</font><font color="#000080">-</font><font color="#800000">6   </font>Sharing mode <font color="#000080">(</font>DOS <font color="#800000">3</font><font color="#000080">+)
                        </font><font color="#800000">000 </font><font color="#000080">= </font>compatibility mode
                        <font color="#800000">001 </font><font color="#000080">= </font>deny all <font color="#000080">(</font>only current <font color="#FF0000"><b>program </b></font>can access <font color="#FF0000"><b>file</b></font><font color="#000080">)
                        </font><font color="#800000">010 </font><font color="#000080">= </font>deny write <font color="#000080">(</font>other programs can only read it<font color="#000080">)
                        </font><font color="#800000">011 </font><font color="#000080">= </font>deny read <font color="#000080">(</font>other programs can only write <font color="#FF0000"><b>to </b></font>it<font color="#000080">)
                        </font><font color="#800000">100 </font><font color="#000080">= </font>deny none 
        DS<font color="#000080">:</font>DX <font color="#000080">= </font>segment<font color="#000080">:</font>offset <font color="#FF0000"><b>of </b></font>ASCIIZ pathname

OUTPUT<font color="#000080">:
        </font>CF <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>function is </b></font>succesful
        AX <font color="#000080">= </font>handle
        CF <font color="#000080">= </font><font color="#800000">1 </font>error has occured
        AX <font color="#000080">= </font>error code
                <font color="#800000">01</font>h missing <font color="#FF0000"><b>file </b></font>sharing software
                <font color="#800000">02</font>h <font color="#FF0000"><b>file not </b></font>found
                <font color="#800000">03</font>h path <font color="#FF0000"><b>not </b></font>found <font color="#FF0000"><b>or file </b></font>does <font color="#FF0000"><b>not </b></font>exist
                <font color="#800000">04</font>h no handle available
                <font color="#800000">05</font>h access denied
                <font color="#800000">0</font>Ch access mode <font color="#FF0000"><b>not </b></font>permitted

What does ASCIIZ mean<font color="#000080">? </font>An ASCIIZ <font color="#FF0000"><b>string is </b></font>a ASCII <font color="#FF0000"><b>string with </b></font>a zero <font color="#FF0000"><b>on </b></font>the <font color="#FF0000"><b>end 
</b></font><font color="#000080">(</font>instead <font color="#FF0000"><b>of </b></font>a dollar sign<font color="#000080">).

</font>Important<font color="#000080">: </font>Remember <font color="#FF0000"><b>to </b></font>save the <font color="#FF0000"><b>file </b></font>handle it <font color="#FF0000"><b>is </b></font>needed <font color="#FF0000"><b>for </b></font>later<font color="#000080">.



</font>How <font color="#FF0000"><b>to </b></font>save the <font color="#FF0000"><b>file </b></font>handle<font color="#000080">:
</font>It <font color="#FF0000"><b>is </b></font>important <font color="#FF0000"><b>to </b></font>save the <font color="#FF0000"><b>file </b></font>handle because this <font color="#FF0000"><b>is </b></font>needed <font color="#FF0000"><b>to do </b></font>anything <font color="#FF0000"><b>with </b></font>the 
<font color="#FF0000"><b>file</b></font><font color="#000080">. </font>Well how <font color="#FF0000"><b>is </b></font>this done<font color="#000080">? </font>There are two methods<font color="#000080">, </font>which <font color="#FF0000"><b>is </b></font>better<font color="#000080">? 

  </font>Copy the <font color="#FF0000"><b>file </b></font>handle into another <font color="#FF0000"><b>register and </b></font>don<font color="#800000">'t use that register.
  </font>Copy it <font color="#FF0000"><b>to </b></font>a variable <font color="#FF0000"><b>in </b></font>memory<font color="#000080">.

</font>The disadvantages <font color="#FF0000"><b>with </b></font>the first method <font color="#FF0000"><b>is </b></font>that you will have <font color="#FF0000"><b>to </b></font>remember <font color="#FF0000"><b>not to </b></font>use 
the <font color="#FF0000"><b>register </b></font>you saved it <font color="#FF0000"><b>in and </b></font>it wastes a <font color="#FF0000"><b>register </b></font>that can be used <font color="#FF0000"><b>for </b></font>something more 
useful<font color="#000080">. </font>We are going <font color="#FF0000"><b>to </b></font>use the second<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>how it <font color="#FF0000"><b>is </b></font>done<font color="#000080">:

</font>	FileHandle DW <font color="#800000">0     </font><font color="#000080">;</font>use this <font color="#FF0000"><b>for </b></font>saving the <font color="#FF0000"><b>file 
</b></font>					<font color="#000080">;</font>handle

     MOV FileHandle<font color="#000080">,</font>ax   <font color="#000080">;</font>save the <font color="#FF0000"><b>file </b></font>handle <font color="#000080">(</font>same <font color="#FF0000"><b>as 
</b></font>					<font color="#000080">;</font>FileHandle<font color="#000080">=</font>ax<font color="#000080">) 


</font><font color="#FF0000"><b>Function </b></font><font color="#800000">3E</font>h<font color="#000080">: </font>close <font color="#FF0000"><b>file
</b></font>Closes a <font color="#FF0000"><b>file </b></font>that has been opened<font color="#000080">.

</font>INPUT<font color="#000080">:
        </font>AX <font color="#000080">= </font><font color="#800000">3E</font>h
        BX <font color="#000080">= </font><font color="#FF0000"><b>file </b></font>handle
 
OUTPUT<font color="#000080">:
        </font>CF <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>function is </b></font>sucsessful
        AX <font color="#000080">= </font>destroyed
        CF <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>function not </b></font>sucsessful
        AX <font color="#000080">= </font>error code <font color="#000080">- </font><font color="#800000">06</font>h <font color="#FF0000"><b>file not </b></font>opened <font color="#FF0000"><b>or </b></font>unautorized handle<font color="#000080">.

</font>Important<font color="#000080">: </font>Don<font color="#800000">'t call this function with a zero handle because that will close the 
</font>standard input <font color="#000080">(</font>the keyboard<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>you won<font color="#800000">'t be able to enter anything.
        
</font><font color="#FF0000"><b>Function </b></font><font color="#800000">3</font>Fh<font color="#000080">: </font>read <font color="#FF0000"><b>file</b></font><font color="#000080">/</font>device
Reads bytes from a <font color="#FF0000"><b>file or </b></font>device <font color="#FF0000"><b>to </b></font>a buffer<font color="#000080">.

</font>INPUT<font color="#000080">:
        </font>AH <font color="#000080">= </font><font color="#800000">3</font>Fh
        BX <font color="#000080">= </font>handle
        CX <font color="#000080">= </font>number <font color="#FF0000"><b>of </b></font>bytes <font color="#FF0000"><b>to </b></font>be read
        DS<font color="#000080">:</font>DX <font color="#000080">= </font>segment<font color="#000080">:</font>offset <font color="#FF0000"><b>of </b></font>a buffer

OUTPUT<font color="#000080">:
        </font>CF <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>function is </b></font>successful
        AX <font color="#000080">= </font>number <font color="#FF0000"><b>of </b></font>bytes read
        CF <font color="#000080">= </font><font color="#800000">1 </font>an error has occured
                <font color="#800000">05</font>h access denied
                <font color="#800000">06</font>h illegal handle <font color="#FF0000"><b>or file not </b></font>opened


<font color="#FF0000"><b>If </b></font>CF <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>and </b></font>AX <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>the <font color="#FF0000"><b>file </b></font>pointer was already at the <font color="#FF0000"><b>end of </b></font>the <font color="#FF0000"><b>file and </b></font>no 
more can be read<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>CF <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>and </b></font>AX <font color="#FF0000"><b>is </b></font>smaller than CX <font color="#FF0000"><b>then </b></font>only part was read 
because the <font color="#FF0000"><b>end of </b></font>the <font color="#FF0000"><b>file </b></font>was reached <font color="#FF0000"><b>or </b></font>an error occured<font color="#000080">. 

</font>This <font color="#FF0000"><b>function </b></font>can also be used <font color="#FF0000"><b>to </b></font>get input from the keyboard<font color="#000080">. </font>Use a handle <font color="#FF0000"><b>of </b></font><font color="#800000">0</font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>it 
stops reading after the first carriage return<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>once a specified number <font color="#FF0000"><b>of </b></font>characters 
have been read<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>a good <font color="#FF0000"><b>and </b></font>easy method <font color="#FF0000"><b>to </b></font>use <font color="#FF0000"><b>to </b></font>only let the user enter a 
certain amount <font color="#FF0000"><b>of </b></font>characters<font color="#000080">.

</font>Note<font color="#000080">: </font><font color="#FF0000"><b>If </b></font>you are using A86 this will cause an error<font color="#000080">. </font>Change <font color="#000080">@</font>data <font color="#FF0000"><b>to </b></font>data <font color="#FF0000"><b>to </b></font>make it 
work<font color="#000080">.

.</font>MODEL small
<font color="#000080">.</font>STACK
<font color="#000080">.</font>CODE               
	mov ax<font color="#000080">,@</font>data     <font color="#000080">;</font>base jaddress <font color="#FF0000"><b>of </b></font>data
	mov ds<font color="#000080">,</font>ax        <font color="#000080">;</font>segment
	
	lea dx<font color="#000080">,</font>FileName  <font color="#000080">;</font>put address <font color="#FF0000"><b>of </b></font>fileneame <font color="#FF0000"><b>in </b></font>dx        
	mov al<font color="#000080">,</font><font color="#800000">2         </font><font color="#000080">;</font>access mode <font color="#000080">- </font>read <font color="#FF0000"><b>and </b></font>write
	mov ah<font color="#000080">,</font><font color="#800000">3</font>Dh       <font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">3</font>Dh <font color="#000080">-</font>open a <font color="#FF0000"><b>file
</b></font>	int <font color="#800000">21</font>h          <font color="#000080">;</font>call DOS service
	mov Handle<font color="#000080">,</font>ax    <font color="#000080">;</font>save <font color="#FF0000"><b>file </b></font>handle <font color="#FF0000"><b>for </b></font>later
	jc ErrorOpening
	
	mov dx<font color="#000080">,</font>offset Buffer  <font color="#000080">;</font>address <font color="#FF0000"><b>of </b></font>buffer <font color="#FF0000"><b>in </b></font>dx
	mov bx<font color="#000080">,</font>Handle         <font color="#000080">;</font>handle <font color="#FF0000"><b>in </b></font>bx
	mov cx<font color="#000080">,</font><font color="#800000">100            </font><font color="#000080">;</font>amount <font color="#FF0000"><b>of </b></font>bytes <font color="#FF0000"><b>to </b></font>be read
	mov ah<font color="#000080">,</font><font color="#800000">3</font>Fh            <font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">3</font>Fh <font color="#000080">- </font>read from <font color="#FF0000"><b>file
</b></font>	int <font color="#800000">21</font>h               <font color="#000080">;</font>call dos service
	jc ErrorReading           

	mov bx<font color="#000080">,</font>Handle    <font color="#000080">;</font>put <font color="#FF0000"><b>file </b></font>handle <font color="#FF0000"><b>in </b></font>bx 
	mov ah<font color="#000080">,</font><font color="#800000">3E</font>h       <font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">3E</font>h <font color="#000080">- </font>close a <font color="#FF0000"><b>file
</b></font>	int <font color="#800000">21</font>h          <font color="#000080">;</font>call dos service
   
	mov di<font color="#000080">,</font>OFFSET Buffer<font color="#000080">+</font><font color="#800000">101  </font><font color="#000080">;</font>Where <font color="#FF0000"><b>to </b></font>put the <font color="#000080">&quot;</font><font color="#800000">$</font><font color="#000080">&quot;
</font>	mov byte ptr <font color="#000080">[</font>di<font color="#000080">],&quot;</font><font color="#800000">$</font><font color="#000080">&quot;     ;</font>Put it at es<font color="#000080">:</font>di
	mov ah<font color="#000080">,</font><font color="#800000">9                  </font><font color="#000080">;</font>write a <font color="#FF0000"><b>string to </b></font>the 
	mov dx<font color="#000080">,</font>OFFSET Buffer	 <font color="#000080">;</font>screen using <font color="#FF0000"><b>function </b></font><font color="#800000">9</font>h
	int <font color="#800000">21</font>h				 <font color="#000080">;</font><font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">21</font>h

	mov AX<font color="#000080">,</font><font color="#800000">4</font>C00h     <font color="#000080">;</font>terminate <font color="#FF0000"><b>program and </b></font>return <font color="#FF0000"><b>to                                                                       
</b></font>				  <font color="#000080">;</font>DOS using
	INT <font color="#800000">21</font>h          <font color="#000080">;</font>interrupt <font color="#800000">21</font>h <font color="#FF0000"><b>function </b></font><font color="#800000">4</font>CH

ErrorOpening<font color="#000080">:
</font>	mov dx<font color="#000080">,</font>offset OpenError <font color="#000080">;</font>display an error                                                                            
	mov ah<font color="#000080">,</font><font color="#800000">09</font>h       <font color="#000080">;</font>using <font color="#FF0000"><b>function </b></font><font color="#800000">09</font>h
	int <font color="#800000">21</font>h          <font color="#000080">;</font>call dos service
	



     mov ax<font color="#000080">,</font><font color="#800000">4</font>C01h <font color="#000080">;</font><font color="#FF0000"><b>end program with </b></font>an errorlevel <font color="#FF0000"><b>of </b></font><font color="#800000">1   
</font>	int <font color="#800000">21</font>h
		
ErrorReading<font color="#000080">:
</font>	mov dx<font color="#000080">,</font>offset ReadError <font color="#000080">;</font>display an error                                                                            
	mov ah<font color="#000080">,</font><font color="#800000">09</font>h       <font color="#000080">;</font>using <font color="#FF0000"><b>function </b></font><font color="#800000">09</font>h
	int <font color="#800000">21</font>h          <font color="#000080">;</font>call dos service
		
	mov ax<font color="#000080">,</font><font color="#800000">4</font>C02h <font color="#000080">;</font><font color="#FF0000"><b>end program with </b></font>an errorlevel <font color="#FF0000"><b>of </b></font><font color="#800000">2   
        </font>int <font color="#800000">21</font>h
 
<font color="#000080">.</font>DATA

Handle        DW <font color="#000080">? ;</font>variable <font color="#FF0000"><b>to </b></font>store <font color="#FF0000"><b>file </b></font>handle   
FileName      DB <font color="#000080">&quot;</font>C<font color="#000080">:\</font>test<font color="#000080">.</font>txt<font color="#000080">&quot;,</font><font color="#800000">0 </font><font color="#000080">;</font><font color="#FF0000"><b>file to </b></font>be opened

OpenError     DB <font color="#000080">&quot;</font>An error has occured<font color="#000080">(</font>opening<font color="#000080">)!</font><font color="#800000">$</font><font color="#000080">&quot;
</font>ReadError     DB <font color="#000080">&quot;</font>An error has occured<font color="#000080">(</font>reading<font color="#000080">)!</font><font color="#800000">$</font><font color="#000080">&quot;

</font>Buffer        DB <font color="#800000">101 </font>dup <font color="#000080">(?) ;</font>buffer <font color="#FF0000"><b>to </b></font>store data from                                             
					    <font color="#000080">;</font><font color="#FF0000"><b>file </b></font>one bigger <font color="#FF0000"><b>for </b></font><font color="#800000">$
</font><font color="#FF0000"><b>END

Function</b></font><font color="#000080">: </font><font color="#800000">3</font>Ch<font color="#000080">: </font>Create <font color="#FF0000"><b>file
</b></font>Creates a new empty <font color="#FF0000"><b>file on </b></font>a specified drive <font color="#FF0000"><b>with </b></font>a specified pathname<font color="#000080">.

</font>INPUT<font color="#000080">:
        </font>AH <font color="#000080">= </font><font color="#800000">3</font>Ch
        CX <font color="#000080">= </font><font color="#FF0000"><b>file </b></font>attribute
                bit <font color="#800000">0 </font><font color="#000080">= </font><font color="#800000">1 </font>read<font color="#000080">-</font>only <font color="#FF0000"><b>file
                </b></font>bit <font color="#800000">1 </font><font color="#000080">= </font><font color="#800000">1 </font>hidden <font color="#FF0000"><b>file
                </b></font>bit <font color="#800000">2 </font><font color="#000080">= </font><font color="#800000">1 </font>system <font color="#FF0000"><b>file
                </b></font>bit <font color="#800000">3 </font><font color="#000080">= </font><font color="#800000">1 </font>volume <font color="#000080">(</font>ignored<font color="#000080">)
                </font>bit <font color="#800000">4 </font><font color="#000080">= </font><font color="#800000">1 </font>reserved <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">) - </font>directory
                bit <font color="#800000">5 </font><font color="#000080">= </font><font color="#800000">1 </font>archive bit
                bits <font color="#800000">6</font><font color="#000080">-</font><font color="#800000">15 </font>reserved <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)
    </font>DS<font color="#000080">:</font>DX <font color="#000080">= </font>segment<font color="#000080">:</font>offset <font color="#FF0000"><b>of </b></font>ASCIIZ pathname

OUTPUT<font color="#000080">:
    </font>CF <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>function is </b></font>successuful
    AX <font color="#000080">= </font>handle
    CF <font color="#000080">= </font><font color="#800000">1 </font>an error has occured
                <font color="#800000">03</font>h path <font color="#FF0000"><b>not </b></font>found
                <font color="#800000">04</font>h no availible handle
                <font color="#800000">05</font>h access denied

Important<font color="#000080">: </font><font color="#FF0000"><b>If </b></font>a <font color="#FF0000"><b>file of </b></font>the same name exists <font color="#FF0000"><b>then </b></font>it will be lost<font color="#000080">. </font>Make sure that there 
<font color="#FF0000"><b>is </b></font>no <font color="#FF0000"><b>file of </b></font>the same name<font color="#000080">. </font>This can be done <font color="#FF0000"><b>with </b></font>the <font color="#FF0000"><b>function </b></font>below<font color="#000080">.



</font><font color="#FF0000"><b>Function </b></font><font color="#800000">4E</font>h<font color="#000080">: </font>find first matching <font color="#FF0000"><b>file
</b></font>Searches <font color="#FF0000"><b>for </b></font>the first <font color="#FF0000"><b>file </b></font>that matches the filename given<font color="#000080">.

</font>INPUT<font color="#000080">:
    </font>AH <font color="#000080">= </font><font color="#800000">4E</font>h
    CX <font color="#000080">= </font><font color="#FF0000"><b>file </b></font>attribute mask <font color="#000080">(</font>bits can be combined<font color="#000080">)
                </font>bit <font color="#800000">0 </font><font color="#000080">= </font><font color="#800000">1 </font>read only
                bit <font color="#800000">1 </font><font color="#000080">= </font><font color="#800000">1 </font>hidden
                bit <font color="#800000">2 </font><font color="#000080">= </font><font color="#800000">1 </font>system
                bit <font color="#800000">3 </font><font color="#000080">= </font><font color="#800000">1 </font>volume <font color="#FF0000"><b>label
                </b></font>bit <font color="#800000">4 </font><font color="#000080">= </font><font color="#800000">1 </font>directory
                bit <font color="#800000">5 </font><font color="#000080">= </font><font color="#800000">1 </font>archive
                bit <font color="#800000">6</font><font color="#000080">-</font><font color="#800000">15 </font>reserved
    DS<font color="#000080">:</font>DX <font color="#000080">= </font>segment<font color="#000080">:</font>offset <font color="#FF0000"><b>of </b></font>ASCIIZ pathname

OUTPUT<font color="#000080">:
    </font>CF <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>function is </b></font>successful
    <font color="#000080">[</font>DTA<font color="#000080">] </font>Disk Transfer Area <font color="#000080">= </font>FindFirst data block

Example <font color="#FF0000"><b>of </b></font>checking <font color="#FF0000"><b>if file </b></font>exists<font color="#000080">:
</font><font color="#FF0000"><b>File    </b></font>DB <font color="#000080">&quot;</font>C<font color="#000080">:\</font><font color="#FF0000"><b>file</b></font><font color="#000080">.</font>txt<font color="#000080">&quot;,</font><font color="#800000">0   </font><font color="#000080">;</font>name <font color="#FF0000"><b>of file </b></font>that we want

        LEA dx<font color="#000080">,</font><font color="#FF0000"><b>File      </b></font><font color="#000080">;</font>address <font color="#FF0000"><b>of </b></font>filename
        MOV cx<font color="#000080">,</font><font color="#800000">3</font>Fh       <font color="#000080">;</font><font color="#FF0000"><b>file </b></font>mask <font color="#800000">3</font>Fh <font color="#000080">- </font>any <font color="#FF0000"><b>file
        </b></font>MOV ah<font color="#000080">,</font><font color="#800000">4E</font>h      	<font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">4E</font>h <font color="#000080">- </font>find first <font color="#FF0000"><b>file
        </b></font>INT <font color="#800000">21</font>h          <font color="#000080">;</font>call dos service
        JC NoFile
        <font color="#000080">;</font>print <font color="#FF0000"><b>message </b></font>saying <font color="#FF0000"><b>file </b></font>exists
NoFile<font color="#000080">:
        ;</font>continue <font color="#FF0000"><b>with </b></font>creating <font color="#FF0000"><b>file


</b></font>This example <font color="#FF0000"><b>program </b></font>creates a <font color="#FF0000"><b>file and then </b></font>writes <font color="#FF0000"><b>to </b></font>it<font color="#000080">.
.</font>MODELSMALL
<font color="#000080">.</font>STACK
<font color="#000080">.</font>CODE               
	mov ax<font color="#000080">,@</font>data     <font color="#000080">;</font>base jaddress <font color="#FF0000"><b>of </b></font>data
	mov ds<font color="#000080">,</font>ax        <font color="#000080">;</font>segment

	mov dx<font color="#000080">,</font>offset StartMessage    <font color="#000080">;</font>display the starting 
							<font color="#000080">;</font><font color="#FF0000"><b>message 
     </b></font>mov ah<font color="#000080">,</font><font color="#800000">09</font>h     <font color="#000080">;</font>using <font color="#FF0000"><b>function </b></font><font color="#800000">09</font>h
     int <font color="#800000">21</font>h        <font color="#000080">;</font>call dos service
 
     mov dx<font color="#000080">,</font>offset FileName <font color="#000080">;</font>put offset <font color="#FF0000"><b>of </b></font>filename <font color="#FF0000"><b>in </b></font>dx        
     <font color="#FF0000"><b>xor </b></font>cx<font color="#000080">,</font>cx      <font color="#000080">;</font>clear cx <font color="#000080">- </font>make ordinary <font color="#FF0000"><b>file
     </b></font>mov ah<font color="#000080">,</font><font color="#800000">3</font>Ch     <font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">3</font>Ch <font color="#000080">- </font>create a <font color="#FF0000"><b>file
     </b></font>int <font color="#800000">21</font>h        <font color="#000080">;</font>call DOS service
     jc Error       <font color="#000080">;</font>jump <font color="#FF0000"><b>if </b></font>there <font color="#FF0000"><b>is </b></font>an error
        
     mov dx<font color="#000080">,</font>offset FileName <font color="#000080">;</font>put offset <font color="#FF0000"><b>of </b></font>filename <font color="#FF0000"><b>in </b></font>dx
     mov al<font color="#000080">,</font><font color="#800000">2       </font><font color="#000080">;</font>access mode <font color="#000080">-</font>read <font color="#FF0000"><b>and </b></font>write
     mov ah<font color="#000080">,</font><font color="#800000">3</font>Dh     <font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">3</font>Dh <font color="#000080">- </font>open the <font color="#FF0000"><b>file
     </b></font>int <font color="#800000">21</font>h        <font color="#000080">;</font>call dos service
     jc Error       <font color="#000080">;</font>jump <font color="#FF0000"><b>if </b></font>there <font color="#FF0000"><b>is </b></font>an error
     mov Handle<font color="#000080">,</font>ax  <font color="#000080">;</font>save value <font color="#FF0000"><b>of </b></font>handle        

     mov dx<font color="#000080">,</font>offset WriteMe 	<font color="#000080">;</font>address <font color="#FF0000"><b>of </b></font>information <font color="#FF0000"><b>to 
</b></font>						<font color="#000080">;</font>write <font color="#FF0000"><b>to </b></font>the <font color="#FF0000"><b>file
     </b></font>mov bx<font color="#000080">,</font>Handle  <font color="#000080">;</font><font color="#FF0000"><b>file </b></font>handle <font color="#FF0000"><b>for file
     </b></font>mov cx<font color="#000080">,</font><font color="#800000">38      </font><font color="#000080">;</font><font color="#800000">38 </font>bytes <font color="#FF0000"><b>to </b></font>be written
     mov ah<font color="#000080">,</font><font color="#800000">40</font>h     <font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">40</font>h write <font color="#FF0000"><b>to file
     </b></font>int <font color="#800000">21</font>h        <font color="#000080">;</font>call dos service
     jc error       <font color="#000080">;</font>jump <font color="#FF0000"><b>if </b></font>there <font color="#FF0000"><b>is </b></font>an error
     cmp ax<font color="#000080">,</font>cx      <font color="#000080">;</font>was all the data written<font color="#000080">? </font>Does 	
				<font color="#000080">;</font>ax<font color="#000080">=</font>cx<font color="#000080">?
     </font>jne error      <font color="#000080">;</font><font color="#FF0000"><b>if </b></font>it wasn<font color="#800000">'t then there was an error

     </font>mov bx<font color="#000080">,</font>Handle  <font color="#000080">;</font>put <font color="#FF0000"><b>file </b></font>handle <font color="#FF0000"><b>in </b></font>bx 
     mov ah<font color="#000080">,</font><font color="#800000">3E</font>h     <font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">3E</font>h <font color="#000080">- </font>close a <font color="#FF0000"><b>file
     </b></font>int <font color="#800000">21</font>h        <font color="#000080">;</font>call dos service
        
     mov dx<font color="#000080">,</font>offset EndMessage <font color="#000080">;</font>display the final <font color="#FF0000"><b>message 
</b></font>						<font color="#000080">;</font><font color="#FF0000"><b>on </b></font>the screen
     mov ah<font color="#000080">,</font><font color="#800000">09</font>h     <font color="#000080">;</font>using <font color="#FF0000"><b>function </b></font><font color="#800000">09</font>h
     int <font color="#800000">21</font>h        <font color="#000080">;</font>call dos service
 
ReturnToDOS<font color="#000080">:
     </font>mov AX<font color="#000080">,</font><font color="#800000">4</font>C00h   <font color="#000080">;</font>terminate <font color="#FF0000"><b>program and </b></font>return <font color="#FF0000"><b>to </b></font>DOS 
     int <font color="#800000">21</font>h        <font color="#000080">;</font>using interrupt <font color="#800000">21</font>h <font color="#FF0000"><b>function </b></font><font color="#800000">4</font>CH



Error<font color="#000080">:
     </font>mov dx<font color="#000080">,</font>offset ErrorMessage <font color="#000080">;</font>display an error <font color="#FF0000"><b>message 
</b></font>						  <font color="#000080">;</font><font color="#FF0000"><b>on </b></font>the screen
     mov ah<font color="#000080">,</font><font color="#800000">09</font>h      <font color="#000080">;</font>using <font color="#FF0000"><b>function </b></font><font color="#800000">09</font>h
     int <font color="#800000">21</font>h         <font color="#000080">;</font>call dos service
     jmp ReturnToDOS <font color="#000080">;</font>lets <font color="#FF0000"><b>end </b></font>this now

<font color="#000080">.</font>DATA                            
StartMessage    DB <font color="#000080">&quot;</font>This <font color="#FF0000"><b>program </b></font>creates a <font color="#FF0000"><b>file </b></font>called<font color="#000080">”, 
</font>			    <font color="#000080">“</font>NEW<font color="#000080">.</font>TXT <font color="#FF0000"><b>in </b></font>the C<font color="#000080">: </font>directory<font color="#000080">.</font><font color="#800000">$</font><font color="#000080">&quot;
</font>EndMessage      DB <font color="#800000">0</font>Ah<font color="#000080">,</font><font color="#800000">0</font>Dh<font color="#000080">,&quot;</font><font color="#FF0000"><b>File </b></font>create OK<font color="#000080">, </font>look at<font color="#000080">”,</font> 	
			    <font color="#000080">“</font><font color="#FF0000"><b>file to </b></font>be sure<font color="#000080">.</font><font color="#800000">$</font><font color="#000080">&quot;
</font>Handle          DW <font color="#000080">? ;</font>variable <font color="#FF0000"><b>to </b></font>store <font color="#FF0000"><b>file </b></font>handle   
ErrorMessage    DB <font color="#000080">&quot;</font>An error has occurred<font color="#000080">!</font><font color="#800000">$</font><font color="#000080">&quot;
</font>WriteMe         DB <font color="#000080">&quot;</font>HELLO<font color="#000080">, </font>THIS <font color="#FF0000"><b>IS </b></font>A TEST<font color="#000080">, </font>HAS IT<font color="#000080">”,</font> 	
			    <font color="#000080">“</font>WORKED<font color="#000080">?&quot;,</font><font color="#800000">0 </font><font color="#000080">;</font>ASCIIZ 
FileName        DB <font color="#000080">&quot;</font>C<font color="#000080">:\</font>new<font color="#000080">.</font>txt<font color="#000080">&quot;,</font><font color="#800000">0</font> 					
<font color="#FF0000"><b>END

</b></font>How <font color="#FF0000"><b>to </b></font>find <font color="#FF0000"><b>out </b></font>the DOS version<font color="#000080">:

</font><font color="#FF0000"><b>In </b></font>many programs it <font color="#FF0000"><b>is </b></font>necessary <font color="#FF0000"><b>to </b></font>find <font color="#FF0000"><b>out </b></font>what the DOS version <font color="#FF0000"><b>is</b></font><font color="#000080">. </font>This could be 
because you are using a DOS <font color="#FF0000"><b>function </b></font>that needs the revision <font color="#FF0000"><b>to </b></font>be over a certain 
level<font color="#000080">.

</font>Firstly this method simply finds <font color="#FF0000"><b>out </b></font>what the version <font color="#FF0000"><b>is</b></font><font color="#000080">.

</font>	mov	ah<font color="#000080">,</font><font color="#800000">30</font>h 	<font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">30</font>h <font color="#000080">- </font>get MS<font color="#000080">-</font>DOS version
	int 	<font color="#800000">21</font>h		<font color="#000080">;</font>call DOS <font color="#FF0000"><b>function

</b></font>This <font color="#FF0000"><b>function </b></font>returns the major version number <font color="#FF0000"><b>in </b></font>AL <font color="#FF0000"><b>and </b></font>the minor version number <font color="#FF0000"><b>in 
</b></font>AH<font color="#000080">. </font><font color="#FF0000"><b>For </b></font>example <font color="#FF0000"><b>if </b></font>it was version <font color="#800000">4.01</font><font color="#000080">, </font>AL would be <font color="#800000">4 </font><font color="#FF0000"><b>and </b></font>AH would be <font color="#800000">01. </font>The 
problem <font color="#FF0000"><b>is </b></font>that <font color="#FF0000"><b>if on </b></font>DOS <font color="#800000">5 </font><font color="#FF0000"><b>and </b></font>higher SETVER can change the version that <font color="#FF0000"><b>is 
</b></font>returned<font color="#000080">. </font>The way <font color="#FF0000"><b>to </b></font>get round this <font color="#FF0000"><b>is to </b></font>use this method<font color="#000080">.

</font>	mov	ah<font color="#000080">,</font><font color="#800000">33</font>h    <font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">33</font>h <font color="#000080">- </font>actual DOS version
 	mov	al<font color="#000080">,</font><font color="#800000">06</font>h	<font color="#000080">;</font>subfunction <font color="#800000">06</font>h
	int	<font color="#800000">21</font>h	  	<font color="#000080">;</font>call interrupt <font color="#800000">21</font>h	

This will only work <font color="#FF0000"><b>on </b></font>DOS version <font color="#800000">5 </font><font color="#FF0000"><b>and </b></font>above so you need <font color="#FF0000"><b>to </b></font>check using the 
former method<font color="#000080">. </font>This will return the actual version <font color="#FF0000"><b>of </b></font>DOS even <font color="#FF0000"><b>if </b></font>SETVER has 
changed the version<font color="#000080">. </font>This returns the major version <font color="#FF0000"><b>in </b></font>BL <font color="#FF0000"><b>and </b></font>the minor version <font color="#FF0000"><b>in </b></font>BH<font color="#000080">.



</font>Fast <font color="#FF0000"><b>string </b></font>print<font color="#000080">:

</font>We have been using a DOS service<font color="#000080">, </font><font color="#FF0000"><b>function </b></font><font color="#800000">9 </font><font color="#FF0000"><b>of </b></font>interrupt <font color="#800000">21</font>h <font color="#FF0000"><b>to </b></font>print a <font color="#FF0000"><b>string on </b></font>the 
screen<font color="#000080">. </font>This isn<font color="#000080">’</font>t too fast nor does it allow us <font color="#FF0000"><b>to </b></font>use different colours <font color="#FF0000"><b>or </b></font>position the 
text<font color="#000080">. </font>There <font color="#FF0000"><b>is </b></font>another way <font color="#FF0000"><b>to </b></font>print a <font color="#FF0000"><b>string to </b></font>the screen <font color="#000080">- </font>direct <font color="#FF0000"><b>to </b></font>memory<font color="#000080">. </font>This <font color="#FF0000"><b>is 
</b></font>harder <font color="#FF0000"><b>as </b></font>you have <font color="#FF0000"><b>to set </b></font>up everything manually but it has a lot <font color="#FF0000"><b>of </b></font>benifits mainly 
speed<font color="#000080">. 

</font>TextAttribute db <font color="#800000">7</font> 	<font color="#000080">;</font><font color="#FF0000"><b>contains </b></font>the character attribute
				<font color="#000080">;</font><font color="#FF0000"><b>default is </b></font>grey <font color="#FF0000"><b>on </b></font>black 
<font color="#000080">......
</font>FastTextPrint PROC            
<font color="#000080">.</font><font color="#800000">286    </font><font color="#000080">;</font>need this <font color="#FF0000"><b>for </b></font>shift instructions<font color="#000080">. </font>Take <font color="#FF0000"><b>out if 
</b></font>less 
        <font color="#000080">;</font>than <font color="#800000">286
</font><font color="#000080">;========================================================
;</font>INPUT<font color="#000080">: </font>AH <font color="#000080">- </font>Row
<font color="#000080">;       </font>AL <font color="#000080">- </font>Column
<font color="#000080">;       </font>CX <font color="#000080">- </font>Length <font color="#FF0000"><b>of string
</b></font><font color="#000080">;       </font>DS<font color="#000080">:</font>DX <font color="#000080">- </font>The <font color="#FF0000"><b>string
</b></font><font color="#000080">;       </font>TextAttribute <font color="#000080">- </font>the colour <font color="#FF0000"><b>of </b></font>the text
<font color="#000080">;</font>OUTPUT<font color="#000080">: </font>none
<font color="#000080">;========================================================
        </font>push ax bx cx dx bp si di es <font color="#000080">;</font>save registers
        mov bl<font color="#000080">,</font>ah     	<font color="#000080">;</font>move row into bl
        <font color="#FF0000"><b>xor </b></font>bh<font color="#000080">,</font>bh        <font color="#000080">;</font>clear bh
        <font color="#FF0000"><b>shl </b></font>bx<font color="#000080">,</font><font color="#800000">5         </font><font color="#000080">;</font>shift bx <font color="#800000">5 </font>places <font color="#FF0000"><b>to </b></font>the left
        mov si<font color="#000080">,</font>bx        <font color="#000080">;</font>move bx into si
        <font color="#FF0000"><b>shl </b></font>bx<font color="#000080">,</font><font color="#800000">2         </font><font color="#000080">;</font>shift bx <font color="#800000">2 </font>places <font color="#FF0000"><b>to </b></font>the left
        add bx<font color="#000080">,</font>si        <font color="#000080">;</font>add si <font color="#FF0000"><b>to </b></font>bx
        <font color="#FF0000"><b>xor </b></font>ah<font color="#000080">,</font>ah        <font color="#000080">;</font>clear ah
        <font color="#FF0000"><b>shl </b></font>ax<font color="#000080">,</font><font color="#800000">1         </font><font color="#000080">;</font>shift ax <font color="#800000">1 </font>place <font color="#FF0000"><b>to </b></font>the left
        add bx<font color="#000080">,</font>ax        <font color="#000080">;</font>add ax onto bx
        mov ax<font color="#000080">,</font><font color="#800000">0</font>b800h    <font color="#000080">;</font>ax <font color="#FF0000"><b>contains </b></font>text video memory
        mov es<font color="#000080">,</font>ax        <font color="#000080">;</font>move ax into es
        mov si<font color="#000080">,</font>dx        <font color="#000080">;</font>mov dx into si
FastTextPrintLoop<font color="#000080">: 
       </font>mov ah<font color="#000080">,</font>ds<font color="#000080">:[</font>si<font color="#000080">]</font>	<font color="#000080">;</font>put the char at ds<font color="#000080">[</font>si<font color="#000080">] </font>into ah
       mov es<font color="#000080">:[</font>bx<font color="#000080">],</font>ah    <font color="#000080">;</font>move the char <font color="#FF0000"><b>in </b></font>ah <font color="#FF0000"><b>to </b></font>es<font color="#000080">[</font>bx<font color="#000080">]
       </font>inc si           	<font color="#000080">;</font>increment si <font color="#000080">(</font>si<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)
       </font>inc bx            <font color="#000080">;</font>increment bx <font color="#000080">(</font>bx<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)
       </font>mov ah<font color="#000080">,</font>TextAttribute <font color="#000080">;</font>put the attribute into ah
       mov es<font color="#000080">:[</font>bx<font color="#000080">],</font>ah    <font color="#000080">;</font>put ah into es position at bx
       inc bx            <font color="#000080">;</font>increment bx <font color="#000080">(</font>bx<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)
       </font>loop FastTextPrintLoop 	<font color="#000080">;</font>loop CX times
       pop es di si bp dx cx bx ax <font color="#000080">;</font>restore registers
       ret			<font color="#000080">;</font>return
FastTextPrint ENDP


Explanation  <font color="#FF0000"><b>of </b></font>new terms <font color="#FF0000"><b>in </b></font>this <font color="#FF0000"><b>procedure</b></font><font color="#000080">:

</font><font color="#FF0000"><b>In </b></font>this <font color="#FF0000"><b>procedure </b></font>there was several things that you have <font color="#FF0000"><b>not </b></font>come across before<font color="#000080">. </font>Firsly 
the lines<font color="#000080">:

</font>	push ax bx cx dx bp si di es 	<font color="#000080">;</font>save registers
	pop es di si bp dx cx bx ax 	<font color="#000080">;</font>restore registers

This <font color="#FF0000"><b>is </b></font>just an easier way <font color="#FF0000"><b>of </b></font>pushing <font color="#FF0000"><b>and </b></font>popping more than one <font color="#FF0000"><b>register</b></font><font color="#000080">. </font>When TASM 
<font color="#000080">(</font><font color="#FF0000"><b>or </b></font>A86<font color="#000080">) </font>compiles these lines it translates it into separate pushes an pops<font color="#000080">. </font>This way 
just saves you time typing <font color="#FF0000"><b>and </b></font>makes it easier <font color="#FF0000"><b>to </b></font>understand<font color="#000080">.

</font>Note<font color="#000080">: </font><font color="#FF0000"><b>To </b></font>make these lines compile <font color="#FF0000"><b>in </b></font>A86 you need <font color="#FF0000"><b>to </b></font>put commas <font color="#000080">(,) </font><font color="#FF0000"><b>in </b></font>between the 
registers<font color="#000080">.

</font>This line might cause difficulty <font color="#FF0000"><b>to </b></font>you at first but they are quite easy <font color="#FF0000"><b>to </b></font>understand<font color="#000080">. 

</font>	mov ah<font color="#000080">,</font>ds<font color="#000080">:[</font>si<font color="#000080">]</font> 	<font color="#000080">;</font>put the char at ds<font color="#000080">[</font>si<font color="#000080">] </font>into ah

What this does <font color="#FF0000"><b>is to </b></font>move the number stored <font color="#FF0000"><b>in </b></font>DS at the location stored <font color="#FF0000"><b>in </b></font>SI into 
AH<font color="#000080">. </font>It <font color="#FF0000"><b>is </b></font>easier <font color="#FF0000"><b>to </b></font>think <font color="#FF0000"><b>of </b></font>DS being like an <font color="#FF0000"><b>array in </b></font>this command<font color="#000080">. </font>It <font color="#FF0000"><b>is </b></font>the same <font color="#FF0000"><b>as 
</b></font>this line <font color="#FF0000"><b>in </b></font>C<font color="#000080">.

</font>	ah <font color="#000080">= </font>ds<font color="#000080">[</font>si<font color="#000080">]; 

</font>Shifts<font color="#000080">:

</font>There are four different ways <font color="#FF0000"><b>of </b></font>shifting numbers either left <font color="#FF0000"><b>or </b></font>right one binary 
position<font color="#000080">. 

</font><font color="#FF0000"><b>SHL </b></font>Unsigned multiple by two
<font color="#FF0000"><b>SHR </b></font>Unsigned devide by two
SAR Signed devide by two
SAL same <font color="#FF0000"><b>as SHL

</b></font>The syntax <font color="#FF0000"><b>for </b></font>all four <font color="#FF0000"><b>is </b></font>the same<font color="#000080">.

</font>Syntax<font color="#000080">:
</font><font color="#FF0000"><b>SHL </b></font>operand1<font color="#000080">,</font>operand2

Note<font color="#000080">: </font>The <font color="#800000">8086 </font>cannot have the value <font color="#FF0000"><b>of </b></font>opperand2 other than <font color="#800000">1. 286</font><font color="#000080">/</font><font color="#800000">386 </font>cannot 
have operand2 higher than <font color="#800000">31.

</font>Using shifts <font color="#FF0000"><b>is </b></font>a lot faster than using MUL<font color="#000080">’</font>s <font color="#FF0000"><b>and DIV</b></font><font color="#000080">’</font>s<font color="#000080">.



</font>Loops<font color="#000080">:

</font>Using Loop <font color="#FF0000"><b>is </b></font>a better way <font color="#FF0000"><b>of </b></font>making a loop <font color="#FF0000"><b>then </b></font>using JMP<font color="#000080">’</font>s<font color="#000080">. </font>You place the amount 
<font color="#FF0000"><b>of </b></font>times you want it <font color="#FF0000"><b>to </b></font>loop <font color="#FF0000"><b>in </b></font>the CX <font color="#FF0000"><b>register and </b></font>every time it reackes the loop 
statement it decrements CX <font color="#000080">(</font>CX<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and then </b></font>does a short jump <font color="#FF0000"><b>to </b></font>the <font color="#FF0000"><b>label </b></font>indicated<font color="#000080">. 
</font>A short jum means that it can only <font color="#800000">128 </font>bytes before <font color="#FF0000"><b>or </b></font><font color="#800000">127 </font>bytes after the LOOP 
instuction<font color="#000080">.

</font>Syntax<font color="#000080">:
</font>Loop <font color="#FF0000"><b>Label

</b></font>Using graphics <font color="#FF0000"><b>in </b></font>mode <font color="#800000">13</font>h<font color="#000080">:

</font>Mode <font color="#800000">13</font>h <font color="#FF0000"><b>is </b></font>only availible <font color="#FF0000"><b>on </b></font>VGA<font color="#000080">, </font>MCGA cards <font color="#FF0000"><b>and </b></font>above<font color="#000080">. </font>The reason that I am 
talking about this card <font color="#FF0000"><b>is </b></font>that it <font color="#FF0000"><b>is </b></font>very easy <font color="#FF0000"><b>to </b></font>use <font color="#FF0000"><b>for </b></font>graphics because <font color="#FF0000"><b>of </b></font>how the 
memory <font color="#FF0000"><b>is </b></font>arranged<font color="#000080">.

</font>First check that mode <font color="#800000">13</font>h <font color="#FF0000"><b>is </b></font>possible<font color="#000080">:

</font>It would be polite <font color="#FF0000"><b>to </b></font>tell the user <font color="#FF0000"><b>if </b></font>his computer cannot support mode <font color="#800000">13</font>h instead <font color="#FF0000"><b>of 
</b></font>just crashing his computer without warning<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>how it <font color="#FF0000"><b>is </b></font>done<font color="#000080">.

</font>CheckMode13h<font color="#000080">: 
;</font>Returns<font color="#000080">: </font>DX<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>Not </b></font>supported<font color="#000080">, </font>DX<font color="#000080">=</font><font color="#800000">1 </font>supported
	mov ax<font color="#000080">,</font><font color="#800000">1</font>A00h      	<font color="#000080">;</font>Request video info <font color="#FF0000"><b>for </b></font>VGA
	int <font color="#800000">10</font>h        	<font color="#000080">;</font>Get Display Combination Code
	cmp al<font color="#000080">,</font><font color="#800000">1</font>Ah    		<font color="#000080">;</font><font color="#FF0000"><b>Is </b></font>VGA <font color="#FF0000"><b>or </b></font>MCGA present<font color="#000080">?
</font>	je Mode13hSupported <font color="#000080">;</font>mode <font color="#800000">13</font>h <font color="#FF0000"><b>is </b></font>supported
	<font color="#FF0000"><b>xor </b></font>dx<font color="#000080">,</font>dx			<font color="#000080">;</font>mode <font color="#800000">13</font>h isn<font color="#000080">’</font>t supported dx<font color="#000080">=</font><font color="#800000">0
</font>Mode13hSupported<font color="#000080">:</font>	
	mov dx<font color="#000080">,</font><font color="#800000">1</font>			<font color="#000080">;</font>return mode13h supported 

Just use this <font color="#FF0000"><b>to </b></font>check <font color="#FF0000"><b>if </b></font>mode <font color="#800000">13</font>h <font color="#FF0000"><b>is </b></font>supported at the beginning <font color="#FF0000"><b>of </b></font>your <font color="#FF0000"><b>program to 
</b></font>make sure that you can go into that mode<font color="#000080">.

</font>Note<font color="#000080">: </font>I have <font color="#FF0000"><b>not </b></font>tested this <font color="#FF0000"><b>on </b></font>a computer that doesn<font color="#000080">’</font>t hav VGA <font color="#FF0000"><b>as </b></font>I don<font color="#000080">’</font>t have any<font color="#000080">. 
</font><font color="#FF0000"><b>In </b></font>theory this should work but you should test this <font color="#FF0000"><b>on </b></font>computers that don<font color="#000080">’</font>t have VGA 
<font color="#FF0000"><b>and </b></font>see <font color="#FF0000"><b>if </b></font>it works this <font color="#FF0000"><b>out</b></font><font color="#000080">.



</font>Setting the Video Mode<font color="#000080">:

</font>It <font color="#FF0000"><b>is </b></font>very simple <font color="#FF0000"><b>to set </b></font>the mode<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>how it <font color="#FF0000"><b>is </b></font>done<font color="#000080">.

</font> 	mov  ax<font color="#000080">,</font><font color="#800000">13</font>h		<font color="#000080">;</font><font color="#FF0000"><b>set </b></font>mode <font color="#800000">13</font>h
 	int  <font color="#800000">10</font>h			<font color="#000080">;</font>call bios service

Once we are <font color="#FF0000"><b>in </b></font>mode <font color="#800000">13</font>h <font color="#FF0000"><b>and </b></font>have finished what we are doing we need <font color="#FF0000"><b>to </b></font>we need <font color="#FF0000"><b>to 
set </b></font>it <font color="#FF0000"><b>to </b></font>the video mode that it was <font color="#FF0000"><b>in </b></font>previously<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>done <font color="#FF0000"><b>in </b></font>two stages<font color="#000080">. </font>Firstly we 
need <font color="#FF0000"><b>to </b></font>save the video mode <font color="#FF0000"><b>and then </b></font>reset it <font color="#FF0000"><b>to </b></font>that mode<font color="#000080">.

</font>VideoMode db <font color="#000080">?
....
</font>	mov ah<font color="#000080">,</font><font color="#800000">0</font>Fh		<font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">0</font>Fh <font color="#000080">- </font>get current mode
	int <font color="#800000">10</font>h			<font color="#000080">;</font>Bios video service call
	mov VideoMode<font color="#000080">,</font>al	<font color="#000080">;</font>save current mode

	<font color="#000080">;</font><font color="#FF0000"><b>program </b></font>code here

	mov al<font color="#000080">,</font>VideoMode	<font color="#000080">;</font><font color="#FF0000"><b>set </b></font>previous video mode
	<font color="#FF0000"><b>xor </b></font>ah<font color="#000080">,</font>ah			<font color="#000080">;</font>clear ah <font color="#000080">- </font><font color="#FF0000"><b>set </b></font>mode
	int <font color="#800000">10</font>h			<font color="#000080">;</font>call bios service
	mov ax<font color="#000080">,</font><font color="#800000">4</font>C00h		<font color="#000080">;</font>exit <font color="#FF0000"><b>to </b></font>dos
	int <font color="#800000">21</font>h			<font color="#000080">;</font>call dos <font color="#FF0000"><b>function

</b></font>Now that we can get into mode <font color="#800000">13</font>h lets <font color="#FF0000"><b>do </b></font>something<font color="#000080">. </font>Firstly lets put some pixels <font color="#FF0000"><b>on 
</b></font>the screen<font color="#000080">. 

</font><font color="#FF0000"><b>Function </b></font><font color="#800000">0</font>Ch <font color="#000080">- </font>Write Graphics Pixel

Makes a color dot <font color="#FF0000"><b>on </b></font>the screen at the specified graphics coordinates<font color="#000080">.

</font>INPUT<font color="#000080">:
</font>	AH <font color="#000080">= </font><font color="#800000">0</font>Ch
	AL <font color="#000080">= </font>Color <font color="#FF0000"><b>of </b></font>the dot
	CX <font color="#000080">= </font>Screen column <font color="#000080">(</font>x coordinate<font color="#000080">)
</font>	DX <font color="#000080">= </font>Screen row <font color="#000080">(</font>y coordinate<font color="#000080">)

</font>OUTPUT<font color="#000080">:
</font>	Nothing <font color="#FF0000"><b>except </b></font>pixel <font color="#FF0000"><b>on </b></font>screen<font color="#000080">.

</font>Note<font color="#000080">: </font>This <font color="#FF0000"><b>function </b></font>performes exclusive <font color="#FF0000"><b>OR </b></font><font color="#000080">(</font><font color="#FF0000"><b>XOR</b></font><font color="#000080">) </font><font color="#FF0000"><b>with </b></font>the new color value <font color="#FF0000"><b>and </b></font>the 
current context <font color="#FF0000"><b>of </b></font>the pixel <font color="#FF0000"><b>of </b></font>bit <font color="#800000">7 </font><font color="#FF0000"><b>of </b></font>AL <font color="#FF0000"><b>is set</b></font><font color="#000080">.

</font>	mov ah<font color="#000080">,</font><font color="#800000">0</font>Ch	<font color="#000080">;</font><font color="#FF0000"><b>function </b></font><font color="#800000">0</font>Ch
	mov al<font color="#000080">,</font><font color="#800000">7</font>		<font color="#000080">;</font>color <font color="#800000">7
</font>	mov cx<font color="#000080">,</font><font color="#800000">160</font>	<font color="#000080">;</font>x position <font color="#000080">-</font><font color="#800000">160
</font>	mov dx<font color="#000080">,</font><font color="#800000">100</font>	<font color="#000080">;</font>y position <font color="#000080">-</font><font color="#800000">100
</font>	int <font color="#800000">10</font>h		<font color="#000080">;</font>call bios service


This example puts a pixel into the middle <font color="#FF0000"><b>of </b></font>the screen <font color="#FF0000"><b>in </b></font>a the color grey<font color="#000080">. </font>The 
problem <font color="#FF0000"><b>with </b></font>this method <font color="#FF0000"><b>is </b></font>that calling interrupts <font color="#FF0000"><b>is </b></font>really slow <font color="#FF0000"><b>and </b></font>should be avoided 
<font color="#FF0000"><b>in </b></font>speed critical areas<font color="#000080">. </font><font color="#FF0000"><b>With </b></font>pixel plotting <font color="#FF0000"><b>if </b></font>you wanted <font color="#FF0000"><b>to </b></font>display a picture the size <font color="#FF0000"><b>of 
</b></font>the screen you would have <font color="#FF0000"><b>to </b></font>call this <font color="#FF0000"><b>procedure </b></font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">000 </font>times <font color="#000080">(</font><font color="#800000">320 </font>x <font color="#800000">200</font><font color="#000080">). 

</font>Some optimizations<font color="#000080">:

</font>This method isn<font color="#000080">’</font>t too fast <font color="#FF0000"><b>and </b></font>we could make it a lot faster<font color="#000080">. </font>How<font color="#000080">? </font>By writing direct <font color="#FF0000"><b>to 
</b></font>video memory<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>done quite easily<font color="#000080">. 

</font>The VGA memory starts at <font color="#800000">0</font>A000h<font color="#000080">. </font><font color="#FF0000"><b>To </b></font>work <font color="#FF0000"><b>out </b></font>where each pixel goes you use this 
simple formula<font color="#000080">:

</font>	Location <font color="#000080">= </font><font color="#800000">0</font>A000h <font color="#000080">+ </font>Xposition <font color="#000080">+ (</font>Yposition x <font color="#800000">320</font><font color="#000080">)

</font>Location <font color="#FF0000"><b>is </b></font>the memory location which we want <font color="#FF0000"><b>to </b></font>put the pixel<font color="#000080">.

</font>This <font color="#FF0000"><b>procedure is </b></font>quite a fast way <font color="#FF0000"><b>to </b></font>put a pixel onto the screen<font color="#000080">. </font>Thanks go <font color="#FF0000"><b>to </b></font>Denthor 
<font color="#FF0000"><b>of </b></font>Asphyxia <font color="#FF0000"><b>as </b></font>I based this <font color="#FF0000"><b>on </b></font>his code<font color="#000080">. 

</font>PutPixel PROC
<font color="#000080">.</font><font color="#800000">286</font>		<font color="#000080">;</font>enable <font color="#800000">286 </font>instructions <font color="#FF0000"><b>for </b></font>shifts remove <font color="#FF0000"><b>if 
</b></font>		<font color="#000080">;</font>you have less than an <font color="#800000">286.</font>	
<font color="#000080">;========================================================
;</font>INPUT<font color="#000080">:</font> 	BX<font color="#000080">=</font>X postion
<font color="#000080">;</font>		DX<font color="#000080">=</font>Y position
<font color="#000080">;</font>		CL<font color="#000080">=</font>colour
<font color="#000080">;</font>OUTPUT<font color="#000080">:  </font>None
<font color="#000080">;========================================================
;</font>this can be optimized by <font color="#FF0000"><b>not </b></font>pushing ax <font color="#FF0000"><b>if </b></font>you don<font color="#000080">’</font>t 
<font color="#000080">;</font>need <font color="#FF0000"><b>to </b></font>save it<font color="#000080">. </font><font color="#FF0000"><b>For </b></font>A86 change push ds es ax <font color="#FF0000"><b>to </b></font>push 
<font color="#000080">;</font>ds<font color="#000080">,</font>es<font color="#000080">,</font>ax <font color="#FF0000"><b>and do </b></font>the same thing <font color="#FF0000"><b>with </b></font>pop<font color="#000080">.
</font>	push ds es ax		<font color="#000080">;</font>save ds<font color="#000080">,</font>es <font color="#FF0000"><b>and </b></font>ax 
	mov ax<font color="#000080">,</font><font color="#800000">0</font>A000h		<font color="#000080">;</font>ax <font color="#FF0000"><b>contains </b></font>address <font color="#FF0000"><b>of </b></font>video
	mov es<font color="#000080">,</font>ax			<font color="#000080">;</font>es <font color="#FF0000"><b>contains </b></font>address <font color="#FF0000"><b>of </b></font>video
	mov di<font color="#000080">,</font>bx			<font color="#000080">;</font>move x position into di
	mov bx<font color="#000080">,</font>dx			<font color="#000080">;</font>mov y postion into bx
	<font color="#FF0000"><b>shl </b></font>dx<font color="#000080">,</font><font color="#800000">8</font>			<font color="#000080">;</font>shift dx <font color="#800000">8 </font>places <font color="#FF0000"><b>to </b></font>the left
	<font color="#FF0000"><b>shl </b></font>bx<font color="#000080">,</font><font color="#800000">6</font>			<font color="#000080">;</font>shift bx <font color="#800000">6 </font>places <font color="#FF0000"><b>to </b></font>the left
	add dx<font color="#000080">,</font>bx			<font color="#000080">;</font>add dx <font color="#FF0000"><b>and </b></font>bx together
	add di<font color="#000080">,</font>bx			<font color="#000080">;</font>add di <font color="#FF0000"><b>and </b></font>bx together
	mov al<font color="#000080">,</font>cl			<font color="#000080">;</font>put colour <font color="#FF0000"><b>in </b></font>al
	stosb			<font color="#000080">;</font>transfer <font color="#FF0000"><b>to </b></font>video memory
	pop ax es ds		<font color="#000080">;</font>restore ds<font color="#000080">,</font>es <font color="#FF0000"><b>and </b></font>ax
	ret
PutPixel ENDP	

Thank you <font color="#FF0000"><b>for </b></font>reading<font color="#000080">. </font>I hope that you have learnt something from this<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you 
need any more help <font color="#FF0000"><b>then </b></font>email me<font color="#000080">.

</font>Gavin Estey <font color="#800000">19</font><font color="#000080">/</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">95



</font>Gavin<font color="#000080">’</font>s Introduction <font color="#FF0000"><b>to </b></font>Assembly		Page <font color="#800000">1


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TUTOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0028.PAS">Original</a><b>]</b></p></body>
</html>
