<html>
<head><title> "Drive Info" by DESCLIN JEAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 A few days ago, Bryan Ellis (gt6918b@prism.gatech.edu) mentioned
 that he had trouble with the DiskFree function of TP.
 I did'nt see any answer on this subject posted to the list.
 Since I also feel that this function yields misleading
 results to the unaware, and available clusters on the disk
 are also a requisite for full information, I post below a
 small program to document another way to implement the
 Diskfree function.

That part of the following code referring to the identification
of ramdisks has already been posted on info-pascal@brl.mil; I have
added the procedure DiskEval to display info about the drive, because
I have found that many users are not aware of the notion of 'slack'
which is the consequence of the use of clusters.
}

{$N+,E+}

</i></font><font color="#FF0000"><b>program </b></font>diskall<font color="#000080">;

</font><font color="#008000"><i>{
displays all drives (except network drives :-() actually in use by
the system, mentions when one is mapped to another one (such as B: to
A: in systems with only one floppy drive), tries to identify RAM
disks but fails to do so with 'Stacked' disks and possibly also with
'Doublespaced' drives: I refrained from trying the latter on _MY_
stacked HD! The program further shows the available space on the disk
chosen by the user among available drives.
From what I have gathered in books and on the net, there is no fail-
safe way of identifying RAM disks. If somebody among the readers of
this should know otherwise, I would be grateful if he could email me
the solution at:
 desclinj@ulb.ac.be  (internet; Dr Jean Desclin)
                     (Lab. of Histology, Fac. of Medicine)
                     (Brussels Free University (U.L.B.) Belgium)
}
</i></font><font color="#FF0000"><b>uses </b></font>Dos<font color="#000080">,</font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>String25 <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">25</font><font color="#000080">];

</font><font color="#FF0000"><b>var
    </b></font>ver               <font color="#000080">: </font>byte<font color="#000080">;
    </font>DrvStr            <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>DrvLet            <font color="#000080">: </font>char<font color="#000080">;
    </font>Count             <font color="#000080">: </font>shortint<font color="#000080">;
    </font>car               <font color="#000080">: </font>char<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Pinsert<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>chain<font color="#000080">: </font>string25<font color="#000080">);
</font><font color="#008000"><i>{Eases reading long numbers by inserting decimal points(commas)}
</i></font><font color="#FF0000"><b>Const </b></font>pdec <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">','</font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>nv     <font color="#000080">:    </font>string25<font color="#000080">;
    </font>loc    <font color="#000080">:    </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>nv <font color="#000080">:= </font>chain<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>chain<font color="#000080">) &gt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then
    begin
       </b></font>loc <font color="#000080">:= </font>length<font color="#000080">(</font>chain<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">;
       </font>Move<font color="#000080">(</font>Nv<font color="#000080">[</font>loc<font color="#000080">],</font>Nv<font color="#000080">[</font>succ<font color="#000080">(</font>loc<font color="#000080">)],</font>succ<font color="#000080">(</font>Length<font color="#000080">(</font>Nv<font color="#000080">))-</font>loc<font color="#000080">);
       </font>Move<font color="#000080">(</font>Pdec<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Nv<font color="#000080">[</font>loc<font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);
       </font>inc<font color="#000080">(</font>Nv<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
       </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>pos<font color="#000080">(</font>pdec<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Nv<font color="#000080">) &gt; </font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>do
           begin
              </b></font>chain <font color="#000080">:= </font>Nv<font color="#000080">;
              </font>loc <font color="#000080">:= </font>pos<font color="#000080">(</font>pdec<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Nv<font color="#000080">) - </font><font color="#800000">3</font><font color="#000080">;
              </font>Move<font color="#000080">(</font>Nv<font color="#000080">[</font>loc<font color="#000080">],</font>Nv<font color="#000080">[</font>succ<font color="#000080">(</font>loc<font color="#000080">)],</font>succ<font color="#000080">(</font>length<font color="#000080">(</font>Nv<font color="#000080">)) - </font>loc<font color="#000080">);
              </font>Move<font color="#000080">(</font>pdec<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Nv<font color="#000080">[</font>loc<font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);
              </font>inc<font color="#000080">(</font>Nv<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>chain <font color="#000080">:= </font>nv
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GetDrives1<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>DS<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);</font><font color="#008000"><i>{for DOS &gt;= 3.x but &lt;4.0       }
{Adapted from Michael Tischer's Turbo Pascal 6 System Programming,  }
{Abacus 1991, ISBN 1-55755-124-3                                    }
</i></font><font color="#FF0000"><b>type </b></font>DPBPTR    <font color="#000080">= ^</font>DPB<font color="#000080">;           </font><font color="#008000"><i>{ pointer to a DOS Parameter Block }
     </i></font>DPBPTRPTR <font color="#000080">= ^</font>DPBPTR<font color="#000080">;           </font><font color="#008000"><i>{ pointer to a pointer to a DPB }
     </i></font>DPB       <font color="#000080">= </font><font color="#FF0000"><b>record       </b></font><font color="#008000"><i>{ recreation of a DOS Parameter Block }
                    </i></font>Code  <font color="#000080">: </font>byte<font color="#000080">;       </font><font color="#008000"><i>{ drive code (0=A, 1=B etc. }
                    </i></font>dummy1<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">$07</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;</font><font color="#008000"><i>{irrelevant bytes}
                    </i></font>FatNb <font color="#000080">: </font>byte<font color="#000080">; </font><font color="#008000"><i>{Number of File Allocation Tables }
                    </i></font>dummy2<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">..</font><font color="#800000">$17</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;</font><font color="#008000"><i>{irrelevant bytes}
                    </i></font>Next  <font color="#000080">: </font>DPBPTR<font color="#000080">;           </font><font color="#008000"><i>{ pointer to next DPB }
                 </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                    </font><font color="#008000"><i>{ xxxx:FFFF marks last DPB }

</i></font><font color="#FF0000"><b>var </b></font>Regs    <font color="#000080">: </font>Registers<font color="#000080">;              </font><font color="#008000"><i>{ register for interrupt call }
    </i></font>CurrDpbP <font color="#000080">: </font>DPBPTR<font color="#000080">;                  </font><font color="#008000"><i>{ pointer to DPBs in memory }

</i></font><font color="#FF0000"><b>begin
   </b></font><font color="#008000"><i>{-- get pointer to first DPB ------------------------------------}

  </i></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$52</font><font color="#000080">;</font><font color="#008000"><i>{ function $52 returns ptr to 'List of Lists'      }
  </i></font>MsDos<font color="#000080">( </font>Regs <font color="#000080">);</font><font color="#008000"><i>{ that's an UNDOCUMENTED DOS function !             }
  </i></font>CurrDpbP <font color="#000080">:= </font>DPBPTRPTR<font color="#000080">( </font>ptr<font color="#000080">( </font>Regs<font color="#000080">.</font>ES<font color="#000080">, </font>Regs<font color="#000080">.</font>BX <font color="#000080">) )^;
  </font><font color="#008000"><i>{-- follow the chain of DPBs--------------------------------------}
  </i></font><font color="#FF0000"><b>repeat
    begin
     </b></font>write<font color="#000080">(</font>chr<font color="#000080">(</font>ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)+</font>CurrDpbP<font color="#000080">^.</font>Code <font color="#000080">),</font><font color="#008000"><i>{ display device code  }
              </i></font><font color="#800000">': ' </font><font color="#000080">);
     </font>DS <font color="#000080">:= </font>DS <font color="#000080">+ </font>chr<font color="#000080">(</font>ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)+</font>CurrDpbP<font color="#000080">^.</font>Code<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>CurrDpbP<font color="#000080">^.</font>Code <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
       begin
         </b></font>Regs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$440E</font><font color="#000080">;
         </font>Regs<font color="#000080">.</font>BL <font color="#000080">:= </font>CurrDpbP<font color="#000080">^.</font>Code<font color="#000080">;
         </font>MsDos<font color="#000080">(</font>Regs<font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font>Regs<font color="#000080">.</font>AL <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
           </b></font>writeln<font color="#000080">(</font><font color="#800000">' is actually mapped to '</font><font color="#000080">,
                    </font>chr<font color="#000080">(</font>ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)+</font>pred<font color="#000080">(</font>CurrDpbP<font color="#000080">^.</font>Code<font color="#000080">)))
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>CurrDpbP<font color="#000080">^.</font>FatNb <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>CurrDpbP<font color="#000080">^.</font>FatNb <font color="#000080">&lt; </font><font color="#800000">2</font><font color="#000080">)) </font><font color="#FF0000"><b>then
        </b></font>writeln<font color="#000080">(</font><font color="#800000">' (RAMDISK)'</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>CurrDpbP <font color="#000080">:= </font>CurrDpbP<font color="#000080">^.</font>Next<font color="#000080">;   </font><font color="#008000"><i>{ set pointer to next DPB        }
  </i></font><font color="#FF0000"><b>until </b></font><font color="#000080">( </font>Ofs<font color="#000080">( </font>CurrDpbP<font color="#000080">^ ) = </font><font color="#800000">$FFFF </font><font color="#000080">);  </font><font color="#008000"><i>{ until last DPB is reached }
 </i></font>writeln
 <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GetDrives2<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>DS<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);</font><font color="#008000"><i>{for DOS versions&gt;=4.0         }
{almost the same as GetDrives1, but for dummy2 which is one byte    }
{longer in DOS 4+                                                   }
</i></font><font color="#FF0000"><b>type </b></font>DPBPTR    <font color="#000080">= ^</font>DPB<font color="#000080">;           </font><font color="#008000"><i>{ pointer to a DOS Parameter Block }
     </i></font>DPBPTRPTR <font color="#000080">= ^</font>DPBPTR<font color="#000080">;           </font><font color="#008000"><i>{ pointer to a pointer to a DPB }
     </i></font>DPB       <font color="#000080">= </font><font color="#FF0000"><b>record       </b></font><font color="#008000"><i>{ recreation of a DOS Parameter Block }
                  </i></font>Code   <font color="#000080">: </font>byte<font color="#000080">;      </font><font color="#008000"><i>{ drive code ( 0=A, 1=B etc.  }
                  </i></font>dummy1 <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">$07</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;</font><font color="#008000"><i>{ irrelevant bytes}
                  </i></font>FatNb  <font color="#000080">: </font>byte<font color="#000080">;</font><font color="#008000"><i>{ Number of File Allocation Tables  }
                  </i></font>dummy2 <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">..</font><font color="#800000">$18</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;</font><font color="#008000"><i>{ irrelevant bytes}
                  </i></font>Next   <font color="#000080">: </font>DPBPTR<font color="#000080">;          </font><font color="#008000"><i>{ pointer to next DPB   }
                 </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                    </font><font color="#008000"><i>{ xxxx:FFFF marks last DPB }

</i></font><font color="#FF0000"><b>var </b></font>Regs    <font color="#000080">: </font>Registers<font color="#000080">;              </font><font color="#008000"><i>{ register for interrupt call }
    </i></font>CurrDpbP <font color="#000080">: </font>DPBPTR<font color="#000080">;                  </font><font color="#008000"><i>{ pointer to DPBs in memory }

</i></font><font color="#FF0000"><b>begin
   </b></font><font color="#008000"><i>{-- get pointer to first DPB-------------------------------------}

  </i></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$52</font><font color="#000080">;</font><font color="#008000"><i>{ function $52 returns ptr to Dos 'List of lists'  }
   </i></font>MsDos<font color="#000080">( </font>Regs <font color="#000080">);</font><font color="#008000"><i>{ that's an UNDOCUMENTED DOS function !            }
 </i></font>CurrDpbP <font color="#000080">:= </font>DPBPTRPTR<font color="#000080">( </font>ptr<font color="#000080">( </font>Regs<font color="#000080">.</font>ES<font color="#000080">, </font>Regs<font color="#000080">.</font>BX <font color="#000080">) )^;

  </font><font color="#008000"><i>{-- follow the chain of DPBs -------------------------------------}

  </i></font><font color="#FF0000"><b>repeat
    begin
     </b></font>write<font color="#000080">( </font>chr<font color="#000080">( </font>ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">) + </font>CurrDpbP<font color="#000080">^.</font>Code <font color="#000080">),</font><font color="#008000"><i>{ display device code  }
              </i></font><font color="#800000">': '</font><font color="#000080">);
     </font>DS <font color="#000080">:= </font>DS <font color="#000080">+ </font>chr<font color="#000080">(</font>ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)+</font>CurrDpbP<font color="#000080">^.</font>Code<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>CurrDpbP<font color="#000080">^.</font>Code <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
       begin
         </b></font>Regs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$440E</font><font color="#000080">;
         </font>Regs<font color="#000080">.</font>BL <font color="#000080">:= </font>CurrDpbP<font color="#000080">^.</font>Code<font color="#000080">;
         </font>MsDos<font color="#000080">(</font>Regs<font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font>Regs<font color="#000080">.</font>AL <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
           </b></font>writeln<font color="#000080">(</font><font color="#800000">' is actually mapped to '</font><font color="#000080">,
                    </font>chr<font color="#000080">(</font>ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)+</font>pred<font color="#000080">(</font>CurrDpbP<font color="#000080">^.</font>Code<font color="#000080">)))
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>CurrDpbP<font color="#000080">^.</font>FatNb <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>CurrDpbP<font color="#000080">^.</font>FatNb <font color="#000080">&lt; </font><font color="#800000">2</font><font color="#000080">)) </font><font color="#FF0000"><b>then
        </b></font>writeln<font color="#000080">(</font><font color="#800000">' (RAMDISK)'</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>CurrDpbP <font color="#000080">:= </font>CurrDpbP<font color="#000080">^.</font>Next<font color="#000080">;   </font><font color="#008000"><i>{ set pointer to next DPB        }
   </i></font><font color="#FF0000"><b>until </b></font><font color="#000080">( </font>Ofs<font color="#000080">( </font>CurrDpbP<font color="#000080">^ ) = </font><font color="#800000">$FFFF </font><font color="#000080">);  </font><font color="#008000"><i>{ until last DPB is reached }
   </i></font>writeln
 <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DiskEval<font color="#000080">;
</font><font color="#008000"><i>{computes statistics of disk chosen by user}

</i></font><font color="#FF0000"><b>var </b></font>Reg <font color="#000080">: </font>registers<font color="#000080">;
    </font>Drive             <font color="#000080">: </font>char<font color="#000080">;
    </font>column<font color="#000080">,</font>row        <font color="#000080">: </font>shortint<font color="#000080">;
    </font>SectorsPerCluster <font color="#000080">: </font>Word<font color="#000080">;
    </font>AvailClusters     <font color="#000080">: </font>Word<font color="#000080">;
    </font>BytesPerSector    <font color="#000080">: </font>Word<font color="#000080">;
    </font>TotalClusters     <font color="#000080">: </font>Word<font color="#000080">;
    </font>BytesAvail<font color="#000080">,</font>Clut   <font color="#000080">: </font>longint<font color="#000080">;
    </font>Kilos             <font color="#000080">: </font>extended<font color="#000080">;
    </font>ByAl              <font color="#000080">: </font>string25<font color="#000080">;
    </font>TotClut           <font color="#000080">: </font>string25<font color="#000080">;
    </font>OneClut           <font color="#000080">: </font>string25<font color="#000080">;
    </font>AvailClut         <font color="#000080">: </font>string25<font color="#000080">;
</font><font color="#FF0000"><b>begin
    </b></font>write<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
    </font>column  <font color="#000080">:= </font>whereX<font color="#000080">;
    </font>row     <font color="#000080">:= </font>whereY<font color="#000080">;
    </font><font color="#FF0000"><b>repeat
       </b></font>gotoXY<font color="#000080">(</font>column<font color="#000080">,</font>row<font color="#000080">);
       </font>write<font color="#000080">(</font><font color="#800000">'Which drive to read from? '</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">));
       </font>read<font color="#000080">(</font>Drive<font color="#000080">);
       </font>Drive <font color="#000080">:= </font>UpCase<font color="#000080">(</font>Drive<font color="#000080">);
    </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>pos<font color="#000080">(</font>Drive<font color="#000080">,</font>DrvStr<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">);
    </font>writeln<font color="#000080">;
    </font><font color="#FF0000"><b>with </b></font>Reg <font color="#FF0000"><b>do begin
         </b></font>DL <font color="#000080">:= </font>ord<font color="#000080">(</font>Drive<font color="#000080">) - </font><font color="#800000">64</font><font color="#000080">;
         </font>AH <font color="#000080">:= </font><font color="#800000">$36</font><font color="#000080">;
         </font>Intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>Reg<font color="#000080">);
         </font>SectorsPerCluster  <font color="#000080">:= </font>AX<font color="#000080">;
         </font>AvailClusters      <font color="#000080">:= </font>BX<font color="#000080">;
         </font>BytesPerSector     <font color="#000080">:= </font>CX<font color="#000080">;
         </font>TotalClusters      <font color="#000080">:= </font>DX
    <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>BytesAvail <font color="#000080">:= </font>longint<font color="#000080">(</font>BytesPerSector<font color="#000080">) * </font>longint<font color="#000080">(</font>SectorsPerCluster<font color="#000080">)
                  * </font>longint<font color="#000080">(</font>AvailClusters<font color="#000080">);
    </font>Kilos <font color="#000080">:= </font>BytesAvail<font color="#000080">/</font><font color="#800000">1024</font><font color="#000080">;
    </font>clut <font color="#000080">:= </font>longint<font color="#000080">(</font>SectorsPerCluster<font color="#000080">)*</font>longint<font color="#000080">(</font>BytesPerSector<font color="#000080">);
    </font>Str<font color="#000080">(</font>BytesAvail<font color="#000080">,</font>Byal<font color="#000080">);
    </font>Pinsert<font color="#000080">(</font>Byal<font color="#000080">);
    </font>Str<font color="#000080">(</font>AvailClusters<font color="#000080">,</font>AvailClut<font color="#000080">);
    </font>Pinsert<font color="#000080">(</font>AvailClut<font color="#000080">);
    </font>Str<font color="#000080">(</font>Clut<font color="#000080">,</font>OneClut<font color="#000080">);
    </font>Pinsert<font color="#000080">(</font>OneClut<font color="#000080">);
    </font>Str<font color="#000080">(</font>TotalClusters<font color="#000080">,</font>TotClut<font color="#000080">);
    </font>Pinsert<font color="#000080">(</font>Totclut<font color="#000080">);
    </font>clrscr<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>SectorsPerCluster <font color="#000080">&lt;&gt; </font><font color="#800000">65535 </font><font color="#FF0000"><b>then
      begin
        </b></font>write<font color="#000080">(</font><font color="#800000">'For drive '</font><font color="#000080">);
        </font>HighVideo<font color="#000080">;
        </font>write<font color="#000080">(</font>Drive<font color="#000080">);
        </font>LowVideo<font color="#000080">;
        </font>writeln<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">);
        </font>writeln<font color="#000080">(</font><font color="#800000">'Sectors per cluster: '</font><font color="#000080">,</font>SectorsPerCluster<font color="#000080">);
        </font>writeln<font color="#000080">(</font><font color="#800000">'Bytes per sector: '</font><font color="#000080">,</font>BytesPerSector<font color="#000080">);
        </font>writeln<font color="#000080">(</font><font color="#800000">'Total clusters: '</font><font color="#000080">,</font>TotClut<font color="#000080">);
        </font>writeln<font color="#000080">(</font><font color="#800000">'Available clusters: '</font><font color="#000080">,</font>AvailClut<font color="#000080">);
        </font>write<font color="#000080">(</font><font color="#800000">'(One cluster = '</font><font color="#000080">,</font>oneclut<font color="#000080">,</font><font color="#800000">' bytes: the smallest'</font><font color="#000080">);
        </font>writeln<font color="#000080">(</font><font color="#800000">' allocatable space!)'</font><font color="#000080">);
        </font>write<font color="#000080">(</font><font color="#800000">'A TOTAL of '</font><font color="#000080">,</font>ByAl<font color="#000080">,</font><font color="#800000">' BYTES are AVAILABLE ('</font><font color="#000080">,</font>Kilos<font color="#000080">:</font><font color="#800000">6</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">);
        </font>writeln<font color="#000080">(</font><font color="#800000">' K)'</font><font color="#000080">) </font><font color="#008000"><i>{previous line split for display: length &lt;73 }
      </i></font><font color="#FF0000"><b>end
    else </b></font>writeln<font color="#000080">(</font><font color="#800000">'There is no diskette in drive '</font><font color="#000080">,</font>Drive<font color="#000080">,</font><font color="#800000">': !'</font><font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>car <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
   </font><font color="#FF0000"><b>repeat
      </b></font>DrvStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font>DrvLet <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
      </font>clrscr<font color="#000080">;
      </font>ver <font color="#000080">:= </font>Lo<font color="#000080">(</font>DosVersion<font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Installed logical drives are : '#13#10</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>ver <font color="#000080">&lt; </font><font color="#800000">4 </font><font color="#FF0000"><b>then
        </b></font>GetDrives1<font color="#000080">(</font>DrvStr<font color="#000080">)
      </font><font color="#FF0000"><b>else
        </b></font>GetDrives2<font color="#000080">(</font>DrvStr<font color="#000080">);
      </font>DiskEval<font color="#000080">;
      </font>writeln<font color="#000080">;
      </font>write<font color="#000080">(</font><font color="#800000">'type ''Y'' to continue, any other key to exit.'</font><font color="#000080">);
      </font>car <font color="#000080">:= </font>upcase<font color="#000080">(</font>readkey<font color="#000080">);
   </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>car <font color="#000080">&lt;&gt; </font><font color="#800000">'Y'</font><font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p></body>
</html>
