<html>
<head><title> "Excellent Disk Drive Unit" by WILLIAM FLORAC</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0114.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>Drives<font color="#000080">;
</font><font color="#008000"><i>{
	Drives Unit for:
		Getting and setting drive labels.
		Getting and setting drive serial number.
		Testing if a drive is ready.
		Determining the type of drive (hard/3.5/5.25...)
		Return last DOS error status.

  All procedures and functions are protected from DOS critical errors.

	Author: William R. Florac
  Company: FITCO, Verona, WI (wee little company from my house)
	Copyright 1996, FITCO.  All rights reserved.

  1) Users of Drives.pas must accept this disclaimer of warranty:
       This Unit is supplied as is.  The Fitco disclaims all
       warranties, expressed or implied, including, without limitation,
       the warranties of merchantability and of fitness for any purpose.
       Fitco assumes no liability for damages, direct or conse-
       quential, which may result from the use of this Unit.&quot;

  2) This Unit is donated to the public as public domain except as
     noted below.

  3) You must copy all Software without modification and must include
     all pages, if the Software is distributed without inclusion in your
     software product. If you are incorporating the Software in
     conjunction with and as a part of your software product which adds
     substantial value, you may modify and include portions of the
     Software.

  4) Fitco retains the copyright for this Unit.  You may not distribute
     the source code (PAS) or its compiled unit (DCU) for profit.

  5) If you do find this Unit handy and you feel guilty
     for using such a great product without paying someone,
     please feel free to send a few bucks ($25) to support further
     development.

  6) This file was formated with tabs set to 2.

	Please forward any comments or suggestions to Bill Florac at:
	 	email: flash@etcconnect.com
		www: http://sumac.etcconnect.com/~fitco/
		mail: FITCO
					209 Jenna Dr
					Verona, WI  53593

	Revision History
		2/28/96
    	1.0 released
}


</i></font><font color="#FF0000"><b>interface

uses
</b></font>	SysUtils<font color="#000080">, </font>WinProcs<font color="#000080">, </font>WinTypes<font color="#000080">;

</font><font color="#FF0000"><b>type
</b></font>  	TDriveStyle <font color="#000080">= (</font>tUnknown<font color="#000080">, </font>tNoDrive<font color="#000080">, </font>t3Floppy<font color="#000080">, </font>t5Floppy<font color="#000080">, </font>tFixed<font color="#000080">, </font>tRFixed<font color="#000080">,
</font>		tNetwork<font color="#000080">, </font>tCDROM<font color="#000080">, </font>tTape<font color="#000080">);

</font>		PDeviceParams <font color="#000080">= ^</font>TDeviceParams<font color="#000080">;
</font>		TDeviceParams <font color="#000080">= </font><font color="#FF0000"><b>record
</b></font>			bSpecFunc<font color="#000080">:</font> 			byte<font color="#000080">;</font>			<font color="#008000"><i>{Special functions}
</i></font>			bDevType<font color="#000080">:</font> 			byte<font color="#000080">;</font>			<font color="#008000"><i>{Device type}
</i></font>			wDevAttr<font color="#000080">:</font> 			word<font color="#000080">;</font>			<font color="#008000"><i>{Device attributes}
</i></font>			wCylinders<font color="#000080">:</font> 		word<font color="#000080">;</font>			<font color="#008000"><i>{Number of cylinders}
</i></font>			bMediaType<font color="#000080">:</font> 		byte<font color="#000080">;</font>			<font color="#008000"><i>{Media type}
{                          Beginning of BIOS parameter block (BPB)}
</i></font>			wBytesPerSec<font color="#000080">:</font> 	word<font color="#000080">;</font>			<font color="#008000"><i>{Bytes per sector}
</i></font>			bSecPerClust<font color="#000080">:</font> 	byte<font color="#000080">;</font>			<font color="#008000"><i>{Sectors per cluster}
</i></font>			wResSectors<font color="#000080">:</font> 		word<font color="#000080">;</font>			<font color="#008000"><i>{Number of reserved sectors}
</i></font>			bFATs<font color="#000080">:</font> 					byte<font color="#000080">;</font>			<font color="#008000"><i>{Number of FATs}
</i></font>			wRootDirEnts<font color="#000080">:</font> 	word<font color="#000080">;</font>			<font color="#008000"><i>{Number of root-directory entries}
</i></font>			wSectors<font color="#000080">:</font> 			word<font color="#000080">;</font>			<font color="#008000"><i>{Total number of sectors}
</i></font>			bMedia<font color="#000080">:</font> 				byte<font color="#000080">;</font>			<font color="#008000"><i>{Media descriptor}
</i></font>			wFATsecs<font color="#000080">:</font> 			word<font color="#000080">;</font>			<font color="#008000"><i>{Number of sectors per FAT}
</i></font>			wSecPerTrack<font color="#000080">:</font> 	word<font color="#000080">;</font>			<font color="#008000"><i>{Number of sectors per track}
</i></font>			wHeads<font color="#000080">:</font> 				word<font color="#000080">;</font>			<font color="#008000"><i>{Number of heads}
</i></font>			dwHiddenSecs<font color="#000080">:</font> 	longInt<font color="#000080">;</font>	<font color="#008000"><i>{Number of hidden sectors}
</i></font>			dwHugeSectors<font color="#000080">:</font> 	longInt<font color="#000080">;</font>	<font color="#008000"><i>{Number of sectors if wSectors == 0}
</i></font>			reserved<font color="#000080">:</font> 			<font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#008000"><i>{                          End of BIOS parameter block (BPB)}
</i></font>		<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>	<font color="#008000"><i>{parameter block for getting serial number}
</i></font>	PSerialNumberParams <font color="#000080">= ^</font>TSerialNumberParams<font color="#000080">;
</font>	TSerialNumberParams <font color="#000080">= </font><font color="#FF0000"><b>record
</b></font>		wInfoLevel<font color="#000080">:</font> 				word<font color="#000080">;
</font>		dwDiskSerialNumber<font color="#000080">: </font>longint<font color="#000080">;
</font>		caLabel<font color="#000080">:</font> 						<font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font>		baFileSystem<font color="#000080">:</font> 			<font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font>	  <font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>	<font color="#008000"><i>{parameter block to get extened error codes}
</i></font>	PExtErrorParams <font color="#000080">= ^</font>TExtErrorParams<font color="#000080">;
  </font>TExtErrorParams <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>eCode<font color="#000080">:</font> 		word<font color="#000080">;
</font>		eClass<font color="#000080">:</font> 	word<font color="#000080">;
</font>		eAction<font color="#000080">:</font> 	word<font color="#000080">;
</font>		eLocus<font color="#000080">:</font> 	word<font color="#000080">;
</font>		eVolume<font color="#000080">:</font> 	<font color="#FF0000"><b>String</b></font><font color="#000080">;
</font>		<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>	<font color="#008000"><i>{structure for FCB}
  </i></font>TEFCB <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>Flag<font color="#000080">:</font> 			byte<font color="#000080">;
    </font>Reserved<font color="#000080">:</font> 	<font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>Attribute<font color="#000080">:</font> 	byte<font color="#000080">;
    </font>Drive<font color="#000080">:</font> 			byte<font color="#000080">;
    </font>Name<font color="#000080">:</font> 			<font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>Extension<font color="#000080">:</font> 	<font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>Misc<font color="#000080">:</font> 			<font color="#FF0000"><b>array  </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">24</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>DriveLabel <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">11</font><font color="#000080">];

  </font><font color="#008000"><i>{my exception class}
</i></font>	EDriveException <font color="#000080">= </font><font color="#FF0000"><b>Class</b></font><font color="#000080">(</font>Exception<font color="#000080">);

</font><font color="#FF0000"><b>const
     </b></font><font color="#008000"><i>{$I strings}  { can be found at the END of this module !}

{standard calls}
</i></font><font color="#FF0000"><b>function </b></font>DriveReady<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{Tests to see if a drive is ready.  (floppy there and door closed)}

</i></font><font color="#FF0000"><b>function </b></font>GetDriveLabel<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SetDriveLabel<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">; </font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{Gets and sets drive label}

</i></font><font color="#FF0000"><b>function </b></font>GetDriveSerialNumber<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SetDriveSerialNumber<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">; </font>SerialNumber<font color="#000080">: </font>LongInt<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{Gets and sets drive serial number}

</i></font><font color="#FF0000"><b>function </b></font>GetDefaultDrive<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#008000"><i>{Returns current default drive}

</i></font><font color="#FF0000"><b>function </b></font>GetDriveStyle<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">): </font>TDriveStyle<font color="#000080">;
</font><font color="#008000"><i>{Returns the drive style (hard, 3-1/2, 5-1/4...)}

</i></font><font color="#FF0000"><b>procedure </b></font>GetExtendedErrorInfo<font color="#000080">(</font>ep<font color="#000080">: </font>PExtErrorParams<font color="#000080">);
</font><font color="#008000"><i>{Gets the parameters for the last DOS error.  Useful after a DriveReady failure.}

{other calls}
</i></font><font color="#FF0000"><b>function </b></font>IsCDROMDrive<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>WriteDriveSNParam<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">; </font>psnp<font color="#000080">: </font>PSerialNumberParams<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>ReadDriveSNParam<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">; </font>psnp<font color="#000080">: </font>PSerialNumberParams<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetDeviceParameters<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>dp<font color="#000080">: </font>TDeviceParams<font color="#000080">): </font>boolean<font color="#000080">;


</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{determins if the drive is ready w/o critical errors enabled}
</i></font><font color="#FF0000"><b>function </b></font>DriveReady<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>OldErrorMode<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	<font color="#008000"><i>{turn off errors}
  </i></font>OldErrorMode <font color="#000080">:= </font>SetErrorMode<font color="#000080">(</font>SEM_FAILCRITICALERRORS<font color="#000080">);
</font>	<font color="#FF0000"><b>try
</b></font>		<font color="#FF0000"><b>if </b></font>DiskSize<font color="#000080">(</font>wDrive<font color="#000080">) = -</font><font color="#800000">1
</font>		<font color="#FF0000"><b>then </b></font>result <font color="#000080">:= </font>false
		<font color="#FF0000"><b>else </b></font>result <font color="#000080">:= </font>true<font color="#000080">;
  </font><font color="#FF0000"><b>finally
</b></font>		<font color="#008000"><i>{turn on errors}
</i></font>		SetErrorMode<font color="#000080">(</font>OldErrorMode<font color="#000080">);
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{get drive parameters w/o drive access}
</i></font><font color="#FF0000"><b>function </b></font>GetDeviceParameters<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>dp<font color="#000080">: </font>TDeviceParams<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	result <font color="#000080">:= </font>TRUE<font color="#000080">;      </font><font color="#008000"><i>{Assume success}
   </i></font><font color="#FF0000"><b>asm
</b></font>			<font color="#FF00FF">push ds
      mov  bx, wDrive
      mov  ch, 08h      </font><font color="#008000"><i>{Device category--must be 08h}
      </i></font><font color="#FF00FF">mov  cl, 60h      </font><font color="#008000"><i>{MS-DOS IOCTL Get Device Parameters}
      </i></font><font color="#FF00FF">lds  dx, dp
      mov  ax, 440Dh
      int  21h
      jnc  @gdp_done     </font><font color="#008000"><i>{CF SET if error}
      </i></font><font color="#FF00FF">mov  result, FALSE
   @gdp_done:
      pop  ds
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{gets last error message from DOS}
</i></font><font color="#FF0000"><b>procedure </b></font>GetExtendedErrorInfo<font color="#000080">(</font>ep<font color="#000080">: </font>PExtErrorParams<font color="#000080">);
</font><font color="#FF0000"><b>var
</b></font>	tCode<font color="#000080">: </font>word<font color="#000080">;
</font>	tClass<font color="#000080">: </font>byte<font color="#000080">;
</font>	tAction<font color="#000080">: </font>byte<font color="#000080">;
</font>	tLocus<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm
</b></font>		<font color="#FF00FF">push ds
</font>		<font color="#FF00FF">push bp
</font>  	<font color="#FF00FF">mov  bx, 0
</font>  	<font color="#FF00FF">mov  ah, 59h
    int  21h
</font>		<font color="#FF00FF">mov</font>	 <font color="#FF00FF">tCode, ax
</font>		<font color="#FF00FF">mov</font>	 <font color="#FF00FF">tClass, bh
    mov</font>	 <font color="#FF00FF">tAction, bl
</font>		<font color="#FF00FF">mov</font>	 <font color="#FF00FF">tLocus, ch
</font>		<font color="#FF00FF">pop  bp
</font>		<font color="#FF00FF">pop  ds
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ep<font color="#000080">^.</font>eCode <font color="#000080">:= </font>tCode<font color="#000080">;
</font>	ep<font color="#000080">^.</font>eClass <font color="#000080">:= </font>tClass<font color="#000080">;
</font>	ep<font color="#000080">^.</font>eAction <font color="#000080">:= </font>tAction<font color="#000080">;
</font>	ep<font color="#000080">^.</font>eLocus <font color="#000080">:= </font>tLocus<font color="#000080">;
</font>	ep<font color="#000080">^.</font>eVolume <font color="#000080">:= </font><font color="#800000">'?'</font><font color="#000080">; </font><font color="#008000"><i>{don't support this for now}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{get volume serial number for a drive:  0=default, 1=A...}
{returns -1 if unable to read}
</i></font><font color="#FF0000"><b>function </b></font>GetDriveSerialNumber<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>var
</b></font>	snp<font color="#000080">: </font>TSerialNumberParams<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	snp<font color="#000080">.</font>dwDiskSerialNumber <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>	<font color="#FF0000"><b>if </b></font>ReadDriveSNParam<font color="#000080">(</font>wDrive<font color="#000080">, @</font>snp<font color="#000080">)
</font>	<font color="#FF0000"><b>then </b></font>Result <font color="#000080">:= </font>snp<font color="#000080">.</font>dwDiskSerialNumber
	<font color="#FF0000"><b>else </b></font>Result <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{set volume serial number for a drive:  0=default, 1=A... }
{returns true if it was sucessful}
</i></font><font color="#FF0000"><b>function </b></font>SetDriveSerialNumber<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">; </font>SerialNumber<font color="#000080">: </font>LongInt<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
</b></font>	snp<font color="#000080">: </font>TSerialNumberParams<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	result <font color="#000080">:= </font>false<font color="#000080">;
</font>	<font color="#008000"><i>{get current parameters}
</i></font>	<font color="#FF0000"><b>if </b></font>ReadDriveSNParam<font color="#000080">(</font>wDrive<font color="#000080">, @</font>snp<font color="#000080">) </font><font color="#FF0000"><b>then begin
</b></font>		<font color="#008000"><i>{change serial number}
</i></font>		snp<font color="#000080">.</font>dwDiskSerialNumber <font color="#000080">:= </font>SerialNumber<font color="#000080">;
</font>		<font color="#008000"><i>{and write back out}
</i></font>		<font color="#FF0000"><b>if </b></font>WriteDriveSNParam<font color="#000080">(</font>wDrive<font color="#000080">, @</font>snp<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>result <font color="#000080">:= </font>true<font color="#000080">;
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Write Drive parameters: 0=default, 1=A...}
{Note: wDrive and psnp are treate as var with assembler directive}
{This interupt does NOT generate a critical error!}
</i></font><font color="#FF0000"><b>function </b></font>WriteDriveSNParam<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">; </font>psnp<font color="#000080">: </font>PSerialNumberParams<font color="#000080">): </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">push ds           </font><font color="#008000"><i>{ds might get changed so save it}
</i></font>	<font color="#FF00FF">mov  bx, wDrive
  mov  al, 01h
</font>	<font color="#FF00FF">mov  ah, 69h
  lds  dx, psnp
  int  21h
  jnc  @no_error    </font><font color="#008000"><i>{CF SET if error}
</i></font>	<font color="#FF00FF">xor</font>	 <font color="#FF00FF">ax,ax</font>				<font color="#008000"><i>{set false}
  </i></font><font color="#FF00FF">jmp</font>	 <font color="#FF00FF">@exit
@no_error:
  mov</font>	<font color="#FF00FF">ax, 1</font>					<font color="#008000"><i>{set true}
</i></font><font color="#FF00FF">@exit:
</font>	<font color="#FF00FF">pop</font>	<font color="#FF00FF">ds</font>						<font color="#008000"><i>{restore ds}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Read Drive parameters: 0=default, 1=A...}
{Note: wDrive and psnp are treate as var with assembler directive}
{This interupt does NOT generate a critical error!}
</i></font><font color="#FF0000"><b>function </b></font>ReadDriveSNParam<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">; </font>psnp<font color="#000080">: </font>PSerialNumberParams<font color="#000080">): </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">push ds
</font>	<font color="#FF00FF">mov  bx, wDrive
  mov  al, 00h
</font>	<font color="#FF00FF">mov  ah, 69h
  lds  dx, psnp
  int  21h
  jnc  @no_error</font>    	<font color="#008000"><i>{CF SET if error}
</i></font>	<font color="#FF00FF">xor</font>	 <font color="#FF00FF">ax,ax</font>		<font color="#008000"><i>{set false}
  </i></font><font color="#FF00FF">jmp</font>	 <font color="#FF00FF">@exit
@no_error:
  mov</font>	<font color="#FF00FF">ax, 1</font>			<font color="#008000"><i>{set true}
</i></font><font color="#FF00FF">@exit:
</font>	<font color="#FF00FF">pop</font>	<font color="#FF00FF">ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{sets the label of the drive specified: wDrive: 0=default 1=A...}
{returns true if it was sucessful}
</i></font><font color="#FF0000"><b>function </b></font>SetDriveLabel<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">; </font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>const
</b></font>		EFCB<font color="#000080">: </font>TEFCB <font color="#000080">= (
</font>	    Flag<font color="#000080">: </font><font color="#800000">$FF</font><font color="#000080">;</font>                          	<font color="#008000"><i>{ Extended FCB Flag }
      </i></font>Reserved<font color="#000080">: (</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">);           </font><font color="#008000"><i>{ Reserved}
      </i></font>Attribute<font color="#000080">: </font><font color="#800000">$08</font><font color="#000080">;                       </font><font color="#008000"><i>{ Volume Label Attribute}
      </i></font>Drive<font color="#000080">: </font><font color="#800000">2</font><font color="#000080">;                             </font><font color="#008000"><i>{ Drive Identifier}
      </i></font>Name<font color="#000080">: </font><font color="#800000">'????????'</font><font color="#000080">;</font>  										<font color="#008000"><i>{ File Name}
      </i></font>Extension<font color="#000080">: </font><font color="#800000">'???'</font><font color="#000080">;                     </font><font color="#008000"><i>{ File Extension}
      </i></font>Misc<font color="#000080">: (</font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">,            </font><font color="#008000"><i>{ Misc. Info filled by DOS}
        </i></font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>  	<font color="#008000"><i>{ Misc. Info filled by DOS}
        </i></font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>                      	<font color="#008000"><i>{ Misc. Info filled by DOS}
        </i></font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">, </font><font color="#800000">#0  </font><font color="#008000"><i>{ Misc. Info filled by DOS}
</i></font>				<font color="#000080">)
      );
</font><font color="#FF0000"><b>var
</b></font>	Ps<font color="#000080">: </font>pchar<font color="#000080">;
</font>	err<font color="#000080">: </font>integer<font color="#000080">;
</font>	x<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font>	<font color="#008000"><i>{abort if drive not ready}
</i></font>	<font color="#FF0000"><b>if not </b></font>DriveReady<font color="#000080">(</font>wDrive<font color="#000080">) </font><font color="#FF0000"><b>then begin
</b></font>		result <font color="#000080">:= </font>false<font color="#000080">;
</font>		exit<font color="#000080">;
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>	<font color="#008000"><i>{assume ok}
</i></font>	result <font color="#000080">:= </font>true<font color="#000080">;

</font>	<font color="#008000"><i>{default things that change in constant varaiable}
</i></font>	EFCB<font color="#000080">.</font>Name <font color="#000080">:= </font><font color="#800000">'????????'</font><font color="#000080">;
</font>	EFCB<font color="#000080">.</font>Extension <font color="#000080">:= </font><font color="#800000">'???'</font><font color="#000080">;
</font>	EFCB<font color="#000080">.</font>Drive <font color="#000080">:= </font>wDrive<font color="#000080">;

</font>	<font color="#008000"><i>{See if it exist using a FCB}
</i></font>	<font color="#FF0000"><b>asm
</b></font>		<font color="#008000"><i>{Check to see;  if the volume label exists}
</i></font>		<font color="#008000"><i>{point DTA to ourself}
</i></font>		<font color="#FF00FF">mov</font>	 <font color="#FF00FF">dx,offset EFCB
</font>		<font color="#FF00FF">mov</font>	 <font color="#FF00FF">ah,1Ah
</font>		<font color="#FF00FF">int  21h
</font>		<font color="#008000"><i>{point to default FCB}
</i></font>   	<font color="#FF00FF">mov  dx, offset EFCB
    mov  ah, 11h
    int  21h
</font>		<font color="#008000"><i>{Exit if label is not present}
    </i></font><font color="#FF00FF">cmp  al, 0
    jne  @exit
</font>		<font color="#008000"><i>{Else delete the volume label}
    </i></font><font color="#FF00FF">mov  dx, offset EFCB
    mov  ah, 013h
    int  21h
    or</font>	 <font color="#FF00FF">al,al
</font>		<font color="#FF00FF">jz</font>	<font color="#FF00FF">@exit
</font>		<font color="#FF00FF">mov</font>	<font color="#FF00FF">result, 0
  @exit:
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>	<font color="#FF0000"><b>if not </b></font>result <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;

</font>	<font color="#008000"><i>{if string is empty, then just erase}
</i></font>	<font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>s<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
</font>	<font color="#008000"><i>{format string}
</i></font>	<font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font>length<font color="#000080">(</font>s<font color="#000080">) + </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">11  </font><font color="#FF0000"><b>do </b></font>s<font color="#000080">[</font>x<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;
</font>	s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>char<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">);
</font>	<font color="#008000"><i>{add drive letter!}
  </i></font><font color="#FF0000"><b>if </b></font>wdrive <font color="#000080">= </font><font color="#800000">0
</font>	<font color="#FF0000"><b>then </b></font>s <font color="#000080">:= </font><font color="#800000">'\' </font><font color="#000080">+ </font>s <font color="#000080">+ </font><font color="#800000">#0
</font>	<font color="#FF0000"><b>else </b></font>s <font color="#000080">:= </font>chr<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">+</font>wdrive<font color="#000080">) + </font><font color="#800000">':\' </font><font color="#000080">+ </font>s <font color="#000080">+ </font><font color="#800000">#0</font><font color="#000080">;
</font>	ps <font color="#000080">:= @</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];

</font>	<font color="#008000"><i>{on now make new one it!}
</i></font>	<font color="#FF0000"><b>asm
</b></font>		<font color="#FF00FF">push ds
    lds  dx, ps
    mov  cx, faVolumeID
    mov  ah,3Ch
    int  21h
    </font><font color="#008000"><i>{CF set if error}
    </i></font><font color="#FF00FF">jnc  @noerror
    mov  result, FALSE
</font>		<font color="#FF00FF">jmp</font>	 <font color="#FF00FF">@exit
  @noerror:
</font>		<font color="#008000"><i>{close file ax = handle}
</i></font>		<font color="#FF00FF">mov  bx,ax
</font>		<font color="#FF00FF">mov</font>	 <font color="#FF00FF">ah,3Eh
</font>		<font color="#FF00FF">int</font>	 <font color="#FF00FF">21h
  @exit:
</font>  	<font color="#FF00FF">pop  ds
</font>	<font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Get label from drive.  0=default, 1=A...}
{return string of 11 character or &quot;NO NAME&quot; if not found}
</i></font><font color="#FF0000"><b>function </b></font>GetDriveLabel<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>const
</b></font>	pattern<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">6</font><font color="#000080">] = </font><font color="#800000">'c:\*.*'</font><font color="#000080">;
</font><font color="#FF0000"><b>var
</b></font>	sr<font color="#000080">: </font>TsearchRec<font color="#000080">;
  </font>OldErrorMode<font color="#000080">: </font>Word<font color="#000080">;
  </font>DotPos<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	<font color="#008000"><i>{get default drive}
</i></font>	<font color="#FF0000"><b>if </b></font>wDrive <font color="#000080">= </font><font color="#800000">0
</font>	<font color="#FF0000"><b>then </b></font>wDrive <font color="#000080">:= </font>GetDefaultDrive
	<font color="#FF0000"><b>else </b></font>dec<font color="#000080">(</font>wDrive<font color="#000080">);

</font>	<font color="#008000"><i>{switch out drive letter}
</i></font>	pattern<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>char<font color="#000080">(</font><font color="#800000">65 </font><font color="#000080">+ </font>wDrive<font color="#000080">);

</font>	<font color="#008000"><i>{stop errors and try}
  </i></font>OldErrorMode <font color="#000080">:= </font>SetErrorMode<font color="#000080">(</font>SEM_FAILCRITICALERRORS<font color="#000080">);
</font>	<font color="#FF0000"><b>try
</b></font>		<font color="#FF0000"><b>if </b></font>FindFirst<font color="#000080">(</font>Pattern<font color="#000080">, </font>faVolumeID<font color="#000080">, </font>sr<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>Result <font color="#000080">:= </font>sr<font color="#000080">.</font>Name<font color="#000080">;
      </font>DotPos <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>Result<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>DotPos <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>Result<font color="#000080">, </font>DotPos<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
</font>	  <font color="#FF0000"><b>end
</b></font>		<font color="#FF0000"><b>else </b></font>result <font color="#000080">:= </font><font color="#800000">'NO NAME'
  </font><font color="#FF0000"><b>finally
</b></font>		<font color="#008000"><i>{restore errorsa}
</i></font>		SetErrorMode<font color="#000080">(</font>OldErrorMode<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>GetDefaultDrive<font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ah, 19h</font> 			<font color="#008000"><i>{convert default to real}
</i></font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">21h
</font>	<font color="#FF00FF">xor</font>	<font color="#FF00FF">ah, ah</font>				<font color="#008000"><i>{clear hi byte}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Determine id drive is a CDROM, 0=default, 1=A ...}
</i></font><font color="#FF0000"><b>function </b></font>IsCDROMDrive<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">): </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
</b></font>	wTempDrive<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax, wDrive
</font>	<font color="#FF00FF">or  ax, ax
</font>	<font color="#FF00FF">jnz</font>	<font color="#FF00FF">@not_default
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ah, 19h</font> 			<font color="#008000"><i>{convert default to drive}
</i></font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">21h
</font>	<font color="#FF00FF">xor</font>	<font color="#FF00FF">ah, ah
</font>	<font color="#FF00FF">mov wTempDrive, ax
</font>	<font color="#FF00FF">jmp</font>	<font color="#FF00FF">@test_it
@not_default:</font> 			<font color="#008000"><i>{zero base it}
</i></font>	<font color="#FF00FF">dec</font>	<font color="#FF00FF">ax
</font>	<font color="#FF00FF">mov wTempDrive, ax
@test_it:
</font>	<font color="#FF00FF">mov ax, 1500h     </font><font color="#008000"><i>{first test for presence of MSCDEX}
  </i></font><font color="#FF00FF">xor bx, bx
  int 2fh
  mov ax, bx        </font><font color="#008000"><i>{MSCDEX is not there if bx is zero}
</i></font>	<font color="#FF00FF">or  ax, ax        </font><font color="#008000"><i>{so return FALSE}
</i></font>	<font color="#FF00FF">jz  @no_mscdex
</font>	<font color="#FF00FF">mov ax, 150bh     </font><font color="#008000"><i>{MSCDEX driver check API}
</i></font>	<font color="#FF00FF">mov cx, wTempDrive    </font><font color="#008000"><i>{...cx is drive index}
</i></font>	<font color="#FF00FF">int 2fh
</font>	<font color="#FF00FF">or</font> 	<font color="#FF00FF">ax, ax
@no_mscdex:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{returns drive type}
{read BOIS not drive so floppy does not have to be in drive}
{I don't have all types of drive so not all could be tested}
</i></font><font color="#FF0000"><b>function </b></font>GetDriveStyle<font color="#000080">(</font>wDrive<font color="#000080">: </font>word<font color="#000080">): </font>TDriveStyle<font color="#000080">;
</font><font color="#FF0000"><b>var
</b></font>	x<font color="#000080">: </font>word<font color="#000080">;
</font>	wTempDrive<font color="#000080">: </font>word<font color="#000080">;
</font>	dp<font color="#000080">: </font>TDeviceParams<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	<font color="#008000"><i>{convert default to drive}
</i></font>	<font color="#FF0000"><b>if </b></font>wDrive <font color="#000080">= </font><font color="#800000">0
</font>	<font color="#FF0000"><b>then </b></font>wTempDrive <font color="#000080">:= </font>GetDefaultDrive
	<font color="#FF0000"><b>else </b></font>wTempDrive <font color="#000080">:= </font>wDrive <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
</font>	x <font color="#000080">:= </font>GetDriveType<font color="#000080">(</font>wTempDrive<font color="#000080">);

</font>	<font color="#008000"><i>{get types}
</i></font>	<font color="#FF0000"><b>case </b></font>x <font color="#FF0000"><b>of
</b></font>	drive_Removable<font color="#000080">: </font><font color="#FF0000"><b>begin
</b></font>		dp<font color="#000080">.</font>bSpecFunc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{need to clear this}
</i></font>		<font color="#FF0000"><b>if </b></font>GetDeviceParameters<font color="#000080">(</font>wDrive<font color="#000080">,</font>dp<font color="#000080">) </font><font color="#FF0000"><b>then begin
</b></font>			<font color="#FF0000"><b>case </b></font>dp<font color="#000080">.</font>bDevType <font color="#FF0000"><b>of
</b></font>			<font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">: </font>result <font color="#000080">:= </font>t5floppy<font color="#000080">;</font>		<font color="#008000"><i>{320K/360K/1.2M}
</i></font>			<font color="#800000">2</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">: </font>result <font color="#000080">:= </font>t3floppy<font color="#000080">;</font>	<font color="#008000"><i>{720K/1.44M/2.88M}
</i></font>			<font color="#800000">5</font><font color="#000080">: </font>result <font color="#000080">:= </font>tRFixed<font color="#000080">;</font>     	<font color="#008000"><i>{yes a removable fixed drive!}
</i></font>			<font color="#800000">6</font><font color="#000080">: </font>result <font color="#000080">:= </font>tTape<font color="#000080">;         </font><font color="#008000"><i>{tape}
      </i></font><font color="#FF0000"><b>else </b></font>result <font color="#000080">:= </font>tUnknown<font color="#000080">;
</font>			<font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>		<font color="#FF0000"><b>end
</b></font>		<font color="#FF0000"><b>else </b></font>result <font color="#000080">:= </font>tUnknown<font color="#000080">;
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>drive_Fixed<font color="#000080">:
</font>		<font color="#FF0000"><b>if </b></font>IsCDROMDrive<font color="#000080">(</font>wDrive<font color="#000080">)
</font>		<font color="#FF0000"><b>then </b></font>result <font color="#000080">:= </font>tCDROM
		<font color="#FF0000"><b>else </b></font>result <font color="#000080">:= </font>tFixed<font color="#000080">;
</font> 	drive_Remote<font color="#000080">:
</font>		<font color="#FF0000"><b>if </b></font>IsCDROMDrive<font color="#000080">(</font>wDrive<font color="#000080">) </font><font color="#008000"><i>{I think this is possible on a network!}
</i></font>		<font color="#FF0000"><b>then </b></font>result <font color="#000080">:= </font>tCDROM
		<font color="#FF0000"><b>else </b></font>result <font color="#000080">:= </font>tNetWork<font color="#000080">;
</font>	<font color="#FF0000"><b>else </b></font>result <font color="#000080">:= </font>tUnknown<font color="#000080">;
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">. </font><font color="#008000"><i>{of unit}

{ ----------------   STRINGS.PAS  ---------------------------------}
{ CUT }

{string constants for drives.pas}

{The error class may be one of the following}
</i></font> 	eClassStr<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">$0D</font><font color="#000080">] </font><font color="#FF0000"><b>of string </b></font><font color="#000080">= (
</font><font color="#008000"><i>{OK											}</i></font><font color="#800000">'OK'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_OUTRES (01h)	}</i></font><font color="#800000">'Out of resource, such as storage.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_TEMPSIT (02h)	}</i></font><font color="#800000">'Not an error, temporary situation (file or record lock)'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_AUTH (03h)		}</i></font><font color="#800000">'Authorization problem.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_INTRN (04h)		}</i></font><font color="#800000">'Internal error in system.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_HRDFAIL (05h)	}</i></font><font color="#800000">'Hardware failure.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_SYSFAIL (06h)	}</i></font><font color="#800000">'System software failure (missing or incorrect configuration files).'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_APPERR (07h)	}</i></font><font color="#800000">'Application error.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_NOTFND (08h)  }</i></font><font color="#800000">'File or item not found.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_BADFMT (09h)  }</i></font><font color="#800000">'File or item with an invalid format or type.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_LOCKED (0Ah)  }</i></font><font color="#800000">'Interlocked file or item.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_MEDIA (0Bh)   }</i></font><font color="#800000">'Wrong disk in drive, bad spot on disk, or other storage-medium problem.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_ALREADY (0Ch) }</i></font><font color="#800000">'Existing file or item.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRCLASS_UNK (0Dh)	 	  }</i></font><font color="#800000">'Unknown.'</font><font color="#000080">);

</font><font color="#008000"><i>{*The suggested action may be one of the following:}
</i></font> 	eActionStr<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">$07</font><font color="#000080">] </font><font color="#FF0000"><b>of string </b></font><font color="#000080">= (
</font><font color="#008000"><i>{OK											}</i></font><font color="#800000">'OK'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRACT_RETRY (01h)			}</i></font><font color="#800000">'Retry immediately.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRACT_DLYRET (02h)		}</i></font><font color="#800000">'Delay and retry.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRACT_USER (03h)			}</i></font><font color="#800000">'Bad user input, get new values.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRACT_ABORT (04h)			}</i></font><font color="#800000">'Terminate in an orderly manner.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRACT_PANIC (05h)			}</i></font><font color="#800000">'Terminate immediately.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRACT_IGNORE (06h)		}</i></font><font color="#800000">'Ignore the error.'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRACT_INTRET (07h)		}</i></font><font color="#800000">'Remove the cause of the error (to change disks, for example) and then retry.'</font><font color="#000080">);

</font><font color="#008000"><i>{The error location may be one of the following:}
</i></font>eLocusStr<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">$05</font><font color="#000080">] </font><font color="#FF0000"><b>of string </b></font><font color="#000080">= (
</font><font color="#008000"><i>{OK											}</i></font><font color="#800000">'OK'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRLOC_UNK (01h)				}</i></font><font color="#800000">'Unknown'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRLOC_DISK (02h)			}</i></font><font color="#800000">'Random-access device, such as a disk drive'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRLOC_NET (03h)				}</i></font><font color="#800000">'Network'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRLOC_SERDEV (04h)		}</i></font><font color="#800000">'Serial device'</font><font color="#000080">,
</font><font color="#008000"><i>{ERRLOC_MEM (05h)				}</i></font><font color="#800000">'Memory'</font><font color="#000080">);

</font><font color="#008000"><i>{MS DOS error codes}
</i></font>eDosErrorStr<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">$5A</font><font color="#000080">] </font><font color="#FF0000"><b>of string </b></font><font color="#000080">= (
</font><font color="#008000"><i>{0000h  non error} </i></font><font color="#800000">'OK'</font><font color="#000080">,
</font><font color="#008000"><i>{0001h}</i></font>	<font color="#800000">'ERROR_INVALID_FUNCTION'</font><font color="#000080">,
</font><font color="#008000"><i>{0002h}</i></font>	<font color="#800000">'ERROR_FILE_NOT_FOUND'</font><font color="#000080">,
</font><font color="#008000"><i>{0003h}</i></font>	<font color="#800000">'ERROR_PATH_NOT_FOUND'</font><font color="#000080">,
</font><font color="#008000"><i>{0004h}</i></font>	<font color="#800000">'ERROR_TOO_MANY_OPEN_FILES'</font><font color="#000080">,
</font><font color="#008000"><i>{0005h}</i></font>	<font color="#800000">'ERROR_ACCESS_DENIED'</font><font color="#000080">,
</font><font color="#008000"><i>{0006h}</i></font>	<font color="#800000">'ERROR_INVALID_HANDLE'</font><font color="#000080">,
</font><font color="#008000"><i>{0007h}</i></font>	<font color="#800000">'ERROR_ARENA_TRASHED'</font><font color="#000080">,
</font><font color="#008000"><i>{0008h}</i></font>	<font color="#800000">'ERROR_NOT_ENOUGH_MEMORY'</font><font color="#000080">,
</font><font color="#008000"><i>{0009h}</i></font>	<font color="#800000">'ERROR_INVALID_BLOCK'</font><font color="#000080">,
</font><font color="#008000"><i>{000Ah}</i></font>	<font color="#800000">'ERROR_BAD_ENVIRONMENT'</font><font color="#000080">,
</font><font color="#008000"><i>{000Bh}</i></font>	<font color="#800000">'ERROR_BAD_FORMAT'</font><font color="#000080">,
</font><font color="#008000"><i>{000Ch}</i></font>	<font color="#800000">'ERROR_INVALID_ACCESS'</font><font color="#000080">,
</font><font color="#008000"><i>{000Dh}</i></font>	<font color="#800000">'ERROR_INVALID_DATA'</font><font color="#000080">,
</font><font color="#008000"><i>{000Eh} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{000Fh}</i></font>	<font color="#800000">'ERROR_INVALID_DRIVE'</font><font color="#000080">,
</font><font color="#008000"><i>{0010h}</i></font>	<font color="#800000">'ERROR_CURRENT_DIRECTORY'</font><font color="#000080">,
</font><font color="#008000"><i>{0011h}</i></font>	<font color="#800000">'ERROR_NOT_SAME_DEVICE'</font><font color="#000080">,
</font><font color="#008000"><i>{0012h}</i></font>	<font color="#800000">'ERROR_NO_MORE_FILES'</font><font color="#000080">,
</font><font color="#008000"><i>{0013h}</i></font>	<font color="#800000">'ERROR_WRITE_PROTECT'</font><font color="#000080">,
</font><font color="#008000"><i>{0014h}</i></font>	<font color="#800000">'ERROR_BAD_UNIT'</font><font color="#000080">,
</font><font color="#008000"><i>{0015h}</i></font>	<font color="#800000">'ERROR_NOT_READY'</font><font color="#000080">,
</font><font color="#008000"><i>{0016h}</i></font>	<font color="#800000">'ERROR_BAD_COMMAND'</font><font color="#000080">,
</font><font color="#008000"><i>{0017h}</i></font>	<font color="#800000">'ERROR_CRC'</font><font color="#000080">,
</font><font color="#008000"><i>{0018h}</i></font>	<font color="#800000">'ERROR_BAD_LENGTH'</font><font color="#000080">,
</font><font color="#008000"><i>{0019h}</i></font>	<font color="#800000">'ERROR_SEEK'</font><font color="#000080">,
</font><font color="#008000"><i>{001Ah}</i></font>	<font color="#800000">'ERROR_NOT_DOS_DISK'</font><font color="#000080">,
</font><font color="#008000"><i>{001Bh}</i></font>	<font color="#800000">'ERROR_SECTOR_NOT_FOUND'</font><font color="#000080">,
</font><font color="#008000"><i>{001Ch}</i></font>	<font color="#800000">'ERROR_OUT_OF_PAPER'</font><font color="#000080">,
</font><font color="#008000"><i>{001Dh}</i></font>	<font color="#800000">'ERROR_WRITE_FAULT'</font><font color="#000080">,
</font><font color="#008000"><i>{001Eh}</i></font>	<font color="#800000">'ERROR_READ_FAULT'</font><font color="#000080">,
</font><font color="#008000"><i>{001Fh}</i></font>	<font color="#800000">'ERROR_GEN_FAILURE'</font><font color="#000080">,
</font><font color="#008000"><i>{0020h}</i></font>	<font color="#800000">'ERROR_SHARING_VIOLATION'</font><font color="#000080">,
</font><font color="#008000"><i>{0021h}</i></font>	<font color="#800000">'ERROR_LOCK_VIOLATION'</font><font color="#000080">,
</font><font color="#008000"><i>{0022h}</i></font>	<font color="#800000">'ERROR_WRONG_DISK'</font><font color="#000080">,
</font><font color="#008000"><i>{0023h}</i></font>	<font color="#800000">'ERROR_FCB_UNAVAILABLE'</font><font color="#000080">,
</font><font color="#008000"><i>{0024h}</i></font>	<font color="#800000">'ERROR_SHARING_BUFFER_EXCEEDED'</font><font color="#000080">,
</font><font color="#008000"><i>{0025h}</i></font>	<font color="#800000">'ERROR_CODE_PAGE_MISMATCHED'</font><font color="#000080">,
</font><font color="#008000"><i>{0026h}</i></font>	<font color="#800000">'ERROR_HANDLE_EOF'</font><font color="#000080">,
</font><font color="#008000"><i>{0027h}</i></font>	<font color="#800000">'ERROR_HANDLE_DISK_FULL'</font><font color="#000080">,
</font><font color="#008000"><i>{0028h} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{0029h} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{002Ah} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{002Bh} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{002Ch} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{002Dh} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{002Eh} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{002Fh} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{0030h} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{0031h} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{0032h}</i></font>	<font color="#800000">'ERROR_NOT_SUPPORTED'</font><font color="#000080">,
</font><font color="#008000"><i>{0033h}</i></font>	<font color="#800000">'ERROR_REM_NOT_LIST'</font><font color="#000080">,
</font><font color="#008000"><i>{0034h}</i></font>	<font color="#800000">'ERROR_DUP_NAME'</font><font color="#000080">,
</font><font color="#008000"><i>{0035h}</i></font>	<font color="#800000">'ERROR_BAD_NETPATH'</font><font color="#000080">,
</font><font color="#008000"><i>{0036h}</i></font>	<font color="#800000">'ERROR_NETWORK_BUSY'</font><font color="#000080">,
</font><font color="#008000"><i>{0037h}</i></font>	<font color="#800000">'ERROR_DEV_NOT_EXIST'</font><font color="#000080">,
</font><font color="#008000"><i>{0038h}</i></font>	<font color="#800000">'ERROR_TOO_MANY_CMDS'</font><font color="#000080">,
</font><font color="#008000"><i>{0039h}</i></font>	<font color="#800000">'ERROR_ADAP_HDW_ERR'</font><font color="#000080">,
</font><font color="#008000"><i>{003Ah}</i></font>	<font color="#800000">'ERROR_BAD_NET_RESP'</font><font color="#000080">,
</font><font color="#008000"><i>{003Bh}</i></font>	<font color="#800000">'ERROR_UNEXP_NET_ERR'</font><font color="#000080">,
</font><font color="#008000"><i>{003Ch}</i></font>	<font color="#800000">'ERROR_BAD_REM_ADAP'</font><font color="#000080">,
</font><font color="#008000"><i>{003Dh}</i></font>	<font color="#800000">'ERROR_PRINTQ _FULL'</font><font color="#000080">,
</font><font color="#008000"><i>{003Eh}</i></font>	<font color="#800000">'ERROR_NO_SPOOL_SPACE'</font><font color="#000080">,
</font><font color="#008000"><i>{003Fh}</i></font>	<font color="#800000">'ERROR_PRINT_CANCELLED'</font><font color="#000080">,
</font><font color="#008000"><i>{0040h}</i></font>	<font color="#800000">'ERROR_NETNAME_DELETED'</font><font color="#000080">,
</font><font color="#008000"><i>{0041h}</i></font>	<font color="#800000">'ERROR_NETWORK_ACCESS_DENIED'</font><font color="#000080">,
</font><font color="#008000"><i>{0042h}</i></font>	<font color="#800000">'ERROR_BAD_DEV_TYPE'</font><font color="#000080">,
</font><font color="#008000"><i>{0043h}</i></font>	<font color="#800000">'ERROR_BAD_NET_NAME'</font><font color="#000080">,
</font><font color="#008000"><i>{0044h}</i></font>	<font color="#800000">'ERROR_TOO_MANY_NAMES'</font><font color="#000080">,
</font><font color="#008000"><i>{0045h}</i></font>	<font color="#800000">'ERROR_TOO_MANY_SESS'</font><font color="#000080">,
</font><font color="#008000"><i>{0046h}</i></font>	<font color="#800000">'ERROR_SHARING_PAUSED'</font><font color="#000080">,
</font><font color="#008000"><i>{0047h}</i></font>	<font color="#800000">'ERROR_ERROR_REQ _NOT_ACCEP'</font><font color="#000080">,
</font><font color="#008000"><i>{0048h}</i></font>	<font color="#800000">'ERROR_REDIR_PAUSED'</font><font color="#000080">,
</font><font color="#008000"><i>{0049h} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{004Ah} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{004Bh} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{004Ch} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{004Dh} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{004Eh} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{004Fh} </i></font><font color="#800000">'Reserved'</font><font color="#000080">,
</font><font color="#008000"><i>{0050h}</i></font>	<font color="#800000">'ERROR_FILE_EXISTS'</font><font color="#000080">,
</font><font color="#008000"><i>{0051h}</i></font>	<font color="#800000">'ERROR_DUP_FCB'</font><font color="#000080">,
</font><font color="#008000"><i>{0052h}</i></font>	<font color="#800000">'ERROR_CANNOT_MAKE'</font><font color="#000080">,
</font><font color="#008000"><i>{0053h}</i></font>	<font color="#800000">'ERROR_FAIL_I24'</font><font color="#000080">,
</font><font color="#008000"><i>{0054h}</i></font>	<font color="#800000">'ERROR_OUT_OF_STRUCTURES'</font><font color="#000080">,
</font><font color="#008000"><i>{0055h}</i></font>	<font color="#800000">'ERROR_ALREADY_ASSIGNED'</font><font color="#000080">,
</font><font color="#008000"><i>{0056h}</i></font>	<font color="#800000">'ERROR_INVALID_PASSWORD'</font><font color="#000080">,
</font><font color="#008000"><i>{0057h}</i></font>	<font color="#800000">'ERROR_INVALID_PARAMETER'</font><font color="#000080">,
</font><font color="#008000"><i>{0058h}</i></font>	<font color="#800000">'ERROR_NET_WRITE_FAULT'</font><font color="#000080">,
</font><font color="#008000"><i>{0059h}</i></font>	<font color="#800000">'Function not supported on Network'</font><font color="#000080">,
</font><font color="#008000"><i>{005Ah}</i></font>	<font color="#800000">'ERROR_SYS_COMP_NOT_LOADED'</font><font color="#000080">);

</font>cDriveStr<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of string </b></font><font color="#000080">= (
</font>			<font color="#800000">'Unknown'</font><font color="#000080">,
</font>			<font color="#800000">'NoDrive'</font><font color="#000080">,
</font>			<font color="#800000">'3-1/2&quot; floppy'</font><font color="#000080">,
</font>			<font color="#800000">'5-1/4&quot; floppy'</font><font color="#000080">,
</font>		 	<font color="#800000">'hard'</font><font color="#000080">,
</font>			<font color="#800000">'removable hard'</font><font color="#000080">,
</font>			<font color="#800000">'network'</font><font color="#000080">,
</font>			<font color="#800000">'CD ROM'</font><font color="#000080">,
      </font><font color="#800000">'tape'</font><font color="#000080">);
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0114.PAS">Original</a><b>]</b></p></body>
</html>
