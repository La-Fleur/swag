<html>
<head><title> "Getting Drive INFO" by ERIC GIVLER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0052.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
ERIC GIVLER

&gt; about, evidentally), are two different things.  The serial
&gt; number is only accessible in Dos v4.0+, and (I think), you
&gt; have to use the FCBs to get it.

No, no FCBs, see:
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">,
  </font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>MIDRecord <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>InfoLevel <font color="#000080">: </font>Word<font color="#000080">;
    </font>SerialNum <font color="#000080">: </font>LongInt<font color="#000080">;   </font><font color="#008000"><i>{This is the serial number...}
    </i></font>VolLabel  <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>FatType   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Label_Fat<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Mid <font color="#000080">: </font>MidRecord<font color="#000080">; </font>Drive <font color="#000080">: </font>Word<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Result <font color="#000080">: </font>Word<font color="#000080">;
  </font>Regs   <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>Mid<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Mid<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font>FillChar<font color="#000080">(</font>Regs<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Regs<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>Regs <font color="#FF0000"><b>DO
  begin
    </b></font>AX <font color="#000080">:= </font><font color="#800000">$440D</font><font color="#000080">;
    </font>BX <font color="#000080">:= </font>Drive<font color="#000080">;
    </font>CX <font color="#000080">:= </font><font color="#800000">$0866</font><font color="#000080">;
    </font>DS <font color="#000080">:= </font>Seg<font color="#000080">(</font>Mid<font color="#000080">);
    </font>DX <font color="#000080">:= </font>Ofs<font color="#000080">(</font>Mid<font color="#000080">);
    </font>Intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>Regs<font color="#000080">);
    </font><font color="#FF0000"><b>Case </b></font>AX <font color="#FF0000"><b>of
      </b></font><font color="#800000">$01 </font><font color="#000080">: </font>Label_Fat <font color="#000080">:= </font>False<font color="#000080">;
      </font><font color="#800000">$02 </font><font color="#000080">: </font>Label_Fat <font color="#000080">:= </font>False<font color="#000080">;
      </font><font color="#800000">$05 </font><font color="#000080">: </font>Label_Fat <font color="#000080">:= </font>False<font color="#000080">;
      </font><font color="#FF0000"><b>else
        </b></font>Label_Fat <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Mid <font color="#000080">: </font>MidRecord<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Label_Fat<font color="#000080">(</font>Mid<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
  With </b></font>Mid <font color="#FF0000"><b>DO
  begin
    </b></font>Writeln<font color="#000080">(</font>SerialNum<font color="#000080">);
    </font>Writeln<font color="#000080">(</font>VolLabel<font color="#000080">);
    </font>Writeln<font color="#000080">(</font>FatType<font color="#000080">);
  </font><font color="#FF0000"><b>end
  else
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error Occured'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0052.PAS">Original</a><b>]</b></p></body>
</html>
