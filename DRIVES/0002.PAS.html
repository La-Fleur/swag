<html>
<head><title> "Change Default Drive" by GREG ESTABROOKS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ Author: Greg Estabrooks }
</i></font><font color="#FF0000"><b>Program </b></font>DriveInf<font color="#000080">;
</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">,                        </font><font color="#008000"><i>(* ClrScr routine                   *)
  </i></font>Dos<font color="#000080">;                        </font><font color="#008000"><i>(* Register Type, Intr() Routine    *)
</i></font><font color="#FF0000"><b>Var
  </b></font>Regs <font color="#000080">:</font>Registers<font color="#000080">;            </font><font color="#008000"><i>(* To hold register info For Intr() *)
  </i></font>CH   <font color="#000080">:</font>Char<font color="#000080">;                 </font><font color="#008000"><i>(* To hold Drive to change to       *)


</i></font><font color="#FF0000"><b>Function </b></font>GetDrive <font color="#000080">:</font>Byte<font color="#000080">;
                </font><font color="#008000"><i>(* Routine to Determine the default drive             *)
</i></font><font color="#FF0000"><b>begin
  </b></font>Regs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$1900</font><font color="#000080">;                </font><font color="#008000"><i>(* Function to determine drive     *)
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>Regs<font color="#000080">);                  </font><font color="#008000"><i>(* Call Dos int 21h                *)
  </i></font>GetDrive <font color="#000080">:= </font>Regs<font color="#000080">.</font>AL<font color="#000080">;             </font><font color="#008000"><i>(* Return Proper result            *)
        (* Returns  0 = A, 1 = B, 2 = C, ETC                          *)
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ChangeDrive<font color="#000080">( </font>Drive <font color="#000080">:</font>Byte <font color="#000080">);
                </font><font color="#008000"><i>(* Routine to change default drive                    *)
</i></font><font color="#FF0000"><b>begin
  </b></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0E</font><font color="#000080">;                </font><font color="#008000"><i>(* Function to change Drives         *)
  </i></font>Regs<font color="#000080">.</font>DL <font color="#000080">:= </font>Drive<font color="#000080">;              </font><font color="#008000"><i>(* Drive to change to                *)
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>Regs<font color="#000080">);                </font><font color="#008000"><i>(* Call Dos Int 21h                  *)
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>NumDrives <font color="#000080">:</font>Byte<font color="#000080">;
                </font><font color="#008000"><i>(* Routine to determine number of valid drives        *)
</i></font><font color="#FF0000"><b>Var
  </b></font>CurDrive <font color="#000080">:</font>Byte<font color="#000080">;             </font><font color="#008000"><i>(* Temporary storage For current drive*)
</i></font><font color="#FF0000"><b>begin
  </b></font>CurDrive <font color="#000080">:= </font>GetDrive<font color="#000080">;         </font><font color="#008000"><i>(* Find out the current drive         *)
  </i></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0E</font><font color="#000080">;               </font><font color="#008000"><i>(* Function to change drives          *)
  </i></font>Regs<font color="#000080">.</font>DL <font color="#000080">:= </font>CurDrive<font color="#000080">;          </font><font color="#008000"><i>(* Change to current drive            *)
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">, </font>Regs<font color="#000080">);              </font><font color="#008000"><i>(* Call Dos                           *)
  </i></font>NumDrives <font color="#000080">:= </font>Regs<font color="#000080">.</font>AL<font color="#000080">;         </font><font color="#008000"><i>(* Return proper info to user         *)
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;                        </font><font color="#008000"><i>(* Clear the screen                  *)
                                 (* Write Current Drive to  Screen    *)
  </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Current Drive Is : '</font><font color="#000080">,</font>CHR<font color="#000080">(</font>GetDrive<font color="#000080">+</font><font color="#800000">65 </font><font color="#000080">),</font><font color="#800000">':\'</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'What Drive do you wish to change to ?[A..'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>CHR<font color="#000080">(</font>NumDrives <font color="#000080">+ </font><font color="#800000">64 </font><font color="#000080">),</font><font color="#800000">']'</font><font color="#000080">);
  </font>CH <font color="#000080">:= </font>ReadKey<font color="#000080">;                 </font><font color="#008000"><i>(* Get Choice                        *)
  </i></font>CH <font color="#000080">:= </font>UpCase<font color="#000080">( </font>CH <font color="#000080">);            </font><font color="#008000"><i>(* Convert to uppercase              *)
  </i></font>ChangeDrive<font color="#000080">( </font>Ord<font color="#000080">( </font>CH <font color="#000080">)-</font><font color="#800000">65 </font><font color="#000080">);   </font><font color="#008000"><i>(* Change to chosen drive            *)
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#008000"><i>(**********************************************************************)


{        And here are the above in Inline Asm. I hope these help. }

</i></font><font color="#FF0000"><b>Function </b></font>GetDrive <font color="#000080">:</font>Byte<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
                    </font><font color="#008000"><i>{  Routine to Determine the default drive           }
</i></font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov AX,$1900                  </font><font color="#008000"><i>{  Function to determine drive          }
  </i></font><font color="#FF00FF">Int $21                       </font><font color="#008000"><i>{  Call Dos int 21h                     }
                    { Returns  0 = A, 1 = B, 2 = C, ETC                 }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{GetDrive}

</i></font><font color="#FF0000"><b>Procedure </b></font>ChangeDrive<font color="#000080">( </font>Drive <font color="#000080">:</font>Byte <font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
                    </font><font color="#008000"><i>{  Routine to change default drive                  }
                    {  0 = A, 1 = B, 2 = C, ETC                         }
</i></font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov AH,$0E                     </font><font color="#008000"><i>{  Function to change Drives           }
  </i></font><font color="#FF00FF">Mov DL,Drive                   </font><font color="#008000"><i>{  Drive to change to                  }
  </i></font><font color="#FF00FF">Int $21                        </font><font color="#008000"><i>{  Call Dos Int 21h                    }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{ChangeDrive}

</i></font><font color="#FF0000"><b>Function </b></font>NumDrives <font color="#000080">:</font>Byte<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
                     </font><font color="#008000"><i>{  Routine to determine number of valid drives   }
</i></font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Call GetDrive                </font><font color="#008000"><i>{  Find out the current drive, Returns }
                               {  Drive in AL                         }
  </i></font><font color="#FF00FF">Mov AH,$0E                   </font><font color="#008000"><i>{  Function to change drives           }
  </i></font><font color="#FF00FF">Mov DL,AL                    </font><font color="#008000"><i>{  Change to current drive             }
  </i></font><font color="#FF00FF">Int $21                      </font><font color="#008000"><i>{  Call Dos                            }
                               {  Number of drives is returns in AL   }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{NumDrives}

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p></body>
</html>
