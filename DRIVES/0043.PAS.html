<html>
<head><title> "Hard Drive Report" by CHRIS PRIEDE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
===========================================================================
 BBS: Canada Remote Systems
Date: 09-20-93 (01:47)             Number: 8840
From: CHRIS PRIEDE                 Refer#: NONE
  To: WIM VAN.VOLLENHOVEN           Recvd: NO
Subj: Disk &amp; Drives                  Conf: (1617) L-Pascal
---------------------------------------------------------------------------
WV&gt;  - I can't figure out how to determain if the drive is a ramdisk
WV&gt;    or a fixed disk.

    RAM disks have only one copy of FAT, while floppies and hard disks
should have at least two. Use DOS function 1Fh or 32h to get this
information for current/specified drive. The following program uses
function 1F:

===========================================================
*)

</i></font><font color="#FF0000"><b>program </b></font>TellMeAllAboutMyDrive<font color="#000080">;
</font><font color="#008000"><i>(* Released to public domain, K. Priede, 1993 *)

</i></font><font color="#FF0000"><b>uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font><font color="#008000"><i>(* record matching DOS (2.0+) Drive Parameter Block.
   * defined only interesting items, DOS structure is bigger *)
  </i></font>DosDPB <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>Drive<font color="#000080">, </font>UnitNo<font color="#000080">: </font>byte<font color="#000080">;
    </font>BytesPerSector<font color="#000080">: </font>word<font color="#000080">;
    </font>LastSectorInCluster<font color="#000080">: </font>byte<font color="#000080">;
    </font>ShiftCount<font color="#000080">: </font>byte<font color="#000080">;
    </font>ReservedSectors<font color="#000080">: </font>word<font color="#000080">;
    </font>FATCount<font color="#000080">: </font>byte<font color="#000080">;
    </font>RootDirEntries<font color="#000080">, </font>FirstDataSector<font color="#000080">, </font>LastCluster<font color="#000080">: </font>word<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Regs<font color="#000080">: </font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>(* func. 1Fh -- Get DPB
   * returns: AL = 0 if successful, DS:BX -&gt; DBP *)
  </i></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$1F</font><font color="#000080">;
  </font>MsDos<font color="#000080">(</font>Regs<font color="#000080">);
  </font><font color="#008000"><i>(* now show what we got ... *)
  </i></font><font color="#FF0000"><b>if </b></font>Regs<font color="#000080">.</font>AL <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    with </b></font>DosDPB<font color="#000080">(</font>Ptr<font color="#000080">(</font>Regs<font color="#000080">.</font>DS<font color="#000080">, </font>Regs<font color="#000080">.</font>BX<font color="#000080">)^) </font><font color="#FF0000"><b>do
    begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">#10#13'Parameters for drive '</font><font color="#000080">,
        </font>Chr<font color="#000080">(</font>Ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">) + </font>Drive<font color="#000080">), </font><font color="#800000">':'#13#10</font><font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Sector size: '</font><font color="#000080">:</font><font color="#800000">24</font><font color="#000080">, </font>BytesPerSector<font color="#000080">, </font><font color="#800000">' bytes'</font><font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Sectors per cluster: '</font><font color="#000080">:</font><font color="#800000">24</font><font color="#000080">, </font>LastSectorInCluster <font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Clusters on drive: '</font><font color="#000080">:</font><font color="#800000">24</font><font color="#000080">, </font>LastCluster <font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Total drive space: '</font><font color="#000080">:</font><font color="#800000">24</font><font color="#000080">, </font>longint<font color="#000080">(</font>BytesPerSector<font color="#000080">) *
        (</font>LastSectorInCluster <font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) * (</font>LastCluster <font color="#000080">-</font><font color="#800000">1</font><font color="#000080">),</font><font color="#800000">' bytes'#13#10</font><font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Number of FATs: '</font><font color="#000080">:</font><font color="#800000">24</font><font color="#000080">, </font>FATCount<font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Root directory size: '</font><font color="#000080">:</font><font color="#800000">24</font><font color="#000080">, </font>RootDirEntries<font color="#000080">, </font><font color="#800000">' entries'</font><font color="#000080">);
    </font><font color="#FF0000"><b>end
   else </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error!'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
===========================================================
---
 &thorn; </font>RNET <font color="#800000">2.00</font>m<font color="#000080">: </font>ILink<font color="#000080">: </font>Faster<font color="#000080">-</font>Than<font color="#000080">-</font>Light <font color="#000080">&thorn; </font>Atlanta GA <font color="#000080">&thorn; </font><font color="#800000">404</font><font color="#000080">-</font><font color="#800000">296</font><font color="#000080">-</font><font color="#800000">3120 </font><font color="#000080">/ </font><font color="#800000">299</font><font color="#000080">-</font><font color="#800000">3930
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p></body>
</html>
