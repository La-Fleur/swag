<html>
<head><title> "Available Drives" by KENT BRIGGS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
KENT BRIGGS

&gt; Does anyone know how to check if a drive is valid Without accessing
&gt; it to see? For example, if the available drives on a system are: A, B,
&gt; C, E. How do you check if drive A is installed Without having the
&gt; floppy drive lights go on. I use TP6, so if you include a sample code,
&gt; could you make it compatible With it.
}

</i></font><font color="#FF0000"><b>Program </b></font>Show_drives<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Drv <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReportDrives<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Regs    <font color="#000080">: </font>Registers<font color="#000080">;
  </font>Count   <font color="#000080">: </font>Integer<font color="#000080">;
  </font>DrvList <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">26</font><font color="#000080">];
  </font>Fcb     <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">37</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DrvList <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">26 </font><font color="#FF0000"><b>do         </b></font><font color="#008000"><i>{Try drives A..Z}
  </i></font><font color="#FF0000"><b>begin
    </b></font>Drv<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]  := </font>Count <font color="#000080">+ </font><font color="#800000">64</font><font color="#000080">;         </font><font color="#008000"><i>{A=ASCII 65, etc}
    </i></font>Drv<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]  := </font>Ord<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">);
    </font>Drv<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]  := </font><font color="#800000">0</font><font color="#000080">;
    </font>Regs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$2906</font><font color="#000080">;          </font><font color="#008000"><i>{Dos Function 29h = Parse Filename}
    </i></font>Regs<font color="#000080">.</font>SI <font color="#000080">:= </font>Ofs<font color="#000080">(</font>Drv<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);    </font><font color="#008000"><i>{Point to drive String}
    </i></font>Regs<font color="#000080">.</font>DI <font color="#000080">:= </font>Ofs<font color="#000080">(</font>Fcb<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);    </font><font color="#008000"><i>{Point to File Control Block}
    </i></font>Regs<font color="#000080">.</font>DS <font color="#000080">:= </font>DSeg<font color="#000080">;
    </font>Regs<font color="#000080">.</font>ES <font color="#000080">:= </font>DSeg<font color="#000080">;
    </font>MsDos<font color="#000080">(</font>Regs<font color="#000080">);               </font><font color="#008000"><i>{Dos Interrupt}
    </i></font><font color="#FF0000"><b>if </b></font>Regs<font color="#000080">.</font>AL <font color="#000080">&lt;&gt; </font><font color="#800000">$FF </font><font color="#FF0000"><b>then
      </b></font>DrvList <font color="#000080">:= </font>DrvList <font color="#000080">+ </font>Chr<font color="#000080">(</font>Count <font color="#000080">+ </font><font color="#800000">64</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Available drives = '</font><font color="#000080">, </font>DrvList<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ReportDrives<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p></body>
</html>
