<html>
<head><title> "Hard Disk Search" by HAROLD MASSELINK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0121.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{I have written a program that searches for a specific directory on the
disk. The sourcecode is included. }

</i></font><font color="#FF0000"><b>program </b></font>XD<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>Dos<font color="#000080">, </font>Crt<font color="#000080">,</font>strings<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>fdir<font color="#000080">, </font>Sdir<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>Scherm     <font color="#000080">: </font>Text <font color="#000080">;
  </font>vlag <font color="#000080">: </font>byte<font color="#000080">;
  </font>ch <font color="#000080">: </font>char<font color="#000080">;
  </font>i<font color="#000080">,</font>l<font color="#000080">,</font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">;
  </font>temp<font color="#000080">,</font>found<font color="#000080">,</font>dir <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>CursorOff<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>asm
     </b></font><font color="#FF00FF">mov   ah,1                         </font><font color="#008000"><i>{ turn off cursor }
     </i></font><font color="#FF00FF">mov   cx,2304h
     int   10h
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{CursorOff}

</i></font><font color="#FF0000"><b>procedure </b></font>CursorOn<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>asm
     </b></font><font color="#FF00FF">mov   ah,1                         </font><font color="#008000"><i>{ turn off cursor }
     </i></font><font color="#FF00FF">mov   cx,0304h
     int   10h
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{CursorOn}

 </i></font><font color="#FF0000"><b>procedure </b></font>Show<font color="#000080">( </font>Direct <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">) ;
  </font><font color="#FF0000"><b>var
   </b></font><font color="#008000"><i>{
    Info must be a local parameter of Show. This way the information in the
    SearchRec is saved when a subdirectory is explored using recursion.
   }
   </i></font>Info <font color="#000080">: </font>SearchRec <font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font><font color="#008000"><i>{ We have to search the directory in Direct, build the search-path }
   </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>Direct<font color="#000080">[</font>Length<font color="#000080">(</font>Direct<font color="#000080">)] &lt;&gt; </font><font color="#800000">'\' </font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>Direct <font color="#000080">:= </font>Direct <font color="#000080">+ </font><font color="#800000">'\' </font><font color="#000080">;
   </font>ch <font color="#000080">:= </font><font color="#800000">'1'</font><font color="#000080">;
   </font>FindFirst<font color="#000080">( </font>Direct<font color="#000080">+</font><font color="#800000">'*.*'</font><font color="#000080">, </font>AnyFile<font color="#000080">, </font>Info <font color="#000080">) ;
   </font><font color="#008000"><i>{ As long as we have 'things' in the Direct directory, look at them }
   </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">( </font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
     if </b></font><font color="#000080">( (</font>Info<font color="#000080">.</font>Name <font color="#000080">&lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Info<font color="#000080">.</font>Name <font color="#000080">&lt;&gt; </font><font color="#800000">'..'</font><font color="#000080">) </font><font color="#FF0000"><b>and
          </b></font><font color="#000080">( (</font>Info<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font>Directory<font color="#000080">) = </font>Directory<font color="#000080">) )
      </font><font color="#FF0000"><b>then
       begin
        </b></font>gotoxy<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
        </font>clreol<font color="#000080">;
        </font>Write<font color="#000080">(</font>Direct<font color="#000080">+</font>Info<font color="#000080">.</font>Name<font color="#000080">) ;
         </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>l<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>fdir<font color="#000080">[</font>i<font color="#000080">] := </font>info<font color="#000080">.</font>name<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
         </font>i<font color="#000080">:= </font>StrComp<font color="#000080">(</font>fdir<font color="#000080">, </font>sDir<font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font>keypressed <font color="#FF0000"><b>then </b></font>ch <font color="#000080">:= </font>readkey<font color="#000080">;
         </font><font color="#FF0000"><b>IF </b></font>ch<font color="#000080">=</font><font color="#800000">#27 </font><font color="#FF0000"><b>THEN BEGIN
                             </b></font>writeln<font color="#000080">;
                             </font>writeln<font color="#000080">;
                             </font>Writeln<font color="#000080">(</font><font color="#800000">'  ...User Break...'</font><font color="#000080">);
                             </font>writeln<font color="#000080">;
                             </font>cursoron<font color="#000080">;
                             </font>HALT<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
                            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
                                     </b></font>found <font color="#000080">:= </font>direct<font color="#000080">+</font>info<font color="#000080">.</font>name<font color="#000080">;
                                     </font>writeln<font color="#000080">;
                                     </font>vlag <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                                     </font>break<font color="#000080">;
                                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#008000"><i>{ We will now search that directory }
        </i></font>Show<font color="#000080">(</font>Direct<font color="#000080">+</font>Info<font color="#000080">.</font>Name <font color="#000080">) ;
       </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font><font color="#008000"><i>{ Are there any more things out there ? If so, look at them }
     </i></font><font color="#FF0000"><b>if </b></font>vlag <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>break<font color="#000080">;
     </font>FindNext<font color="#000080">( </font>Info <font color="#000080">) ;
    </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>help<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>writeln<font color="#000080">;
</font>writeln<font color="#000080">(</font><font color="#800000">'Syntax : XD.EXE [dir]'</font><font color="#000080">);
</font>writeln<font color="#000080">;
</font>cursoron<font color="#000080">;
</font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>begin
 </b></font>cursoroff<font color="#000080">;
 </font>vlag <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>found <font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">;
 </font>dir <font color="#000080">:= </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
 </font>l <font color="#000080">:= </font>length<font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
 </font>Writeln<font color="#000080">;
 </font>WRITELN <font color="#000080">(</font><font color="#800000">' X'</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">68</font><font color="#000080">),</font><font color="#800000">' v1.3 By '</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">72</font><font color="#000080">),</font><font color="#800000">'arol'</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">),</font><font color="#800000">'M'</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">97</font><font color="#000080">),</font><font color="#800000">'ss'</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">101</font><font color="#000080">),</font><font color="#800000">'link '</font><font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font>paramcount<font color="#000080">&lt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>help<font color="#000080">;
</font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>l <font color="#FF0000"><b>do
  begin
   </b></font>dir<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] := </font>UpCase<font color="#000080">(</font>dir<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]);
   </font>sdir<font color="#000080">[</font>i<font color="#000080">] := </font>dir<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>Writeln<font color="#000080">;
 </font>writeln <font color="#000080">(</font><font color="#800000">'  Searching for  : ['</font><font color="#000080">,</font>DIR<font color="#000080">,</font><font color="#800000">'*]'</font><font color="#000080">);;
 </font>Write <font color="#000080">(</font><font color="#800000">'  Current : '</font><font color="#000080">);
 </font>x <font color="#000080">:= </font>wherex<font color="#000080">;
 </font>y <font color="#000080">:= </font>wherey<font color="#000080">;
 </font>GetDir<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>temp<font color="#000080">);
 </font>show<font color="#000080">(</font>temp<font color="#000080">);
 </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font>vlag<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>chdir<font color="#000080">(</font>found<font color="#000080">) </font><font color="#FF0000"><b>else begin
                                   </b></font>chdir<font color="#000080">(</font>temp<font color="#000080">);
                                   </font>writeln<font color="#000080">;
                                   </font>clreol<font color="#000080">;
                                   </font>Writeln<font color="#000080">(</font><font color="#800000">'  Could not find : ['</font><font color="#000080">,</font>Dir<font color="#000080">,</font><font color="#800000">'*]'</font><font color="#000080">);
                                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font>writeln<font color="#000080">;
 </font>cursoron<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.



</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0121.PAS">Original</a><b>]</b></p></body>
</html>
