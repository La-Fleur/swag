<html>
<head><title> "Get Drive Parameters" by MARCO MILTENBURG</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Author : MARCO MILTENBURG

Here's an overview of INT13h, Function 8 :

Name  : Get drive parameters

Input : AH = 08h
        DL = &lt;drive&gt;   00h - 7Fh : Floppy disk
                       80h - FFh : Harddisk

Output: if succesfull
        -------------
        Carry is cleared
        BL = &lt;driveType&gt;    01 : 360 KBytes, 40 tracks, 5.25 Inch
                            02 : 1,2 MBytes, 80 tracks, 5.25 Inch
                            03 : 720 KBytes, 80 tracks, 3.5 Inch
                            04 : 1,44 MBytes, 80 tracks, 3,5 Inch
        CH = Lower 8 bits of maximum cylindernumber
        CL = bits 6-7 : Highest 2 bits of maximum cylindernumber
             bits 0-5 : Maximum sectornumber
        DH = Maximum headnumber
        DL = Number of connected drives
        ES:DI = Pointer to disk drive parameter table

        if failed
        ---------
        Carry is set
        AH = errorstatus

As you can see, you must do more to get the cylindernumber. Here's a little
pascal code :
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>DriveTypes <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">18</font><font color="#000080">] = (</font><font color="#800000">'Harddisk          '</font><font color="#000080">,
                                            </font><font color="#800000">'360 kB - 5.25 Inch'</font><font color="#000080">,
                                            </font><font color="#800000">'1.2 MB - 5.25 Inch'</font><font color="#000080">,
                                            </font><font color="#800000">'720 kB - 3.5 Inch '</font><font color="#000080">,
                                            </font><font color="#800000">'1.44 MB - 3.5 Inch'</font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>Regs      <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$08</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>DL <font color="#000080">:= </font><font color="#800000">$80</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$13</font><font color="#000080">, </font>Regs<font color="#000080">);

  </font>WriteLn <font color="#000080">(</font><font color="#800000">'DriveType : '</font><font color="#000080">, </font>DriveTypes<font color="#000080">[</font>Regs<font color="#000080">.</font>BL<font color="#000080">]);
  </font>WriteLn <font color="#000080">(</font><font color="#800000">'Cylinders : '</font><font color="#000080">, </font><font color="#800000">256 </font><font color="#000080">* (</font>Regs<font color="#000080">.</font>CL <font color="#FF0000"><b>SHR </b></font><font color="#800000">6</font><font color="#000080">) + </font>Regs<font color="#000080">.</font>CH <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
  </font>WriteLn <font color="#000080">(</font><font color="#800000">'Sectors   : '</font><font color="#000080">, </font>Regs<font color="#000080">.</font>CL <font color="#FF0000"><b>and </b></font><font color="#800000">$3F</font><font color="#000080">);
  </font>WriteLn <font color="#000080">(</font><font color="#800000">'Heads     : '</font><font color="#000080">, </font>Regs<font color="#000080">.</font>DH <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#008000"><i>{
This will give you the right information from your diskdrives. I noticed that
my harddisks will always be reported as driveType 0 (zero). I don't know for
sure if that is documented, but it seems to be logical ;-).
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p></body>
</html>
