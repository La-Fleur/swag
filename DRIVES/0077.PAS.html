<html>
<head><title> "Drive Detection" by ANDREW EIGUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 SA&gt; Does anyone have any idea of how I can check the system hardware and
 SA&gt; identify available hard drives and disk drives?
}



</i></font><font color="#FF0000"><b>const
  </b></font><font color="#008000"><i>{ GetDriveType return values.  REQUIRES DOS 3.x or greater}

  </i></font>dtError     <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{ Drive physically isn't available }
  </i></font>dtRemote    <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{ Remote (network) disk drive }
  </i></font>dtFixed     <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">; </font><font color="#008000"><i>{ Fixed (hard) disk drive }
  </i></font>dtRemovable <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">; </font><font color="#008000"><i>{ Removable (floppy) disk drive }
  </i></font>dtBadVer    <font color="#000080">= </font><font color="#800000">$FF</font><font color="#000080">; </font><font color="#008000"><i>{ Invalid DOS version (DOS 3.x required) }


</i></font><font color="#FF0000"><b>Function </b></font>GetDriveType<font color="#000080">(</font>Drive <font color="#000080">: </font>byte<font color="#000080">) : </font>byte<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV AH,30h
  INT 21h
  CMP AL,3
  JGE @@1
  MOV AL,dtBadVer
  JMP @@4
@@1:
  MOV BL,Drive
  MOV AX,4409h
  INT 21h
  JNC @@2
  MOV AL,dtError
  JMP @@5
@@2:
  CMP AL,True
  JNE @@3
  MOV AL,dtRemote
  JMP @@5
@@3:
  MOV AX,4408h
  INT 21h
  CMP AL,True
  JNE @@4
  MOV AL,dtFixed
  JMP @@5
@@4:
  MOV AL,dtRemovable
@@5:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ GetDriveType }

</i></font><font color="#FF0000"><b>var
  </b></font>Drive <font color="#000080">: </font>byte<font color="#000080">;
  </font>DT <font color="#000080">: </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  for </b></font>Drive <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">25 </font><font color="#FF0000"><b>do
  begin
    </b></font>DT <font color="#000080">:= </font>GetDriveType<font color="#000080">(</font>Drive<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>DT <font color="#000080">&lt;&gt; </font>dtError <font color="#FF0000"><b>then
    begin
      </b></font>Write<font color="#000080">(</font><font color="#800000">'Drive '</font><font color="#000080">, </font>Chr<font color="#000080">(</font>Drive <font color="#000080">+ </font><font color="#800000">64</font><font color="#000080">), </font><font color="#800000">': '</font><font color="#000080">);
      </font><font color="#FF0000"><b>case </b></font>DT <font color="#FF0000"><b>of
        </b></font>dtRemote<font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Network drive'</font><font color="#000080">);
        </font>dtFixed<font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Hard disk'</font><font color="#000080">);
        </font>dtRemovable<font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Floppy drive'</font><font color="#000080">)
      </font><font color="#FF0000"><b>end
    end
  end
End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p></body>
</html>
