<html>
<head><title> "ASM Drive Valid Function" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0070.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>function </b></font>DriveValid<font color="#000080">(</font>Drive<font color="#000080">: </font>Char<font color="#000080">): </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov   ah, 19h     </font><font color="#008000"><i>{ Select DOS function 19h }
    </i></font><font color="#FF00FF">int   21h         </font><font color="#008000"><i>{ Call DOS for current disk drive }
    </i></font><font color="#FF00FF">mov   bl, al      </font><font color="#008000"><i>{ Save drive code in bl }
    </i></font><font color="#FF00FF">mov   al, Drive   </font><font color="#008000"><i>{ Assign requested drive to al }
    </i></font><font color="#FF00FF">sub   al, 'A'     </font><font color="#008000"><i>{ Adjust so A:=0, B:=1, etc. }
    </i></font><font color="#FF00FF">mov   dl, al      </font><font color="#008000"><i>{ Save adjusted result in dl }
    </i></font><font color="#FF00FF">mov   ah, 0eh     </font><font color="#008000"><i>{ Select DOS function 0eh }
    </i></font><font color="#FF00FF">int   21h         </font><font color="#008000"><i>{ Call DOS to set default drive }
    </i></font><font color="#FF00FF">mov   ah, 19h     </font><font color="#008000"><i>{ Select DOS function 19h }
    </i></font><font color="#FF00FF">int   21h         </font><font color="#008000"><i>{ Get current drive again }
    </i></font><font color="#FF00FF">mov   cx, 0       </font><font color="#008000"><i>{ Preset result to False }
    </i></font><font color="#FF00FF">cmp   al, dl      </font><font color="#008000"><i>{ Check if drives match }
    </i></font><font color="#FF00FF">jne   @@1         </font><font color="#008000"><i>{ Jump if not--drive not valid }
    </i></font><font color="#FF00FF">mov   cx, 1       </font><font color="#008000"><i>{ Preset result to True }
</i></font><font color="#FF00FF">@@1:
    mov   dl, bl      </font><font color="#008000"><i>{ Restore original default drive }
    </i></font><font color="#FF00FF">mov   ah, 0eh     </font><font color="#008000"><i>{ Select DOS function 0eh }
    </i></font><font color="#FF00FF">int   21h         </font><font color="#008000"><i>{ Call DOS to set default drive }
    </i></font><font color="#FF00FF">xchg  ax, cx      </font><font color="#008000"><i>{ Return function result in ax }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0070.PAS">Original</a><b>]</b></p></body>
</html>
