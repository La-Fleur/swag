<html>
<head><title> "Return Letter of CDROM drive" by ERWIN PAGUIO</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0112.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
The returned value of FirstDrive is an unsigned integer where 0 = 'A', 1 = 'B',

and so on.  So to get the actual drive letter you use:

   FirstDriveLetter := Chr(FirstDrive + Ord('A'));

   LastDriveLetter  := Chr(FirstDrive + NumDrives + Ord('A'));

}

</i></font><font color="#FF0000"><b>Function </b></font>CheckCDROMDrives<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>FirstDrive<font color="#000080">, </font>NumDrives <font color="#000080">: </font>Word<font color="#000080">):</font>Boolean<font color="#000080">;</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;

</font><font color="#FF0000"><b>ASM
    </b></font><font color="#FF00FF">XOR  BX, BX           </font><font color="#008000"><i>{ zero out BX to check availability of function }
    </i></font><font color="#FF00FF">MOV  AX, 1500h        </font><font color="#008000"><i>{ get no. of CDROM drive letters                }
    </i></font><font color="#FF00FF">INT  2Fh              </font><font color="#008000"><i>{ BX = count,  CX = first                       }
    </i></font><font color="#FF00FF">OR   BX, BX           </font><font color="#008000"><i>{ was BX modified?                              }
    </i></font><font color="#FF00FF">JZ   @Error           </font><font color="#008000"><i>{ if not, then no MSCDEX driver installed       }
    </i></font><font color="#FF00FF">LES  DI, FirstDrive
    MOV  ES:[DI], CX      </font><font color="#008000"><i>{ device number of first drive                  }
    </i></font><font color="#FF00FF">LES  DI, NumDrives
    MOV  ES:[DI], BX      </font><font color="#008000"><i>{ number of CD drives                           }
    </i></font><font color="#FF00FF">MOV  AL, Byte(True)
    JMP  @Exit
 @Error:
    XOR  AX, AX
    LES  DI, FirstDrive
    MOV  ES:[DI], AX
    LES  DI, NumDrives
    MOV  ES:[DI], AX
    MOV  AL, Byte(False)
 @Exit:
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0112.PAS">Original</a><b>]</b></p></body>
</html>
