<html>
<head><title> "How can I detect a CD drive?" by JOHN NEWLIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0117.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>unit </b></font>DetectCD<font color="#000080">;

</font><font color="#008000"><i>(*
  Detects whether or not a system drive is a CD-ROM or
  not.  Use with either version of Delphi.

  by John Newlin CIS 71535,665
*)

</i></font><font color="#FF0000"><b>interface
uses
  </b></font><font color="#008000"><i>{$IFDEF VER80}
  </i></font>WinProcs<font color="#000080">, </font>WinTypes<font color="#000080">,
  </font><font color="#008000"><i>{$ELSE}
  </i></font>Windows<font color="#000080">,
  </font><font color="#008000"><i>{$ENDIF}
  </i></font>SysUtils<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>IsCdRom<font color="#000080">(</font>DriveLetter<font color="#000080">:</font>char<font color="#000080">):</font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$IFDEF VER80}

</i></font><font color="#FF0000"><b>function </b></font>IsCdRom<font color="#000080">(</font>DriveLetter<font color="#000080">:</font>char<font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>DriveNum<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result <font color="#000080">:= </font>false<font color="#000080">;
  </font>DriveNum <font color="#000080">:= </font>ord<font color="#000080">(</font>UpCase<font color="#000080">(</font>DriveLetter<font color="#000080">))-</font><font color="#800000">65</font><font color="#000080">;
  </font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">MOV   AX,1500h </font><font color="#008000"><i>{ look for MSCDEX }
  </i></font><font color="#FF00FF">XOR   BX,BX
  INT   2fh
  OR    BX,BX
  JZ    @Finish
  MOV   AX,150Bh </font><font color="#008000"><i>{ check for using CD driver }
  </i></font><font color="#FF00FF">MOV   CX,DriveNum

  INT   2fh
  OR    AX,AX
  @Finish:
  mov   Result,Al
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$ELSE}

</i></font><font color="#FF0000"><b>function </b></font>IsCdRom<font color="#000080">(</font>DriveLetter<font color="#000080">:</font>char<font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>Const
  </b></font>RootPath <font color="#000080">: </font>pAnsiChar <font color="#000080">= </font><font color="#800000">'X:\'</font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RootPath<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>DriveLetter<font color="#000080">;
  </font>Result <font color="#000080">:= </font>IsCdRom<font color="#000080">(</font>RootPath<font color="#000080">) = </font>DRIVE_CDROM<font color="#000080">; </font><font color="#008000"><i>{5}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$ENDIF}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0117.PAS">Original</a><b>]</b></p></body>
</html>
