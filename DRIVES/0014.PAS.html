<html>
<head><title> "Find LASTDRIVE in ASM" by CHRIS PRIEDE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Function </b></font>LastDrive<font color="#000080">: </font>Char<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">mov   ah, 19h
  int   21h
  push  ax            </font><font color="#008000"><i>{ save default drive }
  </i></font><font color="#FF00FF">mov   ah, 0Eh
  mov   dl, 19h
  int   21h
  mov   cl, al
  dec   cx
@@CheckDrive:
  mov   ah, 0Eh       </font><font color="#008000"><i>{ check if drive valid }
  </i></font><font color="#FF00FF">mov   dl, cl
  int   21h
  mov   ah, 19h
  int   21h
  cmp   cl, al
  je    @@Valid
  dec   cl            </font><font color="#008000"><i>{ check next lovest drive number }
  </i></font><font color="#FF00FF">jmp   @@CheckDrive
@@Valid:
  pop   ax
  mov   dl, al
  mov   ah, 0Eh
  int   21h           </font><font color="#008000"><i>{ restore default drive }
  </i></font><font color="#FF00FF">mov   al, cl
  add   al, 'A'
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>(*
LastDrive will return letter of the last valid drive. To check
if the drive letter entered is valid:

if Upcase(DriveLetter) &lt;= LastDrive
   then {valid drive}
   else {bad drive};
*)</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p></body>
</html>
