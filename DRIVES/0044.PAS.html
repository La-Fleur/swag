<html>
<head><title> "Available Drives" by KENT BRIGGS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0044.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
===========================================================================
 BBS: Canada Remote Systems
Date: 08-29-93 (15:41)             Number: 36579
From: KENT BRIGGS                  Refer#: NONE
  To: HOWARD HUANG                  Recvd: NO
Subj: CHECK AVAILABLE DRIVES         Conf: (1221) F-PASCAL
---------------------------------------------------------------------------
 -=&gt; Quoting Howard Huang to All &lt;=-

 HH&gt; Does anyone know how to check if a drive is valid without accessing
 HH&gt; it to see? For example, if the available drives on a system are: A, B,
 HH&gt; C, E. How do you check if drive A is installed without having the
 HH&gt; floppy drive lights go on. I use TP6, so if you include a sample code,
 HH&gt; could you make it compatible with it.

 Howard, here's what I use:
*)
</i></font><font color="#FF0000"><b>program </b></font>show_drives<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>reg<font color="#000080">: </font>registers<font color="#000080">;
  </font>drv<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>drvlist<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">26</font><font color="#000080">];
  </font>fcb<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">37</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>i<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>drvlist<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">26 </font><font color="#FF0000"><b>do         </b></font><font color="#008000"><i>{Try drives A..Z}
  </i></font><font color="#FF0000"><b>begin
    </b></font>drv<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>i<font color="#000080">+</font><font color="#800000">64</font><font color="#000080">;           </font><font color="#008000"><i>{A=ASCII 65, etc}
    </i></font>drv<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font>ord<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">);
    </font>drv<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
    </font>reg<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$2906</font><font color="#000080">;          </font><font color="#008000"><i>{DOS function 29h = Parse Filename}
    </i></font>reg<font color="#000080">.</font>si<font color="#000080">:=</font>ofs<font color="#000080">(</font>drv<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);    </font><font color="#008000"><i>{Point to drive string}
    </i></font>reg<font color="#000080">.</font>di<font color="#000080">:=</font>ofs<font color="#000080">(</font>fcb<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);    </font><font color="#008000"><i>{Point to File Control Block}
    </i></font>reg<font color="#000080">.</font>ds<font color="#000080">:=</font>dseg<font color="#000080">;
    </font>reg<font color="#000080">.</font>es<font color="#000080">:=</font>dseg<font color="#000080">;
    </font>msdos<font color="#000080">(</font>reg<font color="#000080">);             </font><font color="#008000"><i>{DOS Interrupt}
    </i></font><font color="#FF0000"><b>if </b></font>reg<font color="#000080">.</font>al<font color="#000080">&lt;&gt;</font><font color="#800000">$ff </font><font color="#FF0000"><b>then </b></font>drvlist<font color="#000080">:=</font>drvlist<font color="#000080">+</font>chr<font color="#000080">(</font>i<font color="#000080">+</font><font color="#800000">64</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'Available drives = '</font><font color="#000080">,</font>drvlist<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>___ Blue Wave<font color="#000080">/</font>QWK v2<font color="#000080">.</font><font color="#800000">12
</font><font color="#000080">--- </font>Renegade v07<font color="#000080">-</font><font color="#800000">17 </font>Beta
 <font color="#000080">* </font>Origin<font color="#000080">: </font>Snipe<font color="#800000">'s Castle BBS, Waco TX   (817)-757-0169 (1:388/26)
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0044.PAS">Original</a><b>]</b></p></body>
</html>
