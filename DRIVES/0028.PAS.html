<html>
<head><title> "Get Device Type" by JOSE ALMEIDA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0028.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ Gets the device type.
  Part of the Heartware Toolkit v2.00 (HTdisk.PAS) for Turbo Pascal.
  Author: Jose Almeida. P.O.Box 4185. 1504 Lisboa Codex. Portugal.
          I can also be reached at RIME network, site -&gt;TIB or #5314.
  Feel completely free to use this source code in any way you want, and, if
  you do, please don't forget to mention my name, and, give me and Swag the
  proper credits. }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>dpDevType<font color="#000080">(</font>Drive <font color="#000080">: </font>byte<font color="#000080">;
          </font><font color="#FF0000"><b>var </b></font>Device_Type <font color="#000080">: </font>byte<font color="#000080">;
           </font><font color="#FF0000"><b>var </b></font>Error_Code <font color="#000080">: </font>byte<font color="#000080">);

</font><font color="#008000"><i>{ DESCRIPTION:
    Gets the device type.
  SAMPLE CALL:
    dpDevType(1,Device_Type,Error_Code);
  ON ENTRY:
    Drive:
      1 : drive A:
      2 : drive B:
      and so on...
  RETURNS:
    Device_Type :
      0 : 320/360 KBytes floppy
      1 : 1.2 MBytes floppy
      2 : 720 KBytes floppy
      3 : 8&quot; single density floppy
      4 : 8&quot; double density floppy
      5 : hard disk
      6 : tape drive
      7 : 1.44 MBytes floppy
      8 : read/write optiocal disk
      9 : 2.88 MBytes floppy
      else : unknown device type
    Error_Code:
      0 : no error
      else : error number (see The PC Programmers Source Book 3.191)
  NOTES:
    Applies to all DOS versions beginning with v3.3.
    See dpDevType_Text() in order to get a string text. }

</i></font><font color="#FF0000"><b>var
  </b></font>TmpA   <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">31</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>HTregs <font color="#000080">: </font>registers<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{ dpDevType }
  </i></font>HTregs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$440D</font><font color="#000080">;
  </font>HTregs<font color="#000080">.</font>BX <font color="#000080">:= </font>word<font color="#000080">(</font>Drive<font color="#000080">);
  </font>HTregs<font color="#000080">.</font>CX <font color="#000080">:= </font><font color="#800000">$0860</font><font color="#000080">;
  </font>HTregs<font color="#000080">.</font>DX <font color="#000080">:= </font>Ofs<font color="#000080">(</font>TmpA<font color="#000080">);
  </font>HTregs<font color="#000080">.</font>DS <font color="#000080">:= </font>Seg<font color="#000080">(</font>TmpA<font color="#000080">);
  </font>MsDos<font color="#000080">(</font>HTregs<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>HTregs<font color="#000080">.</font>Flags <font color="#FF0000"><b>and </b></font>FCarry <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>Device_Type <font color="#000080">:= </font><font color="#800000">$FF</font><font color="#000080">;          </font><font color="#008000"><i>{ on error returns unknown device type }
      </i></font>Error_Code <font color="#000080">:= </font>HTregs<font color="#000080">.</font>AL
    <font color="#FF0000"><b>end
  else
    begin
      </b></font>Device_Type <font color="#000080">:= </font>TmpA<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
      </font>Error_Code <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ dpDevType }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DRIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0028.PAS">Original</a><b>]</b></p></body>
</html>
