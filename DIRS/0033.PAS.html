<html>
<head><title> "Recursive Directory" by DAVE JARVIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0033.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 On 05-25-94 ROBERT HARRISON wrote to ALL...

 RH&gt;   I'm trying to obtain the source for searching for files in all
 RH&gt; directories and drives.  Anyone happened to have the information
 RH&gt; they would like to share with me?  Thanks.

----------------- 8&lt; ------------- }

</i></font><font color="#FF0000"><b>USES </b></font>DOS<font color="#000080">, </font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Search<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>Err     <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>Attrib<font color="#000080">,
  </font>CurrDir <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
  </font>DirInfo <font color="#000080">: </font>SearchRec<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>FindFirst<font color="#000080">( </font><font color="#800000">'*.*'</font><font color="#000080">, </font>AnyFile<font color="#000080">, </font>DirInfo <font color="#000080">);

  </font>Err <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#FF0000"><b>WHILE </b></font>Err <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
  Begin
    </b></font><font color="#008000"><i>{ If the directory wasn't . or .., then find all files in it ... }
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>DirInfo<font color="#000080">.</font>Attr <font color="#FF0000"><b>AND </b></font>Directory<font color="#000080">) = </font>Directory<font color="#000080">) </font><font color="#FF0000"><b>AND
       </b></font><font color="#000080">(</font>Pos<font color="#000080">( </font><font color="#800000">'.'</font><font color="#000080">, </font>DirInfo<font color="#000080">.</font>Name <font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    Begin
      </b></font><font color="#008000"><i>{$I-}
      </i></font>ChDir<font color="#000080">( </font>DirInfo<font color="#000080">.</font>Name <font color="#000080">);
      </font><font color="#008000"><i>{$I+}

      { Find all files in subdirectory that was found }
      </i></font>Search<font color="#000080">;
      </font>DirInfo<font color="#000080">.</font>Attr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>End
    ELSE
    Begin
      </b></font>GetDir<font color="#000080">( </font><font color="#800000">0</font><font color="#000080">, </font>CurrDir <font color="#000080">);
      </font>WriteLn<font color="#000080">( </font>DirInfo<font color="#000080">.</font>Name <font color="#000080">);
      </font>FindNext<font color="#000080">( </font>DirInfo <font color="#000080">);

      </font>Err <font color="#000080">:= </font>DosError<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#008000"><i>{$I-}
  </i></font>ChDir<font color="#000080">( </font><font color="#800000">'..' </font><font color="#000080">);
  </font><font color="#008000"><i>{$I+}

  </i></font><font color="#FF0000"><b>IF </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
    </b></font><font color="#008000"><i>{ Do Nothing...probably root directory... }</i></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>CurDir <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>ClrScr<font color="#000080">;
  </font>GetDir<font color="#000080">( </font><font color="#800000">0</font><font color="#000080">, </font>CurDir <font color="#000080">);
  </font>ChDir<font color="#000080">( </font><font color="#800000">'C:\' </font><font color="#000080">);
  </font>Search<font color="#000080">;
  </font>ChDir<font color="#000080">( </font>CurDir <font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0033.PAS">Original</a><b>]</b></p></body>
</html>
