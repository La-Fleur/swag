<html>
<head><title> "GIF Directory" by PHIL OVERMAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>GIFDIR<font color="#000080">(</font>Input<font color="#000080">, </font>Output<font color="#000080">);

</font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">, </font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>ProSoft <font color="#000080">= </font><font color="#800000">' Gif DIRectory - Version 2.0 (C) ProSoft '</font><font color="#000080">+</font>Chr<font color="#000080">(</font><font color="#800000">254</font><font color="#000080">)+</font><font color="#800000">' Phil R. Overman 02-02-92'</font><font color="#000080">;
  </font>gifliteheader                       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">)+</font>chr<font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">)+</font>chr<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">)+</font><font color="#800000">'GIFLITE'</font><font color="#000080">;
  </font>giflitesearch                       <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;
  </font>ScreenLines                         <font color="#000080">= </font><font color="#800000">23</font><font color="#000080">;
  </font>Maxlinelength                       <font color="#000080">= </font><font color="#800000">80</font><font color="#000080">;
  </font>test0                               <font color="#000080">= </font>false<font color="#000080">;
  </font>test1                               <font color="#000080">= </font>true<font color="#000080">;
</font><font color="#008000"><i>(*
    {$I-}
*)
</i></font><font color="#FF0000"><b>Type
  </b></font>String12                            <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
  </font>LineType                            <font color="#000080">= </font><font color="#FF0000"><b>Packed Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Maxlinelength<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>LengthType                          <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">..</font>Maxlinelength<font color="#000080">;
  </font>String2                             <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font>String3                             <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>String8                             <font color="#000080">= </font><font color="#FF0000"><b>Packed Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#008000"><i>{ String12                            = Packed Array[1..12] of char; }
  </i></font>String15                            <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">15</font><font color="#000080">];

</font><font color="#FF0000"><b>Var
  </b></font>dodate<font color="#000080">, </font>dotime<font color="#000080">, </font>domegs<font color="#000080">, </font>doextension <font color="#000080">: </font>boolean<font color="#000080">;
  </font>doversion<font color="#000080">, </font>dopalette<font color="#000080">, </font>doGCT         <font color="#000080">: </font>boolean<font color="#000080">;
  </font>dofiledot<font color="#000080">, </font>doall<font color="#000080">, </font>dogiflite         <font color="#000080">: </font>boolean<font color="#000080">;
  </font>CmtFound<font color="#000080">, </font>Pause<font color="#000080">, </font>ShowZips<font color="#000080">, </font>isgif    <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>CmtSize<font color="#000080">, </font>FileCount<font color="#000080">, </font>LinesWritten    <font color="#000080">: </font>Word<font color="#000080">;
  </font>attr<font color="#000080">, </font>height<font color="#000080">, </font>width<font color="#000080">, </font>colors         <font color="#000080">: </font>Word<font color="#000080">;
  </font>fileattr                            <font color="#000080">: </font>word<font color="#000080">;
  </font>TotalSize<font color="#000080">, </font>position                 <font color="#000080">: </font>Longint<font color="#000080">;
  </font>filesize<font color="#000080">, </font>filedate                  <font color="#000080">: </font>longint<font color="#000080">;
  </font>icount<font color="#000080">, </font>jcount                      <font color="#000080">: </font>integer<font color="#000080">;
  </font>count<font color="#000080">, </font>clen                         <font color="#000080">: </font>Byte<font color="#000080">;
  </font>megs                                <font color="#000080">: </font>real<font color="#000080">;
  </font>DirInfo<font color="#000080">, </font>gifdirinfo                 <font color="#000080">: </font>Searchrec<font color="#000080">;
  </font>Path<font color="#000080">, </font>Gifpath<font color="#000080">, </font>filein               <font color="#000080">: </font>PathStr<font color="#000080">;
  </font>Dir                                 <font color="#000080">: </font>DirStr<font color="#000080">;
  </font>Name<font color="#000080">, </font>infdatestring<font color="#000080">, </font>gifname        <font color="#000080">: </font>NameStr<font color="#000080">;
  </font>Ext                                 <font color="#000080">: </font>ExtStr<font color="#000080">;
  </font>A<font color="#000080">, </font>B<font color="#000080">, </font>C<font color="#000080">, </font>cc<font color="#000080">, </font>ch<font color="#000080">, </font>eoname             <font color="#000080">: </font>Char<font color="#000080">;
  </font>Abyte                               <font color="#000080">: </font>Byte<font color="#000080">;
  </font>cs                                  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
  </font>meg                                 <font color="#000080">: </font>String2<font color="#000080">;
  </font>gversion<font color="#000080">, </font>gheader                   <font color="#000080">: </font>String3<font color="#000080">;
  </font>filename                            <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
  </font>infile<font color="#000080">, </font>outfile                     <font color="#000080">: </font>text<font color="#000080">;
  </font>giffile                             <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
  </font>infdt<font color="#000080">, </font>filedt                       <font color="#000080">: </font>datetime<font color="#000080">;
  </font>giffilein                           <font color="#000080">: </font>String15<font color="#000080">;
  </font>Drive                               <font color="#000080">: </font>String2<font color="#000080">;
  </font>GCTF                   <font color="#008000"><i>{1 Bit}      </i></font><font color="#000080">: </font>boolean<font color="#000080">;
  </font>ColorResolution        <font color="#008000"><i>{3 Bits}     </i></font><font color="#000080">: </font>byte<font color="#000080">;
  </font>SortFlag               <font color="#008000"><i>{1 Bit}      </i></font><font color="#000080">: </font>boolean<font color="#000080">;
  </font>SizeOfGCT              <font color="#008000"><i>{3 Bits}     </i></font><font color="#000080">: </font>byte<font color="#000080">;
  </font>giflite                             <font color="#000080">: </font>boolean<font color="#000080">;
  </font>BackgroundColorIndex                <font color="#000080">: </font>Byte<font color="#000080">;
  </font>PixelAspectRatio                    <font color="#000080">: </font>Byte<font color="#000080">;
  </font>SizeofPalette                       <font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#008000"><i>{ Cmt                                 : CmtType; }
(***************************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>BadParms<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">' Program syntax: GDIR [d:\Path][Filename[.GIF]] [/p/a/d/t/m/f/v/g/r/?|h]'</font><font color="#000080">);
</font><font color="#008000"><i>{  writeln; }
  </i></font>writeln<font color="#000080">(</font><font color="#800000">' Displays standard DOS DIR of GIF files, but with height, width, and colors'</font><font color="#000080">);
</font><font color="#008000"><i>{  writeln; }
  </i></font>writeln<font color="#000080">(</font><font color="#800000">' Output looks like this (with no parameters):'</font><font color="#000080">);
</font><font color="#008000"><i>{  writeln; }
  </i></font>writeln<font color="#000080">(</font><font color="#800000">' GIFNAME  GIF   178152   5-11-91  640h 400w 256c'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font><font color="#008000"><i>{ writeln('Enter *.* to display all files (normal Dir).'); }
  </i></font>writeln<font color="#000080">(</font><font color="#800000">' Parameters:'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /P Pauses the display, just as in the DOS Dir command.'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /A Displays complete information, except time.'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /D turns display of the file Date off.'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /T turns display of the file Time on.'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /M shows size in Megabytes instead of bytes.'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /F displays GIFNAME.GIF instead of GIFNAME  GIF'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /E suppress display of the extension.'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /G Check if file optimized by GIFLITE and display it if so.'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /V displays the Version of the GIF file - GIF87a, GIF89a, etc.'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /C displays &quot;GCM&quot; if the file has a Global Color Map'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /R Resolution - displays the total number of colors in the pallette'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">' /H or /? displays this Help screen.'</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Doserror <font color="#000080">&gt;  </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>writeln<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Doserror <font color="#000080">= </font><font color="#800000">18 </font><font color="#FF0000"><b>then </b></font>Writeln<font color="#000080">(</font><font color="#800000">' File not found'</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Doserror <font color="#000080">=  </font><font color="#800000">3 </font><font color="#FF0000"><b>then </b></font>writeln<font color="#000080">(</font><font color="#800000">' Path not found'</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Doserror <font color="#000080">&gt;  </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>writeln<font color="#000080">;
  </font>halt<font color="#000080">(</font><font color="#800000">98</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>FlipB<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>f <font color="#000080">: </font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  If </b></font>f <font color="#FF0000"><b>then </b></font>f <font color="#000080">:= </font>false <font color="#FF0000"><b>else </b></font>f <font color="#000080">:= </font>true<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>ProcessParms<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>sr <font color="#000080">: </font>searchrec<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font><font color="#000080">(</font>pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>s<font color="#000080">) = </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then
    Begin
      If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'P'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'p'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Pause <font color="#000080">:= </font>true<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'D'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'d'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Flipb<font color="#000080">(</font>dodate<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'T'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'t'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Flipb<font color="#000080">(</font>dotime<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'M'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'m'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Flipb<font color="#000080">(</font>domegs<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'F'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'f'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Flipb<font color="#000080">(</font>dofiledot<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'V'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'v'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Flipb<font color="#000080">(</font>doversion<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'R'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'r'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Flipb<font color="#000080">(</font>dopalette<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'G'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'g'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Flipb<font color="#000080">(</font>dogiflite<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'C'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'c'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Flipb<font color="#000080">(</font>doGCT<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'E'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'e'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Flipb<font color="#000080">(</font>doextension<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'A'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'a'</font><font color="#000080">) </font><font color="#FF0000"><b>then
        Begin
          </b></font>Flipb<font color="#000080">(</font>doall<font color="#000080">);
          </font>dodate <font color="#000080">:= </font>true<font color="#000080">; </font>dotime <font color="#000080">:= </font>false<font color="#000080">; </font>dofiledot <font color="#000080">:= </font>false<font color="#000080">;
          </font>domegs <font color="#000080">:= </font>false<font color="#000080">; </font>doversion <font color="#000080">:= </font>true<font color="#000080">; </font>dopalette <font color="#000080">:= </font>false<font color="#000080">;
          </font>doGCT <font color="#000080">:= </font>true<font color="#000080">; </font>doextension <font color="#000080">:= </font>true<font color="#000080">; </font>dogiflite <font color="#000080">:= </font>true<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'H'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'h'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'?'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Badparms<font color="#000080">;
    </font><font color="#FF0000"><b>End
  Else
    Begin
      </b></font>Path <font color="#000080">:= </font>FExpand<font color="#000080">(</font>s<font color="#000080">);
</font><font color="#008000"><i>{      If Copy(Path,Length(Path),1) = '\' then Path := Path + '*.GIF'; }
{      If Pos('.',path) = 0 then path := path + '.GIF'; }
{      If Pos('*',Path) + Pos('?',path) + Pos('.GIF',path) = 0
        then
          begin
            FindFirst(Path,$10,sr);
            If Doserror = 0 then Path := Path + '\*.gif';
          end; }
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(*******************)
</i></font><font color="#FF0000"><b>Function </b></font>Exponential<font color="#000080">(</font>A<font color="#000080">:</font>integer<font color="#000080">; </font>B<font color="#000080">:</font>byte<font color="#000080">):</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>yyy <font color="#000080">: </font>longint<font color="#000080">;
</font><font color="#008000"><i>(* Returns A to the Bth *)
</i></font><font color="#FF0000"><b>Begin
  </b></font>yyy <font color="#000080">:= </font>A<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>count <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>B <font color="#FF0000"><b>Do </b></font>yyy <font color="#000080">:= </font>yyy <font color="#000080">* </font>A<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>b<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Exponential <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>else </b></font>Exponential <font color="#000080">:= </font>yyy<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(**********************************)
</i></font><font color="#FF0000"><b>Function </b></font>BV<font color="#000080">(</font>A<font color="#000080">:</font>byte<font color="#000080">; </font>b<font color="#000080">:</font>byte<font color="#000080">):</font>byte<font color="#000080">; </font><font color="#008000"><i>{BitValue}
</i></font><font color="#FF0000"><b>var </b></font>aa <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#008000"><i>(* A is the byte value - b is the bit # for which the value is desired 1-8 *)
</i></font><font color="#FF0000"><b>Begin
  </b></font>aa <font color="#000080">:= </font>a<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>aa <font color="#000080">&gt;= </font>Exponential<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>b<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>dec<font color="#000080">(</font>aa<font color="#000080">,</font>Exponential<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>b<font color="#000080">));
  </font><font color="#FF0000"><b>If </b></font>aa <font color="#000080">&lt; </font>Exponential<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>b<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>BV <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>else </b></font>BV <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(***********************)
</i></font><font color="#FF0000"><b>Procedure </b></font>ClearName<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  For </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>do </b></font>DirInfo<font color="#000080">.</font>name<font color="#000080">[</font>count<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(**************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>ClearABC<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>A <font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">; </font>B <font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">; </font>C <font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(*******************)
{
Procedure ClearCmt;
Begin
  CmtFound := False;
  for count := 1 to MaxCmtSize do Cmt[count] := ' ';
End;
}
(*******************)
</i></font><font color="#FF0000"><b>Procedure </b></font>WriteName<font color="#000080">(</font>n <font color="#000080">: </font>String12<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>p<font color="#000080">, </font>q<font color="#000080">, </font>qq<font color="#000080">, </font>r <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>p <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;  </font>q <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;  </font>r <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>doextension <font color="#FF0000"><b>then </b></font>qq <font color="#000080">:=</font><font color="#800000">12 </font><font color="#FF0000"><b>else </b></font>qq <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>r <font color="#000080">&lt; </font>length<font color="#000080">(</font>n<font color="#000080">) </font><font color="#FF0000"><b>DO
    Begin
      </b></font>inc<font color="#000080">(</font>p<font color="#000080">);
      </font>inc<font color="#000080">(</font>r<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>n<font color="#000080">[</font>p<font color="#000080">] = </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>and not </b></font>dofiledot
        <font color="#FF0000"><b>then
          Begin
              If </b></font>p <font color="#000080">&lt; </font><font color="#800000">9 </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">-</font>p<font color="#000080">);
              </font>inc<font color="#000080">(</font>q<font color="#000080">, </font><font color="#800000">9</font><font color="#000080">-</font>p<font color="#000080">);
              </font><font color="#FF0000"><b>If </b></font>doextension <font color="#FF0000"><b>then
                Begin
                  </b></font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
                  </font>inc<font color="#000080">(</font>q<font color="#000080">);
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>End
        else
            begin
              If </b></font><font color="#000080">(</font>p<font color="#000080">&lt;</font><font color="#800000">9</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font>doextension <font color="#FF0000"><b>then
                begin
                  </b></font>write<font color="#000080">(</font>n<font color="#000080">[</font>p<font color="#000080">]);
                  </font>inc<font color="#000080">(</font>q<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>q <font color="#000080">&lt; </font>qq <font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">:</font>qq<font color="#000080">-</font>q<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(********************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>WriteDate<font color="#000080">(</font>i <font color="#000080">: </font>longint<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>d <font color="#000080">: </font>datetime<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Unpacktime<font color="#000080">(</font>i<font color="#000080">,</font>d<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>d<font color="#000080">.</font>month <font color="#000080">&gt; </font><font color="#800000">9 </font><font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font>d<font color="#000080">.</font>month<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Write<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">,</font>d<font color="#000080">.</font>month<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>d<font color="#000080">.</font>day <font color="#000080">&gt; </font><font color="#800000">9 </font><font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font>d<font color="#000080">.</font>day<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Write<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">,</font>d<font color="#000080">.</font>day<font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">,</font>d<font color="#000080">.</font>year <font color="#FF0000"><b>mod </b></font><font color="#800000">100</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(********************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>WriteTime<font color="#000080">(</font>i <font color="#000080">: </font>longint<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>d <font color="#000080">: </font>datetime<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Unpacktime<font color="#000080">(</font>i<font color="#000080">,</font>d<font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>d<font color="#000080">.</font>hour <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">'12'</font><font color="#000080">) </font><font color="#FF0000"><b>else if </b></font>d<font color="#000080">.</font>hour <font color="#FF0000"><b>mod </b></font><font color="#800000">12 </font><font color="#000080">&gt; </font><font color="#800000">9 </font><font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font>d<font color="#000080">.</font>hour <font color="#FF0000"><b>mod </b></font><font color="#800000">12</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>d<font color="#000080">.</font>hour <font color="#FF0000"><b>mod </b></font><font color="#800000">12</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>d<font color="#000080">.</font>min <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">':00'</font><font color="#000080">) </font><font color="#FF0000"><b>else if </b></font>d<font color="#000080">.</font>min <font color="#000080">&gt; </font><font color="#800000">9 </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">,</font>d<font color="#000080">.</font>min<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Write<font color="#000080">(</font><font color="#800000">':0'</font><font color="#000080">,</font>d<font color="#000080">.</font>min<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>d<font color="#000080">.</font>hour <font color="#000080">&gt; </font><font color="#800000">11 </font><font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">'p '</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Write<font color="#000080">(</font><font color="#800000">'a '</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(*****************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>Writeline<font color="#000080">(</font>s <font color="#000080">: </font>Searchrec<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>xx <font color="#000080">: </font>byte<font color="#000080">; </font>ss<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
</font><font color="#FF0000"><b>Begin
  </b></font>Writename<font color="#000080">(</font>s<font color="#000080">.</font>name<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>domegs <font color="#FF0000"><b>or </b></font>doextension <font color="#FF0000"><b>then
    Begin
      </b></font>xx <font color="#000080">:= (</font>s<font color="#000080">.</font>size<font color="#000080">+</font><font color="#800000">5120</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">10240</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>xx <font color="#000080">&lt; </font><font color="#800000">10
        </font><font color="#FF0000"><b>then
          begin
            </b></font>Str<font color="#000080">(</font>xx<font color="#000080">:</font><font color="#800000">1</font><font color="#000080">, </font>ss<font color="#000080">);
            </font>meg <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>ss
          <font color="#FF0000"><b>end
        else
          </b></font>Str<font color="#000080">(</font>xx<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">, </font>meg<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>domegs    <font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">'  .'</font><font color="#000080">,</font>meg<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Write<font color="#000080">(</font>s<font color="#000080">.</font>size<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">);
                    </font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>dodate    <font color="#FF0000"><b>then </b></font>Writedate<font color="#000080">(</font>s<font color="#000080">.</font>time<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>dotime    <font color="#FF0000"><b>then </b></font>WriteTime<font color="#000080">(</font>s<font color="#000080">.</font>time<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>isgif     <font color="#FF0000"><b>then
    Begin
      </b></font>Write<font color="#000080">(</font>height<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">'h'</font><font color="#000080">,</font>width<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">'w'</font><font color="#000080">,</font>colors<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">'c '</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>dopalette <font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font>sizeofpalette<font color="#000080">,</font><font color="#800000">'R '</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>doversion <font color="#FF0000"><b>then </b></font>Write <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>gversion<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>doGCT <font color="#FF0000"><b>then begin if </b></font>GCTF <font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">' GCM '</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>write<font color="#000080">(</font><font color="#800000">'     '</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>doGIFLITE <font color="#FF0000"><b>then begin if </b></font>GIFLITE <font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">' GL '</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>write<font color="#000080">(</font><font color="#800000">' ng '</font><font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Writeln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(****************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>ProcessGifFile<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>result <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Assign<font color="#000080">(</font>GifFile<font color="#000080">, </font>Concat<font color="#000080">(</font>Dir<font color="#000080">,</font>DirInfo<font color="#000080">.</font>name<font color="#000080">));
  </font>Reset<font color="#000080">(</font>GifFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font>isgif <font color="#000080">:= </font>false<font color="#000080">;
  </font>inc<font color="#000080">(</font>filecount<font color="#000080">);
  </font>inc<font color="#000080">(</font>totalsize<font color="#000080">,</font>dirinfo<font color="#000080">.</font>size<font color="#000080">);
  </font>ClearABC<font color="#000080">;
</font><font color="#008000"><i>(* See if it's a GIF file. *)
  </i></font>Result <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>Dirinfo<font color="#000080">.</font>name<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>result <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and
    </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>DirInfo<font color="#000080">.</font>name<font color="#000080">,</font>result<font color="#000080">,</font>Length<font color="#000080">(</font>DirInfo<font color="#000080">.</font>name<font color="#000080">)-</font>result<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'.GIF'</font><font color="#000080">)
    </font><font color="#FF0000"><b>then </b></font>isgif <font color="#000080">:= </font>true<font color="#000080">;
</font><font color="#008000"><i>{  Result := Filesize; }
  </i></font><font color="#FF0000"><b>If </b></font>isgif <font color="#008000"><i>{ and (result&gt;12) }
    </i></font><font color="#FF0000"><b>then
      Begin
        </b></font>blockread<font color="#000080">(</font>GifFile<font color="#000080">, </font>A<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>result<font color="#000080">);
        </font>blockread<font color="#000080">(</font>GifFile<font color="#000080">, </font>B<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>result<font color="#000080">);
        </font>blockread<font color="#000080">(</font>GifFile<font color="#000080">, </font>C<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>result<font color="#000080">);
        </font>gheader <font color="#000080">:= </font>A <font color="#000080">+ </font>B <font color="#000080">+ </font>C<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>gheader <font color="#000080">= </font><font color="#800000">'GIF'
    </font><font color="#FF0000"><b>Then
      Begin </b></font><font color="#008000"><i>{GifFileFound!}
        </i></font>blockread<font color="#000080">(</font>GifFile<font color="#000080">, </font>A<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>result<font color="#000080">);
        </font>blockread<font color="#000080">(</font>GifFile<font color="#000080">, </font>B<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>result<font color="#000080">);
        </font>blockread<font color="#000080">(</font>GifFile<font color="#000080">, </font>C<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>result<font color="#000080">);
        </font>gversion <font color="#000080">:= </font>A <font color="#000080">+ </font>B <font color="#000080">+ </font>C<font color="#000080">;
        </font>blockread<font color="#000080">(</font>GifFile<font color="#000080">, </font>height<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font>result<font color="#000080">);
        </font>blockread<font color="#000080">(</font>GifFile<font color="#000080">, </font>width<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font>result<font color="#000080">);
        </font>blockread<font color="#000080">(</font>GifFile<font color="#000080">, </font>Abyte<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>result<font color="#000080">);
        </font>SizeOfGCT <font color="#000080">:= </font>BV<font color="#000080">(</font>Abyte<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) + </font>BV<font color="#000080">(</font>Abyte<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)*</font><font color="#800000">2 </font><font color="#000080">+ </font>BV<font color="#000080">(</font>Abyte<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)*</font><font color="#800000">4 </font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font>colors <font color="#000080">:= </font>Exponential<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>SizeOfGCT<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>BV<font color="#000080">(</font>Abyte<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>SortFlag <font color="#000080">:= </font>true <font color="#FF0000"><b>else </b></font>SortFlag <font color="#000080">:= </font>false<font color="#000080">;
        </font>ColorResolution <font color="#000080">:= </font>BV<font color="#000080">(</font>Abyte<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">) + </font>BV<font color="#000080">(</font>Abyte<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">)*</font><font color="#800000">2 </font><font color="#000080">+ </font>BV<font color="#000080">(</font>Abyte<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">)*</font><font color="#800000">4 </font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font>SizeOfPalette <font color="#000080">:= </font>Exponential<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>ColorResolution<font color="#000080">);
        </font>SizeOfPalette <font color="#000080">:= </font>Exponential<font color="#000080">(</font>SizeofPalette<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>BV<font color="#000080">(</font>Abyte<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>GCTF <font color="#000080">:= </font>true <font color="#FF0000"><b>else </b></font>GCTF <font color="#000080">:= </font>false<font color="#000080">;
        </font>Blockread<font color="#000080">(</font>GifFile<font color="#000080">, </font>BackgroundColorIndex<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
        </font>Blockread<font color="#000080">(</font>GifFile<font color="#000080">, </font>PixelAspectRatio<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>dogiflite
          <font color="#FF0000"><b>then
            Begin
              </b></font>giflite <font color="#000080">:= </font>false<font color="#000080">;
              </font>icount <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>count <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
              </font>jcount <font color="#000080">:= </font>giflitesearch<font color="#000080">;
              </font><font color="#FF0000"><b>If </b></font>GCTF <font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>jcount<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">*</font>colors<font color="#000080">);
              </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>icount <font color="#000080">&lt; </font>jcount<font color="#000080">) </font><font color="#FF0000"><b>and not </b></font>giflite <font color="#FF0000"><b>do
                Begin
                  </b></font>Blockread<font color="#000080">(</font>Giffile<font color="#000080">, </font>A<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>result<font color="#000080">);
                  </font><font color="#FF0000"><b>If </b></font>A <font color="#000080">= </font>Copy<font color="#000080">(</font>gifliteheader<font color="#000080">, </font>count<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
                    Begin
                      If </b></font>count <font color="#000080">= </font>length<font color="#000080">(</font>gifliteheader<font color="#000080">)
                        </font><font color="#FF0000"><b>then
                           </b></font>giflite <font color="#000080">:= </font>true
                        <font color="#FF0000"><b>else
                          </b></font>inc<font color="#000080">(</font>count<font color="#000080">)
                    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                  </font>Inc<font color="#000080">(</font>icount<font color="#000080">);
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Writeline<font color="#000080">(</font>DirInfo<font color="#000080">);
  </font>Close<font color="#000080">(</font>GifFile<font color="#000080">);
  </font>Inc<font color="#000080">(</font>LinesWritten<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>(**********************)
</i></font><font color="#FF0000"><b>Procedure </b></font>WriteVolLabel<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>v <font color="#000080">: </font>searchrec<font color="#000080">; </font>c <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>FindFirst<font color="#000080">(</font>Copy<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)+</font><font color="#800000">'*.*'</font><font color="#000080">,</font>VolumeID<font color="#000080">,</font>v<font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">' Volume in drive '</font><font color="#000080">,</font>Copy<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),</font><font color="#800000">' is '</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>c <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>v<font color="#000080">.</font>name<font color="#000080">) </font><font color="#FF0000"><b>do if </b></font>v<font color="#000080">.</font>name<font color="#000080">[</font>c<font color="#000080">] &lt;&gt; </font><font color="#800000">'.' </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font>v<font color="#000080">.</font>name<font color="#000080">[</font>c<font color="#000080">]);
  </font>Writeln<font color="#000080">;
  </font>Write<font color="#000080">(</font><font color="#800000">' Directory of '</font><font color="#000080">,</font>Copy<font color="#000080">(</font>Dir<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Length<font color="#000080">(</font>Dir<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));
  </font><font color="#FF0000"><b>If </b></font>Copy<font color="#000080">(</font>Dir<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">':' </font><font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(***************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>ParseParms<font color="#000080">(</font>pps <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{ This only gets parms with a slash / in them. }
</i></font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>pps<font color="#000080">) &lt;&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then </b></font><font color="#008000"><i>{ This is the filename with a slash appended }
  </i></font><font color="#FF0000"><b>Begin
</b></font><font color="#008000"><i>{    ProcessParms(Copy(pps,1,Pos('/',pps)-1)); }
    </i></font>Path <font color="#000080">:= </font>Fexpand<font color="#000080">(</font>Copy<font color="#000080">(</font>pps<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>pps<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));
    </font>pps <font color="#000080">:= </font>Copy<font color="#000080">(</font>pps<font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>pps<font color="#000080">),</font>Length<font color="#000080">(</font>pps<font color="#000080">)-</font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>pps<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>pps<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>pps<font color="#000080">) &gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Do
  Begin
    </b></font>ProcessParms<font color="#000080">(</font>Copy<font color="#000080">(</font>pps<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
    </font>pps <font color="#000080">:= </font>Copy<font color="#000080">(</font>pps<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>Length<font color="#000080">(</font>pps<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>pps<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>pps <font color="#000080">:= </font>Copy<font color="#000080">(</font>pps<font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>pps<font color="#000080">),</font>Length<font color="#000080">(</font>pps<font color="#000080">)-</font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>pps<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(***************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>Initialize<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>sr <font color="#000080">: </font>searchrec<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Assign<font color="#000080">(</font>Input<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);   </font>Reset<font color="#000080">(</font>Input<font color="#000080">);
  </font>Assign<font color="#000080">(</font>Output<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);  </font>Rewrite<font color="#000080">(</font>Output<font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font>ProSoft<font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>dodate <font color="#000080">:= </font>true<font color="#000080">;  </font>dotime <font color="#000080">:= </font>false<font color="#000080">;  </font>domegs <font color="#000080">:= </font>false<font color="#000080">;  </font>doextension <font color="#000080">:= </font>true<font color="#000080">;
  </font>dopalette <font color="#000080">:= </font>false<font color="#000080">; </font>doGCT <font color="#000080">:= </font>false<font color="#000080">; </font>doversion <font color="#000080">:= </font>false<font color="#000080">; </font>pause <font color="#000080">:= </font>false<font color="#000080">;
  </font>dofiledot <font color="#000080">:= </font>false<font color="#000080">; </font>dogiflite <font color="#000080">:= </font>true<font color="#000080">; </font>doall <font color="#000080">:= </font>false<font color="#000080">;
  </font>gheader <font color="#000080">:= </font><font color="#800000">'  '</font><font color="#000080">; </font>gversion <font color="#000080">:= </font><font color="#800000">'   '</font><font color="#000080">;
  </font>ClearABC<font color="#000080">; </font>Clearname<font color="#000080">;
  </font>FileCount <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;  </font>TotalSize <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;  </font>LinesWritten <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Sizeof<font color="#000080">(</font>path<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Path<font color="#000080">[</font>count<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Sizeof<font color="#000080">(</font>Dir<font color="#000080">)  </font><font color="#FF0000"><b>do </b></font>Dir<font color="#000080">[</font>count<font color="#000080">]  := </font><font color="#800000">' '</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Sizeof<font color="#000080">(</font>Name<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Name<font color="#000080">[</font>count<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Sizeof<font color="#000080">(</font>Ext<font color="#000080">)  </font><font color="#FF0000"><b>do </b></font>Ext<font color="#000080">[</font>count<font color="#000080">]  := </font><font color="#800000">' '</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>paramcount <font color="#000080">= </font><font color="#800000">0
    </font><font color="#FF0000"><b>then
      </b></font>Path <font color="#000080">:= </font>FExpand<font color="#000080">(</font><font color="#800000">'*.GIF'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      If </b></font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>path <font color="#000080">:= </font>FExpand<font color="#000080">(</font><font color="#800000">'*.GIF'</font><font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>Count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>paramcount <font color="#FF0000"><b>do If </b></font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>paramstr<font color="#000080">(</font>count<font color="#000080">)) &gt; </font><font color="#800000">0
        </font><font color="#FF0000"><b>then
          </b></font>ParseParms<font color="#000080">(</font>paramstr<font color="#000080">(</font>count<font color="#000080">))
        </font><font color="#FF0000"><b>else
          </b></font>Path <font color="#000080">:= </font>Fexpand<font color="#000080">(</font>paramstr<font color="#000080">(</font>count<font color="#000080">));
</font><font color="#008000"><i>{
  FindFirst(Path,$10,sr);
  If (Doserror = 0) and (sr.attr = $10) then
    begin
      Path := Path + '\*.gif';
      Path := FExpand(Path)
    end;
}
  </i></font>Fsplit<font color="#000080">(</font>Path<font color="#000080">,</font>Dir<font color="#000080">,</font>Name<font color="#000080">,</font>Ext<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>name <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>name <font color="#000080">= </font><font color="#800000">'        '</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>name <font color="#000080">:= </font><font color="#800000">'*'</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Ext <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Ext <font color="#000080">= </font><font color="#800000">'    '</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Ext <font color="#000080">:= </font><font color="#800000">'.GIF'</font><font color="#000080">;
  </font>Path <font color="#000080">:= </font>Dir <font color="#000080">+ </font>Name <font color="#000080">+ </font>Ext<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(******************&gt; Main &lt;*********************)
</i></font><font color="#FF0000"><b>Begin    </b></font><font color="#008000"><i>{ Main }
  </i></font>Initialize<font color="#000080">;
  </font>FindFirst<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">$21</font><font color="#000080">,</font>DirInfo<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Doserror <font color="#000080">= </font><font color="#800000">0
    </font><font color="#FF0000"><b>then
      Begin
        </b></font>WriteVolLabel<font color="#000080">;
        </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>do
          Begin
            If </b></font><font color="#000080">(</font>dirinfo<font color="#000080">.</font>name <font color="#000080">= </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>dirinfo<font color="#000080">.</font>name <font color="#000080">= </font><font color="#800000">'..'</font><font color="#000080">)
              </font><font color="#FF0000"><b>then
                For </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>do </b></font>DirInfo<font color="#000080">.</font>name<font color="#000080">[</font>count<font color="#000080">] := </font><font color="#800000">' '
              </font><font color="#FF0000"><b>else
                </b></font>ProcessGifFile<font color="#000080">;
            </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
            </font><font color="#FF0000"><b>If </b></font>pause <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>LinesWritten <font color="#000080">= </font>ScreenLines<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>DosError <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">)
              </font><font color="#FF0000"><b>then
                Begin
                  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Press any key to continue . . .'</font><font color="#000080">);
                    </font>AssignCrt<font color="#000080">(</font>Input<font color="#000080">);   </font>Reset<font color="#000080">(</font>Input<font color="#000080">);
                    </font>AssignCrt<font color="#000080">(</font>Output<font color="#000080">);  </font>Rewrite<font color="#000080">(</font>Output<font color="#000080">);
                  </font>ch <font color="#000080">:= </font>Readkey<font color="#000080">;
                    </font>Assign<font color="#000080">(</font>Input<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);   </font>Reset<font color="#000080">(</font>Input<font color="#000080">);
                    </font>Assign<font color="#000080">(</font>Output<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);  </font>Rewrite<font color="#000080">(</font>Output<font color="#000080">);
                  </font>Writeln<font color="#000080">;
                  </font>LinesWritten <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>Write<font color="#000080">(</font>FileCount<font color="#000080">:</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">' file'</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>Filecount <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">'  '</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Write<font color="#000080">(</font><font color="#800000">'s '</font><font color="#000080">);
        </font>cs <font color="#000080">:= </font>Copy<font color="#000080">(</font>Path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font>cc <font color="#000080">:= </font>cs<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
        </font>count <font color="#000080">:= </font>ord<font color="#000080">(</font>cc<font color="#000080">)-</font><font color="#800000">64</font><font color="#000080">;
        </font>Writeln<font color="#000080">(</font>totalsize<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">' bytes'</font><font color="#000080">);
        </font>Writeln<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">:</font><font color="#800000">16</font><font color="#000080">,</font>diskfree<font color="#000080">(</font>count<font color="#000080">):</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">' bytes free '</font><font color="#000080">);
        </font>Writeln<font color="#000080">;
      </font><font color="#FF0000"><b>End
    Else
      </b></font>Badparms<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p></body>
</html>
