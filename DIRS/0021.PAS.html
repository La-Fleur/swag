<html>
<head><title> "Multiple Dir Picks" by DAVID DRZYZGA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
DAVID DRZYZGA

&gt; And I can't seem to get the OpDir system to work With multiple Files, or
&gt; at least I can't get the &quot;tagging&quot; Function to work.

Here's a somewhat stripped snipit of code from one of my apps that will give
you a clear example of how to use the multiple pick Function of the DirList
Object:
}

</i></font><font color="#FF0000"><b>Program </b></font>DirTest<font color="#000080">;

</font><font color="#008000"><i>{$I OPDEFINE.INC}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">,
  </font>OpRoot<font color="#000080">,
  </font>OpConst<font color="#000080">,
  </font>OpString<font color="#000080">,
  </font>OpCrt<font color="#000080">,
  </font>OpCmd<font color="#000080">,
  </font>OpFrame<font color="#000080">,
  </font>OpWindow<font color="#000080">,
  </font>OpPick<font color="#000080">,
  </font>OpDir<font color="#000080">,
  </font>OpColor<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>SliderChar    <font color="#000080">= </font><font color="#800000">'&sup2;'</font><font color="#000080">;
  </font>ScrollBarChar <font color="#000080">= </font><font color="#800000">'&deg;'</font><font color="#000080">;
  </font>Frame1        <font color="#000080">: </font>FrameArray <font color="#000080">= </font><font color="#800000">'&Uacute;&Agrave;&iquest;&Ugrave;&Auml;&Auml;&sup3;&sup3;'</font><font color="#000080">;
  </font>Counter       <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Dir          <font color="#000080">: </font>DirList<font color="#000080">;
  </font>Finished     <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>SelectedItem <font color="#000080">: </font>Word<font color="#000080">;
  </font>DirWinOpts   <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>I            <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ProcessFile<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{This is where you would process each of the tagged Files}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>DirWinOpts <font color="#000080">:= </font>DefWindowOptions<font color="#000080">+</font>wBordered<font color="#000080">;
  </font><font color="#FF0000"><b>if not </b></font>Dir<font color="#000080">.</font>InitCustom<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">50</font><font color="#000080">, </font><font color="#800000">19</font><font color="#000080">, </font><font color="#008000"><i>{Window coordinates}
                        </i></font>DefaultColorSet<font color="#000080">,  </font><font color="#008000"><i>{ColorSet}
                        </i></font>DirWinOpts<font color="#000080">,    </font><font color="#008000"><i>{Window options}
                        </i></font>MaxAvail<font color="#000080">,      </font><font color="#008000"><i>{Heap space For Files}
                        </i></font>PickVertical<font color="#000080">,  </font><font color="#008000"><i>{Pick orientation}
                        </i></font>MultipleFile<font color="#000080">)  </font><font color="#008000"><i>{Command handler}
  </i></font><font color="#FF0000"><b>then
  begin
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Failed to Init DirList,  Status = '</font><font color="#000080">, </font>InitStatus<font color="#000080">);
    </font>Halt<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{Set desired DirList features}
  </i></font><font color="#FF0000"><b>With </b></font>Dir <font color="#FF0000"><b>do
  begin
    </b></font>wFrame<font color="#000080">.</font>AddShadow<font color="#000080">(</font>shBR<font color="#000080">, </font>shSeeThru<font color="#000080">);
    </font>wFrame<font color="#000080">.</font>AddCustomScrollBar<font color="#000080">(</font>frRR<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>MaxLongInt<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>SliderChar<font color="#000080">,
                              </font>ScrollBarChar<font color="#000080">, </font>DefaultColorSet<font color="#000080">);

    </font>SetSelectMarker<font color="#000080">(</font><font color="#800000">#251' '</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">);
    </font>SetPosLimits<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>ScreenWidth<font color="#000080">, </font>ScreenHeight<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
    </font>SetPadSize<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font>diOptionsOn<font color="#000080">(</font>diOptimizeSize<font color="#000080">);
    </font>AddMaskHeader<font color="#000080">(</font>True<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">30</font><font color="#000080">, </font>heTC<font color="#000080">);
    </font>SetSortOrder<font color="#000080">(</font>SortDirName<font color="#000080">);
    </font>SetNameSizeTimeFormat<font color="#000080">(</font><font color="#800000">'&lt;dir&gt;'</font><font color="#000080">, </font><font color="#800000">'Mm/dd/yy'</font><font color="#000080">, </font><font color="#800000">'Hh:mmt'</font><font color="#000080">);
    </font>SetMask<font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">, </font>AnyFile<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{&lt;AltP&gt;: process selected list}
  </i></font>PickCommands<font color="#000080">.</font>AddCommand<font color="#000080">(</font>ccUser0<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">$1900</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);

  </font><font color="#008000"><i>{Pick Files}
  </i></font>Finished <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>Dir<font color="#000080">.</font>Process<font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>Dir<font color="#000080">.</font>GetLastCommand <font color="#FF0000"><b>of
      </b></font>ccSelect <font color="#000080">: ;
      </font>ccError  <font color="#000080">: ;
      </font>ccUser0  <font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Counter <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>Dir<font color="#000080">.</font>GetSelectedCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        begin
          </b></font>Dir<font color="#000080">.</font>InitSequence<font color="#000080">(</font>SelectedItem<font color="#000080">);
          </font><font color="#FF0000"><b>While </b></font>Dir<font color="#000080">.</font>HaveSelected<font color="#000080">(</font>SelectedItem<font color="#000080">) </font><font color="#FF0000"><b>do
          begin
            </b></font>ProcessFile<font color="#000080">(</font>Dir<font color="#000080">.</font>GetMultiPath<font color="#000080">(</font>SelectedItem<font color="#000080">));
            </font>Inc<font color="#000080">(</font>Counter<font color="#000080">);
            </font>Dir<font color="#000080">.</font>NextSelected<font color="#000080">(</font>SelectedItem<font color="#000080">);
            </font>Dir<font color="#000080">.</font>ResetList<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end
      end</b></font><font color="#000080">;

      </font>ccQuit <font color="#000080">: </font>Finished <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>Finished<font color="#000080">;

  </font>Dir<font color="#000080">.</font>Erase<font color="#000080">;
  </font>ClrScr<font color="#000080">;
  </font>Dir<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p></body>
</html>
