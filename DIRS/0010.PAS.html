<html>
<head><title> "Directory Viewer" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Well, here goes...a directory viewer, sorry it has no box but the
command that i used to create the box was from a Unit. Weel, the Program
is very &quot;raw&quot; but i think it's enough to give you an idea...
}

</i></font><font color="#FF0000"><b>Program </b></font>ListBox<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>S <font color="#000080">= </font><font color="#800000">'           '</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>List         <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">150</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
  </font>AttrList     <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">150</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">15</font><font color="#000080">];
  </font>Pos<font color="#000080">, </font>First   <font color="#000080">: </font>Integer<font color="#000080">;
  </font>C            <font color="#000080">: </font>Char<font color="#000080">;
  </font>Cont         <font color="#000080">: </font>Integer<font color="#000080">;
  </font>DirInfo      <font color="#000080">: </font>SearchRec<font color="#000080">;
  </font>NumFiles     <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>TextBackground<font color="#000080">(</font>Black<font color="#000080">);
  </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
  </font>ClrScr<font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>Cont <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do
  begin
    </b></font>List<font color="#000080">[</font>Cont<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
    </font>AttrList<font color="#000080">[</font>Cont<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>NumFiles <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>FindFirst<font color="#000080">(</font><font color="#800000">'C:\*.*'</font><font color="#000080">, </font>AnyFile<font color="#000080">, </font>DirInfo<font color="#000080">);

  </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>Inc<font color="#000080">(</font>NumFiles<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font>List<font color="#000080">[</font>NumFiles<font color="#000080">] := </font>Concat<font color="#000080">(</font>DirInfo<font color="#000080">.</font>Name<font color="#000080">,
                      </font>Copy<font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">12 </font><font color="#000080">- </font>Length<font color="#000080">(</font>DirInfo<font color="#000080">.</font>Name<font color="#000080">)));
    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DirInfo<font color="#000080">.</font>Attr <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>AttrList<font color="#000080">[</font>NumFiles<font color="#000080">] := </font><font color="#800000">'&lt;DIR&gt;'
    </font><font color="#FF0000"><b>Else
      </b></font>Str<font color="#000080">(</font>DirInfo<font color="#000080">.</font>Size<font color="#000080">, </font>AttrList<font color="#000080">[</font>NumFiles<font color="#000080">]);
    </font>AttrList<font color="#000080">[</font>NumFiles<font color="#000080">] := </font>Concat<font color="#000080">(</font>AttrList<font color="#000080">[</font>NumFiles<font color="#000080">],
                          </font>Copy<font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">9 </font><font color="#000080">- </font>Length<font color="#000080">(</font>AttrList<font color="#000080">[</font>NumFiles<font color="#000080">])));
    </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>First <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Pos   <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>Repeat
    For </b></font>Cont <font color="#000080">:= </font>First <font color="#FF0000"><b>To </b></font>First <font color="#000080">+ </font><font color="#800000">15 </font><font color="#FF0000"><b>do
    begin
      If </b></font><font color="#000080">(</font>Cont <font color="#000080">- </font>First <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">= </font>Pos<font color="#000080">) </font><font color="#FF0000"><b>Then
      begin
        </b></font>TextBackground<font color="#000080">(</font>Blue<font color="#000080">);
        </font>TextColor<font color="#000080">(</font>Yellow<font color="#000080">);
      </font><font color="#FF0000"><b>end
      Else
      begin
        </b></font>TextBackGround<font color="#000080">(</font>Black<font color="#000080">);
        </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>GotoXY<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">, </font>Cont <font color="#000080">- </font>First <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">);
      </font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>List<font color="#000080">[</font>Cont<font color="#000080">], </font><font color="#800000">'  '</font><font color="#000080">, </font>AttrList<font color="#000080">[</font>Cont<font color="#000080">]);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>C <font color="#000080">:= </font>ReadKey<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>C <font color="#000080">= </font><font color="#800000">#72</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      If </b></font><font color="#000080">(</font>Pos <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        </b></font>Dec<font color="#000080">(</font>Pos<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else
      If </b></font><font color="#000080">(</font>First <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        </b></font>Dec<font color="#000080">(</font>First<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);

    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>C <font color="#000080">= </font><font color="#800000">#80</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      If </b></font><font color="#000080">(</font>Pos <font color="#000080">&lt; </font><font color="#800000">15</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        </b></font>Inc<font color="#000080">(</font>Pos<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else
      If </b></font><font color="#000080">(</font>First <font color="#000080">+ </font><font color="#800000">15 </font><font color="#000080">&lt; </font>NumFiles<font color="#000080">) </font><font color="#FF0000"><b>Then
        </b></font>Inc<font color="#000080">(</font>First<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Ord<font color="#000080">(</font>c<font color="#000080">) = </font><font color="#800000">13</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p></body>
</html>
