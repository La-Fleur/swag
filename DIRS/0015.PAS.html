<html>
<head><title> "Every Dir in Pascal" by LAWRENCE JOHNSTONE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
LAWRENCE JOHNSTONE

&sup3;Can someone give me some code (in TP) that recognizes all Sub-dirs
&sup3;and Sub-sub-dirs, etc. in drive C and changes into every single one
&sup3;of them one at a time?
}

</i></font><font color="#FF0000"><b>PROGRAM </b></font>EveryDir<font color="#000080">;

</font><font color="#FF0000"><b>USES
  </b></font>DOS

<font color="#FF0000"><b>PROCEDURE </b></font>ProcessDirs<font color="#000080">( </font>Path<font color="#000080">: </font>DOS<font color="#000080">.</font>PathStr <font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>SR <font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>Path<font color="#000080">[</font>Length<font color="#000080">(</font>Path<font color="#000080">)] &lt;&gt; </font><font color="#800000">'\' </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ Make sure last char is '\' }
    </i></font>Path <font color="#000080">:= </font>Path <font color="#000080">+ </font><font color="#800000">'\'</font><font color="#000080">;

  </font><font color="#008000"><i>{ Change to directory specified by Path.  Handle root as special case }
  {$I-}
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>Path<font color="#000080">) = </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>Path<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">) = </font><font color="#800000">':\'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    </b></font>ChDir<font color="#000080">(</font>Path<font color="#000080">)
  </font><font color="#FF0000"><b>ELSE
    </b></font>ChDir<font color="#000080">(</font>Copy<font color="#000080">(</font>Path<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>Path<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
    </b></font>EXIT<font color="#000080">; </font><font color="#008000"><i>{ Quit if we get a DOS error }
  {$I-}

  { Process all subdirectories of that directory, except for }
  { the '.' and '..' aliases                                 }
  </i></font>FindFirst<font color="#000080">(</font>Path <font color="#000080">+ </font><font color="#800000">'*.*'</font><font color="#000080">, </font>Directory<font color="#000080">, </font>SR<font color="#000080">);
  </font><font color="#FF0000"><b>WHILE </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
  BEGIN
    IF </b></font><font color="#000080">((</font>SR<font color="#000080">.</font>Attr <font color="#FF0000"><b>AND </b></font>Directory<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
        </b></font><font color="#000080">(</font>SR<font color="#000080">.</font>Name <font color="#000080">&lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>SR<font color="#000080">.</font>Name <font color="#000080">&lt;&gt; </font><font color="#800000">'..'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      </b></font>ProcessDirs<font color="#000080">( </font>Path <font color="#000080">+ </font>SR<font color="#000080">.</font>Name <font color="#000080">);
    </font>FindNext<font color="#000080">(</font>SR<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ while }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ProcessDirs}

</i></font><font color="#FF0000"><b>VAR
  </b></font>CurDir <font color="#000080">: </font>DOS<font color="#000080">.</font>PathStr<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>GetDir<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">, </font>CurDir<font color="#000080">);  </font><font color="#008000"><i>{ Get default directory on C }
  </i></font>ProcessDirs<font color="#000080">(</font><font color="#800000">'C:\'</font><font color="#000080">); </font><font color="#008000"><i>{ Process all directories on C }
  </i></font>ChDir<font color="#000080">(</font>CurDir<font color="#000080">);      </font><font color="#008000"><i>{ Restore default directory on C }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p></body>
</html>
