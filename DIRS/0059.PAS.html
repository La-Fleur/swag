<html>
<head><title> "Remove Directory function" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0059.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Remove all files <font color="#FF0000"><b>and </b></font>subdirectories
Q<font color="#000080">:
</font>Has anyone run across a <font color="#FF0000"><b>function </b></font>that will recursively remove files <font color="#FF0000"><b>and
</b></font>directories given a starting subdirectory path<font color="#000080">. </font>Failing that I would
settle <font color="#FF0000"><b>for </b></font>a simple RemoveDirectory <font color="#FF0000"><b>function </b></font>that will just remove a
given directory<font color="#000080">.

</font>A<font color="#000080">:
</font>This doesn<font color="#800000">'t check for attributes being set, which might preclude deletion
</font><font color="#FF0000"><b>of </b></font>a <font color="#FF0000"><b>file</b></font><font color="#000080">. </font>Put a <font color="#008000"><i>{$I-} {$I+} </i></font>pair around the functions that cause the problem<font color="#000080">.

</font><font color="#FF0000"><b>procedure </b></font>removeTree <font color="#000080">(</font>DirName<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>FileSearch<font color="#000080">:  </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font><font color="#008000"><i>{ first, go through and delete all the directories }
   </i></font>chDir <font color="#000080">(</font>DirName<font color="#000080">);
   </font>FindFirst <font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">, </font>Directory<font color="#000080">, </font>FileSearch<font color="#000080">);
   </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>DosError <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
      if </b></font><font color="#000080">(</font>FileSearch<font color="#000080">.</font>name <font color="#000080">&lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>FileSearch<font color="#000080">.</font>name <font color="#000080">&lt;&gt; </font><font color="#800000">'..'</font><font color="#000080">) </font><font color="#FF0000"><b>AND
         </b></font><font color="#000080">( (</font>FileSearch<font color="#000080">.</font>attr <font color="#FF0000"><b>AND </b></font>Directory<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">)
      </font><font color="#FF0000"><b>then begin
         if </b></font>DirName<font color="#000080">[</font>length<font color="#000080">(</font>DirName<font color="#000080">)] = </font><font color="#800000">'\' </font><font color="#FF0000"><b>then
            </b></font>removeTree <font color="#000080">(</font>DirName<font color="#000080">+</font>FileSearch<font color="#000080">.</font>Name<font color="#000080">)
         </font><font color="#FF0000"><b>else
            </b></font>removeTree <font color="#000080">(</font>DirName<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>FileSearch<font color="#000080">.</font>Name<font color="#000080">);
         </font>ChDir <font color="#000080">(</font>DirName<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>FindNext <font color="#000080">(</font>FileSearch<font color="#000080">)
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#008000"><i>{ then, go through and delete all the files }
   </i></font>FindFirst <font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">, </font>AnyFile<font color="#000080">, </font>FileSearch<font color="#000080">);
   </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>DosError <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
      if </b></font><font color="#000080">(</font>FileSearch<font color="#000080">.</font>name <font color="#000080">&lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>FileSearch<font color="#000080">.</font>name <font color="#000080">&lt;&gt; </font><font color="#800000">'..'</font><font color="#000080">) </font><font color="#FF0000"><b>then
         </b></font>Remove <font color="#000080">(</font>workdir<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>FindNext <font color="#000080">(</font>FileSearch<font color="#000080">)
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>rmDir <font color="#000080">(</font>DirName<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0059.PAS">Original</a><b>]</b></p></body>
</html>
