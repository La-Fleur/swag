<html>
<head><title> "Delete Tree" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Procedure </b></font>ClrDir <font color="#000080">( </font>path <font color="#000080">: </font>pathStr <font color="#000080">);

</font><font color="#FF0000"><b>Var </b></font>FileInfo <font color="#000080">: </font>searchRec<font color="#000080">;
    </font>f        <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
    </font>path2    <font color="#000080">: </font>pathStr<font color="#000080">;
    </font>s        <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin </b></font>FindFirst <font color="#000080">( </font>path <font color="#000080">+ </font><font color="#800000">'\*.*'</font><font color="#000080">, </font>AnyFile<font color="#000080">, </font>FileInfo <font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Do
      begin if </b></font><font color="#000080">(</font>FileInfo<font color="#000080">.</font>Name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FileInfo<font color="#000080">.</font>attr <font color="#000080">&lt;&gt; </font>VolumeId<font color="#000080">) </font><font color="#FF0000"><b>then
              if </b></font><font color="#000080">( (</font>FileInfo<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font>Directory<font color="#000080">) = </font>Directory <font color="#000080">) </font><font color="#FF0000"><b>then
                begin </b></font>Path2 <font color="#000080">:= </font>Path <font color="#000080">+ </font><font color="#800000">'\' </font><font color="#000080">+ </font>FileInfo<font color="#000080">.</font>Name<font color="#000080">;
                      </font>ClrDir <font color="#000080">( </font>path2 <font color="#000080">);
                </font><font color="#FF0000"><b>end
            else
              if </b></font><font color="#000080">((</font>FileInfo<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font>VolumeID<font color="#000080">) &lt;&gt; </font>VolumeID<font color="#000080">) </font><font color="#FF0000"><b>then begin
                </b></font>Assign <font color="#000080">( </font>f<font color="#000080">, </font>path <font color="#000080">+ </font><font color="#800000">'\' </font><font color="#000080">+ </font>FileInfo<font color="#000080">.</font>Name <font color="#000080">);
                </font>Erase <font color="#000080">( </font>f <font color="#000080">);
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

            </font>FindNext <font color="#000080">( </font>FileInfo <font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>DosError <font color="#000080">= </font><font color="#800000">18</font><font color="#000080">) </font><font color="#FF0000"><b>and not </b></font><font color="#000080">((</font>Length<font color="#000080">(</font>path<font color="#000080">) = </font><font color="#800000">2</font><font color="#000080">)
                                   </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>path<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">':'</font><font color="#000080">)) </font><font color="#FF0000"><b>then
        </b></font>RmDir <font color="#000080">( </font>path <font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p></body>
</html>
