<html>
<head><title> "Searching a Complete Drv" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Can any one tell me a way to make pascal (TP 6.0) search a Complete
&gt; drive, including all subdirectories, even ones that are not in the
&gt; path, looking For a specific File extension?  I.E., having the Program
&gt; search For *.doC and saving that to a Text File?

Ok, here goes nothing.
}

{$M 65000 0 655360}
{Assign enough stack space For recursion}

</i></font><font color="#FF0000"><b>Program </b></font>FindAllFiles<font color="#000080">;

</font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>FileName <font color="#000080">: </font>Text<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ScanDir<font color="#000080">(</font>path <font color="#000080">: </font>PathStr<font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>SearchFile <font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Path<font color="#000080">[</font>Length<font color="#000080">(</font>Path<font color="#000080">)] &lt;&gt; </font><font color="#800000">'\' </font><font color="#FF0000"><b>then
    </b></font>Path <font color="#000080">:= </font>Path <font color="#000080">+ </font><font color="#800000">'\'</font><font color="#000080">;
  </font>FindFirst<font color="#000080">(</font>Path <font color="#000080">+ </font><font color="#800000">'*.*'</font><font color="#000080">, </font><font color="#800000">$37</font><font color="#000080">, </font>SearchFile<font color="#000080">); </font><font color="#008000"><i>{ Find Files and Directories }
  </i></font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do </b></font><font color="#008000"><i>{ While There are more Files }
  </i></font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">((</font>SearchFile<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font><font color="#800000">$10</font><font color="#000080">) = </font><font color="#800000">$10</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>SearchFile<font color="#000080">.</font>Name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>ScanDir<font color="#000080">(</font>Path <font color="#000080">+ </font>SearchFile<font color="#000080">.</font>Name<font color="#000080">)
      </font><font color="#008000"><i>{ Found a directory Make sure it's not . or .. Scan this dir also }
    </i></font><font color="#FF0000"><b>else
    if </b></font>Pos<font color="#000080">(</font><font color="#800000">'.doC'</font><font color="#000080">,</font>SearchFile<font color="#000080">.</font>Name<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Writeln<font color="#000080">(</font>FileName<font color="#000080">, </font>Path <font color="#000080">+ </font>SearchFile<font color="#000080">.</font>Name<font color="#000080">);
      </font><font color="#008000"><i>{ if the .doC appears in the File name, Write path to File. }
    </i></font>FindNext<font color="#000080">(</font>SearchFile<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>FileName<font color="#000080">,</font><font color="#800000">'doCS'</font><font color="#000080">); </font><font color="#008000"><i>{ File to contain list of .doCs }
  </i></font>ReWrite<font color="#000080">(</font>FileName<font color="#000080">);
  </font>ScanDir<font color="#000080">(</font><font color="#800000">'C:\'</font><font color="#000080">); </font><font color="#008000"><i>{ Drive to scan. }
  </i></font>Close<font color="#000080">(</font>FileName<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p></body>
</html>
