<html>
<head><title> "Does DIR Exist ?" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
  re: Finding a directory

&gt;Obviously that's not the quickest routine in the world, and though
&gt;it works, I was wondering if you have anything easier/faster?

  ...I don't know how much better this routine is, but you may
  want to give it a try:
}

{ Determine if a directory exists. }

</i></font><font color="#FF0000"><b>Function </b></font>DirExist<font color="#000080">(</font>st_Dir <font color="#000080">: </font>DirStr<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>wo_Fattr <font color="#000080">: </font>Word<font color="#000080">;
  </font>fi_Temp  <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>assign<font color="#000080">(</font>fi_Temp<font color="#000080">, (</font>st_Dir <font color="#000080">+ </font><font color="#800000">'.'</font><font color="#000080">));
  </font>getfattr<font color="#000080">(</font>fi_Temp<font color="#000080">, </font>wo_Fattr<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Doserror <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>DirExist <font color="#000080">:= </font>False
  <font color="#FF0000"><b>else
    </b></font>DirExist <font color="#000080">:= ((</font>wo_Fattr <font color="#FF0000"><b>and </b></font>directory<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ DirExist. }

{
notE: The &quot;DirStr&quot; Type definition is found in the standard TP
      Dos Unit. Add this Unit to your Program's &quot;Uses&quot; statement
      to use this routine.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p></body>
</html>
