<html>
<head><title> "Show a Directory of EXE files" by SWAG SUPPORT GROUP</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$M 4000, 0, 0}
</i></font><font color="#FF0000"><b>program </b></font>Directory_Of_Executables<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>DOS<font color="#000080">, </font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>DirInfo <font color="#000080">: </font>SearchRec<font color="#000080">;
    </font>Files <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">40</font><font color="#000080">];
    </font>Size<font color="#000080">, </font>Date<font color="#000080">, </font>Time <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
    </font>StrVar<font color="#000080">, </font>SV <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>Index<font color="#000080">, </font>last <font color="#000080">: </font>Integer<font color="#000080">;
    </font>TotalSize <font color="#000080">: </font>LongInt<font color="#000080">;
    </font>done <font color="#000080">: </font>boolean<font color="#000080">;
    </font>Dir <font color="#000080">: </font>DirStr<font color="#000080">;
    </font>Path <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LeadingZero<font color="#000080">(</font>w <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Str<font color="#000080">(</font>w<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font>s<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Length<font color="#000080">(</font>s<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then
    </b></font>s <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>s<font color="#000080">;
  </font>LeadingZero <font color="#000080">:= </font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>Commas <font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Num<font color="#000080">, </font>Cnt<font color="#000080">, </font>e <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Val<font color="#000080">(</font>S<font color="#000080">, </font>Num<font color="#000080">, </font>e<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>e <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">) &lt;= </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font>Cnt <font color="#000080">:= </font>Length<font color="#000080">(</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>e <font color="#000080">:= </font>Cnt <font color="#FF0000"><b>downto </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do
    If </b></font><font color="#000080">(</font>e <font color="#000080">/ </font><font color="#800000">3</font><font color="#000080">) = (</font>e <font color="#FF0000"><b>div </b></font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Insert<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>S<font color="#000080">, </font>e<font color="#000080">);
  </font>COmmas <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RightJustify<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>N <font color="#000080">: </font>Integer<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>cnt <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  While </b></font>Length<font color="#000080">(</font>S<font color="#000080">) &lt; </font>N <font color="#FF0000"><b>do </b></font>S <font color="#000080">:= </font><font color="#800000">' ' </font><font color="#000080">+ </font>S<font color="#000080">;
  </font>RightJustify <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ExpandFName <font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     while </b></font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>s<font color="#000080">) &lt; </font><font color="#800000">9 </font><font color="#FF0000"><b>do </b></font>insert<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>s<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>s<font color="#000080">));
     </font>s<font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;
     </font>ExpandFName <font color="#000080">:= </font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
     If </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Path <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Path <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
     </font>last <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>totalsize <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>index <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
     </font>FindFirst<font color="#000080">(</font>Path <font color="#000080">+ </font><font color="#800000">'*.EXE'</font><font color="#000080">, </font>Archive<font color="#000080">, </font>DirInfo<font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
       begin
            </b></font>Str<font color="#000080">(</font>DirInfo<font color="#000080">.</font>Size<font color="#000080">, </font>Size<font color="#000080">); </font><font color="#008000"><i>{Size := Commas(Size);}
            </i></font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>ExpandFName<font color="#000080">(</font>DirInfo<font color="#000080">.</font>Name<font color="#000080">);
            </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>Files<font color="#000080">[</font>Index<font color="#000080">]) &lt; </font><font color="#800000">22
                  </font><font color="#FF0000"><b>do </b></font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>Files<font color="#000080">[</font>Index<font color="#000080">] + </font><font color="#800000">' '</font><font color="#000080">;
            </font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>Files<font color="#000080">[</font>Index<font color="#000080">] + </font>RightJustify<font color="#000080">(</font>Size<font color="#000080">, </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">'  '</font><font color="#000080">;
            </font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>Files<font color="#000080">[</font>Index<font color="#000080">] + </font>Date <font color="#000080">+ </font><font color="#800000">'  ' </font><font color="#000080">+ </font>Time<font color="#000080">;
            </font>inc<font color="#000080">(</font>Index<font color="#000080">);
            </font>Totalsize <font color="#000080">:= </font>TotalSize <font color="#000080">+ </font>DirInfo<font color="#000080">.</font>Size<font color="#000080">;
            </font>Inc<font color="#000080">(</font>last<font color="#000080">);
            </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>FindFirst<font color="#000080">(</font>Path <font color="#000080">+ </font><font color="#800000">'*.BAT'</font><font color="#000080">, </font>Archive<font color="#000080">, </font>DirInfo<font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
       begin
            </b></font>Str<font color="#000080">(</font>DirInfo<font color="#000080">.</font>Size<font color="#000080">, </font>Size<font color="#000080">);
            </font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>ExpandFName<font color="#000080">(</font>DirInfo<font color="#000080">.</font>Name<font color="#000080">);
            </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>Files<font color="#000080">[</font>Index<font color="#000080">]) &lt; </font><font color="#800000">22
                  </font><font color="#FF0000"><b>do </b></font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>Files<font color="#000080">[</font>Index<font color="#000080">] + </font><font color="#800000">' '</font><font color="#000080">;
            </font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>Files<font color="#000080">[</font>Index<font color="#000080">] +</font>RightJustify<font color="#000080">(</font>Size<font color="#000080">, </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">'  '</font><font color="#000080">;
            </font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>Files<font color="#000080">[</font>Index<font color="#000080">] + </font>Date <font color="#000080">+ </font><font color="#800000">'  ' </font><font color="#000080">+ </font>Time<font color="#000080">;
            </font>inc<font color="#000080">(</font>Index<font color="#000080">);
            </font>Totalsize <font color="#000080">:= </font>TotalSize <font color="#000080">+ </font>DirInfo<font color="#000080">.</font>Size<font color="#000080">;
            </font>Inc<font color="#000080">(</font>last<font color="#000080">);
            </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>FindFirst<font color="#000080">(</font>Path <font color="#000080">+ </font><font color="#800000">'*.COM'</font><font color="#000080">, </font>Archive<font color="#000080">, </font>DirInfo<font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
       begin
            </b></font>Str<font color="#000080">(</font>DirInfo<font color="#000080">.</font>Size<font color="#000080">, </font>Size<font color="#000080">);
            </font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>ExpandFName<font color="#000080">(</font>DirInfo<font color="#000080">.</font>Name<font color="#000080">);
            </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>Files<font color="#000080">[</font>Index<font color="#000080">]) &lt; </font><font color="#800000">22
                  </font><font color="#FF0000"><b>do </b></font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>Files<font color="#000080">[</font>Index<font color="#000080">] + </font><font color="#800000">' '</font><font color="#000080">;
            </font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>Files<font color="#000080">[</font>Index<font color="#000080">] + </font>RightJustify<font color="#000080">(</font>Size<font color="#000080">, </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">'  '</font><font color="#000080">;
            </font>Files<font color="#000080">[</font>Index<font color="#000080">] := </font>Files<font color="#000080">[</font>Index<font color="#000080">] + </font>Date <font color="#000080">+ </font><font color="#800000">'  ' </font><font color="#000080">+ </font>Time<font color="#000080">;
            </font>inc<font color="#000080">(</font>Index<font color="#000080">);
            </font>Totalsize <font color="#000080">:= </font>TotalSize <font color="#000080">+ </font>DirInfo<font color="#000080">.</font>Size<font color="#000080">;
            </font>Inc<font color="#000080">(</font>last<font color="#000080">);
            </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>repeat
       </b></font>done <font color="#000080">:= </font>True<font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>Index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>last <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
         if </b></font>files<font color="#000080">[</font>index<font color="#000080">] &gt; </font>files<font color="#000080">[</font>index <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>then
           begin
                </b></font>files<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>files<font color="#000080">[</font>index<font color="#000080">]; </font>files<font color="#000080">[</font>index<font color="#000080">] := </font>files<font color="#000080">[</font>index <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">];
                </font>files<font color="#000080">[</font>index <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>files<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]; </font>Done <font color="#000080">:= </font>False<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>until </b></font>done<font color="#000080">;
     </font>writeln<font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>last <font color="#FF0000"><b>do
       begin
         </b></font>writeln<font color="#000080">(</font>files<font color="#000080">[</font>index<font color="#000080">]);
         </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>index <font color="#000080">/ </font><font color="#800000">23</font><font color="#000080">) = </font>Trunc<font color="#000080">(</font>index <font color="#000080">/  </font><font color="#800000">23</font><font color="#000080">) </font><font color="#FF0000"><b>then
            begin
                 </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Press any key to continue...'</font><font color="#000080">);
                 </font><font color="#FF0000"><b>if </b></font>readkey <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>then </b></font>readkey<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>writeln<font color="#000080">;
     </font>WriteLn<font color="#000080">(</font><font color="#800000">'Directory of Executables '</font><font color="#000080">, </font>Path<font color="#000080">);
     </font>Str<font color="#000080">(</font>last<font color="#000080">, </font>StrVar<font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>StrVar<font color="#000080">) &lt; </font><font color="#800000">9 </font><font color="#FF0000"><b>do </b></font>StrVar <font color="#000080">:= </font><font color="#800000">' ' </font><font color="#000080">+ </font>StrVar<font color="#000080">;
     </font>StrVar <font color="#000080">:= </font>StrVar <font color="#000080">+ </font><font color="#800000">' file(s)  '</font><font color="#000080">;
     </font>Str<font color="#000080">(</font>TotalSize<font color="#000080">, </font>SV<font color="#000080">);
     </font>StrVar <font color="#000080">:= </font>StrVar <font color="#000080">+ </font>SV<font color="#000080">;
     </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>StrVar<font color="#000080">) &lt; </font><font color="#800000">32 </font><font color="#FF0000"><b>do </b></font>Insert<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>StrVar<font color="#000080">, </font><font color="#800000">19</font><font color="#000080">);
     </font>StrVar <font color="#000080">:= </font>StrVar <font color="#000080">+ </font><font color="#800000">' used'</font><font color="#000080">;
     </font>WriteLn<font color="#000080">(</font>StrVar<font color="#000080">);
     </font>Str<font color="#000080">(</font>DiskFree<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">), </font>StrVar<font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>StrVar<font color="#000080">) &lt; </font><font color="#800000">32 </font><font color="#FF0000"><b>do </b></font>StrVar <font color="#000080">:= </font><font color="#800000">' ' </font><font color="#000080">+ </font>StrVar<font color="#000080">;
     </font>WriteLn<font color="#000080">(</font>StrVar<font color="#000080">, </font><font color="#800000">' bytes free'</font><font color="#000080">);
     </font>Str<font color="#000080">(</font>DiskSize<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">), </font>StrVar<font color="#000080">);
     </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>StrVar<font color="#000080">) &lt; </font><font color="#800000">32 </font><font color="#FF0000"><b>do </b></font>StrVar <font color="#000080">:= </font><font color="#800000">' ' </font><font color="#000080">+ </font>StrVar<font color="#000080">;
     </font>WriteLn<font color="#000080">(</font>StrVar<font color="#000080">, </font><font color="#800000">' bytes capacity'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p></body>
</html>
