<html>
<head><title> "File Finder" by ROBERT ROTHENBURG</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>program </b></font>XFind<font color="#000080">(</font>input<font color="#000080">,</font>output<font color="#000080">);
  </font><font color="#FF0000"><b>uses </b></font>Dos<font color="#000080">,
       </font>FileSpec<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>FS<font color="#000080">: </font>TWildCard<font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>WriteSpec<font color="#000080">(</font>Name<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
   </b></font>Name <font color="#000080">:= </font>FExpand<font color="#000080">(</font>Name<font color="#000080">);
   </font>WriteLn<font color="#000080">(</font>Name<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>FindFiles<font color="#000080">(</font>Dir<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Search<font color="#000080">:  </font>SearchRec<font color="#000080">;
  </font>CurDir<font color="#000080">:  </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>DirList<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
  </font>i<font color="#000080">,
  </font>DirNum<font color="#000080">:  </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>CurDir <font color="#000080">:= </font>FExpand<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Dir<font color="#000080">&lt;&gt;</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Dir<font color="#000080">&lt;&gt;</font><font color="#800000">'..'</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
    </b></font>ChDir<font color="#000080">(</font>FExpand<font color="#000080">(</font>Dir<font color="#000080">));
    </font>DirNum <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>FindFirst<font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">,</font>AnyFile<font color="#000080">,</font>Search<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>DosError<font color="#000080">&lt;&gt;</font><font color="#800000">18 </font><font color="#FF0000"><b>then begin
         if </b></font>Search<font color="#000080">.</font>Attr<font color="#000080">=</font>Directory
           <font color="#FF0000"><b>then begin
               </b></font>inc<font color="#000080">(</font>DirNum<font color="#000080">);
               </font>DirList<font color="#000080">[ </font>DirNum <font color="#000080">] := </font>Search<font color="#000080">.</font>Name<font color="#000080">;
             </font><font color="#FF0000"><b>end
           else if </b></font>FS<font color="#000080">.</font>FitSpec<font color="#000080">(</font>Search<font color="#000080">.</font>Name<font color="#000080">)
             </font><font color="#FF0000"><b>then </b></font>WriteSpec<font color="#000080">(</font>Search<font color="#000080">.</font>Name<font color="#000080">);
         </font><font color="#FF0000"><b>repeat
           </b></font>FindNext<font color="#000080">(</font>Search<font color="#000080">);
           </font><font color="#FF0000"><b>if </b></font>DosError<font color="#000080">&lt;&gt;</font><font color="#800000">18
             </font><font color="#FF0000"><b>then if </b></font>Search<font color="#000080">.</font>Attr<font color="#000080">=</font>Directory
               <font color="#FF0000"><b>then begin
                  </b></font>inc<font color="#000080">(</font>DirNum<font color="#000080">);
                  </font>DirList<font color="#000080">[ </font>DirNum <font color="#000080">] := </font>Search<font color="#000080">.</font>Name<font color="#000080">;
                 </font><font color="#FF0000"><b>end
               else if </b></font>FS<font color="#000080">.</font>FitSpec<font color="#000080">(</font>Search<font color="#000080">.</font>Name<font color="#000080">)
                  </font><font color="#FF0000"><b>then </b></font>WriteSpec<font color="#000080">(</font>Search<font color="#000080">.</font>Name<font color="#000080">);
         </font><font color="#FF0000"><b>until </b></font>DosError <font color="#000080">= </font><font color="#800000">18</font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>DirNum<font color="#000080">&lt;&gt;</font><font color="#800000">0
      </font><font color="#FF0000"><b>then for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>DirNum <font color="#FF0000"><b>do </b></font>FindFiles<font color="#000080">(</font>DirList<font color="#000080">[</font>i<font color="#000080">]);
    </font>ChDir<font color="#000080">(</font>CurDir<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">:      </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>ParamCount <font color="#000080">= </font><font color="#800000">0
    </font><font color="#FF0000"><b>then </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Usage: XFIND file1 [file2 file3 ... ]'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else begin
       </b></font>FS<font color="#000080">.</font>Init<font color="#000080">;
       </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ParamCount <font color="#FF0000"><b>do </b></font>FS<font color="#000080">.</font>AddSpec<font color="#000080">(</font>ParamStr<font color="#000080">(</font>i<font color="#000080">));
       </font>FindFiles<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">);
       </font>FS<font color="#000080">.</font>Done<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p></body>
</html>
