<html>
<head><title> "DOS INI File Manipulations" by THOMAS BARGHOLZ</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{****************************************}
{*           DOSINI.PAS 1.20            *}
{*                                      *}
{*       Author : Thomas Bargholz       *}
{*     Written : August 10th, 1994      *}
{*                                      *}
{*    Donated to the Public Domain      *}
{****************************************}
{

This unit implements a Windows style .INI file for DOS applications, by
supplying easy and fast access to the exact infomation in the .INI file
of your choise.
The Windows API supplies functions to retrieve information in .INI files,
but are (ofcource) directed at Windows. Now DOS real and pmode programs
can use .INI files just as easy.
As in Windows, the DOS .INI files must have the format:

[section]
entry=profile

By supplying the .INI filename, the section name, and the entry name,
DOSINI will return the profile.
The .INI file can be placed anywhere, but this unit supplies two functions
to locate the DOS directory and your applications home directory, so if
you place your .INI file in one of those directories, you can locate
your .INI files easily.

This unit uses TurboPowers Objecty Professional (OPRO):
TurboPower : US phone    : 800-333-4160
             Other phone : 719-260-9136
             Fax         : 719-260-7151
If you don't have OPRO, it's still possible to use this unit. Simply
undefine OPRO below.

If you have any comments, suggestions or bug reports, please contact me:

e-mail    : tba@m.dia.dk
snail mail: Thomas Bargholz
            Smallegade 20, 3 tv.
            DK-2000 Frederiksberg
            Denmark

Changes:

06.09.94:     Added DEFINE OPRO. Create simmilar functions of those in
              OPRO for those of you that don't have OPRO.
26.09.94:     Removed bug in WriteProfileString. Tanks to Germano Rossi
              for giving me this bugfix. (germano@chiostro.univr.it)

}

{$IFDEF WINDOWS}
  </i></font>Use the Windows API<font color="#000080">, </font>it <font color="#FF0000"><b>is </b></font>better <font color="#FF0000"><b>for </b></font>this purpose <font color="#000080">!!!
</font><font color="#008000"><i>{$ENDIF}

{$DEFINE DEBUG}  {Include debug info in TPU}

{$DEFINE OPRO}   {Undefine this if you don't have OPRO - It'll still compile}

{$IFDEF DEBUG}
  {$A+,D+,I-,L+,R+,X+,Y+}
{$ELSE}
  {$A+,D-,I-,L-,R-,X+,Y-}
{$ENDIF}
{Fee free to change the compiler directives above, but please leave the I-}

</i></font><font color="#FF0000"><b>Unit </b></font>DosIni<font color="#000080">;

</font><font color="#FF0000"><b>Interface

</b></font><font color="#008000"><i>{------ Read a profile in a .INI file ------}

</i></font><font color="#FF0000"><b>Function </b></font>GetProfileStr<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry<font color="#000080">, </font><font color="#FF0000"><b>Default </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{- Read a string in a .INI file}

</i></font><font color="#FF0000"><b>Function </b></font>GetProfileInt<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Default </b></font><font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{- Read a Integer in a .INI file}

</i></font><font color="#FF0000"><b>Function </b></font>GetProfileLong<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Default </b></font><font color="#000080">: </font>LongInt<font color="#000080">) : </font>LongInt<font color="#000080">;
  </font><font color="#008000"><i>{- Read a LongInt in a .INI file}

</i></font><font color="#FF0000"><b>Function </b></font>GetProfileReal<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Default </b></font><font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>{- Read a Real in a .INI file}

{------ Write a profile to .INI file ------}

</i></font><font color="#FF0000"><b>Function </b></font>WriteProfileStr<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry<font color="#000080">, </font>Str <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{- Write a string to a .INI file}

</i></font><font color="#FF0000"><b>Function </b></font>WriteProfileInt<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Int <font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{- Write a Integer to a .INI file}

</i></font><font color="#FF0000"><b>Function </b></font>WriteProfileLong<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Long <font color="#000080">: </font>LongInt<font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{- Write a LongInt to a .INI file}

</i></font><font color="#FF0000"><b>Function </b></font>WriteProfileReal<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>R <font color="#000080">: </font>Real<font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{- Write a Real to a .INI file}

{------ Directory related functions ------}

</i></font><font color="#FF0000"><b>Function </b></font>GetDOSDirectory <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{- Returns the path to the DOS directory}

</i></font><font color="#FF0000"><b>Function </b></font>GetHomeDirectory <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{- Returns the path to the applications home directory}


</i></font><font color="#FF0000"><b>Implementation

</b></font><font color="#008000"><i>{$IFDEF OPRO}

</i></font><font color="#FF0000"><b>Uses
  </b></font>OpDos<font color="#000080">,
  </font>OpString<font color="#000080">;

</font><font color="#008000"><i>{$ELSE}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ExistOnPath<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>FullPath <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>ExistOnPath <font color="#000080">:= </font>False<font color="#000080">;
  </font>S <font color="#000080">:= </font>FSearch<font color="#000080">(</font>FileName<font color="#000080">,</font>GetEnv<font color="#000080">(</font><font color="#800000">'PATH'</font><font color="#000080">));
  </font><font color="#FF0000"><b>If </b></font>S <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then
  Begin
    </b></font>ExistOnPath <font color="#000080">:= </font>True<font color="#000080">;
    </font>FullPath <font color="#000080">:= </font>FExpand<font color="#000080">(</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>JustPathName<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>D <font color="#000080">: </font>DirStr<font color="#000080">;
  </font>N <font color="#000080">: </font>NameStr<font color="#000080">;
  </font>E <font color="#000080">: </font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>FSplit<font color="#000080">(</font>FileName<font color="#000080">,</font>D<font color="#000080">,</font>N<font color="#000080">,</font>E<font color="#000080">);
  </font>JustPathName <font color="#000080">:= </font>D<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StUpCase<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Tmp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Tmp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>S <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then
    For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>Do
      </b></font>Tmp <font color="#000080">:= </font>Tmp <font color="#000080">+ </font>UpCase<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">]);
  </font>StUpCase <font color="#000080">:= </font>Tmp<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Str2Int<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>I <font color="#000080">: </font>Integer<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Error <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Str2Int <font color="#000080">:= </font>False<font color="#000080">;
  </font>Val<font color="#000080">(</font>S<font color="#000080">,</font>I<font color="#000080">,</font>Error<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Error <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>Str2Int <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Str2Long<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>I <font color="#000080">: </font>LongInt<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Error <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Str2Long <font color="#000080">:= </font>False<font color="#000080">;
  </font>Val<font color="#000080">(</font>S<font color="#000080">,</font>I<font color="#000080">,</font>Error<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Error <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
  Begin
    </b></font>Str2Long <font color="#000080">:= </font>True<font color="#000080">;
    </font>I <font color="#000080">:= </font>LongInt<font color="#000080">(</font>I<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ExistFile<font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>ExistFile <font color="#000080">:= </font>False<font color="#000080">;
  </font>S <font color="#000080">:= </font>FSearch<font color="#000080">(</font>FileName<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>S <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then
    </b></font>ExistFile <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>Function </b></font>GetProfileStr<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry<font color="#000080">, </font><font color="#FF0000"><b>Default </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{- Read a string in a .INI file}
</i></font><font color="#FF0000"><b>Var
  </b></font>F <font color="#000080">: </font>Text<font color="#000080">;
  </font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Assign<font color="#000080">(</font>F<font color="#000080">,</font>IniName<font color="#000080">);
  </font>Reset<font color="#000080">(</font>F<font color="#000080">);                       </font><font color="#008000"><i>{Open the file}
  </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then           </b></font><font color="#008000"><i>{Success?}
  </i></font><font color="#FF0000"><b>Begin
    </b></font>GetProfileStr <font color="#000080">:= </font><font color="#FF0000"><b>Default</b></font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat                          </b></font><font color="#008000"><i>{Find the right section}
    </i></font>ReadLn<font color="#000080">(</font>F<font color="#000080">,</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>StUpCase<font color="#000080">(</font>S<font color="#000080">) = </font>StUpCase<font color="#000080">(</font><font color="#800000">'['</font><font color="#000080">+</font>Section<font color="#000080">+</font><font color="#800000">']'</font><font color="#000080">)) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Eof<font color="#000080">(</font>F<font color="#000080">));
  </font><font color="#FF0000"><b>If Not </b></font>Eof<font color="#000080">(</font>F<font color="#000080">) </font><font color="#FF0000"><b>Then
  Begin
    Repeat
      </b></font>ReadLn<font color="#000080">(</font>F<font color="#000080">,</font>S<font color="#000080">);                </font><font color="#008000"><i>{Find the right entry}
      </i></font>I <font color="#000080">:= </font>Pos<font color="#000080">(</font>StUpCase<font color="#000080">(</font>Entry<font color="#000080">+</font><font color="#800000">'='</font><font color="#000080">),</font>StUpCase<font color="#000080">(</font>S<font color="#000080">));
    </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>I <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Eof<font color="#000080">(</font>F<font color="#000080">));
    </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then                 </b></font><font color="#008000"><i>{Extract the profile string}
      </i></font>S <font color="#000080">:= </font>Copy<font color="#000080">(</font>S<font color="#000080">,</font>Length<font color="#000080">(</font>Entry<font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">,</font>Length<font color="#000080">(</font>S<font color="#000080">))
    </font><font color="#FF0000"><b>Else
      </b></font>S <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>End
  Else
    </b></font>S <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>Close<font color="#000080">(</font>F<font color="#000080">);                       </font><font color="#008000"><i>{Close the .INI file, we're done}
  </i></font><font color="#FF0000"><b>If </b></font>S <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then
    </b></font>GetProfileStr <font color="#000080">:= </font>S
  <font color="#FF0000"><b>Else
    </b></font>GetProfileStr <font color="#000080">:= </font><font color="#FF0000"><b>Default</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GetProfileInt<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Default </b></font><font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{- Read a Integer in a .INI file}
</i></font><font color="#FF0000"><b>Var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>S <font color="#000080">:= </font>GetProfileStr<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry<font color="#000080">, </font><font color="#800000">'{@}'</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>S <font color="#000080">= </font><font color="#800000">'{@}' </font><font color="#FF0000"><b>Then
    </b></font>GetProfileInt <font color="#000080">:= </font><font color="#FF0000"><b>Default
  Else
  Begin
    If Not </b></font>Str2Int<font color="#000080">(</font>S<font color="#000080">,</font>I<font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>GetProfileInt <font color="#000080">:= </font><font color="#FF0000"><b>Default
    Else
      </b></font>GetProfileInt <font color="#000080">:= </font>I<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GetProfileLong<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Default </b></font><font color="#000080">: </font>LongInt<font color="#000080">) : </font>LongInt<font color="#000080">;
  </font><font color="#008000"><i>{- Read a LongInt in a .INI file}
</i></font><font color="#FF0000"><b>Var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>L <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>S <font color="#000080">:= </font>GetProfileStr<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry<font color="#000080">, </font><font color="#800000">'{@}'</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>S <font color="#000080">= </font><font color="#800000">'{@}' </font><font color="#FF0000"><b>Then
    </b></font>GetProfileLong <font color="#000080">:= </font><font color="#FF0000"><b>Default
  Else
  Begin
    If Not </b></font>Str2Long<font color="#000080">(</font>S<font color="#000080">,</font>L<font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>GetProfileLong <font color="#000080">:= </font><font color="#FF0000"><b>Default
    Else
      </b></font>GetProfileLong <font color="#000080">:= </font>L<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GetProfileReal<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Default </b></font><font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>{- Read a Real in a .INI file}
</i></font><font color="#FF0000"><b>Var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>R <font color="#000080">: </font>Real<font color="#000080">;
  </font>Error <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>S <font color="#000080">:= </font>GetProfileStr<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry<font color="#000080">, </font><font color="#800000">'{@}'</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>S <font color="#000080">= </font><font color="#800000">'{@}' </font><font color="#FF0000"><b>Then
    </b></font>GetProfileReal <font color="#000080">:= </font><font color="#FF0000"><b>Default
  Else
  Begin
    </b></font>Val<font color="#000080">(</font>S<font color="#000080">,</font>R<font color="#000080">,</font>Error<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Error <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
      </b></font>GetProfileReal <font color="#000080">:= </font><font color="#FF0000"><b>Default
    Else
      </b></font>GetProfileReal <font color="#000080">:= </font>R<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>WriteProfileStr<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry<font color="#000080">, </font>Str <font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{- Write a string to a .INI file}
</i></font><font color="#FF0000"><b>Var
  </b></font>F1<font color="#000080">, </font>F2 <font color="#000080">: </font>Text<font color="#000080">;
  </font>I <font color="#000080">: </font>Integer<font color="#000080">;
  </font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>SectionOK<font color="#000080">, </font>EntryOK <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If Not </b></font>ExistFile<font color="#000080">(</font>IniName<font color="#000080">) </font><font color="#FF0000"><b>Then  </b></font><font color="#008000"><i>{If the file dosen't exist, create it}
  </i></font><font color="#FF0000"><b>Begin
    </b></font>Assign<font color="#000080">(</font>F1<font color="#000080">,</font>IniName<font color="#000080">);
    </font>Rewrite<font color="#000080">(</font>F1<font color="#000080">);
    </font>I <font color="#000080">:= </font>IOResult<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Close<font color="#000080">(</font>F1<font color="#000080">);
      </font>WriteProfileStr <font color="#000080">:= </font>I<font color="#000080">;
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>WriteLn<font color="#000080">(</font>F1<font color="#000080">,</font><font color="#800000">'['</font><font color="#000080">+</font>Section<font color="#000080">+</font><font color="#800000">']'</font><font color="#000080">);   </font><font color="#008000"><i>{Write the section header}
    </i></font>WriteLn<font color="#000080">(</font>F1<font color="#000080">,</font>Entry<font color="#000080">+</font><font color="#800000">'='</font><font color="#000080">+</font>Str<font color="#000080">);     </font><font color="#008000"><i>{Write the entry and the profile string}
    </i></font>WriteLn<font color="#000080">(</font>F1<font color="#000080">);
    </font>Close<font color="#000080">(</font>F1<font color="#000080">);
  </font><font color="#FF0000"><b>End
  Else                            </b></font><font color="#008000"><i>{If the file do exist}
  </i></font><font color="#FF0000"><b>Begin
    </b></font>Assign<font color="#000080">(</font>F1<font color="#000080">,</font>IniName<font color="#000080">);
    </font>Reset<font color="#000080">(</font>F1<font color="#000080">);
    </font>I <font color="#000080">:= </font>IOResult<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Close<font color="#000080">(</font>F1<font color="#000080">);
      </font>WriteProfileStr <font color="#000080">:= </font>I<font color="#000080">;
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Assign<font color="#000080">(</font>F2<font color="#000080">,</font><font color="#800000">'DOSINI$$.$$$'</font><font color="#000080">);
    </font>Rewrite<font color="#000080">(</font>F2<font color="#000080">);
    </font>I<font color="#000080">:= </font>IOResult<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>WriteProfileStr <font color="#000080">:= </font>I<font color="#000080">;
      </font>Close<font color="#000080">(</font>F1<font color="#000080">);
      </font>Close<font color="#000080">(</font>F2<font color="#000080">);
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>SectionOK <font color="#000080">:= </font>False<font color="#000080">;
    </font>EntryOK <font color="#000080">:= </font>False<font color="#000080">;
    </font><font color="#FF0000"><b>While Not </b></font>Eof<font color="#000080">(</font>F1<font color="#000080">) </font><font color="#FF0000"><b>Do
    Begin
      </b></font>ReadLn<font color="#000080">(</font>F1<font color="#000080">,</font>S<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>StUpCase<font color="#000080">(</font>S<font color="#000080">) = </font>StUpCase<font color="#000080">(</font><font color="#800000">'['</font><font color="#000080">+</font>Section<font color="#000080">+</font><font color="#800000">']'</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      Begin
        </b></font>SectionOK <font color="#000080">:= </font>True<font color="#000080">;        </font><font color="#008000"><i>{We've found the section}
        </i></font>WriteLn<font color="#000080">(</font>F2<font color="#000080">,</font>S<font color="#000080">);
        </font><font color="#FF0000"><b>Repeat
          </b></font>ReadLn<font color="#000080">(</font>F1<font color="#000080">,</font>S<font color="#000080">);
          </font>I <font color="#000080">:= </font>Pos<font color="#000080">(</font>StUpCase<font color="#000080">(</font>Entry<font color="#000080">+</font><font color="#800000">'='</font><font color="#000080">),</font>StUpCase<font color="#000080">(</font>S<font color="#000080">));
          </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
          Begin
            </b></font>EntryOK <font color="#000080">:= </font>True<font color="#000080">;      </font><font color="#008000"><i>{We've found the entry}
            </i></font>WriteLn<font color="#000080">(</font>F2<font color="#000080">,</font>Entry<font color="#000080">+</font><font color="#800000">'='</font><font color="#000080">+</font>Str<font color="#000080">);
          </font><font color="#FF0000"><b>End
          Else
            If </b></font><font color="#000080">(</font>S <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'['</font><font color="#000080">,</font>S<font color="#000080">)=</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then
            Begin
              </b></font>WriteLn<font color="#000080">(</font>F2<font color="#000080">,</font>Entry<font color="#000080">+</font><font color="#800000">'='</font><font color="#000080">+</font>Str<font color="#000080">);
              </font>EntryOK <font color="#000080">:= </font>True<font color="#000080">;
            </font><font color="#FF0000"><b>End
            Else
              </b></font>WriteLn<font color="#000080">(</font>F2<font color="#000080">,</font>S<font color="#000080">);
        </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'['</font><font color="#000080">,</font>S<font color="#000080">)=</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Eof<font color="#000080">(</font>F1<font color="#000080">)) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>EntryOK<font color="#000080">);
        </font><font color="#FF0000"><b>If Not </b></font>EntryOK <font color="#FF0000"><b>Then
        Begin
          </b></font>WriteLn<font color="#000080">(</font>F2<font color="#000080">,</font>Entry<font color="#000080">+</font><font color="#800000">'='</font><font color="#000080">+</font>Str<font color="#000080">);
          </font>WriteLn<font color="#000080">(</font>F2<font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End
      Else
        </b></font>WriteLn<font color="#000080">(</font>F2<font color="#000080">,</font>S<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>SectionOK<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>EntryOK<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font><font color="#008000"><i>{We have made the change}
      </i></font><font color="#FF0000"><b>Begin
        Repeat
          </b></font>ReadLn<font color="#000080">(</font>F1<font color="#000080">,</font>S<font color="#000080">);
          </font>WriteLn<font color="#000080">(</font>F2<font color="#000080">,</font>S<font color="#000080">);
        </font><font color="#FF0000"><b>Until </b></font>Eof<font color="#000080">(</font>F1<font color="#000080">);
        </font>Close<font color="#000080">(</font>F1<font color="#000080">);
        </font>Erase<font color="#000080">(</font>F1<font color="#000080">);
        </font>Close<font color="#000080">(</font>F2<font color="#000080">);
        </font>Rename<font color="#000080">(</font>F2<font color="#000080">, </font>IniName<font color="#000080">);
        </font>WriteProfileStr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;     </font><font color="#008000"><i>{Every thing OK -&gt; Return 0}
        </i></font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If Not </b></font>SectionOK <font color="#FF0000"><b>Then
    Begin
      </b></font>WriteLn<font color="#000080">(</font>F2<font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>F2<font color="#000080">,</font><font color="#800000">'['</font><font color="#000080">+</font>Section<font color="#000080">+</font><font color="#800000">']'</font><font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>F2<font color="#000080">,</font>Entry<font color="#000080">+</font><font color="#800000">'='</font><font color="#000080">+</font>Str<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Close<font color="#000080">(</font>F1<font color="#000080">);
    </font>Erase<font color="#000080">(</font>F1<font color="#000080">);
    </font>Close<font color="#000080">(</font>F2<font color="#000080">);
    </font>Rename<font color="#000080">(</font>F2<font color="#000080">, </font>IniName<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>WriteProfileStr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;           </font><font color="#008000"><i>{Every thing OK -&gt; Return 0}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>WriteProfileInt<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Int <font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{- Write a Integer to a .INI file}
</i></font><font color="#FF0000"><b>Var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Str<font color="#000080">(</font>Int<font color="#000080">,</font>S<font color="#000080">);
  </font>I <font color="#000080">:= </font>WriteProfileStr<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry<font color="#000080">, </font>S<font color="#000080">);
  </font>WriteProfileInt <font color="#000080">:= </font>I<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>WriteProfileLong<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Long <font color="#000080">: </font>LongInt<font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{- Write a Integer to a .INI file}
</i></font><font color="#FF0000"><b>Var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Str<font color="#000080">(</font>Long<font color="#000080">,</font>S<font color="#000080">);
  </font>I <font color="#000080">:= </font>WriteProfileStr<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry<font color="#000080">, </font>S<font color="#000080">);
  </font>WriteProfileLong <font color="#000080">:= </font>I<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>WriteProfileReal<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>R <font color="#000080">: </font>Real<font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{- Write a Real to a .INI file}
</i></font><font color="#FF0000"><b>Var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Str<font color="#000080">(</font>R<font color="#000080">,</font>S<font color="#000080">);
  </font>I <font color="#000080">:= </font>WriteProfileStr<font color="#000080">(</font>IniName<font color="#000080">, </font>Section<font color="#000080">, </font>Entry<font color="#000080">, </font>S<font color="#000080">);
  </font>WriteProfileReal <font color="#000080">:= </font>I<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GetDOSDirectory <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{- Returns the path to the DOS directory}
</i></font><font color="#FF0000"><b>Var
  </b></font>Name <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If Not </b></font>ExistOnPath<font color="#000080">(</font><font color="#800000">'FDISK.EXE'</font><font color="#000080">,</font>Name<font color="#000080">) </font><font color="#FF0000"><b>Then    </b></font><font color="#008000"><i>{Is FDISK.EXE on the path?}
  </i></font><font color="#FF0000"><b>Begin
    If Not </b></font>ExistOnPath<font color="#000080">(</font><font color="#800000">'SETVER.EXE'</font><font color="#000080">,</font>Name<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font><font color="#008000"><i>{Is SETVER.EXE on the path?}
      </i></font>GetDOSDirectory <font color="#000080">:= </font><font color="#800000">''
    </font><font color="#FF0000"><b>Else
      </b></font>GetDOSDirectory <font color="#000080">:= </font>JustPathName<font color="#000080">(</font>Name<font color="#000080">);
  </font><font color="#FF0000"><b>End
  Else
    </b></font>GetDOSDirectory <font color="#000080">:= </font>JustPathName<font color="#000080">(</font>Name<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GetHomeDirectory <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{- Returns the path to the applications home directory}
</i></font><font color="#FF0000"><b>Begin
  </b></font>GetHomeDirectory <font color="#000080">:= </font>JustPathName<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">));
  </font><font color="#008000"><i>{This function only returns an empty string, when using it in the IDE, but
   din't worry; It works when the program using it is compiled}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.


</font><font color="#008000"><i>{ ---------------------------   DEMO PROGRAM  ------------------------- }
{ CUT }

{********************************************}
{*               EXAMPLE.PAS                *}
{* Sample application using the DOSINI unit *}
{********************************************}

</i></font><font color="#FF0000"><b>Uses
  </b></font>DosIni<font color="#000080">, </font><font color="#008000"><i>{&lt;-- Easy INI file manipulation}
  </i></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>IniFile <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">'EXAMPLE.INI'</font><font color="#000080">;
  </font>GrSection <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">'Graphics'</font><font color="#000080">;
  </font>SndSection <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">'Sound'</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>No <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Day<font color="#000080">, </font>Month<font color="#000080">, </font>Year<font color="#000080">, </font>WeekDay <font color="#000080">: </font>Word<font color="#000080">;
  </font>Hour<font color="#000080">, </font>Minute<font color="#000080">, </font>Sec<font color="#000080">, </font>Sec100 <font color="#000080">: </font>Word<font color="#000080">;
  </font>S<font color="#000080">, </font>Date<font color="#000080">, </font>Time <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{First extract information from the INI file :}

  {First the setting in the 'Graphics' section...}
  </i></font>WriteLn<font color="#000080">(</font><font color="#800000">'------- Initializing graphics -------'</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Using graphics driver : '</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>GetProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'Driver'</font><font color="#000080">,</font><font color="#800000">'egavga.bgi'</font><font color="#000080">));
  </font>Write<font color="#000080">(</font><font color="#800000">'Resolution : '</font><font color="#000080">);
  </font>Write<font color="#000080">(</font>GetProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'HorzRes'</font><font color="#000080">,</font><font color="#800000">640</font><font color="#000080">));
  </font>Write<font color="#000080">(</font><font color="#800000">'x'</font><font color="#000080">,</font>GetProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'VertRes'</font><font color="#000080">,</font><font color="#800000">480</font><font color="#000080">));
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'x'</font><font color="#000080">,</font>GetProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'Colors'</font><font color="#000080">,</font><font color="#800000">16</font><font color="#000080">));

  </font><font color="#008000"><i>{Then the settings in the 'Sound' section...}
  </i></font>WriteLn<font color="#000080">(</font><font color="#800000">'-------- Initializing sound ---------'</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Using sound driver : '</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>GetProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font>SndSection<font color="#000080">,</font><font color="#800000">'Driver'</font><font color="#000080">,</font><font color="#800000">'ibm.drv'</font><font color="#000080">));

  </font><font color="#008000"><i>{And finally the settings in the 'Control' section...}
  </i></font>WriteLn<font color="#000080">(</font><font color="#800000">'------- Initializing controls -------'</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Using joystick : '</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>GetProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font><font color="#800000">'Control'</font><font color="#000080">,</font><font color="#800000">'Joystick'</font><font color="#000080">,</font><font color="#800000">'No'</font><font color="#000080">));
  </font>Write<font color="#000080">(</font><font color="#800000">'Using mouse : '</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>GetProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font><font color="#800000">'Control'</font><font color="#000080">,</font><font color="#800000">'Mouse'</font><font color="#000080">,</font><font color="#800000">'Yes'</font><font color="#000080">));
  </font>Write<font color="#000080">(</font><font color="#800000">'Using keyboard : '</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>GetProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font><font color="#800000">'Control'</font><font color="#000080">,</font><font color="#800000">'Keyboard'</font><font color="#000080">,</font><font color="#800000">'No'</font><font color="#000080">));
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'-------------------------------------'#10#13</font><font color="#000080">);

  </font><font color="#008000"><i>{Now lets get some user info, and place it in the INI file:}

  {First a new graphic resolution...}
  </i></font>WriteLn<font color="#000080">(</font><font color="#800000">'Select new graphic resolution :'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">' 1) 320x200x16'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">' 2) 320x200x255'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">' 3) 640x480x16'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">' 4) 640x480x255'</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Type 1-4 for selection : '</font><font color="#000080">);
  </font>ReadLn<font color="#000080">(</font>No<font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>No <font color="#FF0000"><b>Of
    </b></font><font color="#800000">1 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin
          If </b></font>WriteProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'Driver'</font><font color="#000080">,</font><font color="#800000">'egavga.bgi'</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting new driver'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'HorzRes'</font><font color="#000080">,</font><font color="#800000">320</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 1'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'VertRes'</font><font color="#000080">,</font><font color="#800000">200</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 2'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'Colors'</font><font color="#000080">,</font><font color="#800000">16</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 3'</font><font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#800000">2 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin
          If </b></font>WriteProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'Driver'</font><font color="#000080">,</font><font color="#800000">'svga.bgi'</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting new driver'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'HorzRes'</font><font color="#000080">,</font><font color="#800000">320</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 1'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'VertRes'</font><font color="#000080">,</font><font color="#800000">200</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 2'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'Colors'</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 3'</font><font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#800000">3 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin
          If </b></font>WriteProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'Driver'</font><font color="#000080">,</font><font color="#800000">'egavga.bgi'</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting new driver'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'HorzRes'</font><font color="#000080">,</font><font color="#800000">640</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 1'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'VertRes'</font><font color="#000080">,</font><font color="#800000">480</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 2'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'Colors'</font><font color="#000080">,</font><font color="#800000">16</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 3'</font><font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#800000">4 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin
          If </b></font>WriteProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'Driver'</font><font color="#000080">,</font><font color="#800000">'svga.bgi'</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting new driver'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'HorzRes'</font><font color="#000080">,</font><font color="#800000">640</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 1'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'VertRes'</font><font color="#000080">,</font><font color="#800000">480</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 2'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>WriteProfileInt<font color="#000080">(</font>IniFile<font color="#000080">,</font>GrSection<font color="#000080">,</font><font color="#800000">'Colors'</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
            </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting initialization data 3'</font><font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#008000"><i>{Then a new sound'driver...}
  </i></font>WriteLn<font color="#000080">(</font><font color="#800000">#10#13'Select sound device :'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">' 1) Sound Blaster'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">' 2) Adlib Gold'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">' 3) PC speaker'</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Type 1-3 for selection : '</font><font color="#000080">);
  </font>ReadLn<font color="#000080">(</font>No<font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>No <font color="#FF0000"><b>Of
    </b></font><font color="#800000">1 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>WriteProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font>SndSection<font color="#000080">,</font><font color="#800000">'Driver'</font><font color="#000080">,</font><font color="#800000">'sblast.drv'</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
          </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting driver info'</font><font color="#000080">);
    </font><font color="#800000">2 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>WriteProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font>SndSection<font color="#000080">,</font><font color="#800000">'Driver'</font><font color="#000080">,</font><font color="#800000">'adlib.drv'</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
          </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting driver info'</font><font color="#000080">);
    </font><font color="#800000">3 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>WriteProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font>SndSection<font color="#000080">,</font><font color="#800000">'Driver'</font><font color="#000080">,</font><font color="#800000">'ibm.drv'</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
          </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error setting driver info'</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#008000"><i>{Now, let's add a new section to the INI file...}
  </i></font>GetDate<font color="#000080">(</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>WeekDay<font color="#000080">);
  </font>Str<font color="#000080">(</font>Day<font color="#000080">,</font>S<font color="#000080">);
  </font>Date <font color="#000080">:= </font>S<font color="#000080">;
  </font>Str<font color="#000080">(</font>Month<font color="#000080">,</font>S<font color="#000080">);
  </font>Date <font color="#000080">:= </font>Date <font color="#000080">+ </font><font color="#800000">'/'</font><font color="#000080">+</font>S<font color="#000080">;
  </font>Str<font color="#000080">(</font>Year<font color="#000080">,</font>S<font color="#000080">);
  </font>Date <font color="#000080">:= </font>Date <font color="#000080">+ </font><font color="#800000">'/'</font><font color="#000080">+</font>S<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>WriteProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font><font color="#800000">'Modified'</font><font color="#000080">,</font><font color="#800000">'Date'</font><font color="#000080">,</font>Date<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error writing date'</font><font color="#000080">);

  </font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">);
  </font>Str<font color="#000080">(</font>Hour<font color="#000080">,</font>S<font color="#000080">);
  </font>Time <font color="#000080">:= </font>s<font color="#000080">;
  </font>Str<font color="#000080">(</font>Minute<font color="#000080">,</font>S<font color="#000080">);
  </font>Time <font color="#000080">:= </font>Time <font color="#000080">+ </font><font color="#800000">':'</font><font color="#000080">+ </font>S<font color="#000080">;
  </font>Str<font color="#000080">(</font>Sec<font color="#000080">,</font>S<font color="#000080">);
  </font>Time <font color="#000080">:= </font>Time <font color="#000080">+ </font><font color="#800000">':' </font><font color="#000080">+ </font>S<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>WriteProfileStr<font color="#000080">(</font>IniFile<font color="#000080">,</font><font color="#800000">'Modified'</font><font color="#000080">,</font><font color="#800000">'Time'</font><font color="#000080">,</font>Time<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error writing time'</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ---------------------- DEMO INI FILE }
{ CUT AND SAVE AS EXAMPLE.INI }

</i></font><font color="#000080">[</font>Graphics<font color="#000080">]
</font>Driver<font color="#000080">=</font>egavga<font color="#000080">.</font>bgi
HorzRes<font color="#000080">=</font><font color="#800000">320
</font>VertRes<font color="#000080">=</font><font color="#800000">200
</font>Colors<font color="#000080">=</font><font color="#800000">16

</font><font color="#000080">[</font>Sound<font color="#000080">]
</font>Driver<font color="#000080">=</font>sblast<font color="#000080">.</font>drv

<font color="#000080">[</font>Control<font color="#000080">]
</font>Joystick<font color="#000080">=</font>No
Mouse<font color="#000080">=</font>Yes
Keyboard<font color="#000080">=</font>Yes

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p></body>
</html>
