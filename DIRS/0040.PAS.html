<html>
<head><title> "Select DIR progarm" by ARNE DE BRUIJN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0040.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Program </b></font>DIRSEL<font color="#000080">;
</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">,</font>Dos<font color="#000080">; </font><font color="#008000"><i>{ ** needed for DIRSELECT functions ** }

{ ** The following Type &amp; Var declarations are for the main program only ** }
{ ** However, the string length of the returned parameter from DIRSELECT ** }
{ ** must be a least 12 characters.  ** }

</i></font><font color="#FF0000"><b>Type
  </b></font>strtype <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
</font><font color="#FF0000"><b>Var
  </b></font>spec<font color="#000080">,</font>fname <font color="#000080">: </font>strtype<font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************** }
{ ** List of Procedures/Functions needed for DIRSELECT** }
{ ** Procedure CURSOR - turns cursor on or off** }
{ ** Procedure FRAME - draws single or double frame ** }
{ ** Function ISCOLOR - returns the current video mode** }
{ ** Procedure SAVESCR- saves current video screen** }
{ ** Procedure RESTORESCR - restores old video screen ** }
{ ** Procedure SCRGET - get character/attribute  ** }
{ ** Procedure SCRPUT - put character/attribute  ** }
{ ** Procedure FNAMEPOS  - finds proper screen position ** }
{ ** Procedure HILITE - highlights proper name** }
{ ** Function DIRSELECT  - directory selector** }
{ ************************************************************************** }

</i></font><font color="#FF0000"><b>Procedure </b></font>CURSOR<font color="#000080">( </font>attrib <font color="#000080">: </font>Boolean <font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If NOT </b></font>attrib <font color="#FF0000"><b>Then </b></font><font color="#008000"><i>{ turn cursor off }
  </i></font><font color="#FF0000"><b>Begin
 </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font>regs<font color="#000080">.</font>cl <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
 </font>regs<font color="#000080">.</font>ch <font color="#000080">:= </font><font color="#800000">32</font><font color="#000080">;
 </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>regs<font color="#000080">)
  </font><font color="#FF0000"><b>End
  Else </b></font><font color="#008000"><i>{ turn cursor on }
  </i></font><font color="#FF0000"><b>Begin
 </b></font>Intr<font color="#000080">(</font><font color="#800000">$11</font><font color="#000080">,</font>regs<font color="#000080">);
 </font>regs<font color="#000080">.</font>cx <font color="#000080">:= </font><font color="#800000">$0607</font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>regs<font color="#000080">.</font>al <font color="#FF0000"><b>AND </b></font><font color="#800000">$10 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>regs<font color="#000080">.</font>cx <font color="#000080">:= </font><font color="#800000">$0B0C</font><font color="#000080">;
 </font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>regs<font color="#000080">)
  </font><font color="#FF0000"><b>End
End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FRAME<font color="#000080">(</font>t<font color="#000080">,</font>l<font color="#000080">,</font>b<font color="#000080">,</font>r<font color="#000080">,</font>ftype <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GoToXY<font color="#000080">(</font>l<font color="#000080">,</font>t<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>ftype <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>Then
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">201</font><font color="#000080">))
  </font><font color="#FF0000"><b>Else
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">218</font><font color="#000080">));
  </font>GoToXY<font color="#000080">(</font>r<font color="#000080">,</font>t<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>ftype <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>Then
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">187</font><font color="#000080">))
  </font><font color="#FF0000"><b>Else
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">191</font><font color="#000080">));
  </font>GoToXY<font color="#000080">(</font>l<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>t<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#000080">(</font>r <font color="#000080">- (</font>l <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>Do
 If </b></font>ftype <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>Then
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">))
 </font><font color="#FF0000"><b>Else
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">196</font><font color="#000080">));
  </font>GoToXY<font color="#000080">(</font>l<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>b<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#000080">(</font>r <font color="#000080">- (</font>l <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>Do
 If </b></font>ftype <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>Then
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">))
 </font><font color="#FF0000"><b>Else
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">196</font><font color="#000080">));
  </font>GoToXY<font color="#000080">(</font>l<font color="#000080">,</font>b<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>ftype <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>Then
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">))
  </font><font color="#FF0000"><b>Else
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">192</font><font color="#000080">));
  </font>GoToXY<font color="#000080">(</font>r<font color="#000080">,</font>b<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>ftype <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>Then
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">188</font><font color="#000080">))
  </font><font color="#FF0000"><b>Else
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">217</font><font color="#000080">));
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= (</font>t<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>To </b></font><font color="#000080">(</font>b<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Do
  Begin
 </b></font>GoToXY<font color="#000080">(</font>l<font color="#000080">,</font>i<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>ftype <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>Then
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">186</font><font color="#000080">))
 </font><font color="#FF0000"><b>Else
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">179</font><font color="#000080">))
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= (</font>t<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>To </b></font><font color="#000080">(</font>b<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Do
  Begin
 </b></font>GoToXY<font color="#000080">(</font>r<font color="#000080">,</font>i<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>ftype <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>Then
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">186</font><font color="#000080">))
 </font><font color="#FF0000"><b>Else
 </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">179</font><font color="#000080">))
  </font><font color="#FF0000"><b>End
End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ISCOLOR <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#008000"><i>{ returns FALSE for MONO or TRUE for COLOR }
</i></font><font color="#FF0000"><b>Var
  </b></font>regs  <font color="#000080">: </font>Registers<font color="#000080">;
  </font>video_mode <font color="#000080">: </font>Integer<font color="#000080">;
  </font>equ_lo <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Intr<font color="#000080">(</font><font color="#800000">$11</font><font color="#000080">,</font>regs<font color="#000080">);
  </font>video_mode <font color="#000080">:= </font>regs<font color="#000080">.</font>al <font color="#FF0000"><b>and </b></font><font color="#800000">$30</font><font color="#000080">;
  </font>video_mode <font color="#000080">:= </font>video_mode <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">;
  </font><font color="#FF0000"><b>Case </b></font>video_mode <font color="#FF0000"><b>of
 </b></font><font color="#800000">1 </font><font color="#000080">: </font>ISCOLOR <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#008000"><i>{ Monochrome }
 </i></font><font color="#800000">2 </font><font color="#000080">: </font>ISCOLOR <font color="#000080">:= </font>TRUE<font color="#008000"><i>{ Color }
  </i></font><font color="#FF0000"><b>End
End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SAVESCR<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>screen <font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>vidc <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$B800</font><font color="#000080">:</font><font color="#800000">0000</font><font color="#000080">;
  </font>vidm <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$B000</font><font color="#000080">:</font><font color="#800000">0000</font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If NOT </b></font>ISCOLOR <font color="#FF0000"><b>Then </b></font><font color="#008000"><i>{ if MONO }
 </i></font>Move<font color="#000080">(</font>vidm<font color="#000080">,</font>screen<font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">)
  </font><font color="#FF0000"><b>Else </b></font><font color="#008000"><i>{ else COLOR }
 </i></font>Move<font color="#000080">(</font>vidc<font color="#000080">,</font>screen<font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>RESTORESCR<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>screen <font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>vidc <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$B800</font><font color="#000080">:</font><font color="#800000">0000</font><font color="#000080">;
  </font>vidm <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$B000</font><font color="#000080">:</font><font color="#800000">0000</font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If NOT </b></font>ISCOLOR <font color="#FF0000"><b>Then </b></font><font color="#008000"><i>{ if MONO }
 </i></font>Move<font color="#000080">(</font>screen<font color="#000080">,</font>vidm<font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">)
  </font><font color="#FF0000"><b>Else </b></font><font color="#008000"><i>{ else COLOR }
 </i></font>Move<font color="#000080">(</font>screen<font color="#000080">,</font>vidc<font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SCRGET<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>ch<font color="#000080">,</font>attr <font color="#000080">: </font>Byte <font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>regs<font color="#000080">.</font>bh <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>regs<font color="#000080">);
  </font>ch <font color="#000080">:= </font>regs<font color="#000080">.</font>al<font color="#000080">;
  </font>attr <font color="#000080">:= </font>regs<font color="#000080">.</font>ah
<font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SCRPUT<font color="#000080">( </font>ch<font color="#000080">,</font>attr <font color="#000080">: </font>Byte <font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>regs<font color="#000080">.</font>al <font color="#000080">:= </font>ch<font color="#000080">;
  </font>regs<font color="#000080">.</font>bl <font color="#000080">:= </font>attr<font color="#000080">;
  </font>regs<font color="#000080">.</font>ch <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>regs<font color="#000080">.</font>cl <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>regs<font color="#000080">.</font>bh <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>regs<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FNAMEPOS<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>arypos<font color="#000080">,</font>x<font color="#000080">,</font>y <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#008000"><i>{ determine position on screen of filename }
</i></font><font color="#FF0000"><b>Const
  </b></font>FPOS1 <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>FPOS2 <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;
  </font>FPOS3 <font color="#000080">= </font><font color="#800000">28</font><font color="#000080">;
  </font>FPOS4 <font color="#000080">= </font><font color="#800000">41</font><font color="#000080">;
  </font>FPOS5 <font color="#000080">= </font><font color="#800000">54</font><font color="#000080">;
  </font>FPOS6 <font color="#000080">= </font><font color="#800000">67</font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  Case </b></font>arypos <font color="#FF0000"><b>of
</b></font><font color="#800000">1</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#800000">2</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#800000">3</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#800000">4</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#800000">5</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#800000">6</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#800000">7</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">3 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#800000">8</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">3 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#800000">9</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">3 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">10</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">3 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">11</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">3 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">12</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">3 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">13</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">4 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">14</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">4 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">15</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">4 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">16</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">4 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">17</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">4 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">18</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">4 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">19</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">5 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">20</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">5 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">21</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">5 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">22</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">5 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">23</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">5 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">24</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">5 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">25</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">6 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">26</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">6 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">27</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">6 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">28</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">6 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">29</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">6 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">30</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">6 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">31</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">7 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">32</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">7 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">33</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">7 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">34</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">7 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">35</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">7 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">36</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">7 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">37</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">8 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">38</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">8 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">39</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">8 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">40</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">8 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">41</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">8 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">42</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">8 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">43</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">9 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">44</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">9 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">45</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">9 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">46</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">9 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">47</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">9 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">48</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">9 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">49</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">10 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">50</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">10 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">51</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">10 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">52</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">10 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">53</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">10 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">54</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">10 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">55</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">11 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">56</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">11 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">57</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">11 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">58</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">11 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">59</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">11 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">60</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">11 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">61</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">12 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">62</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">12 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">63</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">12 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">64</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">12 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">65</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">12 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">66</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">12 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">67</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">13 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">68</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">13 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">69</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">13 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">70</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">13 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">71</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">13 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">72</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">13 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">73</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">14 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">74</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">14 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">75</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">14 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">76</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">14 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">77</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">14 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">78</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">14 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">79</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">15 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">80</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">15 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">81</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">15 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">82</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">15 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">83</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">15 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">84</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">15 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">85</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">86</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">87</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">88</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">89</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">90</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">91</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">17 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">92</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">17 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">93</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">17 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">94</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">17 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">95</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">17 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">96</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">17 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">97</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">18 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">98</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">18 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#800000">99</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">18 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">100</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">18 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">101</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">18 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">102</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">18 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">103</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">19 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">104</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">19 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">105</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">19 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">106</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">19 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">107</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">19 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">108</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">19 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">109</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">20 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">110</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">20 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">111</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">20 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">112</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">20 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">113</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">20 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">114</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">20 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">115</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS1<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">21 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">116</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS2<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">21 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">117</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS3<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">21 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">118</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS4<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">21 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">119</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS5<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">21 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">120</font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font>x <font color="#000080">:= </font>FPOS6<font color="#000080">; </font>y <font color="#000080">:= </font><font color="#800000">21 </font><font color="#FF0000"><b>End
 Else
 Begin
 </b></font>x <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>y <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>End
  End
End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>HILITE<font color="#000080">(</font>old<font color="#000080">,</font>new <font color="#000080">: </font>Integer<font color="#000080">); </font><font color="#008000"><i>{ highlight a filename on the screen }
</i></font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">,</font>oldx<font color="#000080">,</font>oldy<font color="#000080">,</font>newx<font color="#000080">,</font>newy <font color="#000080">: </font>Integer<font color="#000080">;
  </font>ccolor<font color="#000080">,</font>locolor<font color="#000080">,</font>hicolor<font color="#000080">,</font>cchar <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>FNAMEPOS<font color="#000080">(</font>old<font color="#000080">,</font>oldx<font color="#000080">,</font>oldy<font color="#000080">); </font><font color="#008000"><i>{ get position in the array of the filename }
  </i></font>FNAMEPOS<font color="#000080">(</font>new<font color="#000080">,</font>newx<font color="#000080">,</font>newy<font color="#000080">); </font><font color="#008000"><i>{ get position in the array of the filename }
  </i></font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>To </b></font><font color="#800000">11 </font><font color="#FF0000"><b>Do
  Begin
 If </b></font>old <font color="#000080">&lt; </font><font color="#800000">121 </font><font color="#FF0000"><b>Then </b></font><font color="#008000"><i>{ if valid position, reverse video, old selection }
 </i></font><font color="#FF0000"><b>Begin
 </b></font>GoToXY<font color="#000080">((</font>oldx <font color="#000080">+ </font>i<font color="#000080">),</font>oldy<font color="#000080">);
 </font>SCRGET<font color="#000080">(</font>cchar<font color="#000080">,</font>ccolor<font color="#000080">);
 </font>locolor <font color="#000080">:= </font>ccolor <font color="#FF0000"><b>AND </b></font><font color="#800000">$0F</font><font color="#000080">;
 </font>locolor <font color="#000080">:= </font>locolor <font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">;
 </font>hicolor <font color="#000080">:= </font>ccolor <font color="#FF0000"><b>AND </b></font><font color="#800000">$F0</font><font color="#000080">;
 </font>hicolor <font color="#000080">:= </font>hicolor <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">;
 </font>ccolor <font color="#000080">:= </font>locolor <font color="#000080">+ </font>hicolor<font color="#000080">;
 </font>SCRPUT<font color="#000080">(</font>cchar<font color="#000080">,</font>ccolor<font color="#000080">)
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font>GoToXY<font color="#000080">((</font>newx <font color="#000080">+ </font>i<font color="#000080">),</font>newy<font color="#000080">); </font><font color="#008000"><i>{ reverse video, new selection }
 </i></font>SCRGET<font color="#000080">(</font>cchar<font color="#000080">,</font>ccolor<font color="#000080">);
 </font>locolor <font color="#000080">:= </font>ccolor <font color="#FF0000"><b>AND </b></font><font color="#800000">$0F</font><font color="#000080">;
 </font>locolor <font color="#000080">:= </font>locolor <font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">;
 </font>hicolor <font color="#000080">:= </font>ccolor <font color="#FF0000"><b>AND </b></font><font color="#800000">$F0</font><font color="#000080">;
 </font>hicolor <font color="#000080">:= </font>hicolor <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">;
 </font>ccolor <font color="#000080">:= </font>locolor <font color="#000080">+ </font>hicolor<font color="#000080">;
 </font>SCRPUT<font color="#000080">(</font>cchar<font color="#000080">,</font>ccolor<font color="#000080">)
  </font><font color="#FF0000"><b>End
End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>DIRSELECT<font color="#000080">(</font>mask <font color="#000080">: </font>strtype<font color="#000080">; </font>attr <font color="#000080">: </font>Integer<font color="#000080">) : </font>strtype<font color="#000080">;
</font><font color="#FF0000"><b>Const
  </b></font>OFF  <font color="#000080">= </font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>ON</b></font><font color="#000080">= </font>TRUE<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">,</font>oldcurx<font color="#000080">,</font>oldcury<font color="#000080">,
  </font>newcurx<font color="#000080">,</font>newcury<font color="#000080">,
  </font>oldpos<font color="#000080">,</font>newpos<font color="#000080">,
  </font>scrrows<font color="#000080">,</font>fncnt<font color="#000080">: </font>Integer<font color="#000080">;
  </font>ch  <font color="#000080">: </font>Char<font color="#000080">;
  </font>dos_dir <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">120</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
  </font>fileinfo <font color="#000080">: </font>SearchRec<font color="#000080">;
  </font>screen  <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4000</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>fncnt <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>FindFirst<font color="#000080">(</font>mask<font color="#000080">,</font>attr<font color="#000080">,</font>fileinfo<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>DosError <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then  </b></font><font color="#008000"><i>{ if not found, return NULL }
  </i></font><font color="#FF0000"><b>Begin
 </b></font>DIRSELECT <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
 </font>Exit
  <font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>DosError <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>fncnt <font color="#000080">&lt;&gt; </font><font color="#800000">120</font><font color="#000080">) </font><font color="#FF0000"><b>Do  </b></font><font color="#008000"><i>{ else, collect filenames }
  </i></font><font color="#FF0000"><b>Begin
 </b></font>Inc<font color="#000080">(</font>fncnt<font color="#000080">);
 </font>dos_dir<font color="#000080">[</font>fncnt<font color="#000080">] := </font>fileinfo<font color="#000080">.</font>Name<font color="#000080">;
 </font>FindNext<font color="#000080">(</font>fileinfo<font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>oldcurx <font color="#000080">:= </font>WhereX<font color="#000080">; </font><font color="#008000"><i>{ store old CURSOR position }
  </i></font>oldcury <font color="#000080">:= </font>WhereY<font color="#000080">;
  </font>SAVESCR<font color="#000080">(</font>screen<font color="#000080">);
  </font>CURSOR<font color="#000080">(</font>OFF<font color="#000080">);
  </font>scrrows <font color="#000080">:= (</font>fncnt <font color="#FF0000"><b>DIV </b></font><font color="#800000">6</font><font color="#000080">) + </font><font color="#800000">3</font><font color="#000080">;
  </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font>scrrows <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
  </font>ClrScr<font color="#000080">;
  </font>GoToXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>fncnt<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font><font color="#800000">120</font><font color="#000080">) </font><font color="#FF0000"><b>Do </b></font><font color="#008000"><i>{ display all filenames }
  </i></font><font color="#FF0000"><b>Begin
 </b></font>FNAMEPOS<font color="#000080">(</font>i<font color="#000080">,</font>newcurx<font color="#000080">,</font>newcury<font color="#000080">);
 </font>GoToXY<font color="#000080">(</font>newcurx<font color="#000080">,</font>newcury<font color="#000080">);
 </font>Write<font color="#000080">(</font>dos_dir<font color="#000080">[</font>i<font color="#000080">]);
 </font>Inc<font color="#000080">(</font>i<font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>FRAME<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>scrrows<font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{ draw the frame }
  </i></font>HILITE<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);</font><font color="#008000"><i>{ highlight the first filename }
  </i></font>oldpos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>newpos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>TRUE <font color="#FF0000"><b>Do </b></font><font color="#008000"><i>{ get keypress and do appropriate action }
  </i></font><font color="#FF0000"><b>Begin
 </b></font>ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
 </font><font color="#FF0000"><b>Case </b></font>ch <font color="#FF0000"><b>of
 </b></font><font color="#800000">#27</font><font color="#000080">: </font><font color="#008000"><i>{ Esc }
 </i></font><font color="#FF0000"><b>Begin
</b></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
</font>RESTORESCR<font color="#000080">(</font>screen<font color="#000080">);
</font>GoToXY<font color="#000080">(</font>oldcurx<font color="#000080">,</font>oldcury<font color="#000080">);
</font>CURSOR<font color="#000080">(</font><font color="#FF0000"><b>ON</b></font><font color="#000080">);
</font>DIRSELECT <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font>Exit  <font color="#008000"><i>{ return NULL }
 </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">#71</font><font color="#000080">: </font><font color="#008000"><i>{ Home }{ goto first filename }
 </i></font><font color="#FF0000"><b>Begin
</b></font>oldpos <font color="#000080">:= </font>newpos<font color="#000080">;
</font>newpos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
</font>HILITE<font color="#000080">(</font>oldpos<font color="#000080">,</font>newpos<font color="#000080">)
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">#79</font><font color="#000080">: </font><font color="#008000"><i>{ End }{ goto last filename }
 </i></font><font color="#FF0000"><b>Begin
</b></font>oldpos <font color="#000080">:= </font>newpos<font color="#000080">;
</font>newpos <font color="#000080">:= </font>fncnt<font color="#000080">;
</font>HILITE<font color="#000080">(</font>oldpos<font color="#000080">,</font>newpos<font color="#000080">)
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#800000">#72</font><font color="#000080">: </font><font color="#008000"><i>{ Up  }{ move up one filename }
 </i></font><font color="#FF0000"><b>Begin
</b></font>i <font color="#000080">:= </font>newpos<font color="#000080">;
</font>i <font color="#000080">:= </font>i <font color="#000080">- </font><font color="#800000">6</font><font color="#000080">;
</font><font color="#FF0000"><b>If </b></font>i <font color="#000080">&gt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
Begin
  </b></font>oldpos <font color="#000080">:= </font>newpos<font color="#000080">;
  </font>newpos <font color="#000080">:= </font>i<font color="#000080">;
  </font>HILITE<font color="#000080">(</font>oldpos<font color="#000080">,</font>newpos<font color="#000080">)
</font><font color="#FF0000"><b>End
 End</b></font><font color="#000080">;
 </font><font color="#800000">#80</font><font color="#000080">: </font><font color="#008000"><i>{ Down }{ move down one filename }
 </i></font><font color="#FF0000"><b>Begin
</b></font>i <font color="#000080">:= </font>newpos<font color="#000080">;
</font>i <font color="#000080">:= </font>i <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">;
</font><font color="#FF0000"><b>If </b></font>i <font color="#000080">&lt;= </font>fncnt <font color="#FF0000"><b>Then
Begin
  </b></font>oldpos <font color="#000080">:= </font>newpos<font color="#000080">;
  </font>newpos <font color="#000080">:= </font>i<font color="#000080">;
  </font>HILITE<font color="#000080">(</font>oldpos<font color="#000080">,</font>newpos<font color="#000080">)
</font><font color="#FF0000"><b>End
 End</b></font><font color="#000080">;
 </font><font color="#800000">#75</font><font color="#000080">: </font><font color="#008000"><i>{ Left }{ move left one filename }
 </i></font><font color="#FF0000"><b>Begin
</b></font>i <font color="#000080">:= </font>newpos<font color="#000080">;
</font>Dec<font color="#000080">(</font>i<font color="#000080">);
</font><font color="#FF0000"><b>If </b></font>i <font color="#000080">&gt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
Begin
  </b></font>oldpos <font color="#000080">:= </font>newpos<font color="#000080">;
  </font>newpos <font color="#000080">:= </font>i<font color="#000080">;
  </font>HILITE<font color="#000080">(</font>oldpos<font color="#000080">,</font>newpos<font color="#000080">)
</font><font color="#FF0000"><b>End
 End</b></font><font color="#000080">;
 </font><font color="#800000">#77</font><font color="#000080">: </font><font color="#008000"><i>{ Right }  { move right one filename }
 </i></font><font color="#FF0000"><b>Begin
</b></font>i <font color="#000080">:= </font>newpos<font color="#000080">;
</font>Inc<font color="#000080">(</font>i<font color="#000080">);
</font><font color="#FF0000"><b>If </b></font>i <font color="#000080">&lt;= </font>fncnt <font color="#FF0000"><b>Then
Begin
  </b></font>oldpos <font color="#000080">:= </font>newpos<font color="#000080">;
  </font>newpos <font color="#000080">:= </font>i<font color="#000080">;
  </font>HILITE<font color="#000080">(</font>oldpos<font color="#000080">,</font>newpos<font color="#000080">)
</font><font color="#FF0000"><b>End
 End</b></font><font color="#000080">;
 </font><font color="#800000">#13</font><font color="#000080">: </font><font color="#008000"><i>{ CR }
 </i></font><font color="#FF0000"><b>Begin
</b></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
</font>RESTORESCR<font color="#000080">(</font>screen<font color="#000080">);
</font>GoToXY<font color="#000080">(</font>oldcurx<font color="#000080">,</font>oldcury<font color="#000080">);</font><font color="#008000"><i>{ return old CURSOR position }
</i></font>CURSOR<font color="#000080">(</font><font color="#FF0000"><b>ON</b></font><font color="#000080">);
</font>DIRSELECT <font color="#000080">:= </font>dos_dir<font color="#000080">[</font>newpos<font color="#000080">];
</font>Exit<font color="#008000"><i>{ return with filename }
 </i></font><font color="#FF0000"><b>End
 End
  End
End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ************************************************************************** }
{ ** Main Program : NOTE that the following is a demo program only.  ** }
{ **It is not needed to use the DIRSELECT function.  ** }
{ ************************************************************************** }

</i></font><font color="#FF0000"><b>Begin
  While </b></font>TRUE <font color="#FF0000"><b>Do
  Begin
 </b></font>Writeln<font color="#000080">;
 </font>Write<font color="#000080">(</font><font color="#800000">'Enter a filespec =&gt; '</font><font color="#000080">);
 </font>Readln<font color="#000080">(</font>spec<font color="#000080">);
 </font>fname <font color="#000080">:= </font>DIRSELECT<font color="#000080">(</font>spec<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>fname<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
 Begin
 </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Filespec not found.'</font><font color="#000080">);
 </font>Halt
 <font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font>Writeln<font color="#000080">(</font><font color="#800000">'The file you have chosen is '</font><font color="#000080">,</font>fname<font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">)
  </font><font color="#FF0000"><b>End
End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0040.PAS">Original</a><b>]</b></p></body>
</html>
