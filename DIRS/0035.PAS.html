<html>
<head><title> "Create Directories" by NEIL GORIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0035.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
RF&gt;   Has anyone written a function for creating a pathname ?
RF&gt;   I'm having a problem with putting together a function that you
RF&gt;   can pass a pathname to, such as: C:\WINDOWS\SYSTEM\STUFF
RF&gt;   and have it create the path if it's at all possible.

Try the following, taken from a couple (one DOS, one Windows) of
install programs I am working on.  Lines beginning {} should
be replaced with your preferred error reporting methods (they
currently use my UNIXGUI package).  This is not guaranteed to
trap all possible errors.

LEGALDIR will return true if the path is legal.  You *must* specify
the drive in the path as in C:\WINDOWS\SYSTEM\STUFF
*)
</i></font><font color="#FF0000"><b>Function </b></font>LegalDir<font color="#000080">(</font>path<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
    </font><font color="#FF0000"><b>var </b></font>flag<font color="#000080">:</font>boolean<font color="#000080">;
    </font><font color="#FF0000"><b>begin
         </b></font>path<font color="#000080">:=</font>short<font color="#000080">(</font>path<font color="#000080">);
         </font>flag<font color="#000080">:=</font>true<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>path<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&lt;</font><font color="#800000">'A' </font><font color="#FF0000"><b>then </b></font>flag<font color="#000080">:=</font>false<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>path<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&gt;</font><font color="#800000">'Z' </font><font color="#FF0000"><b>then </b></font>flag<font color="#000080">:=</font>false<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>path<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]&lt;&gt;</font><font color="#800000">':' </font><font color="#FF0000"><b>then </b></font>flag<font color="#000080">:=</font>false<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>path<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]&lt;&gt;</font><font color="#800000">'\' </font><font color="#FF0000"><b>then </b></font>flag<font color="#000080">:=</font>false<font color="#000080">;
         </font>delete<font color="#000080">(</font>path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
         </font><font color="#FF0000"><b>While </b></font>path<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>do
         begin
              if </b></font>pos<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">,</font>path<font color="#000080">)&gt;</font><font color="#800000">9 </font><font color="#FF0000"><b>then </b></font>flag<font color="#000080">:=</font>false<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>length<font color="#000080">(</font>path<font color="#000080">)&gt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>path<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'\'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>path<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]=</font><font color="#800000">'\'</font><font color="#000080">))
                 </font><font color="#FF0000"><b>then </b></font>flag<font color="#000080">:=</font>false<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>path<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>flag<font color="#000080">:=</font>false<font color="#000080">;
              </font><font color="#FF0000"><b>if  not </b></font><font color="#000080">(</font>path<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in
                 </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">,</font><font color="#800000">'B'</font><font color="#000080">,</font><font color="#800000">'C'</font><font color="#000080">,</font><font color="#800000">'D'</font><font color="#000080">,</font><font color="#800000">'E'</font><font color="#000080">,</font><font color="#800000">'F'</font><font color="#000080">,</font><font color="#800000">'G'</font><font color="#000080">,</font><font color="#800000">'H'</font><font color="#000080">,</font><font color="#800000">'I'</font><font color="#000080">,</font><font color="#800000">'J'</font><font color="#000080">,</font><font color="#800000">'K'</font><font color="#000080">,</font><font color="#800000">'L'</font><font color="#000080">,</font><font color="#800000">'M'</font><font color="#000080">,
                  </font><font color="#800000">'N'</font><font color="#000080">,</font><font color="#800000">'O'</font><font color="#000080">,</font><font color="#800000">'P'</font><font color="#000080">,</font><font color="#800000">'Q'</font><font color="#000080">,</font><font color="#800000">'R'</font><font color="#000080">,</font><font color="#800000">'S'</font><font color="#000080">,</font><font color="#800000">'T'</font><font color="#000080">,</font><font color="#800000">'U'</font><font color="#000080">,</font><font color="#800000">'V'</font><font color="#000080">,</font><font color="#800000">'W'</font><font color="#000080">,</font><font color="#800000">'X'</font><font color="#000080">,</font><font color="#800000">'Y'</font><font color="#000080">,</font><font color="#800000">'Z'</font><font color="#000080">,
                  </font><font color="#800000">'1'</font><font color="#000080">,</font><font color="#800000">'2'</font><font color="#000080">,</font><font color="#800000">'3'</font><font color="#000080">,</font><font color="#800000">'4'</font><font color="#000080">,</font><font color="#800000">'5'</font><font color="#000080">,</font><font color="#800000">'6'</font><font color="#000080">,</font><font color="#800000">'7'</font><font color="#000080">,</font><font color="#800000">'8'</font><font color="#000080">,</font><font color="#800000">'9'</font><font color="#000080">,</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">'_'</font><font color="#000080">,</font><font color="#800000">'^'</font><font color="#000080">,</font><font color="#800000">'$'</font><font color="#000080">,
                  </font><font color="#800000">'~'</font><font color="#000080">,</font><font color="#800000">'!'</font><font color="#000080">,</font><font color="#800000">'#'</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">,</font><font color="#800000">'&amp;'</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">,</font><font color="#800000">'{'</font><font color="#000080">,</font><font color="#800000">'}'</font><font color="#000080">,</font><font color="#800000">'('</font><font color="#000080">,</font><font color="#800000">')'</font><font color="#000080">,</font><font color="#800000">'\'</font><font color="#000080">])
                 </font><font color="#FF0000"><b>then </b></font>flag<font color="#000080">:=</font>false<font color="#000080">;

              </font>delete<font color="#000080">(</font>path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>if not </b></font>flag <font color="#FF0000"><b>then
         begin
</b></font><font color="#008000"><i>{}             </i></font>WinOkDialogue<font color="#000080">(</font><font color="#800000">'Cannot Install'</font><font color="#000080">,
                             </font><font color="#800000">'Illegal Directory name!'</font><font color="#000080">,
                             </font><font color="#800000">'Please re-edit and'</font><font color="#000080">,
                             </font><font color="#800000">'try again.'</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font>LegalDir<font color="#000080">:=</font>flag<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{
MAKEDIRECTORY will make the directory structure you pass to it.  Best
to call LEGALDIR first, for obvious reasons.
}
    </i></font><font color="#FF0000"><b>Procedure </b></font>MakeDirectory<font color="#000080">(</font>st<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>var </b></font>ns<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
        </font>ior<font color="#000080">:</font>word<font color="#000080">;
    </font><font color="#FF0000"><b>begin
        </b></font>Chdir<font color="#000080">(</font>st<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>ioresult<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
        </font>MKDIR<font color="#000080">(</font>st<font color="#000080">);
        </font>ior<font color="#000080">:=</font>ioresult<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>ior<font color="#000080">=</font><font color="#800000">3 </font><font color="#FF0000"><b>then
        begin
            </b></font>ns<font color="#000080">:=</font>st<font color="#000080">;
            </font><font color="#FF0000"><b>while </b></font>ns<font color="#000080">[</font>length<font color="#000080">(</font>ns<font color="#000080">)]&lt;&gt;</font><font color="#800000">'\' </font><font color="#FF0000"><b>do </b></font>delete<font color="#000080">(</font>ns<font color="#000080">,</font>length<font color="#000080">(</font>ns<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
            </font>delete<font color="#000080">(</font>ns<font color="#000080">,</font>length<font color="#000080">(</font>ns<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
            </font>MakeDirectory<font color="#000080">(</font>ns<font color="#000080">);
            </font>MakeDirectory<font color="#000080">(</font>st<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>ior<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>ior<font color="#000080">&lt;&gt;</font><font color="#800000">3</font><font color="#000080">)) </font><font color="#FF0000"><b>then
        begin
</b></font><font color="#008000"><i>{}             </i></font>Popdialogue<font color="#000080">;
</font><font color="#008000"><i>{}             </i></font>WinOkDialogue<font color="#000080">(</font><font color="#800000">'Error'</font><font color="#000080">,
                             </font><font color="#800000">'Illegal Directory'</font><font color="#000080">,
                             </font><font color="#800000">'or drive error!'</font><font color="#000080">,
                             </font><font color="#800000">'Halting...'</font><font color="#000080">);
</font><font color="#008000"><i>{}             </i></font>closegui<font color="#000080">;
             </font>halt<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0035.PAS">Original</a><b>]</b></p></body>
</html>
