<html>
<head><title> "DOS Wildcards" by BERNHARD TSCHIRREN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0055.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
JH&gt;Is anybody familiar with a way to do Wildcards?
JH&gt;I want to be able to select
JH&gt;something ie: *.ZIP and it makes a que list from all of them?

If you ever need a procedure to check whether a file conforms to a wildcard
Ive got just the right procedure for you.

_______________0/__________________________________________
               0\                                           }

</i></font><font color="#FF0000"><b>Function </b></font>DirOnly<font color="#000080">(</font>FileName<font color="#000080">:</font>PathStr<font color="#000080">) : </font>DirStr<font color="#000080">;
        </font><font color="#FF0000"><b>Var
                </b></font>Dir  <font color="#000080">: </font>DirStr<font color="#000080">;
                </font>Name <font color="#000080">: </font>NameStr<font color="#000080">;
                </font>Ext  <font color="#000080">: </font>ExtStr<font color="#000080">;
        </font><font color="#FF0000"><b>Begin
                </b></font>FSplit<font color="#000080">(</font>FileName<font color="#000080">,</font>Dir<font color="#000080">,</font>Name<font color="#000080">,</font>Ext<font color="#000080">);
                </font>DirOnly <font color="#000080">:= </font>Dir<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>NameOnly<font color="#000080">(</font>FileName<font color="#000080">:</font>PathStr<font color="#000080">) : </font>TStr12<font color="#000080">;
        </font><font color="#FF0000"><b>Var
                </b></font>Dir  <font color="#000080">: </font>DirStr<font color="#000080">;
                </font>Name <font color="#000080">: </font>NameStr<font color="#000080">;
                </font>Ext  <font color="#000080">: </font>ExtStr<font color="#000080">;
        </font><font color="#FF0000"><b>Begin
                </b></font>FSplit<font color="#000080">(</font>FileName<font color="#000080">,</font>Dir<font color="#000080">,</font>Name<font color="#000080">,</font>Ext<font color="#000080">);
                </font>NameOnly <font color="#000080">:= </font>Name<font color="#000080">+</font>Ext<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>BaseNameOnly<font color="#000080">(</font>FileName<font color="#000080">:</font>PathStr<font color="#000080">) : </font>NameStr<font color="#000080">;
        </font><font color="#FF0000"><b>Var
                </b></font>Dir  <font color="#000080">: </font>DirStr<font color="#000080">;
                </font>Name <font color="#000080">: </font>NameStr<font color="#000080">;
                </font>Ext  <font color="#000080">: </font>ExtStr<font color="#000080">;
        </font><font color="#FF0000"><b>Begin
                </b></font>FSplit<font color="#000080">(</font>FileName<font color="#000080">,</font>Dir<font color="#000080">,</font>Name<font color="#000080">,</font>Ext<font color="#000080">);
                </font>BaseNameOnly <font color="#000080">:= </font>Name<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ExtOnly<font color="#000080">(</font>FileName<font color="#000080">:</font>PathStr<font color="#000080">) : </font>ExtStr<font color="#000080">;
        </font><font color="#FF0000"><b>Var
                </b></font>Dir  <font color="#000080">: </font>DirStr<font color="#000080">;
                </font>Name <font color="#000080">: </font>NameStr<font color="#000080">;
                </font>Ext  <font color="#000080">: </font>ExtStr<font color="#000080">;
        </font><font color="#FF0000"><b>Begin
                </b></font>FSplit<font color="#000080">(</font>FileName<font color="#000080">, </font>Dir<font color="#000080">, </font>Name<font color="#000080">, </font>Ext<font color="#000080">);
                </font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>Ext<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Delete<font color="#000080">(</font>Ext<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                </font>ExtOnly <font color="#000080">:= </font>Ext<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SameName<font color="#000080">(</font>N1<font color="#000080">,</font>N2<font color="#000080">:</font>NameStr<font color="#000080">) : </font>Boolean<font color="#000080">;
        </font><font color="#FF0000"><b>Var
                </b></font>P1<font color="#000080">,</font>P2 <font color="#000080">: </font>Byte<font color="#000080">;
                </font>Match <font color="#000080">: </font>Boolean<font color="#000080">;
        </font><font color="#FF0000"><b>Begin
                </b></font>P1    <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                </font>P2    <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                </font>Match <font color="#000080">:= </font>True<font color="#000080">;

                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>N1<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>N2<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                        </b></font>Match <font color="#000080">:= </font>True
                <font color="#FF0000"><b>Else
                        If </b></font>Length<font color="#000080">(</font>N1<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
                                If </b></font>N2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'*' </font><font color="#FF0000"><b>Then
                                        </b></font>Match <font color="#000080">:= </font>True
                                <font color="#FF0000"><b>Else
                                        </b></font>Match <font color="#000080">:= </font>False
                        <font color="#FF0000"><b>Else
                                If </b></font>Length<font color="#000080">(</font>N2<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
                                        If </b></font>N1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'*' </font><font color="#FF0000"><b>Then
                                                </b></font>Match <font color="#000080">:= </font>True
                                        <font color="#FF0000"><b>Else
                                                </b></font>Match <font color="#000080">:= </font>False<font color="#000080">;

                </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Match <font color="#000080">= </font>True<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>P1 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N1<font color="#000080">)) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>P2 <font color="#000080">&lt;= 
</font>Length<font color="#000080">(</font>N2<font color="#000080">)) </font><font color="#FF0000"><b>Do
                        If </b></font><font color="#000080">(</font>N1<font color="#000080">[</font>P1<font color="#000080">] = </font><font color="#800000">'?'</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>N2<font color="#000080">[</font>P2<font color="#000080">] = </font><font color="#800000">'?'</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                                Begin
                                        </b></font>Inc<font color="#000080">(</font>P1<font color="#000080">);
                                        </font>Inc<font color="#000080">(</font>P2<font color="#000080">);
                                </font><font color="#FF0000"><b>End
                        Else
                                If </b></font>N1<font color="#000080">[</font>P1<font color="#000080">] = </font><font color="#800000">'*' </font><font color="#FF0000"><b>Then
                                        Begin
                                                </b></font>Inc<font color="#000080">(</font>P1<font color="#000080">);
                                                </font><font color="#FF0000"><b>If </b></font>P1 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N1<font color="#000080">) </font><font color="#FF0000"><b>Then
                                                Begin
                                                While </b></font><font color="#000080">(</font>P2 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N2<font color="#000080">)) </font><font color="#FF0000"><b>And
                                                Not </b></font>SameName<font color="#000080">(</font>Copy<font color="#000080">(</font>N1<font color="#000080">,</font>P1<font color="#000080">,</font>Length<font color="#000080">(</font>N1<font color="#000080">)-</font>P1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">),</font>Copy<font color="#000080">(</font>N2<font color="#000080">,</font>P2<font color="#000080">,</font>Length<font color="#000080">(</font>N2<font color="#000080">)-</font>P2<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>Do
                                                </b></font>Inc<font color="#000080">(</font>P2<font color="#000080">);
                                                </font><font color="#FF0000"><b>If </b></font>P2 <font color="#000080">&gt; </font>Length<font color="#000080">(</font>N2<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Match <font color="#000080">:= </font>False
                                                <font color="#FF0000"><b>Else

Begin

        </b></font>P1 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N1<font color="#000080">));

        </font>P2 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N2<font color="#000080">));

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>End
                     Else
                     </b></font>P2 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N2<font color="#000080">));
                     </font><font color="#FF0000"><b>End
                      Else
                      If </b></font>N2<font color="#000080">[</font>P2<font color="#000080">] = </font><font color="#800000">'*' </font><font color="#FF0000"><b>Then
                              Begin
                                      </b></font>Inc<font color="#000080">(</font>P2<font color="#000080">);
                                      </font><font color="#FF0000"><b>If </b></font>P2 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N2<font color="#000080">) </font><font color="#FF0000"><b>Then
                                              Begin

While </b></font><font color="#000080">(</font>P1 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N1<font color="#000080">)) </font><font color="#FF0000"><b>And

           Not </b></font>SameName<font color="#000080">(</font>Copy<font color="#000080">(</font>N1<font color="#000080">,</font>P1<font color="#000080">,</font>Length<font color="#000080">(</font>N1<font color="#000080">)-</font>P1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">),</font>Copy<font color="#000080">(</font>N2<font color="#000080">,</font>P2<font color="#000080">,</font>Length<font color="#000080">(</font>N2<font color="#000080">)-</font>P2<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>Do

        </b></font>Inc<font color="#000080">(</font>P1<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>P1 <font color="#000080">&gt; </font>Length<font color="#000080">(</font>N1<font color="#000080">) </font><font color="#FF0000"><b>Then

        </b></font>Match <font color="#000080">:= </font>False

<font color="#FF0000"><b>Else

        Begin

                </b></font>P1 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N1<font color="#000080">));

                </font>P2 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N2<font color="#000080">));

        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                          </font><font color="#FF0000"><b>End
                          Else
                          </b></font>P1 <font color="#000080">:= </font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>N1<font color="#000080">));
                    </font><font color="#FF0000"><b>End
            Else
            If </b></font>UpCase<font color="#000080">(</font>N1<font color="#000080">[</font>P1<font color="#000080">]) = </font>UpCase<font color="#000080">(</font>N2<font color="#000080">[</font>P2<font color="#000080">]) </font><font color="#FF0000"><b>Then
                            Begin
                                    </b></font>Inc<font color="#000080">(</font>P1<font color="#000080">);
                                    </font>Inc<font color="#000080">(</font>P2<font color="#000080">);
                            </font><font color="#FF0000"><b>End
                    Else
                            </b></font>Match <font color="#000080">:= </font>False<font color="#000080">;

                </font><font color="#FF0000"><b>If </b></font>P1 <font color="#000080">&gt; </font>Length<font color="#000080">(</font>N1<font color="#000080">) </font><font color="#FF0000"><b>Then
                        Begin
                                While </b></font><font color="#000080">(</font>P2 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N2<font color="#000080">)) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>N2<font color="#000080">[</font>P2<font color="#000080">] = </font><font color="#800000">'*'</font><font color="#000080">) 
</font><font color="#FF0000"><b>Do
                                        </b></font>Inc<font color="#000080">(</font>P2<font color="#000080">);
                                </font><font color="#FF0000"><b>If </b></font>P2 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N2<font color="#000080">) </font><font color="#FF0000"><b>Then
                                        </b></font>Match <font color="#000080">:= </font>FALSE<font color="#000080">;
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                </font><font color="#FF0000"><b>If </b></font>P2 <font color="#000080">&gt; </font>Length<font color="#000080">(</font>N2<font color="#000080">) </font><font color="#FF0000"><b>Then
                        Begin
                                While </b></font><font color="#000080">(</font>P1 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N1<font color="#000080">)) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>N1<font color="#000080">[</font>P1<font color="#000080">] = </font><font color="#800000">'*'</font><font color="#000080">)
</font><font color="#FF0000"><b>Do
                                        </b></font>Inc<font color="#000080">(</font>P1<font color="#000080">);
                                </font><font color="#FF0000"><b>If </b></font>P1 <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>N1<font color="#000080">) </font><font color="#FF0000"><b>Then
                                        </b></font>Match <font color="#000080">:= </font>False<font color="#000080">;
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

                </font>SameName <font color="#000080">:= </font>Match<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SameFile<font color="#000080">(</font>File1<font color="#000080">,</font>File2<font color="#000080">:</font>PathStr<font color="#000080">) : </font>Boolean<font color="#000080">;
        </font><font color="#FF0000"><b>Var
                </b></font>Dir1<font color="#000080">,</font>Dir2 <font color="#000080">: </font>DirStr<font color="#000080">;
        </font><font color="#FF0000"><b>Begin
                </b></font>File1 <font color="#000080">:= </font>FExpand<font color="#000080">(</font>File1<font color="#000080">);
                </font>File2 <font color="#000080">:= </font>FExpand<font color="#000080">(</font>File2<font color="#000080">);
                </font>Dir1  <font color="#000080">:= </font>DirOnly<font color="#000080">(</font>File1<font color="#000080">);
                </font>Dir2  <font color="#000080">:= </font>DirOnly<font color="#000080">(</font>File2<font color="#000080">);

                </font>SameFile <font color="#000080">:=  </font>SameName<font color="#000080">(</font>BaseNameOnly<font color="#000080">(</font>File1<font color="#000080">),</font>BaseNameOnly<font color="#000080">(</font>File2<font color="#000080">)) </font><font color="#FF0000"><b>And
                </b></font>SameName<font color="#000080">(</font>ExtOnly<font color="#000080">(</font>File1<font color="#000080">),</font>ExtOnly<font color="#000080">(</font>File2<font color="#000080">)) </font><font color="#FF0000"><b>And
                                        </b></font><font color="#000080">(</font>Dir1 <font color="#000080">= </font>Dir2<font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font>_______________0<font color="#000080">/</font>__________________________________________
               <font color="#800000">0</font><font color="#000080">\ 

</font>Sorry about the bad formatting but I use LONG lines <font color="#FF0000"><b>with </b></font>tabs <font color="#FF0000"><b>for </b></font>all my 
indents <font color="#FF0000"><b>with </b></font>my tab size <font color="#FF0000"><b>set to </b></font><font color="#800000">4. </font>This <font color="#FF0000"><b>procedure </b></font>handles all cases <font color="#FF0000"><b>of 
</b></font>wildcards including some that dos doeen<font color="#800000">'t:

    </font>SameFile<font color="#000080">(</font><font color="#800000">'*.PAS'</font><font color="#000080">,</font><font color="#800000">'HELLO.PAS) = TRUE
    </font>SameFile<font color="#000080">(</font><font color="#800000">'*.P?L'</font><font color="#000080">,</font><font color="#800000">'HELLO.PAL) = TRUE    
    </font>SameFile<font color="#000080">(</font><font color="#800000">'TE*.PAS'</font><font color="#000080">,</font><font color="#800000">'TOTO.PAS'</font><font color="#000080">) = </font>False
    SameFile<font color="#000080">(</font><font color="#800000">'*PA.EXE'</font><font color="#000080">,</font><font color="#800000">'SUPA.EXE'</font><font color="#000080">) = </font>True <font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>handled by dos<font color="#000080">!)
    </font>SameFile<font color="#000080">(</font><font color="#800000">'ST?P.*'</font><font color="#000080">,</font><font color="#800000">'STOP.COM'</font><font color="#000080">) = </font>True


</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0055.PAS">Original</a><b>]</b></p></body>
</html>
