<html>
<head><title> "Make/Change DIR" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>MakeChangeDir<font color="#000080">;

</font><font color="#008000"><i>{ Purpose:      - Make directories where they don't exist               }
{                                                                       }
{ Useful for:   - Installation Type Programs                            }
{                                                                       }
{ Useful notes: - seems to handles even directories With extentions     }
{                 (i.e. DIRDIR.YYY)                                     }
{               - there are some defaults that have been set up :-      }
{                 change if needed                                      }
{               - doesn't check to see how legal the required directory }
{                 is (i.e. spaces, colon in the wrong place, etc.)      }
{                                                                       }
{ Legal junk:   - this has been released to the public as public domain }
{               - if you use it, give me some credit!                   }
{                                                                       }

</i></font><font color="#FF0000"><b>Var
  </b></font>Slash <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">20</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>MkDirCDir<font color="#000080">(</font>Target <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">,
  </font>count   <font color="#000080">: </font>Integer<font color="#000080">;
  </font>dir<font color="#000080">,
  </font>home<font color="#000080">,
  </font>tempdir <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ sample directory below to make }
  </i></font>Dir <font color="#000080">:= </font>Target<font color="#000080">;
  </font><font color="#008000"><i>{ add slash at end if not given }
  </i></font><font color="#FF0000"><b>if </b></font>Dir<font color="#000080">[</font>Length<font color="#000080">(</font>Dir<font color="#000080">)] &lt;&gt; </font><font color="#800000">'\' </font><font color="#FF0000"><b>then
    </b></font>Dir <font color="#000080">:= </font>Dir <font color="#000080">+ </font><font color="#800000">'\'</font><font color="#000080">;
  </font><font color="#008000"><i>{ if colon where normally is change to that drive }
  </i></font><font color="#FF0000"><b>if </b></font>Dir<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">':' </font><font color="#FF0000"><b>then
    </b></font>ChDir<font color="#000080">(</font>Copy<font color="#000080">(</font>Dir<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">))
  </font><font color="#FF0000"><b>else
  </b></font><font color="#008000"><i>{ assume current drive (and directory) }
  </i></font><font color="#FF0000"><b>begin
    </b></font>GetDir<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>Home<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>Dir<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'\' </font><font color="#FF0000"><b>then
      </b></font>Dir <font color="#000080">:= </font>Home <font color="#000080">+ </font><font color="#800000">'\' </font><font color="#000080">+ </font>Dir
    <font color="#FF0000"><b>else
      </b></font>Dir <font color="#000080">:= </font>Home <font color="#000080">+ </font>Dir<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Count <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#008000"><i>{ search directory For slashed and Record them }
  </i></font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Dir<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    if </b></font>Dir<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'\' </font><font color="#FF0000"><b>then
    begin
      </b></font>Inc<font color="#000080">(</font>Count<font color="#000080">);
      </font>Slash<font color="#000080">[</font>Count<font color="#000080">] := </font>i<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ For each step of the way, change to the directory }
  { if get error, assume it doesn't exist - make it }
  { then change to it }
  </i></font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>Count <font color="#FF0000"><b>do
  begin
    </b></font>TempDir <font color="#000080">:= </font>Copy<font color="#000080">(</font>Dir<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Slash<font color="#000080">[</font>i<font color="#000080">] - </font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#008000"><i>{$I-}
    </i></font>ChDir<font color="#000080">(</font>TempDir<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>MkDir<font color="#000080">(</font>TempDir<font color="#000080">);
      </font>ChDir<font color="#000080">(</font>TempDir<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>MkDirCDir<font color="#000080">(</font><font color="#800000">'D:\HI.ZZZ\GEEKS\2JKD98'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p></body>
</html>
