<html>
<head><title> "Directory With FileSpec" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;Is there any easy way do turn *.* wildcards into a bunch of Filenames?
&gt;This may be confusing, so here's what I want to do:
&gt;I know C, basic, pascal, and batch.  (but not too well)
&gt;I want to make a Program to read Files from c:\ece\ and, according to my
&gt;Filespecs ( *.* *.dwg plot???.plt hw1-1.c) I want the Program to take
&gt;each File individually, and Compress it and put it on b:.  I also want
&gt;the Program to work in reverse.  I.E.:  unpack Filespecs from b: and
&gt;into c:.  I want this because I take so many disks to school, and I
&gt;don't like packing and unpacking each File individually.  I also don't
&gt;want one big archive.  Any suggestions as to how to do it, or what I
&gt;could do is appreciated.

The easiest way would be to use the findfirst() and findnext()
Procedures. Here's a stub Program in TP. You'll need to put code in
the main routine to handle command line arguments, and call fsplit()
to split up the Filenames to pass to searchDir() or searchAllDirs().
then just put whatever processing you want to do With each File in
the process() Procedure.
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">, </font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Path      <font color="#000080">: </font>PathStr<font color="#000080">;
  </font>Dir       <font color="#000080">: </font>DirStr<font color="#000080">;
  </font>Name      <font color="#000080">: </font>NameStr<font color="#000080">;
  </font>Ext       <font color="#000080">: </font>ExtStr<font color="#000080">;
  </font>FullName  <font color="#000080">: </font>PathStr<font color="#000080">;
  </font>F         <font color="#000080">: </font>SearchRec<font color="#000080">;
  </font>Ch        <font color="#000080">: </font>Char<font color="#000080">;
  </font>I         <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Process<font color="#000080">(</font>dir <font color="#000080">: </font>DirStr<font color="#000080">; </font>s <font color="#000080">: </font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Writeln<font color="#000080">(</font>dir<font color="#000080">, </font>s<font color="#000080">.</font>name<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{
 Both searchDir and searchAllDirs require the following parameters
 path  - the path to the File, which must end With a backslash.
         if there is no ending backslash these won't work.
 fspec - the File specification.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>SearchDir<font color="#000080">(</font>Path <font color="#000080">: </font>PathStr<font color="#000080">; </font>fspec <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>f <font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Findfirst<font color="#000080">(</font>Path <font color="#000080">+ </font>fspec<font color="#000080">, </font>AnyFile<font color="#000080">, </font>f<font color="#000080">);
  </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>Process<font color="#000080">(</font>path<font color="#000080">, </font>f<font color="#000080">);
    </font>Findnext<font color="#000080">(</font>f<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>searchAllDirs<font color="#000080">(</font>path <font color="#000080">: </font>pathStr<font color="#000080">; </font>fspec <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>d <font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SearchDir<font color="#000080">(</font>Path<font color="#000080">, </font>fspec<font color="#000080">);
  </font>FindFirst<font color="#000080">(</font>Path <font color="#000080">+ </font><font color="#800000">'*.*'</font><font color="#000080">, </font>Directory<font color="#000080">, </font>d<font color="#000080">);
  </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    if </b></font><font color="#000080">(</font>d<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font>Directory <font color="#000080">= </font>Directory<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>d<font color="#000080">.</font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>SearchAllDirs<font color="#000080">(</font>Path <font color="#000080">+ </font>d<font color="#000080">.</font>name <font color="#000080">+ </font><font color="#800000">'\'</font><font color="#000080">, </font>fspec<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Findnext<font color="#000080">(</font>d<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>SearchAllDirs<font color="#000080">( </font><font color="#800000">'\'</font><font color="#000080">, </font><font color="#800000">'*.*' </font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DIRS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p></body>
</html>
