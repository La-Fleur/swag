<html>
<head><title> "Text Word Wrap" by MIKE COPELAND</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTEDIT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
   Here's some code I found in this echo a number of years ago - I don't
recall who should get credit for it.  I put it into my own program,
which uses some other Units, and I hope I've sanitized it enough to make
it generic...

Uses a FASTWRITE routine that can be found in SWAG G.D. 02/01/94 }


</i></font><font color="#FF0000"><b>program </b></font>WordWrap<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>CRT<font color="#000080">;
</font><font color="#FF0000"><b>const
   </b></font>FKeyCode          <font color="#000080">= </font><font color="#800000">#00</font><font color="#000080">;
   </font>Space             <font color="#000080">= </font><font color="#800000">' '</font><font color="#000080">;
   </font>Hyphen            <font color="#000080">= </font><font color="#800000">'-'</font><font color="#000080">;
   </font>BackSpace         <font color="#000080">= </font><font color="#800000">#08</font><font color="#000080">;
   </font>C_R               <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">;
   </font>MaxWordLineLength <font color="#000080">= </font><font color="#800000">60</font><font color="#000080">;
   </font>MAXLINES          <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;  </font><font color="#008000"><i>{ Maximum # of lines in &quot;box&quot; }
</i></font><font color="#FF0000"><b>var
   </b></font>WordLine  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font>MaxWordLineLength<font color="#000080">];
   </font>Index1    <font color="#000080">: </font>byte<font color="#000080">;
   </font>Index2    <font color="#000080">: </font>byte<font color="#000080">;
   </font>InputChar <font color="#000080">: </font>char<font color="#000080">;
   </font>LINE      <font color="#000080">: </font>byte<font color="#000080">;               </font><font color="#008000"><i>{ current output line }
   </i></font>LC        <font color="#000080">: </font>byte<font color="#000080">;                        </font><font color="#008000"><i>{ Line Count }
   </i></font>I         <font color="#000080">: </font>Word<font color="#000080">;
   </font>S1        <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font>LA        <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAXLINES<font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font>MaxWordLineLength<font color="#000080">];
</font><font color="#FF0000"><b>begin
  </b></font>WordLine <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; </font>Index1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>Index2 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>InputChar <font color="#000080">:= </font>Space<font color="#000080">;
  </font>ClrScr<font color="#000080">; </font>Write <font color="#000080">(</font><font color="#800000">'Enter text ('</font><font color="#000080">,</font>MAXLINES<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">' line maximum): '</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MAXLINES <font color="#FF0000"><b>do  </b></font><font color="#008000"><i>{ clear storage array }
    </i></font>LA<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
  </font>InputChar <font color="#000080">:= </font>ReadKey<font color="#000080">;
  </font>LC <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font>LINE <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">; </font>gotoXY <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);               </font><font color="#008000"><i>{ work area }
  </i></font><font color="#FF0000"><b>while </b></font>LC <font color="#000080">&lt;= </font>MAXLINES <font color="#FF0000"><b>do
    begin
      case </b></font>InputChar <font color="#FF0000"><b>of
        </b></font><font color="#800000">#13      </font><font color="#000080">: </font><font color="#FF0000"><b>begin                </b></font><font color="#008000"><i>{ C/R - terminate line }
                     </i></font>S1 <font color="#000080">:= </font>WordLine<font color="#000080">;
                     </font>Writeln <font color="#000080">(</font>S1<font color="#000080">); </font>LA<font color="#000080">[</font>LC<font color="#000080">] := </font>S1<font color="#000080">; </font>Inc<font color="#000080">(</font>LC<font color="#000080">);
                     </font>gotoXY <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">); </font>ClrEol<font color="#000080">; </font>WordLine <font color="#000080">:= </font><font color="#800000">''
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>BackSpace<font color="#000080">:
          </font><font color="#FF0000"><b>begin
            </b></font>Write<font color="#000080">(</font>BackSpace<font color="#000080">,</font>Space<font color="#000080">,</font>BackSpace<font color="#000080">);
            </font><font color="#FF0000"><b>if </b></font>Length<font color="#000080">(</font>WordLine<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Dec<font color="#000080">(</font>WordLine<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>FKeyCode<font color="#000080">:                         </font><font color="#008000"><i>{ flush function key }
          </i></font><font color="#FF0000"><b>begin
            </b></font>InputChar <font color="#000080">:= </font>ReadKey<font color="#000080">; </font>InputChar <font color="#000080">:= </font>Space
          <font color="#FF0000"><b>end
        else                                      </b></font><font color="#008000"><i>{ valid char }
          </i></font><font color="#FF0000"><b>begin
            </b></font>Write<font color="#000080">(</font>InputChar<font color="#000080">); </font>WordLine <font color="#000080">:= </font>WordLine<font color="#000080">+</font>InputChar<font color="#000080">;
            </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>WordLine<font color="#000080">) &gt;= (</font>MaxWordLineLength <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then
              begin                  </b></font><font color="#008000"><i>{ have to do a word-wrap }
                </i></font>Index1 <font color="#000080">:= </font>MaxWordLineLength<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
                </font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>WordLine<font color="#000080">[</font>Index1<font color="#000080">] &lt;&gt; </font>Space<font color="#000080">) </font><font color="#FF0000"><b>and
                       </b></font><font color="#000080">(</font>WordLine<font color="#000080">[</font>Index1<font color="#000080">] &lt;&gt; </font>Hyphen<font color="#000080">) </font><font color="#FF0000"><b>and
                       </b></font><font color="#000080">(</font>Index1 <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">))
                  </font><font color="#FF0000"><b>do </b></font>Dec<font color="#000080">(</font>Index1<font color="#000080">);
                </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Index1 <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then  </b></font><font color="#008000"><i>{no space was found to split!}
                  </i></font>Index1 <font color="#000080">:= (</font>MaxWordLineLength<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);    </font><font color="#008000"><i>{forces split}
                </i></font>S1 <font color="#000080">:= </font>Copy<font color="#000080">(</font>WordLine<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Index1<font color="#000080">);
                </font>Delete<font color="#000080">(</font>WordLine<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Index1<font color="#000080">);
                </font><font color="#FF0000"><b>for </b></font>Index2 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH<font color="#000080">(</font>WordLine<font color="#000080">) </font><font color="#FF0000"><b>do
                  </b></font>Write<font color="#000080">(</font>BackSpace<font color="#000080">,</font>Space<font color="#000080">,</font>BackSpace<font color="#000080">);
                </font>FastWrite <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>LINE<font color="#000080">,</font>LONORM<font color="#000080">,</font>S1<font color="#000080">); </font>Inc<font color="#000080">(</font>LINE<font color="#000080">);
                </font>LA<font color="#000080">[</font>LC<font color="#000080">] := </font>S1<font color="#000080">; </font>Inc<font color="#000080">(</font>LC<font color="#000080">);
                </font>gotoXY <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">) </font>ClrEol<font color="#000080">; </font>Write<font color="#000080">(</font>WordLine<font color="#000080">)
              </font><font color="#FF0000"><b>end
          end
      end</b></font><font color="#000080">;                                          </font><font color="#008000"><i>{case InputChar}
      </i></font>InputChar <font color="#000080">:= </font>ReadKey                  <font color="#008000"><i>{Get next key from user}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                       </font><font color="#008000"><i>{while (InputChar &lt;&gt; CarriageReturn)}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTEDIT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
