<html>
<head><title> "Write String in ASM" by BRIAN PAPE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTEDIT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
BRIAN PAPE

Ok, I was writing a little program that I was trying to make as small as
possible, so I wrote this little WriteString function.  Since I'm not an
assembly language mogul by any stretch of the imagination, could one of
you assembly wizards out there tell me if this is Ok.  I mean, it works
fine (and saves almost 1k over linking in the writeln code), but I want
to make sure that I'm not trashing a register or something that needs to
be preserved.  Thanks...  BTW, anybody, go ahead and use it if it
doesn't crash!
}

</i></font><font color="#FF0000"><b>procedure </b></font>WriteString<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push ds
  mov  ah, 40h    </font><font color="#008000"><i>{ DOS fcn call 40h write string to file handle }

  </i></font><font color="#FF00FF">mov  dx, seg s
  mov  ds, dx
  mov  bx, offset s

  mov  dx, bx     </font><font color="#008000"><i>{ now put the offset into dx for the fcn call }
  </i></font><font color="#FF00FF">inc  dx         </font><font color="#008000"><i>{ plus 1, to avoid the length byte }
  </i></font><font color="#FF00FF">mov  cl, [bx]   </font><font color="#008000"><i>{ cl is length to write }
  </i></font><font color="#FF00FF">xor  ch, ch

  mov  bx, 1      </font><font color="#008000"><i>{ file handle to write to }
  </i></font><font color="#FF00FF">int  21h
  pop  ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTEDIT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p></body>
</html>
