<html>
<head><title> "Pretty Good Text Editor" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTEDIT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$B+}    {Boolean complete evaluation on}
{$I+}    {I/O checking on} 
{$N-}    {No numeric coprocessor} 
{$R-}    {Range checking off} 
{$S-}    {Stack checking on}
{$V-}    {Var String checking off} 
 
</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">,</font>Dos<font color="#000080">,</font>Printer<font color="#000080">;
 
</font><font color="#FF0000"><b>Const 
   </b></font>MaxWidth      <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">; 
   </font>RtMrg         <font color="#000080">: </font>Integer <font color="#000080">= </font><font color="#800000">76</font><font color="#000080">; 
   </font>LeftM         <font color="#000080">: </font>Integer <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">; 
   </font>Wrap          <font color="#000080">: </font>Boolean <font color="#000080">= </font>True<font color="#000080">; 
   </font>InSrt         <font color="#000080">: </font>Boolean <font color="#000080">= </font>True<font color="#000080">;
   </font>GoodColorCard <font color="#000080">: </font>Boolean <font color="#000080">= </font>True<font color="#000080">;     </font><font color="#008000"><i>{set false for IBM CGA} 
 
</i></font><font color="#FF0000"><b>Type 
   </b></font>Line       <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font>MaxWidth<font color="#000080">]; 
   </font>LPtr       <font color="#000080">= ^</font>LineRec<font color="#000080">; 
   </font>LineRec    <font color="#000080">= </font><font color="#FF0000"><b>Record
                  </b></font>Last <font color="#000080">: </font>LPtr<font color="#000080">; 
                  </font>Data <font color="#000080">: </font>Line<font color="#000080">; 
                  </font>Next <font color="#000080">: </font>LPtr<font color="#000080">; 
                  </font>Clr  <font color="#000080">: </font>BYTE<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>ScreenLine <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">]; 
   </font>String80   <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">]; 
   </font>Word       <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">24</font><font color="#000080">]; 

</font><font color="#FF0000"><b>Var 
   </b></font>LWord                    <font color="#000080">: </font>ScreenLine<font color="#000080">;     </font><font color="#008000"><i>{ left margin spacer } 
   </i></font>Find <font color="#000080">,</font>Repl <font color="#000080">, 
   </font>InPut<font color="#000080">,</font>OutPut             <font color="#000080">: </font>Word<font color="#000080">; 
   </font>Fore <font color="#000080">, </font>Back<font color="#000080">, </font>Attr        <font color="#000080">: </font>Byte<font color="#000080">;           </font><font color="#008000"><i>{ text colors for Write} 
   </i></font>BaseOfScreen<font color="#000080">,</font>Mode        <font color="#000080">: </font>LongInt<font color="#000080">;        </font><font color="#008000"><i>{ used by FASTWRITE } 
   </i></font>WaitforRetrace           <font color="#000080">: </font>Boolean<font color="#000080">;        </font><font color="#008000"><i>{  &quot;   &quot;      &quot;     } 
   </i></font>VidStatPort<font color="#000080">, </font>VidModePort <font color="#000080">: </font>LongInt<font color="#000080">;        </font><font color="#008000"><i>{  &quot;   &quot;      &quot;     } 
   </i></font>ModePortData             <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40 </font><font color="#000080">: </font><font color="#800000">$65</font><font color="#000080">; </font><font color="#008000"><i>{          } 
   </i></font>SearchString<font color="#000080">, 
   </font>Replacement              <font color="#000080">: </font>ScreenLine<font color="#000080">; 
   </font>TextLine <font color="#000080">,</font>BlankLine      <font color="#000080">: </font>ScreenLine<font color="#000080">; 
   </font>FileFound<font color="#000080">, 
   </font>Finished <font color="#000080">,</font>Changed        <font color="#000080">: </font>Boolean<font color="#000080">; 
   </font>TabSet                   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxWidth<font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Boolean<font color="#000080">;
   </font>TextFile                 <font color="#000080">: </font>Text<font color="#000080">; 
   </font>WorkFile                 <font color="#000080">: </font>Text<font color="#000080">; 
   </font>Ln<font color="#000080">,</font>LastLn<font color="#000080">,</font>NextLn<font color="#000080">, 
   </font>FirstLn<font color="#000080">,</font>EndLn            <font color="#000080">: </font>LPtr<font color="#000080">; 
   </font>MaxLines                 <font color="#000080">: </font>Integer <font color="#000080">; 
   </font>IBeg    <font color="#000080">, </font>IEnd           <font color="#000080">: </font>Integer <font color="#000080">; 
   </font>BlockBeg<font color="#000080">, </font>BlockEnd       <font color="#000080">: </font>LPtr<font color="#000080">; 
   </font>I <font color="#000080">, </font>J<font color="#000080">,                     </font><font color="#008000"><i>{cursor position: i = line, j = column} 
   </i></font>Len<font color="#000080">,                       </font><font color="#008000"><i>{length of current line} 
   </i></font>NLines<font color="#000080">,                    </font><font color="#008000"><i>{length of file} 
   </i></font>NBl<font color="#000080">,                       </font><font color="#008000"><i>{number of buffer lines} 
   </i></font>Top<font color="#000080">,                       </font><font color="#008000"><i>{first line on screen} 
   </i></font>Offset<font color="#000080">, </font>K<font color="#000080">, </font>N             <font color="#000080">: </font>Integer<font color="#000080">; 
   </font>Choice<font color="#000080">, </font>Ch               <font color="#000080">: </font>Char<font color="#000080">; 

</font><font color="#008000"><i>(*-------------------------------------------------------------------*) 
 
</i></font><font color="#FF0000"><b>Function </b></font>YN<font color="#000080">: </font>Boolean<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  Repeat 
    </b></font>Ch <font color="#000080">:= </font>ReadKey 
  <font color="#FF0000"><b>Until </b></font>Ch <font color="#FF0000"><b>In</b></font><font color="#000080">[</font><font color="#800000">'y'</font><font color="#000080">,</font><font color="#800000">'Y'</font><font color="#000080">,</font><font color="#800000">'n'</font><font color="#000080">,</font><font color="#800000">'N'</font><font color="#000080">]; 
  </font><font color="#FF0000"><b>If </b></font>UpCase<font color="#000080">(</font>Ch<font color="#000080">) = </font><font color="#800000">'Y' </font><font color="#FF0000"><b>Then 
    </b></font>YN <font color="#000080">:= </font>True 
  <font color="#FF0000"><b>Else </b></font>YN <font color="#000080">:= </font>False<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>Beep<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>Sound<font color="#000080">(</font><font color="#800000">800</font><font color="#000080">);
  </font>Delay<font color="#000080">(</font><font color="#800000">400</font><font color="#000080">); 
  </font>NoSound<font color="#000080">; 
  </font>Delay<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">); 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>Capitalize<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>fname<font color="#000080">:</font>word<font color="#000080">); 
</font><font color="#FF0000"><b>Begin 
  For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Length<font color="#000080">(</font>FName<font color="#000080">) </font><font color="#FF0000"><b>Do 
    </b></font>FName<font color="#000080">[</font>J<font color="#000080">] := </font>UpCase<font color="#000080">(</font>FName<font color="#000080">[</font>J<font color="#000080">]); 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>ReadFile<font color="#000080">; 
</font><font color="#FF0000"><b>Var  </b></font>OvFlw     <font color="#000080">: </font>Boolean<font color="#000080">; 
     </font>InputLine <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">255</font><font color="#000080">]; 
</font><font color="#FF0000"><b>Begin
  If </b></font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'' </font><font color="#FF0000"><b>Then 
    Begin 
      </b></font>Write<font color="#000080">(</font><font color="#800000">'File to edit: '</font><font color="#000080">); 
      </font>ReadLn<font color="#000080">(</font>Input<font color="#000080">); 
    </font><font color="#FF0000"><b>End 
  Else 
    </b></font>InPut <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">); 
  </font>Capitalize<font color="#000080">(</font>Input<font color="#000080">); 
  </font>New<font color="#000080">(</font>Ln<font color="#000080">); 
  </font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; 
  </font>FirstLn  <font color="#000080">:= </font>Ln<font color="#000080">; 
  </font>EndLn    <font color="#000080">:= </font>Ln<font color="#000080">; 
  </font>Assign<font color="#000080">(</font>WorkFile<font color="#000080">,</font>Input<font color="#000080">); 
  </font><font color="#008000"><i>{$I-} </i></font>ReSet<font color="#000080">(</font>WorkFile<font color="#000080">); </font><font color="#008000"><i>{I+} 
  </i></font><font color="#FF0000"><b>If </b></font>IoResult <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    Begin 
      </b></font>OvFlw <font color="#000080">:= </font>False<font color="#000080">; 
      </font>MaxLines <font color="#000080">:= </font>MemAvail <font color="#FF0000"><b>Div </b></font><font color="#800000">12</font><font color="#000080">; 
      </font><font color="#FF0000"><b>If </b></font>MaxLines <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then 
        </b></font>MaxLines <font color="#000080">:= </font><font color="#800000">2730</font><font color="#000080">; 
      </font>NLines <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; 
      </font>Write<font color="#000080">(</font><font color="#800000">' Reading file '</font><font color="#000080">); 
      </font><font color="#FF0000"><b>While Not </b></font><font color="#000080">(</font>Eof<font color="#000080">(</font>WorkFile<font color="#000080">) </font><font color="#FF0000"><b>Or </b></font>OvFlw<font color="#000080">) </font><font color="#FF0000"><b>Do 
        Begin 
          </b></font>ReadLn<font color="#000080">(</font>WorkFile<font color="#000080">,</font>InputLine<font color="#000080">); 
          </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>InputLine<font color="#000080">) &gt; </font>MaxWidth <font color="#FF0000"><b>Then 
            Begin 
              </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'File is too fat for this editor'</font><font color="#000080">); 
              </font>OvFlw <font color="#000080">:= </font>True<font color="#000080">; </font>Delay<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">); 
            </font><font color="#FF0000"><b>End
          Else 
            Begin 
              </b></font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font>InputLine<font color="#000080">; 
              </font>LastLn   <font color="#000080">:= </font>Ln<font color="#000080">; 
              </font>New<font color="#000080">(</font>Ln<font color="#000080">); 
              </font>Ln<font color="#000080">^.</font>data     <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; 
              </font>Ln<font color="#000080">^.</font>last     <font color="#000080">:= </font>LastLn<font color="#000080">; 
              </font>LastLn<font color="#000080">^.</font>Next <font color="#000080">:= </font>Ln<font color="#000080">; 
              </font>NLines       <font color="#000080">:= </font>NLines <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
              </font><font color="#FF0000"><b>If </b></font>NLines <font color="#000080">&gt; </font>MaxLines <font color="#FF0000"><b>Then 
                Begin 
                  </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'File is too long. Not enough memory'</font><font color="#000080">); 
                  </font>OvFlw <font color="#000080">:= </font>True<font color="#000080">; </font>Delay<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">); 
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;       </font><font color="#008000"><i>{not EOF} 
     </i></font>EndLn <font color="#000080">:= </font>Ln<font color="#000080">; 
     </font><font color="#FF0000"><b>If Not </b></font>OvFlw <font color="#FF0000"><b>Then 
       </b></font>FileFound <font color="#000080">:= </font>True<font color="#000080">; 
    </font><font color="#FF0000"><b>End   </b></font><font color="#008000"><i>{IOresult = 0} 
  </i></font><font color="#FF0000"><b>Else 
    Begin 
      </b></font>Write<font color="#000080">(</font><font color="#800000">'Can''t find this file. Is this a new file?'</font><font color="#000080">); 
      </font><font color="#FF0000"><b>If </b></font>YN <font color="#FF0000"><b>Then 
        Begin 
          </b></font>FileFound <font color="#000080">:= </font>True<font color="#000080">; 
          </font>NLines <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
          </font>New<font color="#000080">(</font>Ln<font color="#000080">); 
          </font>Ln<font color="#000080">^.</font>Data      <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; 
          </font>FirstLn<font color="#000080">^.</font>Next <font color="#000080">:= </font>Ln<font color="#000080">; 
          </font>Ln<font color="#000080">^.</font>Last      <font color="#000080">:= </font>FirstLn<font color="#000080">; 
          </font>EndLn         <font color="#000080">:= </font>Ln<font color="#000080">; 
        </font><font color="#FF0000"><b>End 
      Else 
        </b></font>FileFound <font color="#000080">:= </font>False<font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font>Close<font color="#000080">(</font>WorkFile<font color="#000080">); 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>WriteFile<font color="#000080">;     </font><font color="#008000"><i>{ save changes to file } 
</i></font><font color="#FF0000"><b>Begin 
  </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">45 </font><font color="#FF0000"><b>Do </b></font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">); 
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>Write<font color="#000080">(</font><font color="#800000">'Text was changed. Save? '</font><font color="#000080">); 
  </font><font color="#FF0000"><b>If </b></font>YN <font color="#FF0000"><b>Then 
    Begin 
      </b></font>Write<font color="#000080">(</font><font color="#800000">'as: '</font><font color="#000080">); </font>ReadLn<font color="#000080">(</font>OutPut<font color="#000080">); 
      </font><font color="#FF0000"><b>If </b></font>OutPut <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>Then 
        </b></font>OutPut <font color="#000080">:= </font>Input<font color="#000080">; 
      </font>Capitalize<font color="#000080">(</font>OutPut<font color="#000080">); 
      </font>GotoXY<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>WriteLn<font color="#000080">(</font><font color="#800000">'    Writing to disk as '</font><font color="#000080">,</font>OutPut<font color="#000080">); 
      </font>Assign<font color="#000080">(</font>WorkFile<font color="#000080">,</font>OutPut<font color="#000080">); 
      </font>ReWrite<font color="#000080">(</font>WorkFile<font color="#000080">); 
      </font>Ln <font color="#000080">:= </font>EndLn<font color="#000080">^.</font>Next<font color="#000080">; 
      </font><font color="#FF0000"><b>Repeat 
        </b></font>WriteLn<font color="#000080">(</font>WorkFile<font color="#000080">,</font>Ln<font color="#000080">^.</font>Data<font color="#000080">); 
        </font>Ln <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next 
      <font color="#FF0000"><b>Until </b></font>Ln <font color="#000080">= </font>EndLn<font color="#000080">; 
      </font>Close<font color="#000080">(</font>WorkFile<font color="#000080">); 
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{------------------------- FastWrite Routines -------------------------} 
 
</i></font><font color="#FF0000"><b>Function </b></font>Attribute<font color="#000080">(</font>Foreground<font color="#000080">, </font>Background <font color="#000080">: </font>Byte<font color="#000080">) : </font>Byte<font color="#000080">; 
  </font><font color="#008000"><i>{-Translates foreground and background colors into video attributes. 
    &quot;And 127&quot; masks out the blink bit. Add 128 to the result to set it.} 
</i></font><font color="#FF0000"><b>Begin 
   </b></font>Attribute <font color="#000080">:= ((</font>Background <font color="#FF0000"><b>Shl </b></font><font color="#800000">4</font><font color="#000080">) + </font>Foreground<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#800000">127</font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Function </b></font>EgaInstalled <font color="#000080">: </font>Boolean<font color="#000080">; 
  </font><font color="#008000"><i>{-Test for presence of the EGA. I have little idea how this works, but 
    it does.} 
</i></font><font color="#FF0000"><b>Begin 
Inline</b></font><font color="#000080">( 
  </font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$12      </font><font color="#008000"><i>{      MOV AX,$1200} 
  </i></font><font color="#000080">/</font><font color="#800000">$BB</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/</font><font color="#800000">$00     </font><font color="#008000"><i>{      MOV BX,$10} 
  </i></font><font color="#000080">/</font><font color="#800000">$B9</font><font color="#000080">/</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$FF     </font><font color="#008000"><i>{      MOV CX,$FFFF} 
  </i></font><font color="#000080">/</font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10         </font><font color="#008000"><i>{      INT $10} 
  </i></font><font color="#000080">/</font><font color="#800000">$31</font><font color="#000080">/</font><font color="#800000">$C0         </font><font color="#008000"><i>{      XOR AX,AX} 
  </i></font><font color="#000080">/</font><font color="#800000">$81</font><font color="#000080">/</font><font color="#800000">$F9</font><font color="#000080">/</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$FF </font><font color="#008000"><i>{      CMP CX,$FFFF} 
  </i></font><font color="#000080">/</font><font color="#800000">$74</font><font color="#000080">/</font><font color="#800000">$01         </font><font color="#008000"><i>{      JE DONE} 
  </i></font><font color="#000080">/</font><font color="#800000">$40             </font><font color="#008000"><i>{      INC AX} 
  </i></font><font color="#000080">/</font><font color="#800000">$88</font><font color="#000080">/</font><font color="#800000">$46</font><font color="#000080">/</font><font color="#800000">$04     </font><font color="#008000"><i>{DONE: MOV [BP+$04],AL} 
</i></font><font color="#000080">); 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>GetVideoMode<font color="#000080">; 
  </font><font color="#008000"><i>{-Video mode of 7 indicates mono display; all other modes are for color 
    displays. This routine MUST be called before any of the screen writing 
    routines are used!} 
</i></font><font color="#FF0000"><b>Var 
  </b></font>Mode <font color="#000080">: </font>Integer<font color="#000080">; 
  </font>Vid  <font color="#000080">: </font>Integer <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40 </font><font color="#000080">: </font><font color="#800000">$63</font><font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
     Inline</b></font><font color="#000080">( 
       </font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$0F        </font><font color="#008000"><i>{MOV AH,$F} 
       </i></font><font color="#000080">/</font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10       </font><font color="#008000"><i>{INT $10} 
       </i></font><font color="#000080">/</font><font color="#800000">$30</font><font color="#000080">/</font><font color="#800000">$E4       </font><font color="#008000"><i>{XOR AH,AH} 
       </i></font><font color="#000080">/</font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$46</font><font color="#000080">/&lt;</font>Mode <font color="#008000"><i>{MOV [BP+&lt;Mode],AX} 
     </i></font><font color="#000080">); 
     </font><font color="#FF0000"><b>If </b></font>Mode <font color="#000080">= </font><font color="#800000">6 </font><font color="#FF0000"><b>Then </b></font>Mode <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">; 
     </font><font color="#FF0000"><b>If </b></font>Mode <font color="#000080">= </font><font color="#800000">7 </font><font color="#FF0000"><b>Then </b></font>BaseOfScreen <font color="#000080">:= </font><font color="#800000">$B000  </font><font color="#008000"><i>{ Mono } 
                 </i></font><font color="#FF0000"><b>Else </b></font>BaseOfScreen <font color="#000080">:= </font><font color="#800000">$B800</font><font color="#000080">; </font><font color="#008000"><i>{ Color } 
     </i></font>VidStatPort    <font color="#000080">:= </font>Vid <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">;   </font><font color="#008000"><i>{video status port for either card} 
     </i></font>VidModePort    <font color="#000080">:= </font>Vid <font color="#000080">+ </font><font color="#800000">4</font><font color="#000080">;   </font><font color="#008000"><i>{video mode port for either card} 
     </i></font>WaitForRetrace <font color="#000080">:= (</font>BaseOfScreen <font color="#000080">= </font><font color="#800000">$B800</font><font color="#000080">) </font><font color="#FF0000"><b>And Not </b></font>EgaInstalled<font color="#000080">; 
     </font><font color="#008000"><i>{ *VERY IMPORTANT*  WaitForRetrace MUST be false if BaseOfScreen = $B000. } 
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>VideoOff<font color="#000080">; 
</font><font color="#008000"><i>{-avoid snow writing full screen to c/g card} 
</i></font><font color="#FF0000"><b>Begin 
  </b></font><font color="#008000"><i>{clear video enable bit} 
  </i></font>Port<font color="#000080">[</font>VidModePort<font color="#000080">] := </font>ModePortData <font color="#FF0000"><b>And </b></font><font color="#800000">247</font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>VideoOn<font color="#000080">; 
</font><font color="#008000"><i>{-reenable video} 
</i></font><font color="#FF0000"><b>Begin 
  </b></font><font color="#008000"><i>{set video enable bit} 
  </i></font>Port<font color="#000080">[</font>VidModePort<font color="#000080">] := </font>ModePortData <font color="#FF0000"><b>Or </b></font><font color="#800000">8</font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>FastWrite<font color="#000080">( </font>St <font color="#000080">: </font>String80<font color="#000080">; </font>Row<font color="#000080">, </font>Col<font color="#000080">, </font>Attr <font color="#000080">: </font>Byte <font color="#000080">); 
  </font><font color="#008000"><i>{-Write St directly to video memory, without snow.} 
</i></font><font color="#FF0000"><b>Begin 
Inline</b></font><font color="#000080">( 
  </font><font color="#800000">$1E                    </font><font color="#008000"><i>{         PUSH DS                  ;Save DS} 
  </i></font><font color="#000080">/</font><font color="#800000">$31</font><font color="#000080">/</font><font color="#800000">$C0               </font><font color="#008000"><i>{         XOR AX,AX                ;AX = 0} 
  </i></font><font color="#000080">/</font><font color="#800000">$88</font><font color="#000080">/</font><font color="#800000">$C1               </font><font color="#008000"><i>{         MOV CL,AL                ;CL = 0} 
  </i></font><font color="#000080">/</font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$AE</font><font color="#000080">/&gt;</font>Row          <font color="#008000"><i>{         MOV CH,[BP+&gt;Row]         ;CX = Row * 256} 
  </i></font><font color="#000080">/</font><font color="#800000">$FE</font><font color="#000080">/</font><font color="#800000">$CD               </font><font color="#008000"><i>{         DEC CH                   ;Row to 0..24 range} 
  </i></font><font color="#000080">/</font><font color="#800000">$D1</font><font color="#000080">/</font><font color="#800000">$E9               </font><font color="#008000"><i>{         SHR CX,1                 ;CX = Row * 128} 
  </i></font><font color="#000080">/</font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$CF               </font><font color="#008000"><i>{         MOV DI,CX                ;Store in DI} 
  </i></font><font color="#000080">/</font><font color="#800000">$D1</font><font color="#000080">/</font><font color="#800000">$EF               </font><font color="#008000"><i>{         SHR DI,1                 ;DI = Row * 64} 
  </i></font><font color="#000080">/</font><font color="#800000">$D1</font><font color="#000080">/</font><font color="#800000">$EF               </font><font color="#008000"><i>{         SHR DI,1                 ;DI = Row * 32} 
  </i></font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/</font><font color="#800000">$CF               </font><font color="#008000"><i>{         ADD DI,CX                ;DI = (Row * 160)} 
  </i></font><font color="#000080">/</font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$8E</font><font color="#000080">/&gt;</font>Col          <font color="#008000"><i>{         MOV CX,[BP+&gt;Col]         ;CX = Column} 
  </i></font><font color="#000080">/</font><font color="#800000">$49                   </font><font color="#008000"><i>{         DEC CX                   ;Col to 0..79 range} 
  </i></font><font color="#000080">/</font><font color="#800000">$D1</font><font color="#000080">/</font><font color="#800000">$E1               </font><font color="#008000"><i>{         SHL CX,1                 ;Account for attribute bytes} 
  </i></font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/</font><font color="#800000">$CF               </font><font color="#008000"><i>{         ADD DI,CX                ;DI = (Row * 160) + (Col * 2)} 
  </i></font><font color="#000080">/</font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/&gt;</font>BaseOfScreen <font color="#008000"><i>{         MOV ES,[&gt;BaseOfScreen]   ;ES:DI points to Base:Row,Col} 
  </i></font><font color="#000080">/</font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$0E</font><font color="#000080">/&gt;</font>WaitForRetrace<font color="#008000"><i>{        MOV CL,[&gt;WaitForRetrace] ;Grab this before changing DS} 
  </i></font><font color="#000080">/</font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$D2               </font><font color="#008000"><i>{         MOV DX,SS                ;Move SS...} 
  </i></font><font color="#000080">/</font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$DA               </font><font color="#008000"><i>{         MOV DS,DX                ; into DS} 
  </i></font><font color="#000080">/</font><font color="#800000">$8D</font><font color="#000080">/</font><font color="#800000">$B6</font><font color="#000080">/&gt;</font>St           <font color="#008000"><i>{         LEA SI,[BP+&gt;St]          ;DS:SI points to St[0]} 
  </i></font><font color="#000080">/</font><font color="#800000">$FC                   </font><font color="#008000"><i>{         CLD                      ;Set direction to forward} 
  </i></font><font color="#000080">/</font><font color="#800000">$AC                   </font><font color="#008000"><i>{         LODSB                    ;AX = Length(St); DS:SI -&gt; St[1]} 
  </i></font><font color="#000080">/</font><font color="#800000">$91                   </font><font color="#008000"><i>{         XCHG AX,CX               ;CX = Length; AL = Wait} 
  </i></font><font color="#000080">/</font><font color="#800000">$E3</font><font color="#000080">/</font><font color="#800000">$29               </font><font color="#008000"><i>{         JCXZ Exit                ;If string empty, Exit} 
  </i></font><font color="#000080">/</font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$A6</font><font color="#000080">/&gt;</font>Attr         <font color="#008000"><i>{         MOV AH,[BP+&gt;Attr]        ;AH = Attribute} 
  </i></font><font color="#000080">/</font><font color="#800000">$D0</font><font color="#000080">/</font><font color="#800000">$D8               </font><font color="#008000"><i>{         RCR AL,1                 ;If WaitForRetrace is False...} 
  </i></font><font color="#000080">/</font><font color="#800000">$73</font><font color="#000080">/</font><font color="#800000">$1D               </font><font color="#008000"><i>{         JNC NoWait               ; use NoWait routine} 
  </i></font><font color="#000080">/</font><font color="#800000">$BA</font><font color="#000080">/</font><font color="#800000">$DA</font><font color="#000080">/</font><font color="#800000">$03           </font><font color="#008000"><i>{         MOV DX,$03DA             ;Point DX to CGA status port} 
  </i></font><font color="#000080">/</font><font color="#800000">$AC                   </font><font color="#008000"><i>{Next:    LODSB                    ;Load next character into AL} 
                         {                                  ; AH already has Attr} 
  </i></font><font color="#000080">/</font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$C3               </font><font color="#008000"><i>{         MOV BX,AX                ;Store video word in BX} 
  </i></font><font color="#000080">/</font><font color="#800000">$FA                   </font><font color="#008000"><i>{         CLI                      ;No interrupts now} 
  </i></font><font color="#000080">/</font><font color="#800000">$EC                   </font><font color="#008000"><i>{WaitNoH: IN AL,DX                 ;Get 6845 status} 
  </i></font><font color="#000080">/</font><font color="#800000">$A8</font><font color="#000080">/</font><font color="#800000">$08               </font><font color="#008000"><i>{         TEST AL,8                ;Check for vertical retrace} 
  </i></font><font color="#000080">/</font><font color="#800000">$75</font><font color="#000080">/</font><font color="#800000">$09               </font><font color="#008000"><i>{         JNZ Store                ; In progress? go} 
  </i></font><font color="#000080">/</font><font color="#800000">$D0</font><font color="#000080">/</font><font color="#800000">$D8               </font><font color="#008000"><i>{         RCR AL,1                 ;Else, wait for end of} 
  </i></font><font color="#000080">/</font><font color="#800000">$72</font><font color="#000080">/</font><font color="#800000">$F7               </font><font color="#008000"><i>{         JC WaitNoH               ; horizontal retrace} 
  </i></font><font color="#000080">/</font><font color="#800000">$EC                   </font><font color="#008000"><i>{WaitH:   IN AL,DX                 ;Get 6845 status again} 
  </i></font><font color="#000080">/</font><font color="#800000">$D0</font><font color="#000080">/</font><font color="#800000">$D8               </font><font color="#008000"><i>{         RCR AL,1                 ;Wait for horizontal} 
  </i></font><font color="#000080">/</font><font color="#800000">$73</font><font color="#000080">/</font><font color="#800000">$FB               </font><font color="#008000"><i>{         JNC WaitH                ; retrace} 
  </i></font><font color="#000080">/</font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$D8               </font><font color="#008000"><i>{Store:   MOV AX,BX                ;Move word back to AX...} 
  </i></font><font color="#000080">/</font><font color="#800000">$AB                   </font><font color="#008000"><i>{         STOSW                    ; and then to screen} 
  </i></font><font color="#000080">/</font><font color="#800000">$FB                   </font><font color="#008000"><i>{         STI                      ;Allow interrupts} 
  </i></font><font color="#000080">/</font><font color="#800000">$E2</font><font color="#000080">/</font><font color="#800000">$E8               </font><font color="#008000"><i>{         LOOP Next                ;Get next character} 
  </i></font><font color="#000080">/</font><font color="#800000">$EB</font><font color="#000080">/</font><font color="#800000">$04               </font><font color="#008000"><i>{         JMP SHORT Exit           ;Done} 
  </i></font><font color="#000080">/</font><font color="#800000">$AC                   </font><font color="#008000"><i>{NoWait:  LODSB                    ;Load next character into AL} 
                         {                                  ; AH already has Attr} 
  </i></font><font color="#000080">/</font><font color="#800000">$AB                   </font><font color="#008000"><i>{         STOSW                    ;Move video word into place} 
  </i></font><font color="#000080">/</font><font color="#800000">$E2</font><font color="#000080">/</font><font color="#800000">$FC               </font><font color="#008000"><i>{         LOOP NoWait              ;Get next character} 
  </i></font><font color="#000080">/</font><font color="#800000">$1F                   </font><font color="#008000"><i>{Exit:    POP DS                   ;Restore DS} 
</i></font><font color="#000080">); 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>FastWriteV<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>St<font color="#000080">; </font>Row<font color="#000080">, </font>Col<font color="#000080">, </font>Attr <font color="#000080">: </font>Byte <font color="#000080">); 
  </font><font color="#008000"><i>{-Works with string variables ONLY. (I made St an untyped parameter 
    only to make this easier to use when type checking is on.) This is 
    just FastWrite optimized for use with string Variables, for times 
    when speed really matters.} 
</i></font><font color="#FF0000"><b>Begin 
Inline</b></font><font color="#000080">( 
  </font><font color="#800000">$1E                    </font><font color="#008000"><i>{         PUSH DS} 
  </i></font><font color="#000080">/</font><font color="#800000">$31</font><font color="#000080">/</font><font color="#800000">$C0               </font><font color="#008000"><i>{         XOR AX,AX} 
  </i></font><font color="#000080">/</font><font color="#800000">$88</font><font color="#000080">/</font><font color="#800000">$C1               </font><font color="#008000"><i>{         MOV CL,AL} 
  </i></font><font color="#000080">/</font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$6E</font><font color="#000080">/&lt;</font>Row          <font color="#008000"><i>{         MOV CH,[BP+&lt;Row]} 
  </i></font><font color="#000080">/</font><font color="#800000">$FE</font><font color="#000080">/</font><font color="#800000">$CD               </font><font color="#008000"><i>{         DEC CH} 
  </i></font><font color="#000080">/</font><font color="#800000">$D1</font><font color="#000080">/</font><font color="#800000">$E9               </font><font color="#008000"><i>{         SHR CX,1} 
  </i></font><font color="#000080">/</font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$CF               </font><font color="#008000"><i>{         MOV DI,CX} 
  </i></font><font color="#000080">/</font><font color="#800000">$D1</font><font color="#000080">/</font><font color="#800000">$EF               </font><font color="#008000"><i>{         SHR DI,1} 
  </i></font><font color="#000080">/</font><font color="#800000">$D1</font><font color="#000080">/</font><font color="#800000">$EF               </font><font color="#008000"><i>{         SHR DI,1} 
  </i></font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/</font><font color="#800000">$CF               </font><font color="#008000"><i>{         ADD DI,CX} 
  </i></font><font color="#000080">/</font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$4E</font><font color="#000080">/&lt;</font>Col          <font color="#008000"><i>{         MOV CX,[BP+&lt;Col]} 
  </i></font><font color="#000080">/</font><font color="#800000">$49                   </font><font color="#008000"><i>{         DEC CX} 
  </i></font><font color="#000080">/</font><font color="#800000">$D1</font><font color="#000080">/</font><font color="#800000">$E1               </font><font color="#008000"><i>{         SHL CX,1} 
  </i></font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/</font><font color="#800000">$CF               </font><font color="#008000"><i>{         ADD DI,CX} 
  </i></font><font color="#000080">/</font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/&gt;</font>BaseOfScreen <font color="#008000"><i>{         MOV ES,[&gt;BaseOfScreen]} 
  </i></font><font color="#000080">/</font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$0E</font><font color="#000080">/&gt;</font>WaitForRetrace<font color="#008000"><i>{        MOV CL,[&gt;WaitForRetrace]} 
  </i></font><font color="#000080">/</font><font color="#800000">$C5</font><font color="#000080">/</font><font color="#800000">$76</font><font color="#000080">/&lt;</font>St           <font color="#008000"><i>{         LDS SI,[BP+&lt;St]          ;DS:SI points to St[0]} 
  </i></font><font color="#000080">/</font><font color="#800000">$FC                   </font><font color="#008000"><i>{         CLD} 
  </i></font><font color="#000080">/</font><font color="#800000">$AC                   </font><font color="#008000"><i>{         LODSB} 
  </i></font><font color="#000080">/</font><font color="#800000">$91                   </font><font color="#008000"><i>{         XCHG AX,CX} 
  </i></font><font color="#000080">/</font><font color="#800000">$E3</font><font color="#000080">/</font><font color="#800000">$28               </font><font color="#008000"><i>{         JCXZ Exit} 
  </i></font><font color="#000080">/</font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$66</font><font color="#000080">/&lt;</font>Attr         <font color="#008000"><i>{         MOV AH,[BP+&lt;Attr]} 
  </i></font><font color="#000080">/</font><font color="#800000">$D0</font><font color="#000080">/</font><font color="#800000">$D8               </font><font color="#008000"><i>{         RCR AL,1} 
  </i></font><font color="#000080">/</font><font color="#800000">$73</font><font color="#000080">/</font><font color="#800000">$1D               </font><font color="#008000"><i>{         JNC NoWait} 
  </i></font><font color="#000080">/</font><font color="#800000">$BA</font><font color="#000080">/</font><font color="#800000">$DA</font><font color="#000080">/</font><font color="#800000">$03           </font><font color="#008000"><i>{         MOV DX,$03DA} 
  </i></font><font color="#000080">/</font><font color="#800000">$AC                   </font><font color="#008000"><i>{Next:    LODSB} 
  </i></font><font color="#000080">/</font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$C3               </font><font color="#008000"><i>{         MOV BX,AX} 
  </i></font><font color="#000080">/</font><font color="#800000">$FA                   </font><font color="#008000"><i>{         CLI} 
  </i></font><font color="#000080">/</font><font color="#800000">$EC                   </font><font color="#008000"><i>{WaitNoH: IN AL,DX} 
  </i></font><font color="#000080">/</font><font color="#800000">$A8</font><font color="#000080">/</font><font color="#800000">$08               </font><font color="#008000"><i>{         TEST AL,8} 
  </i></font><font color="#000080">/</font><font color="#800000">$75</font><font color="#000080">/</font><font color="#800000">$09               </font><font color="#008000"><i>{         JNZ Store} 
  </i></font><font color="#000080">/</font><font color="#800000">$D0</font><font color="#000080">/</font><font color="#800000">$D8               </font><font color="#008000"><i>{         RCR AL,1} 
  </i></font><font color="#000080">/</font><font color="#800000">$72</font><font color="#000080">/</font><font color="#800000">$F7               </font><font color="#008000"><i>{         JC WaitNoH} 
  </i></font><font color="#000080">/</font><font color="#800000">$EC                   </font><font color="#008000"><i>{WaitH:   IN AL,DX} 
  </i></font><font color="#000080">/</font><font color="#800000">$D0</font><font color="#000080">/</font><font color="#800000">$D8               </font><font color="#008000"><i>{         RCR AL,1} 
  </i></font><font color="#000080">/</font><font color="#800000">$73</font><font color="#000080">/</font><font color="#800000">$FB               </font><font color="#008000"><i>{         JNC WaitH} 
  </i></font><font color="#000080">/</font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$D8               </font><font color="#008000"><i>{Store:   MOV AX,BX} 
  </i></font><font color="#000080">/</font><font color="#800000">$AB                   </font><font color="#008000"><i>{         STOSW} 
  </i></font><font color="#000080">/</font><font color="#800000">$FB                   </font><font color="#008000"><i>{         STI} 
  </i></font><font color="#000080">/</font><font color="#800000">$E2</font><font color="#000080">/</font><font color="#800000">$E8               </font><font color="#008000"><i>{         LOOP Next} 
  </i></font><font color="#000080">/</font><font color="#800000">$EB</font><font color="#000080">/</font><font color="#800000">$04               </font><font color="#008000"><i>{         JMP SHORT Exit} 
  </i></font><font color="#000080">/</font><font color="#800000">$AC                   </font><font color="#008000"><i>{NoWait:  LODSB} 
  </i></font><font color="#000080">/</font><font color="#800000">$AB                   </font><font color="#008000"><i>{         STOSW} 
  </i></font><font color="#000080">/</font><font color="#800000">$E2</font><font color="#000080">/</font><font color="#800000">$FC               </font><font color="#008000"><i>{         LOOP NoWait} 
  </i></font><font color="#000080">/</font><font color="#800000">$1F                   </font><font color="#008000"><i>{Exit:    POP DS} 
</i></font><font color="#000080">); 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{------------------------- FastWrite Routines -------------------------} 
 
</i></font><font color="#FF0000"><b>Procedure </b></font>RulerLine<font color="#000080">; 
</font><font color="#FF0000"><b>Var 
  </b></font>C <font color="#000080">, </font>J <font color="#000080">: </font>Byte<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>TextLine <font color="#000080">:= </font>BlankLine<font color="#000080">; 
  </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">79 </font><font color="#FF0000"><b>Do 
    Begin 
      If </b></font>J <font color="#FF0000"><b>Mod </b></font><font color="#800000">5 </font><font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then 
        </b></font>TextLine<font color="#000080">[</font>J<font color="#000080">] := </font><font color="#800000">'+' 
      </font><font color="#FF0000"><b>Else 
        </b></font>TextLine<font color="#000080">[</font>J<font color="#000080">] := </font><font color="#800000">'-'</font><font color="#000080">; 
      </font>C <font color="#000080">:= </font><font color="#800000">48 </font><font color="#000080">+ ((</font>J <font color="#000080">+ </font>Offset<font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>Mod </b></font><font color="#800000">10 </font><font color="#000080">; 
      </font><font color="#FF0000"><b>If </b></font>J <font color="#FF0000"><b>Mod </b></font><font color="#800000">10 </font><font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then 
        </b></font>TextLine<font color="#000080">[</font>J<font color="#000080">] := </font>Chr<font color="#000080">(</font>C<font color="#000080">); 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font>FastWriteV<font color="#000080">(</font>TextLine<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">, </font>Attr<font color="#000080">); 
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Wrap<font color="#000080">) </font><font color="#FF0000"><b>Then   </b></font><font color="#008000"><i>{ put margin markers on ruler } 
    </i></font><font color="#FF0000"><b>Begin 
      </b></font>Textcolor<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">); 
      </font>TextBackGround<font color="#000080">(</font>Green<font color="#000080">); 
      </font><font color="#FF0000"><b>if </b></font>LeftM <font color="#000080">&gt;= </font>Offset <font color="#FF0000"><b>Then 
        Begin 
          </b></font>GotoXY<font color="#000080">(</font>LeftM <font color="#000080">- </font>Offset <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">); 
          </font>Write<font color="#000080">(</font><font color="#800000">'|'</font><font color="#000080">); 
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
      </font><font color="#FF0000"><b>If </b></font>RtMrg <font color="#000080">&gt;= </font>Offset <font color="#FF0000"><b>Then 
        Begin 
          </b></font>GotoXY<font color="#000080">(</font>RtMrg <font color="#000080">- </font>Offset <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">); 
          </font>Write<font color="#000080">(</font><font color="#800000">'|'</font><font color="#000080">); 
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
      </font>TextColor<font color="#000080">( </font>Fore <font color="#000080">); 
      </font>TextBackGround<font color="#000080">( </font>Back <font color="#000080">); 
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>StatusLine<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>Textline <font color="#000080">:= </font>BlankLine<font color="#000080">; 
  </font>Insert<font color="#000080">(</font><font color="#800000">' Line:      Column:'</font><font color="#000080">,</font>TextLine<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); 
  </font><font color="#FF0000"><b>If </b></font>Insrt <font color="#FF0000"><b>Then </b></font>Insert<font color="#000080">(</font><font color="#800000">'Insert '</font><font color="#000080">,</font>TextLine<font color="#000080">,</font><font color="#800000">26</font><font color="#000080">) 
    </font><font color="#FF0000"><b>Else </b></font>Insert<font color="#000080">(</font><font color="#800000">'OverWrite '</font><font color="#000080">,</font>TextLine<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">); 
  </font><font color="#FF0000"><b>If </b></font>Wrap  <font color="#FF0000"><b>Then </b></font>Insert<font color="#000080">(</font><font color="#800000">' WordWrap'</font><font color="#000080">,</font>TextLine<font color="#000080">,</font><font color="#800000">35</font><font color="#000080">) 
    </font><font color="#FF0000"><b>Else </b></font>Insert<font color="#000080">(</font><font color="#800000">'  NoWrap   '</font><font color="#000080">,</font>TextLine<font color="#000080">,</font><font color="#800000">35</font><font color="#000080">); 
  </font>Insert<font color="#000080">(</font><font color="#800000">' Workfile:'</font><font color="#000080">,</font>TextLine<font color="#000080">,</font><font color="#800000">47</font><font color="#000080">); 
  </font>Insert<font color="#000080">(</font>Input<font color="#000080">,</font>TextLine<font color="#000080">,</font><font color="#800000">58</font><font color="#000080">); 
  </font>FastWriteV<font color="#000080">(</font>TextLine<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Attr<font color="#000080">); 
  </font>RulerLine<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>WriteLine<font color="#000080">(</font>Row<font color="#000080">,</font>Attr<font color="#000080">:</font>Byte<font color="#000080">);    </font><font color="#008000"><i>{ direct write to screen } 
</i></font><font color="#FF0000"><b>Var </b></font>Len        <font color="#000080">: </font>Byte<font color="#000080">;                 </font><font color="#008000"><i>{ writes blanks where there is no text} 
    </i></font>Contents   <font color="#000080">: </font>ScreenLine<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>TextLine <font color="#000080">:= </font>BlankLine<font color="#000080">; 
  </font>Contents <font color="#000080">:= </font>Copy<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font>Offset<font color="#000080">,</font><font color="#800000">80</font><font color="#000080">); 
  </font>Len      <font color="#000080">:= </font>Ord<font color="#000080">(</font>Contents<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]); 
  </font>Insert<font color="#000080">(</font>Contents<font color="#000080">,</font>TextLine<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); 
  </font><font color="#FF0000"><b>If </b></font>Len <font color="#000080">= </font><font color="#800000">80 </font><font color="#FF0000"><b>Then </b></font>TextLine<font color="#000080">[</font><font color="#800000">80</font><font color="#000080">] := </font><font color="#800000">'+' 
    </font><font color="#FF0000"><b>Else If </b></font>Len <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>TextLine<font color="#000080">[</font><font color="#800000">80</font><font color="#000080">] := </font><font color="#800000">'&lt;'</font><font color="#000080">; 
  </font>FastWriteV<font color="#000080">(</font>TextLine<font color="#000080">,</font>Row<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Attr<font color="#000080">); 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>Screen<font color="#000080">;     </font><font color="#008000"><i>{ rewrites the bottom 23 lines } 
</i></font><font color="#FF0000"><b>Var </b></font>Row   <font color="#000080">: </font>Byte<font color="#000080">; 
    </font>TopLn <font color="#000080">: </font>LPtr<font color="#000080">; 
</font><font color="#FF0000"><b>Begin                 </b></font><font color="#008000"><i>{ makes sure i and ln are in register } 
  </i></font>Ln <font color="#000080">:= </font>EndLn<font color="#000080">^.</font>Next<font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>Top <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
   For </b></font>K <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>To </b></font>Top <font color="#FF0000"><b>Do 
    </b></font>Ln <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next<font color="#000080">; 
  </font>TopLn <font color="#000080">:= </font>Ln<font color="#000080">; 
  </font><font color="#FF0000"><b>For </b></font>Row <font color="#000080">:= </font><font color="#800000">3 </font><font color="#FF0000"><b>to </b></font><font color="#800000">25 </font><font color="#FF0000"><b>do 
   Begin 
    </b></font>WriteLine<font color="#000080">(</font>Row<font color="#000080">,</font>Attr<font color="#000080">); 
    </font><font color="#FF0000"><b>If </b></font>Ln <font color="#000080">&lt;&gt; </font>EndLn <font color="#FF0000"><b>Then 
     </b></font>Ln <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next<font color="#000080">; 
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font>Ln  <font color="#000080">:= </font>TopLn<font color="#000080">; 
  </font>Row <font color="#000080">:= </font>I <font color="#000080">- </font>Top<font color="#000080">; 
  </font><font color="#FF0000"><b>While </b></font>Row <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do 
   Begin 
    </b></font>Ln  <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next<font color="#000080">; 
    </font>Row <font color="#000080">:= </font>Row <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>Help<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">80</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">); 
  </font>ClrScr<font color="#000080">;
  </font>GetVideoMode<font color="#000080">;
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;'</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm;                    Window Editor -- by GDSOFT                                &ordm;'</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &Uacute;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&iquest; &Uacute;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&iquest; &Uacute;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&iquest; &ordm;'</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^X      line up      &sup3; &sup3;  ^S     column left   &sup3; &sup3;  Alt-A   Ascii       &sup3; &ordm;'</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^E      line down    &sup3; &sup3;  ^D     column right  &sup3; &sup3;  Alt-B   Back Color  &sup3; &ordm;'</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^C      page up      &sup3; &sup3;  ^PgUp  file home     &sup3; &sup3;  Alt-C   Copy Block  &sup3; &ordm;'</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^R      page down    &sup3; &sup3;  ^PgDn  file end      &sup3; &sup3;  Alt-D   Del  Block  &sup3; &ordm;'</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^K      quit         &sup3; &sup3;  ^N     insert line   &sup3; &sup3;  Alt-F   Fore Color  &sup3; &ordm;'</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^P      set margins  &sup3; &sup3;  ^Y     delete line   &sup3; &sup3;  Alt-G   Goto Block  &sup3; &ordm;'</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^BkSp   delete word  &sup3; &sup3;  BkSp   delete char   &sup3; &sup3;  Alt-M   Move Block  &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^V      toggle ins   &sup3; &sup3;  Ins    toggle insert &sup3; &sup3;  Alt-N   Clr  Marks  &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^W      window dn    &sup3; &sup3;                       &sup3; &sup3;  Alt-S   Beg  Block  &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^Z      window up    &sup3; &sup3;  Del    delete char   &sup3; &sup3;  Alt-T   End  Block  &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^Home   erase bol    &sup3; &sup3;  Home   beg of line   &sup3; &sup3;                      &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^End    erase eol    &sup3; &sup3;  End    end of line   &sup3; &sup3;  SPELLING CHECK      &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^F      next word    &sup3; &sup3;  Tab    next tab stop &sup3; &sup3;  Alt-0   Document    &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  ^A      prev word    &sup3; &sup3;  BTab   last tab stop &sup3; &sup3;  Alt-1   Word        &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">17</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  F1      help         &sup3; &sup3;  F6     replace       &sup3; &sup3;                      &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  F2      clear marks  &sup3; &sup3;  F7     page up       &sup3; &sup3;                      &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">19</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  F3      quit         &sup3; &sup3;  F8     page down     &sup3; &sup3;                      &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  F4      set margins  &sup3; &sup3;  F9     prev word     &sup3; &sup3;                      &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &sup3;  F5      search       &sup3; &sup3;  F10    next word     &sup3; &sup3;                      &sup3; &ordm;'</font><font color="#000080">,</font><font color="#800000">22</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm; &Agrave;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Ugrave; &Agrave;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Ugrave; &Agrave;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Ugrave; &ordm;'</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&ordm;                  Press any key to return to your editing.....                &ordm;'</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font>FastWrite<font color="#000080">(</font><font color="#800000">'&Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;'</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Attr <font color="#000080">);
  </font><font color="#FF0000"><b>Repeat
  Until </b></font>KeyPressed<font color="#000080">;
  </font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
  </font>StatusLine<font color="#000080">;
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>PageUp<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  If </b></font>Top <font color="#000080">&gt; </font><font color="#800000">22 </font><font color="#FF0000"><b>Then Begin 
    </b></font>Top <font color="#000080">:= </font>Top <font color="#000080">- </font><font color="#800000">22</font><font color="#000080">; </font>I <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">22</font><font color="#000080">; </font><font color="#FF0000"><b>End 
  Else Begin 
    </b></font>I <font color="#000080">:= </font>I <font color="#000080">- </font>Top <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; </font>Top <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>PageDown<font color="#000080">; 
</font><font color="#FF0000"><b>begin 
  If </b></font>Top <font color="#000080">&lt;= (</font>NLines <font color="#000080">- </font><font color="#800000">44</font><font color="#000080">) </font><font color="#FF0000"><b>Then 
   Begin 
    </b></font>Top <font color="#000080">:= </font>Top <font color="#000080">+ </font><font color="#800000">22</font><font color="#000080">; 
    </font>I <font color="#000080">:= </font>I <font color="#000080">+ </font><font color="#800000">22</font><font color="#000080">; 
   </font><font color="#FF0000"><b>End 
  Else If </b></font>NLines <font color="#000080">&gt; </font><font color="#800000">22 </font><font color="#FF0000"><b>Then 
   Begin 
    </b></font>I <font color="#000080">:= </font>I <font color="#000080">- </font>Top <font color="#000080">+ </font>NLines <font color="#000080">- </font><font color="#800000">22</font><font color="#000080">; 
    </font>Top <font color="#000080">:= </font>NLines <font color="#000080">- </font><font color="#800000">22</font><font color="#000080">; 
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>Cursor<font color="#000080">;       </font><font color="#008000"><i>{ make sure the cursor is visible on the screen } 
</i></font><font color="#FF0000"><b>Var </b></font>ii<font color="#000080">,</font>jj<font color="#000080">,</font>chgd <font color="#000080">: </font>Word<font color="#000080">; 
    </font>Shifted    <font color="#000080">: </font>Boolean<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>Shifted <font color="#000080">:= </font>False<font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
    Begin 
      </b></font>I  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
      </font>Ln <font color="#000080">:= </font>EndLn<font color="#000080">^.</font>Next<font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&gt; </font>NLines <font color="#FF0000"><b>Then 
    Begin 
      </b></font>I  <font color="#000080">:= </font>NLines<font color="#000080">; 
      </font>Ln <font color="#000080">:= </font>EndLn<font color="#000080">^.</font>Last<font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
    </b></font>J <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">&gt; </font>MaxWidth <font color="#FF0000"><b>Then 
    </b></font>J <font color="#000080">:= </font>MaxWidth<font color="#000080">; 
  </font>Len <font color="#000080">:= </font>Ord<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]); 
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>J <font color="#000080">&gt; </font>Offset <font color="#000080">+ </font><font color="#800000">77 </font><font color="#000080">) </font><font color="#FF0000"><b>Then 
    Begin 
      </b></font>Offset  <font color="#000080">:= </font><font color="#800000">10 </font><font color="#000080">* ( </font>J <font color="#FF0000"><b>Div </b></font><font color="#800000">10 </font><font color="#000080">) - </font><font color="#800000">59</font><font color="#000080">; 
      </font>Shifted <font color="#000080">:= </font>True<font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">&lt; </font>Offset <font color="#FF0000"><b>Then 
    Begin 
      </b></font>Offset  <font color="#000080">:= </font><font color="#800000">10 </font><font color="#000080">* ( ( </font>J <font color="#000080">- </font><font color="#800000">10 </font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">10 </font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">; 
      </font>Shifted <font color="#000080">:= </font>True<font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&lt; </font>Top <font color="#FF0000"><b>Then 
    Begin 
      </b></font>Top     <font color="#000080">:= </font>I<font color="#000080">; 
      </font>Shifted <font color="#000080">:= </font>True<font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&gt; </font>Top <font color="#000080">+ </font><font color="#800000">22 </font><font color="#FF0000"><b>Then 
    Begin 
      </b></font>Top     <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">22</font><font color="#000080">; 
      </font>Shifted <font color="#000080">:= </font>True<font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>Shifted <font color="#FF0000"><b>Then 
    Begin 
      </b></font>RulerLine<font color="#000080">; 
      </font>Screen<font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font>Str<font color="#000080">(</font>i<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font>ii<font color="#000080">); 
  </font>Str<font color="#000080">(</font>j<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font>jj<font color="#000080">); 
  </font><font color="#FF0000"><b>If </b></font>Changed <font color="#FF0000"><b>Then </b></font>Chgd <font color="#000080">:= </font><font color="#800000">' * ' 
    </font><font color="#FF0000"><b>Else </b></font>Chgd <font color="#000080">:= </font><font color="#800000">'   '</font><font color="#000080">; 
  </font>FastWriteV<font color="#000080">(</font>ii<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font>Attr<font color="#000080">);    </font>GetVideoMode<font color="#000080">; 
  </font>FastWriteV<font color="#000080">(</font>jj<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>Attr<font color="#000080">);   </font>GetVideoMode<font color="#000080">; 
  </font>FastWriteV<font color="#000080">(</font>Chgd<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">76</font><font color="#000080">,</font>Attr<font color="#000080">); </font>GetVideoMode<font color="#000080">; 
  </font>GotoXY<font color="#000080">( </font>J <font color="#000080">- </font>Offset <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>i <font color="#000080">- </font>top <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">); 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>CursorLeft<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>J <font color="#000080">:= </font>J <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
    Begin 
      </b></font>I <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
      </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
        Begin 
          </b></font>I  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
          </font>J  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
          </font>Ln <font color="#000080">:= </font>EndLn<font color="#000080">^.</font>Next <font color="#000080">; 
          </font>Exit<font color="#000080">; 
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
      </font>J <font color="#000080">:= </font>Length<font color="#000080">(</font>Ln<font color="#000080">^.</font>Last<font color="#000080">^.</font>Data<font color="#000080">) + </font><font color="#800000">1 </font><font color="#000080">; 
      </font>Ln <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Last <font color="#000080">; 
   </font><font color="#FF0000"><b>End 
End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>CursorRight<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>j <font color="#000080">:= </font>j <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
  </font><font color="#FF0000"><b>if </b></font>j <font color="#000080">&gt; </font>MaxWidth <font color="#FF0000"><b>then 
    Begin 
      </b></font>i <font color="#000080">:= </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
      </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&gt; </font>NLines <font color="#FF0000"><b>then 
        Begin 
          </b></font>I  <font color="#000080">:= </font>NLines<font color="#000080">; 
          </font>Ln <font color="#000080">:= </font>EndLn<font color="#000080">^.</font>Last <font color="#000080">; 
        </font><font color="#FF0000"><b>End 
      Else If </b></font>I <font color="#000080">&lt; </font>NLines <font color="#FF0000"><b>Then 
        </b></font>Ln <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next <font color="#000080">; 
      </font>J <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>ParaForm<font color="#000080">;  </font><font color="#008000"><i>{ set margins, wordwrap on/off } 
</i></font><font color="#FF0000"><b>Begin 
  </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>ClrEol<font color="#000080">; 
  </font>Write<font color="#000080">(</font><font color="#800000">'WordWrap? '</font><font color="#000080">); 
  </font><font color="#FF0000"><b>If </b></font>YN <font color="#FF0000"><b>Then 
    </b></font>Wrap <font color="#000080">:= </font>True 
  <font color="#FF0000"><b>Else 
    Begin 
      </b></font>Wrap  <font color="#000080">:= </font>False<font color="#000080">; 
      </font>LeftM <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
      </font>LWord <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>Wrap <font color="#FF0000"><b>Then 
    Begin 
      </b></font>GotoXY<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>Write<font color="#000080">(</font><font color="#800000">'Left margin: '</font><font color="#000080">); 
      </font>ReadLn<font color="#000080">(</font>LeftM<font color="#000080">); 
      </font>LWord <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; 
      </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>LWord<font color="#000080">) &lt; </font>LeftM <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>Do 
        </b></font>LWord <font color="#000080">:= </font>LWord <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">; 
      </font>RulerLine<font color="#000080">; 
      </font><font color="#FF0000"><b>Repeat 
        </b></font>GotoXY<font color="#000080">(</font><font color="#800000">35</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>Write<font color="#000080">(</font><font color="#800000">'Right margin: '</font><font color="#000080">); 
        </font>ReadLn<font color="#000080">(</font>RtMrg<font color="#000080">); 
      </font><font color="#FF0000"><b>Until </b></font>RtMrg <font color="#000080">&gt; </font>LeftM <font color="#000080">+ </font><font color="#800000">24</font><font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font>ClrScr<font color="#000080">; 
  </font>StatusLine<font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;    </font><font color="#008000"><i>{ ParaForm } 
 
</i></font><font color="#FF0000"><b>Procedure </b></font>InsertLn<font color="#000080">(</font>contents<font color="#000080">:</font>line<font color="#000080">);  </font><font color="#008000"><i>{insert after current line} 
</i></font><font color="#FF0000"><b>Begin 
  </b></font>New<font color="#000080">(</font>NextLn<font color="#000080">); 
  </font>NextLn<font color="#000080">^.</font>Data <font color="#000080">:= </font>Contents<font color="#000080">; 
  </font>NextLn<font color="#000080">^.</font>Last <font color="#000080">:= </font>Ln<font color="#000080">; 
  </font>NextLn<font color="#000080">^.</font>Next <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next<font color="#000080">; 
  </font>Ln<font color="#000080">^.</font>Next<font color="#000080">^.</font>Last <font color="#000080">:= </font>NextLn<font color="#000080">; 
  </font>Ln<font color="#000080">^.</font>Next <font color="#000080">:= </font>NextLn<font color="#000080">; 
  </font>NLines   <font color="#000080">:= </font>NLines <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>CutLine<font color="#000080">;    </font><font color="#008000"><i>{ start new line after &lt;CR&gt; } 
</i></font><font color="#FF0000"><b>Var 
  </b></font>More <font color="#000080">: </font>Line<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>More <font color="#000080">:= </font>Copy<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font>J<font color="#000080">,</font>Len<font color="#000080">-</font>J<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">); 
  </font>Delete<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font>J<font color="#000080">,</font>Len<font color="#000080">-</font>J<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">); 
  </font>InsertLn<font color="#000080">(</font>LWord <font color="#000080">+ </font>More<font color="#000080">); 
  </font>i <font color="#000080">:= </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
  </font>j <font color="#000080">:= </font>LeftM<font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>WordWrap<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>N <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; 
  </font><font color="#FF0000"><b>Repeat 
    </b></font>J <font color="#000080">:= </font>J <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
    </font>N <font color="#000080">:= </font>N <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">[</font>J<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>J <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">); 
  </font>J   <font color="#000080">:= </font>J <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
  </font>Len <font color="#000080">:= </font>Len <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
  </font>CutLine<font color="#000080">; 
  </font>J <font color="#000080">:= </font>LeftM <font color="#000080">+ </font>N <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">; 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>StackLine<font color="#000080">;   </font><font color="#008000"><i>{ put current line on top of previous line } 
</i></font><font color="#FF0000"><b>begin 
  </b></font>j <font color="#000080">:= </font>length<font color="#000080">(</font>ln<font color="#000080">^.</font>last<font color="#000080">^.</font>data<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">; 
  </font>ln<font color="#000080">^.</font>last<font color="#000080">^.</font>data <font color="#000080">:= </font>ln<font color="#000080">^.</font>last<font color="#000080">^.</font>data <font color="#000080">+ </font>ln<font color="#000080">^.</font>data<font color="#000080">; 
  </font>ln<font color="#000080">^.</font>last<font color="#000080">^.</font>next <font color="#000080">:= </font>ln<font color="#000080">^.</font>next<font color="#000080">;     </font><font color="#008000"><i>{ isolate current line } 
  </i></font>ln<font color="#000080">^.</font>next<font color="#000080">^.</font>last <font color="#000080">:= </font>ln<font color="#000080">^.</font>last<font color="#000080">; 
  </font>Dispose<font color="#000080">(</font>Ln<font color="#000080">);                    </font><font color="#008000"><i>{ and zap it} 
  </i></font>I <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
  </font>NLines <font color="#000080">:= </font>NLines <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>DeleteLine<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>Ln<font color="#000080">^.</font>Last<font color="#000080">^.</font>Next <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next<font color="#000080">;     </font><font color="#008000"><i>{ isolate current line } 
  </i></font>Ln<font color="#000080">^.</font>Next<font color="#000080">^.</font>Last <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Last<font color="#000080">; 
  </font>Dispose<font color="#000080">(</font>Ln<font color="#000080">);                    </font><font color="#008000"><i>{ and zap it} 
  </i></font>J  <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;  </font>I <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
  </font>NLines  <font color="#000080">:= </font>NLines <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
  </font>Changed <font color="#000080">:= </font>True<font color="#000080">; 
  </font>StatusLine<font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>DeleteEOL<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  If </b></font>J <font color="#000080">&lt; </font>MaxWidth <font color="#FF0000"><b>Then 
    Begin 
      </b></font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font>Copy <font color="#000080">( </font>Ln<font color="#000080">^.</font>Data<font color="#000080">, </font><font color="#800000">1 </font><font color="#000080">, </font>J <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">) ; 
      </font>Changed <font color="#000080">:= </font>True<font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
    </b></font>J <font color="#000080">:= </font>J <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
  </font>StatusLine <font color="#000080">; 
  </font>Screen <font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>DeleteBOL<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  If </b></font>J <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
    Begin 
      </b></font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font>Copy <font color="#000080">( </font>BlankLine<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>J <font color="#000080">) + </font>Copy <font color="#000080">( </font>Ln<font color="#000080">^.</font>Data<font color="#000080">, </font>J <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">, </font>MaxWidth <font color="#000080">) ; 
      </font>Changed <font color="#000080">:= </font>True<font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">&lt; </font>MaxWidth <font color="#FF0000"><b>Then 
    </b></font>J <font color="#000080">:= </font>J <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
  </font>StatusLine <font color="#000080">; 
  </font>Screen <font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>DeleteWord<font color="#000080">; 
</font><font color="#FF0000"><b>Var 
  </b></font>EndW <font color="#000080">: </font>Byte<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  While </b></font><font color="#000080">(( </font>Copy<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font>J<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) &lt;&gt; </font><font color="#800000">' ' </font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">( </font>J <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#000080">)) </font><font color="#FF0000"><b>Do 
    </b></font>J <font color="#000080">:= </font>J <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then 
    </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">; 
  </font>EndW <font color="#000080">:= </font>J <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(( </font>Copy<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font>EndW<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) &lt;&gt; </font><font color="#800000">' ' </font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">( </font>EndW <font color="#000080">&lt; </font>MaxWidth <font color="#000080">)) </font><font color="#FF0000"><b>Do 
    </b></font>EndW <font color="#000080">:= </font>EndW <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
    </b></font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font>Copy <font color="#000080">( </font>Ln<font color="#000080">^.</font>Data <font color="#000080">, </font>EndW <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>MaxWidth <font color="#000080">) 
  </font><font color="#FF0000"><b>Else 
    </b></font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font>Copy <font color="#000080">( </font>Ln<font color="#000080">^.</font>Data<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>J <font color="#000080">) + </font>Copy <font color="#000080">( </font>Ln<font color="#000080">^.</font>Data <font color="#000080">, </font>EndW <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>MaxWidth <font color="#000080">) ; 
  </font>Changed <font color="#000080">:= </font>True <font color="#000080">; 
  </font>StatusLine <font color="#000080">; 
  </font>Screen <font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>PrevWord<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
</b></font><font color="#008000"><i>(* if i am in a word then skip to the space *) 
  </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#000080">((</font>Ln<font color="#000080">^.</font>Data<font color="#000080">[</font>j<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">( </font>j <font color="#000080">&gt;= </font>Length<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">) ))) </font><font color="#FF0000"><b>And 
         </b></font><font color="#000080">(( </font>i <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">( </font>j <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#000080">)) </font><font color="#FF0000"><b>Do 
      </b></font>CursorLeft<font color="#000080">; 
</font><font color="#008000"><i>(* find end of previous word *) 
  </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>Ln<font color="#000080">^.</font>Data<font color="#000080">[</font>j<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">( </font>j <font color="#000080">&gt;= </font>Length<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">) )) </font><font color="#FF0000"><b>And 
         </b></font><font color="#000080">(( </font>i <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">( </font>j <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#000080">)) </font><font color="#FF0000"><b>Do 
      </b></font>CursorLeft<font color="#000080">; 
</font><font color="#008000"><i>(* find start of previous word *) 
  </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#000080">((</font>Ln<font color="#000080">^.</font>Data<font color="#000080">[</font>j<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">( </font>j <font color="#000080">&gt;= </font>Length<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">) ))) </font><font color="#FF0000"><b>And 
         </b></font><font color="#000080">(( </font>i <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">( </font>j <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#000080">)) </font><font color="#FF0000"><b>do 
      </b></font>CursorLeft<font color="#000080">; 
   </font>CursorRight<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>NextWord<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
</b></font><font color="#008000"><i>(* if i am in a word, then move to the whitespace *) 
  </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font><font color="#000080">((</font>Ln<font color="#000080">^.</font>Data<font color="#000080">[</font>j<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">( </font>j <font color="#000080">&gt;= </font>length<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">)))) </font><font color="#FF0000"><b>and 
        </b></font><font color="#000080">( </font>i <font color="#000080">&lt; </font>NLines <font color="#000080">) </font><font color="#FF0000"><b>do 
    </b></font>CursorRight<font color="#000080">; 
</font><font color="#008000"><i>(* skip over the space to the other word *) 
  </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>Ln<font color="#000080">^.</font>Data<font color="#000080">[</font>j<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">( </font>j <font color="#000080">&gt;= </font>Length<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">))) </font><font color="#FF0000"><b>and 
         </b></font><font color="#000080">( </font>i <font color="#000080">&lt; </font>NLines <font color="#000080">) </font><font color="#FF0000"><b>do 
    </b></font>CursorRight<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>Tab<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  If </b></font>J <font color="#000080">&lt; </font>MaxWidth <font color="#FF0000"><b>Then 
    Begin 
      Repeat 
        </b></font>J <font color="#000080">:= </font>J <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
      </font><font color="#FF0000"><b>Until </b></font><font color="#000080">( </font>TabSet <font color="#000080">[</font>J<font color="#000080">]= </font>True <font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">( </font>J <font color="#000080">= </font>MaxWidth <font color="#000080">); 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>BackTab<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  If </b></font>J <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
    Begin 
      Repeat 
         </b></font>J <font color="#000080">:= </font>J <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
      </font><font color="#FF0000"><b>Until </b></font><font color="#000080">( </font>TabSet <font color="#000080">[</font>J<font color="#000080">]= </font>True <font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">( </font>J <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">); 
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>Search<font color="#000080">; 
</font><font color="#FF0000"><b>var 
  </b></font>Temp              <font color="#000080">: </font>ScreenLine<font color="#000080">; 
  </font>Pointer<font color="#000080">, </font>Position <font color="#000080">: </font>Integer<font color="#000080">; 
  </font>LocPtr <font color="#000080">, </font>Location <font color="#000080">: </font>Integer<font color="#000080">; 
  </font>TmpPtr            <font color="#000080">: </font>LPtr<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
   </b></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">80</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">); 
   </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">); </font>ClrEol<font color="#000080">; 
   </font>Write<font color="#000080">(</font><font color="#800000">'Search:     Enter string: &lt;'</font><font color="#000080">,</font>SearchString<font color="#000080">,</font><font color="#800000">'&gt; '</font><font color="#000080">); 
   </font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; 
   </font>ReadLn<font color="#000080">(</font>Temp<font color="#000080">); 
   </font><font color="#FF0000"><b>If </b></font>Temp <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then 
      </b></font>SearchString <font color="#000080">:= </font>Temp<font color="#000080">; 
   </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">( </font>SearchString <font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then 
     Begin 
       </b></font>StatusLine<font color="#000080">; 
       </font>Screen<font color="#000080">; 
       </font>Exit<font color="#000080">; 
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
   </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>ClrEol<font color="#000080">; 
   </font>Write<font color="#000080">(</font><font color="#800000">'Searching...'</font><font color="#000080">); 
   </font>NextWord<font color="#000080">; 
   </font>TmpPtr <font color="#000080">:= </font>Ln<font color="#000080">; 
   </font>LocPtr <font color="#000080">:= </font>J<font color="#000080">; 
   </font><font color="#FF0000"><b>For </b></font>Location <font color="#000080">:= </font>I <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>NLines <font color="#FF0000"><b>Do 
     begin 
       </b></font><font color="#008000"><i>(* look for matches on this line *) 
       </i></font>Pointer <font color="#000080">:= </font>Pos <font color="#000080">(</font>SearchString<font color="#000080">, </font>Copy<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font>LocPtr<font color="#000080">,</font>MaxWidth<font color="#000080">)); 
       </font><font color="#008000"><i>(* if there was a match then get ready to print it *) 
       </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Pointer <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then 
         Begin 
           </b></font>I <font color="#000080">:= </font>Location <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">; 
           </font>J <font color="#000080">:= </font>Pointer<font color="#000080">; 
           </font>StatusLine<font color="#000080">; 
           </font>Screen<font color="#000080">; 
           </font>Exit<font color="#000080">; 
         </font><font color="#FF0000"><b>End 
       Else If </b></font>Location <font color="#000080">&lt;&gt; </font>NLines <font color="#FF0000"><b>Then 
         Begin 
           </b></font>Ln <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next <font color="#000080">; 
           </font>LocPtr <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">; 
         </font><font color="#FF0000"><b>End 
   End</b></font><font color="#000080">; 
   </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">80</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">); 
   </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">); </font>ClrEol<font color="#000080">; 
   </font>Write<font color="#000080">(</font><font color="#800000">'Search string not found.  Press any key to exit...'</font><font color="#000080">); 
   </font><font color="#FF0000"><b>Repeat 
   Until </b></font>KeyPressed<font color="#000080">; 
   </font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">; 
   </font>Ln <font color="#000080">:= </font>TmpPtr <font color="#000080">; 
   </font>StatusLine<font color="#000080">; 
   </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>Replace<font color="#000080">; 
</font><font color="#FF0000"><b>Var 
  </b></font>Temp               <font color="#000080">: </font>ScreenLine<font color="#000080">; 
  </font>Pointer <font color="#000080">, </font>Position <font color="#000080">: </font>Integer<font color="#000080">; 
  </font>Location<font color="#000080">, </font>Len      <font color="#000080">: </font>Integer<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">80</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">); 
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">); </font>ClrEol<font color="#000080">; 
  </font>Write<font color="#000080">(</font><font color="#800000">'Replace:     Enter search string: &lt;'</font><font color="#000080">,</font>SearchString<font color="#000080">,</font><font color="#800000">'&gt; '</font><font color="#000080">); 
  </font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; 
  </font>ReadLn<font color="#000080">(</font>Temp<font color="#000080">); 
  </font><font color="#FF0000"><b>If </b></font>Temp <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then 
    </b></font>SearchString <font color="#000080">:= </font>Temp<font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>SearchString<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then 
    Begin 
      </b></font>StatusLine<font color="#000080">; 
      </font>Screen<font color="#000080">; 
      </font>Exit<font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">); </font>ClrEol<font color="#000080">; 
  </font>Write<font color="#000080">(</font><font color="#800000">'Replace:     Enter replacement string: &lt;'</font><font color="#000080">,</font>replacement<font color="#000080">,</font><font color="#800000">'&gt; '</font><font color="#000080">); 
  </font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; 
  </font>ReadLn<font color="#000080">(</font>Temp<font color="#000080">); 
  </font><font color="#FF0000"><b>if </b></font>Temp <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then 
    </b></font>Replacement <font color="#000080">:= </font>Temp<font color="#000080">; 
  </font>Len <font color="#000080">:= </font>Length <font color="#000080">(</font>Replacement<font color="#000080">); 
  </font>Ln  <font color="#000080">:= </font>EndLn<font color="#000080">^.</font>Next <font color="#000080">; 
  </font>I   <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;  </font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">; 
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);  </font>ClrEol<font color="#000080">; 
  </font>Write<font color="#000080">(</font><font color="#800000">'Searching...'</font><font color="#000080">); 
  </font><font color="#FF0000"><b>For </b></font>Location <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NLines <font color="#FF0000"><b>Do 
    Begin 
      </b></font><font color="#008000"><i>(* look for matches on this line *) 
      </i></font>Position <font color="#000080">:= </font>Pos <font color="#000080">(</font>SearchString<font color="#000080">, </font>Ln<font color="#000080">^.</font>Data <font color="#000080">); 
      </font><font color="#008000"><i>(* if there was a match then get ready to print it *) 
      </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Position <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Do 
        Begin 
          </b></font>I   <font color="#000080">:= </font>Location <font color="#000080">; 
          </font>J   <font color="#000080">:= </font>Position <font color="#000080">; 
          </font><font color="#FF0000"><b>If </b></font>Location <font color="#000080">&gt; </font><font color="#800000">8 </font><font color="#FF0000"><b>Then 
            </b></font>Top <font color="#000080">:= </font>Location <font color="#000080">- </font><font color="#800000">8 
          </font><font color="#FF0000"><b>Else 
            </b></font>Top <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">; 
          </font>Screen <font color="#000080">; 
          </font>TextColor<font color="#000080">( </font>Back <font color="#000080">); 
          </font>TextBackGround<font color="#000080">( </font>Fore <font color="#000080">); 
          </font>GotoXY<font color="#000080">( </font>J <font color="#000080">- </font>Offset <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>I <font color="#000080">- </font>Top <font color="#000080">+ </font><font color="#800000">3 </font><font color="#000080">); 
          </font>Write <font color="#000080">( </font>SearchString <font color="#000080">); 
          </font>TextColor<font color="#000080">( </font>Fore <font color="#000080">); 
          </font>TextBackGround<font color="#000080">( </font>Back <font color="#000080">); 
          </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">); </font>ClrEol<font color="#000080">; 
          </font>Write<font color="#000080">(</font><font color="#800000">'Replace (Y/N/ESC)? '</font><font color="#000080">); 
          </font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">; 
          </font><font color="#FF0000"><b>If </b></font>Ord <font color="#000080">(</font>Ch<font color="#000080">)= </font><font color="#800000">27 </font><font color="#FF0000"><b>Then 
            Begin 
              </b></font>I  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
              </font>J  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
              </font>Ln <font color="#000080">:= </font>EndLn<font color="#000080">^.</font>Next <font color="#000080">; 
              </font>StatusLine<font color="#000080">; 
              </font>Screen<font color="#000080">; 
              </font>Exit<font color="#000080">; 
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
          </font><font color="#FF0000"><b>If </b></font>Ch <font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">'y'</font><font color="#000080">,</font><font color="#800000">'Y'</font><font color="#000080">] </font><font color="#FF0000"><b>Then 
            Begin 
              </b></font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font>Copy <font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Position <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) + </font>Replacement <font color="#000080">+ 
                              </font>Copy <font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">, </font>Position <font color="#000080">+ </font>Length <font color="#000080">(</font>SearchString<font color="#000080">), </font>MaxWidth<font color="#000080">); 
              </font>Position <font color="#000080">:= </font>Pos <font color="#000080">(</font>SearchString<font color="#000080">, </font>Copy <font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">, </font>Position <font color="#000080">+ </font>Len <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">,</font>MaxWidth<font color="#000080">)) ; 
            </font><font color="#FF0000"><b>End 
          Else 
            </b></font>Position <font color="#000080">:= </font>Pos <font color="#000080">(</font>SearchString<font color="#000080">, </font>Copy <font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">, </font>Position <font color="#000080">+ </font>Length<font color="#000080">(</font>SearchString<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">,</font>MaxWidth<font color="#000080">)) ; 
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
      </font>Ln <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next <font color="#000080">; 
      </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);  </font>ClrEol<font color="#000080">; 
      </font>Write<font color="#000080">(</font><font color="#800000">'Searching...'</font><font color="#000080">); 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">80</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">); 
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">); </font>ClrEol<font color="#000080">; 
  </font>Write<font color="#000080">(</font><font color="#800000">'End of replace.  Press any key to exit...'</font><font color="#000080">); 
  </font><font color="#FF0000"><b>Repeat 
  Until </b></font>KeyPressed<font color="#000080">; 
  </font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">; 
  </font>Ln <font color="#000080">:= </font>EndLn<font color="#000080">^.</font>Next <font color="#000080">; 
  </font>I  <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">; 
  </font>J  <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">; 
  </font>StatusLine<font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>ClearMarks <font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>IBeg <font color="#000080">:= </font><font color="#800000">0 </font><font color="#000080">; 
  </font>IEnd <font color="#000080">:= </font><font color="#800000">0 </font><font color="#000080">; 
  </font>BlockBeg <font color="#000080">:= </font><font color="#FF0000"><b>Nil </b></font><font color="#000080">; 
  </font>BlockEnd <font color="#000080">:= </font><font color="#FF0000"><b>Nil </b></font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>InsertMark<font color="#000080">( </font>Mark <font color="#000080">: </font>Char <font color="#000080">); 
</font><font color="#FF0000"><b>Begin 
  If </b></font>Mark <font color="#000080">= </font><font color="#800000">'B' </font><font color="#FF0000"><b>Then 
    Begin 
      If </b></font>BlockBeg <font color="#000080">= </font><font color="#FF0000"><b>Nil Then 
        Begin 
          </b></font>BlockBeg <font color="#000080">:= </font>Ln <font color="#000080">; 
          </font>IBeg     <font color="#000080">:= </font>I  <font color="#000080">; 
        </font><font color="#FF0000"><b>End 
      Else  </b></font><font color="#008000"><i>{ BlockBeg Already Defined } 
        </i></font>Write<font color="#000080">(</font><font color="#800000">#7</font><font color="#000080">); 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>Mark <font color="#000080">= </font><font color="#800000">'E' </font><font color="#FF0000"><b>Then 
    Begin 
      If </b></font>BlockEnd <font color="#000080">= </font><font color="#FF0000"><b>Nil Then 
        Begin 
          </b></font>BlockEnd <font color="#000080">:= </font>Ln <font color="#000080">; 
          </font>IEnd     <font color="#000080">:= </font>I  <font color="#000080">; 
        </font><font color="#FF0000"><b>End 
      Else  </b></font><font color="#008000"><i>{ BlockEnd Already Defined } 
        </i></font>Write<font color="#000080">(</font><font color="#800000">#7</font><font color="#000080">); 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>GotoBlock <font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  If </b></font>BlockBeg <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>Nil Then 
    Begin 
      </b></font>Ln  <font color="#000080">:= </font>BlockBeg <font color="#000080">; 
      </font>I   <font color="#000080">:= </font>IBeg<font color="#000080">; 
      </font>J   <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">; 
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>I <font color="#000080">&gt;= </font><font color="#800000">12 </font><font color="#000080">) </font><font color="#FF0000"><b>Then 
        </b></font>Top <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">8</font><font color="#000080">; 
      </font>StatusLine <font color="#000080">; 
      </font>Screen <font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>DeleteBlock<font color="#000080">; 
</font><font color="#FF0000"><b>Var 
  </b></font>TPtr   <font color="#000080">: </font>LPtr<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  If </b></font>IEnd <font color="#000080">&lt; </font>IBeg <font color="#FF0000"><b>Then 
    </b></font>Exit<font color="#000080">; 
  </font>Ln <font color="#000080">:= </font>BlockEnd <font color="#000080">; 
  </font>I  <font color="#000080">:= </font>IEnd <font color="#000080">; 
  </font><font color="#FF0000"><b>Repeat 
    </b></font>TPtr           <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Last<font color="#000080">;     </font><font color="#008000"><i>{ save location of previous line } 
    </i></font>Ln<font color="#000080">^.</font>Last<font color="#000080">^.</font>Next <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next<font color="#000080">;     </font><font color="#008000"><i>{ isolate current line } 
    </i></font>Ln<font color="#000080">^.</font>Next<font color="#000080">^.</font>Last <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Last<font color="#000080">; 
    </font>Dispose<font color="#000080">(</font>Ln<font color="#000080">);                    </font><font color="#008000"><i>{ and zap it} 
    </i></font>J  <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;  </font>I <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
    </font>NLines  <font color="#000080">:= </font>NLines <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
    </font>Ln      <font color="#000080">:= </font>TPtr<font color="#000080">; 
  </font><font color="#FF0000"><b>Until </b></font>Ln <font color="#000080">= </font>BlockBeg<font color="#000080">^.</font>Last <font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&gt;= </font><font color="#800000">12 </font><font color="#FF0000"><b>Then 
    </b></font>Top <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">8 
  </font><font color="#FF0000"><b>Else 
    </b></font>Top <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">; 
  </font>Changed <font color="#000080">:= </font>True<font color="#000080">; 
  </font>ClearMarks<font color="#000080">; 
  </font>StatusLine<font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>CopyBlock<font color="#000080">; 
</font><font color="#FF0000"><b>var 
  </b></font>TPtr <font color="#000080">: </font>LPtr <font color="#000080">; 
  </font>Size <font color="#000080">: </font>Integer<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  If </b></font>IEnd <font color="#000080">&lt; </font>IBeg <font color="#FF0000"><b>then 
    </b></font>Exit<font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>IBeg <font color="#000080">&lt; </font>I<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>I <font color="#000080">&lt;= </font>IEnd<font color="#000080">) </font><font color="#FF0000"><b>Then 
    </b></font>Exit<font color="#000080">; 
  </font>Size <font color="#000080">:= </font>IEnd <font color="#000080">- </font>IBeg <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;  </font><font color="#008000"><i>{ exclude markers } 
  </i></font><font color="#FF0000"><b>If </b></font>Size <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then 
    </b></font>Exit<font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>NLines <font color="#000080">+ </font>Size <font color="#000080">&lt;= </font>MaxLines <font color="#FF0000"><b>Then 
    Begin 
      Repeat 
          </b></font>InsertLn <font color="#000080">(</font>BlockEnd<font color="#000080">^.</font>Data<font color="#000080">) ; 
          </font>BlockEnd <font color="#000080">:= </font>BlockEnd<font color="#000080">^.</font>Last <font color="#000080">; 
          </font>NLines   <font color="#000080">:= </font>NLines <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">; 
      </font><font color="#FF0000"><b>Until </b></font>BlockEnd <font color="#000080">= </font>BlockBeg<font color="#000080">^.</font>Last <font color="#000080">; 
    </font><font color="#FF0000"><b>End 
  Else 
    </b></font>Write<font color="#000080">(</font><font color="#800000">#7</font><font color="#000080">); 
  </font>Changed <font color="#000080">:= </font>True<font color="#000080">; 
  </font>ClearMarks<font color="#000080">; 
  </font>StatusLine<font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>MoveBlock<font color="#000080">; 
</font><font color="#FF0000"><b>Var 
  </b></font>Size <font color="#000080">: </font>Integer<font color="#000080">; 
  </font>TPtr <font color="#000080">: </font>LPtr<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  If </b></font>IEnd <font color="#000080">&lt; </font>IBeg <font color="#FF0000"><b>Then 
    </b></font>Exit<font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>IBeg <font color="#000080">&lt;= </font>I<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>I <font color="#000080">&lt;= </font>IEnd <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then 
    </b></font>Exit<font color="#000080">; 
  </font>Size <font color="#000080">:= </font>IEnd <font color="#000080">- </font>IBeg <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>NLines <font color="#000080">+ </font>Size <font color="#000080">&lt;= </font>MaxLines <font color="#FF0000"><b>Then 
    Begin 
      </b></font>TPtr <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next <font color="#000080">; 
      </font>BlockBeg<font color="#000080">^.</font>Last<font color="#000080">^.</font>Next <font color="#000080">:= </font>BlockEnd<font color="#000080">^.</font>Next <font color="#000080">; 
      </font>BlockEnd<font color="#000080">^.</font>Next<font color="#000080">^.</font>Last <font color="#000080">:= </font>BlockBeg<font color="#000080">^.</font>Last <font color="#000080">; 
      </font>Ln<font color="#000080">^.</font>Next   <font color="#000080">:= </font>BlockBeg <font color="#000080">; 
      </font>TPtr<font color="#000080">^.</font>Last <font color="#000080">:= </font>BlockEnd <font color="#000080">; 
      </font>BlockBeg<font color="#000080">^.</font>Last <font color="#000080">:= </font>Ln <font color="#000080">; 
      </font>BlockEnd<font color="#000080">^.</font>Next <font color="#000080">:= </font>TPtr <font color="#000080">; 
    </font><font color="#FF0000"><b>End 
  Else 
    </b></font>Write<font color="#000080">(</font><font color="#800000">#7</font><font color="#000080">); 
  </font>Changed <font color="#000080">:= </font>True<font color="#000080">; 
  </font>ClearMarks<font color="#000080">; 
  </font>StatusLine<font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>WriteBlock <font color="#000080">; 
</font><font color="#FF0000"><b>Var 
  </b></font>TPtr <font color="#000080">: </font>LPtr <font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  If </b></font><font color="#000080">((</font>BlockBeg <font color="#000080">= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>BlockEnd <font color="#000080">= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)) </font><font color="#FF0000"><b>Then 
    </b></font>Exit <font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>IBeg <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">&lt; </font>IEnd <font color="#FF0000"><b>Then 
    Begin 
      </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">45 </font><font color="#FF0000"><b>Do </b></font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">); 
      </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>Write<font color="#000080">(</font><font color="#800000">'Write Block To Disk ? '</font><font color="#000080">); 
      </font><font color="#FF0000"><b>If </b></font>YN <font color="#FF0000"><b>Then 
        Begin 
          </b></font>Write<font color="#000080">(</font><font color="#800000">'as: '</font><font color="#000080">); </font>ReadLn<font color="#000080">(</font>OutPut<font color="#000080">); 
          </font><font color="#FF0000"><b>If </b></font>OutPut <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>Then 
            </b></font>OutPut <font color="#000080">:= </font>Input<font color="#000080">; 
          </font>Capitalize<font color="#000080">(</font>OutPut<font color="#000080">); 
          </font>GotoXY<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>WriteLn<font color="#000080">(</font><font color="#800000">'    Writing to disk as '</font><font color="#000080">,</font>OutPut<font color="#000080">); 
          </font>Assign<font color="#000080">(</font>WorkFile<font color="#000080">,</font>OutPut<font color="#000080">); 
          </font>ReWrite<font color="#000080">(</font>WorkFile<font color="#000080">); 
          </font>TPtr <font color="#000080">:= </font>BlockBeg<font color="#000080">; 
          </font><font color="#FF0000"><b>Repeat 
            </b></font>WriteLn<font color="#000080">(</font>WorkFile<font color="#000080">,</font>TPtr<font color="#000080">^.</font>Data<font color="#000080">); 
            </font>TPtr <font color="#000080">:= </font>TPtr<font color="#000080">^.</font>Next 
          <font color="#FF0000"><b>Until </b></font>TPtr <font color="#000080">= </font>BlockEnd<font color="#000080">; 
          </font>Close<font color="#000080">(</font>WorkFile<font color="#000080">); 
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
    </font><font color="#FF0000"><b>End 
  Else 
    </b></font>Write<font color="#000080">(</font><font color="#800000">#7</font><font color="#000080">); 
  </font>StatusLine <font color="#000080">; 
  </font>Screen <font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>AddChar<font color="#000080">;       </font><font color="#008000"><i>{ keyboard entry } 
</i></font><font color="#FF0000"><b>begin 
  </b></font>Changed <font color="#000080">:= </font>True<font color="#000080">; 
  </font><font color="#FF0000"><b>While </b></font>J <font color="#000080">&gt; </font>Len <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>Do 
    Begin 
      </b></font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Data <font color="#000080">+ </font><font color="#800000">' ' </font><font color="#000080">; 
      </font>Len <font color="#000080">:= </font>Len <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">= </font>Len <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
    </b></font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Data <font color="#000080">+ </font>Ch 
  <font color="#FF0000"><b>Else If </b></font>InSrt <font color="#FF0000"><b>Then 
    </b></font>Insert<font color="#000080">(</font>Ch<font color="#000080">,</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font>J<font color="#000080">) 
  </font><font color="#FF0000"><b>Else 
    </b></font>Ln<font color="#000080">^.</font>Data<font color="#000080">[</font>J<font color="#000080">] := </font>Ch<font color="#000080">; 
  </font>J <font color="#000080">:= </font>J <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
  </font>WriteLine<font color="#000080">( </font>I <font color="#000080">- </font>Top <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">,</font>Attr<font color="#000080">); 
  </font><font color="#FF0000"><b>If  </b></font><font color="#000080">(</font>J <font color="#000080">&gt; </font>RtMrg <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font>Wrap <font color="#FF0000"><b>Then 
    </b></font>WordWrap<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>Ascii<font color="#000080">; 
</font><font color="#FF0000"><b>Var 
  </b></font>AscNo<font color="#000080">, </font>Repeats<font color="#000080">, </font>R <font color="#000080">: </font>Integer<font color="#000080">; 
  </font>AsciiLine         <font color="#000080">: </font>ScreenLine<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>AsciiLine <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; 
  </font>GotoXY<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">); </font>ClrEol<font color="#000080">; 
  </font>Write<font color="#000080">(</font><font color="#800000">'Enter ASCII code number: --- '</font><font color="#000080">); 
  </font>GotoXY<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); 
  </font>Readln<font color="#000080">(</font>AscNo<font color="#000080">); 
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); 
  </font>Write<font color="#000080">(</font><font color="#800000">'Enter number of repeats: --  '</font><font color="#000080">); 
  </font>GotoXY<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); 
  </font>ReadLn<font color="#000080">(</font>Repeats<font color="#000080">); 
  </font><font color="#FF0000"><b>If Not</b></font><font color="#000080">(</font>Repeats <font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">79</font><font color="#000080">]) </font><font color="#FF0000"><b>Then 
    </b></font>Repeats <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>AscNo <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>AscNo <font color="#000080">&lt; </font><font color="#800000">256</font><font color="#000080">) </font><font color="#FF0000"><b>Then 
    Begin 
      For </b></font>R <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Repeats <font color="#FF0000"><b>Do 
        Begin 
          </b></font>Ch <font color="#000080">:= </font>Chr<font color="#000080">(</font>AscNo<font color="#000080">); 
          </font>AsciiLine <font color="#000080">:= </font>AsciiLine <font color="#000080">+ </font>Ch <font color="#000080">; 
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font><font color="#FF0000"><b>While </b></font>J <font color="#000080">&gt; </font>Length<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">) + </font><font color="#800000">1 </font><font color="#FF0000"><b>Do 
    Begin 
      </b></font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Data <font color="#000080">+ </font><font color="#800000">' ' </font><font color="#000080">; 
      </font>Len <font color="#000080">:= </font>Len <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">; 
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font>J <font color="#000080">:= </font>J <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">= </font>Length<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">) + </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
    </b></font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Data <font color="#000080">+ </font>AsciiLine 
  <font color="#FF0000"><b>Else If </b></font>InSrt <font color="#FF0000"><b>Then 
    </b></font>Insert<font color="#000080">(</font>AsciiLine<font color="#000080">,</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font>J<font color="#000080">) 
  </font><font color="#FF0000"><b>Else 
    </b></font>Ln<font color="#000080">^.</font>Data <font color="#000080">:= </font>Copy<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>J<font color="#000080">) + </font>AsciiLine <font color="#000080">+ </font>Copy<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font>J <font color="#000080">+ </font>Length<font color="#000080">(</font>AsciiLine<font color="#000080">),</font><font color="#800000">128</font><font color="#000080">); 
  </font>Changed    <font color="#000080">:= </font>True<font color="#000080">; 
  </font>StatusLine<font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>Leave<font color="#000080">; 
</font><font color="#FF0000"><b>Var 
  </b></font>Trash <font color="#000080">: </font>Char<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  </b></font>VideoOff<font color="#000080">; 
  </font><font color="#FF0000"><b>Repeat 
  Until </b></font>KeyPressed<font color="#000080">; 
  </font>Trash <font color="#000080">:= </font>ReadKey<font color="#000080">; 
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Trash <font color="#000080">= </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">) </font><font color="#FF0000"><b>Then 
    </b></font>Trash <font color="#000080">:= </font>ReadKey<font color="#000080">; 
  </font>VideoOn<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>Procedure </b></font>Colors<font color="#000080">; 
</font><font color="#FF0000"><b>Begin 
  Case </b></font>Ch <font color="#FF0000"><b>Of 
     </b></font><font color="#800000">#48 </font><font color="#000080">: </font>Back  <font color="#000080">:= (</font>Back <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Mod </b></font><font color="#800000">8</font><font color="#000080">; 
     </font><font color="#800000">#33 </font><font color="#000080">: </font>Fore  <font color="#000080">:= (</font>Fore <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Mod </b></font><font color="#800000">16</font><font color="#000080">; 
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
  </font>Attr <font color="#000080">:= </font>Attribute<font color="#000080">( </font>Fore<font color="#000080">, </font>Back <font color="#000080">); 
  </font>StatusLine<font color="#000080">; 
  </font>Screen<font color="#000080">; 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 

</font><font color="#FF0000"><b>Procedure </b></font>Command<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>Ch <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>Then
    If </b></font>KeyPressed <font color="#FF0000"><b>Then </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">; </font><font color="#008000"><i>{ keypad input }
  </i></font><font color="#FF0000"><b>Case </b></font>Ch <font color="#FF0000"><b>Of
</b></font><font color="#008000"><i>{alt 1}  </i></font><font color="#800000">'x' </font><font color="#000080">: </font><font color="#FF0000"><b>Begin
               </b></font><font color="#008000"><i>{ do something useful here }
               </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{alt A}  </i></font><font color="#800000">#30 </font><font color="#000080">: </font>Ascii<font color="#000080">;
</font><font color="#008000"><i>{alt B, alt F}  </i></font><font color="#800000">#48</font><font color="#000080">,</font><font color="#800000">#33 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>Mode <font color="#000080">&lt;&gt; </font><font color="#800000">7 </font><font color="#FF0000"><b>Then </b></font>Colors<font color="#000080">;
</font><font color="#008000"><i>{alt C}  </i></font><font color="#800000">#46 </font><font color="#000080">: </font>CopyBlock<font color="#000080">;
</font><font color="#008000"><i>{alt D}  </i></font><font color="#800000">#32 </font><font color="#000080">: </font>DeleteBlock<font color="#000080">;
</font><font color="#008000"><i>{alt G}  </i></font><font color="#800000">#34 </font><font color="#000080">: </font>GotoBlock<font color="#000080">;
</font><font color="#008000"><i>{alt H}  </i></font><font color="#800000">#35 </font><font color="#000080">: </font>Help<font color="#000080">;
</font><font color="#008000"><i>{alt K}  </i></font><font color="#800000">#37 </font><font color="#000080">: ;
</font><font color="#008000"><i>{alt L}  </i></font><font color="#800000">#38 </font><font color="#000080">: </font>Leave<font color="#000080">; 
</font><font color="#008000"><i>{alt M}  </i></font><font color="#800000">#50 </font><font color="#000080">: </font>MoveBlock<font color="#000080">; 
</font><font color="#008000"><i>{alt N}  </i></font><font color="#800000">#49 </font><font color="#000080">: </font>ClearMarks<font color="#000080">; 
</font><font color="#008000"><i>{alt S}  </i></font><font color="#800000">#31 </font><font color="#000080">: </font>InsertMark<font color="#000080">(</font><font color="#800000">'B'</font><font color="#000080">); 
</font><font color="#008000"><i>{alt T}  </i></font><font color="#800000">#20 </font><font color="#000080">: </font>InsertMark<font color="#000080">(</font><font color="#800000">'E'</font><font color="#000080">); 
</font><font color="#008000"><i>{alt W}  </i></font><font color="#800000">#17 </font><font color="#000080">: </font>WriteBlock<font color="#000080">; 
</font><font color="#008000"><i>{alt X}  </i></font><font color="#800000">#45 </font><font color="#000080">: </font>Finished <font color="#000080">:= </font>True<font color="#000080">; 
</font><font color="#008000"><i>{tab}     </i></font><font color="#800000">#9 </font><font color="#000080">: </font>Tab<font color="#000080">; 
</font><font color="#008000"><i>{bktab}  </i></font><font color="#800000">#15 </font><font color="#000080">: </font>BackTab<font color="#000080">; 
</font><font color="#008000"><i>{F1}     </i></font><font color="#800000">#59 </font><font color="#000080">: </font>Help<font color="#000080">; 
</font><font color="#008000"><i>{F2}     </i></font><font color="#800000">#60 </font><font color="#000080">: </font>ClearMarks<font color="#000080">; 
</font><font color="#008000"><i>{F3}     </i></font><font color="#800000">#61 </font><font color="#000080">: </font>Finished <font color="#000080">:= </font>True<font color="#000080">; 
</font><font color="#008000"><i>{F4}     </i></font><font color="#800000">#62 </font><font color="#000080">: </font>ParaForm <font color="#000080">; 
</font><font color="#008000"><i>{F5}     </i></font><font color="#800000">#63 </font><font color="#000080">: </font>Search <font color="#000080">; 
</font><font color="#008000"><i>{F6}     </i></font><font color="#800000">#64 </font><font color="#000080">: </font>Replace<font color="#000080">; 
</font><font color="#008000"><i>{F7}     </i></font><font color="#800000">#65 </font><font color="#000080">: </font>PageUp <font color="#000080">; 
</font><font color="#008000"><i>{F8}     </i></font><font color="#800000">#66 </font><font color="#000080">: </font>PageDown<font color="#000080">; 
</font><font color="#008000"><i>{F9}     </i></font><font color="#800000">#67 </font><font color="#000080">: </font>PrevWord<font color="#000080">; 
</font><font color="#008000"><i>{F10}    </i></font><font color="#800000">#68 </font><font color="#000080">: </font>NextWord<font color="#000080">; 
</font><font color="#008000"><i>{home}   </i></font><font color="#800000">#71 </font><font color="#000080">: </font>J <font color="#000080">:= </font>LeftM<font color="#000080">;
</font><font color="#008000"><i>{end }   </i></font><font color="#800000">#79 </font><font color="#000080">: </font>J <font color="#000080">:= </font>Len <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
</font><font color="#008000"><i>{^home} </i></font><font color="#800000">#119 </font><font color="#000080">: </font>DeleteBOL<font color="#000080">; 
</font><font color="#008000"><i>{^end } </i></font><font color="#800000">#117 </font><font color="#000080">: </font>DeleteEOL<font color="#000080">; 
</font><font color="#008000"><i>{^A} </i></font><font color="#800000">#116</font><font color="#000080">,</font><font color="#800000">#1 </font><font color="#000080">: </font>PrevWord<font color="#000080">; 
</font><font color="#008000"><i>{^D} </i></font><font color="#800000">#77</font><font color="#000080">, </font><font color="#800000">#4 </font><font color="#000080">: </font>J <font color="#000080">:= </font>J <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
</font><font color="#008000"><i>{^S} </i></font><font color="#800000">#75</font><font color="#000080">,</font><font color="#800000">#19 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
                 </b></font>J <font color="#000080">:= </font>J <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
</font><font color="#008000"><i>{^E} </i></font><font color="#800000">#72</font><font color="#000080">, </font><font color="#800000">#5 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
                 Begin 
                   </b></font>I <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
                   </font>Ln <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Last<font color="#000080">; 
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#008000"><i>{^F} </i></font><font color="#800000">#115</font><font color="#000080">,</font><font color="#800000">#6 </font><font color="#000080">: </font>NextWord<font color="#000080">; 
</font><font color="#008000"><i>{^X} </i></font><font color="#800000">#80</font><font color="#000080">,</font><font color="#800000">#24 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>I <font color="#000080">&lt; </font>NLines <font color="#FF0000"><b>Then 
                 Begin 
                   </b></font>I  <font color="#000080">:= </font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
                   </font>Ln <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Next<font color="#000080">; 
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#008000"><i>{del}</i></font><font color="#800000">#83</font><font color="#000080">, </font><font color="#800000">#7 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin 
                 </b></font>Delete<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font>J<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                 </font>WriteLine<font color="#000080">(</font>I <font color="#000080">- </font>Top <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">,</font>Attr<font color="#000080">); 
               </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#008000"><i>{ &lt;-- }   </i></font><font color="#800000">#8 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>J <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
                 </b></font>StackLine 
               <font color="#FF0000"><b>Else 
                 Begin 
                   </b></font>J <font color="#000080">:= </font>J <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; 
                   </font>Delete<font color="#000080">(</font>Ln<font color="#000080">^.</font>Data<font color="#000080">,</font>J<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); 
                   </font>Cursor<font color="#000080">; 
                   </font>WriteLine<font color="#000080">(</font>i <font color="#000080">- </font>Top <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">,</font>Attr<font color="#000080">); 
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#008000"><i>{^&lt;--}  </i></font><font color="#800000">#127 </font><font color="#000080">: </font>DeleteWord<font color="#000080">; 
</font><font color="#008000"><i>{Enter}  </i></font><font color="#800000">#13 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin 
                 If </b></font>InSrt <font color="#FF0000"><b>Then 
                   Begin 
                     If </b></font>J <font color="#000080">= </font>Len <font color="#FF0000"><b>Then 
                       </b></font>J <font color="#000080">:= </font>J <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; 
                     </font>CutLine<font color="#000080">; 
                   </font><font color="#FF0000"><b>End 
                 Else
                   Begin 
                     </b></font>I <font color="#000080">:= </font>I <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">; 
                     </font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">; 
                     </font>Ln<font color="#000080">^ := </font>Ln<font color="#000080">^.</font>Next<font color="#000080">^ 
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
               </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#008000"><i>{^R} </i></font><font color="#800000">#73</font><font color="#000080">,</font><font color="#800000">#18 </font><font color="#000080">: </font>PageUp<font color="#000080">; 
</font><font color="#008000"><i>{^C} </i></font><font color="#800000">#81</font><font color="#000080">, </font><font color="#800000">#3 </font><font color="#000080">: </font>PageDown<font color="#000080">; 
</font><font color="#008000"><i>{^PgUp} </i></font><font color="#800000">#132 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin 
                 </b></font>I   <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
                 </font>Top <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; 
                 </font>Ln  <font color="#000080">:= </font>FirstLn<font color="#000080">; 
                 </font>Screen<font color="#000080">; 
               </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#008000"><i>{^PgDn} </i></font><font color="#800000">#118 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin 
                 </b></font>I   <font color="#000080">:= </font>NLines<font color="#000080">; 
                 </font>Top <font color="#000080">:= </font>NLines <font color="#000080">- </font><font color="#800000">22</font><font color="#000080">; 
                 </font>Ln  <font color="#000080">:= </font>EndLn<font color="#000080">; 
                 </font>Screen<font color="#000080">; 
               </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{^Y}     </i></font><font color="#800000">#25 </font><font color="#000080">: </font>DeleteLine<font color="#000080">; 
</font><font color="#008000"><i>{^N}     </i></font><font color="#800000">#14 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin 
                 </b></font>Ln <font color="#000080">:= </font>Ln<font color="#000080">^.</font>Last<font color="#000080">; 
                 </font>InsertLn<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">); 
                 </font>Screen<font color="#000080">; 
               </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#008000"><i>{Ins}</i></font><font color="#800000">#22</font><font color="#000080">,</font><font color="#800000">#82 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin 
                 If </b></font>InSrt <font color="#FF0000"><b>Then 
                   </b></font>InSrt <font color="#000080">:= </font>False 
                 <font color="#FF0000"><b>Else 
                   </b></font>InSrt <font color="#000080">:= </font>True<font color="#000080">; 
                 </font>StatusLine<font color="#000080">; 
               </font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
</font><font color="#008000"><i>{^P}     </i></font><font color="#800000">#16 </font><font color="#000080">: </font>ParaForm<font color="#000080">; 
</font><font color="#008000"><i>{^W}     </i></font><font color="#800000">#23 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>Top <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then 
                 Begin 
                   </b></font>Top <font color="#000080">:= </font>Top <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
                   </font>I <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
                   </font>Screen<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{^Z}     </i></font><font color="#800000">#26 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>Top <font color="#000080">&lt; </font>NLines <font color="#000080">+ </font><font color="#800000">22 </font><font color="#FF0000"><b>Then
                 Begin
                   </b></font>Top <font color="#000080">:= </font>Top <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                   </font>I <font color="#000080">:= </font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                   </font>Screen<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{^K} </i></font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">#11 </font><font color="#000080">: </font>Finished <font color="#000080">:= </font>True<font color="#000080">;
          </font><font color="#FF0000"><b>Else Begin
            </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>WriteLn<font color="#000080">(</font><font color="#800000">'****** COMMAND NOT RECOGNIZED ******                    '</font><font color="#000080">);
            </font>Beep<font color="#000080">; </font>StatusLine<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{case}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{Main}

  </i></font>CheckBreak  <font color="#000080">:= </font>TRUE<font color="#000080">;
  </font>DirectVideo <font color="#000080">:= </font>TRUE<font color="#000080">;

  </font>ClearMarks  <font color="#000080">;
  </font>GetVideoMode<font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font>BaseOfScreen <font color="#000080">= </font><font color="#800000">$B000 </font><font color="#FF0000"><b>Then
     Begin
        </b></font>Fore <font color="#000080">:= </font>White<font color="#000080">;
        </font>Back <font color="#000080">:= </font>Black<font color="#000080">;
     </font><font color="#FF0000"><b>End
  Else Begin
        </b></font>Fore <font color="#000080">:= </font>White<font color="#000080">; </font><font color="#008000"><i>{ make these whatever you want }
        </i></font>Back <font color="#000080">:= </font>Black<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>Attr  <font color="#000080">:= </font>Attribute<font color="#000080">( </font>Fore<font color="#000080">, </font>Back <font color="#000080">);
  </font>TextColor<font color="#000080">( </font>Fore <font color="#000080">);
  </font>TextBackground<font color="#000080">( </font>Back <font color="#000080">);
  </font>ClrScr<font color="#000080">;
  </font>BlankLine <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">80 </font><font color="#FF0000"><b>Do
    </b></font>BlankLine <font color="#000080">:= </font>BlankLine <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>MaxWidth <font color="#FF0000"><b>Do
    </b></font>TabSet<font color="#000080">[</font>I<font color="#000080">]:=( </font>I <font color="#FF0000"><b>Mod </b></font><font color="#800000">8 </font><font color="#000080">) = </font><font color="#800000">1</font><font color="#000080">;
  </font>FileFound <font color="#000080">:= </font>False<font color="#000080">;
  </font>ReadFile<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>FileFound <font color="#FF0000"><b>Then Begin
    </b></font>FirstLn<font color="#000080">^.</font>Last <font color="#000080">:= </font>EndLn <font color="#000080">;
    </font>EndLn<font color="#000080">^.</font>Next   <font color="#000080">:= </font>FirstLn <font color="#000080">;    </font><font color="#008000"><i>{ close chain, endless loop }
    </i></font>J    <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;   </font>I      <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;
    </font>Top  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;   </font>Offset <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;
    </font>Find <font color="#000080">:= </font><font color="#800000">'.'</font><font color="#000080">; </font>Repl   <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>Nbl  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;   </font>Lword  <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>SearchString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; </font>Finished <font color="#000080">:= </font>False<font color="#000080">;
    </font>Replacement  <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; </font>Changed  <font color="#000080">:= </font>False<font color="#000080">;
    </font>ClrScr<font color="#000080">;
    </font>StatusLine<font color="#000080">;
    </font>Screen<font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
      </b></font>Cursor<font color="#000080">;
      </font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
      </font><font color="#FF0000"><b>Case </b></font>Ch <font color="#FF0000"><b>Of
        </b></font><font color="#800000">#0</font><font color="#000080">..</font><font color="#800000">#31</font><font color="#000080">,</font><font color="#800000">#127 </font><font color="#000080">: </font>Command<font color="#000080">;
                </font><font color="#FF0000"><b>Else   </b></font>AddChar<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Until </b></font>Finished<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Changed <font color="#FF0000"><b>Then </b></font>WriteFile<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;  </font><font color="#008000"><i>{FileFound}

  </i></font>TextAttr <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
  </font>ClrScr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">. 
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTEDIT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p></body>
</html>
