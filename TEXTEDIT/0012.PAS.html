<html>
<head><title> "Word Wrap" by JASON KING</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTEDIT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
BT&gt;Hello All...

BT&gt;       Ok once again I have reached a brick wall in my program... What I
BT&gt;was trying to do, was to make Word Wrap actully work... Turns out I was
BT&gt;barking up the wrong tree... If you have examples on how to do this... Th
BT&gt;please reply
BT&gt;and let me know...

What I'm about to describe assumes you either have a loop of
procedure/function that'll read in one line as it works on a line by
line basis....  What I've always done (for wordwrap) is when entering a
line, it stores each character into a holding string that'll contain the
final line, you also have a string that contains the wrapped text, if
the user presses space, you clear the string holding the wrapped text,
and if they reach the end of the line, you erase as many characters as
the length of the string holding the wrapped text...

Example (untested):

(uses the CRT unit)
}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetLineWithWrap<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Line<font color="#000080">,</font>Wrap<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Const </b></font>Cr<font color="#000080">=</font><font color="#800000">#13</font><font color="#000080">;
      </font>BS<font color="#000080">=</font><font color="#800000">#8</font><font color="#000080">;
      </font>EraseChar<font color="#000080">=</font><font color="#800000">#8</font><font color="#000080">+</font><font color="#800000">#32</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>HoldLine<font color="#000080">,</font>HoldWrap<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>Ch<font color="#000080">: </font>Char<font color="#000080">;
    </font>Count<font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>HoldWrap<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
     </font>HoldLine<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>line<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        </b></font>HoldLine<font color="#000080">:=</font>Line<font color="#000080">;
        </font>Write<font color="#000080">(</font>Line<font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Repeat
        While not </b></font>keypressed <font color="#FF0000"><b>do</b></font><font color="#000080">;
        </font>Ch<font color="#000080">:=</font>Readkey<font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>WhereX<font color="#000080">=</font><font color="#800000">80 </font><font color="#FF0000"><b>and then begin
           For </b></font>Count<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>HoldWrap<font color="#000080">) </font>Write<font color="#000080">(</font>EraseChar<font color="#000080">);
           </font>HoldLine<font color="#000080">:=</font>Copy<font color="#000080">(</font>HoldLine<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Length<font color="#000080">(</font>HoldLine<font color="#000080">)-</font>Length<font color="#000080">(</font>HoldWrap<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
           </font>Line<font color="#000080">:=</font>HoldLine<font color="#000080">;
           </font><font color="#FF0000"><b>If </b></font>Ch<font color="#000080">=</font><font color="#800000">#32 </font><font color="#FF0000"><b>then </b></font>Wrap<font color="#000080">:=</font><font color="#800000">'' </font><font color="#FF0000"><b>else </b></font>Wrap<font color="#000080">:=</font>HoldWrap<font color="#000080">+</font>ch<font color="#000080">;
           </font>Exit <font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>Case </b></font>Ch <font color="#FF0000"><b>of
            </b></font><font color="#800000">#13 </font><font color="#000080">: </font><font color="#008000"><i>{nothing, but don't want it added to the line}</i></font><font color="#000080">;
             </font><font color="#800000">#8 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>length<font color="#000080">(</font>HoldLine<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
                     </b></font>Write<font color="#000080">(</font>EraseChar<font color="#000080">);
                     </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>HoldLine<font color="#000080">)&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then
                       </b></font>HoldLine<font color="#000080">:=</font>Copy<font color="#000080">(</font>HoldLine<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Length<font color="#000080">(</font>HoldLine<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">)
                       </font><font color="#FF0000"><b>else </b></font>HoldLine<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                     </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>HoldWrap<font color="#000080">)&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then
                       </b></font>HoldWrap<font color="#000080">:=</font>Copy<font color="#000080">(</font>HoldWrap<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Length<font color="#000080">(</font>HoldWrap<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">)
                       </font><font color="#FF0000"><b>else </b></font>HoldWrap<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
             </font><font color="#800000">#32 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                </b></font>HoldLine<font color="#000080">:=</font>HoldLine<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
                </font>HoldWrap<font color="#000080">:=</font><font color="#800000">'' </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>Else </b></font>HoldLine<font color="#000080">:=</font>HoldLine<font color="#000080">+</font>Ch <font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Until </b></font>Ch<font color="#000080">=</font><font color="#800000">#13</font><font color="#000080">;
    </font>Line<font color="#000080">:=</font>HoldLine<font color="#000080">;
    </font>Wrap<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTEDIT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p></body>
</html>
