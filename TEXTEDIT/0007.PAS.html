<html>
<head><title> "Text Wrapping and Justify" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTEDIT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Uses </b></font>CRT<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Wrap<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>st<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>maxlen<font color="#000080">: </font>byte<font color="#000080">; </font>justify<font color="#000080">: </font>boolean<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ returns a string of no more than maxlen characters with the last   }
  { character being the last space before maxlen. On return st now has }
  { the remaining characters left after the wrapping.                  }
  </i></font><font color="#FF0000"><b>const
    </b></font>space <font color="#000080">= </font><font color="#800000">#32</font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>len      <font color="#000080">: </font>byte <font color="#FF0000"><b>absolute </b></font>st<font color="#000080">;
    </font>x<font color="#000080">,
    </font>oldlen<font color="#000080">,
    </font>newlen   <font color="#000080">: </font>byte<font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>JustifiedStr<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>max<font color="#000080">: </font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

    </font><font color="#008000"><i>{ Justifies string s left and right to length max. If there is more }
    { than one trailing space, only the right most space is deleted. The}
    { remaining spaces are considered &quot;hard&quot;.  #255 is used as the char }
    { used for padding purposes. This will enable easy removal in any   }
    { editor routine.                                                   }

    </i></font><font color="#FF0000"><b>const
      </b></font>softSpace <font color="#000080">= </font><font color="#800000">#255</font><font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>jstr      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font>len       <font color="#000080">: </font>byte <font color="#FF0000"><b>absolute </b></font>jstr<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>jstr <font color="#000080">:= </font>s<font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>jstr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font>space<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>len <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do   </b></font><font color="#008000"><i>{ delete all leading spaces }
        </i></font>delete<font color="#000080">(</font>jstr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>jstr<font color="#000080">[</font>len<font color="#000080">] = </font>space <font color="#FF0000"><b>then
        </b></font>dec<font color="#000080">(</font>len<font color="#000080">);                                </font><font color="#008000"><i>{ Get rid of trailing space }
      </i></font><font color="#FF0000"><b>if not </b></font><font color="#000080">((</font>len <font color="#000080">= </font>max<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>len <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then begin
        </b></font>x <font color="#000080">:= </font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>jstr<font color="#000080">);     </font><font color="#008000"><i>{ Attempt to start padding at sentence break }
        </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>x <font color="#000080">=</font>len<font color="#000080">) </font><font color="#FF0000"><b>then       </b></font><font color="#008000"><i>{ no period or period is at length }
          </i></font>x <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                                    </font><font color="#008000"><i>{ so start at beginning }
        </i></font><font color="#FF0000"><b>if </b></font>pos<font color="#000080">(</font>space<font color="#000080">,</font>jstr<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then repeat        </b></font><font color="#008000"><i>{ ensure at least 1 space }
          </i></font><font color="#FF0000"><b>if </b></font>jstr<font color="#000080">[</font>x<font color="#000080">] = </font>space <font color="#FF0000"><b>then                      </b></font><font color="#008000"><i>{ so add a soft space }
            </i></font>insert<font color="#000080">(</font>softSpace<font color="#000080">,</font>jstr<font color="#000080">,</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
          </font>x <font color="#000080">:= </font>succ<font color="#000080">(</font>x <font color="#FF0000"><b>mod </b></font>len<font color="#000080">);  </font><font color="#008000"><i>{ if eoln is reached return and do it again }
        </i></font><font color="#FF0000"><b>until </b></font>len <font color="#000080">= </font>max<font color="#000080">;        </font><font color="#008000"><i>{ until the wanted string length is achieved }
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ if not ... }
      </i></font>JustifiedStr <font color="#000080">:= </font>jstr<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ JustifiedStr }


  </i></font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{ Wrap }
    </i></font><font color="#FF0000"><b>if </b></font>len <font color="#000080">&lt;= </font>maxlen <font color="#FF0000"><b>then begin                       </b></font><font color="#008000"><i>{ no wrapping required }
      </i></font>Wrap <font color="#000080">:= </font>st<font color="#000080">;
      </font>len  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end else begin
      </b></font>oldlen <font color="#000080">:= </font>len<font color="#000080">;                </font><font color="#008000"><i>{ save the length of the original string }
      </i></font>len    <font color="#000080">:= </font>succ<font color="#000080">(</font>maxlen<font color="#000080">);                        </font><font color="#008000"><i>{ set length to maximum }
      </i></font><font color="#FF0000"><b>repeat                     </b></font><font color="#008000"><i>{ find last space in st before or at maxlen }
        </i></font>dec<font color="#000080">(</font>len<font color="#000080">);
      </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>st<font color="#000080">[</font>len<font color="#000080">] = </font>space<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>len <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>len <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then                   </b></font><font color="#008000"><i>{ no spaces in st, so chop at maxlen }
        </i></font>len <font color="#000080">:= </font>maxlen<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>justify <font color="#FF0000"><b>then
        </b></font>Wrap <font color="#000080">:= </font>JustifiedStr<font color="#000080">(</font>st<font color="#000080">,</font>maxlen<font color="#000080">)
      </font><font color="#FF0000"><b>else
        </b></font>Wrap <font color="#000080">:= </font>st<font color="#000080">;
      </font>newlen <font color="#000080">:=  </font>len<font color="#000080">;          </font><font color="#008000"><i>{ save the length of the newly wrapped string }
      </i></font>len <font color="#000080">:= </font>oldlen<font color="#000080">;              </font><font color="#008000"><i>{ and restore it to original length before }
      </i></font>Delete<font color="#000080">(</font>st<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>newlen<font color="#000080">);              </font><font color="#008000"><i>{ getting rid of the wrapped portion }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Wrap }

</i></font><font color="#FF0000"><b>begin
  </b></font>S <font color="#000080">:=
</font><font color="#800000">'By far the easiest way to manage a database is to create an '</font><font color="#000080">+
</font><font color="#800000">'index file. An index file can take many forms and its size will depend '</font><font color="#000080">+
</font><font color="#800000">'upon how many records you want in the db. The routines that follow '</font><font color="#000080">+
</font><font color="#800000">'assume no more than 32760 records.'</font><font color="#000080">;

</font><font color="#FF0000"><b>while </b></font>length<font color="#000080">(</font>S<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  </b></font>writeln<font color="#000080">(</font>Wrap<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">75</font><font color="#000080">,</font>true<font color="#000080">));
</font>Readkey<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>Whilst this <font color="#FF0000"><b>is </b></font>tested <font color="#FF0000"><b>and </b></font>known <font color="#FF0000"><b>to </b></font>work <font color="#FF0000"><b>on </b></font>the example <font color="#FF0000"><b>string</b></font><font color="#000080">, </font>no further
testing than that has been done<font color="#000080">.  </font>I suggest you test it a great deal more
before being satisfied that it <font color="#FF0000"><b>is </b></font>OK<font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTEDIT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p></body>
</html>
