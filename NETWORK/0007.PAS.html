<html>
<head><title> "NETINFO Unit" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>PROGRAM </b></font>NetInfo<font color="#000080">;
</font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;
</font><font color="#FF0000"><b>CONST
 </b></font>Redirector <font color="#000080">= </font><font color="#800000">$08</font><font color="#000080">;
 </font>Receiver   <font color="#000080">= </font><font color="#800000">$80</font><font color="#000080">;
 </font>Messenger  <font color="#000080">= </font><font color="#800000">$04</font><font color="#000080">;
 </font>Server     <font color="#000080">= </font><font color="#800000">$40</font><font color="#000080">;
 </font>AnyType    <font color="#000080">= </font><font color="#800000">$CC</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
 </b></font>String15 <font color="#000080">= </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">15</font><font color="#000080">];
 </font>LocalDevice <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">16</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">;
 </font>RedirDevice <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">;
 </font>DevicePtr <font color="#000080">= ^</font>DevInfo<font color="#000080">;
 </font>DevInfo <font color="#000080">= </font><font color="#FF0000"><b>RECORD
   </b></font>LD <font color="#000080">: </font>LocalDevice<font color="#000080">;
   </font>RD <font color="#000080">: </font>RedirDevice<font color="#000080">;
   </font>ND <font color="#000080">: </font>DevicePtr
 <font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR </b></font>Done<font color="#000080">:</font>Boolean<font color="#000080">;
    </font>Name<font color="#000080">:</font>String15<font color="#000080">;
    </font>Ver<font color="#000080">:</font>Word<font color="#000080">;
    </font>I<font color="#000080">,</font>Key<font color="#000080">:</font>Integer<font color="#000080">;
    </font>DevIn<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">];
    </font>RedIn<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">128</font><font color="#000080">];
    </font>LDevice<font color="#000080">:</font>LocalDevice<font color="#000080">;
    </font>RDevice<font color="#000080">:</font>RedirDevice<font color="#000080">;
    </font>DeviceList<font color="#000080">,</font>NextDevice <font color="#000080">: </font>DevicePtr<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ClrCursor<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>Regs<font color="#000080">.</font>CH<font color="#000080">:=</font><font color="#800000">$20</font><font color="#000080">;
 </font>Regs<font color="#000080">.</font>AH<font color="#000080">:=</font><font color="#800000">$01</font><font color="#000080">;
 </font>INTR<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetCursor<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>Regs<font color="#000080">.</font>AH<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>LastMode <font color="#000080">&lt;&gt; </font>Mono <font color="#FF0000"><b>THEN
  BEGIN
   </b></font>Regs<font color="#000080">.</font>CH<font color="#000080">:=</font><font color="#800000">6</font><font color="#000080">;
   </font>Regs<font color="#000080">.</font>CL<font color="#000080">:=</font><font color="#800000">7
  </font><font color="#FF0000"><b>END
 ELSE
  BEGIN
   </b></font>Regs<font color="#000080">.</font>CH<font color="#000080">:=</font><font color="#800000">12</font><font color="#000080">;
   </font>Regs<font color="#000080">.</font>CL<font color="#000080">:=</font><font color="#800000">13
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font>INTR<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetExtended <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>CH<font color="#000080">:</font>Char<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>CH<font color="#000080">:=</font><font color="#800000">#0</font><font color="#000080">;</font>GetExtended<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;</font>CH<font color="#000080">:=</font>ReadKey<font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>Ord<font color="#000080">(</font>CH<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
   BEGIN
     </b></font>CH<font color="#000080">:=</font>ReadKey<font color="#000080">;
     </font>GetExtended<font color="#000080">:=</font>Ord<font color="#000080">(</font>CH<font color="#000080">)
   </font><font color="#FF0000"><b>END
END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetFileName<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">):</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>FileName<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">11</font><font color="#000080">];
    </font>I<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>FileName<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
 </font>I<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>WHILE </b></font>S<font color="#000080">[</font>I<font color="#000080">]&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>DO
  BEGIN
   </b></font>FileName<font color="#000080">[</font>I<font color="#000080">]:=(</font>S<font color="#000080">[</font>I<font color="#000080">]);
   </font>I<font color="#000080">:=</font>I<font color="#000080">+</font><font color="#800000">1
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font>FileName<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>Chr<font color="#000080">(</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
 </font>GetFileName<font color="#000080">:=</font>FileName
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>ChkNetInterface <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>NetRegs<font color="#000080">:</font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>NetRegs<font color="#000080">.</font>AH<font color="#000080">:=</font><font color="#800000">$00</font><font color="#000080">;
 </font>INTR<font color="#000080">(</font><font color="#800000">$2A</font><font color="#000080">,</font>NetRegs<font color="#000080">);
 </font><font color="#FF0000"><b>IF </b></font>NetRegs<font color="#000080">.</font>AH <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>ChkNetInterface<font color="#000080">:=</font>FALSE
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ChkPCLan<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>NetRegs<font color="#000080">:</font>Registers<font color="#000080">;
    </font>ChkType<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>NetRegs<font color="#000080">.</font>AX<font color="#000080">:=</font><font color="#800000">$B800</font><font color="#000080">;
 </font>INTR<font color="#000080">(</font><font color="#800000">$2F</font><font color="#000080">,</font>NetRegs<font color="#000080">);
 </font><font color="#FF0000"><b>IF </b></font>NetRegs<font color="#000080">.</font>AH <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
   </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Network Not Installed'</font><font color="#000080">)
 </font><font color="#FF0000"><b>ELSE
  BEGIN
   </b></font>ChkType<font color="#000080">:= </font>NetRegs<font color="#000080">.</font>BL <font color="#FF0000"><b>AND </b></font>AnyType<font color="#000080">;
   </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ChkType <font color="#FF0000"><b>AND </b></font>Server <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Server'</font><font color="#000080">)
   </font><font color="#FF0000"><b>ELSE
   IF </b></font><font color="#000080">(</font>ChkType <font color="#FF0000"><b>AND </b></font>Messenger <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Messenger'</font><font color="#000080">)
   </font><font color="#FF0000"><b>ELSE
   IF </b></font><font color="#000080">(</font>ChkType <font color="#FF0000"><b>AND </b></font>Receiver <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Receiver'</font><font color="#000080">)
   </font><font color="#FF0000"><b>ELSE
   IF </b></font><font color="#000080">(</font>ChkType <font color="#FF0000"><b>AND </b></font>Redirector <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Redirector'</font><font color="#000080">)
   </font><font color="#FF0000"><b>ELSE
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Unknown Type'</font><font color="#000080">)
  </font><font color="#FF0000"><b>END
END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>NetName <font color="#000080">: </font>String15<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>NetRegs<font color="#000080">:</font>Registers<font color="#000080">;
    </font>Name<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 WITH </b></font>NetRegs <font color="#FF0000"><b>DO
  BEGIN
   </b></font>AH<font color="#000080">:=</font><font color="#800000">$5E</font><font color="#000080">;
   </font>AL<font color="#000080">:=</font><font color="#800000">$00</font><font color="#000080">;
   </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>Name<font color="#000080">);
   </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>Name<font color="#000080">)
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font>MsDos<font color="#000080">(</font>NetRegs<font color="#000080">);
 </font><font color="#FF0000"><b>IF </b></font>NetRegs<font color="#000080">.</font>CH<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
  </b></font>NetName<font color="#000080">:=</font>Name
 <font color="#FF0000"><b>ELSE
  </b></font>NetName<font color="#000080">:=</font><font color="#800000">'NOT DEFINED'
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>ChkDrive<font color="#000080">(</font>DriveNo<font color="#000080">:</font>Integer<font color="#000080">):</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>DriveRegs<font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 WITH </b></font>DriveRegs <font color="#FF0000"><b>DO
  BEGIN
   </b></font>AH<font color="#000080">:=</font><font color="#800000">$44</font><font color="#000080">;
   </font>AL<font color="#000080">:=</font><font color="#800000">$09</font><font color="#000080">;
   </font>BL<font color="#000080">:=</font>DriveNo<font color="#000080">;
   </font>MsDos<font color="#000080">(</font>DriveRegs<font color="#000080">);
   </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>FLAGS <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
    IF </b></font><font color="#000080">(</font>DX <font color="#FF0000"><b>AND </b></font><font color="#800000">$1000</font><font color="#000080">) = </font><font color="#800000">$1000 </font><font color="#FF0000"><b>THEN
     </b></font>ChkDrive <font color="#000080">:= </font><font color="#800000">1
    </font><font color="#FF0000"><b>ELSE
     </b></font>ChkDrive <font color="#000080">:= </font><font color="#800000">0
   </font><font color="#FF0000"><b>ELSE
    </b></font>ChkDrive <font color="#000080">:= </font>AX <font color="#000080">* -</font><font color="#800000">1
  </font><font color="#FF0000"><b>END
END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetDevices<font color="#000080">: </font>DevicePtr<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>NetRegs<font color="#000080">: </font>Registers<font color="#000080">;
    </font>FstDevice<font color="#000080">, </font>CurDevice<font color="#000080">,</font>NewDevice <font color="#000080">: </font>DevicePtr<font color="#000080">;
    </font>DevName<font color="#000080">: </font>LocalDevice<font color="#000080">;
    </font>RedName<font color="#000080">: </font>RedirDevice<font color="#000080">;
    </font>NextDev<font color="#000080">: </font>Integer<font color="#000080">;
    </font>More <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
</b></font>More<font color="#000080">:=</font>TRUE<font color="#000080">;
</font>FstDevice<font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
</font>CurDevice<font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
</font>NextDev<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>WHILE </b></font>More <font color="#FF0000"><b>DO
BEGIN
 WITH </b></font>NetRegs <font color="#FF0000"><b>DO
  BEGIN
   </b></font>AH<font color="#000080">:=</font><font color="#800000">$5F</font><font color="#000080">;
   </font>AL<font color="#000080">:=</font><font color="#800000">$02</font><font color="#000080">;
   </font>BX<font color="#000080">:=</font>NextDev<font color="#000080">;
   </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>DevName<font color="#000080">);
   </font>SI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>DevName<font color="#000080">);
   </font>ES<font color="#000080">:=</font>Seg<font color="#000080">(</font>RedName<font color="#000080">);
   </font>DI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>RedName<font color="#000080">)
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font>MsDos<font color="#000080">(</font>NetRegs<font color="#000080">);
 </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>NetRegs<font color="#000080">.</font>FLAGS <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
  </b></font>More<font color="#000080">:=</font>FALSE
 <font color="#FF0000"><b>ELSE
 BEGIN
  </b></font>NEW<font color="#000080">(</font>NewDevice<font color="#000080">);
  </font>NewDevice<font color="#000080">^.</font>LD<font color="#000080">:=</font>DevName<font color="#000080">;
  </font>NewDevice<font color="#000080">^.</font>RD<font color="#000080">:=</font>RedName<font color="#000080">;
  </font>NewDevice<font color="#000080">^.</font>ND<font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>CurDevice <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>FstDevice<font color="#000080">=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    BEGIN
     </b></font>CurDevice<font color="#000080">:=</font>NewDevice<font color="#000080">;
     </font>FstDevice<font color="#000080">:=</font>NewDevice
    <font color="#FF0000"><b>END
  ELSE
    BEGIN
     </b></font>CurDevice<font color="#000080">^.</font>ND<font color="#000080">:=</font>NewDevice<font color="#000080">;
     </font>CurDevice<font color="#000080">:=</font>NewDevice
    <font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Inc<font color="#000080">(</font>NextDev<font color="#000080">)
 </font><font color="#FF0000"><b>END
END</b></font><font color="#000080">;
</font>GetDevices<font color="#000080">:=</font>FstDevice
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>AssignDevice<font color="#000080">(</font>DevName<font color="#000080">:</font>LocalDevice<font color="#000080">;
                       </font>RedName<font color="#000080">:</font>RedirDevice<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>NetRegs<font color="#000080">: </font>Registers<font color="#000080">;
    </font>DevType<font color="#000080">: </font>Byte<font color="#000080">;
    </font>Dummy  <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
IF </b></font>Pos<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">,</font>DevName<font color="#000080">)=</font><font color="#800000">2 </font><font color="#FF0000"><b>THEN
  </b></font>DevType<font color="#000080">:=</font><font color="#800000">4
 </font><font color="#FF0000"><b>ELSE
  </b></font>DevType<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;

 </font><font color="#FF0000"><b>WITH </b></font>NetRegs <font color="#FF0000"><b>DO
  BEGIN
   </b></font>AH<font color="#000080">:=</font><font color="#800000">$5F</font><font color="#000080">;
   </font>AL<font color="#000080">:=</font><font color="#800000">$03</font><font color="#000080">;
   </font>BL<font color="#000080">:=</font>DevType<font color="#000080">;
   </font>CX<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>DevName<font color="#000080">);
   </font>SI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>DevName<font color="#000080">);
   </font>ES<font color="#000080">:=</font>Seg<font color="#000080">(</font>RedName<font color="#000080">);
   </font>DI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>RedName<font color="#000080">)
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font>MsDos<font color="#000080">(</font>NetRegs<font color="#000080">);
 </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>NetRegs<font color="#000080">.</font>FLAGS <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
  BEGIN
   </b></font>TextColor<font color="#000080">(</font>Red<font color="#000080">);</font>GotoXY<font color="#000080">(</font>WhereX<font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>WhereY<font color="#000080">);
   </font>WriteLn<font color="#000080">(</font><font color="#800000">'An Error Occurred on Assign'</font><font color="#000080">);
   </font>TextColor<font color="#000080">(</font>Red<font color="#000080">+</font><font color="#800000">128</font><font color="#000080">);</font>GotoXY<font color="#000080">(</font>WhereX<font color="#000080">+</font><font color="#800000">13</font><font color="#000080">,</font>WhereY<font color="#000080">);
   </font>Write<font color="#000080">(</font><font color="#800000">'Press Any Key'</font><font color="#000080">);
   </font>Dummy<font color="#000080">:=</font>GetExtended<font color="#000080">;
   </font>TextColor<font color="#000080">(</font>White<font color="#000080">);
   </font>ClrScr
  <font color="#FF0000"><b>END
END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DeleteDevice<font color="#000080">(</font>DevName<font color="#000080">:</font>LocalDevice<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>NetRegs<font color="#000080">: </font>Registers<font color="#000080">;
    </font>Dummy  <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 WITH </b></font>NetRegs <font color="#FF0000"><b>DO
  BEGIN
   </b></font>AH<font color="#000080">:=</font><font color="#800000">$5F</font><font color="#000080">;
   </font>AL<font color="#000080">:=</font><font color="#800000">$04</font><font color="#000080">;
   </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>DevName<font color="#000080">);
   </font>SI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>DevName<font color="#000080">)
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font>MsDos<font color="#000080">(</font>NetRegs<font color="#000080">);
 </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>NetRegs<font color="#000080">.</font>FLAGS <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
  BEGIN
   </b></font>TextColor<font color="#000080">(</font>Red<font color="#000080">);</font>GotoXY<font color="#000080">(</font>WhereX<font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>WhereY<font color="#000080">);
   </font>WriteLn<font color="#000080">(</font><font color="#800000">'An Error Occurred on Delete'</font><font color="#000080">);
   </font>TextColor<font color="#000080">(</font>Red<font color="#000080">+</font><font color="#800000">128</font><font color="#000080">);</font>GotoXY<font color="#000080">(</font>WhereX<font color="#000080">+</font><font color="#800000">13</font><font color="#000080">,</font>WhereY<font color="#000080">);
   </font>Write<font color="#000080">(</font><font color="#800000">'Press Any Key'</font><font color="#000080">);
   </font>Dummy<font color="#000080">:=</font>GetExtended<font color="#000080">;
   </font>TextColor<font color="#000080">(</font>White<font color="#000080">);
   </font>ClrScr
  <font color="#FF0000"><b>END
END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SrchDevice<font color="#000080">(</font>Drive<font color="#000080">:</font>LocalDevice<font color="#000080">):</font>DevicePtr<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>NDevice<font color="#000080">:</font>DevicePtr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>NDevice<font color="#000080">:=</font>GetDevices<font color="#000080">;
 </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>NDevice <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>AND
       </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>NDevice<font color="#000080">^.</font>LD<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">) &lt;&gt;
        </font>Copy<font color="#000080">(</font>Drive<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)) </font><font color="#FF0000"><b>DO
  BEGIN
   </b></font>NDevice<font color="#000080">:=</font>NDevice<font color="#000080">^.</font>ND
  <font color="#FF0000"><b>END</b></font><font color="#000080">;
</font>SrchDevice<font color="#000080">:=</font>NDevice
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DisplayDrives<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>I<font color="#000080">:</font>Integer<font color="#000080">;
    </font>LDevice<font color="#000080">:</font>LocalDevice<font color="#000080">;
    </font>NextDevice <font color="#000080">: </font>DevicePtr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 FOR </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">26 </font><font color="#FF0000"><b>DO
  BEGIN
   CASE </b></font>ChkDrive<font color="#000080">(</font>I<font color="#000080">) </font><font color="#FF0000"><b>OF
    </b></font><font color="#800000">0 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
         </b></font>Write<font color="#000080">(</font><font color="#800000">#32</font><font color="#000080">,</font><font color="#800000">#32</font><font color="#000080">,</font>Chr<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">+</font>I<font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">);
         </font>GotoXY<font color="#000080">(</font>WhereX<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>WhereY<font color="#000080">);
         </font>WriteLn<font color="#000080">(</font><font color="#800000">'Local'</font><font color="#000080">)
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#800000">1 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
         </b></font>Write<font color="#000080">(</font><font color="#800000">#32</font><font color="#000080">,</font><font color="#800000">#32</font><font color="#000080">,</font>Chr<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">+</font>I<font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">);
         </font>GotoXY<font color="#000080">(</font>WhereX<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>WhereY<font color="#000080">);
         </font>Write<font color="#000080">(</font><font color="#800000">'Remote'</font><font color="#000080">);
         </font>LDevice<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>Chr<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">+</font>I<font color="#000080">);
         </font>LDevice<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font><font color="#800000">':'</font><font color="#000080">;
         </font>LDevice<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font><font color="#800000">#0</font><font color="#000080">;
         </font>NextDevice<font color="#000080">:=</font>SrchDevice<font color="#000080">(</font>LDevice<font color="#000080">);
         </font>GotoXY<font color="#000080">(</font>WhereX<font color="#000080">+</font><font color="#800000">7</font><font color="#000080">,</font>WhereY<font color="#000080">);
         </font><font color="#FF0000"><b>WITH </b></font>NextDevice<font color="#000080">^ </font><font color="#FF0000"><b>DO
          </b></font>WriteLn<font color="#000080">(</font>Copy<font color="#000080">(</font>RD<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">#0</font><font color="#000080">,</font>RD<font color="#000080">)))
        </font><font color="#FF0000"><b>END
   END
  END
END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrnSetup<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>ClrCursor<font color="#000080">;
 </font>TextBackground<font color="#000080">(</font>Blue<font color="#000080">);
 </font>TextColor<font color="#000080">(</font>White<font color="#000080">);
 </font>ClrScr<font color="#000080">;
 </font>GotoXY<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'Network Status'</font><font color="#000080">);
 </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
 </font>GotoXY<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'Dos Version:'</font><font color="#000080">);
 </font>GotoXY<font color="#000080">(</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'Network Name:'</font><font color="#000080">);
 </font>GotoXY<font color="#000080">(</font><font color="#800000">51</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'Node Type:'</font><font color="#000080">);
 </font>TextColor<font color="#000080">(</font>White<font color="#000080">);
 </font>GotoXY<font color="#000080">(</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'Drive Status'</font><font color="#000080">);
 </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
 </font>GotoXY<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'Drive'</font><font color="#000080">);
 </font>GotoXY<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'Location'</font><font color="#000080">);
 </font>GotoXY<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'Connection'</font><font color="#000080">);
 </font>GotoXY<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'F1 - Assign Device'</font><font color="#000080">);
 </font>GotoXY<font color="#000080">(</font><font color="#800000">35</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'F2 - Delete Device'</font><font color="#000080">);
 </font>GotoXY<font color="#000080">(</font><font color="#800000">55</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'F10 - Exit'</font><font color="#000080">);
 </font>TextBackground<font color="#000080">(</font>Black<font color="#000080">);
 </font>Ver<font color="#000080">:=</font>DosVersion<font color="#000080">;
 </font>GotoXY<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
 </font>WriteLn<font color="#000080">(</font>Lo<font color="#000080">(</font>Ver<font color="#000080">),</font><font color="#800000">'.'</font><font color="#000080">,</font>Hi<font color="#000080">(</font>Ver<font color="#000080">))
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetScreen<font color="#000080">(</font>W<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Z<font color="#000080">,</font>Back<font color="#000080">,</font>Txt<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
 </b></font>Window<font color="#000080">(</font>W<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Z<font color="#000080">);
 </font>TextColor<font color="#000080">(</font>Txt<font color="#000080">);
 </font>TextBackground<font color="#000080">(</font>Back<font color="#000080">);
 </font>ClrScr
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>ScrnSetup<font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>ChkNetInterface <font color="#FF0000"><b>THEN
  BEGIN
    </b></font>GotoXY<font color="#000080">(</font><font color="#800000">35</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">); </font>WriteLn<font color="#000080">(</font>NetName<font color="#000080">);</font>GotoXY<font color="#000080">(</font><font color="#800000">62</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
    </font>ChkPCLan<font color="#000080">;
    </font>Window<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);</font>ClrScr<font color="#000080">;
    </font>DisplayDrives<font color="#000080">;
    </font><font color="#FF0000"><b>REPEAT
     </b></font>SetScreen<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font>Blue<font color="#000080">,</font>White<font color="#000080">);
     </font>Key<font color="#000080">:=</font>GetExtended<font color="#000080">;
     </font><font color="#FF0000"><b>CASE </b></font>Key <font color="#FF0000"><b>OF
       </b></font><font color="#800000">59</font><font color="#000080">:</font><font color="#FF0000"><b>BEGIN
           </b></font>SetCursor<font color="#000080">;
           </font>Write<font color="#000080">(</font><font color="#800000">'Drive to Redirect  '</font><font color="#000080">);
           </font>ReadLn<font color="#000080">(</font>DevIn<font color="#000080">);
           </font>Write<font color="#000080">(</font><font color="#800000">'Remote Definition  '</font><font color="#000080">);
           </font>ReadLn<font color="#000080">(</font>RedIn<font color="#000080">);
           </font>ClrCursor<font color="#000080">;
           </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Ord<font color="#000080">(</font>DevIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>DO
            </b></font>LDevice<font color="#000080">[</font>I<font color="#000080">]:=</font>DevIn<font color="#000080">[</font>I<font color="#000080">];
           </font>LDevice<font color="#000080">[</font>Ord<font color="#000080">(</font>DevIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">#0</font><font color="#000080">;
           </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Ord<font color="#000080">(</font>RedIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>DO
            </b></font>RDevice<font color="#000080">[</font>I<font color="#000080">]:=</font>RedIn<font color="#000080">[</font>I<font color="#000080">];
           </font>RDevice<font color="#000080">[</font>Ord<font color="#000080">(</font>RedIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">#0</font><font color="#000080">;
           </font>AssignDevice<font color="#000080">(</font>LDevice<font color="#000080">,</font>RDevice<font color="#000080">)
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
       </font><font color="#800000">60</font><font color="#000080">:</font><font color="#FF0000"><b>BEGIN
           </b></font>Write<font color="#000080">(</font><font color="#800000">'Drive to Delete    '</font><font color="#000080">);
           </font>SetCursor<font color="#000080">;
           </font>ReadLn<font color="#000080">(</font>DevIn<font color="#000080">);
           </font>ClrCursor<font color="#000080">;
           </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Ord<font color="#000080">(</font>DevIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>DO
            </b></font>LDevice<font color="#000080">[</font>I<font color="#000080">]:=</font>DevIn<font color="#000080">[</font>I<font color="#000080">];
           </font>LDevice<font color="#000080">[</font>Ord<font color="#000080">(</font>DevIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">#0</font><font color="#000080">;
           </font>DeleteDevice<font color="#000080">(</font>LDevice<font color="#000080">)
          </font><font color="#FF0000"><b>END
     END</b></font><font color="#000080">;
     </font>SetScreen<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>Black<font color="#000080">,</font>LightGray<font color="#000080">);
     </font>DisplayDrives<font color="#000080">;
    </font><font color="#FF0000"><b>UNTIL </b></font>Key <font color="#000080">= </font><font color="#800000">68</font><font color="#000080">;

  </font><font color="#FF0000"><b>END
 ELSE
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'NetBIOS Interface Not Available'</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p></body>
</html>
