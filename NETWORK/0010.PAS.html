<html>
<head><title> "Network "Real" name" by KERRY SOKALSKY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
-&gt; I don't have an answer to your question, but would you happen to know
-&gt; how to return a user's full name (as stored in syscon)?  Thanks.

I assume you already have the user's login name.  Here is a procedure
that will get a user's full name.  If you are going to do a lot of
Netware programming I suggest you get &quot;Programmers Guide to Netware&quot; by
Charles Rose. ISBN # 0-07-607029-8.  It documents all of the Netware
functions and also talks about IPX/SPX programming.
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Full_Name<font color="#000080">(</font>User_Name <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Type
  </b></font>RequestBuffer <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>RequestBufferLength <font color="#000080">: </font>Word<font color="#000080">;
    </font>Code                <font color="#000080">: </font>Byte<font color="#000080">;
    </font>ObjectType          <font color="#000080">: </font>Word<font color="#000080">;
    </font>ObjectNameLength    <font color="#000080">: </font>Byte<font color="#000080">;
    </font>ObjectName          <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">48</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>SegmentNumber       <font color="#000080">: </font>Byte<font color="#000080">;
    </font>PropertyNameLength  <font color="#000080">: </font>Byte<font color="#000080">;
    </font>PropertyName        <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>ReplyBuffer <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>ReplyBufferLength <font color="#000080">: </font>Word<font color="#000080">;
    </font>PropertyValue     <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>MoreSegments      <font color="#000080">: </font>Byte<font color="#000080">;
    </font>PropertyFlags     <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Request <font color="#000080">: </font>RequestBuffer<font color="#000080">;
  </font>Reply   <font color="#000080">: </font>ReplyBuffer<font color="#000080">;
  </font>PropertyName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">15</font><font color="#000080">];
  </font>Counter <font color="#000080">: </font>Byte<font color="#000080">;
  </font>Temp    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">128</font><font color="#000080">];

</font><font color="#FF0000"><b>begin
  </b></font>PropertyName <font color="#000080">:= </font><font color="#800000">'IDENTIFICATION'</font><font color="#000080">;
  </font>Request<font color="#000080">.</font>RequestBufferLength <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>Request<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">;
  </font>Request<font color="#000080">.</font>Code <font color="#000080">:= </font><font color="#800000">$3D</font><font color="#000080">;
  </font>Request<font color="#000080">.</font>SegmentNumber <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Request<font color="#000080">.</font>ObjectType <font color="#000080">:= </font><font color="#800000">$0100</font><font color="#000080">;
  </font>Request<font color="#000080">.</font>ObjectNameLength <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>Request<font color="#000080">.</font>ObjectName<font color="#000080">);
  </font>FillChar<font color="#000080">(</font>Request<font color="#000080">.</font>ObjectName<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Request<font color="#000080">.</font>ObjectName<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>User_Name<font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>Request<font color="#000080">.</font>ObjectName<font color="#000080">[</font>Counter<font color="#000080">] := </font>User_Name<font color="#000080">[</font>Counter<font color="#000080">];

  </font>Request<font color="#000080">.</font>PropertyNameLength <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>Request<font color="#000080">.</font>PropertyName<font color="#000080">);
  </font>FillChar<font color="#000080">(</font>Request<font color="#000080">.</font>PropertyName<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Request<font color="#000080">.</font>PropertyName<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>PropertyName<font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>Request<font color="#000080">.</font>PropertyName<font color="#000080">[</font>Counter<font color="#000080">] := </font>PropertyName<font color="#000080">[</font>Counter<font color="#000080">];

  </font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$E3</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>DS <font color="#000080">:= </font>Seg<font color="#000080">(</font>Request<font color="#000080">);
  </font>Regs<font color="#000080">.</font>SI <font color="#000080">:= </font>Ofs<font color="#000080">(</font>Request<font color="#000080">);

  </font>Reply<font color="#000080">.</font>ReplyBufferLength <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>Reply<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>ES <font color="#000080">:= </font>Seg<font color="#000080">(</font>Reply<font color="#000080">);
  </font>Regs<font color="#000080">.</font>DI <font color="#000080">:= </font>Ofs<font color="#000080">(</font>Reply<font color="#000080">);

  </font>MSDos<font color="#000080">(</font>Regs<font color="#000080">);

  </font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>Counter <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Reply<font color="#000080">.</font>PropertyValue<font color="#000080">[</font>Counter<font color="#000080">] &lt;&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>Reply<font color="#000080">.</font>PropertyValue<font color="#000080">[</font>Counter<font color="#000080">];
    </font>inc<font color="#000080">(</font>Counter<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Full_Name <font color="#000080">:= </font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Writeln<font color="#000080">(</font>Full_Name<font color="#000080">(</font><font color="#800000">'SOKALSKY'</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p></body>
</html>
