<html>
<head><title> "Misc NOVELL API Calls" by RICK RYAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program  </b></font>Novell_API_Examples<font color="#000080">;

</font><font color="#008000"><i>{ Misc. Novell Advanced Netware 2.1+ API examples to retrieve info on the
  user who is running this program
}

</i></font><font color="#FF0000"><b>USES   </b></font>DOS<font color="#000080">, </font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>HexDigit<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
  </font>Days_Of_Week   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of string </b></font><font color="#000080">= (</font><font color="#800000">'Sunday'</font><font color="#000080">,</font><font color="#800000">'Monday'</font><font color="#000080">,</font><font color="#800000">'Tuesday'</font><font color="#000080">,
                                            </font><font color="#800000">'Wednesday'</font><font color="#000080">,</font><font color="#800000">'Thursday'</font><font color="#000080">,</font><font color="#800000">'Friday'</font><font color="#000080">,
                                            </font><font color="#800000">'Saturday'</font><font color="#000080">);


</font><font color="#FF0000"><b>TYPE
  </b></font>string2 <font color="#000080">= </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font>string4 <font color="#000080">= </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];


</font><font color="#FF0000"><b>VAR
  </b></font>Reg          <font color="#000080">: </font>DOS<font color="#000080">.</font>Registers<font color="#000080">;
  </font>RCode        <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Connect      <font color="#000080">: </font>Byte<font color="#000080">;
  </font>Address      <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>HexByte<font color="#000080">(</font>B<font color="#000080">: </font>byte<font color="#000080">): </font>string2<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>HexByte <font color="#000080">:= </font>HexDigit<font color="#000080">[</font>B <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">] + </font>HexDigit<font color="#000080">[</font>B <font color="#FF0000"><b>and </b></font><font color="#800000">$F</font><font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>Hex<font color="#000080">(</font>I<font color="#000080">: </font>integer<font color="#000080">): </font>string4<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Hex <font color="#000080">:= </font>HexByte<font color="#000080">(</font>hi<font color="#000080">(</font>I<font color="#000080">)) + </font>HexByte<font color="#000080">(</font>lo<font color="#000080">(</font>I<font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>Get_Connection_Number <font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{ |
    | Returns the connection number for the current session
    |
  }
  </i></font><font color="#FF0000"><b>begin
    </b></font>Reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$DC</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>Reg<font color="#000080">);
    </font>Get_Connection_Number <font color="#000080">:= </font>Reg<font color="#000080">.</font>AL<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>Get_Station_Address<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Address<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Integer<font color="#000080">;
  </font><font color="#008000"><i>{ |
    |  Returns the Physical Station Address (NIC Number)
    |
  }
  </i></font><font color="#FF0000"><b>var
    </b></font>S1<font color="#000080">, </font>S2<font color="#000080">, </font>S3 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$EE</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>Reg<font color="#000080">);
    </font>Address <font color="#000080">:= </font>Hex<font color="#000080">(</font>Reg<font color="#000080">.</font>CX<font color="#000080">) + </font>Hex<font color="#000080">(</font>Reg<font color="#000080">.</font>BX<font color="#000080">) + </font>Hex<font color="#000080">(</font>Reg<font color="#000080">.</font>AX<font color="#000080">);
    </font>Get_Station_Address <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>Get_Login_Name <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ |
    |  Who's calling?
    |
  }
  </i></font><font color="#FF0000"><b>var
    </b></font>Reg           <font color="#000080">: </font>DOS<font color="#000080">.</font>REGISTERS<font color="#000080">;
    </font>Loop<font color="#000080">,
    </font>Connection    <font color="#000080">: </font>Byte<font color="#000080">;
    </font>TmpStr        <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>Request_Buf   <font color="#000080">: </font><font color="#FF0000"><b>Record
                      </b></font>BufLen     <font color="#000080">: </font>Integer<font color="#000080">;
                      </font>SubFunc    <font color="#000080">: </font>Byte<font color="#000080">;
                      </font>Connection <font color="#000080">: </font>Byte<font color="#000080">;
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Reply_Buf     <font color="#000080">: </font><font color="#FF0000"><b>Record
                      </b></font>BufLen     <font color="#000080">: </font>Integer<font color="#000080">;
                      </font>Obj_ID     <font color="#000080">: </font>LongInt<font color="#000080">;
                      </font>Obj_Type   <font color="#000080">: </font>Integer<font color="#000080">;
                      </font>Obj_Name   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">48</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
                      </font>Login_Time <font color="#000080">: </font><font color="#FF0000"><b>Record
                                     </b></font>Year   <font color="#000080">: </font>Byte<font color="#000080">;
                                     </font>Month  <font color="#000080">: </font>Byte<font color="#000080">;
                                     </font>Day    <font color="#000080">: </font>Byte<font color="#000080">;
                                     </font>Hour   <font color="#000080">: </font>Byte<font color="#000080">;
                                     </font>Minute <font color="#000080">: </font>Byte<font color="#000080">;
                                     </font>Second <font color="#000080">: </font>Byte<font color="#000080">;
                                     </font>Day_No <font color="#000080">: </font>Byte<font color="#000080">;
                                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>begin
    </b></font>TmpStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>RCode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Connect <font color="#000080">:= </font>Get_Connection_Number<font color="#000080">;
    </font>fillchar<font color="#000080">(</font>Request_Buf<font color="#000080">,</font>sizeof<font color="#000080">(</font>Request_Buf<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>fillchar<font color="#000080">(</font>Reply_Buf<font color="#000080">,</font>sizeof<font color="#000080">(</font>Reply_Buf<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);

    </font>Request_Buf<font color="#000080">.</font>SubFunc <font color="#000080">:= </font><font color="#800000">$16</font><font color="#000080">;
    </font>Request_Buf<font color="#000080">.</font>Connection <font color="#000080">:= </font>Connect<font color="#000080">;
    </font>Request_Buf<font color="#000080">.</font>BufLen <font color="#000080">:= </font>sizeof<font color="#000080">(</font>Request_Buf<font color="#000080">);
    </font>Reply_Buf<font color="#000080">.</font>BufLen <font color="#000080">:= </font>sizeof<font color="#000080">(</font>Reply_Buf<font color="#000080">);
    </font>Reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$E3</font><font color="#000080">;
    </font>Reg<font color="#000080">.</font>DS <font color="#000080">:= </font>seg<font color="#000080">(</font>Request_Buf<font color="#000080">);
    </font>Reg<font color="#000080">.</font>SI <font color="#000080">:= </font>ofs<font color="#000080">(</font>Request_Buf<font color="#000080">);
    </font>Reg<font color="#000080">.</font>ES <font color="#000080">:= </font>seg<font color="#000080">(</font>Reply_Buf<font color="#000080">);
    </font>Reg<font color="#000080">.</font>DI <font color="#000080">:= </font>ofs<font color="#000080">(</font>Reply_Buf<font color="#000080">);
    </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>Reg<font color="#000080">);
    </font>Loop <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>Reply_Buf<font color="#000080">.</font>Obj_Name<font color="#000080">[</font>Loop<font color="#000080">] &lt;&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Loop <font color="#000080">&lt;= </font><font color="#800000">48</font><font color="#000080">)) </font><font color="#FF0000"><b>do
      begin
        </b></font>TmpStr <font color="#000080">:= </font>TmpStr <font color="#000080">+ </font>Reply_Buf<font color="#000080">.</font>Obj_Name<font color="#000080">[</font>Loop<font color="#000080">];
        </font>inc<font color="#000080">(</font>loop<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Get_Login_Name <font color="#000080">:= </font>TmpStr<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Pause<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>ch <font color="#000080">: </font>char<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>writeln<font color="#000080">;
    </font>write<font color="#000080">(</font><font color="#800000">'Press Any Key To Continue '</font><font color="#000080">);
    </font>ch <font color="#000080">:= </font>readkey<font color="#000080">;
    </font>writeln<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>BEGIN
  </b></font>clrscr<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'Get Novell Station Info  - (C) Rick Ryan, 1989'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>Connect <font color="#000080">:= </font>Get_Connection_Number<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'  Connection ID: '</font><font color="#000080">, </font>Connect<font color="#000080">);

  </font>RCode <font color="#000080">:= </font>Get_Station_Address<font color="#000080">(</font>Address<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Station Address: '</font><font color="#000080">,</font>Address<font color="#000080">,</font><font color="#800000">'  With ErrCode of '</font><font color="#000080">, </font>RCode<font color="#000080">);

  </font>writeln<font color="#000080">(</font><font color="#800000">'Login Name = '</font><font color="#000080">,</font>Get_Login_Name<font color="#000080">);

  </font>Pause<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p></body>
</html>
