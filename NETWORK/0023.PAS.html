<html>
<head><title> "Netware Encrypted Login" by OLAF BARTELT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0023.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{$R+,V-}

{ This program will prompt for a server, login id and password.  All }
{ input will be echoed to the screen!                                }

</i></font><font color="#FF0000"><b>PROGRAM </b></font>LOGON<font color="#000080">;

</font><font color="#FF0000"><b>USES
  </b></font>Dos<font color="#000080">,
  </font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>NET_USER         <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>USER_GROUP       <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>FILE_SERVER      <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;

  </font>MaxServers       <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;
  </font>DriveHandleTable <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>DriveFlagTable   <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>DriveServerTable <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>ServerMapTable   <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
  </font>ServerNameTable  <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>Buf32 <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">31</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
  </font>Buf16 <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
  </font>Buf8  <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">]  </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
  </font>Buf4  <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">]  </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>EncryptTable <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font>BYTE<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE <font color="#000080">=
(</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,
 </font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,
 </font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,
 </font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,
 </font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,
 </font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,
 </font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,
 </font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,
 </font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,
 </font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,
 </font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,
 </font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,
 </font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,
 </font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$5</font><font color="#000080">,</font><font color="#800000">$9</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,
 </font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$E</font><font color="#000080">,</font><font color="#800000">$1</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$4</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,
 </font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">,</font><font color="#800000">$3</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$F</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$7</font><font color="#000080">,</font><font color="#800000">$B</font><font color="#000080">,</font><font color="#800000">$2</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">,</font><font color="#800000">$C</font><font color="#000080">,</font><font color="#800000">$6</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$A</font><font color="#000080">,</font><font color="#800000">$8</font><font color="#000080">,</font><font color="#800000">$D</font><font color="#000080">);

  </font>EncryptKeys <font color="#000080">: </font>Buf32 <font color="#000080">=
(</font><font color="#800000">$48</font><font color="#000080">,</font><font color="#800000">$93</font><font color="#000080">,</font><font color="#800000">$46</font><font color="#000080">,</font><font color="#800000">$67</font><font color="#000080">,</font><font color="#800000">$98</font><font color="#000080">,</font><font color="#800000">$3D</font><font color="#000080">,</font><font color="#800000">$E6</font><font color="#000080">,</font><font color="#800000">$8D</font><font color="#000080">,</font><font color="#800000">$B7</font><font color="#000080">,</font><font color="#800000">$10</font><font color="#000080">,</font><font color="#800000">$7A</font><font color="#000080">,</font><font color="#800000">$26</font><font color="#000080">,</font><font color="#800000">$5A</font><font color="#000080">,</font><font color="#800000">$B9</font><font color="#000080">,</font><font color="#800000">$B1</font><font color="#000080">,</font><font color="#800000">$35</font><font color="#000080">,
 </font><font color="#800000">$6B</font><font color="#000080">,</font><font color="#800000">$0F</font><font color="#000080">,</font><font color="#800000">$D5</font><font color="#000080">,</font><font color="#800000">$70</font><font color="#000080">,</font><font color="#800000">$AE</font><font color="#000080">,</font><font color="#800000">$FB</font><font color="#000080">,</font><font color="#800000">$AD</font><font color="#000080">,</font><font color="#800000">$11</font><font color="#000080">,</font><font color="#800000">$F4</font><font color="#000080">,</font><font color="#800000">$47</font><font color="#000080">,</font><font color="#800000">$DC</font><font color="#000080">,</font><font color="#800000">$A7</font><font color="#000080">,</font><font color="#800000">$EC</font><font color="#000080">,</font><font color="#800000">$CF</font><font color="#000080">,</font><font color="#800000">$50</font><font color="#000080">,</font><font color="#800000">$C0</font><font color="#000080">);


</font><font color="#FF0000"><b>TYPE
  </b></font>WORD   <font color="#000080">= </font>INTEGER<font color="#000080">;

  </font>NetStr <font color="#000080">= </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">47</font><font color="#000080">];
  </font>GenStr <font color="#000080">= </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">128</font><font color="#000080">];
  </font>FourBytes <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>BYTE<font color="#000080">;
  </font>MemBlock <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;

</font><font color="#008000"><i>{  RegsType = RECORD case integer of
    1: (AX, BX, CX, DX, BP, SI, DI, DS, ES, Flags : INTEGER);
    2: (AL, AH, BL, BH, CL, CH, DL, DH            : BYTE);
    END; }

  </i></font>ServerItem <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">48</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
  </font>ServerName <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxServers<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>ServerItem<font color="#000080">;
  </font>ServerNamePtr <font color="#000080">= ^</font>ServerName<font color="#000080">;

  </font>ServerMappingEntry <font color="#000080">= </font><font color="#FF0000"><b>RECORD
    </b></font>SlotInUse      <font color="#000080">: </font>BYTE<font color="#000080">;
    </font>OrderNumber    <font color="#000080">: </font>BYTE<font color="#000080">;
    </font>ServerNet      <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
    </font>ServerSocket   <font color="#000080">: </font>WORD<font color="#000080">;
    </font>RouterNet      <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
    </font>RouterSocket   <font color="#000080">: </font>WORD<font color="#000080">;
    </font>ShellInternal  <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>ServerMappingTable <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxServers<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>ServerMappingEntry<font color="#000080">;
  </font>ServerMappingPtr   <font color="#000080">= ^</font>ServerMappingTable<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>rc   <font color="#000080">: </font>BYTE<font color="#000080">;
  </font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
  </font><font color="#008000"><i>{ Regs : RegsType; }

{ -------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetString<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>NameEntry<font color="#000080">: </font>ServerItem<font color="#000080">): </font>GenStr<font color="#000080">;
</font><font color="#FF0000"><b>VAR   </b></font>tmp<font color="#000080">: </font>GenStr<font color="#000080">;
      </font>i<font color="#000080">:   </font>INTEGER<font color="#000080">;
      </font>ct<font color="#000080">:  </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>i  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>ct <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#FF0000"><b>WHILE </b></font>NameEntry<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font>CHR<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
     BEGIN
       </b></font>tmp<font color="#000080">[</font>i<font color="#000080">] := </font>NameEntry<font color="#000080">[</font>i<font color="#000080">];
       </font>i  <font color="#000080">:= </font>i  <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
       </font>ct <font color="#000080">:= </font>ct <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>tmp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>CHAR<font color="#000080">(</font>ct<font color="#000080">);
  </font>GetString <font color="#000080">:= </font>tmp<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Str2Az<font color="#000080">(</font>st<font color="#000080">: </font>GenStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>az<font color="#000080">; </font>size<font color="#000080">: </font>INTEGER<font color="#000080">);
</font><font color="#FF0000"><b>VAR  </b></font>p<font color="#000080">: ^</font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Fillchar<font color="#000080">(</font>az<font color="#000080">, </font>size<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font>p <font color="#000080">:= </font>ADDR<font color="#000080">(</font>st<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
  </font>Move<font color="#000080">(</font>p<font color="#000080">^, </font>az<font color="#000080">, </font>size<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DefaultRegs<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r<font color="#000080">: </font>Registers<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>DSeg<font color="#000080">;
  </font>r<font color="#000080">.</font>ES <font color="#000080">:= </font>DSeg<font color="#000080">;
</font><font color="#008000"><i>{ r.AX := 0;
  r.BX := 0;
  r.CX := 0;
  r.DX := 0;
  r.BP := 0;
  r.SI := 0;
  r.DI := 0; }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>FileServiceRequest<font color="#000080">( </font>func<font color="#000080">:            </font>BYTE<font color="#000080">;
                             </font><font color="#FF0000"><b>VAR </b></font>q<font color="#000080">; </font>qlen<font color="#000080">:     </font>WORD<font color="#000080">;
                             </font><font color="#FF0000"><b>VAR </b></font>reply<font color="#000080">; </font>rlen<font color="#000080">: </font>WORD<font color="#000080">): </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>DefaultRegs<font color="#000080">(</font>Regs<font color="#000080">);
  </font>Regs<font color="#000080">.</font>DS <font color="#000080">:= </font>Seg<font color="#000080">(</font>q<font color="#000080">);
  </font>Regs<font color="#000080">.</font>SI <font color="#000080">:= </font>Ofs<font color="#000080">(</font>q<font color="#000080">);
  </font>Regs<font color="#000080">.</font>CX <font color="#000080">:= </font>qlen<font color="#000080">;
  </font>Regs<font color="#000080">.</font>ES <font color="#000080">:= </font>Seg<font color="#000080">(</font>reply<font color="#000080">);
  </font>Regs<font color="#000080">.</font>DI <font color="#000080">:= </font>Ofs<font color="#000080">(</font>reply<font color="#000080">);
  </font>Regs<font color="#000080">.</font>DX <font color="#000080">:= </font>rlen<font color="#000080">;
  </font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$F2</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>AL <font color="#000080">:= </font>func<font color="#000080">;
  </font>MSDOS<font color="#000080">(</font>Regs<font color="#000080">);
  </font>FileServiceRequest <font color="#000080">:= </font>Regs<font color="#000080">.</font>AL<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>CallNetware<font color="#000080">(</font>RegAH <font color="#000080">: </font>BYTE<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>request<font color="#000080">, </font>reply<font color="#000080">): </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>DefaultRegs<font color="#000080">(</font>Regs<font color="#000080">);
  </font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font>RegAH<font color="#000080">;
  </font>Regs<font color="#000080">.</font>DS <font color="#000080">:= </font>Seg<font color="#000080">(</font>request<font color="#000080">);
  </font>Regs<font color="#000080">.</font>SI <font color="#000080">:= </font>Ofs<font color="#000080">(</font>request<font color="#000080">);
  </font>Regs<font color="#000080">.</font>ES <font color="#000080">:= </font>Seg<font color="#000080">(</font>reply<font color="#000080">);
  </font>Regs<font color="#000080">.</font>DI <font color="#000080">:= </font>Ofs<font color="#000080">(</font>reply<font color="#000080">);
  </font>MSDOS<font color="#000080">(</font>Regs<font color="#000080">);
  </font>CallNetware <font color="#000080">:= </font>Regs<font color="#000080">.</font>AL<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>UpcaseStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>s<font color="#000080">: </font>GenStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR  </b></font>i <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    Begin
    </b></font>s<font color="#000080">[</font>i<font color="#000080">] := </font>UpCase<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetServerMappingPtr <font color="#000080">: </font>ServerMappingPtr<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>TmpPtr<font color="#000080">: </font>ServerMappingPtr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>DefaultRegs<font color="#000080">(</font>Regs<font color="#000080">);
  </font>Regs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$EF03</font><font color="#000080">;
  </font>MSDOS<font color="#000080">(</font>Regs<font color="#000080">);
  </font>TmpPtr  <font color="#000080">:= </font>Ptr<font color="#000080">(</font>Regs<font color="#000080">.</font>ES<font color="#000080">, </font>Regs<font color="#000080">.</font>SI<font color="#000080">);
  </font>GetServerMappingPtr <font color="#000080">:= </font>TmpPtr<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetServerNamePtr <font color="#000080">: </font>ServerNamePtr<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>TmpPtr<font color="#000080">: </font>ServerNamePtr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>DefaultRegs<font color="#000080">(</font>Regs<font color="#000080">);
  </font>Regs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$EF04</font><font color="#000080">;
  </font>MSDOS<font color="#000080">(</font>Regs<font color="#000080">);
  </font>TmpPtr  <font color="#000080">:= </font>Ptr<font color="#000080">(</font>Regs<font color="#000080">.</font>ES<font color="#000080">, </font>Regs<font color="#000080">.</font>SI<font color="#000080">);
  </font>GetServerNamePtr <font color="#000080">:= </font>TmpPtr<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetServerNumber<font color="#000080">(</font>s<font color="#000080">: </font>NetStr<font color="#000080">): </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>t <font color="#000080">: </font>ServerNamePtr<font color="#000080">;
  </font>m <font color="#000080">: </font>ServerMappingPtr<font color="#000080">;
  </font>i <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>m <font color="#000080">:= </font>GetServerMappingPtr<font color="#000080">;
  </font>t <font color="#000080">:= </font>GetServerNamePtr<font color="#000080">;
  </font>UpCaseStr<font color="#000080">(</font>s<font color="#000080">);

  </font><font color="#FF0000"><b>FOR </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>MaxServers <font color="#FF0000"><b>DO BEGIN
    IF </b></font><font color="#000080">(</font>m<font color="#000080">^[</font>i<font color="#000080">].</font>SlotInUse <font color="#000080">= </font><font color="#800000">$FF</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>GetString<font color="#000080">(</font>t<font color="#000080">^[</font>i<font color="#000080">]) = </font>s<font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>GetServerNumber <font color="#000080">:= </font>i<font color="#000080">;
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>GetServerNumber <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>ReadPropertyValue<font color="#000080">(</font>ObjectType <font color="#000080">: </font>WORD<font color="#000080">; </font>ObjectName <font color="#000080">: </font>NetStr<font color="#000080">;
                        </font>Segnr <font color="#000080">: </font>BYTE<font color="#000080">; </font><font color="#FF0000"><b>Property </b></font><font color="#000080">: </font>NetStr<font color="#000080">;
                        </font><font color="#FF0000"><b>VAR </b></font>item<font color="#000080">): </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>req <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen <font color="#000080">: </font>WORD<font color="#000080">;
    </font>func <font color="#000080">: </font>BYTE<font color="#000080">;
    </font>otype <font color="#000080">: </font>WORD<font color="#000080">;
    </font>Filler <font color="#000080">: </font>GenStr<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>rep <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen <font color="#000080">: </font>WORD<font color="#000080">;
    </font>Data <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
    </font>More <font color="#000080">: </font>BYTE<font color="#000080">;
    </font>PropFlags <font color="#000080">: </font>BYTE<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>req<font color="#000080">.</font>func <font color="#000080">:= </font><font color="#800000">61</font><font color="#000080">;
  </font>req<font color="#000080">.</font>otype <font color="#000080">:= </font>Swap<font color="#000080">(</font>ObjectType<font color="#000080">);
  </font>req<font color="#000080">.</font>plen <font color="#000080">:= </font>Length<font color="#000080">(</font>ObjectName<font color="#000080">) +
              </font>Length<font color="#000080">(</font><font color="#FF0000"><b>Property</b></font><font color="#000080">) + </font><font color="#800000">6</font><font color="#000080">;
  </font>req<font color="#000080">.</font>filler <font color="#000080">:= </font>ObjectName <font color="#000080">+ </font>Char<font color="#000080">(</font>Segnr<font color="#000080">) +
                </font>Char<font color="#000080">(</font>Length<font color="#000080">(</font><font color="#FF0000"><b>Property</b></font><font color="#000080">)) +
                </font><font color="#FF0000"><b>Property</b></font><font color="#000080">;
  </font>req<font color="#000080">.</font>filler<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Char<font color="#000080">(</font>Length<font color="#000080">(</font>ObjectName<font color="#000080">));
  </font>rep<font color="#000080">.</font>plen <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>rep<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">;
  </font>ReadPropertyValue <font color="#000080">:= </font>CallNetware<font color="#000080">(</font><font color="#800000">$E3</font><font color="#000080">,</font>req<font color="#000080">,</font>rep<font color="#000080">);
  </font>Move<font color="#000080">(</font>rep<font color="#000080">.</font>data<font color="#000080">, </font>item<font color="#000080">, </font>SizeOf<font color="#000080">(</font>rep<font color="#000080">.</font>data<font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>InsertServer<font color="#000080">(</font>Name <font color="#000080">: </font>NetStr<font color="#000080">):</font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>MapPtr  <font color="#000080">: </font>ServerMappingPtr<font color="#000080">;
  </font>NamePtr <font color="#000080">: </font>ServerNamePtr<font color="#000080">;
  </font>res     <font color="#000080">: </font>BYTE<font color="#000080">;
  </font>free<font color="#000080">,</font>i  <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>data    <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">130</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>LowerAddr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>a<font color="#000080">, </font>b<font color="#000080">): </font>BOOLEAN<font color="#000080">;
  </font><font color="#FF0000"><b>TYPE
    </b></font>Net_Address <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>a_addr <font color="#000080">: </font>Net_Address <font color="#FF0000"><b>ABSOLUTE </b></font>a<font color="#000080">;
    </font>b_addr <font color="#000080">: </font>Net_Address <font color="#FF0000"><b>ABSOLUTE </b></font>b<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>LowerAddr <font color="#000080">:= </font>a_addr <font color="#000080">&lt; </font>b_addr<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>UpCaseStr<font color="#000080">(</font>Name<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>GetServerNumber<font color="#000080">(</font>Name<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
    </b></font>InsertServer <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>res <font color="#000080">:= </font>ReadPropertyValue<font color="#000080">(</font>FILE_SERVER<font color="#000080">, </font>name<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">'NET_ADDRESS'</font><font color="#000080">, </font>data<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>res <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
    </b></font>InsertServer <font color="#000080">:= </font><font color="#800000">$7D</font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>MapPtr <font color="#000080">:= </font>GetServerMappingPtr<font color="#000080">;
  </font>free <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>MapPtr<font color="#000080">^[</font>free<font color="#000080">].</font>SlotInUse <font color="#000080">= </font><font color="#800000">$FF</font><font color="#000080">) </font><font color="#FF0000"><b>DO BEGIN
    </b></font>free <font color="#000080">:= </font>free <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>free <font color="#000080">&gt; </font>MaxServers <font color="#FF0000"><b>THEN BEGIN
      </b></font>InsertServer <font color="#000080">:= </font><font color="#800000">$7C</font><font color="#000080">;
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>NamePtr <font color="#000080">:= </font>GetServerNamePtr<font color="#000080">;
  </font><font color="#FF0000"><b>WITH </b></font>MapPtr<font color="#000080">^[</font>free<font color="#000080">] </font><font color="#FF0000"><b>DO BEGIN
    </b></font>Move<font color="#000080">(</font>data<font color="#000080">, </font>ServerNet<font color="#000080">, </font><font color="#800000">12</font><font color="#000080">);
    </font>Str2Az<font color="#000080">(</font>name<font color="#000080">, </font>NamePtr<font color="#000080">^[</font>free<font color="#000080">], </font>SizeOf<font color="#000080">(</font>NamePtr<font color="#000080">^[</font>free<font color="#000080">]));
    </font>OrderNumber <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>MaxServers <font color="#FF0000"><b>DO BEGIN
      IF </b></font>MapPtr<font color="#000080">^[</font>i<font color="#000080">].</font>SlotInUse <font color="#000080">= </font><font color="#800000">$FF </font><font color="#FF0000"><b>THEN BEGIN
        IF </b></font>LowerAddr<font color="#000080">(</font>MapPtr<font color="#000080">^[</font>i<font color="#000080">].</font>ServerNet<font color="#000080">, </font>ServerNet<font color="#000080">) </font><font color="#FF0000"><b>THEN
          </b></font>OrderNumber <font color="#000080">:= </font>OrderNumber <font color="#000080">+ </font><font color="#800000">1
        </font><font color="#FF0000"><b>ELSE
          </b></font>MapPtr<font color="#000080">^[</font>i<font color="#000080">].</font>OrderNumber <font color="#000080">:= </font>MapPtr<font color="#000080">^[</font>i<font color="#000080">].</font>OrderNumber <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>SlotInUse <font color="#000080">:= </font><font color="#800000">$FF</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>InsertServer <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>AttachServerNumber<font color="#000080">(</font>func <font color="#000080">: </font>BYTE<font color="#000080">; </font>sn <font color="#000080">: </font>BYTE<font color="#000080">) : </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>DefaultRegs<font color="#000080">(</font>Regs<font color="#000080">);
  </font>Regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$F1</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>al <font color="#000080">:= </font>func<font color="#000080">;
  </font>Regs<font color="#000080">.</font>dl <font color="#000080">:= </font>sn<font color="#000080">;
  </font>MSDOS<font color="#000080">(</font>Regs<font color="#000080">);
  </font>AttachServerNumber <font color="#000080">:= </font>Regs<font color="#000080">.</font>al<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>AttachServer<font color="#000080">(</font>func <font color="#000080">: </font>BYTE<font color="#000080">; </font>name <font color="#000080">: </font>NetStr<font color="#000080">) : </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>sn <font color="#000080">: </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>sn <font color="#000080">:= </font>GetServerNumber<font color="#000080">(</font>name<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>sn <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
    </b></font>AttachServer <font color="#000080">:= </font><font color="#800000">$7B</font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>AttachServer <font color="#000080">:= </font>AttachServerNumber<font color="#000080">(</font>func<font color="#000080">,</font>sn<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>GetEffectiveServer<font color="#000080">:</font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>DefaultRegs<font color="#000080">(</font>Regs<font color="#000080">);
  </font>Regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$F002</font><font color="#000080">;
  </font>MSDOS<font color="#000080">(</font>Regs<font color="#000080">);
  </font>GetEffectiveServer <font color="#000080">:= </font>Regs<font color="#000080">.</font>al<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetPrimaryServer<font color="#000080">(</font>sno<font color="#000080">:</font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>DefaultRegs<font color="#000080">(</font>Regs<font color="#000080">);
  </font>Regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$F004</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>dl <font color="#000080">:= </font>sno<font color="#000080">;
  </font>MSDOS<font color="#000080">(</font>Regs<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetPrimaryServer<font color="#000080">:</font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>DefaultRegs<font color="#000080">(</font>Regs<font color="#000080">);
  </font>Regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$F005</font><font color="#000080">;
  </font>MSDOS<font color="#000080">(</font>Regs<font color="#000080">);
  </font>GetPrimaryServer <font color="#000080">:= </font>Regs<font color="#000080">.</font>al<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SetPreferredServer<font color="#000080">(</font>sno<font color="#000080">: </font>BYTE<font color="#000080">): </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>DefaultRegs<font color="#000080">(</font>Regs<font color="#000080">);
  </font>Regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$F000</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>dl <font color="#000080">:= </font>sno<font color="#000080">;
  </font>MSDOS<font color="#000080">(</font>Regs<font color="#000080">);
  </font>Regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$F001</font><font color="#000080">;
  </font>MSDOS<font color="#000080">(</font>Regs<font color="#000080">);
  </font>SetPreferredServer <font color="#000080">:= </font>Regs<font color="#000080">.</font>AL<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>MapNameToNumber<font color="#000080">(</font>ObjectType <font color="#000080">: </font>WORD<font color="#000080">;</font>ObjectName <font color="#000080">: </font>NetStr<font color="#000080">;
                         </font><font color="#FF0000"><b>VAR </b></font>ObjectID <font color="#000080">: </font>FourBytes<font color="#000080">): </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>req <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen <font color="#000080">: </font>WORD<font color="#000080">;
    </font>func <font color="#000080">: </font>BYTE<font color="#000080">;
    </font>otype <font color="#000080">: </font>WORD<font color="#000080">;
    </font>name <font color="#000080">: </font>NetStr<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>rep <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen <font color="#000080">: </font>WORD<font color="#000080">;
    </font>objID <font color="#000080">: </font>FourBytes<font color="#000080">;
    </font>otype <font color="#000080">: </font>WORD<font color="#000080">;
    </font>name <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">48</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>req<font color="#000080">.</font>func <font color="#000080">:= </font><font color="#800000">53</font><font color="#000080">;      </font><font color="#008000"><i>{Get an object's number}
  </i></font>req<font color="#000080">.</font>otype <font color="#000080">:= </font>Swap<font color="#000080">(</font>ObjectType<font color="#000080">);
  </font>req<font color="#000080">.</font>name <font color="#000080">:= </font>ObjectName<font color="#000080">;
  </font>req<font color="#000080">.</font>plen <font color="#000080">:= </font>Length<font color="#000080">(</font>ObjectName<font color="#000080">) + </font><font color="#800000">4</font><font color="#000080">;
  </font>rep<font color="#000080">.</font>plen <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>rep<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">;
  </font>MapNameToNumber <font color="#000080">:= </font>CallNetware<font color="#000080">(</font><font color="#800000">$E3</font><font color="#000080">, </font>req<font color="#000080">, </font>rep<font color="#000080">);
  </font>ObjectID <font color="#000080">:= </font>rep<font color="#000080">.</font>objID<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>MapNumberToName<font color="#000080">(</font>ID <font color="#000080">: </font>FourBytes<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Name<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Otype <font color="#000080">: </font>WORD<font color="#000080">):</font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>req <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen <font color="#000080">: </font>WORD<font color="#000080">;
    </font>func <font color="#000080">: </font>BYTE<font color="#000080">;
    </font>OID  <font color="#000080">: </font>FourBytes<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>rep <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen  <font color="#000080">: </font>WORD<font color="#000080">;
    </font>OID   <font color="#000080">: </font>FourBytes<font color="#000080">;
    </font>otyp  <font color="#000080">: </font>WORD<font color="#000080">;
    </font>Oname <font color="#000080">: </font>ServerItem<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>nam <font color="#000080">: </font>NetStr <font color="#FF0000"><b>ABSOLUTE </b></font>Name<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>req<font color="#000080">.</font>func <font color="#000080">:= </font><font color="#800000">54</font><font color="#000080">;      </font><font color="#008000"><i>{Get an object's name}
  </i></font>req<font color="#000080">.</font>OID <font color="#000080">:= </font>ID<font color="#000080">;
  </font>req<font color="#000080">.</font>plen <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>req<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">;
  </font>rep<font color="#000080">.</font>plen <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>rep<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">;
  </font>MapNumberToName <font color="#000080">:= </font>CallNetware<font color="#000080">(</font><font color="#800000">$E3</font><font color="#000080">,</font>req<font color="#000080">,</font>rep<font color="#000080">);
  </font>Nam <font color="#000080">:= </font>GetString<font color="#000080">(</font>rep<font color="#000080">.</font>OName<font color="#000080">);
  </font>Otype<font color="#000080">:= </font>Swap<font color="#000080">(</font>rep<font color="#000080">.</font>Otyp<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LoginAnObject<font color="#000080">( </font>Name<font color="#000080">:</font>NetStr<font color="#000080">; </font>Otype<font color="#000080">:</font>WORD<font color="#000080">; </font>Passw<font color="#000080">: </font>NetStr<font color="#000080">):</font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>req <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen <font color="#000080">: </font>WORD<font color="#000080">;
    </font>func <font color="#000080">: </font>BYTE<font color="#000080">;
    </font>otype <font color="#000080">: </font>WORD<font color="#000080">;
    </font>NamePass <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">96</font><font color="#000080">];
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>rep <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen <font color="#000080">: </font>WORD<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>req<font color="#000080">.</font>plen <font color="#000080">:= </font><font color="#800000">5 </font><font color="#000080">+ </font>Length<font color="#000080">(</font>Name<font color="#000080">) + </font>Length<font color="#000080">(</font>Passw<font color="#000080">);
  </font>req<font color="#000080">.</font>func <font color="#000080">:= </font><font color="#800000">20</font><font color="#000080">;
  </font>UpCaseStr<font color="#000080">(</font>Passw<font color="#000080">);
  </font>UpCaseStr<font color="#000080">(</font>Name<font color="#000080">);
  </font>req<font color="#000080">.</font>otype <font color="#000080">:= </font>Swap<font color="#000080">(</font>otype<font color="#000080">);
  </font>req<font color="#000080">.</font>NamePass<font color="#000080">:=</font>Name<font color="#000080">;
  </font>Move<font color="#000080">(</font>Passw<font color="#000080">, </font>req<font color="#000080">.</font>NamePass<font color="#000080">[</font>Length<font color="#000080">(</font>Name<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">], </font>Length<font color="#000080">(</font>Passw<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
  </font>rep<font color="#000080">.</font>plen <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>LoginAnObject <font color="#000080">:= </font>CallNetware<font color="#000080">(</font><font color="#800000">$E3</font><font color="#000080">, </font>req<font color="#000080">, </font>rep<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LoginUser<font color="#000080">(</font>Name<font color="#000080">, </font>Password<font color="#000080">: </font>NetStr<font color="#000080">): </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>req <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen <font color="#000080">: </font>INTEGER<font color="#000080">;
    </font>func <font color="#000080">: </font>BYTE<font color="#000080">;
    </font>NamePass <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">96</font><font color="#000080">];
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>rep <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>req<font color="#000080">.</font>plen <font color="#000080">:= </font><font color="#800000">3 </font><font color="#000080">+ </font>Length<font color="#000080">(</font>Name<font color="#000080">) + </font>Length<font color="#000080">(</font>Password<font color="#000080">);
  </font>req<font color="#000080">.</font>func <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>UpcaseStr<font color="#000080">(</font>Password<font color="#000080">);
  </font>UpcaseStr<font color="#000080">(</font>Name<font color="#000080">);
  </font>req<font color="#000080">.</font>NamePass <font color="#000080">:= </font>Name<font color="#000080">;
  </font>Move<font color="#000080">(</font>Password<font color="#000080">, </font>req<font color="#000080">.</font>NamePass<font color="#000080">[</font>Length<font color="#000080">(</font>Name<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">], </font>Length<font color="#000080">(</font>Password<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
  </font>rep<font color="#000080">.</font>plen <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>LoginUser <font color="#000080">:= </font>CallNetware<font color="#000080">(</font><font color="#800000">$E3</font><font color="#000080">, </font>req<font color="#000080">, </font>rep<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetEncryptionKey<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>key <font color="#000080">: </font>Buf8<font color="#000080">): </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>q <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen <font color="#000080">: </font>WORD<font color="#000080">;
    </font>func <font color="#000080">: </font>BYTE<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>q<font color="#000080">.</font>plen <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>q<font color="#000080">.</font>func <font color="#000080">:= </font><font color="#800000">$17</font><font color="#000080">;
  </font>GetEncryptionKey <font color="#000080">:= </font>FileServiceRequest<font color="#000080">(</font><font color="#800000">$17</font><font color="#000080">, </font>q<font color="#000080">, </font>SizeOf<font color="#000080">(</font>q<font color="#000080">), </font>key<font color="#000080">, </font>SizeOf<font color="#000080">(</font>key<font color="#000080">));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LoginEncrypted<font color="#000080">(</font>name <font color="#000080">: </font>NetStr<font color="#000080">; </font>otype <font color="#000080">: </font>WORD<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>key <font color="#000080">: </font>Buf8<font color="#000080">): </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>a <font color="#000080">: </font><font color="#FF0000"><b>RECORD
    </b></font>plen <font color="#000080">: </font>WORD<font color="#000080">;
    </font>func <font color="#000080">: </font>BYTE<font color="#000080">;
    </font>key  <font color="#000080">: </font>Buf8<font color="#000080">;
    </font>otyp <font color="#000080">: </font>WORD<font color="#000080">;
    </font>name <font color="#000080">: </font>NetStr<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>a<font color="#000080">.</font>plen <font color="#000080">:= </font>Length<font color="#000080">(</font>name<font color="#000080">) + </font><font color="#800000">12</font><font color="#000080">;
  </font>a<font color="#000080">.</font>func <font color="#000080">:= </font><font color="#800000">$18</font><font color="#000080">;
  </font>a<font color="#000080">.</font>key  <font color="#000080">:= </font>key<font color="#000080">;
  </font>a<font color="#000080">.</font>otyp <font color="#000080">:= </font>Swap<font color="#000080">(</font>otype<font color="#000080">);
  </font>a<font color="#000080">.</font>name <font color="#000080">:= </font>name<font color="#000080">;
  </font>LoginEncrypted <font color="#000080">:= </font>FileServiceRequest<font color="#000080">(</font><font color="#800000">$17</font><font color="#000080">, </font>a<font color="#000080">, </font>Length<font color="#000080">(</font>name<font color="#000080">)+</font><font color="#800000">14</font><font color="#000080">, </font>Mem<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Shuffle1<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>temp <font color="#000080">: </font>Buf32<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>target<font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>t  <font color="#000080">:  </font>Buf16 <font color="#FF0000"><b>ABSOLUTE </b></font>target<font color="#000080">;
  </font>b4 <font color="#000080">:  </font>WORD<font color="#000080">;
  </font>b3 <font color="#000080">:  </font>BYTE<font color="#000080">;
  </font>s<font color="#000080">, </font>d<font color="#000080">, </font>b2<font color="#000080">, </font>i <font color="#000080">: </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>b4 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>b2 <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">1 </font><font color="#FF0000"><b>DO BEGIN
    FOR </b></font>s <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">31 </font><font color="#FF0000"><b>DO BEGIN
      </b></font>b3 <font color="#000080">:= </font>Lo<font color="#000080">(</font>Lo<font color="#000080">(</font>temp<font color="#000080">[</font>s<font color="#000080">] + </font>b4<font color="#000080">)
            </font><font color="#FF0000"><b>XOR </b></font>Lo<font color="#000080">(</font>temp<font color="#000080">[(</font>s <font color="#000080">+ </font>b4<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">31</font><font color="#000080">]
          - </font>EncryptKeys<font color="#000080">[</font>s<font color="#000080">]));
      </font>b4 <font color="#000080">:= </font>b4 <font color="#000080">+ </font>b3<font color="#000080">;
      </font>temp<font color="#000080">[</font>s<font color="#000080">] := </font>b3<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">15 </font><font color="#FF0000"><b>DO
    </b></font>t<font color="#000080">[</font>i<font color="#000080">] := </font>EncryptTable<font color="#000080">[</font>temp<font color="#000080">[</font>i <font color="#FF0000"><b>Shl </b></font><font color="#800000">1</font><font color="#000080">]]
        </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>EncryptTable<font color="#000080">[</font>temp<font color="#000080">[</font>i <font color="#FF0000"><b>Shl </b></font><font color="#800000">1 </font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]] </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">4</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Shuffle<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>lon<font color="#000080">, </font>buf<font color="#000080">; </font>buflen <font color="#000080">: </font>WORD<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>target<font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>l <font color="#000080">: </font>Buf4 <font color="#FF0000"><b>ABSOLUTE </b></font>lon<font color="#000080">;
  </font>b <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">127</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE <font color="#FF0000"><b>ABSOLUTE </b></font>buf<font color="#000080">;
  </font>b2 <font color="#000080">: </font>WORD<font color="#000080">;
  </font>temp <font color="#000080">: </font>Buf32<font color="#000080">;
  </font>s<font color="#000080">, </font>d <font color="#000080">: </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>buflen <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
     WHILE </b></font><font color="#000080">(</font>buflen <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>b<font color="#000080">[</font>buflen<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
       </b></font>buflen <font color="#000080">:= </font>buflen <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;

  </font>FillChar<font color="#000080">(</font>temp<font color="#000080">, </font>SizeOf<font color="#000080">(</font>temp<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);

  </font>d <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>WHILE </b></font>buflen <font color="#000080">&gt;= </font><font color="#800000">32 </font><font color="#FF0000"><b>DO BEGIN
    FOR </b></font>s <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">31 </font><font color="#FF0000"><b>DO BEGIN
      </b></font>temp<font color="#000080">[</font>s<font color="#000080">] := </font>temp<font color="#000080">[</font>s<font color="#000080">] </font><font color="#FF0000"><b>XOR </b></font>b<font color="#000080">[</font>d<font color="#000080">];
      </font>d <font color="#000080">:= </font>d <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>buflen <font color="#000080">:= </font>buflen <font color="#000080">- </font><font color="#800000">32</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>b2 <font color="#000080">:= </font>d<font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font>buflen <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
    FOR </b></font>s <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">31 </font><font color="#FF0000"><b>DO BEGIN
      IF </b></font>d <font color="#000080">+ </font>buflen <font color="#000080">= </font>b2 <font color="#FF0000"><b>THEN BEGIN
        </b></font>b2 <font color="#000080">:= </font>d<font color="#000080">;
        </font>temp<font color="#000080">[</font>s<font color="#000080">] := </font>temp<font color="#000080">[</font>s<font color="#000080">] </font><font color="#FF0000"><b>XOR </b></font>EncryptKeys<font color="#000080">[</font>s<font color="#000080">];
      </font><font color="#FF0000"><b>END
      ELSE BEGIN
        </b></font>temp<font color="#000080">[</font>s<font color="#000080">] := </font>temp<font color="#000080">[</font>s<font color="#000080">] </font><font color="#FF0000"><b>XOR </b></font>b<font color="#000080">[</font>b2<font color="#000080">];
        </font>b2 <font color="#000080">:= </font>b2 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>s <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">31 </font><font color="#FF0000"><b>DO
    </b></font>temp<font color="#000080">[</font>s<font color="#000080">] := </font>temp<font color="#000080">[</font>s<font color="#000080">] </font><font color="#FF0000"><b>XOR </b></font>l<font color="#000080">[</font>s <font color="#FF0000"><b>AND </b></font><font color="#800000">3</font><font color="#000080">];

  </font>Shuffle1<font color="#000080">(</font>temp<font color="#000080">, </font>target<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Encrypt<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>fra<font color="#000080">, </font>buf<font color="#000080">, </font>til<font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>f <font color="#000080">: </font>Buf8  <font color="#FF0000"><b>ABSOLUTE </b></font>fra<font color="#000080">;
  </font>t <font color="#000080">: </font>Buf8  <font color="#FF0000"><b>ABSOLUTE </b></font>til<font color="#000080">;
  </font>k <font color="#000080">: </font>Buf32<font color="#000080">;
  </font>s <font color="#000080">: </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Shuffle<font color="#000080">(</font>f<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>buf<font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font>k<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
  </font>Shuffle<font color="#000080">(</font>f<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">], </font>buf<font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font>k<font color="#000080">[</font><font color="#800000">16</font><font color="#000080">]);
  </font><font color="#FF0000"><b>FOR </b></font>s <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">15 </font><font color="#FF0000"><b>DO
    </b></font>k<font color="#000080">[</font>s<font color="#000080">] := </font>k<font color="#000080">[</font>s<font color="#000080">] </font><font color="#FF0000"><b>XOR </b></font>k<font color="#000080">[</font><font color="#800000">31</font><font color="#000080">-</font>s<font color="#000080">];
  </font><font color="#FF0000"><b>FOR </b></font>s <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">7 </font><font color="#FF0000"><b>DO
    </b></font>t<font color="#000080">[</font>s<font color="#000080">] := </font>k<font color="#000080">[</font>s<font color="#000080">] </font><font color="#FF0000"><b>XOR </b></font>k<font color="#000080">[</font><font color="#800000">15</font><font color="#000080">-</font>s<font color="#000080">];
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LoginToFileServer<font color="#000080">(</font>name<font color="#000080">: </font>NetStr<font color="#000080">; </font>otype<font color="#000080">: </font>WORD<font color="#000080">; </font>passw<font color="#000080">: </font>GenStr<font color="#000080">): </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>key <font color="#000080">: </font>Buf8<font color="#000080">;
  </font>id  <font color="#000080">: </font>FourBytes<font color="#000080">;
  </font>buf <font color="#000080">: </font>Buf32<font color="#000080">;
  </font>res <font color="#000080">: </font>BYTE<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>UpCaseStr<font color="#000080">(</font>passw<font color="#000080">);
  </font>res <font color="#000080">:= </font>GetEncryptionKey<font color="#000080">(</font>key<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>res <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
    </b></font>res <font color="#000080">:= </font>MapNameToNumber<font color="#000080">(</font>otype<font color="#000080">, </font>name<font color="#000080">, </font>id<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>res <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>Shuffle<font color="#000080">(</font>id<font color="#000080">, </font>passw<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Length<font color="#000080">(</font>passw<font color="#000080">), </font>buf<font color="#000080">);
      </font>Encrypt<font color="#000080">(</font>key<font color="#000080">, </font>buf<font color="#000080">, </font>key<font color="#000080">);
      </font>res <font color="#000080">:= </font>LoginEncrypted<font color="#000080">(</font>name<font color="#000080">, </font>otype<font color="#000080">, </font>key<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END
  ELSE BEGIN
    </b></font>res <font color="#000080">:= </font>LoginAnObject<font color="#000080">(</font>name<font color="#000080">, </font>otype<font color="#000080">, </font>passw<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>LoginToFileServer <font color="#000080">:= </font>res<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Login<font color="#000080">(</font>Sname<font color="#000080">, </font>OName <font color="#000080">: </font>NetStr<font color="#000080">; </font>OType <font color="#000080">: </font>WORD<font color="#000080">; </font>Passw <font color="#000080">: </font>NetStr<font color="#000080">) : </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>sn<font color="#000080">, </font>res<font color="#000080">, </font>rc <font color="#000080">: </font>BYTE<font color="#000080">;
  </font>Curr_Server <font color="#000080">: </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>UpCaseStr<font color="#000080">(</font>SName<font color="#000080">);
  </font>sn <font color="#000080">:= </font>GetServerNumber<font color="#000080">(</font>Sname<font color="#000080">);

  </font><font color="#FF0000"><b>IF </b></font>sn <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
    </b></font>res <font color="#000080">:= </font>InsertServer<font color="#000080">(</font>SName<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>res <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>Login <font color="#000080">:= </font>res<font color="#000080">;
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>sn <font color="#000080">:= </font>GetServerNumber<font color="#000080">(</font>SName<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>res <font color="#000080">:= </font>AttachServerNumber<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>sn<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>res <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
    </b></font>Login <font color="#000080">:= </font>res<font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>Curr_Server <font color="#000080">:= </font>GetEffectiveServer<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>SetPreferredServer<font color="#000080">(</font>sn<font color="#000080">) = </font>sn <font color="#FF0000"><b>THEN
    </b></font>rc <font color="#000080">:= </font>LoginToFileServer<font color="#000080">(</font>OName<font color="#000080">, </font>Otype<font color="#000080">, </font>Passw<font color="#000080">)
  </font><font color="#FF0000"><b>ELSE
    </b></font>rc <font color="#000080">:= </font><font color="#800000">$7A</font><font color="#000080">;

  </font>res <font color="#000080">:= </font>SetPreferredServer<font color="#000080">(</font>Curr_Server<font color="#000080">);
  </font>Login <font color="#000080">:= </font>rc<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  IF </b></font>ParamCount <font color="#000080">&lt;&gt; </font><font color="#800000">3 </font><font color="#FF0000"><b>THEN BEGIN
     </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Please supply server name, your user id, and a password.'</font><font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>rc <font color="#000080">:= </font>Login<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">), </font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">), </font>NET_USER<font color="#000080">, </font>ParamStr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">));

  </font><font color="#FF0000"><b>IF </b></font>rc <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
     </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Login failed.'</font><font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0023.PAS">Original</a><b>]</b></p></body>
</html>
