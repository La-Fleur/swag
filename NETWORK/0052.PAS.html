<html>
<head><title> "TENTOOLS module for network support" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0052.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000"> <font color="#008000"><i>{
 Program Name : Tentools.Pas
 Written By   : Anonymous
 E-Mail       : nothing
 Web Page     : nothing
 Program
 Compilation  : Turbo Pascal 5.0 or later

 Program Description :

 Usefulness for BBS'S and general communications.
 For a detailed description of this code source, please,
 read the file TENTOOLS.DOC. Thank you
 }

{$F+}
</i></font><font color="#FF0000"><b>Unit </b></font>TenTools<font color="#000080">;  </font><font color="#008000"><i>{ SEE TENTOOLS.DOC for more information !! }

</i></font><font color="#FF0000"><b>Interface

Uses </b></font>DOS<font color="#000080">,</font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>CONST
   </b></font>TNTI <font color="#000080">: </font>Boolean <font color="#000080">= </font>False<font color="#000080">; </font><font color="#008000"><i>{Initialized False, this Boolean tells whether the
                     the initialization procedure has been run successfully.}
   </i></font>HPointer <font color="#000080">: </font>Integer <font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;
  </font>TPointer <font color="#000080">: </font>Integer <font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;
   </font>CPointer <font color="#000080">: </font>Integer <font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;

</font><font color="#008000"><i>{ The next three parameters can be set dynamically using the
  TenConfig Function}
                                          </i></font>MaxSendBufferSize <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;  </font><font color="#008000"><i>{Size of largest record to TBsend}
   </i></font>MaxRecBufferSize <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;  </font><font color="#008000"><i>{Size of largest record to TBreceive}
   </i></font>MaxReceives <font color="#000080">: </font>Integer <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;   </font><font color="#008000"><i>{Number of TBReceives to buffer}

{This parameter will change if TenConfig is called with new MAXRECBUFFERSIZE}

{   MaxRecvSets = MaxRecBufferSize div 457 + 1; }

   </i></font>MAXRCVWAIT <font color="#000080">: </font>Integer <font color="#000080">= </font><font color="#800000">30</font><font color="#000080">; </font><font color="#008000"><i>{Can be changed through SetWait function}

   </i></font>SCLim <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer <font color="#000080">= (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">99</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">);
   </font>SCMon <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">= (</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">);
   </font>SCMin <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer <font color="#000080">= (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);

</font><font color="#FF0000"><b>TYPE

   </b></font>PW8 <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;              </font><font color="#008000"><i>{Used for 8 character password  }
   </i></font>SID <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;             </font><font color="#008000"><i>{Used for 12 character serverID }
   </i></font>S8 <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];
   </font>String80 <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
   </font>S12 <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
   </font>S15 <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">15</font><font color="#000080">];
   </font>TID <font color="#000080">= </font>Real<font color="#000080">;
   </font>TStamp <font color="#000080">= </font>Real<font color="#000080">;
   </font>RcvBlock <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">457</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
   </font>MAXBytes <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65521</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
   </font>ChatBytes <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
   </font>PathString <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">128</font><font color="#000080">];
   </font>NotifyTypes <font color="#000080">= (</font>Start<font color="#000080">,</font>Reply<font color="#000080">,</font>Completion<font color="#000080">,</font>ExplQueue<font color="#000080">,</font>NoFF<font color="#000080">,</font>IDPage<font color="#000080">,</font>QueueTop<font color="#000080">);
   </font>NotifySet <font color="#000080">= </font><font color="#FF0000"><b>Set of </b></font>NotifyTypes<font color="#000080">;

</font><font color="#008000"><i>{The Pre-Configuration Table and the Configuration Table are the Internal
 Structures within 10Net's Data Segment. These Tables provide information
 that is necessary for some of the functions in this toolbox. They are
 already allocated by 10Net when it is loaded and add no extra memory usage
 to the toolbox. }
   </i></font>PreConfigurationTable <font color="#000080">=
   </font><font color="#FF0000"><b>Record
      </b></font><font color="#008000"><i>{First variable located at CTAB-51 bytes or PreCTAB }
      </i></font>PCT_PhyAddr <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;   </font><font color="#008000"><i>{Physical Adapter Address       }
      </i></font>PCT_NPID    <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{NPID Table Address             }
      </i></font>PCT_NCBFST  <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{First NCB in Pool              }
      </i></font>PCT_LDEVTAB <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{Local Dev Table Addr(FOXCOM)   }
      </i></font>PCT_EXT_MAP <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{Extended Network Err Table Addr}
      </i></font>PCT_SDEVTAB <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{SDEV Address                   }
      </i></font>PCT_RESV1   <font color="#000080">: </font>Integer<font color="#000080">;
      </font>PCT_RBUFCNT <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Receive Buffer Counter         }
      </i></font>PCT_CBUF_CNT<font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Collect Buffer Counter         }
      </i></font>PCT_TUF     <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{TUF Address                    }
      </i></font>PCT_ENABLE  <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Enable Flag                    }
      </i></font>PCT_KEEP    <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{FCB Keep Flag                  }
      </i></font>PCT_RESV2   <font color="#000080">: </font>Integer<font color="#000080">;
      </font>PCT_DS6F    <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{Dropped Send 6F Count          }
      </i></font>PCT_BFRST   <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{Buffer Chain                   }
      </i></font>PCT_RESV3   <font color="#000080">: </font>Integer<font color="#000080">;
      </font>PCT_RTY     <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{Broadcast Retry Count          }
      </i></font>PCT_TOVAL   <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{#FFFF Loops before retry       }
      </i></font>PCT_UFH     <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{UFH Address                    }
      </i></font>PCT_NETH    <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{NetH Address                   }
      </i></font>PCT_LTAB    <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{LTab Address                   }
      </i></font>PCT_SFH     <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{SFH Address                    }
      </i></font>PCT_FTAB    <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{FTAB Address                   }
      </i></font>PCT_RLTAB   <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{RLTAB Address                  }
      </i></font>PCT_SMI     <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{Semaphore Address              }
      </i></font>PCT_NTAB    <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{NTAB Address                   }
     </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font>ConfigurationTable <font color="#000080">=
      </font><font color="#FF0000"><b>Record
      </b></font>CT_REDIR    <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{Redirection Table Address      }
                                           {sometimes called CT_ADDR       }
      </i></font>CT_NUM      <font color="#000080">: </font>Byte<font color="#000080">;               </font><font color="#008000"><i>{RDR_TAB Entries- 5(LPT1-3 &amp; AUX-2)}
      </i></font>CT_LNAME    <font color="#000080">: </font>PW8<font color="#000080">;                   </font><font color="#008000"><i>{Login Name                     }
      </i></font>CT_NID      <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;  </font><font color="#008000"><i>{Node ID                        }
      </i></font>CT_UNODE    <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;   </font><font color="#008000"><i>{Unique portion of Node Address }
      </i></font>CT_FLG      <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Flag (DPC - Bit 6)             }
      </i></font>CT_CFLG     <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Chat permit flag               }
      </i></font>CT_PSFLG    <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Print and Submit Flag          }
      </i></font>CT_NETFLGS  <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;   </font><font color="#008000"><i>{10Net System Status Flag       }
      </i></font>CT_L_INT    <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Last Interrupt                 }
      </i></font>CT_L21      <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Last Interrupt 21              }
      </i></font>CT_L6F      <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Last Interrupt 6F              }
      </i></font>CT_L60      <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Last Interrupt 60              }
      </i></font>CT_BFLG     <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Break Flag                     }
      </i></font>CT_BTYP     <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{Break Type                     }
      </i></font>CT_TALY     <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;</font><font color="#008000"><i>{Send Tallies                   }

      </i></font>CT_PENDF    <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{DO_COND Pending COMMAND MAP    }
      </i></font>CT_CERRF    <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Reserved                       }

      </i></font>CT_RESV2    <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;   </font><font color="#008000"><i>{Reserved                       }

      </i></font>CT_CB       <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{CB Channel                     }
      </i></font>CT_CBCNT    <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Send6F on Que                  }
      </i></font>CT_CBCHL    <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;   </font><font color="#008000"><i>{Chnls 1-9 Activity             }
      </i></font>CT_GATE     <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Bits: 1-RS232Gate, 2-Send6FGate}
      </i></font>CT_RGATE    <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;</font><font color="#008000"><i>{Dbl word ptr into Gate         }
      </i></font>CT_SGATE    <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;</font><font color="#008000"><i>{Dbl word ptr into 10Net Send   }
      </i></font>CT_TIMR     <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{Address of Timer Blocks        }

      {Those variables below are only implemented in 10Net 4.1 and above}
      </i></font>CT_CTSTO    <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{Datagram send time out value   }
      </i></font>CT_DGRETRY  <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Datagram retry count           }
      </i></font>CT_NCBMSES  <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Max Netbios sessions           }
      </i></font>CT_NCBMCOMM <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Max Netbios command blocks     }
      </i></font>CT_BUFFNUM  <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Number of total buffers        }
      </i></font>CT_CLCTNUM  <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Number of Collect buffers      }
      </i></font>CT_CLCTFST  <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{Offs of 1st coll. buffer chain }
      </i></font>CT_DEVMASK  <font color="#000080">: </font>Word<font color="#000080">;                  </font><font color="#008000"><i>{Shared disk drives bit mask    }
      </i></font>CT_DEVPRN   <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Shared LPT bit mask            }
      </i></font>CT_DEVCOM   <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Shared COM bit mask            }
      </i></font>CT_RESV3    <font color="#000080">: </font>LongInt<font color="#000080">;               </font><font color="#008000"><i>{Reserved}
      </i></font>CT_DOSVER   <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{Dos Version(Int21/30)          }
      </i></font>CT_PHYSDRVS <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Number of physical drives      }
      </i></font>CT_RESV4    <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">13</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;  </font><font color="#008000"><i>{Reserved}
      </i></font>CT_SRVNUM   <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Server NCB Name Number         }
      </i></font>CT_RDRNUM   <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Redirector NCB Name Number     }
      </i></font>CT_MSGNUM   <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{Messenger NCB Name Number      }
      </i></font>CT_RESV5    <font color="#000080">: </font>LongInt<font color="#000080">;               </font><font color="#008000"><i>{Reserved}
      </i></font>CT_CHATCALL <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{Chat Call Key                  }
      </i></font>CT_CHATIME  <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{Chat Time Out                  }
      </i></font>CT_AUTOSP1  <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{AutoSP Flag (0=No AutoSp)      }
      </i></font>CT_AUTOSP2  <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{TMR_TIC=CT_AutoSP1*Ct_AutoSP2  }
   </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{ What follows are structures used in function calls}

   </i></font>TenNetTableRec <font color="#000080">= </font><font color="#FF0000"><b>Record
       </b></font>Alloc <font color="#000080">: </font>Integer<font color="#000080">;
        </font>Free <font color="#000080">: </font>Integer<font color="#000080">;
    </font>Reserved <font color="#000080">: </font>Integer<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>GetTableDataRec <font color="#000080">= </font><font color="#FF0000"><b>Record
           </b></font>NodeID <font color="#000080">: </font>SID<font color="#000080">;
           </font>RES1   <font color="#000080">: </font>Byte<font color="#000080">;
       </font>ServerFlag <font color="#000080">: </font>Byte<font color="#000080">;                  </font><font color="#008000"><i>{ 0=Worker, 1=Server           }
       </i></font>BufferSize <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{ Size of Receive Buffers      }
      </i></font>TotalMemory <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{ Total RAM memory in K        }
      </i></font>TenNetMemory <font color="#000080">: </font>LongInt<font color="#000080">;               </font><font color="#008000"><i>{ Memory alloc. to 10Net (bytes}
      </i></font>AvailMemory <font color="#000080">: </font>LongInt<font color="#000080">;               </font><font color="#008000"><i>{ Available Memory in Bytes    }
      </i></font>TenNetTables <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">22</font><font color="#000080">] </font><font color="#FF0000"><b>of
                    </b></font>TenNetTableRec<font color="#000080">;
       </font>DeviceList <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">64</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
       </font>SecurityFN <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">64</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
          </font>AuditFN <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">64</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
     </font>PrimaryDrive <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
        </font>OtherJunk <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">48</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>LogRec <font color="#000080">= </font><font color="#FF0000"><b>Record
      </b></font>UserName <font color="#000080">: </font>PW8<font color="#000080">;
      </font>PassWord <font color="#000080">: </font>PW8<font color="#000080">;
      </font>NodeName <font color="#000080">: </font>SID<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>SendFormat <font color="#000080">= </font><font color="#FF0000"><b>Record
      </b></font>RNode <font color="#000080">: </font>SID<font color="#000080">;
      </font>DataBytes <font color="#000080">: </font>Integer<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font>PRec <font color="#000080">= </font><font color="#FF0000"><b>Record
      </b></font>TransID <font color="#000080">: </font>TID<font color="#000080">;     </font><font color="#008000"><i>{6 bytes}
       </i></font>Packet <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{1}
     </i></font>TPackets <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{1}
        </i></font>TType <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{2}
      </i></font>TLength <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{2}
     </i></font>RespType <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{1}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>RecSet <font color="#000080">= </font><font color="#FF0000"><b>set of </b></font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">144</font><font color="#000080">;

   </font>DateTimeRec <font color="#000080">= </font><font color="#FF0000"><b>Record
           </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Second <font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font>RecvRec <font color="#000080">= </font><font color="#FF0000"><b>Record
       </b></font>Sender <font color="#000080">: </font>S12<font color="#000080">;
      </font>TransID <font color="#000080">: </font>TID<font color="#000080">;
    </font>TrackRecv <font color="#000080">: </font>RecSet<font color="#000080">;
        </font>TType <font color="#000080">: </font>Integer<font color="#000080">;
      </font>TLength <font color="#000080">: </font>Integer<font color="#000080">;
     </font>RespType <font color="#000080">: </font>Byte<font color="#000080">;
        </font>RTime <font color="#000080">: </font>Real<font color="#000080">;
           </font>CB <font color="#000080">: </font>Boolean<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>RecvData <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">143</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>RcvBlock<font color="#000080">;


   </font>HeapRecBlock <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1310</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>RecvRec<font color="#000080">;
   </font>HeapDataBlock <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2040</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font><font color="#000080">^</font>RecvData<font color="#000080">;

   </font>ChRec <font color="#000080">= </font><font color="#FF0000"><b>Record
        </b></font>MsgLength <font color="#000080">: </font>Integer<font color="#000080">;
        </font>ChatText <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">101</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>NodeRec <font color="#000080">= </font><font color="#FF0000"><b>Record
        </b></font>NID <font color="#000080">: </font>SID<font color="#000080">;
        </font>NT <font color="#000080">: </font>Byte<font color="#000080">;
        </font>UID <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
        </font>Ver <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>NARec <font color="#000080">= </font>S12<font color="#000080">;
   </font>NWRec <font color="#000080">= </font><font color="#FF0000"><b>Record
        </b></font>NID <font color="#000080">: </font>SID<font color="#000080">;
        </font>Ver <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>NBuffer <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">140</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>NodeRec<font color="#000080">;
   </font>NABuffer <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">140</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>NARec<font color="#000080">;
   </font>NWBuffer <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">140</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>NWRec<font color="#000080">;

   </font>SDRec <font color="#000080">= </font><font color="#FF0000"><b>Record             </b></font><font color="#008000"><i>{MountList/NetUse List Record Structure}
         </i></font>ServerID <font color="#000080">: </font>S12<font color="#000080">;
          </font>RPath <font color="#000080">: </font>PathString<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>DriveArray <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>SDRec<font color="#000080">;

   </font>PrintArray <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">'1'</font><font color="#000080">..</font><font color="#800000">'3'</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>SDRec<font color="#000080">;

   </font>LogArray <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">19</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>S12<font color="#000080">;
   </font>DeviceArray <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">24</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>S8<font color="#000080">;
   </font>SDev <font color="#000080">= </font><font color="#FF0000"><b>Record         </b></font><font color="#008000"><i>{used in Get/Set/Delete/Get User Shared Device}
        </i></font>Alias <font color="#000080">: </font>PW8<font color="#000080">;
        </font>Path <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">64</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
        </font>PassWord <font color="#000080">: </font>PW8<font color="#000080">;
        </font>Access <font color="#000080">: </font>Byte<font color="#000080">;
        </font>Mask <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


  </font>StatusBlock <font color="#000080">= </font><font color="#FF0000"><b>Record
      </b></font>S_Name <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;  </font><font color="#008000"><i>{User Name}
      </i></font>S_Flag <font color="#000080">: </font>Byte<font color="#000080">;                 </font><font color="#008000"><i>{0-user node,1-superstation,2-gate,
                                      3-gateactive,4-on more than 2 superstns,
                                      5-Reserved}
      </i></font>S_Srvr <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">24</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">; </font><font color="#008000"><i>{Superstation Nodes logged into (reserved)}
      </i></font>S_NID <font color="#000080">: </font>SID<font color="#000080">;                   </font><font color="#008000"><i>{NodeID}
      </i></font>Reserved0 <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

      </font><font color="#008000"><i>{From Superstations:}

      </i></font>S_SDRV <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;  </font><font color="#008000"><i>{Drives avail: Bits 0-15/A-P}
      </i></font>S_UFlag <font color="#000080">: </font>Byte<font color="#000080">;                </font><font color="#008000"><i>{User Service Flag:
                                      0-Mail for you     1-News for you
                                      2-Calendar for you 3-Mail for Node
                                      4-Submit ON        6-Print Permit ON
                                      6-Gate                               }
      </i></font>S_SPRTRT <font color="#000080">: </font>Byte<font color="#000080">;               </font><font color="#008000"><i>{Bit 0-7 set for Printers 1-3    }
      </i></font>Reserved1 <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
      </font>S_PRIU   <font color="#000080">: </font>Byte<font color="#000080">;               </font><font color="#008000"><i>{Primary Unit (0=A,1=B,etc) }
      </i></font>Reserved2 <font color="#000080">: </font>Byte<font color="#000080">;
      </font>LoggedNodes <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">444</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">; </font><font color="#008000"><i>{Logged on NodeIDS}
      </i></font>S_Time <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;  </font><font color="#008000"><i>{Time: SEC/MIN/HR}
      </i></font>S_Date <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;  </font><font color="#008000"><i>{Date: DAY/MON/YR-1980}
      </i></font>Reserved3 <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>SpoolBlock <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>UCode <font color="#000080">: </font>Integer<font color="#000080">;
    </font>UFile <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>UNote <font color="#000080">: </font>Byte<font color="#000080">;
    </font>UDays <font color="#000080">: </font>Byte<font color="#000080">;
    </font>UDVC <font color="#000080">: </font>Byte<font color="#000080">;
    </font>ULen <font color="#000080">: </font>Integer<font color="#000080">;
    </font>UArea <font color="#000080">: </font>Byte<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{These variable declarations allocate approximately 1660 bytes of memory
 to the Tentools Unit}

</i></font><font color="#FF0000"><b>VAR
   </b></font>I10 <font color="#000080">: </font>Integer<font color="#000080">;
   </font>TenTest <font color="#000080">: </font>Word<font color="#000080">;
   </font>TenRegs <font color="#000080">: </font>Registers<font color="#000080">;
   </font>SendSet <font color="#000080">: </font>SendFormat<font color="#000080">;
   </font>SendBuffer <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">470</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
   </font>ReceiveBuffer <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">484</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
   </font>LogData <font color="#000080">: </font>LogRec<font color="#000080">;
   </font>PreConfig <font color="#000080">: ^</font>PreConfigurationTable<font color="#000080">;
   </font>ConfigTable <font color="#000080">: ^</font>ConfigurationTable<font color="#000080">;
   </font>UserName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];
   </font>DataBuffer <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">470</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
   </font>PacketRec <font color="#000080">: </font>PRec<font color="#000080">;
   </font>ChatRec <font color="#000080">: </font>ChRec<font color="#000080">;
   </font>TBR <font color="#000080">: ^</font>HeapRecBlock<font color="#000080">;
   </font>TBD <font color="#000080">: ^</font>HeapDataBlock<font color="#000080">;
   </font>MaxRecvSets <font color="#000080">: </font>Integer<font color="#000080">;
   </font>NodeArray <font color="#000080">: ^</font>NBuffer<font color="#000080">;
   </font>NAArray <font color="#000080">: ^</font>NABuffer<font color="#000080">;
   </font>NWArray <font color="#000080">: ^</font>NWBuffer<font color="#000080">;
   </font>SpoolSettings <font color="#000080">: </font>SpoolBlock<font color="#000080">;
   </font>Spooling <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#008000"><i>{ The Procedures/Functions }

</i></font><font color="#FF0000"><b>Function </b></font>TimeStamp <font color="#000080">: </font>Real<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StampAge<font color="#000080">(</font>StartTime <font color="#000080">: </font>Real<font color="#000080">): </font>LongInt<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Loaded <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Chat<font color="#000080">(</font>NodeID <font color="#000080">: </font>S12<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>DBuffer <font color="#008000"><i>{:String[n]} </i></font><font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Status<font color="#000080">(</font>NodeName <font color="#000080">: </font>S15<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>SBlock <font color="#000080">: </font>StatusBlock<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>NODEName <font color="#000080">: </font>S12<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Login<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">;</font>PW10Net <font color="#000080">: </font>S8<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Logoff<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Mount<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">; </font>LocalDevice<font color="#000080">,</font>RemoteDevice <font color="#000080">: </font>Char<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>UnMount<font color="#000080">(</font>LocalDrive <font color="#000080">: </font>Char<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Send<font color="#000080">(</font>NodeID <font color="#000080">: </font>S12<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>DBuffer<font color="#000080">; </font>DLength <font color="#000080">:</font>Integer<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Receive<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>DBuffer<font color="#000080">; </font>Secs <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Available <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>CBMessage <font color="#000080">: </font>Boolean<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetRemoteMemory<font color="#000080">(</font>NodeID <font color="#000080">: </font>S12<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>DBuffer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>DLength <font color="#000080">: </font>Integer<font color="#000080">;
                         </font>RemSeg<font color="#000080">,</font>RemOfs <font color="#000080">: </font>Word<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetCBChannel<font color="#000080">(</font>CBChannel <font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Function </b></font>TBSend<font color="#000080">(</font>NodeID <font color="#000080">: </font>S12<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>DBuffer<font color="#000080">;</font>DLength <font color="#000080">: </font>Integer<font color="#000080">;</font>TransactionID <font color="#000080">: </font>TID<font color="#000080">;
                </font>TransType <font color="#000080">: </font>Integer<font color="#000080">;</font>ResponseType <font color="#000080">: </font>Byte<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TBReceive<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>SenderID<font color="#000080">: </font>S12<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>DBuffer<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>DLength <font color="#000080">: </font>Integer<font color="#000080">;
                   </font><font color="#FF0000"><b>VAR </b></font>TransactionID <font color="#000080">: </font>TID<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>TransType <font color="#000080">: </font>Integer<font color="#000080">;
                   </font><font color="#FF0000"><b>VAR </b></font>Available <font color="#000080">: </font>Integer<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>CB <font color="#000080">: </font>Boolean<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Nodes<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>NodeBuffer<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>MaxNodes <font color="#000080">: </font>Integer<font color="#000080">;</font>SuperstationsOnly <font color="#000080">: </font>Boolean<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>MountList<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>MountTable <font color="#000080">: </font>DriveArray<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>PrintTable <font color="#000080">: </font>PrintArray<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>TableEntries <font color="#000080">: </font>Integer<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LogList<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Logins <font color="#000080">: </font>LogArray<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>TableEntries <font color="#000080">: </font>Integer<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetTableData<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>TableBuffer <font color="#000080">: </font>GetTableDataRec<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>MountsAvail <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TenConfig<font color="#000080">(</font>MaxSendRec<font color="#000080">,</font>MaxRecvRec <font color="#000080">: </font>Integer<font color="#000080">;</font>MaxRecs <font color="#000080">: </font>Integer<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SetWait<font color="#000080">(</font>WaitLimit <font color="#000080">: </font>Integer<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetUserName<font color="#000080">(</font>UName <font color="#000080">: </font>S8<font color="#000080">);

</font><font color="#FF0000"><b>Function </b></font>Get10Time<font color="#000080">(</font>NodeName <font color="#000080">: </font>S15 <font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>TenTime <font color="#000080">: </font>DateTimeRec<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetDevices<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Device <font color="#000080">: </font>DeviceArray<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>DeviceCount <font color="#000080">: </font>Integer<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>NetUse<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">; </font>LocalDrive <font color="#000080">: </font>Char<font color="#000080">; </font>RemoteDevice <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>NetUsePassWord <font color="#000080">: </font>S8<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>UnUse<font color="#000080">(</font>LocalDrive <font color="#000080">: </font>Char<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Submit<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">; </font>CommandLine <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SetSpool<font color="#000080">(</font>Printer <font color="#000080">: </font>Byte<font color="#000080">; </font>SpoolName <font color="#000080">: </font>S12<font color="#000080">; </font>Notification <font color="#000080">: </font>NotifySet<font color="#000080">; </font>RDays <font color="#000080">: </font>Byte<font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>OpenSpool<font color="#000080">(</font>NewSpoolName <font color="#000080">: </font>S12<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>CloseSpool <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>UpCase8<font color="#000080">(</font>Str_8 <font color="#000080">: </font>S8<font color="#000080">): </font>S8<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>UpCase12<font color="#000080">(</font>Str_12 <font color="#000080">: </font>S12<font color="#000080">): </font>S12<font color="#000080">;

</font><font color="#008000"><i>{******************************************************************************}


</i></font><font color="#FF0000"><b>Implementation

Function </b></font>UpCase12<font color="#000080">(</font>Str_12 <font color="#000080">: </font>S12<font color="#000080">): </font>S12<font color="#000080">;
</font><font color="#008000"><i>{Expands and &quot;Upcases&quot; a 12 character string}
</i></font><font color="#FF0000"><b>VAR </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Str_12<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Str_12<font color="#000080">[</font>I<font color="#000080">]:=</font>Upcase<font color="#000080">(</font>Str_12<font color="#000080">[</font>I<font color="#000080">]);
   </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>Str_12<font color="#000080">)&lt;</font><font color="#800000">12 </font><font color="#FF0000"><b>do </b></font>Str_12<font color="#000080">:=</font>Str_12<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
   </font>UpCase12<font color="#000080">:=</font>Str_12<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>UpCase8<font color="#000080">(</font>Str_8 <font color="#000080">: </font>S8<font color="#000080">): </font>S8<font color="#000080">;
</font><font color="#008000"><i>{Expands and &quot;Upcases&quot; an 8 character string}
</i></font><font color="#FF0000"><b>VAR </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Str_8<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Str_8<font color="#000080">[</font>I<font color="#000080">]:=</font>Upcase<font color="#000080">(</font>Str_8<font color="#000080">[</font>I<font color="#000080">]);
   </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>Str_8<font color="#000080">)&lt;</font><font color="#800000">8 </font><font color="#FF0000"><b>do </b></font>Str_8<font color="#000080">:=</font>Str_8<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
   </font>UpCase8<font color="#000080">:=</font>Str_8<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>TimeStamp <font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#008000"><i>{Returns a timestamp of 6 bytes ordered, Year,Month,Day,Hour(24),Minute,
 Second }
</i></font><font color="#FF0000"><b>VAR
   </b></font>TS <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
   </font>TStmp <font color="#000080">: </font>Real <font color="#FF0000"><b>absolute </b></font>TS<font color="#000080">;
   </font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>DOW<font color="#000080">,</font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Sec<font color="#000080">,</font>Hund <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Sec<font color="#000080">,</font>Hund<font color="#000080">);
   </font>GetDate<font color="#000080">(</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>DOW<font color="#000080">);
   </font>Year<font color="#000080">:=</font>Year <font color="#FF0000"><b>mod </b></font><font color="#800000">100</font><font color="#000080">;
   </font>TS<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>Byte<font color="#000080">(</font>Year<font color="#000080">);
   </font>TS<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font>Byte<font color="#000080">(</font>Month<font color="#000080">);
   </font>TS<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font>Byte<font color="#000080">(</font>Day<font color="#000080">);
   </font>TS<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]:=</font>Byte<font color="#000080">(</font>Hour<font color="#000080">);
   </font>TS<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]:=</font>Byte<font color="#000080">(</font>Minute<font color="#000080">);
   </font>TS<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]:=</font>Byte<font color="#000080">(</font>Sec<font color="#000080">);
   </font>TimeStamp<font color="#000080">:=</font>TStmp<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>StampAge<font color="#000080">(</font>StartTime <font color="#000080">: </font>Real<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#008000"><i>{ Returns the difference in seconds between the currenttime and the
&quot;Starttime&quot; timestamp.}
</i></font><font color="#FF0000"><b>VAR
   </b></font>TS1 <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#FF0000"><b>absolute </b></font>StartTime<font color="#000080">;
   </font>TStamp2 <font color="#000080">: </font>Real<font color="#000080">;
   </font>TS2 <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#FF0000"><b>absolute </b></font>TStamp2<font color="#000080">;
   </font>IArray <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;
   </font>SA <font color="#000080">: </font>Longint<font color="#000080">;
   </font>I <font color="#000080">: </font>Integer<font color="#000080">;
   </font>Leaps <font color="#000080">: </font>Integer<font color="#000080">;

 </font><font color="#008000"><i>{==========}
   </i></font><font color="#FF0000"><b>procedure </b></font>TDec<font color="#000080">(</font>Pos <font color="#000080">: </font>Integer<font color="#000080">);
   </font><font color="#FF0000"><b>begin
      if </b></font>Pos<font color="#000080">&gt;</font><font color="#800000">0
      </font><font color="#FF0000"><b>then
       begin
          If </b></font><font color="#000080">(</font>TS2<font color="#000080">[</font>Pos<font color="#000080">]=</font>SCMin<font color="#000080">[</font>Pos<font color="#000080">])
          </font><font color="#FF0000"><b>then
           begin
              </b></font>TDec<font color="#000080">(</font>Pos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
              </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Pos<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>TS2<font color="#000080">[</font>Pos<font color="#000080">]:=</font>SCMon<font color="#000080">[</font>TS2<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]]
              </font><font color="#FF0000"><b>else
               begin
                  If </b></font>Pos<font color="#000080">&gt;</font><font color="#800000">3 </font><font color="#FF0000"><b>then </b></font>TS2<font color="#000080">[</font>Pos<font color="#000080">]:=</font>SCLim<font color="#000080">[</font>Pos<font color="#000080">]-</font><font color="#800000">1
                  </font><font color="#FF0000"><b>else </b></font>TS2<font color="#000080">[</font>Pos<font color="#000080">]:=</font>SCLim<font color="#000080">[</font>Pos<font color="#000080">];
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end
          else
          </b></font>TS2<font color="#000080">[</font>Pos<font color="#000080">]:=</font>TS2<font color="#000080">[</font>Pos<font color="#000080">]-</font><font color="#800000">1</font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#008000"><i>{==========}

</i></font><font color="#FF0000"><b>Begin
   </b></font>FillChar<font color="#000080">(</font>IArray<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
   </font>TStamp2<font color="#000080">:=</font>TimeStamp<font color="#000080">;
   </font><font color="#008000"><i>{Count leaps if necessary}
   </i></font>Leaps<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>TS2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&gt;(</font>TS1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then for </b></font>I<font color="#000080">:=</font>TS1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>TS2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
    if </b></font><font color="#000080">(</font>I <font color="#FF0000"><b>mod </b></font><font color="#800000">4 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Leaps<font color="#000080">:=</font>Leaps<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>TS2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font>TS1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font><font color="#800000">1 </font><font color="#FF0000"><b>then if </b></font><font color="#000080">(((</font>TS1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>mod </b></font><font color="#800000">4 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>TS1<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]&lt;=</font><font color="#800000">2</font><font color="#000080">)) </font><font color="#FF0000"><b>or
   </b></font><font color="#000080">((</font>TS2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>mod </b></font><font color="#800000">4 </font><font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>TS2<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]&gt;</font><font color="#800000">2</font><font color="#000080">))) </font><font color="#FF0000"><b>then </b></font>Leaps<font color="#000080">:=</font>Leaps<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(((</font>TS1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font>TS2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>TS1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>mod </b></font><font color="#800000">4 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>TS1<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]&lt;=</font><font color="#800000">2</font><font color="#000080">)</font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>TS2<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]&gt;</font><font color="#800000">2</font><font color="#000080">)))
    </font><font color="#FF0000"><b>then </b></font>Leaps<font color="#000080">:=</font>Leaps<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">6 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
       If </b></font><font color="#000080">(</font>TS2<font color="#000080">[</font>I<font color="#000080">]&lt;</font>TS1<font color="#000080">[</font>I<font color="#000080">])
       </font><font color="#FF0000"><b>then
        begin
           </b></font>TS2<font color="#000080">[</font>I<font color="#000080">]:=</font>TS2<font color="#000080">[</font>I<font color="#000080">]+</font>SCLim<font color="#000080">[</font>I<font color="#000080">];
           </font>TDec<font color="#000080">(</font>I<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>IArray<font color="#000080">[</font>I<font color="#000080">]:=</font>TS2<font color="#000080">[</font>I<font color="#000080">]-</font>TS1<font color="#000080">[</font>I<font color="#000080">];
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>IArray<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font>IArray<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]+</font>Leaps<font color="#000080">;
   </font><font color="#008000"><i>{Using leaps now to count days}
   </i></font>Leaps<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>I<font color="#000080">:=</font>TS2<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
   </font><font color="#FF0000"><b>While </b></font>I<font color="#000080">&lt;&gt;</font>TS1<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>do
    begin
       </b></font>Leaps<font color="#000080">:=</font>Leaps<font color="#000080">+</font>SCMon<font color="#000080">[</font>I<font color="#000080">];
       </font>I<font color="#000080">:=</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
       </font><font color="#FF0000"><b>If </b></font>I<font color="#000080">&gt;</font><font color="#800000">12 </font><font color="#FF0000"><b>then </b></font>I<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>IArray<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Leaps<font color="#000080">:=</font>Leaps<font color="#000080">+</font>IArray<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]*</font><font color="#800000">365</font><font color="#000080">;
   </font>Leaps<font color="#000080">:=</font>Leaps<font color="#000080">+</font>IArray<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
   </font>SA<font color="#000080">:=</font>Leaps<font color="#000080">;
   </font>SA<font color="#000080">:=</font>SA<font color="#000080">*</font><font color="#800000">24</font><font color="#000080">+</font>IArray<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
   </font>SA<font color="#000080">:=</font>SA<font color="#000080">*</font><font color="#800000">60</font><font color="#000080">+</font>IArray<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];
   </font>StampAge<font color="#000080">:=</font>SA<font color="#000080">*</font><font color="#800000">60</font><font color="#000080">+</font>IArray<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>Loaded <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Is 10Net Loaded? }
</i></font><font color="#FF0000"><b>TYPE
  </b></font>LoadCheck <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>LPtr <font color="#000080">: ^</font>LoadCheck<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   With </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>AX<font color="#000080">:=</font><font color="#800000">$356F</font><font color="#000080">;
       </font>MSDos<font color="#000080">(</font>TenRegs<font color="#000080">);
       </font>LPtr<font color="#000080">:=</font>Ptr<font color="#000080">(</font>ES<font color="#000080">,</font>BX<font color="#000080">-</font><font color="#800000">4</font><font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>LPtr<font color="#000080">^[</font><font color="#800000">4</font><font color="#000080">]+</font>Lptr<font color="#000080">^[</font><font color="#800000">3</font><font color="#000080">]+</font>LPtr<font color="#000080">^[</font><font color="#800000">2</font><font color="#000080">]+</font>LPtr<font color="#000080">^[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'1XOF'</font><font color="#000080">)
       </font><font color="#FF0000"><b>then </b></font>Loaded<font color="#000080">:=</font>True
       <font color="#FF0000"><b>else </b></font>Loaded<font color="#000080">:=</font>False<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>NODEName <font color="#000080">: </font>S12<font color="#000080">;
</font><font color="#008000"><i>{Returns the current nodename }
</i></font><font color="#FF0000"><b>VAR
 </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
 </font>NN <font color="#000080">: </font>S12<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>NN<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>TNTI <font color="#FF0000"><b>then for </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>do </b></font>NN<font color="#000080">:=</font>NN<font color="#000080">+</font>ConfigTable<font color="#000080">^.</font>CT_NID<font color="#000080">;
   </font>NodeName<font color="#000080">:=</font>NN<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#FF0000"><b>Function </b></font>Chat<font color="#000080">(</font>NodeID <font color="#000080">: </font>S12<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>DBuffer <font color="#008000"><i>{:String[n]} </i></font><font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ The DBuffer should be a Turbo Pascal String (length indicator in byte 0)
  The string should be no more than 100 bytes long. This function sends a
  10Net Chat message to the NodeID specified. }
</i></font><font color="#FF0000"><b>VAR
   </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
   </font>LI <font color="#000080">: ^</font>Byte<font color="#000080">;
   </font>PBuffer <font color="#000080">: ^</font>ChatBytes<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   With </b></font>TenRegs <font color="#FF0000"><b>do if </b></font>TNTI <font color="#FF0000"><b>then
    begin
       For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>NodeID<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>LogData<font color="#000080">.</font>NodeName<font color="#000080">[</font>I<font color="#000080">]:=</font>NodeID<font color="#000080">[</font>I<font color="#000080">];
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>NodeID<font color="#000080">)&lt;</font><font color="#800000">12</font><font color="#000080">) </font><font color="#FF0000"><b>then for </b></font>I<font color="#000080">:=</font>Length<font color="#000080">(</font>NodeID<font color="#000080">)+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>do
        </b></font>LogData<font color="#000080">.</font>NodeName<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">#32</font><font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do </b></font>LogData<font color="#000080">.</font>Password<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">#32</font><font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do </b></font>LogData<font color="#000080">.</font>UserName<font color="#000080">[</font>I<font color="#000080">]:=</font>ConfigTable<font color="#000080">^.</font>CT_LName<font color="#000080">[</font>I<font color="#000080">];
       </font>PBuffer<font color="#000080">:=@</font>DBuffer<font color="#000080">;
       </font>LI<font color="#000080">:=@</font>DBuffer<font color="#000080">;
       </font>ChatRec<font color="#000080">.</font>MsgLength<font color="#000080">:=</font>Integer<font color="#000080">(</font>LI<font color="#000080">^)+</font><font color="#800000">2</font><font color="#000080">;
       </font><font color="#FF0000"><b>If </b></font>ChatRec<font color="#000080">.</font>MsgLength<font color="#000080">&gt;</font><font color="#800000">102
       </font><font color="#FF0000"><b>then
        begin
           </b></font>ChatRec<font color="#000080">.</font>MsgLength<font color="#000080">:=</font><font color="#800000">102</font><font color="#000080">;
           </font>LI<font color="#000080">^:=</font><font color="#800000">100</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{@#@}       </i></font>Move<font color="#000080">(</font>PBuffer<font color="#000080">^[</font><font color="#800000">2</font><font color="#000080">],</font>ChatRec<font color="#000080">.</font>ChatText<font color="#000080">,</font>ChatRec<font color="#000080">.</font>MsgLength<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
       </font>AX<font color="#000080">:=</font><font color="#800000">$0A00</font><font color="#000080">;
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>LogData<font color="#000080">);
       </font>BX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>LogData<font color="#000080">);
       </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ChatRec<font color="#000080">);
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">$01</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then </b></font>Chat<font color="#000080">:=</font>AX
       <font color="#FF0000"><b>else </b></font>Chat<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
  else
    begin
       </b></font>Writeln<font color="#000080">(</font><font color="#800000">'TENTOOLS Not Initialized'</font><font color="#000080">);
       </font>Halt<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Status<font color="#000080">(</font>NodeName <font color="#000080">: </font>S15<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>SBlock <font color="#000080">: </font>StatusBlock<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ Returns a Block of Status information from the Nodename requested if
  that node is on the network.}
</i></font><font color="#FF0000"><b>TYPE
   </b></font>A20 <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">23</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>SBP <font color="#000080">: ^</font>A20<font color="#000080">;
   </font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>TNTI <font color="#FF0000"><b>then with </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>NodeName<font color="#000080">:=</font>Upcase12<font color="#000080">(</font>NodeName<font color="#000080">);
       </font>FillChar<font color="#000080">(</font>SBlock<font color="#000080">,</font>Sizeof<font color="#000080">(</font>StatusBlock<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
       </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>NodeName<font color="#000080">)&lt;</font><font color="#800000">15 </font><font color="#FF0000"><b>do </b></font>NodeName<font color="#000080">:=</font>NodeName<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
       </font>Move<font color="#000080">(</font>NodeName<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>SBlock<font color="#000080">,</font><font color="#800000">15</font><font color="#000080">);
       </font>SBP<font color="#000080">:=@</font>SBlock<font color="#000080">;
       </font>Move<font color="#000080">(</font>ConfigTable<font color="#000080">^.</font>CT_LName<font color="#000080">,</font>SBP<font color="#000080">^[</font><font color="#800000">16</font><font color="#000080">],</font><font color="#800000">8</font><font color="#000080">);
       </font>AX<font color="#000080">:=</font><font color="#800000">$0200</font><font color="#000080">;
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>SBlock<font color="#000080">);
       </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>SBlock<font color="#000080">);
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">$01</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then </b></font>Status<font color="#000080">:=</font>AX
       <font color="#FF0000"><b>else </b></font>Status<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else
    begin
       </b></font>Writeln<font color="#000080">(</font><font color="#800000">'TENTOOLS Not Initialized'</font><font color="#000080">);
       </font>Halt<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Get10Time<font color="#000080">(</font>NodeName <font color="#000080">: </font>S15 <font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>TenTime <font color="#000080">: </font>DateTimeRec<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>{Returns the Date and Time in a DateTimeRec Record from the Node Requested.}

</i></font><font color="#FF0000"><b>VAR
   </b></font>TempStatus <font color="#000080">: ^</font>StatusBlock<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>GetMem<font color="#000080">(</font>TempStatus<font color="#000080">,</font><font color="#800000">512</font><font color="#000080">);
   </font>TenTest<font color="#000080">:=</font>Status<font color="#000080">(</font>NodeName<font color="#000080">,</font>TempStatus<font color="#000080">^);
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>TenTest<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
   </font><font color="#FF0000"><b>then with </b></font>TempStatus<font color="#000080">^ </font><font color="#FF0000"><b>do
    begin
       with </b></font>TenTime <font color="#FF0000"><b>do
        begin
           </b></font>Year<font color="#000080">:=</font>S_Date<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]+</font><font color="#800000">1980</font><font color="#000080">;
           </font>Month<font color="#000080">:=</font>S_Date<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
           </font>Day<font color="#000080">:=</font>S_Date<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
           </font>Hour<font color="#000080">:=</font>S_Time<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
           </font>Minute<font color="#000080">:=</font>S_Time<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
           </font>Second<font color="#000080">:=</font>S_Time<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
           </font>Get10Time<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>Get10Time<font color="#000080">:=</font>TenTest<font color="#000080">;
   </font>FreeMem<font color="#000080">(</font>TempStatus<font color="#000080">,</font><font color="#800000">512</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Login<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">;</font>PW10Net <font color="#000080">: </font>S8<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ Logs into the requested server. }
</i></font><font color="#FF0000"><b>VAR
  </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   With </b></font>TenRegs <font color="#FF0000"><b>do if </b></font>TNTI <font color="#FF0000"><b>then
    begin
       </b></font>Move<font color="#000080">(</font>ConfigTable<font color="#000080">^.</font>CT_LName<font color="#000080">,</font>LogData<font color="#000080">.</font>UserName<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
       </font>PW10Net<font color="#000080">:=</font>Upcase8<font color="#000080">(</font>PW10Net<font color="#000080">);
       </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do </b></font>LogData<font color="#000080">.</font>Password<font color="#000080">[</font>I<font color="#000080">]:=</font>PW10Net<font color="#000080">[</font>I<font color="#000080">];
       </font>ServerID<font color="#000080">:=</font>Upcase12<font color="#000080">(</font>ServerID<font color="#000080">);
       </font>Move<font color="#000080">(</font>ServerID<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>LogData<font color="#000080">.</font>NodeName<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
</font><font color="#008000"><i>{       Writeln(LogData.UserName,'&lt;');
       Writeln(LogData.PassWord,'&lt;');
       Writeln(LogData.NodeName,'&lt;');
}      </i></font>AX<font color="#000080">:=</font><font color="#800000">$0000</font><font color="#000080">;
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>LogData<font color="#000080">);
       </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>LogData<font color="#000080">);
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">$01</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then </b></font>Login<font color="#000080">:=</font>AX
       <font color="#FF0000"><b>else </b></font>Login<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#008000"><i>(*       Case AX of
            $0000 : Write('Good Login');
            $01FF : Write('No response from Superstation');
            $02FF : Write('Network Error');
            $03FF : Write('Invalid password');
            $04FF : Write('No Local Buffer available');
            $05FF : Write('Superstation device is not available');
            $06FF : Write('Node Already logged in under different name.');
            $07FF : Write('Login not valid from this node ID.');
            $09FF : Write('Node is not a superstation');
            $0AFF : Write('Node-ID already in use by another station!');
            else Write('ErrorCode ',AX);
           end; {Case}
 *)
    </i></font><font color="#FF0000"><b>end
  else
   begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'TENTOOLS Not Initialized'</font><font color="#000080">);
      </font>Halt<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Logoff<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ Logs off the requested server. }
</i></font><font color="#FF0000"><b>Begin
   While </b></font>Length<font color="#000080">(</font>ServerID<font color="#000080">)&lt;</font><font color="#800000">12 </font><font color="#FF0000"><b>do </b></font>ServerID<font color="#000080">:=</font>ServerID<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
   </font><font color="#FF0000"><b>With </b></font>TenRegs <font color="#FF0000"><b>do if </b></font>Loaded <font color="#FF0000"><b>then
    begin
       </b></font>AX<font color="#000080">:=</font><font color="#800000">$0100</font><font color="#000080">;
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>ServerID<font color="#000080">);
       </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ServerID<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">$01</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then </b></font>Logoff<font color="#000080">:=</font>AX
       <font color="#FF0000"><b>else </b></font>Logoff<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>Logoff<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Mount<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">; </font>LocalDevice<font color="#000080">,</font>RemoteDevice <font color="#000080">: </font>Char<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ For Drive mounting, mounts drive REMOTEDRIVE at SERVERID as LOCALDRIVE
 locally; for printer mounting, use &quot;1&quot; for LPT1, etc. }
</i></font><font color="#FF0000"><b>VAR
 </b></font>LDrive <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   With </b></font>TenRegs <font color="#FF0000"><b>do if </b></font>Loaded <font color="#FF0000"><b>then
    begin
       If </b></font>LocalDevice <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font>LDrive<font color="#000080">:=</font>Ord<font color="#000080">(</font>LocalDevice<font color="#000080">)-</font><font color="#800000">65
       </font><font color="#FF0000"><b>else if </b></font>LocalDevice <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'1'</font><font color="#000080">..</font><font color="#800000">'3'</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font>LDrive<font color="#000080">:=</font>Ord<font color="#000080">(</font>LocalDevice<font color="#000080">)-</font><font color="#800000">49</font><font color="#000080">;
       </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>ServerID<font color="#000080">)&lt;</font><font color="#800000">12 </font><font color="#FF0000"><b>do </b></font>ServerID<font color="#000080">:=</font>ServerID<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
       </font>AX<font color="#000080">:=</font><font color="#800000">$1700</font><font color="#000080">+</font>LDrive<font color="#000080">;
       </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ServerID<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>ServerID<font color="#000080">);
       </font>BL<font color="#000080">:=</font>Ord<font color="#000080">(</font>RemoteDevice<font color="#000080">);
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then
        begin
           </b></font>Mount<font color="#000080">:=</font>AX<font color="#000080">;
</font><font color="#008000"><i>{           TextColor(White+Blink);
           Writeln('Error: ',AX);}
        </i></font><font color="#FF0000"><b>end
       else </b></font>Mount<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>Mount<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>UnMount<font color="#000080">(</font>LocalDrive <font color="#000080">: </font>Char<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ Unmounts previously mounted drive or printer }
</i></font><font color="#FF0000"><b>VAR
 </b></font>LDrive <font color="#000080">: </font>Integer<font color="#000080">;
 </font>LPrint <font color="#000080">: </font>Integer <font color="#FF0000"><b>absolute </b></font>LDrive<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>Loaded <font color="#FF0000"><b>then
   With </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       If </b></font><font color="#000080">(</font>LocalDrive <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">])
       </font><font color="#FF0000"><b>then
        begin
           </b></font>LDrive<font color="#000080">:=</font>Ord<font color="#000080">(</font>LocalDrive<font color="#000080">)-</font><font color="#800000">65</font><font color="#000080">;
           </font>AX<font color="#000080">:=</font><font color="#800000">$1800</font><font color="#000080">+</font>LDrive<font color="#000080">;
           </font>BL<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>end
       else if </b></font><font color="#000080">(</font>LocalDrive <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'1'</font><font color="#000080">..</font><font color="#800000">'3'</font><font color="#000080">])
       </font><font color="#FF0000"><b>then
        begin
           </b></font>LPrint<font color="#000080">:=</font>Ord<font color="#000080">(</font>LocalDrive<font color="#000080">)-</font><font color="#800000">49</font><font color="#000080">;
           </font>AX<font color="#000080">:=</font><font color="#800000">$1800</font><font color="#000080">+</font>LPrint<font color="#000080">;
           </font>BL<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then </b></font>UnMount<font color="#000080">:=</font>AX
       <font color="#FF0000"><b>else </b></font>UnMount<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>UnMount<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>NetUse<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">; </font>LocalDrive <font color="#000080">: </font>Char<font color="#000080">; </font>RemoteDevice <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>NetUsePassWord <font color="#000080">: </font>S8<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ Attaches to a Device at a Remote Server. The RemoteDevice can be an ALIAS }
</i></font><font color="#FF0000"><b>VAR
   </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
   </font>DriveString <font color="#000080">: </font>S8<font color="#000080">;
   </font>SERVERZ <font color="#000080">: </font>S12<font color="#000080">;
   </font>RemoteString <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>Loaded
   <font color="#FF0000"><b>then with </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>SERVERZ<font color="#000080">:=</font>ServerID<font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>SERVERZ<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>SERVERZ<font color="#000080">[</font>I<font color="#000080">]:=</font>Upcase<font color="#000080">(</font>SERVERZ<font color="#000080">[</font>I<font color="#000080">]);
       </font><font color="#FF0000"><b>While </b></font>ServerZ<font color="#000080">[</font>Length<font color="#000080">(</font>ServerZ<font color="#000080">)]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>do </b></font>Dec<font color="#000080">(</font>ServerZ<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
       </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>NetUsePassword<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>NetUsePassword<font color="#000080">[</font>I<font color="#000080">]:=</font>Upcase<font color="#000080">(</font>NetUsePassword<font color="#000080">[</font>I<font color="#000080">]);
       </font>BL<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;
       </font>CX<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font>DriveString<font color="#000080">:=</font>Upcase<font color="#000080">(</font>LocalDrive<font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">+</font><font color="#800000">#0</font><font color="#000080">;
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>DriveString<font color="#000080">);
       </font>SI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>DriveString<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>RemoteDevice<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>RemoteDevice<font color="#000080">[</font>I<font color="#000080">]:=</font>Upcase<font color="#000080">(</font>RemoteDevice<font color="#000080">[</font>I<font color="#000080">]);
       </font>RemoteString<font color="#000080">:=</font><font color="#800000">'\\'</font><font color="#000080">+</font>SERVERZ<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>RemoteDevice<font color="#000080">+</font><font color="#800000">#0</font><font color="#000080">+</font>NetUsePassWord<font color="#000080">;
       </font><font color="#FF0000"><b>While </b></font>RemoteString<font color="#000080">[</font>Length<font color="#000080">(</font>RemoteString<font color="#000080">)]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>do </b></font>Dec<font color="#000080">(</font>RemoteString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
       </font>RemoteString<font color="#000080">:=</font>RemoteString<font color="#000080">+</font><font color="#800000">#0</font><font color="#000080">;
       </font>ES<font color="#000080">:=</font>Seg<font color="#000080">(</font>RemoteString<font color="#000080">);
       </font>DI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>RemoteString<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
       </font>AX<font color="#000080">:=</font><font color="#800000">$5F03</font><font color="#000080">;  </font><font color="#008000"><i>{uses the Dos function call &quot;Redirect Device&quot;}
       </i></font>MSDOS<font color="#000080">(</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then
        </b></font>NetUse<font color="#000080">:=</font>AX
       <font color="#FF0000"><b>else
        </b></font>NetUse<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>NetUse<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>UnUse<font color="#000080">(</font>LocalDrive <font color="#000080">: </font>Char<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ Detaches from a shared device at a remote server. The attachment was made
through a Net Use (or NetUse), and the local drive letter is all that is
needed to detach}
</i></font><font color="#FF0000"><b>VAR
   </b></font>DriveString <font color="#000080">: </font>S8<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   If </b></font>Loaded
   <font color="#FF0000"><b>then with </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>DriveString<font color="#000080">:=</font>Upcase<font color="#000080">(</font>LocalDrive<font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">+</font><font color="#800000">#0</font><font color="#000080">;
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>DriveString<font color="#000080">);
       </font>SI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>DriveString<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
       </font>AX<font color="#000080">:=</font><font color="#800000">$5F04</font><font color="#000080">;
       </font>MSDos<font color="#000080">(</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then
        </b></font>UnUse<font color="#000080">:=</font>AX
       <font color="#FF0000"><b>else
        </b></font>UnUse<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>UnUse<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>Send<font color="#000080">(</font>NodeID <font color="#000080">: </font>S12<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>DBuffer<font color="#000080">; </font>DLength <font color="#000080">:</font>Integer<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{Send a data packet on the network to NODEID ( or on a CB Channel if
NODEID is CB##, limited to 470 byte packets. Used within the Toolbox to
accomplish TBSend, which allows large records to be sent.}

</i></font><font color="#FF0000"><b>VAR
 </b></font>I<font color="#000080">,</font>SR <font color="#000080">: </font>Integer<font color="#000080">;
 </font>CBL <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
</font><font color="#FF0000"><b>Begin
   If </b></font>DLength<font color="#000080">&lt;=</font><font color="#800000">470
   </font><font color="#FF0000"><b>then
    begin
      </b></font>NodeID<font color="#000080">:=</font>Upcase12<font color="#000080">(</font>NodeId<font color="#000080">);
      </font>Move<font color="#000080">(</font>NodeID<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>SendSet<font color="#000080">.</font>RNode<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
      </font>SendSet<font color="#000080">.</font>DataBytes<font color="#000080">:=</font>DLength<font color="#000080">;
      </font>Move<font color="#000080">(</font>DBuffer<font color="#000080">,</font>SendBuffer<font color="#000080">,</font>DLength<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>NodeID<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'C'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>NodeID<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]=</font><font color="#800000">'B'</font><font color="#000080">))
      </font><font color="#FF0000"><b>then
       begin
          </b></font>CBL<font color="#000080">:=</font>Copy<font color="#000080">(</font>NodeID<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>CBL<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>CBL<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">#1</font><font color="#000080">;
          </font>VAL<font color="#000080">(</font>CBL<font color="#000080">,</font>I<font color="#000080">,</font>SR<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>SR<font color="#000080">=</font><font color="#800000">0
          </font><font color="#FF0000"><b>then
           begin
              </b></font>SendSet<font color="#000080">.</font>RNode<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font><font color="#800000">#0</font><font color="#000080">;
              </font>SendSet<font color="#000080">.</font>RNode<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>Char<font color="#000080">(</font>I<font color="#000080">);
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>With </b></font>TenRegs <font color="#FF0000"><b>do
       begin
          </b></font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>SendSet<font color="#000080">);
          </font>BX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>SendSet<font color="#000080">);
          </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>SendBuffer<font color="#000080">);
          </font>AX<font color="#000080">:=</font><font color="#800000">$0400</font><font color="#000080">;
          </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
          </b></font>Send<font color="#000080">:=</font>AX
          <font color="#FF0000"><b>else </b></font>Send<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>Send<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Receive<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>DBuffer<font color="#000080">; </font>Secs <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Available <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>CBMessage <font color="#000080">: </font>Boolean<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{Receive a data packet on the network in the structure below:
         data           bytes
         =====================
         SenderNodeID : 12
         Len          : 2
         Data         : (Len)
  Available is set to the number of packets available INCLUDING the
  current message. Receives data sent through the SEND function, which is
  limited to data structures of length 470 or less. TBSend and TBReceive
  (which use Send and Receive) can be used for larger structures.
}
</i></font><font color="#FF0000"><b>VAR
 </b></font>TestString <font color="#000080">: ^</font>String80<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>TestString<font color="#000080">:=@</font>DBuffer<font color="#000080">;
   </font>CBMessage<font color="#000080">:=</font>False<font color="#000080">;
   </font><font color="#FF0000"><b>With </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>DBuffer<font color="#000080">);
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>DBuffer<font color="#000080">);
       </font>CX<font color="#000080">:=</font>Secs<font color="#000080">;
       </font>AX<font color="#000080">:=</font><font color="#800000">$0500</font><font color="#000080">;
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
       </b></font>Receive<font color="#000080">:=</font>AX
       <font color="#FF0000"><b>else
        begin
           </b></font>Receive<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
           </font><font color="#FF0000"><b>If </b></font>AL<font color="#000080">=</font><font color="#800000">$FE </font><font color="#FF0000"><b>then </b></font>CBMessage<font color="#000080">:=</font>True<font color="#000080">;
           </font>Available<font color="#000080">:=</font>ConfigTable<font color="#000080">^.</font>CT_CBCNT<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;




</font><font color="#FF0000"><b>Function </b></font>GetRemoteMemory<font color="#000080">(</font>NodeID <font color="#000080">: </font>S12<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>DBuffer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>DLength <font color="#000080">: </font>Integer<font color="#000080">; </font>RemSeg<font color="#000080">,</font>RemOfs <font color="#000080">: </font>Word<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>{Copy a section of memory from a remote node to DBuffer (maximum of 470 bytes) }
</i></font><font color="#FF0000"><b>VAR
 </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   With </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>AX<font color="#000080">:=</font><font color="#800000">$1400</font><font color="#000080">;
       </font>BX<font color="#000080">:=</font>RemSeg<font color="#000080">;
       </font>CX<font color="#000080">:=</font>DLength<font color="#000080">;
       </font>SI<font color="#000080">:=</font>RemOfs<font color="#000080">;
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>DBuffer<font color="#000080">);
       </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>NodeID<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
       </font>NodeID<font color="#000080">:=</font>Upcase12<font color="#000080">(</font>NodeID<font color="#000080">);
       </font>DI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>DBuffer<font color="#000080">);
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0
       </font><font color="#FF0000"><b>then </b></font>GetRemoteMemory<font color="#000080">:=</font>AX
       <font color="#FF0000"><b>else
        begin
           </b></font>DLength<font color="#000080">:=</font>CX<font color="#000080">;
           </font>GetRemoteMemory<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetCBChannel<font color="#000080">(</font>CBChannel <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#008000"><i>{      This procedure will set your &quot;Listening&quot; Channel to the CBCHANNEL (1
 through 40 are available) specified. TBSends to this CBChannel from other
 nodes will be available here through TBReceive. TBSends to other CBChannels
 will not be seen here. TBSends directed specifically to this node will also
 be seen here, of course.
       The advantages of CB messaging are that many nodes can be setup to
 receive messages on a particular channel, and the sender will not be held
 up waiting for a network handshake to tell him that his Send was Received.
}
</i></font><font color="#FF0000"><b>Begin
   If </b></font>TNTI
   <font color="#FF0000"><b>then
    begin
       </b></font>ConfigTable<font color="#000080">^.</font>CT_CB<font color="#000080">:=</font>CBChannel<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TBSend<font color="#000080">(</font>NodeID <font color="#000080">: </font>S12<font color="#000080">;            </font><font color="#008000"><i>{Node to send to                 }
           </i></font><font color="#FF0000"><b>VAR </b></font>DBuffer<font color="#000080">;                   </font><font color="#008000"><i>{The data record                 }
                </i></font>DLength <font color="#000080">: </font>Integer<font color="#000080">;        </font><font color="#008000"><i>{Length (bytes) of data          }
          </i></font>TransactionID <font color="#000080">: </font>TID<font color="#000080">;            </font><font color="#008000"><i>{Tag to identify record (4 bytes)}
              </i></font>TransType <font color="#000080">: </font>Integer<font color="#000080">;        </font><font color="#008000"><i>{Transaction Type - (external to
                                          this toolbox) an integer type used
                                          to maintain that one is receiving
                                          only the correct type of records.}
           </i></font>ResponseType <font color="#000080">: </font>Byte            <font color="#008000"><i>{Not implemented}


              </i></font><font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ TBSend will send a large interapplication message (DBuffer) of length
DLENGTH across the network. The TransactionID is user defineable and can be
used to acknowledge the receipt or processing of a record to the originator.
TransType, optional, can be used to identify the type of processing required
of a record. The data in DBuffer can be of any structure.
     The message is effectively broken into packets, and sent with a
&quot;packet marker&quot; to assist in its reconstruction when received. Unique
Transaction IDs is essential for records larger than 457 bytes to maintain
unique record identity. Packet Data consists of a PRec (see data Type
definitions) and 457 bytes of the DataRec.
     The network provides handshaking with Sends and Receives if they are
directed to a particular node. If CB# is used instead, there is no
handshaking provided. If a node is specified, and it is not currently
available or its 10Net SBuffers buffering is full, the sending node will
be stuck waiting for a timeout or until the receiver or buffer space appears.
For this reason, in some applications which can't be held up waiting, it is
wise to use CB channel communication. (See the &quot;SetCBChannel&quot; function for a
discussion of its usage.)

}
</i></font><font color="#FF0000"><b>VAR
</b></font>RetCode <font color="#000080">: </font>Word<font color="#000080">;
</font>PBuffer <font color="#000080">: ^</font>MaxBytes<font color="#000080">;
</font>ILength <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>TNTI
   <font color="#FF0000"><b>then
    begin
       If </b></font>DLength<font color="#000080">&lt;</font>MaxSendBufferSize
       <font color="#FF0000"><b>then
        begin
           </b></font>NodeID<font color="#000080">:=</font>Upcase12<font color="#000080">(</font>NodeID<font color="#000080">);
           </font><font color="#FF0000"><b>With </b></font>PacketRec <font color="#FF0000"><b>do
            begin
               </b></font>PBuffer<font color="#000080">:=@</font>DBuffer<font color="#000080">;
               </font>TransID<font color="#000080">:=</font>TransactionID<font color="#000080">;
               </font>TPackets<font color="#000080">:=</font>DLength <font color="#FF0000"><b>div </b></font><font color="#800000">457</font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DLength <font color="#FF0000"><b>mod </b></font><font color="#800000">457</font><font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>TPackets<font color="#000080">:=</font>TPackets<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
               </font>TType<font color="#000080">:=</font>TransType<font color="#000080">;
               </font>TLength<font color="#000080">:=</font>DLength<font color="#000080">;
               </font>RespType<font color="#000080">:=</font>ResponseType<font color="#000080">;
               </font><font color="#FF0000"><b>For </b></font>Packet<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>TPackets <font color="#FF0000"><b>do
                begin
                   If </b></font>Packet<font color="#000080">=</font>TPackets <font color="#FF0000"><b>then </b></font>ILength<font color="#000080">:=</font>DLength <font color="#FF0000"><b>mod </b></font><font color="#800000">457
                   </font><font color="#FF0000"><b>else </b></font>ILength<font color="#000080">:=</font><font color="#800000">457</font><font color="#000080">;
                   </font>Move<font color="#000080">(</font>PacketRec<font color="#000080">,</font>SendBuffer<font color="#000080">,</font><font color="#800000">13</font><font color="#000080">);
                   </font>Move<font color="#000080">(</font>PBuffer<font color="#000080">^[(</font>Packet<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">457</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>SendBuffer<font color="#000080">[</font><font color="#800000">14</font><font color="#000080">],</font>ILength<font color="#000080">);
                   </font>RetCode<font color="#000080">:=</font>Send<font color="#000080">(</font>NodeID<font color="#000080">,</font>SendBuffer<font color="#000080">,</font>ILength<font color="#000080">+</font><font color="#800000">13</font><font color="#000080">);
                   </font><font color="#FF0000"><b>If </b></font>RetCode<font color="#000080">&lt;&gt;</font><font color="#800000">0
                   </font><font color="#FF0000"><b>then </b></font>Packet<font color="#000080">:=</font>TPackets<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font>RetCode<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>TBSend<font color="#000080">:=</font>RetCode <font color="#FF0000"><b>else </b></font>TBSend<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end
       else
        begin
           </b></font>Writeln<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
           </font>Writeln<font color="#000080">(</font><font color="#800000">'Record Size too large for TenTools Configuration.'</font><font color="#000080">);
           </font>Writeln<font color="#000080">(</font><font color="#800000">'MaxSendBufferSize='</font><font color="#000080">,</font>MaxSendBufferSize<font color="#000080">);
           </font>Writeln<font color="#000080">(</font><font color="#800000">'Record not Sent!'</font><font color="#000080">);
           </font>Delay<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end
    else
     begin
        </b></font>Writeln<font color="#000080">(</font><font color="#800000">'TENTOOLS Not Initialized'</font><font color="#000080">);
        </font>Halt<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TBReceive<font color="#000080">( </font><font color="#FF0000"><b>VAR </b></font>SenderID<font color="#000080">: </font>S12<font color="#000080">;      </font><font color="#008000"><i>{Sending NodeID : String12       }
                    </i></font><font color="#FF0000"><b>VAR </b></font>DBuffer<font color="#000080">;           </font><font color="#008000"><i>{Variable (record) to receive    }
                    </i></font><font color="#FF0000"><b>VAR </b></font>DLength <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{Maximum length record to receive}
              </i></font><font color="#FF0000"><b>VAR </b></font>TransactionID <font color="#000080">: </font>TID<font color="#000080">;     </font><font color="#008000"><i>{See description of TBSend       }
                  </i></font><font color="#FF0000"><b>VAR </b></font>TransType <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{See description of TBSend       }
                  </i></font><font color="#FF0000"><b>VAR </b></font>Available <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{Number of records available
                                            including the one passed back   }
                         </i></font><font color="#FF0000"><b>VAR </b></font>CB <font color="#000080">: </font>Boolean<font color="#000080">) </font><font color="#008000"><i>{Was this a CB transmission?     }
                         </i></font><font color="#000080">: </font>Word<font color="#000080">;  </font><font color="#008000"><i>{Return code indicates a 10Net error($XXFF)
                                   or an error in a passed parameter ($FFXX)}
</i></font><font color="#FF0000"><b>VAR
   </b></font>LLRs<font color="#000080">,</font>LLRet<font color="#000080">,</font>I <font color="#000080">: </font>Integer<font color="#000080">;
   </font>SenderNode <font color="#000080">: </font>SID <font color="#FF0000"><b>absolute </b></font>ReceiveBuffer<font color="#000080">;
   </font>RLength <font color="#000080">: ^</font>Integer<font color="#000080">;
   </font>RPack <font color="#000080">: ^</font>PRec<font color="#000080">;
   </font>RcvData <font color="#000080">: ^</font>Byte<font color="#000080">;
   </font>CBM <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>TNTI
   <font color="#FF0000"><b>then
    begin
      </b></font>RLength<font color="#000080">:=@</font>ReceiveBuffer<font color="#000080">[</font><font color="#800000">13</font><font color="#000080">];
      </font>RPack<font color="#000080">:=@</font>ReceiveBuffer<font color="#000080">[</font><font color="#800000">15</font><font color="#000080">];
      </font>RcvData<font color="#000080">:=@</font>ReceiveBuffer<font color="#000080">[</font><font color="#800000">15</font><font color="#000080">+</font>Sizeof<font color="#000080">(</font>RPack<font color="#000080">^)];
      </font><font color="#FF0000"><b>Repeat </b></font><font color="#008000"><i>{process 10net receives}
         </i></font>LLRet<font color="#000080">:=</font>Receive<font color="#000080">(</font>ReceiveBuffer<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>LLRs<font color="#000080">,</font>CBM<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>LLRet<font color="#000080">=</font><font color="#800000">0
         </font><font color="#FF0000"><b>then
          begin
             </b></font>CPointer<font color="#000080">:=</font>TPointer<font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>RPack<font color="#000080">^.</font>Packet<font color="#000080">=</font><font color="#800000">1
             </font><font color="#FF0000"><b>then </b></font>CPointer<font color="#000080">:=</font>HPointer
             <font color="#FF0000"><b>else while </b></font><font color="#000080">((</font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TransID <font color="#000080">&lt;&gt; </font>RPack<font color="#000080">^.</font>TransID<font color="#000080">)
             </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>CPointer<font color="#000080">&lt;&gt;</font>HPointer<font color="#000080">)) </font><font color="#FF0000"><b>do
              begin
                 </b></font>CPointer<font color="#000080">:=</font>CPointer<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
                 </font><font color="#FF0000"><b>If </b></font>CPointer<font color="#000080">&gt;</font>MaxReceives <font color="#FF0000"><b>then </b></font>CPointer<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>CPointer<font color="#000080">=</font>HPointer
             <font color="#FF0000"><b>then
              begin
                 </b></font><font color="#008000"><i>{beginning a new record}
                 </i></font>HPointer<font color="#000080">:=</font>HPointer<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
                 </font><font color="#FF0000"><b>If </b></font>HPointer<font color="#000080">&gt;</font>MaxReceives <font color="#FF0000"><b>then </b></font>HPointer<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
                 </font><font color="#FF0000"><b>If </b></font>TPointer<font color="#000080">=</font>HPointer
                 <font color="#FF0000"><b>then
                  begin
                     </b></font>TPointer<font color="#000080">:=</font>TPointer<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>If </b></font>TPointer<font color="#000080">&gt;</font>MaxReceives <font color="#FF0000"><b>then </b></font>TPointer<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                 </font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>Sender<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                 </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>do
                 </b></font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>Sender<font color="#000080">:=</font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>Sender<font color="#000080">+</font>SenderNode<font color="#000080">[</font>I<font color="#000080">];
                 </font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TransID<font color="#000080">:=</font>RPack<font color="#000080">^.</font>TransID<font color="#000080">;
                 </font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TType<font color="#000080">:=</font>RPack<font color="#000080">^.</font>TType<font color="#000080">;
                 </font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>RTime<font color="#000080">:=</font>TimeStamp<font color="#000080">;
                 </font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TrackRecv<font color="#000080">:=[];
                 </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>RPack<font color="#000080">^.</font>TPackets <font color="#FF0000"><b>do
                 </b></font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TrackRecv<font color="#000080">:=</font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TrackRecv<font color="#000080">+[</font>I<font color="#000080">];
                 </font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>Resptype<font color="#000080">:=</font>RPack<font color="#000080">^.</font>RespType<font color="#000080">;
                 </font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TLength<font color="#000080">:=</font>RPack<font color="#000080">^.</font>TLength<font color="#000080">;
                 </font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>CB<font color="#000080">:=</font>CBM<font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font>Move<font color="#000080">(</font>RcvData<font color="#000080">^,</font>TBD<font color="#000080">^[</font>CPointer<font color="#000080">]^[</font>RPack<font color="#000080">^.</font>Packet<font color="#000080">],</font>RLength<font color="#000080">^-</font>Sizeof<font color="#000080">(</font>RPack<font color="#000080">^));
             </font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TrackRecv<font color="#000080">:=</font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TrackRecv<font color="#000080">-[</font>RPack<font color="#000080">^.</font>Packet<font color="#000080">];
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Until </b></font>LLRet<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#008000"><i>{Count number of records ready, keeping track of the first.}
      </i></font>Available<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font>CPointer<font color="#000080">:=</font>TPointer<font color="#000080">;
      </font><font color="#FF0000"><b>While </b></font>CPointer<font color="#000080">&lt;&gt;</font>HPointer <font color="#FF0000"><b>do
       begin
          If </b></font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TrackRecv<font color="#000080">=[]
          </font><font color="#FF0000"><b>then
           begin
              </b></font>Available<font color="#000080">:=</font>Available<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
              </font><font color="#FF0000"><b>If </b></font>Available<font color="#000080">=</font><font color="#800000">1
              </font><font color="#FF0000"><b>then
               begin
                  </b></font>SenderID<font color="#000080">:=</font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>Sender<font color="#000080">;
                  </font>DLength<font color="#000080">:=</font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TLength<font color="#000080">;
                  </font><font color="#FF0000"><b>If </b></font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TLength<font color="#000080">&gt;</font>MaxRecBufferSize
                  <font color="#FF0000"><b>then </b></font>DLength<font color="#000080">:=</font>MaxRecBufferSize<font color="#000080">;
                  </font>TransactionID<font color="#000080">:=</font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TransID<font color="#000080">;
                  </font>TransType<font color="#000080">:=</font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>TType<font color="#000080">;
                  </font>CB<font color="#000080">:=</font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>CB<font color="#000080">;
                  </font>Move<font color="#000080">(</font>TBD<font color="#000080">^[</font>CPointer<font color="#000080">]^,</font>DBuffer<font color="#000080">,</font>DLength<font color="#000080">);
                  </font><font color="#FF0000"><b>If </b></font>CPointer<font color="#000080">&lt;&gt;</font>TPointer
                  <font color="#FF0000"><b>then </b></font>Move<font color="#000080">(</font>TBR<font color="#000080">^[</font>TPointer<font color="#000080">],</font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">],</font>Sizeof<font color="#000080">(</font>TBR<font color="#000080">^[</font><font color="#800000">1</font><font color="#000080">]));
                  </font>TPointer<font color="#000080">:=</font>TPointer<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
                  </font><font color="#FF0000"><b>If </b></font>TPointer<font color="#000080">&gt;</font>MaxReceives <font color="#FF0000"><b>then </b></font>TPointer<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end
          else if </b></font><font color="#000080">((</font>CPointer<font color="#000080">=</font>TPointer<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>StampAge<font color="#000080">(</font>TBR<font color="#000080">^[</font>CPointer<font color="#000080">].</font>RTime<font color="#000080">)&gt;</font>MAXRCVWAIT<font color="#000080">))
          </font><font color="#FF0000"><b>then
           begin
              </b></font>TPointer<font color="#000080">:=</font>TPointer<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
              </font><font color="#FF0000"><b>If </b></font>TPointer<font color="#000080">&gt;</font>MaxReceives <font color="#FF0000"><b>then </b></font>TPointer<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>CPointer<font color="#000080">:=</font>CPointer<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>CPointer<font color="#000080">&gt;</font>MaxReceives <font color="#FF0000"><b>then </b></font>CPointer<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Available<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>TBReceive<font color="#000080">:=</font><font color="#800000">0
      </font><font color="#FF0000"><b>else if </b></font>LLRet<font color="#000080">&lt;&gt;</font><font color="#800000">$01FF </font><font color="#FF0000"><b>then </b></font>TBReceive<font color="#000080">:=</font>LLRet
      <font color="#FF0000"><b>else </b></font>TBReceive<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>end
  else
   begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'TENTOOLS Not Initialized'</font><font color="#000080">);
      </font>Halt<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Nodes<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>NodeBuffer<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>MaxNodes <font color="#000080">: </font>Integer<font color="#000080">;
                  </font>SuperstationsOnly <font color="#000080">: </font>Boolean<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ A call to this function should be made with NODEBUFFER being an
 Array[1..MaxNodes] of S12. MaxNodes being the largest number of nodes you
 expect to see on the network. If the Returncode of NODES is 0, MaxNodes will
 have the actual number of nodenames returned and the array will be filled
 with their names. SuperstationsOnly is a boolean which allows nodes to be
 called to list only superstations. }

</i></font><font color="#FF0000"><b>VAR
   </b></font>LIAV <font color="#000080">: </font>LongInt<font color="#000080">;
   </font>Av <font color="#000080">: </font>Word<font color="#000080">;
   </font>I<font color="#000080">,</font>J<font color="#000080">,</font>K<font color="#000080">,</font>MaxRecs <font color="#000080">: </font>Integer<font color="#000080">;
   </font>Adjust <font color="#000080">: </font>S12<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>MaxNodes<font color="#000080">&gt;</font><font color="#800000">1024 </font><font color="#FF0000"><b>then </b></font>MaxNodes<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>TNTI <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>MaxNodes<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">))
   </font><font color="#FF0000"><b>then with </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>LIAV<font color="#000080">:=</font>MaxAvail<font color="#000080">;
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>LIAV<font color="#000080">&gt;=</font><font color="#800000">$FFFF</font><font color="#000080">)
       </font><font color="#FF0000"><b>then </b></font>AV<font color="#000080">:=</font><font color="#800000">$FFFF
       </font><font color="#FF0000"><b>else </b></font>AV<font color="#000080">:=</font>LIAV<font color="#000080">;
       </font>MaxRecs<font color="#000080">:=</font>Av <font color="#FF0000"><b>div </b></font><font color="#800000">24</font><font color="#000080">;
       </font><font color="#FF0000"><b>If </b></font>MaxNodes<font color="#000080">&lt;</font>MaxRecs
       <font color="#FF0000"><b>then
        begin
           </b></font>MaxRecs<font color="#000080">:=</font>MaxNodes<font color="#000080">;
           </font>AV<font color="#000080">:=</font>MaxRecs<font color="#000080">*</font><font color="#800000">24</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>GetMem<font color="#000080">(</font>NodeArray<font color="#000080">,</font>AV<font color="#000080">);
       </font>AX<font color="#000080">:=</font><font color="#800000">$0D02</font><font color="#000080">;
       </font><font color="#FF0000"><b>If </b></font>SuperstationsOnly <font color="#FF0000"><b>then </b></font>AX<font color="#000080">:=</font><font color="#800000">$0D01</font><font color="#000080">;
       </font>CX<font color="#000080">:=</font>AV<font color="#000080">;
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>NodeArray<font color="#000080">^);
       </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>NodeArray<font color="#000080">^);
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font>NAArray<font color="#000080">:=@</font>NodeBuffer<font color="#000080">;
       </font>NWArray<font color="#000080">:=@</font>NodeArray<font color="#000080">^;
       </font>MaxNodes<font color="#000080">:=</font>CX<font color="#000080">;
       </font>K<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MaxNodes <font color="#FF0000"><b>do
        begin
           </b></font>Adjust<font color="#000080">:=</font><font color="#800000">'            '</font><font color="#000080">;
           </font><font color="#FF0000"><b>for </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>do Case </b></font>SuperStationsOnly <font color="#FF0000"><b>of
           </b></font>False <font color="#000080">: </font>Adjust<font color="#000080">[</font>I<font color="#000080">]:=</font>NodeArray<font color="#000080">^[</font>J<font color="#000080">].</font>NID<font color="#000080">[</font>I<font color="#000080">];
           </font>True <font color="#000080">: </font>Adjust<font color="#000080">[</font>I<font color="#000080">]:=</font>NWArray<font color="#000080">^[</font>J<font color="#000080">].</font>NID<font color="#000080">[</font>I<font color="#000080">];
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>If </b></font>SuperStationsOnly
           <font color="#FF0000"><b>then
            begin
               if </b></font><font color="#000080">(</font>NWArray<font color="#000080">^[</font>J<font color="#000080">].</font>Ver<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]</font><font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
               </font><font color="#FF0000"><b>then
                begin
                   </b></font>NAArray<font color="#000080">^[</font>K<font color="#000080">]:=</font>Adjust<font color="#000080">;
                   </font>Inc<font color="#000080">(</font>K<font color="#000080">);
                </font><font color="#FF0000"><b>end
            end
           else </b></font>NAArray<font color="#000080">^[</font>J<font color="#000080">]:=</font>Adjust<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0
       </font><font color="#FF0000"><b>then </b></font>Nodes<font color="#000080">:=</font>AX
       <font color="#FF0000"><b>else </b></font>Nodes<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font><font color="#FF0000"><b>If </b></font>SuperStationsOnly <font color="#FF0000"><b>then </b></font>MaxNodes<font color="#000080">:=</font>K<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
       </font>FreeMem<font color="#000080">(</font>NodeArray<font color="#000080">,</font>AV<font color="#000080">);
    </font><font color="#FF0000"><b>end
    else if </b></font><font color="#000080">(</font>MaxNodes<font color="#000080">&lt;=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Nodes<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetDevices<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">;
             </font><font color="#FF0000"><b>VAR </b></font>Device <font color="#000080">: </font>DeviceArray<font color="#000080">;
             </font><font color="#FF0000"><b>VAR </b></font>DeviceCount <font color="#000080">: </font>Integer<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ Returns a list of devices through the Variable parameter Devices (which is
  defined as Array[1..25] of S8). Uses the Get/Set/Delete/Get User Shared
  Device (Int-$6F,Service-$15) function call.
  }
</i></font><font color="#FF0000"><b>VAR
   </b></font>DCount <font color="#000080">: </font>Integer<font color="#000080">;
   </font>DeviceTable <font color="#000080">: </font>SDev<font color="#000080">;
   </font>SERVERZ <font color="#000080">: </font>S12<font color="#000080">;
   </font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>FillChar<font color="#000080">(</font>Device<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Device<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);  </font><font color="#008000"><i>{initialize to all nullstrings}
   </i></font><font color="#FF0000"><b>If </b></font>Loaded
   <font color="#FF0000"><b>then with </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>SERVERZ<font color="#000080">:=</font>Upcase12<font color="#000080">(</font>ServerID<font color="#000080">);
       </font>DCount<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font><font color="#FF0000"><b>Repeat
          </b></font>AX<font color="#000080">:=</font><font color="#800000">$1501</font><font color="#000080">;
          </font>BX<font color="#000080">:=</font>DCount<font color="#000080">;
          </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>ServerZ<font color="#000080">);
          </font>SI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ServerZ<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
          </font>ES<font color="#000080">:=</font>Seg<font color="#000080">(</font>DeviceTable<font color="#000080">);
          </font>DI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>DeviceTable<font color="#000080">);
          </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
          </font><font color="#FF0000"><b>If not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)
          </font><font color="#FF0000"><b>then
           begin
              </b></font>Device<font color="#000080">[</font>DCount<font color="#000080">]:=</font>DeviceTable<font color="#000080">.</font>Alias<font color="#000080">;
              </font>Inc<font color="#000080">(</font>DCount<font color="#000080">);
           </font><font color="#FF0000"><b>end
          else </b></font>GetDevices<font color="#000080">:=</font>AX<font color="#000080">;
       </font><font color="#FF0000"><b>Until </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">);
       </font>DeviceCount<font color="#000080">:=</font>DCount<font color="#000080">;
       </font><font color="#FF0000"><b>If </b></font>DeviceCount<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>GetDevices<font color="#000080">:=</font>AX <font color="#FF0000"><b>else </b></font>GetDevices<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>GetDevices<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetTableData<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>TableBuffer <font color="#000080">: </font>GetTableDataRec<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>VAR
 </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>Loaded <font color="#FF0000"><b>then
   With </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>do </b></font>TableBuffer<font color="#000080">.</font>NodeID<font color="#000080">[</font>I<font color="#000080">]:=</font>ConfigTable<font color="#000080">^.</font>CT_NID<font color="#000080">[</font>I<font color="#000080">];
       </font>TableBuffer<font color="#000080">.</font>Res1<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font>AX<font color="#000080">:=</font><font color="#800000">$1D00</font><font color="#000080">;
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>TableBuffer<font color="#000080">);
       </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>TableBuffer<font color="#000080">);
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)
        </font><font color="#FF0000"><b>then </b></font>GetTableData<font color="#000080">:=</font><font color="#800000">0
        </font><font color="#FF0000"><b>else </b></font>GetTableData<font color="#000080">:=</font>AX<font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>GetTableData<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>MountsAvail <font color="#000080">: </font>Integer<font color="#000080">;
 </font><font color="#FF0000"><b>VAR
    </b></font>TempTable <font color="#000080">: ^</font>GetTableDataRec<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>GetMem<font color="#000080">(</font>TempTable<font color="#000080">,</font>Sizeof<font color="#000080">(</font>GetTableDataRec<font color="#000080">));
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>GetTableData<font color="#000080">(</font>TempTable<font color="#000080">^)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
   </b></font>MountsAvail<font color="#000080">:=</font>TempTable<font color="#000080">^.</font>TenNetTables<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>Free<font color="#000080">+</font>TempTable<font color="#000080">^.</font>TenNetTables<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>Alloc
   <font color="#FF0000"><b>else </b></font>MountsAvail<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>FreeMem<font color="#000080">(</font>TempTable<font color="#000080">,</font>Sizeof<font color="#000080">(</font>GetTableDataRec<font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>MountList<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>MountTable <font color="#000080">: </font>DriveArray<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>PrintTable <font color="#000080">: </font>PrintArray<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>TableEntries <font color="#000080">: </font>Integer<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{Returns a mountlist of type DriveTable (with TableEntries as a count of
actual table entries returned), and PrintTable of Printer reassignments.
The caller must specify a maximum tablesize by setting table entries before
calling. Returns with a value of 0 if it worked without any hitches, and the
value of a 10net error if there is any problem. Will return with a value of
$FFFF if not loaded. Will return names of Devices if any are currently
&quot;NetUsed&quot;.}
</i></font><font color="#FF0000"><b>VAR
  </b></font>I<font color="#000080">,</font>IB<font color="#000080">,</font>IM <font color="#000080">: </font>Integer<font color="#000080">;
  </font>SA <font color="#000080">: </font>Word<font color="#000080">;
  </font>SR <font color="#000080">: </font>SearchRec<font color="#000080">;
  </font>MChar <font color="#000080">: </font>Char<font color="#000080">;
  </font>Highest <font color="#000080">: </font>Integer<font color="#000080">;
  </font>LD <font color="#000080">: ^</font>Byte<font color="#000080">;
  </font>HighestLocal <font color="#000080">: </font>Integer<font color="#000080">;
  </font>LDevBuffer <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>RDevBuffer <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>TableEntries<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>TableEntries<font color="#000080">:=</font><font color="#800000">26</font><font color="#000080">;
   </font>Highest<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>If not </b></font>Loaded
   <font color="#FF0000"><b>then </b></font>MountList<font color="#000080">:=</font><font color="#800000">$FFFF
   </font><font color="#FF0000"><b>else with </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>HighestLocal<font color="#000080">:=</font>ConfigTable<font color="#000080">^.</font>CT_PHYSDRVS<font color="#000080">;
       </font>MountList<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font>Highest<font color="#000080">:=</font>MountsAvail<font color="#000080">;
       </font><font color="#FF0000"><b>If </b></font>TableEntries<font color="#000080">&gt;</font>Highest <font color="#FF0000"><b>then </b></font>TableEntries<font color="#000080">:=</font>Highest<font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>MChar<font color="#000080">:=</font><font color="#800000">'A' </font><font color="#FF0000"><b>to </b></font>Char<font color="#000080">(</font>TableEntries<font color="#000080">+</font><font color="#800000">64</font><font color="#000080">) </font><font color="#FF0000"><b>do with </b></font>MountTable<font color="#000080">[</font>MChar<font color="#000080">] </font><font color="#FF0000"><b>do
        begin
           If </b></font>Ord<font color="#000080">(</font>MChar<font color="#000080">)-</font><font color="#800000">64</font><font color="#000080">&lt;=</font>HighestLocal <font color="#FF0000"><b>then </b></font>ServerID<font color="#000080">:=</font><font color="#800000">'Local       '
           </font><font color="#FF0000"><b>else </b></font>ServerID<font color="#000080">:=</font><font color="#800000">'            '</font><font color="#000080">;
           </font>RPath<font color="#000080">:=</font>MChar<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>MChar<font color="#000080">:=</font><font color="#800000">'1' </font><font color="#FF0000"><b>to </b></font><font color="#800000">'3' </font><font color="#FF0000"><b>do with </b></font>PrintTable<font color="#000080">[</font>MChar<font color="#000080">] </font><font color="#FF0000"><b>do
        begin
           </b></font>ServerID<font color="#000080">:=</font><font color="#800000">'            '</font><font color="#000080">;
           </font>RPath<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>IB<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font>Flags<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font><font color="#FF0000"><b>while not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
        begin
           </b></font>AX<font color="#000080">:=</font><font color="#800000">$1C00</font><font color="#000080">;
           </font>BX<font color="#000080">:=</font>IB<font color="#000080">;
           </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>SendSet<font color="#000080">);
           </font>DI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>SendSet<font color="#000080">);
           </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
           </font><font color="#FF0000"><b>If not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)
           </font><font color="#FF0000"><b>then
            begin
               </b></font>IM<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
               </font><font color="#FF0000"><b>While not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
                begin
                   </b></font>AX<font color="#000080">:=</font><font color="#800000">$1B00</font><font color="#000080">;
                   </font>BX<font color="#000080">:=</font>IM<font color="#000080">;
                   </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>SendSet<font color="#000080">);
                   </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>SendSet<font color="#000080">);
                   </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
                   </font><font color="#FF0000"><b>If not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)
                   </font><font color="#FF0000"><b>then
                    begin
                       If </b></font><font color="#000080">(</font>AH <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">65</font><font color="#000080">..</font><font color="#800000">90</font><font color="#000080">])
                       </font><font color="#FF0000"><b>then
                        begin
                           </b></font>MChar<font color="#000080">:=</font>Char<font color="#000080">(</font>AH<font color="#000080">);
                           </font><font color="#FF0000"><b>If </b></font>AH<font color="#000080">&lt;=(</font>TableEntries<font color="#000080">+</font><font color="#800000">64</font><font color="#000080">)
                           </font><font color="#FF0000"><b>then
                            begin
                               </b></font>MountTable<font color="#000080">[</font>MChar<font color="#000080">].</font>ServerID<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">#12</font><font color="#000080">;
                               </font>Move<font color="#000080">(</font>SendSet<font color="#000080">.</font>RNode<font color="#000080">,</font>MountTable<font color="#000080">[</font>MChar<font color="#000080">].</font>ServerID<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">12</font><font color="#000080">);
                               </font>MountTable<font color="#000080">[</font>MChar<font color="#000080">].</font>RPath<font color="#000080">:=</font>Char<font color="#000080">(</font>AL<font color="#000080">);
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>end
                       else if </b></font><font color="#000080">(</font>AH <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">49</font><font color="#000080">..</font><font color="#800000">51</font><font color="#000080">])
                       </font><font color="#FF0000"><b>then
                        begin
                           </b></font>MChar<font color="#000080">:=</font>Char<font color="#000080">(</font>AH<font color="#000080">);
                           </font>PrintTable<font color="#000080">[</font>MChar<font color="#000080">].</font>ServerID<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">#12</font><font color="#000080">;
                           </font>Move<font color="#000080">(</font>SendSet<font color="#000080">.</font>RNode<font color="#000080">,</font>PrintTable<font color="#000080">[</font>MChar<font color="#000080">].</font>ServerID<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">12</font><font color="#000080">);
                           </font>PrintTable<font color="#000080">[</font>MChar<font color="#000080">].</font>RPath<font color="#000080">:=</font>Char<font color="#000080">(</font>AL<font color="#000080">);
                        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                    </font><font color="#FF0000"><b>end
                   else if not </b></font><font color="#000080">(</font>AX<font color="#000080">=</font><font color="#800000">$25FF</font><font color="#000080">)
                   </font><font color="#FF0000"><b>then
                    begin
                       </b></font>MountList<font color="#000080">:=</font>AX<font color="#000080">;
                       </font>TableEntries<font color="#000080">:=</font>Highest<font color="#000080">;
                       </font>Exit<font color="#000080">;
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                   </font>Inc<font color="#000080">(</font>IM<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font>Flags<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
            </font><font color="#FF0000"><b>end
           else if not </b></font><font color="#000080">(</font>AX<font color="#000080">=</font><font color="#800000">$08FF</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>MountList<font color="#000080">:=</font>AX<font color="#000080">;
           </font>Inc<font color="#000080">(</font>IB<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>IB<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>Repeat
           </b></font>AX<font color="#000080">:=</font><font color="#800000">$5F02</font><font color="#000080">;
           </font>BX<font color="#000080">:=</font>IB<font color="#000080">;
           </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>LDevBuffer<font color="#000080">);
           </font>SI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>LDevBuffer<font color="#000080">);
           </font>ES<font color="#000080">:=</font>Seg<font color="#000080">(</font>RDevBuffer<font color="#000080">);
           </font>DI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>RDevBuffer<font color="#000080">);
           </font>MSDOS<font color="#000080">(</font>TenRegs<font color="#000080">);
           </font><font color="#FF0000"><b>If not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)
           </font><font color="#FF0000"><b>then with </b></font>MountTable<font color="#000080">[</font>LDevBuffer<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]] </font><font color="#FF0000"><b>do
            begin
               </b></font>I<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
               </font>RPath<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
               </font>ServerID<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
               </font><font color="#FF0000"><b>While not </b></font><font color="#000080">(</font>RDevBuffer<font color="#000080">[</font>I<font color="#000080">]=</font><font color="#800000">'\'</font><font color="#000080">) </font><font color="#FF0000"><b>do
                begin
                   </b></font>ServerID<font color="#000080">:=</font>ServerID<font color="#000080">+</font>RDevBuffer<font color="#000080">[</font>I<font color="#000080">];
                   </font>Inc<font color="#000080">(</font>I<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font>Inc<font color="#000080">(</font>I<font color="#000080">);
               </font><font color="#FF0000"><b>While not</b></font><font color="#000080">(</font>RDevBuffer<font color="#000080">[</font>I<font color="#000080">]=</font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>do
                begin
                   </b></font>RPath<font color="#000080">:=</font>RPath<font color="#000080">+</font>RDevBuffer<font color="#000080">[</font>I<font color="#000080">];
                   </font>Inc<font color="#000080">(</font>I<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font>Inc<font color="#000080">(</font>IB<font color="#000080">);
        </font><font color="#FF0000"><b>Until </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LogList<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Logins <font color="#000080">: </font>LogArray<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>TableEntries <font color="#000080">: </font>Integer<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{Returns a list of nodes that the local station is logged into. LogArray
 is a TYPE defined as Array[0..19] of String[12] and can be used in the
 calling program. }
</i></font><font color="#FF0000"><b>VAR
  </b></font>IB <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   If not </b></font>Loaded
   <font color="#FF0000"><b>then </b></font>LogList<font color="#000080">:=</font><font color="#800000">$FFFF
   </font><font color="#FF0000"><b>else with </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>IB<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font>Flags<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font><font color="#FF0000"><b>while not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
        begin
           </b></font>AX<font color="#000080">:=</font><font color="#800000">$1C00</font><font color="#000080">;
           </font>BX<font color="#000080">:=</font>IB<font color="#000080">;
           </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>Sendset<font color="#000080">);
           </font>DI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>SendSet<font color="#000080">);
           </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
           </font><font color="#FF0000"><b>If not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)
           </font><font color="#FF0000"><b>then
            begin
               </b></font>Logins<font color="#000080">[</font>IB<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">#12</font><font color="#000080">;
               </font>Move<font color="#000080">(</font>SendSet<font color="#000080">.</font>RNode<font color="#000080">,</font>Logins<font color="#000080">[</font>IB<font color="#000080">][</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">12</font><font color="#000080">);
               </font>Inc<font color="#000080">(</font>IB<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font>LogList<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>TableEntries<font color="#000080">:=</font>IB<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Submit<font color="#000080">(</font>ServerID <font color="#000080">: </font>S12<font color="#000080">; </font>CommandLine <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ If the local User is LOGGED INTO the node SERVERID, and the submit permit
 is ON at ServerID, and ServerID is currently at a DOS prompt, then the
 Commandline will be SUBMITTED to ServerID. If it is not currently at a DOS
 prompt, it will be SUBMITTED when it reaches a DOS prompt. }

</i></font><font color="#FF0000"><b>TYPE
   </b></font>SubmitRec <font color="#000080">= </font><font color="#FF0000"><b>Record
      </b></font>Nodeid <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
      </font>CLen   <font color="#000080">: </font>Integer<font color="#000080">;
      </font>CLine <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>ServerZ <font color="#000080">: </font>S12<font color="#000080">;
   </font>I <font color="#000080">: </font>Integer<font color="#000080">;
   </font>SRec <font color="#000080">: </font>SubmitRec<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>Loaded
   <font color="#FF0000"><b>then with </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>SERVERZ<font color="#000080">:=</font>Upcase12<font color="#000080">(</font>ServerID<font color="#000080">);
       </font>Move<font color="#000080">(</font>ServerZ<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>SRec<font color="#000080">.</font>Nodeid<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font><font color="#800000">#13</font><font color="#000080">,</font>Commandline<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>SRec<font color="#000080">.</font>CLen<font color="#000080">:=</font>Pos<font color="#000080">(</font><font color="#800000">#13</font><font color="#000080">,</font>Commandline<font color="#000080">)-</font><font color="#800000">1
       </font><font color="#FF0000"><b>else </b></font>SRec<font color="#000080">.</font>CLen<font color="#000080">:=</font>Length<font color="#000080">(</font>Commandline<font color="#000080">);
       </font>CommandLine<font color="#000080">:=</font>CommandLine<font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">+</font><font color="#800000">#10</font><font color="#000080">;
       </font>Inc<font color="#000080">(</font>SRec<font color="#000080">.</font>CLen<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
       </font>Move<font color="#000080">(</font>Commandline<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>SRec<font color="#000080">.</font>CLine<font color="#000080">,</font>SRec<font color="#000080">.</font>CLen<font color="#000080">);
       </font>AX<font color="#000080">:=</font><font color="#800000">$0900</font><font color="#000080">;
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>SRec<font color="#000080">);
       </font>BX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>SRec<font color="#000080">);
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then
        begin
           </b></font>Submit<font color="#000080">:=</font>AX<font color="#000080">;
        </font><font color="#FF0000"><b>end
       else </b></font>Submit<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>Submit<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SetSpool<font color="#000080">(</font>Printer <font color="#000080">: </font>Byte<font color="#000080">; </font>SpoolName <font color="#000080">: </font>S12<font color="#000080">; </font>Notification <font color="#000080">: </font>NotifySet<font color="#000080">; </font>RDays <font color="#000080">: </font>Byte<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ When SetSpool is first called, it merely sets up a &quot;Template&quot; for
  subsequent calls to OpenSpool and CloseSpool. You must be logged into the
  Superstation where you want to spool and be mounted to a printer and a
  drive on that Superstation. SetSpool will determine where the Printer
  (1,2, or 3 for your local LPT1:,LPT2:, or LPT3:) is mounted and a drive
  letter that you are mounted to. }

</i></font><font color="#FF0000"><b>VAR
  </b></font>NT <font color="#000080">: </font>NotifyTypes<font color="#000080">;
  </font>DriveTable <font color="#000080">: </font>DriveArray<font color="#000080">;
  </font>PrintTable <font color="#000080">: </font>PrintArray<font color="#000080">;
  </font>MaxDrive <font color="#000080">: </font>Integer<font color="#000080">;
  </font>SSC <font color="#000080">: </font>Char<font color="#000080">;
  </font>Pr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];
  </font>SplServer <font color="#000080">: </font>S12<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   If </b></font>Loaded <font color="#FF0000"><b>then with </b></font>SpoolSettings <font color="#FF0000"><b>do
    begin
</b></font><font color="#008000"><i>{ Look at which server printer is mounted on and find out which drives it is
  also mounted to. }
       </i></font>MaxDrive<font color="#000080">:=</font><font color="#800000">26</font><font color="#000080">;
       </font>TenTest<font color="#000080">:=</font>MountList<font color="#000080">(</font>DriveTable<font color="#000080">,</font>PrintTable<font color="#000080">,</font>MaxDrive<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>TenTest<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then
        begin
           </b></font>SplServer<font color="#000080">:=</font>PrintTable<font color="#000080">[</font>Char<font color="#000080">(</font>Printer<font color="#000080">+</font><font color="#800000">48</font><font color="#000080">)].</font>ServerID<font color="#000080">;
           </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>SplServer<font color="#000080">=</font><font color="#800000">'            '</font><font color="#000080">)</font><font color="#FF0000"><b>or</b></font><font color="#000080">(</font>SplServer<font color="#000080">=</font><font color="#800000">'Local       '</font><font color="#000080">))
           </font><font color="#FF0000"><b>then </b></font>SplServer<font color="#000080">:=</font><font color="#800000">''
           </font><font color="#FF0000"><b>else
            begin
               </b></font>Pr<font color="#000080">:=</font><font color="#800000">'LPT'</font><font color="#000080">+</font>Char<font color="#000080">(</font>Printer<font color="#000080">+</font><font color="#800000">48</font><font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">;
               </font>SSC<font color="#000080">:=</font><font color="#800000">'A'</font><font color="#000080">;
               </font><font color="#FF0000"><b>While not </b></font><font color="#000080">((</font>SSC<font color="#000080">&gt;</font>Char<font color="#000080">(</font>MaxDrive<font color="#000080">+</font><font color="#800000">64</font><font color="#000080">))</font><font color="#FF0000"><b>or</b></font><font color="#000080">(</font>DriveTable<font color="#000080">[</font>SSC<font color="#000080">].</font>ServerID<font color="#000080">=</font>SplServer<font color="#000080">)) </font><font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>SSC<font color="#000080">);
               </font><font color="#FF0000"><b>If not </b></font><font color="#000080">(</font>DriveTable<font color="#000080">[</font>SSC<font color="#000080">].</font>ServerID<font color="#000080">=</font>SplServer<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>SSC<font color="#000080">:=</font><font color="#800000">#0</font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>SSC<font color="#000080">&lt;&gt;</font><font color="#800000">#0</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>SplServer<font color="#000080">&lt;&gt;</font><font color="#800000">''</font><font color="#000080">))
           </font><font color="#FF0000"><b>then
            begin
               </b></font>UDVC<font color="#000080">:=</font>Printer<font color="#000080">;
               </font>UDVC<font color="#000080">:=</font>UDVC<font color="#000080">+(</font>Ord<font color="#000080">(</font>SSC<font color="#000080">)-</font><font color="#800000">64</font><font color="#000080">)</font><font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">;
               </font>UCode<font color="#000080">:=</font><font color="#800000">00</font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font>Spoolname<font color="#000080">&lt;&gt;</font><font color="#800000">''
               </font><font color="#FF0000"><b>then
                begin
                   While </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>Spoolname<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Delete<font color="#000080">(</font>Spoolname<font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>Spoolname<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
                   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>Spoolname<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>Spoolname<font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>Spoolname<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>Spoolname<font color="#000080">)&lt;</font><font color="#800000">11 </font><font color="#FF0000"><b>do </b></font>Spoolname<font color="#000080">:=</font>Spoolname<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
               </font>Move<font color="#000080">(</font>Spoolname<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>SpoolSettings<font color="#000080">.</font>UFile<font color="#000080">,</font><font color="#800000">11</font><font color="#000080">);
               </font>UNote<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Start <font color="#FF0000"><b>in </b></font>Notification<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>UNote<font color="#000080">:=</font>UNote <font color="#FF0000"><b>or </b></font><font color="#800000">1</font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Reply <font color="#FF0000"><b>in </b></font>Notification<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>UNote<font color="#000080">:=</font>UNote <font color="#FF0000"><b>or </b></font><font color="#800000">2</font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Completion <font color="#FF0000"><b>in </b></font>Notification<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>UNote<font color="#000080">:=</font>UNote <font color="#FF0000"><b>or </b></font><font color="#800000">4</font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>ExplQueue <font color="#FF0000"><b>in </b></font>Notification<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>UNote<font color="#000080">:=</font>UNote <font color="#FF0000"><b>or </b></font><font color="#800000">8</font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>NoFF <font color="#FF0000"><b>in </b></font>Notification<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>UNote<font color="#000080">:=</font>UNote <font color="#FF0000"><b>or </b></font><font color="#800000">32</font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>IDPage <font color="#FF0000"><b>in </b></font>Notification<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>UNote<font color="#000080">:=</font>UNote <font color="#FF0000"><b>or </b></font><font color="#800000">64</font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>QueueTop <font color="#FF0000"><b>in </b></font>Notification<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>UNote<font color="#000080">:=</font>UNote <font color="#FF0000"><b>or </b></font><font color="#800000">2</font><font color="#000080">;
               </font>UDays<font color="#000080">:=</font>RDays<font color="#000080">;
               </font>ULen<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
               </font>UArea<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
               </font>SetSpool<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
               </font>Spooling<font color="#000080">:=</font>True<font color="#000080">;
            </font><font color="#FF0000"><b>end
           else </b></font>SetSpool<font color="#000080">:=</font><font color="#800000">$23FF</font><font color="#000080">;
        </font><font color="#FF0000"><b>end
       else </b></font>SetSpool<font color="#000080">:=</font><font color="#800000">$25FF</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
  else </b></font>SetSpool<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>OpenSpool<font color="#000080">(</font>NewSpoolname <font color="#000080">: </font>S12<font color="#000080">) : </font>Word<font color="#000080">;
 </font><font color="#008000"><i>{Once SetSpool has &quot;configured&quot; your spool, calls to OpenSpool will
  create a new spoolfile with the optional Newspoolname, or with a name
  automatically set by 10Net if NewSpoolName=''. }

</i></font><font color="#FF0000"><b>VAR
   </b></font>OpenSpoolSet <font color="#000080">: </font>SpoolBlock<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   If </b></font>Spooling
   <font color="#FF0000"><b>then with </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       If </b></font>NewSpoolname<font color="#000080">&lt;&gt;</font><font color="#800000">''
       </font><font color="#FF0000"><b>then
        begin
           While </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>NewSpoolname<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Delete<font color="#000080">(</font>NewSpoolname<font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>NewSpoolname<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>NewSpoolname<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>NewSpoolname<font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>NewSpoolname<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>NewSpoolname<font color="#000080">)&lt;</font><font color="#800000">11 </font><font color="#FF0000"><b>do </b></font>NewSpoolname<font color="#000080">:=</font>NewSpoolname<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
       </font>Move<font color="#000080">(</font>NewSpoolname<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>SpoolSettings<font color="#000080">.</font>UFile<font color="#000080">,</font><font color="#800000">11</font><font color="#000080">);
       </font>Move<font color="#000080">(</font>SpoolSettings<font color="#000080">,</font>OpenSpoolSet<font color="#000080">,</font>Sizeof<font color="#000080">(</font>SpoolSettings<font color="#000080">));
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>OpenSpoolSet<font color="#000080">);
       </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>OpenSpoolSet<font color="#000080">);
       </font>AX<font color="#000080">:=</font><font color="#800000">$0E00</font><font color="#000080">;
       </font>OpenSpoolSet<font color="#000080">.</font>UCode<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then
        begin
           </b></font>OpenSpool<font color="#000080">:=</font>AX<font color="#000080">;
        </font><font color="#FF0000"><b>end
       else </b></font>OpenSpool<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>OpenSpool<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>CloseSpool <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ Calls to CloseSpool, after a spool has been started through OpenSpool and
  some print has been &quot;sent to the printer&quot;, will cause the Spoolfile to
  close and printing to begin if the Print Permit is ON at the location
  where the printer is mounted.
     &quot;Sending print to the printer&quot; is done in the usual manner, from within
  programs, by &quot;Typing and Piping&quot; (TYPE&gt;LPT1 &lt;filename&gt;), by Copying from a
  file to the printer, etc.}

</i></font><font color="#FF0000"><b>VAR
   </b></font>CloseSpoolSet <font color="#000080">: </font>SpoolBlock<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>Spooling
   <font color="#FF0000"><b>then with </b></font>TenRegs <font color="#FF0000"><b>do
    begin
       </b></font>Move<font color="#000080">(</font>SpoolSettings<font color="#000080">,</font>CloseSpoolSet<font color="#000080">,</font>Sizeof<font color="#000080">(</font>SpoolSettings<font color="#000080">));
       </font>DS<font color="#000080">:=</font>Seg<font color="#000080">(</font>CloseSpoolSet<font color="#000080">);
       </font>DX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>CloseSpoolSet<font color="#000080">);
       </font>AX<font color="#000080">:=</font><font color="#800000">$0E00</font><font color="#000080">;
       </font>CloseSpoolSet<font color="#000080">.</font>UCode<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)
       </font><font color="#FF0000"><b>then
        begin
           </b></font>CloseSpool<font color="#000080">:=</font>AX<font color="#000080">;
        </font><font color="#FF0000"><b>end
       else </b></font>CloseSpool<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>CloseSpool<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>TenConfig<font color="#000080">(</font>MaxSendRec<font color="#000080">,</font>MaxRecvRec <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{Size of largest records
                                                     to send/receive}
                   </i></font>MaxRecs <font color="#000080">: </font>Integer<font color="#000080">)   </font><font color="#008000"><i>{Maximum number of Records to recv}
                          </i></font><font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
   </font>RetCode <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ This function allows the user to dynamically change the size of the
buffers being used by TBSend and TBReceive to optimize usage.
MaxSendRec is the size of the largest TBSEND record
MaxRecvRec is the size of the largest TBRECEIVE record
MaxRecs is the number of TBReceive records to buffer
}
</i></font><font color="#FF0000"><b>Begin
   If </b></font>TNTI
   <font color="#FF0000"><b>then
    begin
       For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MaxReceives <font color="#FF0000"><b>do
        begin
           </b></font>FreeMem<font color="#000080">(</font>TBD<font color="#000080">^[</font>I<font color="#000080">],</font>Sizeof<font color="#000080">(</font>RcvBlock<font color="#000080">)*</font>MaxRecvSets<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>FreeMem<font color="#000080">(</font>TBD<font color="#000080">,</font>MaxReceives<font color="#000080">*</font><font color="#800000">4</font><font color="#000080">);
       </font>FreeMem<font color="#000080">(</font>TBR<font color="#000080">,</font>MaxReceives<font color="#000080">*</font>Sizeof<font color="#000080">(</font>RecvRec<font color="#000080">));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>RetCode<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>MaxRecs<font color="#000080">&lt;</font><font color="#800000">1310 </font><font color="#FF0000"><b>then </b></font>MaxReceives<font color="#000080">:=</font>MaxRecs
   <font color="#FF0000"><b>else </b></font>RetCode<font color="#000080">:=</font>RetCode<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>MaxSendRec<font color="#000080">&lt;=</font><font color="#800000">65521 </font><font color="#FF0000"><b>then </b></font>MaxSendBufferSize<font color="#000080">:=</font>MaxSendRec
   <font color="#FF0000"><b>else </b></font>RetCode<font color="#000080">:=</font>RetCode<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>MaxRecvRec<font color="#000080">&lt;=</font><font color="#800000">65521 </font><font color="#FF0000"><b>then </b></font>MaxRecBuffersize<font color="#000080">:=</font>MaxRecvRec
   <font color="#FF0000"><b>else </b></font>RetCode<font color="#000080">:=</font>RetCode<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>MaxRecs<font color="#000080">&gt;</font><font color="#800000">0
   </font><font color="#FF0000"><b>then
    begin
       </b></font>MaxRecvSets<font color="#000080">:= </font>MaxRecBufferSize <font color="#FF0000"><b>div </b></font><font color="#800000">457 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
       </font>GetMem<font color="#000080">(</font>TBR<font color="#000080">,</font>MaxReceives<font color="#000080">*</font>Sizeof<font color="#000080">(</font>RecvRec<font color="#000080">));
       </font>GetMem<font color="#000080">(</font>TBD<font color="#000080">,</font>MaxReceives<font color="#000080">*</font><font color="#800000">4</font><font color="#000080">);
       </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MaxReceives <font color="#FF0000"><b>do
       </b></font>GetMem<font color="#000080">(</font>TBD<font color="#000080">^[</font>I<font color="#000080">],</font>Sizeof<font color="#000080">(</font>RcvBlock<font color="#000080">)*</font>MaxRecvSets<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>TenConfig<font color="#000080">:=</font>RetCode<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SetWait<font color="#000080">(</font>WaitLimit <font color="#000080">: </font>Integer<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ Changes the maximum seconds to wait for receive packets in the same record,
  Defaults to 30 }
</i></font><font color="#FF0000"><b>Begin
   If </b></font><font color="#000080">((</font>WaitLimit<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>WaitLimit<font color="#000080">&lt;</font><font color="#800000">3000</font><font color="#000080">))
   </font><font color="#FF0000"><b>then
    begin
       </b></font>MaxRcvWait<font color="#000080">:=</font>WaitLimit<font color="#000080">;
       </font>SetWait<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end
   else </b></font>SetWait<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>SetUserName<font color="#000080">(</font>UName <font color="#000080">: </font>S8<font color="#000080">);
</font><font color="#008000"><i>{Changes the Username in the Network Table and in the Global variable
  USERNAME}
</i></font><font color="#FF0000"><b>VAR
   </b></font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>Loaded
   <font color="#FF0000"><b>then
    begin
       </b></font>UserName<font color="#000080">:=</font>Upcase8<font color="#000080">(</font>UName<font color="#000080">);
       </font>Move<font color="#000080">(</font>UserName<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>ConfigTable<font color="#000080">^.</font>CT_LName<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
    </font><font color="#FF0000"><b>end
   else </b></font>UserName<font color="#000080">:=</font>Upcase8<font color="#000080">(</font>UName<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ The Unit Initialization Code below locates the Configuration Table Address
and establishes the buffers necessary to make 10Net function calls. It will
be called at the beginning of a program to make the tools available
throughout the program. }


</i></font><font color="#FF0000"><b>Begin
   If </b></font>Loaded
   <font color="#FF0000"><b>then with </b></font>TenRegs <font color="#FF0000"><b>do
    begin
</b></font><font color="#008000"><i>(*      Initially, no space is allocated for Sends and Receives; These
       buffers can be established dynamically with a call to TenConfig.
       TenTest:=TenConfig(MaxSendBufferSize,MaxRecBufferSize,MaxReceives);
       If TenTest&lt;&gt;0 then Writeln('TenConfig Error: ',TenTest);
*)       </i></font>AX<font color="#000080">:=</font><font color="#800000">$0300</font><font color="#000080">;
       </font>Intr<font color="#000080">(</font><font color="#800000">$6F</font><font color="#000080">,</font>TenRegs<font color="#000080">);
       </font>ConfigTable<font color="#000080">:=</font>Ptr<font color="#000080">(</font>ES<font color="#000080">,</font>BX<font color="#000080">);
       </font>PreConfig<font color="#000080">:=</font>Ptr<font color="#000080">(</font>ES<font color="#000080">,</font>BX<font color="#000080">-</font><font color="#800000">51</font><font color="#000080">);
       </font>UserName<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>I10<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do </b></font>UserName<font color="#000080">:=</font>UserName<font color="#000080">+</font>ConfigTable<font color="#000080">^.</font>CT_LName<font color="#000080">[</font>I10<font color="#000080">];
       </font>TNTI<font color="#000080">:=</font>True<font color="#000080">;
       </font>Spooling<font color="#000080">:=</font>False<font color="#000080">;
    </font><font color="#FF0000"><b>end
   else
    begin
       </b></font>Writeln<font color="#000080">(</font><font color="#800000">'TenTools inititalization Error!'</font><font color="#000080">);
       </font>Writeln<font color="#000080">(</font><font color="#800000">'Netword not Loaded!'</font><font color="#000080">);
       </font>Spooling<font color="#000080">:=</font>False<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">. </font><font color="#008000"><i>{ Of TenTools Unit }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0052.PAS">Original</a><b>]</b></p></body>
</html>
