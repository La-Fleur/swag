<html>
<head><title> "Netware 3.11 API Library - NetTTS" by S.PEREVOZNIK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0044.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
            &Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;
            &ordm;     &Uacute;&Euml;&Iacute;&Iacute;&Iacute;&Euml;&iquest;&Uacute;&Euml;&Iacute;&Iacute;&Iacute;&Euml;&iquest;&Uacute;&Euml;&Iacute;&Iacute;&Iacute;&Euml;&iquest;&Uacute;&Euml;&Iacute;&raquo; &Euml;&iquest;&Uacute;&Euml;&Iacute;&Iacute;&Iacute;&Euml;&iquest;&Uacute;&Eacute;&Iacute;&Euml;&Iacute;&raquo;&iquest;   &ordm;
            &ordm;     &sup3;&Igrave;&Iacute;&Iacute;&Iacute;&Ecirc;&Ugrave;&Atilde;&Icirc;&Iacute;&Iacute;&Iacute;&Icirc;&acute;&Agrave;&Ecirc;&Iacute;&Iacute;&Iacute;&Euml;&iquest;&sup3;&ordm; &ordm; &ordm;&sup3;&Atilde;&Icirc;&Iacute;&Iacute;      &ordm;      &ordm;
            &ordm;     &Agrave;&Ecirc;     &Agrave;&Ecirc;   &Ecirc;&Ugrave;&Agrave;&Ecirc;&Iacute;&Iacute;&Iacute;&Ecirc;&Ugrave;&Agrave;&Ecirc; &Egrave;&Iacute;&Ecirc;&Ugrave;&Agrave;&Ecirc;&Iacute;&Iacute;&Iacute;&Ecirc;&Ugrave;   &Ecirc;      &ordm;
            &ordm;                                                  &ordm;
            &ordm;     NetWare 3.11 API Library for Turbo Pascal    &ordm;
            &ordm;                      by                          &ordm;
            &ordm;                  S.Perevoznik                    &ordm;
            &ordm;                     1996                         &ordm;
            &Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;
}

</i></font><font color="#FF0000"><b>Unit </b></font>NetTTS<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses </b></font>NetConv<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TTSIsAvailable <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#008000"><i>{True, if TTS is available}

</i></font><font color="#FF0000"><b>Function </b></font>TTSAbortTransaction <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#008000"><i>{Abort current transaction}

</i></font><font color="#FF0000"><b>Function </b></font>TTSBeginTransaction <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#008000"><i>{Begin new transaction}

</i></font><font color="#FF0000"><b>Function </b></font>TTSEndTransaction <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>transNumber <font color="#000080">: </font>longInt<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#008000"><i>{End current transaction}

</i></font><font color="#FF0000"><b>Function </b></font>TTSTransactionStatus<font color="#000080">(</font>transNumber <font color="#000080">: </font>longint<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#008000"><i>{Return transaction status}

</i></font><font color="#FF0000"><b>Implementation

Uses </b></font>Dos<font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>TTSIsAvailable <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>r <font color="#000080">: </font>registers<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$C7</font><font color="#000080">;
  </font>r<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$02</font><font color="#000080">;
  </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>r<font color="#000080">);
  </font>TTSIsAvailable <font color="#000080">:= </font>r<font color="#000080">.</font>AL<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TTSAbortTransaction <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>r <font color="#000080">: </font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$C7</font><font color="#000080">;
  </font>r<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$03</font><font color="#000080">;
  </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>r<font color="#000080">);
  </font>TTSAbortTransaction <font color="#000080">:= </font>r<font color="#000080">.</font>AL<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TTSBeginTransaction <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>r <font color="#000080">: </font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$C7</font><font color="#000080">;
  </font>r<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
  </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>r<font color="#000080">);
  </font>TTSBeginTransaction <font color="#000080">:= </font>r<font color="#000080">.</font>AL<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TTSEndTransaction <font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>transNumber <font color="#000080">: </font>longInt<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>r <font color="#000080">: </font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$C7</font><font color="#000080">;
   </font>r<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;
   </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>r<font color="#000080">);
   </font>transNumber <font color="#000080">:= </font>Int2Long<font color="#000080">(</font>r<font color="#000080">.</font>DX<font color="#000080">,</font>r<font color="#000080">.</font>CX<font color="#000080">);
   </font>TTSEndTransAction <font color="#000080">:= </font>r<font color="#000080">.</font>AL<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>TTSTransactionStatus<font color="#000080">(</font>transNumber <font color="#000080">: </font>longint<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>r <font color="#000080">: </font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$C7</font><font color="#000080">;
  </font>r<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$04</font><font color="#000080">;
  </font>long2Int<font color="#000080">(</font>transNumber<font color="#000080">,</font>r<font color="#000080">.</font>DX<font color="#000080">,</font>r<font color="#000080">.</font>CX<font color="#000080">);
  </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>r<font color="#000080">);
  </font>TTSTransactionStatus <font color="#000080">:= </font>r<font color="#000080">.</font>AL<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0044.PAS">Original</a><b>]</b></p></body>
</html>
