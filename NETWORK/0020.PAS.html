<html>
<head><title> "Re: Get Server Date" by JIM ROBB</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 MP&gt; Can someone show me what a PASCAL procedure would look like to
 MP&gt; encapsulate the following information (from Brown's int list):
 MP&gt; INT 21 - Novell NetWare - FILE SERVER - GET FILE SERVER DATE AND TIME

I tested this on our Novell 3.11 network:
}

</i></font><font color="#FF0000"><b>program </b></font>ServDate<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>tDateAndTime <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>Year      <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Month     <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Day       <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Hours     <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Minutes   <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Seconds   <font color="#000080">: </font>Byte<font color="#000080">;
    </font>DayOfWeek <font color="#000080">: </font>Byte
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>String9 <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[ </font><font color="#800000">9 </font><font color="#000080">];

</font><font color="#FF0000"><b>const
  </b></font>DayArray <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[ </font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6 </font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>String9 <font color="#000080">=
             ( </font><font color="#800000">'Sunday'</font><font color="#000080">, </font><font color="#800000">'Monday'</font><font color="#000080">, </font><font color="#800000">'Tuesday'</font><font color="#000080">, </font><font color="#800000">'Wednesday'</font><font color="#000080">,
               </font><font color="#800000">'Thursday'</font><font color="#000080">, </font><font color="#800000">'Friday'</font><font color="#000080">, </font><font color="#800000">'Saturday' </font><font color="#000080">);

  </font>MonthArray <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[ </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12 </font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>String9 <font color="#000080">=
               ( </font><font color="#800000">'January'</font><font color="#000080">, </font><font color="#800000">'February'</font><font color="#000080">, </font><font color="#800000">'March'</font><font color="#000080">, </font><font color="#800000">'April'</font><font color="#000080">, </font><font color="#800000">'May'</font><font color="#000080">, </font><font color="#800000">'June'</font><font color="#000080">,
                 </font><font color="#800000">'July'</font><font color="#000080">, </font><font color="#800000">'August'</font><font color="#000080">, </font><font color="#800000">'September'</font><font color="#000080">, </font><font color="#800000">'October'</font><font color="#000080">, </font><font color="#800000">'November'</font><font color="#000080">,
                 </font><font color="#800000">'December' </font><font color="#000080">);


</font><font color="#FF0000"><b>function </b></font>GetFileServerDateAndTime<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>DTBuf <font color="#000080">: </font>tDateAndTime <font color="#000080">) : </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>NovRegs <font color="#000080">: </font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>begin
  with </b></font>NovRegs <font color="#FF0000"><b>do
  begin
    </b></font>AH <font color="#000080">:= </font><font color="#800000">$E7</font><font color="#000080">;
    </font>DS <font color="#000080">:= </font>Seg<font color="#000080">( </font>DTBuf <font color="#000080">);
    </font>DX <font color="#000080">:= </font>Ofs<font color="#000080">( </font>DTBuf <font color="#000080">);
    </font>MSDos<font color="#000080">( </font>NovRegs <font color="#000080">);
    </font>GetFileServerDateAndTime <font color="#000080">:= </font>AL
  <font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>DateAndTime <font color="#000080">: </font>tDateAndTime<font color="#000080">;
  </font>ResultCode  <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ResultCode <font color="#000080">:= </font>GetFileServerDateAndTime<font color="#000080">( </font>DateAndTime <font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>ResultCode <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    with </b></font>DateAndTime <font color="#FF0000"><b>do
    begin
      </b></font>Write<font color="#000080">( </font><font color="#800000">'File server date/time = '</font><font color="#000080">, </font>DayArray<font color="#000080">[ </font>DayOfWeek <font color="#000080">], </font><font color="#800000">', '</font><font color="#000080">,
             </font>MonthArray<font color="#000080">[ </font>Month <font color="#000080">], </font><font color="#800000">' '</font><font color="#000080">, </font>Day <font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>Year <font color="#000080">&lt; </font><font color="#800000">80 </font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>Write<font color="#000080">( </font><font color="#800000">', 20'</font><font color="#000080">, </font>Year <font color="#000080">)
      </font><font color="#FF0000"><b>else
        </b></font>Write<font color="#000080">( </font><font color="#800000">', 19'</font><font color="#000080">, </font>Year <font color="#000080">);
      </font>WriteLn<font color="#000080">( </font><font color="#800000">' at '</font><font color="#000080">, </font>Hours<font color="#000080">, </font><font color="#800000">':'</font><font color="#000080">, </font>Minutes<font color="#000080">, </font><font color="#800000">':'</font><font color="#000080">, </font>Seconds <font color="#000080">)
    </font><font color="#FF0000"><b>end
  else
    </b></font>WriteLn<font color="#000080">( </font><font color="#800000">'Date/time call unsuccessful' </font><font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p></body>
</html>
