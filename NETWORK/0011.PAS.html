<html>
<head><title> "NETWARE User name" by NORBERT IGL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: NORBERT IGL
Subj: Netware &quot;User name&quot;

 I need a way to get the current user name from the netware shell.
 For instance, if I'm logged into server MYSERVER as user SUPERVISOR,
 I need some way to get 'supervisor' as the user name.  (Kind of like
 WHOAMI would return: You are user SUPERVISOR on server MYSERVER)
}

</i></font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>lStationNumber<font color="#000080">:</font>byte<font color="#000080">;   </font><font color="#008000"><i>{ MY logical Station(connection)-Number }
</i></font><font color="#FF0000"><b>var   </b></font>regs     <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$DC</font><font color="#000080">;
   </font>MsDos<font color="#000080">(</font>regs <font color="#000080">);
   </font>lStationNumber <font color="#000080">:= </font>pcregs<font color="#000080">.</font>al<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>GetUserName<font color="#000080">( </font>Station<font color="#000080">: </font>byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>i               <font color="#000080">: </font>byte<font color="#000080">;
  </font>Regs            <font color="#000080">: </font>Registers<font color="#000080">;
  </font>name            <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">50</font><font color="#000080">];
  </font>Reply    <font color="#000080">: </font><font color="#FF0000"><b>Record
                </b></font>Filler1      <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
                </font>ObjectName   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">48</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
                </font>Filler2me    <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Request <font color="#000080">: </font><font color="#FF0000"><b>Record
               </b></font>PacketLen <font color="#000080">: </font>Integer<font color="#000080">;
               </font>vFunc     <font color="#000080">: </font>Byte<font color="#000080">;
               </font>ConnNb    <font color="#000080">: </font>Byte<font color="#000080">;
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  With </b></font>Request <font color="#FF0000"><b>do
  begin
    </b></font>PacketLen <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
    </font>vFunc     <font color="#000080">:= </font><font color="#800000">22</font><font color="#000080">;
    </font>ConnNbm   <font color="#000080">:= </font>Station<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Reply<font color="#000080">.</font>ReturnLength <font color="#000080">:= </font><font color="#800000">62</font><font color="#000080">;
  </font><font color="#FF0000"><b>With </b></font>Regs <font color="#FF0000"><b>Do Begin
    </b></font>Ah <font color="#000080">:= </font><font color="#800000">$e3</font><font color="#000080">;
    </font>Ds <font color="#000080">:= </font>Seg<font color="#000080">(</font>Request<font color="#000080">);
    </font>Si <font color="#000080">:= </font>Ofs<font color="#000080">(</font>Request<font color="#000080">);
    </font>Es <font color="#000080">:= </font>Seg<font color="#000080">(</font>Reply<font color="#000080">);
    </font>Di <font color="#000080">:= </font>Ofs<font color="#000080">(</font>Reply<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>MsDos<font color="#000080">(</font>Reg<font color="#000080">);
          </font><font color="#008000"><i>{         1         2         3         4        }
          {123456789012345678901234567890123456789012345678}
  </i></font>name <font color="#000080">:= </font><font color="#800000">'                                                '</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Regs<font color="#000080">.</font>al <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then with </b></font>reply <font color="#FF0000"><b>do
  begin
     </b></font>move<font color="#000080">( </font>objectName<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] , </font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font><font color="#800000">48 </font><font color="#000080">);
     </font>i <font color="#000080">:= </font>pos<font color="#000080">(</font><font color="#800000">#0</font><font color="#000080">, </font>name <font color="#000080">);
     </font>name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>char<font color="#000080">(</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

[...]

</font><font color="#FF0000"><b>var </b></font>me <font color="#000080">: </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>me <font color="#000080">:= </font>lStationNumber<font color="#000080">;
   </font>writeln<font color="#000080">(</font><font color="#800000">' Hello, '</font><font color="#000080">, </font>GetUserName<font color="#000080">( </font>me <font color="#000080">),
           </font><font color="#800000">' you''re hooked in on Station # '</font><font color="#000080">, </font>me <font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p></body>
</html>
