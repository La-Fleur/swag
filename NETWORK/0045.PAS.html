<html>
<head><title> "Nice NETBIOS interface" by NICOLAI WADSTROUM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
! Name            : NetBios.Pas
! Ver             : 0.10
! (C) Copyright   :
! Author          : Nicolai Wadstr&amp;ouml;m
! Type of code    : Turbo Pascal 5.0 Unit
! Date            : 1989-10-xx
!
!----------------------------------------------------------------------------
!
! Description:
! ------------
! NetBios interface routines for Turbo Pascal 4.x, 5.x.
!
!
!
! History:
! --------
!
!
!
!
!============================================================================
}
{$A+ Align data + = Word, - = Byte}
{$B- Boolean evaluation + = complete, - = short-circuit}
{$D+ Debug info + = On, - = Off}
{$E- 8087 emulator + = On, - = Off}
{$F- Force far calls + = On, - = Off}
{$I+ IO check + = On, - = Off}
{$L+ Local symbol info + = On, - = Off}
{$N- 8087 code generation + = On, - = Off}
{$O+ Overlay code generation + = On, - = Off}
{$R- Range checking + = On, - = Off}
{$S+ Stack checking + = On, - = Off}
{$V- Var-String checking + = On, - = Off}

</i></font><font color="#FF0000"><b>Unit </b></font>NetBios<font color="#000080">;
</font><font color="#FF0000"><b>interface

Uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Const
 </b></font><font color="#008000"><i>{
 ! NetBios commands:
 }
 </i></font>NetBiosCmd_Call           <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">;
 </font>NetBiosCmd_Listen         <font color="#000080">= </font><font color="#800000">$11</font><font color="#000080">;
 </font>NetBiosCmd_HangUp         <font color="#000080">= </font><font color="#800000">$12</font><font color="#000080">;

 </font>NetBiosCmd_Send           <font color="#000080">= </font><font color="#800000">$14</font><font color="#000080">;
 </font>NetBiosCmd_Rec            <font color="#000080">= </font><font color="#800000">$15</font><font color="#000080">;
 </font>NetBiosCmd_RecAny         <font color="#000080">= </font><font color="#800000">$16</font><font color="#000080">;
 </font>NetBiosCmd_SendChain      <font color="#000080">= </font><font color="#800000">$17</font><font color="#000080">;

 </font>NetBiosCmd_SendDatagram   <font color="#000080">= </font><font color="#800000">$20</font><font color="#000080">;
 </font>NetBiosCmd_RecDatagram    <font color="#000080">= </font><font color="#800000">$21</font><font color="#000080">;
 </font>NetBiosCmd_SendBroadcast  <font color="#000080">= </font><font color="#800000">$22</font><font color="#000080">;
 </font>NetBiosCmd_RecBroadcast   <font color="#000080">= </font><font color="#800000">$23</font><font color="#000080">;

 </font>NetBiosCmd_AddName        <font color="#000080">= </font><font color="#800000">$30</font><font color="#000080">;
 </font>NetBiosCmd_DeleteName     <font color="#000080">= </font><font color="#800000">$31</font><font color="#000080">;
 </font>NetBiosCmd_Reset          <font color="#000080">= </font><font color="#800000">$32</font><font color="#000080">;
 </font>NetBiosCmd_AdapterStat    <font color="#000080">= </font><font color="#800000">$33</font><font color="#000080">;
 </font>NetBiosCmd_SessionStat    <font color="#000080">= </font><font color="#800000">$34</font><font color="#000080">;
 </font>NetBiosCmd_Cancel         <font color="#000080">= </font><font color="#800000">$35</font><font color="#000080">;
 </font>NetBiosCmd_AddGroupName   <font color="#000080">= </font><font color="#800000">$36</font><font color="#000080">;


 </font>NetBiosCmd_Unlink         <font color="#000080">= </font><font color="#800000">$70</font><font color="#000080">;
 </font>NetBiosCmd_SendNoAck      <font color="#000080">= </font><font color="#800000">$71</font><font color="#000080">;
 </font>NetBiosCmd_SendChainNoAck <font color="#000080">= </font><font color="#800000">$72</font><font color="#000080">;
 </font>NetBiosCmd_FindName       <font color="#000080">= </font><font color="#800000">$78</font><font color="#000080">;
 </font>NetBiosCmd_TokenRingTrace <font color="#000080">= </font><font color="#800000">$79</font><font color="#000080">;






 </font>NetBiosCmdNoWait         <font color="#000080">= </font><font color="#800000">$80</font><font color="#000080">;

 </font><font color="#008000"><i>{
 ! NetBios error codes:
 }

 </i></font>NetBios_Ok               <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">;
 </font>NetBios_IllegalBufLen    <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">;
 </font>NetBios_InvalidCmd       <font color="#000080">= </font><font color="#800000">$03</font><font color="#000080">;
 </font>NetBios_Timeout          <font color="#000080">= </font><font color="#800000">$05</font><font color="#000080">;
 </font>NetBios_MsgIncomplete    <font color="#000080">= </font><font color="#800000">$06</font><font color="#000080">;
 </font>NetBios_InvalidSessionNr <font color="#000080">= </font><font color="#800000">$08</font><font color="#000080">;
 </font>NetBios_OutofResources   <font color="#000080">= </font><font color="#800000">$09</font><font color="#000080">;
 </font>NetBios_SessionClosed    <font color="#000080">= </font><font color="#800000">$0A</font><font color="#000080">;
 </font>NetBios_CmdCanceled      <font color="#000080">= </font><font color="#800000">$0B</font><font color="#000080">;
 </font>NetBios_DupLocalName     <font color="#000080">= </font><font color="#800000">$0D</font><font color="#000080">;
 </font>NetBios_NameTableFull    <font color="#000080">= </font><font color="#800000">$0E</font><font color="#000080">;
 </font>NetBios_Name_Deleted     <font color="#000080">= </font><font color="#800000">$0F</font><font color="#000080">;
 </font>NetBios_SessionTableFull <font color="#000080">= </font><font color="#800000">$11</font><font color="#000080">;
 </font>NetBios_RemNotListning   <font color="#000080">= </font><font color="#800000">$12</font><font color="#000080">;
 </font>NetBios_IvalidNameNr     <font color="#000080">= </font><font color="#800000">$13</font><font color="#000080">;
 </font>NetBios_NameNotFound     <font color="#000080">= </font><font color="#800000">$14</font><font color="#000080">;
 </font>NetBios_InvalidNameFormat<font color="#000080">= </font><font color="#800000">$15</font><font color="#000080">;
 </font>NetBios_NameExists       <font color="#000080">= </font><font color="#800000">$16</font><font color="#000080">;
 </font>NetBios_NameDeleted      <font color="#000080">= </font><font color="#800000">$17</font><font color="#000080">;
 </font>NetBios_ConnectionLost   <font color="#000080">= </font><font color="#800000">$18</font><font color="#000080">;
 </font>NetBios_DupNetworkName   <font color="#000080">= </font><font color="#800000">$19</font><font color="#000080">;
 </font>NetBios_BadPacket        <font color="#000080">= </font><font color="#800000">$1A</font><font color="#000080">;
 </font>NetBios_InterfaceBusy    <font color="#000080">= </font><font color="#800000">$21</font><font color="#000080">;
 </font>NetBios_TooManyCmds      <font color="#000080">= </font><font color="#800000">$22</font><font color="#000080">;
 </font>NetBios_InvalidAdapNr    <font color="#000080">= </font><font color="#800000">$23</font><font color="#000080">;
 </font>NetBios_CmdNotCanceled   <font color="#000080">= </font><font color="#800000">$24</font><font color="#000080">;
 </font>NetBios_InvalidCancelCmd <font color="#000080">= </font><font color="#800000">$26</font><font color="#000080">;
 </font>NetBios_AlreadyDefName   <font color="#000080">= </font><font color="#800000">$30</font><font color="#000080">; </font><font color="#008000"><i>{ Name already defined by another envoirment }
 </i></font>NetBios_EnvNotDef        <font color="#000080">= </font><font color="#800000">$34</font><font color="#000080">; </font><font color="#008000"><i>{ Envoirment not defined, RESET must be issued}
 </i></font>NetBios_OutOfSysResource <font color="#000080">= </font><font color="#800000">$35</font><font color="#000080">; </font><font color="#008000"><i>{ Required os resources exhausted, retry later}
 </i></font>NetBios_MaxAPPLExceeded  <font color="#000080">= </font><font color="#800000">$36</font><font color="#000080">; </font><font color="#008000"><i>{ Max. nr of applications eceeded }
 </i></font>NetBios_OutOfSAPs        <font color="#000080">= </font><font color="#800000">$37</font><font color="#000080">; </font><font color="#008000"><i>{ There is no SAPs available for NetBIOS}
 </i></font>NetBios_ResourceNotAvail <font color="#000080">= </font><font color="#800000">$38</font><font color="#000080">; </font><font color="#008000"><i>{ Requested resource(s) not available }
 </i></font>NetBios_InvalidNCB       <font color="#000080">= </font><font color="#800000">$39</font><font color="#000080">; </font><font color="#008000"><i>{ Invalid NCB address or len don' fit in seg}
 </i></font>NetBios_Illegal_RESET    <font color="#000080">= </font><font color="#800000">$3A</font><font color="#000080">; </font><font color="#008000"><i>{ Reset May not be issued from a NetBios adapter appendage}
 </i></font>NetBios_InvalidNCB_DD_ID <font color="#000080">= </font><font color="#800000">$3B</font><font color="#000080">; </font><font color="#008000"><i>{ Invalid DeviceDriver ID, OS/2 only }
 </i></font>NetBios_LockFailed       <font color="#000080">= </font><font color="#800000">$3C</font><font color="#000080">; </font><font color="#008000"><i>{ NetBios attempted to lock user storage but lock failed }
 </i></font>NetBios_DDOpenErr        <font color="#000080">= </font><font color="#800000">$3F</font><font color="#000080">; </font><font color="#008000"><i>{ Device driver open error, OS/2 only }
 </i></font>NetBios_OS2error         <font color="#000080">= </font><font color="#800000">$40</font><font color="#000080">; </font><font color="#008000"><i>{ OS/2 error detected, OS/2 only }
 </i></font>NetBios_HardwareError    <font color="#000080">= </font><font color="#800000">$FE</font><font color="#000080">;
 </font>NetBios_NotCompleted     <font color="#000080">= </font><font color="#800000">$FF</font><font color="#000080">;




 </font>NrOfNCBs                 <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
 </font>CurrentNCB               <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
 </font>MaxSessions              <font color="#000080">= </font><font color="#800000">20</font><font color="#000080">;
 </font>NrOfNames                <font color="#000080">= </font><font color="#800000">254</font><font color="#000080">;
 </font>NetBiosNoWait            <font color="#000080">: </font>Boolean <font color="#000080">= </font>False<font color="#000080">;

</font><font color="#FF0000"><b>Type
   </b></font>Str16                  <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">];
   </font>NameType               <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">16</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
   </font>NodeAddressType        <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
   </font>VersionType            <font color="#000080">= </font><font color="#FF0000"><b>record
                             </b></font>Major          <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>Minor          <font color="#000080">: </font>Byte<font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>NameEntryType          <font color="#000080">= </font><font color="#FF0000"><b>record
                             </b></font>Name           <font color="#000080">: </font>NameType<font color="#000080">;
                             </font>NameNumber     <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>NameStatus     <font color="#000080">: </font>Byte<font color="#000080">;
                             </font><font color="#008000"><i>{
                             !                |                         |
                             ! NameStatus     | Meaning                 |
                             !  Bin     | Dec |                         |
                             ! -----421----------------------------------
                             ! 00000000   (0) | Name add in progress.   |
                             ! 00000100   (4) | Active name.            |
                             ! 00000101   (5) | Delete pending.         |
                             ! 00000110   (6) | Improper duplicate name.|
                             ! 00000111   (7) | Duplicate name, delete  |
                             !                | pending.                |
                             ! ------------------------------------------
                             }
                            </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


   </font>OneSessionStatusType   <font color="#000080">= </font><font color="#FF0000"><b>record
                             </b></font>LocSessionNr   <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>SessionState   <font color="#000080">: </font>Byte<font color="#000080">;
                             </font><font color="#008000"><i>{
                             !              |                         |
                             ! SessionState | Meaning                 |
                             ! ----------------------------------------
                             !            1 | Session LISTEN pending. |
                             !            2 | Session CALL pending.   |
                             !            3 | Session active.         |
                             !            4 | HANG UP pending.        |
                             !            5 | HANG UP complete.       |
                             !            6 | Session aborted.        |
                             ! ----------------------------------------
                             }

                             </i></font>LocName        <font color="#000080">: </font>NameType<font color="#000080">;
                             </font>RemName        <font color="#000080">: </font>NameType<font color="#000080">;
                             </font>RecCmdsOut     <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>SendCmdsOut    <font color="#000080">: </font>Byte<font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>SessionStatusType      <font color="#000080">= </font><font color="#FF0000"><b>record
                             </b></font>SessionNr      <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>NrOfSessions   <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>MessCmdsOut    <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>RecAnyCmdsOut  <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>SessionTable   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxSessions<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>OneSessionStatusType<font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>SessionStatusPtr       <font color="#000080">= ^</font>SessionStatusType<font color="#000080">;




   </font>ExtStatusType          <font color="#000080">= </font><font color="#FF0000"><b>record
                             </b></font>DIR_INIT_ErrCode       <font color="#000080">: </font>Word<font color="#000080">;
                             </font>DIR_OPEN_ADAPErrCode   <font color="#000080">: </font>Word<font color="#000080">;
                             </font>LatestNetworkStatus    <font color="#000080">: </font>Word<font color="#000080">;
                             </font>LatestPCError          <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{Contents of AX reg}
                             </i></font>LatestOperCommandCode  <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>LatestCCBRetCode       <font color="#000080">: </font>Byte<font color="#000080">;

                             </font>LineErrors             <font color="#000080">: </font>Word<font color="#000080">;
                             </font>InternalErrors         <font color="#000080">: </font>Word<font color="#000080">;
                             </font>BurstErrors            <font color="#000080">: </font>Word<font color="#000080">;
                             </font>ARI_FCI_delimiter      <font color="#000080">: </font>Word<font color="#000080">;
                             </font>Abort_delimiter        <font color="#000080">: </font>Word<font color="#000080">;
                             </font>LostFrameErrors        <font color="#000080">: </font>Word<font color="#000080">;
                             </font>RecCongestion          <font color="#000080">: </font>Word<font color="#000080">;
                             </font>FrameCopiedErrors      <font color="#000080">: </font>Word<font color="#000080">;
                             </font>FreqErrors             <font color="#000080">: </font>Word<font color="#000080">;
                             </font>TokenErrors            <font color="#000080">: </font>Word<font color="#000080">;
                             </font>Reserved               <font color="#000080">: </font>Word<font color="#000080">;
                             </font>DMABusErrors           <font color="#000080">: </font>Word<font color="#000080">;
                             </font>DMAParityErrors        <font color="#000080">: </font>Word<font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>AdapterStatusType      <font color="#000080">= </font><font color="#FF0000"><b>record
                             </b></font>NodeAddress    <font color="#000080">: </font>NodeAddressType<font color="#000080">;
                             </font>MajorVersion   <font color="#000080">: </font>Byte<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! $00 = Version 1.xx
                             ! $02 = Version 2.xx
                             ! $03 = Version 3.xx
                             !
                             }

                             </i></font>PowerOnResult  <font color="#000080">: </font>Byte<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Always zero in current versions.
                             }

                             </i></font>AdapterType    <font color="#000080">: </font>Byte<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! $FF = Token-Ring Network Adapter
                             ! $FE = PC Network Adapter
                             !
                             }
                             </i></font>MinorVersion   <font color="#000080">: </font>Byte<font color="#000080">;

                             </font>MinSincePowerUp<font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Minutes since system was powered up.
                             ! Rolls over to zero when it reaches $FFFF.
                             }

                             </i></font>NrOfCRCErrors  <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Number of CRC error on received packets.
                             ! Rolls over to zero when it reaches $FFFF.
                             }

                             </i></font>NrOfAlignErrors<font color="#000080">:</font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Number of alignment errors.
                             ! Rolls over to zero when it reaches $FFFF.
                             }

                             </i></font>NrOfCollisions <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Number of transmit collision errors.
                             ! Rolls over to zero when it reaches $FFFF.
                             }

                             </i></font>NrOfAborted    <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Number of aborted transmissions.
                             ! Rolls over to zero when it reaches $FFFF.
                             }

                             </i></font>NrOfTxDPackets <font color="#000080">: </font>LongInt<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Number of packets trasmitted.
                             ! Rolls over to zero when it reaches $FFFFFFFF.
                             }

                             </i></font>NrOfRxDPackets <font color="#000080">: </font>LongInt<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Number of packets received.
                             ! Rolls over to zero when it reaches $FFFFFFFF.
                             }

                             </i></font>NrOfReTxDs     <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Number of retransmissions.
                             ! Rolls over to zero when it reaches $FFFF.
                             }

                             </i></font>NrOfEoBufErrs  <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Number of times receiver was out of buffers.
                             ! Rolls over to zero when it reaches $FFFF.
                             }

                             </i></font>DLCT1_Timeouts <font color="#000080">: </font>Word<font color="#000080">;

                             </font>DLCTi_Timeouts <font color="#000080">: </font>Word<font color="#000080">;

                             </font>ExtStatusPtr   <font color="#000080">: ^</font>ExtStatusType<font color="#000080">;
                             </font>NrOfNCBsFree   <font color="#000080">: </font>Word<font color="#000080">;
                             </font>NrOfNCBsReseted<font color="#000080">: </font>Word<font color="#000080">;
                             </font>MaxResNCBs     <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Maximum number of NCBs that can be specified
                             ! by the RESET command.
                             }

                             </i></font>NrOfTxOutOfBuf <font color="#000080">: </font>Word<font color="#000080">;
                             </font>MaxDatagramSize<font color="#000080">: </font>Word<font color="#000080">;
                             </font>ActSessions    <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Number of active or pending sessions.
                             }

                             </i></font>NrOfResSessions<font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Number of possible sessions specified in
                             ! last RESET command.
                             }

                             </i></font>MaxResSessions <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Maximum number of sessions that can be specified
                             ! by the RESET command.
                             }

                             </i></font>NetPacketSize  <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#008000"><i>{
                             ! Maximum packet size supported by the network
                             }

                             </i></font>NrOfNames             <font color="#000080">: </font>Word<font color="#000080">;
                             </font>PermanentName         <font color="#000080">: </font>NameEntryType<font color="#000080">;
                             </font>NameTable             <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>NrOfNames<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>NameEntryType<font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


   </font>NCB_Type               <font color="#000080">= </font><font color="#FF0000"><b>record
                             </b></font>Command               <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>RetCode               <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>LocSessionNr          <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>NameNr                <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>BufferPtr             <font color="#000080">: </font>Pointer<font color="#000080">;
                             </font>BufferLen             <font color="#000080">: </font>Word<font color="#000080">;
                             </font>Callname              <font color="#000080">: </font>NameType<font color="#000080">;
                             </font>Name                  <font color="#000080">: </font>NameType<font color="#000080">;
                             </font>Rec_TimeOut           <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>Send_TimeOut          <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>User_Int              <font color="#000080">: </font>Pointer<font color="#000080">;
                             </font>Adapter_Num           <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>CmdDone               <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>Reserved              <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">14</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>NCB_TypePtr            <font color="#000080">= ^</font>NCB_TypePtr<font color="#000080">;

   </font>TraceHeaderType        <font color="#000080">= </font><font color="#FF0000"><b>record
                             </b></font>TraceBufferPtr         <font color="#000080">: </font>Pointer<font color="#000080">;
                             </font>TraceBufferLen         <font color="#000080">: </font>Word<font color="#000080">;
                             </font>TraceEntryStart        <font color="#000080">: </font>Word<font color="#000080">;
                             </font>CodeChangeLvl          <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
                             </font>TraceEntryCounterLo    <font color="#000080">: </font>Word<font color="#000080">;
                             </font>TraceEntryCounterHi    <font color="#000080">: </font>Word<font color="#000080">;
                             </font>InternBuffersExhaust   <font color="#000080">: </font>Word<font color="#000080">;
                             </font>InternTxdBufferExhaust <font color="#000080">: </font>Word<font color="#000080">;
                             </font>Reserved               <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">24</font><font color="#000080">..</font><font color="#800000">27</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
                             </font>LastTraceEntry         <font color="#000080">: </font>Word<font color="#000080">;
                             </font>NextTraceEntry         <font color="#000080">: </font>Word<font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>TraceEntry             <font color="#000080">= </font><font color="#FF0000"><b>record
                             </b></font>AdapterNum             <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>XMA3270BankID          <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>EntryType              <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>Modifier               <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>TicksSinceLastEntry    <font color="#000080">: </font>Word<font color="#000080">;
                             </font>Data                   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">6</font><font color="#000080">..</font><font color="#800000">31</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


   </font>NetBIOSHardwareHeader  <font color="#000080">= </font><font color="#FF0000"><b>record
                             </b></font>HeaderLength           <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>Delimiter              <font color="#000080">: </font>Word<font color="#000080">;
                             </font>Command                <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>Data1                  <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>Data2                  <font color="#000080">: </font>Word<font color="#000080">;
                             </font>TxCorrelator           <font color="#000080">: </font>Word<font color="#000080">;
                             </font>RespCorrelator         <font color="#000080">: </font>Word<font color="#000080">;
                             </font>DestSessionNr          <font color="#000080">: </font>Byte<font color="#000080">;
                             </font>SrcSessionNr           <font color="#000080">: </font>Byte<font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
   </b></font>LocalAdapterStatus     <font color="#000080">: </font>AdapterStatusType<font color="#000080">;
   </font>LocalName              <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">];


</font><font color="#FF0000"><b>function </b></font>Call_NetBios<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NCB<font color="#000080">:</font>NCB_Type<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>{
! Calls netbios with a NCB.
!
}


</i></font><font color="#FF0000"><b>function </b></font>NetBIOSErrorStr <font color="#000080">( </font>ErrorCode <font color="#000080">: </font>Word <font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{
! NetBIOSErrorStr
! ---------------
!
! Returns the error code as a explaining strig.
!
!
}

</i></font><font color="#FF0000"><b>function </b></font>NetBIOSAvailable <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{
! NetBIOSAvailable
! ----------------
! Returns true if NetBIOS interface routines can be found otherwise false.
!
}




</i></font><font color="#FF0000"><b>procedure </b></font>Name2Str<font color="#000080">(</font>Name<font color="#000080">:</font>NameType<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Strng<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>procedure </b></font>Str2Name<font color="#000080">(</font>Strng<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Name<font color="#000080">:</font>NameType<font color="#000080">);

</font><font color="#FF0000"><b>function </b></font>Reset<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NCB <font color="#000080">: </font>NCB_Type<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Cancel<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NCB <font color="#000080">: </font>NCB_Type<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>GetAdapterStat<font color="#000080">(
                        </font><font color="#FF0000"><b>Var </b></font>NCB           <font color="#000080">: </font>NCB_Type<font color="#000080">;
                        </font><font color="#FF0000"><b>Var </b></font>Status        <font color="#000080">: </font>AdapterStatusType
                       <font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Unlink<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NCB <font color="#000080">: </font>NCB_Type<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>AddName<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NCB <font color="#000080">: </font>NCB_Type<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>SendBlock<font color="#000080">(
                   </font><font color="#FF0000"><b>Var </b></font>NCB         <font color="#000080">: </font>NCB_Type<font color="#000080">;
                   </font><font color="#FF0000"><b>Var </b></font>Buffer
                  <font color="#000080">) : </font>Word<font color="#000080">;


</font><font color="#FF0000"><b>implementation

Var
   </b></font>NetBiosStatus          <font color="#000080">: </font>Word<font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>Call_NetBios<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NCB<font color="#000080">:</font>NCB_Type<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>{
! Calls netbios with a NCB.
!
}
</i></font><font color="#FF0000"><b>Var
  </b></font>Regs        <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>Regs<font color="#000080">.</font>ES<font color="#000080">:=</font>Seg<font color="#000080">(</font>NCB<font color="#000080">);
 </font>Regs<font color="#000080">.</font>BX<font color="#000080">:=</font>Ofs<font color="#000080">(</font>NCB<font color="#000080">);
  </font>Intr<font color="#000080">(</font><font color="#800000">$5C</font><font color="#000080">,</font>Regs<font color="#000080">);

</font><font color="#008000"><i>{$IFDEF DEBUGING}
   </i></font>WriteLn<font color="#000080">(</font><font color="#800000">' NetBIOS Msg('</font><font color="#000080">,</font>NCB<font color="#000080">.</font>RetCode <font color="#000080">,</font><font color="#800000">' dec): '</font><font color="#000080">,</font>NetBIOSErrorStr<font color="#000080">(</font>NCB<font color="#000080">.</font>RetCode<font color="#000080">) );
</font><font color="#008000"><i>{$ENDIF}

 </i></font>Call_NetBios<font color="#000080">:=</font>Regs<font color="#000080">.</font>AX<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>NetBIOSErrorStr <font color="#000080">( </font>ErrorCode <font color="#000080">: </font>Word <font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{
! NetBIOSErrorStr
! ---------------
!
! Returns the error code as a explaining strig.
!
!
}
</i></font><font color="#FF0000"><b>begin
  Case </b></font>ErrorCode <font color="#FF0000"><b>of
   </b></font>NetBios_Ok               <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Ok'</font><font color="#000080">;
   </font>NetBios_IllegalBufLen    <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Illegal buffer length'</font><font color="#000080">;
   </font>NetBios_InvalidCmd       <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Invalid command'</font><font color="#000080">;
   </font>NetBios_Timeout          <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Timeout'</font><font color="#000080">;
   </font>NetBios_MsgIncomplete    <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Message incomplete'</font><font color="#000080">;
   </font>NetBios_InvalidSessionNr <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Invalid session nr'</font><font color="#000080">;
   </font>NetBios_OutofResources   <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Out of resources'</font><font color="#000080">;
   </font>NetBios_SessionClosed    <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Session closed'</font><font color="#000080">;
   </font>NetBios_CmdCanceled      <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Command canceled'</font><font color="#000080">;
   </font>NetBios_DupLocalName     <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Duplicate of Localname'</font><font color="#000080">;
   </font>NetBios_NameTableFull    <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Nametable full'</font><font color="#000080">;
   </font>NetBios_Name_Deleted     <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Name deleted'</font><font color="#000080">;
   </font>NetBios_SessionTableFull <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Session table full'</font><font color="#000080">;
   </font>NetBios_RemNotListning   <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Remote not listning'</font><font color="#000080">;
   </font>NetBios_IvalidNameNr     <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Ivalid name nr'</font><font color="#000080">;
   </font>NetBios_NameNotFound     <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Name not found'</font><font color="#000080">;
   </font>NetBios_InvalidNameFormat<font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Invalid name format'</font><font color="#000080">;
   </font>NetBios_NameExists       <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Name exists'</font><font color="#000080">;
   </font>NetBios_NameDeleted      <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Name deleted'</font><font color="#000080">;
   </font>NetBios_ConnectionLost   <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Connection lost'</font><font color="#000080">;
   </font>NetBios_DupNetworkName   <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Dupliacte network name'</font><font color="#000080">;
   </font>NetBios_BadPacket        <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Bad packet'</font><font color="#000080">;
   </font>NetBios_InterfaceBusy    <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Busy (Try again)'</font><font color="#000080">;
   </font>NetBios_TooManyCmds      <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Too Many Commands'</font><font color="#000080">;
   </font>NetBios_InvalidAdapNr    <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Invalid adapter nr'</font><font color="#000080">;
   </font>NetBios_CmdNotCanceled   <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Command not canceled'</font><font color="#000080">;
   </font>NetBios_InvalidCancelCmd <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Invalid cancel command'</font><font color="#000080">;
   </font>NetBios_HardwareError    <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Hardware error'</font><font color="#000080">;
   </font>NetBios_NotCompleted     <font color="#000080">: </font>NetBIOSErrorStr <font color="#000080">:= </font><font color="#800000">'Not completed'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>Name2Str<font color="#000080">(</font>Name<font color="#000080">:</font>NameType<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Strng<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>B<font color="#000080">,</font>B1<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>B1<font color="#000080">:=</font><font color="#800000">16</font><font color="#000080">;
  </font>Strng<font color="#000080">:=</font>Name<font color="#000080">;

 </font>B1 <font color="#000080">:= </font><font color="#800000">16</font><font color="#000080">;

 </font><font color="#FF0000"><b>for </b></font>B<font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
  if </b></font>Name<font color="#000080">[</font>B<font color="#000080">]=</font><font color="#800000">#0 </font><font color="#FF0000"><b>then </b></font>B1<font color="#000080">:=</font>B<font color="#000080">;

 </font>Strng<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>Chr<font color="#000080">(</font>B1<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Str2Name<font color="#000080">(</font>Strng<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Name<font color="#000080">:</font>NameType<font color="#000080">);
</font><font color="#FF0000"><b>Var
   </b></font>B<font color="#000080">,
   </font>StrLen     <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin

  for </b></font>B<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">16 </font><font color="#FF0000"><b>do </b></font>Name<font color="#000080">[</font>B<font color="#000080">] := </font><font color="#800000">#0</font><font color="#000080">;

   </font>StrLen   <font color="#000080">:= </font>Length<font color="#000080">(</font>Strng<font color="#000080">);

   </font><font color="#FF0000"><b>if </b></font>StrLen <font color="#000080">&gt; </font><font color="#800000">16 </font><font color="#FF0000"><b>then </b></font>StrLen <font color="#000080">:= </font><font color="#800000">16</font><font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>B <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>StrLen <font color="#FF0000"><b>do
   </b></font>Name<font color="#000080">[</font>B<font color="#000080">] := </font>Strng<font color="#000080">[</font>B<font color="#000080">];

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>function </b></font>NetBIOSAvailable <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{
! NetBIOSAvailable
! ----------------
! Returns true if NetBIOS interface routines can be found otherwise false.
!
}
</i></font><font color="#FF0000"><b>Var
  </b></font>Regs               <font color="#000080">: </font>Registers<font color="#000080">;
  </font>NCB                <font color="#000080">: </font>NCB_Type<font color="#000080">;
  </font>VectorTable        <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>LongInt <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$0000</font><font color="#000080">;

</font><font color="#FF0000"><b>begin

  if </b></font>VectorTable<font color="#000080">[</font><font color="#800000">$5C</font><font color="#000080">] = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
   begin
    </b></font>NetBIOSAvailable     <font color="#000080">:= </font>False<font color="#000080">;
    </font>Exit<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



   </font>FillChar<font color="#000080">(</font>NCB<font color="#000080">, </font>SizeOf<font color="#000080">(</font>NCB<font color="#000080">), </font><font color="#800000">#0 </font><font color="#000080">);

  </font>NCB<font color="#000080">.</font>Command      <font color="#000080">:= </font><font color="#800000">$FF</font><font color="#000080">;       </font><font color="#008000"><i>{ Invalid command }

  </i></font>Regs<font color="#000080">.</font>ES          <font color="#000080">:= </font>Seg<font color="#000080">(</font>NCB<font color="#000080">);
  </font>Regs<font color="#000080">.</font>BX          <font color="#000080">:= </font>Ofs<font color="#000080">(</font>NCB<font color="#000080">);

   </font>Intr<font color="#000080">(</font><font color="#800000">$5C</font><font color="#000080">,</font>Regs<font color="#000080">);

 </font>NetBiosAvailable <font color="#000080">:= (</font>NCB<font color="#000080">.</font>RetCode <font color="#000080">= </font>NetBios_InvalidCmd<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
!=============================================================================
!                          NetBios function calls.
!
!-----------------------------------------------------------------------------
}

</i></font><font color="#FF0000"><b>function </b></font>Reset<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NCB <font color="#000080">: </font>NCB_Type<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>NCB<font color="#000080">.</font>Command<font color="#000080">:=</font>NetBiosCmd_Reset<font color="#000080">;
 </font>Reset <font color="#000080">:= </font>Call_NetBios<font color="#000080">(</font>NCB<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>Cancel<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NCB <font color="#000080">: </font>NCB_Type<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>NCB<font color="#000080">.</font>Command<font color="#000080">:=</font>NetBiosCmd_Cancel<font color="#000080">;
 </font>Cancel <font color="#000080">:= </font>Call_NetBios<font color="#000080">(</font>NCB<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>GetAdapterStat<font color="#000080">(
                        </font><font color="#FF0000"><b>Var </b></font>NCB           <font color="#000080">: </font>NCB_Type<font color="#000080">;
                        </font><font color="#FF0000"><b>Var </b></font>Status        <font color="#000080">: </font>AdapterStatusType
                       <font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>NCB<font color="#000080">.</font>Command<font color="#000080">:=</font>NetBiosCmd_AdapterStat<font color="#000080">;
  </font>NCB<font color="#000080">.</font>BufferPtr<font color="#000080">:= </font>Addr<font color="#000080">(</font>Status<font color="#000080">);
  </font>NCB<font color="#000080">.</font>BufferLen<font color="#000080">:= </font>SizeOf<font color="#000080">(</font>Status<font color="#000080">);
 </font>GetAdapterStat<font color="#000080">:= </font>Call_NetBios<font color="#000080">(</font>NCB<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>Unlink<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NCB <font color="#000080">: </font>NCB_Type<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>NCB<font color="#000080">.</font>Command  <font color="#000080">:= </font>NetBiosCmd_Unlink<font color="#000080">;
 </font>Unlink       <font color="#000080">:= </font>Call_NetBios<font color="#000080">(</font>NCB<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>AddName<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NCB <font color="#000080">: </font>NCB_Type<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>NCB<font color="#000080">.</font>Command<font color="#000080">:=</font>NetBiosCmd_AddName<font color="#000080">;
 </font>AddName <font color="#000080">:= </font>Call_NetBios<font color="#000080">(</font>NCB<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>SendBlock<font color="#000080">(
                   </font><font color="#FF0000"><b>Var </b></font>NCB         <font color="#000080">: </font>NCB_Type<font color="#000080">;
                   </font><font color="#FF0000"><b>Var </b></font>Buffer
                  <font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>NCB<font color="#000080">.</font>Command     <font color="#000080">:= </font>NetBiosCmd_Send<font color="#000080">;
  </font>NCB<font color="#000080">.</font>BufferPtr   <font color="#000080">:= </font>Addr<font color="#000080">(</font>Buffer<font color="#000080">);
  </font>SendBlock       <font color="#000080">:= </font>Call_NetBios<font color="#000080">(</font>NCB<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p></body>
</html>
