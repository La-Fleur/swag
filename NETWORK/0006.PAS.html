<html>
<head><title> "LOCKREC.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
The following Program is a slight modification of one posted by Zach
Linnet.  The problem is it doesn't lock the use of the File and allows
multiple PC's to access the File at the same time.  Also, it seems to
take input from the keyboard when it isn't supposed to and I am unable
to locate why.  How could I improve this to actually lock the File?
What if I just wanted to lock one or two Records?
}

</i></font><font color="#FF0000"><b>Program </b></font>Sample_File_Locking_Program<font color="#000080">;
</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>Type
  </b></font>Fi <font color="#000080">= </font><font color="#FF0000"><b>File of </b></font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>f <font color="#000080">: </font>Fi<font color="#000080">;
  </font>x<font color="#000080">, </font>n <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Choice <font color="#000080">: </font>Char<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{$I-}
  </i></font>FileName <font color="#000080">:= </font><font color="#800000">'e:\test\test.dat'</font><font color="#000080">;
  </font>Assign<font color="#000080">(</font>f<font color="#000080">,</font>FileName<font color="#000080">);
  </font><font color="#FF0000"><b>Repeat
    </b></font>Write<font color="#000080">(</font><font color="#800000">'Option [rwq] ? '</font><font color="#000080">); </font>choice <font color="#000080">:= </font>ReadKey<font color="#000080">;
    </font>Writeln<font color="#000080">(</font>choice<font color="#000080">);
    </font><font color="#FF0000"><b>Case </b></font>choice <font color="#FF0000"><b>of
      </b></font><font color="#800000">'r' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
              </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Attempting to read : '</font><font color="#000080">);
              </font>Reset<font color="#000080">(</font>f<font color="#000080">);
              </font><font color="#FF0000"><b>While </b></font>Ioresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
                begin
                  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Busy waiting...'</font><font color="#000080">);
                  </font>Reset<font color="#000080">(</font>f<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font>Write<font color="#000080">(</font><font color="#800000">'Reading now...'</font><font color="#000080">);
              </font><font color="#FF0000"><b>For </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">1000 </font><font color="#FF0000"><b>do
                </b></font>Read<font color="#000080">(</font>f<font color="#000080">,</font>n<font color="#000080">);
              </font>Writeln<font color="#000080">(</font><font color="#800000">'done!'</font><font color="#000080">);
              </font>Close<font color="#000080">(</font>f<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#800000">'w' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
              </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Attempting to Write : '</font><font color="#000080">);
              </font>Reset<font color="#000080">(</font>f<font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font>Ioresult <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>then
                </b></font>ReWrite<font color="#000080">(</font>f<font color="#000080">);
              </font><font color="#FF0000"><b>While </b></font>Ioresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
                begin
                  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Busy waiting...'</font><font color="#000080">);
                  </font>Reset<font color="#000080">(</font>f<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font>Write<font color="#000080">(</font><font color="#800000">'Writing now...'</font><font color="#000080">);
              </font><font color="#FF0000"><b>For </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">1000 </font><font color="#FF0000"><b>do
                </b></font>Write<font color="#000080">(</font>f<font color="#000080">,</font>x<font color="#000080">);
              </font>Writeln<font color="#000080">(</font><font color="#800000">'done!'</font><font color="#000080">);
              </font>Close<font color="#000080">(</font>f<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Case }
  </i></font><font color="#FF0000"><b>Until </b></font>Choice <font color="#000080">= </font><font color="#800000">'q'</font><font color="#000080">;
  </font><font color="#008000"><i>{$I+}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p></body>
</html>
