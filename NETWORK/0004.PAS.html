<html>
<head><title> "GET-ID3.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
[   Does anyone know the syntax For Novell-specific interrupts in Pascal
[(or C)?  I have posted this message in all the pascal confs nad haven't
[had any replies.  Any help is appreciated.
[  Specifically, I need to use interrupts to find the username, security
[in a certain directory and groups belongs to.

Since this is Novell-specific I hope the moderator won't mind if I
answer this one in this conference, rather than Pascal conf...

You Absolutely NEED a copy of &quot;System Calls - Dos&quot; from Novell. This
book has every last call you'll ever need For getting inFormation out of
NetWare. Warning: some of their inFormation is erroneous, and you'll
just have to do things like count up the size of the Reply buffers, For
example, and not trust their reported Record sizes.

Just as an example of how to use the inFormation from the System Calls
book, here's an example of a Function I slapped together to return a
3-Character username. Pretty much all the Novell calls work the same
way: you set up a Request buffer and a Reply buffer, then you read your
results into whatever Format you want them. Hope this helps:
}

</i></font><font color="#FF0000"><b>Function </b></font>GetNetUserID<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>NovRegs<font color="#000080">:</font>Registers<font color="#000080">;
  </font>Answer<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>iii<font color="#000080">:</font>Integer<font color="#000080">;
  </font>ConnectNo<font color="#000080">:</font>Byte<font color="#000080">;
  </font>Request   <font color="#000080">: </font><font color="#FF0000"><b>Record
                </b></font>Len    <font color="#000080">: </font>Word<font color="#000080">;                    </font><font color="#008000"><i>{LO-HI}
                </i></font>SubF   <font color="#000080">: </font>Byte<font color="#000080">;
                </font>ConnNum<font color="#000080">: </font>Word<font color="#000080">;                    </font><font color="#008000"><i>{HI-LO}
              </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Reply     <font color="#000080">: </font><font color="#FF0000"><b>Record
                </b></font>Len    <font color="#000080">: </font>Word<font color="#000080">;                    </font><font color="#008000"><i>{LO-HI}
                </i></font>ObjID  <font color="#000080">: </font>LongInt<font color="#000080">;                 </font><font color="#008000"><i>{HI-LO}
                </i></font>ObjType<font color="#000080">: </font>Word<font color="#000080">;
                </font>ObjName<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">48</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
                </font>LogTime<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>ReqdNetType <font color="#000080">&lt;&gt; </font>Novell<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>GetNetUserID <font color="#000080">:= </font>copy<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ReqdNetType <font color="#000080">= </font>Novell<font color="#000080">) </font><font color="#FF0000"><b>then

  begin

    With </b></font>NovRegs <font color="#FF0000"><b>do
    begin
      </b></font>AH <font color="#000080">:= </font><font color="#800000">$dc</font><font color="#000080">;
      </font>AL <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
      </font>cx <font color="#000080">:= </font><font color="#800000">$0000</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>MsDos<font color="#000080">(</font>NovRegs<font color="#000080">);
    </font>ConnectNo<font color="#000080">:=</font>NovRegs<font color="#000080">.</font>AL<font color="#000080">;

    </font><font color="#FF0000"><b>For </b></font>iii <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">48 </font><font color="#FF0000"><b>do
    begin
      </b></font>Reply<font color="#000080">.</font>ObjName<font color="#000080">[</font>iii<font color="#000080">] := </font><font color="#800000">$00</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>With </b></font>Request <font color="#FF0000"><b>do
    begin
      </b></font>Len    <font color="#000080">:= </font>Sizeof<font color="#000080">(</font>Request<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">;
      </font>SubF   <font color="#000080">:= </font><font color="#800000">$16</font><font color="#000080">;
      </font>ConnNum<font color="#000080">:= (</font>ConnectNo<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>Reply<font color="#000080">.</font>Len <font color="#000080">:= </font>Sizeof<font color="#000080">(</font>Reply<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">;

    </font><font color="#FF0000"><b>With </b></font>NovRegs <font color="#FF0000"><b>do
    begin
      </b></font>AH <font color="#000080">:= </font><font color="#800000">$e3</font><font color="#000080">;
      </font>DS <font color="#000080">:= </font>Seg<font color="#000080">(</font>Request<font color="#000080">);
      </font>SI <font color="#000080">:= </font>ofs<font color="#000080">(</font>Request<font color="#000080">);
      </font>ES <font color="#000080">:= </font>Seg<font color="#000080">(</font>Reply<font color="#000080">);
      </font>DI <font color="#000080">:= </font>ofs<font color="#000080">(</font>Reply<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>MsDos<font color="#000080">(</font>NovRegs<font color="#000080">);
    </font>Answer<font color="#000080">:=</font><font color="#800000">'   '</font><font color="#000080">;

    </font><font color="#FF0000"><b>For </b></font>iii<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do
    begin
      </b></font>Answer<font color="#000080">[</font>iii<font color="#000080">]:= </font>chr<font color="#000080">(</font>Reply<font color="#000080">.</font>ObjName<font color="#000080">[</font>iii<font color="#000080">]);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>GetNetUserID<font color="#000080">:= </font>Answer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{GetNetUserID}

{
That $e3 in the AH register is the generic bindery call. $16 is the
subFunction For &quot;Get Connection Name&quot; in the Bindery calls.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p></body>
</html>
