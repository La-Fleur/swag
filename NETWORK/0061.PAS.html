<html>
<head><title> "Novell unit for IPX" by KEN JOHNSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{


 Ken Johnson's Novell unit.
 kjohnso3@chat.carleton.ca
 Some of this stuff may/maynot work. If something doesn't,
 email me.


}

</i></font><font color="#FF0000"><b>Unit </b></font>kjnet<font color="#000080">;
</font><font color="#FF0000"><b>interface
Var
  </b></font>error <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Const
  </b></font>week <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of string </b></font><font color="#000080">= (</font><font color="#800000">'Sunday'</font><font color="#000080">,</font><font color="#800000">'Monday'</font><font color="#000080">,</font><font color="#800000">'Tuesday'</font><font color="#000080">,</font><font color="#800000">'Wednesday'
                                 </font><font color="#000080">,</font><font color="#800000">'Thursday'</font><font color="#000080">,</font><font color="#800000">'Friday'</font><font color="#000080">,</font><font color="#800000">'Saturday'</font><font color="#000080">);
  </font>personal     <font color="#000080">= </font><font color="#800000">$05</font><font color="#000080">;</font><font color="#008000"><i>{used for GETMESSAGE}
  </i></font>broadcast    <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">;
  </font>receiveall         <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">;</font><font color="#008000"><i>{used for SETBROADCASTMODE}
  </i></font>NoUsermessage      <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">;
  </font>StoreServerMessage <font color="#000080">= </font><font color="#800000">$02</font><font color="#000080">;
  </font>StoreAllMessages   <font color="#000080">= </font><font color="#800000">$03</font><font color="#000080">;

</font><font color="#FF0000"><b>type
</b></font>diskrec<font color="#000080">=</font><font color="#FF0000"><b>record
  </b></font>clockticks<font color="#000080">:</font>longint<font color="#000080">;
  </font>objectid<font color="#000080">:</font>longint<font color="#000080">;
  </font>diskspace<font color="#000080">:</font>longint<font color="#000080">;
  </font>enforced<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>diskspacerec <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>clockticks <font color="#000080">: </font>longint<font color="#000080">;
    </font>id <font color="#000080">: </font>longint<font color="#000080">;
    </font>diskleft <font color="#000080">: </font>longint<font color="#000080">;
    </font>restrict <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>BinderyRec <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>ID <font color="#000080">: </font>longint<font color="#000080">;
    </font>objtype <font color="#000080">: </font>word<font color="#000080">;
    </font>Name <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>objectFlag <font color="#000080">: </font>byte<font color="#000080">;
    </font>securitylevel <font color="#000080">: </font>byte<font color="#000080">;
    </font>propertyflags <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font>NoReturn <font color="#000080">= </font><font color="#FF0000"><b>record</b></font><font color="#008000"><i>{when the function call}
    </i></font>Len <font color="#000080">: </font>Word<font color="#000080">;    </font><font color="#008000"><i>{returns nothing.}
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>Userrec <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>Name      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>objtype   <font color="#000080">: </font>word<font color="#000080">;
    </font>id        <font color="#000080">: </font>longint<font color="#000080">;
    </font>logindate <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>logintime <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>weekday   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>Connection<font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>delnulls<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>Callint<font color="#000080">(</font>Ahreg <font color="#000080">: </font>byte<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">;
                  </font><font color="#FF0000"><b>Var </b></font>error <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>getdisk<font color="#000080">(</font>id<font color="#000080">:</font>longint<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>disk <font color="#000080">: </font>diskrec<font color="#000080">);

</font><font color="#FF0000"><b>Procedure </b></font>GetBinderyAccess<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sec <font color="#000080">: </font>byte<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>id <font color="#000080">: </font>longint<font color="#000080">);
</font><font color="#FF0000"><b>Function  </b></font>upcaseStr<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>logout<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>connectnum <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>setbroadcastmode<font color="#000080">(</font>mode <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>Getbroadcastmode <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SendBroadCastMessage<font color="#000080">(</font>Con <font color="#000080">: </font>Byte<font color="#000080">;</font><font color="#FF0000"><b>Message </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Function  </b></font>GetMessage<font color="#000080">(</font>Func <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SendPersonalMessage<font color="#000080">(</font>Con <font color="#000080">: </font>Byte<font color="#000080">;</font><font color="#FF0000"><b>Message </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>broadcastToConsole<font color="#000080">(</font><font color="#FF0000"><b>message </b></font><font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>idnumber <font color="#000080">: </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>Getconnectioninfo<font color="#000080">(</font>Con <font color="#000080">: </font>byte<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>U <font color="#000080">: </font>userrec<font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>Connect2ID<font color="#000080">(</font>Con <font color="#000080">: </font>byte<font color="#000080">) : </font>longint<font color="#000080">;
</font><font color="#008000"><i>{procedure getdiskspaceleft(id : longint;var bufferout : diskspacerec);}
</i></font><font color="#FF0000"><b>procedure </b></font>ClearConnection<font color="#000080">(</font>c <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>getopenfiles<font color="#000080">(</font>c <font color="#000080">: </font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>files <font color="#000080">: </font><font color="#FF0000"><b>array of string</b></font><font color="#000080">;</font><font color="#FF0000"><b>var </b></font>numf <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>scanbindery<font color="#000080">(</font>objID <font color="#000080">: </font>Longint<font color="#000080">;</font>obj <font color="#000080">: </font>word<font color="#000080">;</font>name1 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>var </b></font>Bin <font color="#000080">: </font>binderyrec<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>error<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>function </b></font>name2id<font color="#000080">(</font>name <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>longint<font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>ConsoleOperator <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>fullname<font color="#000080">(</font>Name <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>callFint<font color="#000080">(</font>con <font color="#000080">: </font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">;
                  </font><font color="#FF0000"><b>var </b></font>e <font color="#000080">: </font>word<font color="#000080">);

</font><font color="#FF0000"><b>implementation

Function </b></font>fullname<font color="#000080">(</font>Name <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Type
  </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>sub <font color="#000080">: </font>byte<font color="#000080">;
    </font>objtype <font color="#000080">: </font>word<font color="#000080">;
    </font>data <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>reply <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>value <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
    </font>s <font color="#000080">: </font>byte<font color="#000080">;
    </font>f <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>reaL<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
  </font>prop<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>bufferin <font color="#000080">: </font>request<font color="#000080">;
  </font>bufferout <font color="#000080">: </font>reply<font color="#000080">;
  </font>x<font color="#000080">,</font>i <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>fillchar<font color="#000080">(</font>Bufferin<font color="#000080">,</font>sizeof<font color="#000080">(</font>BUfferin<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>Fillchar<font color="#000080">(</font>BufferOut<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>Bufferout<font color="#000080">.</font>Len <font color="#000080">:= </font>Sizeof<font color="#000080">(</font>BufferOut<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">;
    </font>prop <font color="#000080">:= </font><font color="#800000">'IDENTIFICATION'</font><font color="#000080">;
    </font><font color="#FF0000"><b>with </b></font>bufferin <font color="#FF0000"><b>do
      begin
        </b></font>Sub <font color="#000080">:= </font><font color="#800000">$3d</font><font color="#000080">;
        </font>objtype <font color="#000080">:= </font><font color="#800000">256</font><font color="#000080">;</font><font color="#008000"><i>{I guess tis could be different.}
        </i></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>bufferin<font color="#000080">.</font>data<font color="#000080">[</font>i<font color="#000080">] := </font>Length<font color="#000080">(</font>Name<font color="#000080">);
        </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>name<font color="#000080">) </font><font color="#FF0000"><b>do
          begin
            </b></font>Inc<font color="#000080">(</font>I<font color="#000080">);
            </font>bufferin<font color="#000080">.</font>daTa<font color="#000080">[</font>i<font color="#000080">] := </font>ord<font color="#000080">(</font>name<font color="#000080">[</font>x<font color="#000080">]);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>inc<font color="#000080">(</font>i<font color="#000080">);
        </font>bufferin<font color="#000080">.</font>data<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">01</font><font color="#000080">;
        </font>inc<font color="#000080">(</font>i<font color="#000080">);
        </font>bufferin<font color="#000080">.</font>data<font color="#000080">[</font>i<font color="#000080">] := </font>length<font color="#000080">(</font>Prop<font color="#000080">);
        </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>Prop<font color="#000080">) </font><font color="#FF0000"><b>do
          begin
            </b></font>Inc<font color="#000080">(</font>i<font color="#000080">);
            </font>bufferin<font color="#000080">.</font>data<font color="#000080">[</font>i<font color="#000080">] := </font>ord<font color="#000080">(</font>prop<font color="#000080">[</font>x<font color="#000080">]);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>bufferin<font color="#000080">.</font>len <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">+</font>I<font color="#000080">;
   </font>callint<font color="#000080">(</font><font color="#800000">$e3</font><font color="#000080">,</font>Bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);
   </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>While Not</b></font><font color="#000080">(</font>Chr<font color="#000080">(</font>Bufferout<font color="#000080">.</font>value<font color="#000080">[</font>i<font color="#000080">]) = </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>I <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">)</font><font color="#FF0000"><b>do
     begin
       </b></font>real<font color="#000080">[</font>i<font color="#000080">] := </font>Chr<font color="#000080">(</font>Bufferout<font color="#000080">.</font>Value<font color="#000080">[</font>i<font color="#000080">]);
       </font>Inc<font color="#000080">(</font>I<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>real<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(</font>I<font color="#000080">);
     </font>delnulls<font color="#000080">(</font>real<font color="#000080">);
     </font>fullname<font color="#000080">:=</font>real<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{--------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>getpriv<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>e <font color="#000080">: </font>Byte<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">push ds
    mov ah,$e3
    lds si,bufferin
    les di,bufferout
    int $21
    mov [byte ptr e],al
    pop ds
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{----------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>function </b></font>name2id<font color="#000080">(</font>name <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>request<font color="#000080">=</font><font color="#FF0000"><b>record
    </b></font>len<font color="#000080">:</font>word<font color="#000080">;
    </font>sub<font color="#000080">:</font>byte<font color="#000080">;
    </font>obtype<font color="#000080">:</font>word<font color="#000080">;
    </font>name<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">49</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>reply <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len<font color="#000080">:</font>word<font color="#000080">;
    </font>id<font color="#000080">:</font>longint<font color="#000080">;
    </font>objtype<font color="#000080">:</font>word<font color="#000080">;
    </font>name <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">48</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>bufferin<font color="#000080">:</font>request<font color="#000080">;
 </font>bufferout<font color="#000080">:</font>reply<font color="#000080">;
 </font>x<font color="#000080">:</font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>bufferin<font color="#000080">.</font>len <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">+</font>Length<font color="#000080">(</font>name<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
    </font>bufferin<font color="#000080">.</font>sub<font color="#000080">:=</font><font color="#800000">$35</font><font color="#000080">;
    </font>bufferin<font color="#000080">.</font>obtype<font color="#000080">:=(</font><font color="#800000">256</font><font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>name<font color="#000080">) </font><font color="#FF0000"><b>do
      begin
        </b></font>bufferin<font color="#000080">.</font>name<font color="#000080">[</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] := </font>name<font color="#000080">[</font>x<font color="#000080">];
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>fillchar<font color="#000080">(</font>bufferout<font color="#000080">,</font>sizeof<font color="#000080">(</font>bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
   </font>bufferout<font color="#000080">.</font>len<font color="#000080">:=</font><font color="#800000">$36</font><font color="#000080">;
   </font>callint<font color="#000080">(</font><font color="#800000">$e3</font><font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);
   </font>name2id <font color="#000080">:= (</font>bufferout<font color="#000080">.</font>id<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{--------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>ConsoleOperator <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>Word<font color="#000080">;
    </font>Sub <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>bufferin <font color="#000080">: </font>request<font color="#000080">;
  </font>bufferout <font color="#000080">: </font>noreturn<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Bufferin<font color="#000080">.</font>len <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>bufferin<font color="#000080">.</font>Sub <font color="#000080">:= </font><font color="#800000">$c8</font><font color="#000080">;
    </font>getpriv<font color="#000080">(</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>error <font color="#000080">= </font><font color="#800000">$c6 </font><font color="#FF0000"><b>Then </b></font>consoleoperator <font color="#000080">:= </font>False
    <font color="#FF0000"><b>else </b></font>consoleoperator <font color="#000080">:= </font>true<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{--------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>getdisk<font color="#000080">(</font>id<font color="#000080">:</font>longint<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>disk <font color="#000080">: </font>diskrec<font color="#000080">);
</font><font color="#FF0000"><b>type
  </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len<font color="#000080">:</font>word<font color="#000080">;
    </font>sub<font color="#000080">:</font>byte<font color="#000080">;
    </font>id1<font color="#000080">:</font>Longint<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>reply <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len<font color="#000080">:</font>word<font color="#000080">;
    </font>a<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">]</font><font color="#FF0000"><b>of </b></font>longint<font color="#000080">;
    </font>enforced<font color="#000080">:</font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>bufferin<font color="#000080">:</font>request<font color="#000080">;
  </font>bufferout<font color="#000080">:</font>reply<font color="#000080">;
  </font>u<font color="#000080">:</font>userrec<font color="#000080">;
  </font><font color="#FF0000"><b>begin

    </b></font>bufferin<font color="#000080">.</font>len<font color="#000080">:=</font><font color="#800000">5</font><font color="#000080">;
    </font>bufferin<font color="#000080">.</font>sub<font color="#000080">:=</font><font color="#800000">$e6</font><font color="#000080">;
    </font>bufferin<font color="#000080">.</font>id1<font color="#000080">:=(</font>id<font color="#000080">);
    </font>fillchar<font color="#000080">(</font>Bufferout<font color="#000080">,</font>sizeof<font color="#000080">(</font>bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>bufferout<font color="#000080">.</font>len<font color="#000080">:=</font>sizeof<font color="#000080">(</font>bufferout<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">;
    </font>callint<font color="#000080">(</font><font color="#800000">$e3</font><font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);

    </font><font color="#FF0000"><b>with </b></font>bufferout <font color="#FF0000"><b>do
      begin
        </b></font>disk<font color="#000080">.</font>clockticks <font color="#000080">:= </font>SWAP<font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
        </font>disk<font color="#000080">.</font>objectid<font color="#000080">:=</font>SWAP<font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
        </font>disk<font color="#000080">.</font>diskspace<font color="#000080">:=</font>swap<font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]);
        </font>disk<font color="#000080">.</font>enforced<font color="#000080">:=</font>enforced<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{--------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>scanbindery<font color="#000080">(</font>objID <font color="#000080">: </font>Longint<font color="#000080">;</font>obj <font color="#000080">: </font>word<font color="#000080">;</font>name1 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>var </b></font>Bin <font color="#000080">: </font>binderyrec<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>error <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>type
  </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>sub <font color="#000080">: </font>byte<font color="#000080">;
    </font>id  <font color="#000080">: </font>longint<font color="#000080">;
    </font>ot  <font color="#000080">: </font>word<font color="#000080">;
    </font>namelen <font color="#000080">: </font>byte<font color="#000080">;
    </font>namedata <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">47</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>reply <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>id  <font color="#000080">: </font>longint<font color="#000080">;
    </font>ot  <font color="#000080">: </font>word<font color="#000080">;
   </font>name <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">48</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
   </font>flag <font color="#000080">: </font>byte<font color="#000080">;
   </font>lev  <font color="#000080">: </font>byte<font color="#000080">;
   </font>prop <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var</b></font><font color="#008000"><i>{this works man}
  </i></font>bufferin <font color="#000080">: </font>request<font color="#000080">;
  </font>bufferout <font color="#000080">: </font>reply<font color="#000080">;
  </font>x<font color="#000080">,</font>i <font color="#000080">: </font>byte<font color="#000080">;
  </font>name<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>name<font color="#000080">:=</font>name1<font color="#000080">;
    </font>upcaseStr<font color="#000080">(</font>name<font color="#000080">);
    </font>fillchar<font color="#000080">(</font>Bufferin<font color="#000080">,</font>sizeof<font color="#000080">(</font>Bufferin<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>with </b></font>bufferin <font color="#FF0000"><b>do
      begin
        </b></font>sub <font color="#000080">:= </font><font color="#800000">$37</font><font color="#000080">;
        </font>id <font color="#000080">:= </font>objid<font color="#000080">;
        </font>ot <font color="#000080">:= </font>obj<font color="#000080">;
        </font>i <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font>namelen <font color="#000080">:= </font>length<font color="#000080">(</font>name<font color="#000080">);
        </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>Name<font color="#000080">) </font><font color="#FF0000"><b>do
          begin
            </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
            </font>namedata<font color="#000080">[</font>i<font color="#000080">] := </font>name<font color="#000080">[</font>x<font color="#000080">];
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>len <font color="#000080">:= </font>length<font color="#000080">(</font>Name<font color="#000080">)+</font><font color="#800000">8</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>bufferout<font color="#000080">.</font>len <font color="#000080">:= </font>sizeof<font color="#000080">(</font>Bufferout<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">;
   </font>callint<font color="#000080">(</font><font color="#800000">$e3</font><font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);
   </font><font color="#FF0000"><b>With </b></font>BUfferout <font color="#FF0000"><b>do
     begin
       </b></font>bin<font color="#000080">.</font>id <font color="#000080">:= </font>id<font color="#000080">;
       </font>bin<font color="#000080">.</font>objtype <font color="#000080">:= </font>ot<font color="#000080">;
       </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">48 </font><font color="#FF0000"><b>do
         </b></font>bin<font color="#000080">.</font>name<font color="#000080">[</font>i<font color="#000080">] := </font>bufferout<font color="#000080">.</font>name<font color="#000080">[</font>i<font color="#000080">];
       </font>bin<font color="#000080">.</font>name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(</font>i<font color="#000080">);
       </font>bin<font color="#000080">.</font>objectflag <font color="#000080">:= </font>flag<font color="#000080">;
       </font>bin<font color="#000080">.</font>securitylevel <font color="#000080">:= </font>lev<font color="#000080">;
       </font>bin<font color="#000080">.</font>propertyflags <font color="#000080">:= </font>prop<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>callFint<font color="#000080">(</font>con <font color="#000080">: </font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">;
                  </font><font color="#FF0000"><b>var </b></font>e <font color="#000080">: </font>word<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">push ds
    mov ax,$f217
    mov cx,con
    lds si,bufferin
    les di,bufferout
    int $21
    mov [word ptr e],ax
    pop ds
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>sortthese<font color="#000080">(</font>num <font color="#000080">: </font>word<font color="#000080">;</font>B <font color="#000080">: </font><font color="#FF0000"><b>array of </b></font>byte<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>files <font color="#000080">: </font><font color="#FF0000"><b>array of string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>W<font color="#000080">,</font>x<font color="#000080">,</font>i <font color="#000080">: </font>integer<font color="#000080">;
  </font>len <font color="#000080">: </font>byte<font color="#000080">;
  </font>oldi <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>i <font color="#000080">:= </font><font color="#800000">16</font><font color="#000080">;
    </font>x <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>repeat
         </b></font>INC<font color="#000080">(</font>x<font color="#000080">);
         </font>files<font color="#000080">[</font>x<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(</font>B<font color="#000080">[</font>i<font color="#000080">]);</font><font color="#008000"><i>{length}
         </i></font>len <font color="#000080">:= </font>b<font color="#000080">[</font>i<font color="#000080">];
         </font>inc<font color="#000080">(</font>i<font color="#000080">);
         </font>OldI <font color="#000080">:= </font>i<font color="#000080">;
         </font><font color="#FF0000"><b>for </b></font>w <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>len <font color="#FF0000"><b>do
           begin
             </b></font>files<font color="#000080">[</font>x<font color="#000080">][</font>w<font color="#000080">] := </font>chr<font color="#000080">(</font>b<font color="#000080">[</font>i<font color="#000080">]);
             </font>inc<font color="#000080">(</font>i<font color="#000080">);
             </font><font color="#FF0000"><b>if </b></font>oldI <font color="#000080">&gt; </font>i<font color="#000080">+</font><font color="#800000">16 </font><font color="#FF0000"><b>Then </b></font>Break<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font>inc<font color="#000080">(</font>I<font color="#000080">,</font><font color="#800000">16</font><font color="#000080">);

      </font><font color="#FF0000"><b>until </b></font>x <font color="#000080">= </font>num<font color="#000080">;

  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>getopenfiles<font color="#000080">(</font>c <font color="#000080">: </font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>files <font color="#000080">: </font><font color="#FF0000"><b>array of string</b></font><font color="#000080">;</font><font color="#FF0000"><b>var </b></font>numf <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>type
  </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>sub <font color="#000080">: </font>byte<font color="#000080">;
    </font>con <font color="#000080">: </font>word<font color="#000080">;
    </font>lastrec <font color="#000080">: </font>word<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>reply <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>nextrecord <font color="#000080">: </font>word<font color="#000080">;
    </font>numberofrecords <font color="#000080">: </font>word<font color="#000080">;
    </font>RawReplyData <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">508</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>bufferin  <font color="#000080">: </font>request<font color="#000080">;
  </font>bufferout <font color="#000080">: </font>reply<font color="#000080">;
  </font>i<font color="#000080">,</font>x<font color="#000080">,</font>l <font color="#000080">: </font>word<font color="#000080">;
  </font>error <font color="#000080">: </font>word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>fillchar<font color="#000080">(</font>files<font color="#000080">,</font>sizeof<font color="#000080">(</font>Files<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">11 </font><font color="#FF0000"><b>to </b></font><font color="#800000">13 </font><font color="#FF0000"><b>do
       begin
         </b></font>fillchar<font color="#000080">(</font>Bufferin<font color="#000080">,</font>sizeof<font color="#000080">(</font>Bufferin<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
         </font>fillchar<font color="#000080">(</font>Bufferout<font color="#000080">,</font>sizeof<font color="#000080">(</font>Bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
         </font><font color="#FF0000"><b>with </b></font>bufferin <font color="#FF0000"><b>do
           begin
             </b></font>len <font color="#000080">:= </font><font color="#800000">$5</font><font color="#000080">;
             </font>sub <font color="#000080">:= </font><font color="#800000">$eb</font><font color="#000080">;
             </font>con <font color="#000080">:= </font>c<font color="#000080">;
             </font>lastrec <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font>callFint<font color="#000080">(</font>bufferin<font color="#000080">.</font>con<font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Bufferout<font color="#000080">.</font>numberofrecords <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
            begin
              </b></font>numf <font color="#000080">:= </font>bufferout<font color="#000080">.</font>numberofrecords<font color="#000080">;
              </font>sortthese<font color="#000080">(</font>bufferout<font color="#000080">.</font>numberofrecords<font color="#000080">,</font>bufferout<font color="#000080">.</font>rawreplydata<font color="#000080">,</font>files<font color="#000080">);
              </font>exit<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>ClearConnection<font color="#000080">(</font>c <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>type
  </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>sub <font color="#000080">: </font>byte<font color="#000080">;
    </font>con <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>bufferin <font color="#000080">: </font>request<font color="#000080">;
  </font>bufferout <font color="#000080">: </font>noreturn<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>bufferin<font color="#000080">.</font>len <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
    </font>bufferin<font color="#000080">.</font>sub <font color="#000080">:= </font><font color="#800000">$d2</font><font color="#000080">;
    </font>bufferin<font color="#000080">.</font>con <font color="#000080">:= </font>c<font color="#000080">;
    </font>callint<font color="#000080">(</font><font color="#800000">$e3</font><font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>function  </b></font>Connect2ID<font color="#000080">(</font>Con <font color="#000080">: </font>byte<font color="#000080">) : </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>u <font color="#000080">: </font>userrec<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>getconnectioninfo<font color="#000080">(</font>con<font color="#000080">,</font>u<font color="#000080">);
    </font>connect2id <font color="#000080">:= </font>u<font color="#000080">.</font>id<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>getdiskspaceleft<font color="#000080">(</font>id <font color="#000080">: </font>longint<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>bufferout <font color="#000080">: </font>diskspacerec<font color="#000080">);
</font><font color="#FF0000"><b>type
  </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>sub <font color="#000080">: </font>byte<font color="#000080">;
    </font>oid <font color="#000080">: </font>longint<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;                </font><font color="#008000"><i>{works. page 367}
</i></font><font color="#FF0000"><b>var
  </b></font>bufferin <font color="#000080">: </font>request<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    with </b></font>bufferin <font color="#FF0000"><b>do
      begin
        </b></font>len <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
        </font>sub <font color="#000080">:= </font><font color="#800000">$e6</font><font color="#000080">;
        </font>oid <font color="#000080">:= </font>id<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>fillchar<font color="#000080">(</font>Bufferout<font color="#000080">,</font>sizeof<font color="#000080">(</font>Bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font>bufferout<font color="#000080">.</font>len <font color="#000080">:= </font>sizeof<font color="#000080">(</font>Bufferout<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">;
  </font>callint<font color="#000080">(</font><font color="#800000">$e3</font><font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>delnulls<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>x <font color="#000080">: </font>byte<font color="#000080">;
  </font>temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do
      begin
        if </b></font>s<font color="#000080">[</font>x<font color="#000080">] = </font><font color="#800000">#0 </font><font color="#FF0000"><b>Then
          Begin
            </b></font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
            </font>exit<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>Callint<font color="#000080">(</font>Ahreg <font color="#000080">: </font>byte<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">;
                  </font><font color="#FF0000"><b>Var </b></font>error <font color="#000080">: </font>Byte<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">xor ax,ax

  push ds
  mov ah,ahreg
  lds si,bufferin
  les di,bufferout
  int 21h
  pop ds
  mov [byte ptr error],al
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>GetBinderyAccess<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sec <font color="#000080">: </font>byte<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>id <font color="#000080">: </font>longint<font color="#000080">);
</font><font color="#FF0000"><b>Type
  </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>sub <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>reply <font color="#000080">= </font><font color="#FF0000"><b>record
   </b></font>len <font color="#000080">: </font>word<font color="#000080">;
   </font>level <font color="#000080">: </font>byte<font color="#000080">;
   </font>oid <font color="#000080">: </font>longint<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>bufferin <font color="#000080">: </font>request<font color="#000080">;
  </font>bufferout <font color="#000080">: </font>reply<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>bufferin<font color="#000080">.</font>len <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;</font><font color="#008000"><i>{page 328. works}
    </i></font>bufferin<font color="#000080">.</font>sub <font color="#000080">:= </font><font color="#800000">$46</font><font color="#000080">;
    </font>fillchar<font color="#000080">(</font>Bufferout<font color="#000080">,</font>sizeof<font color="#000080">(</font>bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>bufferout<font color="#000080">.</font>len <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
    </font>callint<font color="#000080">(</font><font color="#800000">$e3</font><font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);
    </font>sec <font color="#000080">:= </font>bufferout<font color="#000080">.</font>level<font color="#000080">;
    </font>id <font color="#000080">:= </font>bufferout<font color="#000080">.</font>oid<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>upcaseStr<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>x <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>S<font color="#000080">[</font>x<font color="#000080">] := </font>Upcase<font color="#000080">(</font>S<font color="#000080">[</font>x<font color="#000080">]);
    </font>upcaseStr <font color="#000080">:= </font>s<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>logout<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov ah,$d7
    int 21h
    mov [byte ptr error],al
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>function </b></font>connectnum <font color="#000080">: </font>byte<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov ah,$dc
    int 21h</font><font color="#008000"><i>{connectnum stored in al. should return}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>setbroadcastmode<font color="#000080">(</font>mode <font color="#000080">: </font>byte<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov ah,$de
    mov dl,mode</font><font color="#008000"><i>{page 374}
    </i></font><font color="#FF00FF">int 21h
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>function </b></font>Getbroadcastmode <font color="#000080">: </font>byte<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov ah,$de
    mov dl,$04           </font><font color="#008000"><i>{page 374}
    </i></font><font color="#FF00FF">int 21h</font><font color="#008000"><i>{broadcastmode stored in al}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>SendBroadCastMessage<font color="#000080">(</font>Con <font color="#000080">: </font>Byte<font color="#000080">;</font><font color="#FF0000"><b>Message </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Type
  </b></font>Request <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Len <font color="#000080">: </font>Word<font color="#000080">;
    </font>sub <font color="#000080">: </font>byte<font color="#000080">;
    </font>Stuff <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">157</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>reply <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>num <font color="#000080">: </font>byte<font color="#000080">;
    </font>list <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Bufferin <font color="#000080">: </font>request<font color="#000080">;
  </font>bufferout <font color="#000080">: </font>reply<font color="#000080">;
  </font>i<font color="#000080">,</font>x <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>fillchar<font color="#000080">(</font>Bufferin<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Bufferin<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>fillchar<font color="#000080">(</font>BufferOut<font color="#000080">,</font>Sizeof<font color="#000080">(</font>BufferOut<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>With </b></font>Bufferin <font color="#FF0000"><b>do
      begin
        </b></font>len <font color="#000080">:= </font>Length<font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">)+</font><font color="#800000">4</font><font color="#000080">;
        </font>Sub <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;                          </font><font color="#008000"><i>{works. page 374}
        </i></font>I <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>Stuff<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;</font><font color="#008000"><i>{connect num}
        </i></font>Inc<font color="#000080">(</font>I<font color="#000080">);
        </font>Stuff<font color="#000080">[</font>i<font color="#000080">] := </font>Con<font color="#000080">;
        </font>Inc<font color="#000080">(</font>I<font color="#000080">);
        </font>Stuff<font color="#000080">[</font>i<font color="#000080">] := </font>Length<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">);
        </font>Inc<font color="#000080">(</font>I<font color="#000080">);
        </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">) </font><font color="#FF0000"><b>do
          Begin
            </b></font>stuff<font color="#000080">[</font>i<font color="#000080">] := </font>ord<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">[</font>x<font color="#000080">]);
            </font>inc<font color="#000080">(</font>I<font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>callInt<font color="#000080">(</font><font color="#800000">$e1</font><font color="#000080">,</font>Bufferin<font color="#000080">,</font>Bufferout<font color="#000080">,</font>Error<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>GetMessage<font color="#000080">(</font>Func <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Type
  </b></font>Request <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Len <font color="#000080">: </font>Word<font color="#000080">;
    </font>Sub <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Reply <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Len  <font color="#000080">: </font>Word<font color="#000080">;
    </font>messlen <font color="#000080">: </font>Byte<font color="#000080">;
    </font>mess <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">126</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var                      </b></font><font color="#008000"><i>{page 376 &amp; 375}
  </i></font>Bufferin <font color="#000080">: </font>request<font color="#000080">;
  </font>BufferOut <font color="#000080">: </font>Reply<font color="#000080">;
  </font>duh<font color="#000080">,</font>x <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>getmessage <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>fillchar<font color="#000080">(</font>Bufferin<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Bufferin<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>Fillchar<font color="#000080">(</font>Bufferout<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>Bufferin<font color="#000080">.</font>Len <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>Bufferin<font color="#000080">.</font>Sub <font color="#000080">:= </font>Func<font color="#000080">;</font><font color="#008000"><i>{a personal message or a broadcast message}
    </i></font>bufferout<font color="#000080">.</font>Len <font color="#000080">:= </font><font color="#800000">128</font><font color="#000080">;
    </font>CallInt<font color="#000080">(</font><font color="#800000">$e1</font><font color="#000080">,</font>Bufferin<font color="#000080">,</font>BufferOut<font color="#000080">,</font>Error<font color="#000080">);

    </font>duh <font color="#000080">:= </font>bufferout<font color="#000080">.</font>messlen<font color="#000080">;
    </font>getmessage<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(</font>duh<font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1</font><font color="#FF0000"><b>to </b></font>duh <font color="#FF0000"><b>do
        </b></font>Getmessage<font color="#000080">[</font>x<font color="#000080">] := </font>chr<font color="#000080">(</font>bufferout<font color="#000080">.</font>mess<font color="#000080">[</font>x<font color="#000080">]);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>SendPersonalMessage<font color="#000080">(</font>Con <font color="#000080">: </font>Byte<font color="#000080">;</font><font color="#FF0000"><b>Message </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Type
  </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Len <font color="#000080">: </font>Word<font color="#000080">;
    </font>Sub <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Data <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">228</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;                        </font><font color="#008000"><i>{likely works. page 375-376}
  </i></font>Reply <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Len <font color="#000080">: </font>word<font color="#000080">;
    </font>Num <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Results <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Bufferin <font color="#000080">: </font>request<font color="#000080">;
  </font>Bufferout <font color="#000080">: </font>reply<font color="#000080">;
  </font>x<font color="#000080">,</font>i <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>fillchar<font color="#000080">(</font>Bufferin<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Bufferin<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>Fillchar<font color="#000080">(</font>Bufferout<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>Bufferin<font color="#000080">.</font>sub <font color="#000080">:= </font><font color="#800000">$04</font><font color="#000080">;
    </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>bufferin<font color="#000080">.</font>data<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;</font><font color="#008000"><i>{num of connections}
    </i></font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font>Bufferin<font color="#000080">.</font>Data<font color="#000080">[</font>i<font color="#000080">] := </font>Con<font color="#000080">;</font><font color="#008000"><i>{which connection number?}
    </i></font>inc<font color="#000080">(</font>I<font color="#000080">);
    </font>Bufferin<font color="#000080">.</font>data<font color="#000080">[</font>i<font color="#000080">] := </font>length<font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">);</font><font color="#008000"><i>{length of message}
    </i></font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>X <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">) </font><font color="#FF0000"><b>do</b></font><font color="#008000"><i>{actual message}
      </i></font><font color="#FF0000"><b>Begin
        </b></font>bufferin<font color="#000080">.</font>data<font color="#000080">[</font>i<font color="#000080">] := </font>ord<font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">[</font>x<font color="#000080">]);
        </font>inc<font color="#000080">(</font>i<font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Bufferin<font color="#000080">.</font>Len <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">+</font>Length<font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">);
    </font>callint<font color="#000080">(</font><font color="#800000">$e1</font><font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);</font><font color="#008000"><i>{call the int}
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>broadcastToConsole<font color="#000080">(</font><font color="#FF0000"><b>message </b></font><font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Type
  </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>sub <font color="#000080">: </font>byte<font color="#000080">;
    </font>Messlen <font color="#000080">: </font>byte<font color="#000080">;
    </font>mess <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">$3c</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>bufferin  <font color="#000080">: </font>request<font color="#000080">;
  </font>bufferout <font color="#000080">: </font>noreturn<font color="#000080">;
  </font>x <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>fillchar<font color="#000080">(</font>Bufferin<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Bufferin<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>Fillchar<font color="#000080">(</font>Bufferout<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>bufferin<font color="#000080">.</font>len <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">+</font>length<font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">);
    </font>bufferin<font color="#000080">.</font>sub <font color="#000080">:= </font><font color="#800000">$09</font><font color="#000080">;
    </font>Bufferin<font color="#000080">.</font>messlen <font color="#000080">:= </font>Length<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>Bufferin<font color="#000080">.</font>Mess<font color="#000080">[</font>x<font color="#000080">] := </font>ord<font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">[</font>x<font color="#000080">]);
    </font>callint<font color="#000080">(</font><font color="#800000">$e1</font><font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>function </b></font>idnumber <font color="#000080">: </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>id <font color="#000080">: </font>longint<font color="#000080">;
  </font>l <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>getbinderyaccess<font color="#000080">(</font>L<font color="#000080">,</font>id<font color="#000080">);</font><font color="#008000"><i>{just uses this routine}
    </i></font>idnumber <font color="#000080">:= </font>id<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>Getconnectioninfo<font color="#000080">(</font>Con <font color="#000080">: </font>byte<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>U <font color="#000080">: </font>userrec<font color="#000080">);
</font><font color="#FF0000"><b>type
  </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;                              </font><font color="#008000"><i>{this routine}
    </i></font>sub <font color="#000080">: </font>byte<font color="#000080">;                              </font><font color="#008000"><i>{will get all}
    </i></font>connect <font color="#000080">: </font>byte<font color="#000080">;                          </font><font color="#008000"><i>{info about a}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                                       </font><font color="#008000"><i>{connection..}
  </i></font>reply <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>len <font color="#000080">: </font>word<font color="#000080">;
    </font>id <font color="#000080">: </font>longint<font color="#000080">;
    </font>ot <font color="#000080">:</font>word<font color="#000080">;
    </font>stuff <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">48</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
    </font>log  <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>bufferin <font color="#000080">: </font>request<font color="#000080">;
  </font>bufferout <font color="#000080">: </font>reply<font color="#000080">;
  </font>x<font color="#000080">,</font>i <font color="#000080">: </font>byte<font color="#000080">;
  </font>t1<font color="#000080">,</font>t2 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>year <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>date <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>bufferin<font color="#000080">.</font>len <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
    </font>bufferin<font color="#000080">.</font>sub <font color="#000080">:= </font><font color="#800000">$16</font><font color="#000080">;
    </font>bufferin<font color="#000080">.</font>connect <font color="#000080">:= </font>con<font color="#000080">;
    </font>fillchar<font color="#000080">(</font>Bufferout<font color="#000080">,</font>sizeof<font color="#000080">(</font>Bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>bufferout<font color="#000080">.</font>len <font color="#000080">:= </font>sizeof<font color="#000080">(</font>Bufferout<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">;
    </font>callint<font color="#000080">(</font><font color="#800000">$e3</font><font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);
    </font>u<font color="#000080">.</font>objtype <font color="#000080">:= </font>bufferout<font color="#000080">.</font>ot<font color="#000080">;
    </font>u<font color="#000080">.</font>id <font color="#000080">:= </font>bufferout<font color="#000080">.</font>id<font color="#000080">;
    </font>t1 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>t1<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(</font><font color="#800000">48</font><font color="#000080">);
    </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">48 </font><font color="#FF0000"><b>do
      begin
        </b></font>t1<font color="#000080">[</font>x<font color="#000080">] := </font>chr<font color="#000080">(</font>bufferout<font color="#000080">.</font>stuff<font color="#000080">[</font>i<font color="#000080">]);
        </font>inc<font color="#000080">(</font>i<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>t2 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
   </font>t2<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
   </font>i <font color="#000080">:= </font><font color="#800000">48</font><font color="#000080">;
   </font>u<font color="#000080">.</font>name <font color="#000080">:= </font>t1<font color="#000080">;
   </font>t1 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
   </font><font color="#FF0000"><b>with </b></font>bufferout <font color="#FF0000"><b>do
     begin
       </b></font>str<font color="#000080">(</font>log<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>t1<font color="#000080">);</font><font color="#008000"><i>{month}
       </i></font>date <font color="#000080">:= </font>t1<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">;
       </font>str<font color="#000080">(</font>log<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>t1<font color="#000080">);
       </font>date <font color="#000080">:= </font>date<font color="#000080">+</font>t1<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">; </font><font color="#008000"><i>{day}
       </i></font>str<font color="#000080">(</font>log<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>t1<font color="#000080">); </font><font color="#008000"><i>{year}
       </i></font>date <font color="#000080">:= </font>date<font color="#000080">+</font>t1<font color="#000080">;
       </font>u<font color="#000080">.</font>logindate <font color="#000080">:= </font>date<font color="#000080">;
       </font>str<font color="#000080">(</font>log<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">],</font>t1<font color="#000080">);</font><font color="#008000"><i>{hour}
       </i></font>date <font color="#000080">:= </font>t1<font color="#000080">+</font><font color="#800000">':'</font><font color="#000080">;
       </font>str<font color="#000080">(</font>log<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">],</font>t1<font color="#000080">);
       </font>date <font color="#000080">:= </font>date<font color="#000080">+</font>T1<font color="#000080">+</font><font color="#800000">':'</font><font color="#000080">;</font><font color="#008000"><i>{min}
       </i></font>str<font color="#000080">(</font>log<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">],</font>t1<font color="#000080">);</font><font color="#008000"><i>{sec}
       </i></font>date <font color="#000080">:= </font>date<font color="#000080">+</font>t1<font color="#000080">;
       </font>u<font color="#000080">.</font>logintime <font color="#000080">:= </font>t1<font color="#000080">;
       </font>u<font color="#000080">.</font>weekday <font color="#000080">:= </font>Week<font color="#000080">[</font>log<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]];
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>delnulls<font color="#000080">(</font>u<font color="#000080">.</font>name<font color="#000080">);
  </font>u<font color="#000080">.</font>connection <font color="#000080">:= </font>con<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Begin
End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p></body>
</html>
