<html>
<head><title> "Novell Detection" by DENNIS RUSH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Is there a way to detect if a system is running under Novell
&gt; Netware? There must be an interrupt to do that, but wich one?


     Yes there is.  Although this is in assembly, I'm sure you can dig
out what you need and convert it to Pascal or inline ASM. I've also
included for the more common multitaskers. I always try to check for
each at the beginning of a program so I can code to take advantage of
the features of whatever system it's operating under, or at least
prevent problems.
}

</i></font><font color="#000080">;*****************************************************************
;*    </font>Check <font color="#FF0000"><b>to </b></font>see <font color="#FF0000"><b>if </b></font>we are running under a Novell Network      <font color="#000080">*
;*****************************************************************
.</font><font color="#FF0000"><b>public     </b></font>chk_novell
<font color="#000080">.</font>proc       chk_novell  auto
    <font color="#000080">.</font>push   es<font color="#000080">,</font>di               <font color="#000080">; </font>Protect the registers well use
    <font color="#FF0000"><b>xor     </b></font>ax<font color="#000080">,</font>ax               <font color="#000080">; </font><font color="#FF0000"><b>and </b></font>clear them
    push    ax
    push    ax
    <font color="#000080">.</font>pop    es<font color="#000080">,</font>di
    mov     ax<font color="#000080">,</font><font color="#800000">07</font>A00H           <font color="#000080">; </font>Novel Netware installation check
    int     <font color="#800000">2</font>FH                 <font color="#000080">; </font>Check it
    <font color="#FF0000"><b>or      </b></font>al<font color="#000080">,</font>al               <font color="#000080">; </font><font color="#FF0000"><b>If </b></font>installed<font color="#000080">, </font>al <font color="#000080">= </font><font color="#800000">0</font>FFH
                                <font color="#000080">;  </font>ES<font color="#000080">:</font>DI ptr <font color="#000080">-&gt; </font><font color="#FF0000"><b>far </b></font>entry point <font color="#FF0000"><b>for
                                </b></font><font color="#000080">;  </font>routines otherwise accessed through
                                <font color="#000080">;  </font>INT <font color="#800000">21</font>H
    jnz     double_check        <font color="#000080">; </font>Appears <font color="#FF0000"><b>to </b></font>be installed<font color="#000080">, </font>see <font color="#FF0000"><b>if </b></font>there
                                <font color="#000080">;  </font><font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>far </b></font>address <font color="#FF0000"><b>in </b></font>ES<font color="#000080">:</font>DI
    stc                         <font color="#000080">; </font><font color="#FF0000"><b>Set </b></font>carry <font color="#FF0000"><b>to </b></font>indicate no network
    <font color="#000080">.</font>pop    es<font color="#000080">,</font>di               <font color="#000080">; </font>restore what we used
    ret                         <font color="#000080">; </font><font color="#FF0000"><b>and </b></font>exit
double_check<font color="#000080">:
    </font>push    di                  <font color="#000080">; </font>Check
    pop     ax
    <font color="#FF0000"><b>or      </b></font>ax<font color="#000080">,</font>ax               <font color="#000080">; </font><font color="#FF0000"><b>Is </b></font>it empty
    jnz     in_novell           <font color="#000080">; </font>No has pointer so were <font color="#FF0000"><b>in </b></font>a network
    push    es
    pop     ax
    <font color="#FF0000"><b>or      </b></font>ax<font color="#000080">,</font>ax               <font color="#000080">; </font><font color="#FF0000"><b>Is </b></font>it empty
    jnz     in_novell           <font color="#000080">; </font>No has pointer
    stc                         <font color="#000080">; </font>No pointer <font color="#FF0000"><b>to far </b></font>address so no network
                                <font color="#000080">;  </font>Chance <font color="#FF0000"><b>of </b></font>a ptr <font color="#FF0000"><b>to </b></font><font color="#800000">0000</font><font color="#000080">:</font><font color="#800000">0000 </font>are
                                <font color="#000080">;  </font>basically non<font color="#000080">-</font>existant
in_novell<font color="#000080">:
    .</font>pop    es<font color="#000080">,</font>di               <font color="#000080">; </font>Clean up after ourselves
    ret                         <font color="#000080">; </font><font color="#FF0000"><b>and </b></font>go home
<font color="#000080">.</font>endp       chk_novell
<font color="#000080">;***********************************************************************
;* </font>Check <font color="#FF0000"><b>to </b></font>see <font color="#FF0000"><b>if </b></font>we are running under Desqview<font color="#000080">, </font>TopView<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>TaskView <font color="#000080">*
;***********************************************************************
.</font><font color="#FF0000"><b>public     </b></font>chk_desq
<font color="#000080">.</font>proc       chk_desq  auto
    <font color="#000080">.</font>push   ax<font color="#000080">,</font>bx               <font color="#000080">; </font>Save registers we will use
    mov     ax<font color="#000080">,</font><font color="#800000">1022</font>H            <font color="#000080">; </font>This <font color="#FF0000"><b>is </b></font>the get version <font color="#FF0000"><b>function
                                </b></font><font color="#000080">;  </font>that TopView installs <font color="#FF0000"><b>for </b></font>Int <font color="#800000">15</font>H<font color="#000080">.
                                ;  </font>Most TopView compatibles use the
                                <font color="#000080">;  </font>same <font color="#FF0000"><b>function </b></font>so we can check <font color="#FF0000"><b>for
                                </b></font><font color="#000080">;  </font>several <font color="#FF0000"><b>with </b></font>just one call
    <font color="#FF0000"><b>xor     </b></font>dx<font color="#000080">,</font>dx               <font color="#000080">; </font>Clear dx
    int     <font color="#800000">15</font>H                 <font color="#000080">; </font>Make the call
    cmp     bx<font color="#000080">,</font><font color="#800000">0</font>a01H            <font color="#000080">; </font>DesqView <font color="#800000">2.</font>x returns <font color="#800000">0</font>A01H
    jnz     try_task            <font color="#000080">; </font>Did we get it
    mov     <font color="#000080">@</font>dataseg<font color="#000080">:</font>Desqview<font color="#000080">,</font><font color="#800000">1 </font><font color="#000080">; </font>YES<font color="#000080">, </font>save it <font color="#FF0000"><b>and </b></font>go home
    jmp     short No_View
try_task<font color="#000080">:                       ; </font>No<font color="#000080">, </font><font color="#FF0000"><b>Try </b></font>TaskView
    cmp     bx<font color="#000080">,</font><font color="#800000">0001</font>H            <font color="#000080">; </font>TaskView Returns <font color="#800000">0001</font>H
    jnz     try_top             <font color="#000080">; </font>Get it
    mov     <font color="#000080">@</font>dataseg<font color="#000080">:</font>TaskView<font color="#000080">,</font><font color="#800000">1 </font><font color="#000080">; </font>Yes
    jmp     short No_View
try_top<font color="#000080">:                        ; </font>No<font color="#000080">, </font><font color="#FF0000"><b>try </b></font>TopView<font color="#000080">. </font>Top View returns it<font color="#800000">'s
    </font><font color="#FF0000"><b>or      </b></font>bx<font color="#000080">,</font>bx               <font color="#000080">; </font>version so just test <font color="#FF0000"><b>for </b></font>non<font color="#000080">-</font>zero
    jz      No_View             <font color="#000080">; </font><font color="#FF0000"><b>is </b></font>it non<font color="#000080">-</font>zero
    mov     <font color="#000080">@</font>dataseg<font color="#000080">:</font>TopView<font color="#000080">,</font><font color="#800000">1  </font><font color="#000080">; </font>Yes<font color="#000080">, </font>save it
No_View<font color="#000080">:
    .</font>pop    ax<font color="#000080">,</font>bx               <font color="#000080">; </font>Restore regs <font color="#FF0000"><b>and </b></font>go home
    ret
<font color="#000080">.</font>endp       chk_desq

<font color="#008000"><i>{
   Hope this helps. BTW, I don't know about the later versions of
Windows, but the older versions respected the Desqview installation
check.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p></body>
</html>
