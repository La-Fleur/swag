<html>
<head><title> "Novell Reading" by KEVIN R. PIERCE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0028.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>Litl_Nov<font color="#000080">;

</font><font color="#008000"><i>(**********************************************************************)
(*    by Kevin R. Pierce                                              *)
(*       December 29, 1991                                            *)
(*    Kev1n@aol.com                                                   *)
(**********************************************************************)
</i></font><font color="#FF0000"><b>interface

type
  </b></font>LoginTime    <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;

  </font>ConnectionInfo <font color="#000080">= </font><font color="#FF0000"><b>record
                     </b></font>Object_ID   <font color="#000080">: </font>longint<font color="#000080">;
                     </font>Object_Type <font color="#000080">: </font>word<font color="#000080">;
                     </font>Object_Name <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">48</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
                     </font>Login_Time  <font color="#000080">: </font>LoginTime<font color="#000080">;
                     </font>ApplicationNumber     <font color="#000080">: </font>word<font color="#000080">;    </font><font color="#008000"><i>{swap &amp; display Hex}
                   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>CnxnInfoREQUEST <font color="#000080">= </font><font color="#FF0000"><b>record
                      </b></font>ReqBuffLen <font color="#000080">: </font>word<font color="#000080">;  </font><font color="#008000"><i>{always = 2}
                      </i></font>Mask       <font color="#000080">: </font>byte<font color="#000080">;  </font><font color="#008000"><i>{always = 16h}
                      </i></font>CnxnNo     <font color="#000080">: </font>byte<font color="#000080">;  </font><font color="#008000"><i>{ &gt;1 }
                    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>CnxnInfoREPLY <font color="#000080">= </font><font color="#FF0000"><b>record
                    </b></font>RepBuffLen <font color="#000080">: </font>word<font color="#000080">;  </font><font color="#008000"><i>{always = SIZEOF(ConnectionInfo) }
                    </i></font>Data       <font color="#000080">: </font>ConnectionInfo<font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function  </b></font>NOV_GetConnectionNumber<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>NOV_GetConnectionInformation<font color="#000080">(</font>connection<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var
</b></font>Result<font color="#000080">:</font>ConnectionInfo<font color="#000080">);

</font><font color="#008000"><i>(**********************************************************************)
</i></font><font color="#FF0000"><b>implementation

uses
  </b></font>dos<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>NOV_GetConnectionNumber<font color="#000080">:</font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>buf <font color="#000080">: </font>registers<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>buf<font color="#000080">.</font>AH<font color="#000080">:=</font><font color="#800000">$DC</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>buf<font color="#000080">);
    </font>NOV_GetConnectionNumber<font color="#000080">:=</font>buf<font color="#000080">.</font>AL<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>NOV_GetConnectionInformation<font color="#000080">(</font>connection<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var
</b></font>Result<font color="#000080">:</font>ConnectionInfo<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>buf <font color="#000080">: </font>registers<font color="#000080">;
    </font>req <font color="#000080">: </font>CnxnInfoREQUEST<font color="#000080">;
    </font>rep <font color="#000080">: </font>CnxnInfoREPLY<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    with </b></font>buf <font color="#FF0000"><b>do
      begin
        </b></font>AH<font color="#000080">:=</font><font color="#800000">$E3</font><font color="#000080">;
        </font>DS<font color="#000080">:=</font>seg<font color="#000080">(</font>req<font color="#000080">);
        </font>SI<font color="#000080">:=</font>ofs<font color="#000080">(</font>req<font color="#000080">);
        </font>ES<font color="#000080">:=</font>seg<font color="#000080">(</font>rep<font color="#000080">);
        </font>DI<font color="#000080">:=</font>ofs<font color="#000080">(</font>rep<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>with </b></font>req <font color="#FF0000"><b>do
      begin
        </b></font>ReqBuffLen <font color="#000080">:= </font>Sizeof<font color="#000080">(</font>req<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">;
        </font>Mask       <font color="#000080">:= </font><font color="#800000">$16</font><font color="#000080">;
        </font>CnxnNo     <font color="#000080">:= </font>Connection<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>fillchar<font color="#000080">(</font>rep<font color="#000080">,</font>sizeof<font color="#000080">(</font>rep<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
    </font>rep<font color="#000080">.</font>RepBuffLen<font color="#000080">:=</font>Sizeof<font color="#000080">(</font>rep<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>buf<font color="#000080">);
    </font>Result<font color="#000080">:=</font>rep<font color="#000080">.</font>data<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0028.PAS">Original</a><b>]</b></p></body>
</html>
