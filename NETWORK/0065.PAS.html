<html>
<head><title> "How to program IPX on Netware systems" by KENNETH JOHNSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0065.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">                         How <font color="#FF0000"><b>to program </b></font>IPX <font color="#FF0000"><b>on </b></font>Netware systems
                              Written By Kenneth Johnson
                                     July <font color="#800000">29</font>th <font color="#800000">1996
                                  </font>Updated Dec <font color="#800000">5</font>th <font color="#800000">1997

      </font>Table <font color="#FF0000"><b>of </b></font>contents

      Section <font color="#800000">0. </font>General Info
      Section <font color="#800000">1. </font>Network addresses <font color="#FF0000"><b>and </b></font>socket numbers
      Section <font color="#800000">2. </font>Data types <font color="#FF0000"><b>and </b></font>packet format<font color="#000080">.
      </font>Section <font color="#800000">3. </font>The information <font color="#FF0000"><b>in </b></font>Section <font color="#800000">2 </font><font color="#FF0000"><b>in Pascal record </b></font>types<font color="#000080">.
      </font>Section <font color="#800000">4. </font>The routines<font color="#000080">.
      </font>Section <font color="#800000">5. </font><font color="#FF0000"><b>Program </b></font>flow
      Section <font color="#800000">6. </font>Common questions<font color="#000080">.
      </font>Section <font color="#800000">7. </font>Other stuff<font color="#000080">.
      </font>Section <font color="#800000">8. </font>About Kenneth Johnson<font color="#000080">.
      </font>Section <font color="#800000">9. </font>Future works<font color="#000080">.

      </font>Hello<font color="#000080">! </font>I wrote this document <font color="#FF0000"><b>to </b></font>give programmers a basic
      understanding <font color="#FF0000"><b>of </b></font>the use <font color="#FF0000"><b>of </b></font>IPX<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>what it can <font color="#FF0000"><b>do</b></font><font color="#000080">. </font>The
      following information may work well<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>may <font color="#FF0000"><b>not </b></font>work at all<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>I
      didn<font color="#800000">'t think it would work then I probably wouldn'</font>t write this<font color="#000080">. </font>I
      can<font color="#800000">'t test my IPX stuff because I am currently not on a network.
      </font>But it worked ok when I was <font color="#FF0000"><b>in </b></font>school so I am assuming it works now<font color="#000080">.
      </font><font color="#FF0000"><b>If </b></font>you are a fairly good programmer<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>understand networks <font color="#FF0000"><b>and
      </b></font>interrupts <font color="#FF0000"><b>then </b></font>you should <font color="#FF0000"><b>not </b></font>have much trouble writing your own
      routines from this text<font color="#000080">. </font>You should have a good idea <font color="#FF0000"><b>of record
      </b></font>types<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>very basic assembly language<font color="#000080">. </font>I<font color="#800000">'ve included the code you need
      </font><font color="#FF0000"><b>for </b></font>the routines<font color="#000080">.
           </font>Another thing I should explain <font color="#FF0000"><b>is </b></font>that some data fields have
      <font color="#000080">(</font>hi<font color="#000080">-</font>low<font color="#000080">) </font>beside them<font color="#000080">. </font>That means that the most
      significant byte should be switched <font color="#FF0000"><b>with </b></font>the least significant
      byte<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>the variable X must be switched <font color="#FF0000"><b>in </b></font>this manner it would
      look like this <font color="#000080">(</font><font color="#FF0000"><b>in pascal</b></font><font color="#000080">): </font>X <font color="#000080">:= </font>swap<font color="#000080">(</font>X<font color="#000080">);

      </font>Section <font color="#800000">0. </font>General info

      What does IPX stand <font color="#FF0000"><b>for</b></font><font color="#000080">?

      </font>IPX stands <font color="#FF0000"><b>for </b></font><font color="#000080">(</font>I<font color="#000080">)</font>nternetwork <font color="#000080">(</font>P<font color="#000080">)</font>acket E<font color="#000080">(</font>x<font color="#000080">)</font>change Protocol<font color="#000080">, </font>it <font color="#FF0000"><b>is
      </b></font>used by networks <font color="#FF0000"><b>to </b></font>send <font color="#FF0000"><b>and </b></font>receive information quickly <font color="#FF0000"><b>to and
      </b></font>from the server <font color="#FF0000"><b>and </b></font>other computers<font color="#000080">.


      </font>Why use IPX <font color="#FF0000"><b>and not </b></font>SPX<font color="#000080">?

      </font>The reason I have wrote IPX routines <font color="#FF0000"><b>and not </b></font>SPX <font color="#FF0000"><b>is </b></font>that IPX <font color="#FF0000"><b>is
      </b></font>faster<font color="#000080">. </font>The problem <font color="#FF0000"><b>with </b></font>IPX <font color="#FF0000"><b>is </b></font>that it just sends the packet <font color="#FF0000"><b>to
      </b></font>the destination computer<font color="#000080">. </font>It may <font color="#FF0000"><b>not </b></font>necessarily get there<font color="#000080">, </font><font color="#FF0000"><b>and
      if </b></font>you send multiple packets sequentially<font color="#000080">, </font>the third packet may
      get there before the first<font color="#000080">, </font>whereas SPX <font color="#000080">(</font>S<font color="#000080">)</font>equenced <font color="#000080">(</font>P<font color="#000080">)</font>acket
      E<font color="#000080">(</font>x<font color="#000080">)</font>change makes sure that they are delivered <font color="#FF0000"><b>in </b></font>the proper
      order<font color="#000080">. </font>These problems are easily overcome<font color="#000080">.


      </font>Section <font color="#800000">1. </font>Network addresses<font color="#000080">.

      &thorn; </font>What <font color="#FF0000"><b>is </b></font>an address <font color="#000080">&thorn;

      </font>A network address <font color="#FF0000"><b>is </b></font>comprised <font color="#FF0000"><b>of </b></font>a Network Number<font color="#000080">, </font><font color="#FF0000"><b>and
      </b></font>a Node Number within a Network<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>how Netware recognizes
      you <font color="#FF0000"><b>on </b></font>the network<font color="#000080">.

      </font>The format <font color="#FF0000"><b>of </b></font>a netware address<font color="#000080">:
      </font><font color="#800000">1. </font>Network number <font color="#000080">(</font>hi<font color="#000080">-</font>low<font color="#000080">) : =</font>long integer<font color="#000080">=
      </font><font color="#800000">2. </font>node address   <font color="#000080">(</font>hi<font color="#000080">-</font>low<font color="#000080">) : =</font><font color="#FF0000"><b>array of </b></font>six bytes<font color="#000080">=
      </font><font color="#800000">3. </font>Socket number  <font color="#000080">(</font>hi<font color="#000080">-</font>low<font color="#000080">) : =</font>word<font color="#000080">=

      </font>A socket <font color="#FF0000"><b>is </b></font>a <font color="#000080">&quot;</font>highway<font color="#000080">&quot; </font><font color="#FF0000"><b>or </b></font>connection that this
      information should be sent <font color="#FF0000"><b>on</b></font><font color="#000080">. </font>You can pick any number <font color="#FF0000"><b>for </b></font>the
      socket<font color="#000080">, </font>but Netware has some reserved<font color="#000080">. </font>Also games like DOOM send
      packets via IPX during a net game<font color="#000080">. </font>DOOM sends <font color="#FF0000"><b>on </b></font>socket number
      <font color="#800000">$869C</font><font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you really want <font color="#FF0000"><b>to </b></font>ruin a net DOOM game<font color="#000080">, </font>start sending
      packets <font color="#FF0000"><b>on </b></font>this socket<font color="#000080">. (</font><font color="#FF0000"><b>And </b></font>see how unpopular you<font color="#800000">'ll become!)
      </font>Getting your address <font color="#FF0000"><b>and </b></font>others <font color="#FF0000"><b>is </b></font>fairly simple<font color="#000080">.


      </font>Section <font color="#800000">2. </font>Data types <font color="#FF0000"><b>and </b></font>packet format

      <font color="#000080">&thorn; </font>Inside IPX <font color="#000080">&thorn;

      </font>I will now discuss some <font color="#FF0000"><b>of </b></font>the parts <font color="#FF0000"><b>of </b></font>IPX<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>the hardest
      part <font color="#FF0000"><b>in </b></font>understanding IPX<font color="#000080">. </font><font color="#FF0000"><b>To </b></font>send information from one computer
      <font color="#FF0000"><b>to </b></font>another<font color="#000080">, </font><font color="#FF0000"><b>or to </b></font>all computers that are <font color="#FF0000"><b>on </b></font>the network IPX <font color="#FF0000"><b>uses
      </b></font>PACKETS<font color="#000080">. </font>Packets are  <font color="#000080">&quot;</font>pieces<font color="#000080">&quot; </font><font color="#FF0000"><b>of </b></font>information<font color="#000080">.  </font><font color="#FF0000"><b>To </b></font>send
      a packet<font color="#000080">, </font>you must <font color="#FF0000"><b>set </b></font>up something called an ECB <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>E<font color="#000080">)</font>vent
      <font color="#000080">(</font>C<font color="#000080">)</font>ontrol <font color="#000080">(</font>B<font color="#000080">)</font>lock <font color="#FF0000"><b>with </b></font>an IPX header <font color="#FF0000"><b>and </b></font>datagram<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>what
      IPX <font color="#FF0000"><b>uses as </b></font>information <font color="#FF0000"><b>to </b></font>send data<font color="#000080">. </font>What are all these things<font color="#000080">?
      </font>Keep reading <font color="#FF0000"><b>and </b></font>I<font color="#800000">'ll explain. The numbers beside each data field
      </font>correspond <font color="#FF0000"><b>to </b></font>the information that follows the format listing<font color="#000080">.

      &thorn; </font>Format <font color="#FF0000"><b>of </b></font>IPX header <font color="#000080">&thorn;

      (</font><font color="#800000">1</font><font color="#000080">) </font>Checksum <font color="#000080">(</font>hi<font color="#000080">-</font>low<font color="#000080">) : =</font>word<font color="#000080">=
      (</font><font color="#800000">2</font><font color="#000080">) </font>Length <font color="#FF0000"><b>of </b></font>packet <font color="#000080">(</font>hi<font color="#000080">-</font>low<font color="#000080">) : =</font>word<font color="#000080">=
      (</font><font color="#800000">3</font><font color="#000080">) </font>Transport control <font color="#000080">: =</font>byte<font color="#000080">=
      (</font><font color="#800000">4</font><font color="#000080">) </font>packet <font color="#FF0000"><b>type </b></font><font color="#000080">(</font>hi<font color="#000080">-</font>low<font color="#000080">) : =</font>byte<font color="#000080">=
      (</font><font color="#800000">5</font><font color="#000080">) </font>Destination address <font color="#000080">: (</font>address <font color="#FF0000"><b>record type </b></font>discussed above<font color="#000080">)
      (</font><font color="#800000">6</font><font color="#000080">) </font>The source address  <font color="#000080">: (</font>address <font color="#FF0000"><b>record type </b></font>discussed above<font color="#000080">)

      </font><font color="#800000">1. </font>Just <font color="#FF0000"><b>set </b></font>this <font color="#FF0000"><b>to </b></font>zero <font color="#000080">(</font>don<font color="#800000">'t worry about the hi-low stuff)
      2. </font>The length <font color="#FF0000"><b>of </b></font>the packet you are going <font color="#FF0000"><b>to </b></font>send<font color="#000080">. </font>Just
         Sizeof<font color="#000080">(</font>IPXHEADER<font color="#000080">). (</font>the size <font color="#FF0000"><b>of </b></font>the ipx header<font color="#000080">)
      </font><font color="#800000">3. </font>Just <font color="#FF0000"><b>set to </b></font>zero<font color="#000080">.
      </font><font color="#800000">4. </font>The <font color="#FF0000"><b>type of </b></font>packet you are going <font color="#FF0000"><b>to </b></font>send<font color="#000080">. </font>I just <font color="#FF0000"><b>set to </b></font>zero<font color="#000080">,
         </font>but different values have different <font color="#FF0000"><b>uses</b></font><font color="#000080">. </font>You can also use
         four<font color="#000080">.
      </font><font color="#800000">5. </font>The filled destination address<font color="#000080">, </font>the computer<font color="#000080">(</font>s<font color="#000080">) </font>you want <font color="#FF0000"><b>to
         </b></font>send this packet <font color="#FF0000"><b>to</b></font><font color="#000080">. </font>You must also fill <font color="#FF0000"><b>in </b></font>the socket number<font color="#000080">,
         </font>a value you choose <font color="#FF0000"><b>for </b></font>the socket that you are sending <font color="#FF0000"><b>on</b></font><font color="#000080">, </font><font color="#FF0000"><b>and
         </b></font>the other computer<font color="#000080">(</font>s<font color="#000080">) </font>are listening <font color="#FF0000"><b>on</b></font><font color="#000080">.
      </font><font color="#800000">6. </font>The filled source address <font color="#000080">(</font>your address<font color="#000080">) </font><font color="#FF0000"><b>with </b></font>the socket <font color="#FF0000"><b>to
         </b></font>send <font color="#FF0000"><b>on </b></font>filled<font color="#000080">.


      &thorn; </font>Format <font color="#FF0000"><b>of </b></font>ECB <font color="#000080">&thorn;

      </font>Here<font color="#800000">'s the format for an IPX Event Control Block.

      </font><font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)  </font>Link                             <font color="#000080">: =</font>long integer<font color="#000080">=
      (</font><font color="#800000">2</font><font color="#000080">)  </font>Pointer <font color="#FF0000"><b>To </b></font>Event Service Routine <font color="#000080">: =</font>long integer<font color="#000080">=
      (</font><font color="#800000">3</font><font color="#000080">)  </font><font color="#FF0000"><b>In</b></font><font color="#000080">-</font>Use<font color="#000080">-</font>Flag                      <font color="#000080">: =</font>byte<font color="#000080">=
      (</font><font color="#800000">4</font><font color="#000080">)  </font>Completion Code                  <font color="#000080">: =</font>byte<font color="#000080">=
      (</font><font color="#800000">5</font><font color="#000080">)  </font>Socket Number <font color="#000080">(</font>hi<font color="#000080">-</font>low<font color="#000080">)           : =</font>word<font color="#000080">=
      (</font><font color="#800000">6</font><font color="#000080">)  </font>workspace                        <font color="#000080">: =</font>four bytes<font color="#000080">=
      (</font><font color="#800000">7</font><font color="#000080">)  </font>driver workspace                 <font color="#000080">: =</font>twelve bytes<font color="#000080">=
      (</font><font color="#800000">8</font><font color="#000080">)  </font>Immediate Local Node Address     <font color="#000080">: =</font>six bytes<font color="#000080">=
      (</font><font color="#800000">9</font><font color="#000080">)  </font>Fragment Count                   <font color="#000080">: =</font>word<font color="#000080">=
      (</font><font color="#800000">10</font><font color="#000080">) </font>Data Fragments                   <font color="#000080">: =</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of
                                              </b></font>fragments<font color="#000080">= (</font>see below<font color="#000080">)


      &thorn; </font>Format <font color="#FF0000"><b>of </b></font>a fragment <font color="#FF0000"><b>record </b></font><font color="#000080">(</font>Data Fragments<font color="#000080">) &thorn;

      </font>Format <font color="#FF0000"><b>for </b></font>the fragments <font color="#FF0000"><b>of </b></font>data found <font color="#FF0000"><b>in </b></font>the ECB<font color="#000080">. </font>This does <font color="#FF0000"><b>not
      </b></font>necessarily have <font color="#FF0000"><b>to </b></font>be an <font color="#FF0000"><b>array of </b></font>two fragments<font color="#000080">, </font>it could be
      more<font color="#000080">, </font>but this <font color="#FF0000"><b>is </b></font>what I use <font color="#FF0000"><b>and </b></font>I can guarantee that it works<font color="#000080">.

      </font>Pointer <font color="#FF0000"><b>to </b></font>Fragment <font color="#000080">: =</font>pointer<font color="#000080">=
      </font>Size <font color="#FF0000"><b>of </b></font>fragment    <font color="#000080">: =</font>word<font color="#000080">=

      </font>Explanation <font color="#FF0000"><b>of </b></font>the ECB data fields<font color="#000080">:

      </font><font color="#800000">1.</font>When setting up an ECB I don<font color="#800000">'t even bother with the &quot;link&quot;.
        </font>I<font color="#800000">'m not even sure about it'</font>s purpose<font color="#000080">.

      </font><font color="#800000">2.</font>You don<font color="#800000">'t have to fill this field either. This is an address
        </font><font color="#FF0000"><b>to </b></font>the event service routine<font color="#000080">. </font>When the ECB you have given <font color="#FF0000"><b>to
        </b></font>IPX has been handled<font color="#000080">, </font>it calls this <font color="#FF0000"><b>procedure</b></font><font color="#000080">. </font>You don<font color="#800000">'t really
        </font>need it<font color="#000080">, </font>but I guess it would make life easier<font color="#000080">.

      </font><font color="#800000">3.</font>The <font color="#FF0000"><b>In</b></font><font color="#000080">-</font>Use<font color="#000080">-</font>Flag <font color="#FF0000"><b>is </b></font>used <font color="#FF0000"><b>to </b></font>determine whether <font color="#FF0000"><b>or not </b></font>IPX has
        gotten around <font color="#FF0000"><b>to </b></font>actually sending the data off <font color="#FF0000"><b>to </b></font>the other
        computer<font color="#000080">(</font>s<font color="#000080">). </font><font color="#FF0000"><b>If </b></font>it has sent the packet <font color="#FF0000"><b>then </b></font>this <font color="#FF0000"><b>is set as </b></font><font color="#800000">$0</font><font color="#000080">,
        </font><font color="#FF0000"><b>if </b></font>IPX did <font color="#FF0000"><b>not </b></font>send it<font color="#000080">, </font>it will be <font color="#800000">$ff</font><font color="#000080">. </font>The <font color="#FF0000"><b>in</b></font><font color="#000080">-</font>use<font color="#000080">-</font>flag could
        have other values which will be discussed later<font color="#000080">. </font>These two are
        the ones that are important right now<font color="#000080">.

      </font><font color="#800000">4.</font><font color="#FF0000"><b>If </b></font>the completion code <font color="#FF0000"><b>is </b></font><font color="#800000">0</font>h <font color="#FF0000"><b>then </b></font>IPX delivered the packet
        <font color="#FF0000"><b>with </b></font>no problems<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>it <font color="#FF0000"><b>is </b></font>anything <font color="#FF0000"><b>else then </b></font>it did <font color="#FF0000"><b>not </b></font>send
        it<font color="#000080">.

      </font><font color="#800000">5. </font>The socket that you are going <font color="#FF0000"><b>to </b></font>send the packet <font color="#FF0000"><b>on</b></font><font color="#000080">.

      </font><font color="#800000">6. </font>Just fill <font color="#FF0000"><b>with </b></font>zeros<font color="#000080">.

      </font><font color="#800000">7. </font>Just fill <font color="#FF0000"><b>with </b></font>zeros<font color="#000080">.

      </font><font color="#800000">8. </font>Your local node address<font color="#000080">. </font>We will be looking at routines that
         get your network address <font color="#000080">(</font>including node address<font color="#000080">)

      </font><font color="#800000">9. </font>Your fragment count<font color="#000080">. (</font><font color="#FF0000"><b>In </b></font>this document<font color="#000080">, </font>we<font color="#800000">'ll use 2)

      10. </font>You<font color="#800000">'re information that you want IPX to send. It is contained
          </font><font color="#FF0000"><b>in </b></font>DATAGRAMS<font color="#000080">. </font>Datagrams <font color="#FF0000"><b>is </b></font>the actual information you want <font color="#FF0000"><b>to
          </b></font>send<font color="#000080">, </font>whether it<font color="#800000">'s part of a file, for a chatting program, or
          </font>any other <font color="#FF0000"><b>type of </b></font>format<font color="#000080">.
          </font>A datagram can be maximum <font color="#800000">546 </font>bytes long<font color="#000080">. </font>I assume that the
          minimum would be <font color="#800000">1 </font><font color="#FF0000"><b>or </b></font><font color="#800000">0</font><font color="#000080">, </font>but that doesn<font color="#800000">'t really matter. I
          </font>have the datagram <font color="#FF0000"><b>as </b></font>an <font color="#FF0000"><b>array of </b></font>bytes<font color="#000080">:
          </font>Datagram <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">546</font><font color="#000080">]  </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
          </font><font color="#FF0000"><b>In </b></font>the fragment pointer <font color="#FF0000"><b>of </b></font>TFRAG<font color="#000080">, </font>you give it the datagram
          segment <font color="#FF0000"><b>and </b></font>offset <font color="#FF0000"><b>and in </b></font>the Size field you give it the size
          <font color="#FF0000"><b>of </b></font>the datagram<font color="#000080">, </font><font color="#FF0000"><b>in </b></font>this <font color="#FF0000"><b>case </b></font><font color="#800000">546 </font>bytes<font color="#000080">.
          </font>What <font color="#FF0000"><b>is </b></font>interesting about IPX <font color="#FF0000"><b>is </b></font>that instead <font color="#FF0000"><b>of </b></font>giving IPX
          variables <font color="#FF0000"><b>to </b></font>put information <font color="#FF0000"><b>in</b></font><font color="#000080">, </font>you give it their addresses<font color="#000080">,
          </font><font color="#FF0000"><b>and </b></font>IPX will take care <font color="#FF0000"><b>of </b></font>everything<font color="#000080">.
          </font><font color="#FF0000"><b>In </b></font>the Fragment <font color="#FF0000"><b>array </b></font>you must include the IPX header <font color="#FF0000"><b>in </b></font>the
          first fragment<font color="#000080">. </font>So you copy the stuff <font color="#FF0000"><b>in </b></font>the IPX
          header into the datagram<font color="#000080">, </font><font color="#FF0000"><b>and then </b></font>your other info into the
          second datagram <font color="#FF0000"><b>and </b></font>IPX handles it<font color="#000080">.



      </font>Section <font color="#800000">3. </font>The information <font color="#FF0000"><b>in </b></font>Section <font color="#800000">2 </font><font color="#FF0000"><b>in Pascal record </b></font>types<font color="#000080">.

      </font>Here<font color="#800000">'s what I babbled on about in section two in Pascal
      </font><font color="#FF0000"><b>Record </b></font>Types<font color="#000080">. </font>These are the actual things you send IPX so that it
      can work<font color="#000080">:


      </font><font color="#FF0000"><b>type

      </b></font><font color="#008000"><i>{The datagram record type}

       </i></font>datagramRec <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">546</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;   </font><font color="#008000"><i>{where you put the data
                                             you want to send}
      {IPX record type}

       </i></font>tipxheader <font color="#000080">= </font><font color="#FF0000"><b>record         </b></font><font color="#008000"><i>{IPX uses this to determine where }
         </i></font>checksum <font color="#000080">: </font>word<font color="#000080">;          </font><font color="#008000"><i>{it's going, from who and on}
         </i></font>Len      <font color="#000080">: </font>word<font color="#000080">;          </font><font color="#008000"><i>{which socket}
         </i></font>control  <font color="#000080">: </font>byte<font color="#000080">;
         </font>packettype <font color="#000080">: </font>byte<font color="#000080">;
         </font>dest<font color="#000080">,
         </font>source <font color="#000080">: </font>tinternetworkaddress<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#008000"><i>{network address record type without socket number}
        </i></font>networkaddressREC <font color="#000080">= </font><font color="#FF0000"><b>record
          </b></font>network <font color="#000080">: </font>longint<font color="#000080">;
          </font>nodeaddr <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#008000"><i>{network address record type with socket number}
        </i></font>tinternetworkaddressREC <font color="#000080">= </font><font color="#FF0000"><b>record </b></font><font color="#008000"><i>{full network address and socket}
          </i></font>network <font color="#000080">: </font>longint<font color="#000080">;
          </font>nodeaddr <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;

          </font>socket <font color="#000080">: </font>word<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#008000"><i>{the data fragment record type}

        </i></font>tfrag <font color="#000080">= </font><font color="#FF0000"><b>record     </b></font><font color="#008000"><i>{where the data pointers goes}
          </i></font>FragPtr <font color="#000080">: </font>pointer<font color="#000080">;
          </font>Size <font color="#000080">: </font>Word<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#008000"><i>{Event control block record type}

        </i></font>Tecb <font color="#000080">= </font><font color="#FF0000"><b>record </b></font><font color="#008000"><i>{what you send to IPX}
          </i></font>Link         <font color="#000080">: </font>pointer<font color="#000080">;
          </font>ESR          <font color="#000080">: </font>pointer<font color="#000080">;
          </font>inuse        <font color="#000080">: </font>byte<font color="#000080">;
          </font>code         <font color="#000080">: </font>byte<font color="#000080">;
          </font>socketnum    <font color="#000080">: </font>word<font color="#000080">;
          </font>ipxworkspace <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">]  </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
          </font>driver       <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
          </font>localnode    <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">]  </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
          </font>fragcount    <font color="#000080">: </font>word<font color="#000080">;
          </font>fragdata     <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">]  </font><font color="#FF0000"><b>of </b></font>tfrag<font color="#000080">;</font><font color="#008000"><i>{the first TFRAG should have}
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                                   </font><font color="#008000"><i>{the IPX header}


      </i></font>Section <font color="#800000">4.

      </font>The routines

      Here<font color="#800000">'s all the routines that you will be using to send packets,
      </font>listen <font color="#FF0000"><b>for </b></font>packets<font color="#000080">, </font>get your address <font color="#FF0000"><b>and </b></font>others<font color="#000080">.

      &thorn; </font>essential routines <font color="#000080">&thorn;
      </font><font color="#008000"><i>{------------------------------------------------------------------------}
      {sending a packet: ecbpointer is an ecb record type}
      </i></font><font color="#FF0000"><b>procedure </b></font>sendpacket<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>ecbpointer<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>asm
          </b></font><font color="#FF00FF">push bp  </font><font color="#008000"><i>{if this isn't saved then the program will crash}
          </i></font><font color="#FF00FF">mov bx,0003h
          les si,ecbpointer
          int $7a
          pop bp
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{------------------------------------------------------------------------}
      {listen for a packet: ecb is an ecb record type}
      </i></font><font color="#FF0000"><b>procedure </b></font>listenforpacket<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>ecb<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>asm
          </b></font><font color="#FF00FF">push bp
          Push si
          mov bx,$0004
          les si,ecb
          int $7a
          mov [byte ptr result],al
          Pop si
          pop bp
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{------------------------------------------------------------------------}
      {check to see if IPX is installed}
      </i></font><font color="#FF0000"><b>function </b></font>IPXinstalled <font color="#000080">: </font>Boolean<font color="#000080">;
      </font><font color="#FF0000"><b>var </b></font>stat <font color="#000080">: </font>byte<font color="#000080">;
        </font><font color="#FF0000"><b>begin
          asm
            </b></font><font color="#FF00FF">mov ax,7a00h
            int $2f
            mov stat,al
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>stat <font color="#000080">= </font><font color="#800000">$ff </font><font color="#FF0000"><b>then </b></font>ipxinstalled <font color="#000080">:= </font>true <font color="#FF0000"><b>else
          </b></font>ipxinstalled <font color="#000080">:= </font>false<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{------------------------------------------------------------------------}
      {closes an open socket}
      </i></font><font color="#FF0000"><b>procedure </b></font>closesocket<font color="#000080">(</font>socketnum <font color="#000080">: </font>word<font color="#000080">);
      </font><font color="#FF0000"><b>var </b></font>sock <font color="#000080">: </font>word<font color="#000080">;
        </font><font color="#FF0000"><b>begin
         </b></font>sock <font color="#000080">:= </font>swap<font color="#000080">(</font>Socketnum<font color="#000080">);
           </font><font color="#FF0000"><b>asm
             </b></font><font color="#FF00FF">mov bx,0001h
             mov dx,sock
             int $7a
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{------------------------------------------------------------------------}
      {Opens a socket, (SocketType is the type of socket you want to
      open:
      00h = open until close or terminate
      FFh = open until close}
      </i></font><font color="#FF0000"><b>procedure </b></font>opensocket<font color="#000080">(</font>socketnum <font color="#000080">: </font>word<font color="#000080">);
      </font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>word<font color="#000080">;
        </font><font color="#FF0000"><b>begin
          </b></font>i <font color="#000080">:= </font>swap<font color="#000080">(</font>socketnum<font color="#000080">);
            </font><font color="#FF0000"><b>asm
              </b></font><font color="#FF00FF">mov bx,0000h
              mov dx,i
              mov al,sockettype
              int $7a
              mov [byte ptr result],al
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{------------------------------------------------------------------------}
      {tells IPX that the program is idle and it can do some work}
      </i></font><font color="#FF0000"><b>Procedure </b></font>RelinquishControl<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>asm
          </b></font><font color="#FF00FF">mov bx,$000a
          int $7a
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{------------------------------------------------------------------------}

      </i></font><font color="#000080">&thorn; </font>Other routines <font color="#000080">&thorn;

      </font><font color="#008000"><i>{------------------------------------------------------------------------}
      {some of these routines use this.}
      </i></font><font color="#FF0000"><b>procedure </b></font>Callint<font color="#000080">(</font>Ahreg <font color="#000080">: </font>byte<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">;
                        </font><font color="#FF0000"><b>Var </b></font>error <font color="#000080">: </font>Byte<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>asm
        </b></font><font color="#FF00FF">push ds
        mov ah,ahreg
        lds si,bufferin
        les di,bufferout
        int 21h
        mov [byte ptr error],al
        pop  ds
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{------------------------------------------------------------------------}
      </i></font><font color="#FF0000"><b>procedure </b></font>getinternetaddress<font color="#000080">(</font>Connect <font color="#000080">: </font>byte<font color="#000080">;
                                   </font><font color="#FF0000"><b>Var </b></font>net <font color="#000080">: </font>tinternetworkaddressrec<font color="#000080">);
      </font><font color="#FF0000"><b>type
        </b></font>request <font color="#000080">= </font><font color="#FF0000"><b>record
          </b></font>len <font color="#000080">: </font>word<font color="#000080">;
          </font>sub <font color="#000080">: </font>byte<font color="#000080">;
          </font>c<font color="#000080">: </font>byte<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>reply <font color="#000080">= </font><font color="#FF0000"><b>record
          </b></font>len <font color="#000080">: </font>word<font color="#000080">;
          </font>n <font color="#000080">: </font>tinternetworkaddressREC<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>var  </b></font>bufferin  <font color="#000080">: </font>request<font color="#000080">;
        </font>bufferout <font color="#000080">: </font>reply<font color="#000080">;
        </font>i <font color="#000080">: </font>byte<font color="#000080">;
        </font><font color="#FF0000"><b>begin
          </b></font>fillchar<font color="#000080">(</font>Bufferout<font color="#000080">,</font>sizeof<font color="#000080">(</font>Bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
          </font>bufferin<font color="#000080">.</font>len <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
          </font>bufferin<font color="#000080">.</font>sub <font color="#000080">:= </font><font color="#800000">$13</font><font color="#000080">;
          </font>bufferin<font color="#000080">.</font>c <font color="#000080">:= </font>connect<font color="#000080">;
          </font>bufferout<font color="#000080">.</font>len <font color="#000080">:= </font>sizeof<font color="#000080">(</font>Bufferout<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">;

          </font>callint<font color="#000080">(</font><font color="#800000">$e3</font><font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">,</font>error<font color="#000080">);


          </font>net<font color="#000080">.</font>networkaddr <font color="#000080">:= </font>bufferout<font color="#000080">.</font>n<font color="#000080">.</font>networkaddr<font color="#000080">;
          </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">6 </font><font color="#FF0000"><b>do
          </b></font>net<font color="#000080">.</font>nodeaddr<font color="#000080">[</font>i<font color="#000080">] := </font>bufferout<font color="#000080">.</font>n<font color="#000080">.</font>nodeaddr<font color="#000080">[</font>i<font color="#000080">];
          </font>net<font color="#000080">.</font>socket <font color="#000080">:= </font>bufferout<font color="#000080">.</font>n<font color="#000080">.</font>socket<font color="#000080">;

        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{------------------------------------------------------------------------}
      </i></font><font color="#FF0000"><b>procedure </b></font>myaddrASM<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>bufferout<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>asm
          </b></font><font color="#FF00FF">mov bx,0009h
          les si,bufferout
          int $7a
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{------------------------------------------------------------------------}
      {get your own address}
      </i></font><font color="#FF0000"><b>Procedure </b></font>myaddress<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n <font color="#000080">: </font>tinternetworkaddressrec<font color="#000080">);
      </font><font color="#FF0000"><b>type
        </b></font>reply <font color="#000080">= </font><font color="#FF0000"><b>record
          </b></font>net <font color="#000080">: </font>longint<font color="#000080">;
          </font>node <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>var
        </b></font>bufferout <font color="#000080">: </font>reply<font color="#000080">;
        </font><font color="#FF0000"><b>begin
          </b></font>fillchar<font color="#000080">(</font>Bufferout<font color="#000080">,</font>sizeof<font color="#000080">(</font>Bufferout<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
          </font>myaddrasm<font color="#000080">(</font>Bufferout<font color="#000080">);
          </font>move<font color="#000080">(</font>bufferout<font color="#000080">.</font>node<font color="#000080">,</font>n<font color="#000080">.</font>nodeaddr<font color="#000080">,</font>sizeof<font color="#000080">(</font>N<font color="#000080">.</font>nodeaddr<font color="#000080">));
          </font>n<font color="#000080">.</font>networkaddr <font color="#000080">:= </font>bufferout<font color="#000080">.</font>net<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{------------------------------------------------------------------------}
      </i></font>Other routines that you should write are things that <font color="#FF0000"><b>set </b></font>up the ECB <font color="#FF0000"><b>for
      </b></font>sending <font color="#FF0000"><b>and </b></font>receiving packets<font color="#000080">. </font>I<font color="#800000">'ll show you what you should be
      </font>doing <font color="#FF0000"><b>for </b></font>those routines<font color="#000080">.



      </font>Section <font color="#800000">5.

      </font><font color="#FF0000"><b>Program </b></font>flow

      <font color="#FF0000"><b>In </b></font>this section I will show you the basic <font color="#FF0000"><b>program </b></font>flow <font color="#FF0000"><b>for </b></font>sending <font color="#FF0000"><b>and
      </b></font>receiving an IPX packet<font color="#000080">.

      </font><font color="#FF0000"><b>For </b></font>the socket numbers I just use the same socket <font color="#FF0000"><b>for </b></font>sending<font color="#000080">/</font>receiving
      data<font color="#000080">. </font>A better way <font color="#FF0000"><b>to do </b></font>this would be <font color="#FF0000"><b>to </b></font>have one socket <font color="#FF0000"><b>for </b></font>receiving
      <font color="#FF0000"><b>and </b></font>one <font color="#FF0000"><b>for </b></font>sending packets<font color="#000080">. (</font>that gets a bit complicated<font color="#000080">)


      </font>SEND PACKET

      The <font color="#FF0000"><b>program </b></font>flow <font color="#FF0000"><b>is </b></font>this<font color="#000080">:
      </font>variables used<font color="#000080">:
       </font>ecb <font color="#000080">: </font>tecb<font color="#000080">;
       </font>IPX <font color="#000080">: </font>tipxheader<font color="#000080">;
       </font>D   <font color="#000080">: </font>datagram<font color="#000080">;


      </font><font color="#800000">1.  </font>Open socket your going <font color="#FF0000"><b>to </b></font>send <font color="#FF0000"><b>on</b></font><font color="#000080">.
      </font><font color="#800000">2.  </font>Setup your IPX header<font color="#000080">. (</font>The fields listed here MUST be filled<font color="#000080">)
           ==&gt; </font>Get destination address <font color="#000080">&amp; </font>put it <font color="#FF0000"><b>in </b></font>IPX<font color="#000080">.</font>dest
               <font color="#FF0000"><b>If </b></font>you want <font color="#FF0000"><b>to </b></font>send a broadcast packet <font color="#000080">(</font><font color="#FF0000"><b>to </b></font>all computers<font color="#000080">)
               </font><font color="#FF0000"><b>then </b></font>just leave the ipx<font color="#000080">.</font>dest filled <font color="#FF0000"><b>with </b></font>zeros <font color="#FF0000"><b>and </b></font>the
               ipx<font color="#000080">.</font>dest<font color="#000080">.</font>nodeaddr filled <font color="#FF0000"><b>with </b></font><font color="#800000">$FF</font><font color="#000080">.
           ==&gt; </font>IPX<font color="#000080">.</font>checksum must equal zero <font color="#000080">(</font>hi<font color="#000080">-</font>low<font color="#000080">)
           ==&gt; </font>IPX<font color="#000080">.</font>len <font color="#000080">= </font>Sizeof<font color="#000080">(</font>ipx<font color="#000080">) (</font>size <font color="#FF0000"><b>of </b></font>the ipx header<font color="#000080">) (</font>hi<font color="#000080">-</font>low<font color="#000080">)
           ==&gt; </font>IPX<font color="#000080">.</font>dest<font color="#000080">.</font>socket equals socket number that destination <font color="#000080">(</font>hi<font color="#000080">-</font>low<font color="#000080">)
               </font>computer <font color="#FF0000"><b>is </b></font>using <font color="#FF0000"><b>to </b></font>receive data<font color="#000080">. (</font>I think<font color="#000080">)
           ==&gt; </font>the rest <font color="#FF0000"><b>of </b></font>the IPX header should be all zeros<font color="#000080">.
               </font>The fields <font color="#FF0000"><b>with </b></font><font color="#000080">&quot;</font>hi<font color="#000080">-</font>low<font color="#000080">&quot; </font>must have their bytes SWAPED<font color="#000080">.

      </font><font color="#800000">3.   </font>Put whatever data you want <font color="#FF0000"><b>to </b></font>send into the datagram<font color="#000080">.
           </font><font color="#FF0000"><b>as </b></font>an example<font color="#000080">:
           </font>S <font color="#000080">:= </font><font color="#800000">'This is a test!'
           </font>Move<font color="#000080">(</font>S<font color="#000080">,</font>D<font color="#000080">,</font>Sizeof<font color="#000080">(</font>S<font color="#000080">));
           </font>Now the datagram <font color="#000080">(</font>D<font color="#000080">) </font><font color="#FF0000"><b>contains </b></font>the <font color="#FF0000"><b>string </b></font><font color="#000080">&quot;</font>This <font color="#FF0000"><b>is </b></font>a test<font color="#000080">!&quot;.
           </font>When we <font color="#FF0000"><b>set </b></font>up the ECB <font color="#FF0000"><b>and </b></font>actually send the packet<font color="#000080">, </font>this <font color="#FF0000"><b>is </b></font>what
           we would be sending<font color="#000080">.
           </font>You can put ANY <font color="#FF0000"><b>type of </b></font>data <font color="#FF0000"><b>in </b></font>the datagram<font color="#000080">.


      </font><font color="#800000">4.   </font>Setup your Event Control Block <font color="#000080">(</font>ECB<font color="#000080">)
           </font>These fields must be filled<font color="#000080">:
           ==&gt; </font>ecb<font color="#000080">.</font>socketnum equals socket your sending <font color="#FF0000"><b>on </b></font><font color="#000080">(</font>hi<font color="#000080">-</font>low<font color="#000080">)
           ==&gt; </font>Fragcount equals the amount <font color="#FF0000"><b>of </b></font>data fragments you have<font color="#000080">.
               </font><font color="#FF0000"><b>In </b></font>this document we are using two<font color="#000080">.
           ==&gt; </font>Fragdata<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>size <font color="#000080">:= </font>sizeof<font color="#000080">(</font>IPX<font color="#000080">)
           ==&gt; </font>Fragdata<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>fragptr <font color="#000080">:= @(</font>IPX<font color="#000080">) (</font>pointer <font color="#FF0000"><b>to </b></font>IPX header<font color="#000080">)
           </font>N<font color="#000080">.</font>B The first fragment must always contain the ipx header
               data<font color="#000080">.
           ==&gt; </font>fragdata<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">].</font>size <font color="#000080">:= </font>sizeof<font color="#000080">(</font>D<font color="#000080">)
           ==&gt; </font>fragdata<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">].</font>fragptr <font color="#000080">:= @(</font>D<font color="#000080">)
               </font>The second fragment <font color="#FF0000"><b>contains </b></font>the datagram<font color="#000080">.
               (</font>the stuff your actually sending<font color="#000080">)


      </font><font color="#800000">5.  </font>Send the packet<font color="#000080">.
          </font>You are now ready <font color="#FF0000"><b>to </b></font>send the packet <font color="#FF0000"><b>on </b></font>it<font color="#800000">'s speedy little voyage
          </font>through the network <font color="#FF0000"><b>to </b></font>reach it<font color="#800000">'s destination computer(s).
          </font>This <font color="#FF0000"><b>is </b></font>just a call <font color="#FF0000"><b>to </b></font>the routine Sendpacket<font color="#000080">. </font>You give the
          routine the filled ecb <font color="#FF0000"><b>and </b></font>it takes care <font color="#FF0000"><b>of </b></font>the rest<font color="#000080">.

          </font>SendPakcet<font color="#000080">(</font>ecb<font color="#000080">);

          </font><font color="#FF0000"><b>repeat
            </b></font>relinquishcontrol<font color="#000080">;
          </font><font color="#FF0000"><b>until </b></font>ecb<font color="#000080">.</font>inuse <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">;

          </font>What <font color="#FF0000"><b>is </b></font>that <font color="#000080">&quot;</font>relinquishcontrol<font color="#000080">&quot; </font>stuff<font color="#000080">?
          </font>That<font color="#800000">'s a routine to tell IPX that it can go ahead and send the packet.
          </font>Usually you <font color="#FF0000"><b>repeat </b></font>that routine <font color="#FF0000"><b>until </b></font>the ecb<font color="#000080">.</font>inuse flag <font color="#FF0000"><b>is set to
          </b></font>zero<font color="#000080">, </font>which means that the packet was sent<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>ECB<font color="#000080">.</font>code <font color="#FF0000"><b>is </b></font>something
          other than zero <font color="#FF0000"><b>then </b></font>the packet did <font color="#FF0000"><b>not </b></font>send successfully<font color="#000080">.


      </font>That<font color="#800000">'s how an IPX packet is sent. You should probably write some procedures
      </font>that will <font color="#FF0000"><b>set </b></font>up the IPX header <font color="#FF0000"><b>and </b></font>ECB header by just sending up a
      connection number <font color="#FF0000"><b>and </b></font>the header<font color="#000080">. </font><font color="#FF0000"><b>In </b></font>my IPXSETUP <font color="#FF0000"><b>procedure</b></font><font color="#000080">, </font>a connection
      number that <font color="#FF0000"><b>is </b></font>zero tells it <font color="#FF0000"><b>to set </b></font>up the header<font color="#800000">'s dest address as a
      </font>broadcast packet<font color="#000080">. </font>Note that setting up ipx <font color="#FF0000"><b>for </b></font>receiving a packet <font color="#FF0000"><b>is </b></font>a bit
      different<font color="#000080">. (</font>A lot easier<font color="#000080">!)


      </font>RECEIVE PACKET <font color="#000080">(</font>same variables used<font color="#000080">)

      </font>Basic <font color="#FF0000"><b>program </b></font>flow<font color="#000080">:

      </font><font color="#800000">1.  </font>Fill IPX header <font color="#FF0000"><b>with </b></font>zeros

      <font color="#800000">2.  </font>Setup ECB<font color="#000080">.
          ==&gt; </font>ecb<font color="#000080">.</font>socketnum <font color="#000080">:= </font>swap<font color="#000080">(</font>listensocket<font color="#000080">)
          ==&gt; </font>ecb<font color="#000080">.</font>fragcount <font color="#000080">= </font><font color="#800000">2
          </font><font color="#000080">==&gt; </font>fragdata<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>size <font color="#000080">:= </font>sizeof<font color="#000080">(</font>ipx<font color="#000080">);
              </font>fragdata<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>fragprt <font color="#000080">:= @</font>ipx<font color="#000080">;
          ==&gt; </font>fragdata<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">].</font>size <font color="#000080">:= </font>sizeof<font color="#000080">(</font>d<font color="#000080">);
          ==&gt; </font>fragdata<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">].</font>fragptr <font color="#000080">:= @</font>d<font color="#000080">;

      </font><font color="#800000">3.  </font>Wait <font color="#FF0000"><b>for </b></font>a packet <font color="#FF0000"><b>to </b></font>arrive<font color="#000080">.
          </font>Listenforpacket<font color="#000080">(</font>ecB<font color="#000080">);
          </font><font color="#FF0000"><b>repeat
            </b></font>relinquishcontrol<font color="#000080">;
          </font><font color="#FF0000"><b>until </b></font>ecb<font color="#000080">.</font>inuse <font color="#000080">= </font><font color="#800000">00</font><font color="#000080">;

      </font><font color="#800000">4.  </font>data <font color="#FF0000"><b>is </b></font>now <font color="#FF0000"><b>in </b></font>Datagram


      Notice <font color="#FF0000"><b>in </b></font>step <font color="#800000">3 </font>that the routine <font color="#000080">&quot;</font>listenforpacket<font color="#000080">&quot; </font>does <font color="#FF0000"><b>not </b></font>wait <font color="#FF0000"><b>for </b></font>a
      packet <font color="#FF0000"><b>to </b></font>be send<font color="#000080">. </font>Rather<font color="#000080">, </font>you call that routine <font color="#FF0000"><b>and then repeat
      </b></font><font color="#000080">&quot;</font>relinquishcontrol<font color="#000080">&quot; </font><font color="#FF0000"><b>until </b></font>a packet does arrive<font color="#000080">. </font>When a packet <font color="#FF0000"><b>is </b></font>received
      <font color="#FF0000"><b>then </b></font>IPX puts the packet information into the pointers specified<font color="#000080">. </font><font color="#FF0000"><b>In </b></font>this
      <font color="#FF0000"><b>case </b></font><font color="#000080">&quot;</font>IPX<font color="#000080">&quot; </font><font color="#FF0000"><b>and </b></font><font color="#000080">&quot;</font>D<font color="#000080">&quot;. </font>Now you know who send the packet <font color="#000080">(</font>you have their
      address<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>what they sent<font color="#000080">.


      </font>Section <font color="#800000">6.

      </font>Common questions

      Q<font color="#000080">. </font>Why isn<font color="#800000">'t my program working?

      </font>A<font color="#000080">. </font>Could be a number <font color="#FF0000"><b>of </b></font>reasons<font color="#000080">. </font>Step through your <font color="#FF0000"><b>program and </b></font>see exactly
         what you are putting <font color="#FF0000"><b>in </b></font>the IPX header <font color="#FF0000"><b>and </b></font>ECB<font color="#000080">. (</font><font color="#FF0000"><b>If </b></font>your using <font color="#FF0000"><b>Pascal
         </b></font>press ctrl<font color="#000080">-</font>f4<font color="#000080">) </font>Also<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>you are setting up an ECB <font color="#FF0000"><b>or </b></font>header<font color="#000080">, </font>any fields
         that <font color="#FF0000"><b>do not </b></font>have <font color="#FF0000"><b>to </b></font>be filled <font color="#FF0000"><b>with </b></font>a value should be <font color="#FF0000"><b>set to </b></font>zero<font color="#000080">.
         </font>Make sure the socket you are sending <font color="#FF0000"><b>on is </b></font>open<font color="#000080">. (</font>check the error code<font color="#000080">)

      </font><font color="#FF0000"><b>If </b></font>you e<font color="#000080">-</font>mail me <font color="#FF0000"><b>with </b></font>a question <font color="#FF0000"><b>then </b></font>it will probably <font color="#FF0000"><b>end </b></font>up <font color="#FF0000"><b>in </b></font>this
      section<font color="#000080">.


      </font>Section <font color="#800000">7.

      </font>Other stuff

      Here<font color="#800000">'s a list of the inuse flag codes,completion codes and values for
      </font>IPX packet types<font color="#000080">:

      </font>Values <font color="#FF0000"><b>for </b></font>ECB <font color="#FF0000"><b>in</b></font><font color="#000080">-</font>use flag<font color="#000080">:

      </font><font color="#800000">00</font>h available
      E0h AES temporary
      F6h <font color="#000080">\</font>special IPX<font color="#000080">/</font>SPX processing <font color="#FF0000"><b>for </b></font>v3<font color="#000080">.</font><font color="#800000">02</font><font color="#000080">+
      </font>F7h <font color="#000080">/
      </font>F8h IPX <font color="#FF0000"><b>in </b></font>critical section
      F9h SPX listening
      FAh processing
      FBh holding
      FCh AES waiting
      FDh AES counting down delay time
      FEh awaiting packet reception
      FFh senfing packet

      Values <font color="#FF0000"><b>for </b></font>ECB completion code<font color="#000080">:

      </font><font color="#800000">00</font>h success
      ECh remote terminated connection without acknowledging packet
      EDh abnormal connection termination
      EEh invalid connection ID
      EFh SPX connection table full
      F9h event should <font color="#FF0000"><b>not </b></font>be canceled
      FAh cannot establish connection <font color="#FF0000"><b>with </b></font>specified destination
      FCh cancelled
      FDh malformed packet
      FEh packet undeliverable
      FFh physical error

      Values <font color="#FF0000"><b>for </b></font>IPX packet <font color="#FF0000"><b>type</b></font><font color="#000080">:

      </font><font color="#800000">00</font>h     unknown packet <font color="#FF0000"><b>type
      </b></font><font color="#800000">01</font>h     routing information packet
      <font color="#800000">02</font>h     echo packet
      <font color="#800000">03</font>h     error packet
      <font color="#800000">04</font>h     packet exchange packet
      <font color="#800000">05</font>h     SPX packet
      <font color="#800000">11</font>h     Netware Core Protocol
      <font color="#800000">14</font>h     Propagated Packet <font color="#000080">(</font><font color="#FF0000"><b>for </b></font>Netware<font color="#000080">), </font>NetBIOS name packet
      <font color="#800000">15</font>h<font color="#000080">-</font><font color="#800000">1E</font>h experimental protocols

      Section <font color="#800000">8

      </font>About Ken Johnson

      Hello<font color="#000080">! </font>My name <font color="#FF0000"><b>is </b></font>Ken Johnson <font color="#FF0000"><b>and </b></font>I am a student at Carleton
      University <font color="#FF0000"><b>in </b></font>Ottawa Ont<font color="#000080">. </font>Canada<font color="#000080">. </font>Currently I am <font color="#FF0000"><b>in </b></font>my first
      year <font color="#FF0000"><b>of </b></font>a Computer Mathmatics degree<font color="#000080">.
      </font>You can visit my website at<font color="#000080">: </font>wabakimi<font color="#000080">.</font>carleton<font color="#000080">.</font>ca<font color="#000080">/~</font>kjohnso3
      <font color="#FF0000"><b>or </b></font>email me at kjohnso3<font color="#000080">@</font>chat<font color="#000080">.</font>carleton<font color="#000080">.</font>ca


      Section <font color="#800000">9

      </font>Future works
      Hopefully somemore TCP<font color="#000080">/</font>IP stuff but I haven<font color="#800000">'t had the time to
      </font><font color="#FF0000"><b>do </b></font>so<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you are interested <font color="#FF0000"><b>in </b></font>IPX<font color="#000080">/</font>SPX code <font color="#FF0000"><b>for </b></font>C<font color="#000080">++ </font><font color="#FF0000"><b>then </b></font>send
      me some mail<font color="#000080">.
      
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0065.PAS">Original</a><b>]</b></p></body>
</html>
