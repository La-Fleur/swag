<html>
<head><title> "DETCNETX.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&plusmn;i'm trying to find a method by which i can, from within a TP Program,
&plusmn;detect whether or not the NetWare shell has been loaded (Net3, NetX, or
&plusmn;whatever); i've figured out how to determine if IPX is running, but
&plusmn;can't seem to nail down the shell; the general idea is to detect IPX,
&plusmn;detect the shell, determine whether or not the user is logged in, and if
&plusmn;not, give them the oppurtUnity to do so; i've got most of the rest
&plusmn;figured out, but can't find the shell; any help would be greatly
&plusmn;appreciated

Try Interrupt 21h, Function EAh, GetShellVersion;
}

</i></font><font color="#FF0000"><b>Uses
  </b></font><font color="#008000"><i>{$IFDEF DPMI}
  </i></font>WinDos<font color="#000080">;
  </font><font color="#008000"><i>{$ELSE}
  </i></font>Dos<font color="#000080">;
  </font><font color="#008000"><i>{$endIF}
</i></font><font color="#FF0000"><b>Var
  </b></font>vOS<font color="#000080">,
  </font>vHardwareType<font color="#000080">,
  </font>vShellMajorVer<font color="#000080">,
  </font>vShellMinorVer<font color="#000080">,
  </font>vShellType<font color="#000080">,
  </font>vShellRevision  <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#008000"><i>{$IFDEF DPMI}
  </i></font>vRegs <font color="#000080">: </font>tRegisters<font color="#000080">;
  </font><font color="#008000"><i>{$ELSE}
  </i></font>vRegs <font color="#000080">: </font>Registers<font color="#000080">;
  </font><font color="#008000"><i>{$endIF}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetShellVersion<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>vOS            <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>vHardwareType  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>vShellMajorVer <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>vShellMinorVer <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>vShellType     <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>vShellRevision <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>FillChar<font color="#000080">(</font>vRegs<font color="#000080">, </font>SizeOf<font color="#000080">(</font>vRegs<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>vRegs <font color="#FF0000"><b>DO
  begin
    </b></font>AH <font color="#000080">:= </font><font color="#800000">$EA</font><font color="#000080">;
    </font>Intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">, </font>vRegs<font color="#000080">);
    </font>vOS <font color="#000080">:= </font>AH<font color="#000080">;              </font><font color="#008000"><i>(* $00 = MS-Dos *)
    </i></font>vHardwareType <font color="#000080">:= </font>AL<font color="#000080">;    </font><font color="#008000"><i>(* $00 = PC, $01 = Victor 9000 *)
    </i></font>vShellMajorVer <font color="#000080">:= </font>BH<font color="#000080">;
    </font>vShellMinorVer <font color="#000080">:= </font>BL<font color="#000080">;
    </font>vShellType <font color="#000080">:= </font>CH<font color="#000080">;       </font><font color="#008000"><i>(* $00 = conventional memory *)
                            (* $01 = expanded memory     *)
                            (* $02 = extended memory     *)
    </i></font>vShellRevision <font color="#000080">:= </font>CL<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>GetShellVersion<font color="#000080">;
  </font>Writeln<font color="#000080">(</font>vOS<font color="#000080">);
  </font>Readln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p></body>
</html>
