<html>
<head><title> "Encryped logins" by NORBERT IGL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 SM&gt; Have you got any idea on how to do a login under Novell 3.11+?

 SM&gt; I have some source (SWAG has source for a great TPU), but
 SM&gt; unfortunatly it doesn't do encrypted logins.. I managed to find
 SM&gt; *some* reference to it in the interrupt list (int 21h, the F2h
 SM&gt; multiplexor functions 17h/18h), but it didn't give any details on
 SM&gt; how this is done...

 hmmm. Novell never released any informations about Password Encrytion !

 You got two choices (:-)

1.   do a &quot;Set Allow Unencrypted Passwords = ON&quot; on the server console,
     use the following, ripped from an old src &quot;Novapi.zip:Novell.pas&quot;

------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">;
[...]

</font><font color="#008000"><i>{ obj_type:   User = 1, group =2 printserver = 3 }

</i></font><font color="#FF0000"><b>procedure </b></font>login_to_file_server<font color="#000080">( </font>obj_type<font color="#000080">:</font>integer<font color="#000080">;
                              </font>_name<font color="#000080">,
                              </font>_password <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                          </font><font color="#FF0000"><b>var </b></font>retcode<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var
      </b></font>regs <font color="#000080">: </font>registers<font color="#000080">;

      </font>request_buffer <font color="#000080">: </font><font color="#FF0000"><b>record
            </b></font>B_length <font color="#000080">: </font>integer<font color="#000080">;
         </font>subfunction <font color="#000080">: </font>byte<font color="#000080">;
              </font>o_type <font color="#000080">: </font><font color="#FF0000"><b>packed array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
         </font>name_length <font color="#000080">: </font>byte<font color="#000080">;
            </font>obj_name <font color="#000080">: </font><font color="#FF0000"><b>packed array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">47</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
     </font>password_length <font color="#000080">: </font>byte<font color="#000080">;
            </font>password <font color="#000080">: </font><font color="#FF0000"><b>packed array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">27</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font>reply_buffer <font color="#000080">: </font><font color="#FF0000"><b>record
            </b></font>R_length <font color="#000080">: </font>integer<font color="#000080">;
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

               </font>count <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
With </b></font>request_buffer <font color="#FF0000"><b>do
begin
 </b></font>B_length <font color="#000080">:= </font><font color="#800000">79</font><font color="#000080">;
 </font>subfunction <font color="#000080">:= </font><font color="#800000">$14</font><font color="#000080">;
 </font>o_type<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
 </font>o_type<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>obj_type<font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">47 </font><font color="#FF0000"><b>do </b></font>obj_name<font color="#000080">[</font>count<font color="#000080">] := </font><font color="#800000">$0</font><font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">27 </font><font color="#FF0000"><b>do </b></font>password<font color="#000080">[</font>count<font color="#000080">] := </font><font color="#800000">$0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>_name<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    for </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>_name<font color="#000080">) </font><font color="#FF0000"><b>do
</b></font>obj_name<font color="#000080">[</font>count<font color="#000080">]:=</font>ord<font color="#000080">(</font>upcase<font color="#000080">(</font>_name<font color="#000080">[</font>count<font color="#000080">]));
 </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>_password<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    for </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>_password<font color="#000080">) </font><font color="#FF0000"><b>do
</b></font>password<font color="#000080">[</font>count<font color="#000080">]:=</font>ord<font color="#000080">(</font>upcase<font color="#000080">(</font>_password<font color="#000080">[</font>count<font color="#000080">]));
 </font><font color="#008000"><i>{set to full length of field}
 </i></font>name_length <font color="#000080">:= </font><font color="#800000">47</font><font color="#000080">;
 </font>password_length <font color="#000080">:= </font><font color="#800000">27</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>With </b></font>reply_buffer <font color="#FF0000"><b>do
begin
 </b></font>R_length <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>With </b></font>Regs <font color="#FF0000"><b>Do Begin
    </b></font>Ah <font color="#000080">:= </font><font color="#800000">$e3</font><font color="#000080">;                 </font><font color="#008000"><i>{ moved to $F2 for v3.x ??? }
    </i></font>Ds <font color="#000080">:= </font>Seg<font color="#000080">(</font>Request_Buffer<font color="#000080">);
    </font>Si <font color="#000080">:= </font>Ofs<font color="#000080">(</font>Request_Buffer<font color="#000080">);
    </font>Es <font color="#000080">:= </font>Seg<font color="#000080">(</font>reply_buffer<font color="#000080">);
    </font>Di <font color="#000080">:= </font>Ofs<font color="#000080">(</font>reply_buffer<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>MsDos<font color="#000080">(</font>Regs<font color="#000080">);
  </font>retcode <font color="#000080">:= </font>regs<font color="#000080">.</font>al
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>logout<font color="#000080">;
</font><font color="#008000"><i>{logout from all file servers}
</i></font><font color="#FF0000"><b>var </b></font>regs <font color="#000080">: </font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$D7</font><font color="#000080">;
 </font>msdos<font color="#000080">(</font>regs<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>logout_from_file_server<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>id<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#008000"><i>{logout from one file server}
</i></font><font color="#FF0000"><b>var </b></font>regs <font color="#000080">: </font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$F1</font><font color="#000080">;
 </font>regs<font color="#000080">.</font>al <font color="#000080">:= </font><font color="#800000">$02</font><font color="#000080">;
 </font>regs<font color="#000080">.</font>dl <font color="#000080">:= </font>id<font color="#000080">;
 </font>msdos<font color="#000080">(</font>regs<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

------------------------------------------------------------------------

</font><font color="#800000">2.   </font>get a copy <font color="#FF0000"><b>of </b></font><font color="#000080">&quot;</font>Charles Rose<font color="#000080">: </font>Netware Programming<font color="#000080">&quot;. </font>There are some
     <font color="#000080">&lt;</font>obj<font color="#000080">&gt; </font><font color="#FF0000"><b>for </b></font><font color="#000080">&quot;</font>C<font color="#000080">&quot;, </font><font color="#FF0000"><b>and in </b></font>my German version  TPU<font color="#800000">'s for Turbo/BP&quot; !

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p></body>
</html>
