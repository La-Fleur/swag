<html>
<head><title> "TENTOOLS chatting module" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0051.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000"> <font color="#008000"><i>{
 Program Name : Phone.Pas
 Written By   : Anonymous
 E-Mail       : nothing
 Web Page     : nothing
 Program
 Compilation  : Turbo Pascal 5.0 or later

 Program Description :

 Usefulness for BBS'S and general communications.
 For a detailed description of this code source, please,
 read the file TENTOOLS.DOC. Thank you
 }

</i></font><font color="#FF0000"><b>Program </b></font>Phone<font color="#000080">;
</font><font color="#008000"><i>{$F+}
</i></font><font color="#FF0000"><b>Uses </b></font>CRT<font color="#000080">,</font>TenTools<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>S80 <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];

</font><font color="#FF0000"><b>Var
  </b></font>RemoteID <font color="#000080">: </font>S12<font color="#000080">;
  </font>Caller <font color="#000080">: </font>S12<font color="#000080">;
  </font>NodeID   <font color="#000080">: </font>S12<font color="#000080">;
  </font>SendCount<font color="#000080">,</font>I<font color="#000080">,</font>TransType<font color="#000080">,</font>Msgs <font color="#000080">: </font>INteger<font color="#000080">;
  </font>TransID <font color="#000080">: </font>Real<font color="#000080">;
  </font>SendString <font color="#000080">: </font>S80<font color="#000080">;
  </font>RcvString <font color="#000080">: </font>S80<font color="#000080">;
  </font>RcvLength <font color="#000080">: </font>Integer<font color="#000080">;
  </font>TenError <font color="#000080">: </font>Word<font color="#000080">;
  </font>Connect<font color="#000080">,</font>Hangup<font color="#000080">,</font>BeingCalled<font color="#000080">,</font>Calling<font color="#000080">,</font>CBMess <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Gar <font color="#000080">: </font>Integer<font color="#000080">;
  </font>SendKey<font color="#000080">,</font>SpecChar<font color="#000080">,</font>Inchar <font color="#000080">: </font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Ring<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>ClrScr<font color="#000080">;
   </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'With which node do you wish to converse: '</font><font color="#000080">);
   </font>Readln<font color="#000080">(</font>RemoteID<font color="#000080">);
   </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>RemoteID<font color="#000080">)&lt;</font><font color="#800000">12 </font><font color="#FF0000"><b>do </b></font>RemoteID<font color="#000080">:=</font>RemoteID<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>do </b></font>RemoteID<font color="#000080">[</font>I<font color="#000080">]:=</font>Upcase<font color="#000080">(</font>RemoteID<font color="#000080">[</font>I<font color="#000080">]);
   </font>ClrScr<font color="#000080">;
   </font>SendString<font color="#000080">:=</font><font color="#800000">'You are being &quot;PHONE&quot;ed...'</font><font color="#000080">;
   </font>TenError<font color="#000080">:=</font>Chat<font color="#000080">(</font>RemoteID<font color="#000080">,</font>SendString<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>TenError<font color="#000080">&lt;&gt;</font><font color="#800000">0
   </font><font color="#FF0000"><b>then
    begin
       </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error Chatting...'</font><font color="#000080">,</font>TenError<font color="#000080">);
       </font>Halt<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>SendCount<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>TenError<font color="#000080">:=</font>TBSend<font color="#000080">(</font>RemoteID<font color="#000080">,</font>SendString<font color="#000080">,</font>Length<font color="#000080">(</font>SendString<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font>SendCount<font color="#000080">,</font><font color="#800000">17</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
   </font>SendString<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
   </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
   </font>TextColor<font color="#000080">(</font>White<font color="#000080">);
   </font>Write<font color="#000080">(
</font><font color="#800000">'Ringing '</font><font color="#000080">,</font>RemoteID<font color="#000080">,</font><font color="#800000">'  (A)bort '</font><font color="#000080">);
   </font>ClrEol<font color="#000080">;
   </font>Caller<font color="#000080">:=</font>RemoteID<font color="#000080">;
   </font>Calling<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Ignore<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>SendString<font color="#000080">:=</font><font color="#800000">'Cannot Talk Now...Sorry'</font><font color="#000080">;
   </font>TenError<font color="#000080">:=</font>TBSend<font color="#000080">(</font>RemoteID<font color="#000080">,</font>SendString<font color="#000080">,</font>Length<font color="#000080">(</font>SendString<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font>SendCount<font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
   </font>SendString<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>Caller<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>BeingCalled<font color="#000080">:=</font>False<font color="#000080">;
   </font>Hangup<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Answer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>RemoteID<font color="#000080">:=</font>Caller<font color="#000080">;
   </font>SendCount<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>SendString<font color="#000080">:=</font><font color="#800000">'Responding...'</font><font color="#000080">;
   </font>TenError<font color="#000080">:=</font>TBSend<font color="#000080">(</font>RemoteID<font color="#000080">,</font>SendString<font color="#000080">,</font>Length<font color="#000080">(</font>SendString<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font>SendCount<font color="#000080">,</font><font color="#800000">17</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
   </font>SendString<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>TenError<font color="#000080">&lt;&gt;</font><font color="#800000">0
   </font><font color="#FF0000"><b>then
    begin
       </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error Sending String to '</font><font color="#000080">,</font>Caller<font color="#000080">);
       </font>Halt<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ClearBuffers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   Repeat
      </b></font>TenError<font color="#000080">:=</font>TBReceive<font color="#000080">(</font>RemoteID<font color="#000080">,</font>RcvString<font color="#000080">,</font>RcvLength<font color="#000080">,</font>TransID<font color="#000080">,</font>TransType<font color="#000080">,</font>Msgs<font color="#000080">,</font>CBMess<font color="#000080">);
   </font><font color="#FF0000"><b>Until </b></font>Msgs<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Communicate<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>X<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>Y<font color="#000080">:=</font><font color="#800000">11</font><font color="#000080">;
   </font>TextColor<font color="#000080">(</font>White<font color="#000080">);
   </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
   </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
   </font>Write<font color="#000080">(
</font><font color="#800000">'                          Press [F1] to end Conversation'</font><font color="#000080">);
   </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
   </font>Write<font color="#000080">(
</font><font color="#800000">'&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;     '</font><font color="#000080">,</font>Caller<font color="#000080">,</font><font color="#800000">' &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;'</font><font color="#000080">);
   </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">);
   </font><font color="#FF0000"><b>Repeat
      </b></font>RcvLength<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font>TenError<font color="#000080">:=</font>TBReceive<font color="#000080">(</font>RemoteID<font color="#000080">,</font>RcvString<font color="#000080">,</font>RcvLength<font color="#000080">,</font>TransID<font color="#000080">,</font>TransType<font color="#000080">,</font>Msgs<font color="#000080">,</font>CBMess<font color="#000080">);
</font><font color="#008000"><i>{      If Msgs&gt;0 then Delay(20); }
      </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>TenError<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Msgs<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">))
      </font><font color="#FF0000"><b>then while </b></font><font color="#000080">((</font>TenError<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Msgs<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>do
       begin
          </b></font>TextColor<font color="#000080">(</font>Red<font color="#000080">);
          </font>Sound<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">);
          </font>Delay<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">);
          </font>NoSound<font color="#000080">;
          </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">);
          </font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>RemoteID<font color="#000080">=</font>Caller<font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>TransType<font color="#000080">=</font><font color="#800000">20</font><font color="#000080">))
          </font><font color="#FF0000"><b>then
           begin
              </b></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">);
              </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">);
              </font>Writeln<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
              </font>Writeln<font color="#000080">(</font>RcvString<font color="#000080">);
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>RemoteID<font color="#000080">=</font>Caller<font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>TransType<font color="#000080">=</font><font color="#800000">19</font><font color="#000080">))
          </font><font color="#FF0000"><b>then
           begin
              </b></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">);
              </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">);
              </font>Writeln<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
              </font>Writeln<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>RemoteID<font color="#000080">,</font><font color="#800000">' hung up!'</font><font color="#000080">);
              </font>Write<font color="#000080">(</font><font color="#800000">' Press any key to Continue...'</font><font color="#000080">);
              </font>InChar<font color="#000080">:=</font>ReadKey<font color="#000080">;
              </font>Hangup<font color="#000080">:=</font>True<font color="#000080">;
              </font>Calling<font color="#000080">:=</font>False<font color="#000080">;
              </font>Connect<font color="#000080">:=</font>False<font color="#000080">;
              </font>BeingCalled<font color="#000080">:=</font>False<font color="#000080">;
              </font>Caller<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
              </font>Msgs<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>RcvString<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
          </font><font color="#FF0000"><b>If not </b></font>Hangup <font color="#FF0000"><b>then
          </b></font>TenError<font color="#000080">:=</font>TBReceive<font color="#000080">(</font>RemoteID<font color="#000080">,</font>RcvString<font color="#000080">,</font>RcvLength<font color="#000080">,</font>TransID<font color="#000080">,</font>TransType<font color="#000080">,</font>Msgs<font color="#000080">,</font>CBMess<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>Msgs<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Delay<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>TenError<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Writeln<font color="#000080">(</font><font color="#800000">'10Net Error: '</font><font color="#000080">,</font>TenError<font color="#000080">);
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Keypressed <font color="#FF0000"><b>and not </b></font>Hangup<font color="#000080">)
      </font><font color="#FF0000"><b>then
       begin
          </b></font>SendKey<font color="#000080">:=</font>ReadKey<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>SendKey<font color="#000080">=</font><font color="#800000">#0
          </font><font color="#FF0000"><b>then
           begin
              </b></font>SpecCHar<font color="#000080">:=</font>ReadKey<font color="#000080">;
              </font><font color="#FF0000"><b>If </b></font>SpecCHar<font color="#000080">=</font><font color="#800000">#59
              </font><font color="#FF0000"><b>then
               begin
                  </b></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
                  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
                  </font>ClrEOL<font color="#000080">;
                  </font>TextColor<font color="#000080">(</font>White<font color="#000080">);
                  </font>Write<font color="#000080">(
</font><font color="#800000">'                   (E)nd Communication  (C)ontinue Communication'</font><font color="#000080">);
                  </font><font color="#FF0000"><b>Repeat
                     </b></font>Inchar<font color="#000080">:=</font>Upcase<font color="#000080">(</font>Readkey<font color="#000080">);
                  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Inchar <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'E'</font><font color="#000080">,</font><font color="#800000">'C'</font><font color="#000080">]);
                  </font><font color="#FF0000"><b>If </b></font>Inchar<font color="#000080">=</font><font color="#800000">'E'
                  </font><font color="#FF0000"><b>then
                   begin
                      </b></font>Hangup<font color="#000080">:=</font>True<font color="#000080">;
                      </font>Connect<font color="#000080">:=</font>False<font color="#000080">;
                      </font>Caller<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                      </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
                      </font>ClrEol<font color="#000080">;
                      </font>Write<font color="#000080">(
</font><font color="#800000">'                    Ending Communication...please wait...'</font><font color="#000080">);
                      </font>SendString<font color="#000080">:=</font><font color="#800000">'CLICK'</font><font color="#000080">;
                      </font>TenError<font color="#000080">:=</font>TBSend<font color="#000080">(</font>RemoteID<font color="#000080">,</font>SendString<font color="#000080">,</font>Length<font color="#000080">(</font>SendString<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font>SendCount<font color="#000080">,</font><font color="#800000">19</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
                      </font>SendString<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                      </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
                      </font>ClrScr<font color="#000080">;
                      </font>Calling<font color="#000080">:=</font>False<font color="#000080">;
                      </font>BeingCalled<font color="#000080">:=</font>False<font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
                  </font>ClrEol<font color="#000080">;
                  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
                  </font><font color="#FF0000"><b>If not </b></font>Hangup <font color="#FF0000"><b>then
                  </b></font>Write<font color="#000080">(
               </font><font color="#800000">'                          Press [F1] to end Conversation'</font><font color="#000080">);
                  </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">);
               </font><font color="#FF0000"><b>end
              else </b></font>Write<font color="#000080">(</font><font color="#800000">#7</font><font color="#000080">);
           </font><font color="#FF0000"><b>end
          else if </b></font>Sendkey<font color="#000080">=</font><font color="#800000">#13
          </font><font color="#FF0000"><b>then
           begin
              </b></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">);
              </font>GotoXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);
              </font>Writeln<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
              </font>X<font color="#000080">:=</font>WhereX<font color="#000080">;
              </font>Y<font color="#000080">:=</font>WhereY<font color="#000080">;
              </font>Inc<font color="#000080">(</font>SendCount<font color="#000080">);
              </font>TenError<font color="#000080">:=</font>TBSend<font color="#000080">(</font>RemoteID<font color="#000080">,</font>SendString<font color="#000080">,</font>Length<font color="#000080">(</font>SendString<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font>SendCount<font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
              </font>SendString<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
           </font><font color="#FF0000"><b>end
          else
           begin
              </b></font>TextColor<font color="#000080">(</font>Cyan<font color="#000080">);
              </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">);
              </font>GotoXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);
              </font>SendString<font color="#000080">:=</font>SendString<font color="#000080">+</font>SendKey<font color="#000080">;
              </font>Write<font color="#000080">(</font>SendKey<font color="#000080">);
              </font>X<font color="#000080">:=</font>WhereX<font color="#000080">;
              </font>Y<font color="#000080">:=</font>WhereY<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>Until </b></font>Hangup<font color="#000080">;
   </font>TextColor<font color="#000080">(</font>White<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>ScreenCalls<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   Repeat
      </b></font>TenError<font color="#000080">:=</font>TBReceive<font color="#000080">(</font>RemoteID<font color="#000080">,</font>RcvString<font color="#000080">,</font>RcvLength<font color="#000080">,</font>TransID<font color="#000080">,</font>TransType<font color="#000080">,</font>Msgs<font color="#000080">,</font>CBMess<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Msgs<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Delay<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Msgs<font color="#000080">&gt;</font><font color="#800000">0
      </font><font color="#FF0000"><b>then
       begin
          If </b></font>Calling
          <font color="#FF0000"><b>then
           begin
              If </b></font><font color="#000080">(</font>RemoteID<font color="#000080">=</font>Caller<font color="#000080">)
              </font><font color="#FF0000"><b>then
               begin
                  If </b></font>TransType<font color="#000080">=</font><font color="#800000">17 </font><font color="#FF0000"><b>then </b></font>Connect<font color="#000080">:=</font>True<font color="#000080">;
                  </font><font color="#FF0000"><b>If </b></font>TransType<font color="#000080">=</font><font color="#800000">18
                  </font><font color="#FF0000"><b>then
                   begin
                      </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
                      </font>ClrEol<font color="#000080">;
                      </font>Write<font color="#000080">(
</font><font color="#800000">'              Call Refused...'</font><font color="#000080">);
                      </font>Sound<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">);
                      </font>Delay<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">);
                      </font>NoSound<font color="#000080">;
                      </font>Hangup<font color="#000080">:=</font>True<font color="#000080">;
                      </font>Calling<font color="#000080">:=</font>False<font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end
          else
           begin
              If </b></font><font color="#000080">((</font>TransType<font color="#000080">=</font><font color="#800000">17</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Caller<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">))
              </font><font color="#FF0000"><b>then </b></font>Caller<font color="#000080">:=</font>RemoteID<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Msgs<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ClearCalls<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
   </font>ClrScr<font color="#000080">;
   </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
   </font>Write<font color="#000080">(</font><font color="#800000">'(R)ing someone  (Q)uit'</font><font color="#000080">);
   </font>Hangup<font color="#000080">:=</font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Begin  </b></font><font color="#008000"><i>{ Main }
  </i></font>TenError<font color="#000080">:=</font>TenConfig<font color="#000080">(</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>TenError<font color="#000080">&lt;&gt;</font><font color="#800000">0
  </font><font color="#FF0000"><b>then
   Begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error Configuring TenTools...'</font><font color="#000080">,</font>TenError<font color="#000080">);
      </font>Halt<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Connect<font color="#000080">:=</font>False<font color="#000080">;
  </font>BeingCalled<font color="#000080">:=</font>False<font color="#000080">;
  </font>Calling<font color="#000080">:=</font>False<font color="#000080">;
  </font>Hangup<font color="#000080">:=</font>False<font color="#000080">;
  </font>TextBackground<font color="#000080">(</font>Black<font color="#000080">);
  </font>TextColor<font color="#000080">(</font>Cyan<font color="#000080">);
  </font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
  </font>ClrScr<font color="#000080">;
</font><font color="#008000"><i>{Main Menu}
  </i></font>ClearBuffers<font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
     </b></font>ClearCalls<font color="#000080">;
      </font><font color="#FF0000"><b>Repeat
         </b></font>ScreenCalls<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>Connect
         <font color="#FF0000"><b>then </b></font>Communicate
         <font color="#FF0000"><b>else if </b></font>Keypressed
         <font color="#FF0000"><b>then
          begin
             </b></font>Inchar<font color="#000080">:=</font>Upcase<font color="#000080">(</font>Readkey<font color="#000080">);
             </font><font color="#FF0000"><b>If not </b></font><font color="#000080">(</font>Inchar <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">,</font><font color="#800000">'I'</font><font color="#000080">,</font><font color="#800000">'R'</font><font color="#000080">,</font><font color="#800000">'Q'</font><font color="#000080">]) </font><font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">#7</font><font color="#000080">);
             </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Inchar<font color="#000080">=</font><font color="#800000">'A'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font>BeingCalled<font color="#000080">)
              </font><font color="#FF0000"><b>then
               begin
                  </b></font>Answer<font color="#000080">;
                  </font>Communicate<font color="#000080">;
               </font><font color="#FF0000"><b>end
             else if </b></font><font color="#000080">((</font>Inchar<font color="#000080">=</font><font color="#800000">'A'</font><font color="#000080">)</font><font color="#FF0000"><b>and </b></font>Calling<font color="#000080">)
             </font><font color="#FF0000"><b>then
              begin
                 </b></font>Calling<font color="#000080">:=</font>False<font color="#000080">;
                 </font>Hangup<font color="#000080">:=</font>True<font color="#000080">;
                 </font>Caller<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
              </font><font color="#FF0000"><b>end
             else if </b></font>Inchar<font color="#000080">=</font><font color="#800000">'I'
             </font><font color="#FF0000"><b>then </b></font>Ignore
             <font color="#FF0000"><b>else if </b></font>Inchar<font color="#000080">=</font><font color="#800000">'R'
             </font><font color="#FF0000"><b>then
              begin
                 If </b></font>Calling <font color="#FF0000"><b>then </b></font>Ignore<font color="#000080">;
                 </font>Ring<font color="#000080">;
              </font><font color="#FF0000"><b>end
             else
              begin
                 </b></font>Hangup<font color="#000080">:=</font>True<font color="#000080">;
                 </font>Sound<font color="#000080">(</font><font color="#800000">2000</font><font color="#000080">);
                 </font>Delay<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
                 </font>NOsound<font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end
         else if </b></font><font color="#000080">((</font>Caller<font color="#000080">&lt;&gt;</font><font color="#800000">''</font><font color="#000080">)</font><font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>Calling <font color="#FF0000"><b>or </b></font>BeingCalled<font color="#000080">))
         </font><font color="#FF0000"><b>then
          begin
             </b></font>BeingCalled<font color="#000080">:=</font>True<font color="#000080">;
             </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'(R)ing someone (A)nswer  (I)gnore  (Q)uit'</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Until </b></font>Hangup<font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>Inchar <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'Q'</font><font color="#000080">,</font><font color="#800000">'q'</font><font color="#000080">];
  </font>ClearBuffers<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.  </font><font color="#008000"><i>{ Program TenTAlk}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0051.PAS">Original</a><b>]</b></p></body>
</html>
